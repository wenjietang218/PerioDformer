nohup: ignoring input
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03554582595825195 GB
Epoch: 1 cost time: 2.412367105484009
Epoch: 1, Steps: 64 | Train Loss: 1.1543644 Vali Loss: 3.1991007 Test Loss: 5.7212415
Validation loss decreased (inf --> 3.199101).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 2 cost time: 0.8716263771057129
Epoch: 2, Steps: 64 | Train Loss: 0.9820300 Vali Loss: 2.2705922 Test Loss: 3.9536765
Validation loss decreased (3.199101 --> 2.270592).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 3 cost time: 0.8614892959594727
Epoch: 3, Steps: 64 | Train Loss: 0.7202260 Vali Loss: 1.6230940 Test Loss: 2.7137921
Validation loss decreased (2.270592 --> 1.623094).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 4 cost time: 0.8744449615478516
Epoch: 4, Steps: 64 | Train Loss: 0.5243710 Vali Loss: 1.1682402 Test Loss: 1.8528148
Validation loss decreased (1.623094 --> 1.168240).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 5 cost time: 0.8726344108581543
Epoch: 5, Steps: 64 | Train Loss: 0.3947171 Vali Loss: 0.8918890 Test Loss: 1.3524934
Validation loss decreased (1.168240 --> 0.891889).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 6 cost time: 0.8316349983215332
Epoch: 6, Steps: 64 | Train Loss: 0.3160576 Vali Loss: 0.7215388 Test Loss: 1.0364056
Validation loss decreased (0.891889 --> 0.721539).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 7 cost time: 0.8683741092681885
Epoch: 7, Steps: 64 | Train Loss: 0.2698879 Vali Loss: 0.6211936 Test Loss: 0.8485051
Validation loss decreased (0.721539 --> 0.621194).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 8 cost time: 0.8473646640777588
Epoch: 8, Steps: 64 | Train Loss: 0.2413799 Vali Loss: 0.5515238 Test Loss: 0.7308215
Validation loss decreased (0.621194 --> 0.551524).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 9 cost time: 0.8440594673156738
Epoch: 9, Steps: 64 | Train Loss: 0.2197574 Vali Loss: 0.5014749 Test Loss: 0.6443291
Validation loss decreased (0.551524 --> 0.501475).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 10 cost time: 0.8365716934204102
Epoch: 10, Steps: 64 | Train Loss: 0.2042514 Vali Loss: 0.4657607 Test Loss: 0.5829080
Validation loss decreased (0.501475 --> 0.465761).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 11 cost time: 0.895625114440918
Epoch: 11, Steps: 64 | Train Loss: 0.1932916 Vali Loss: 0.4317083 Test Loss: 0.5324084
Validation loss decreased (0.465761 --> 0.431708).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 12 cost time: 0.8794338703155518
Epoch: 12, Steps: 64 | Train Loss: 0.1834040 Vali Loss: 0.4101858 Test Loss: 0.4987423
Validation loss decreased (0.431708 --> 0.410186).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 13 cost time: 0.8784153461456299
Epoch: 13, Steps: 64 | Train Loss: 0.1761100 Vali Loss: 0.3917405 Test Loss: 0.4682024
Validation loss decreased (0.410186 --> 0.391741).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 14 cost time: 0.8853895664215088
Epoch: 14, Steps: 64 | Train Loss: 0.1711300 Vali Loss: 0.3745696 Test Loss: 0.4474922
Validation loss decreased (0.391741 --> 0.374570).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 15 cost time: 0.8612353801727295
Epoch: 15, Steps: 64 | Train Loss: 0.1664409 Vali Loss: 0.3632763 Test Loss: 0.4295889
Validation loss decreased (0.374570 --> 0.363276).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 16 cost time: 0.8540012836456299
Epoch: 16, Steps: 64 | Train Loss: 0.1631376 Vali Loss: 0.3552309 Test Loss: 0.4177701
Validation loss decreased (0.363276 --> 0.355231).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 17 cost time: 0.8566186428070068
Epoch: 17, Steps: 64 | Train Loss: 0.1582791 Vali Loss: 0.3463859 Test Loss: 0.4032997
Validation loss decreased (0.355231 --> 0.346386).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 18 cost time: 0.8639998435974121
Epoch: 18, Steps: 64 | Train Loss: 0.1562112 Vali Loss: 0.3374450 Test Loss: 0.3951555
Validation loss decreased (0.346386 --> 0.337445).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 19 cost time: 0.8680014610290527
Epoch: 19, Steps: 64 | Train Loss: 0.1533684 Vali Loss: 0.3333037 Test Loss: 0.3871283
Validation loss decreased (0.337445 --> 0.333304).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 20 cost time: 0.8807635307312012
Epoch: 20, Steps: 64 | Train Loss: 0.1515153 Vali Loss: 0.3276612 Test Loss: 0.3787207
Validation loss decreased (0.333304 --> 0.327661).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 21 cost time: 0.8670005798339844
Epoch: 21, Steps: 64 | Train Loss: 0.1504317 Vali Loss: 0.3230940 Test Loss: 0.3759849
Validation loss decreased (0.327661 --> 0.323094).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 22 cost time: 0.8763484954833984
Epoch: 22, Steps: 64 | Train Loss: 0.1485271 Vali Loss: 0.3141820 Test Loss: 0.3690610
Validation loss decreased (0.323094 --> 0.314182).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 23 cost time: 0.849625825881958
Epoch: 23, Steps: 64 | Train Loss: 0.1470323 Vali Loss: 0.3171106 Test Loss: 0.3625130
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 24 cost time: 0.8430814743041992
Epoch: 24, Steps: 64 | Train Loss: 0.1458752 Vali Loss: 0.3118423 Test Loss: 0.3586139
Validation loss decreased (0.314182 --> 0.311842).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 25 cost time: 0.8267865180969238
Epoch: 25, Steps: 64 | Train Loss: 0.1442656 Vali Loss: 0.3096195 Test Loss: 0.3594917
Validation loss decreased (0.311842 --> 0.309619).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 26 cost time: 0.828179121017456
Epoch: 26, Steps: 64 | Train Loss: 0.1437842 Vali Loss: 0.3043351 Test Loss: 0.3569973
Validation loss decreased (0.309619 --> 0.304335).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 27 cost time: 0.8296372890472412
Epoch: 27, Steps: 64 | Train Loss: 0.1431275 Vali Loss: 0.3087583 Test Loss: 0.3521397
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 28 cost time: 0.8233792781829834
Epoch: 28, Steps: 64 | Train Loss: 0.1426153 Vali Loss: 0.3045315 Test Loss: 0.3515487
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 29 cost time: 0.8549745082855225
Epoch: 29, Steps: 64 | Train Loss: 0.1413485 Vali Loss: 0.3020138 Test Loss: 0.3489776
Validation loss decreased (0.304335 --> 0.302014).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 30 cost time: 0.8389990329742432
Epoch: 30, Steps: 64 | Train Loss: 0.1403729 Vali Loss: 0.3031759 Test Loss: 0.3471904
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 31 cost time: 0.8765964508056641
Epoch: 31, Steps: 64 | Train Loss: 0.1400568 Vali Loss: 0.2986372 Test Loss: 0.3440560
Validation loss decreased (0.302014 --> 0.298637).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 32 cost time: 0.8733940124511719
Epoch: 32, Steps: 64 | Train Loss: 0.1398950 Vali Loss: 0.2954691 Test Loss: 0.3441277
Validation loss decreased (0.298637 --> 0.295469).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 33 cost time: 0.8890364170074463
Epoch: 33, Steps: 64 | Train Loss: 0.1405502 Vali Loss: 0.2958393 Test Loss: 0.3432246
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 34 cost time: 0.8564229011535645
Epoch: 34, Steps: 64 | Train Loss: 0.1396086 Vali Loss: 0.2990474 Test Loss: 0.3443570
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 35 cost time: 0.8668217658996582
Epoch: 35, Steps: 64 | Train Loss: 0.1399651 Vali Loss: 0.2934820 Test Loss: 0.3408743
Validation loss decreased (0.295469 --> 0.293482).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 36 cost time: 0.8575758934020996
Epoch: 36, Steps: 64 | Train Loss: 0.1397986 Vali Loss: 0.2984462 Test Loss: 0.3386476
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 37 cost time: 0.8623619079589844
Epoch: 37, Steps: 64 | Train Loss: 0.1383671 Vali Loss: 0.2989945 Test Loss: 0.3388062
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 38 cost time: 0.8631529808044434
Epoch: 38, Steps: 64 | Train Loss: 0.1384957 Vali Loss: 0.2953866 Test Loss: 0.3409117
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 39 cost time: 0.8727431297302246
Epoch: 39, Steps: 64 | Train Loss: 0.1383123 Vali Loss: 0.2938899 Test Loss: 0.3367711
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 40 cost time: 0.8778350353240967
Epoch: 40, Steps: 64 | Train Loss: 0.1377613 Vali Loss: 0.2940413 Test Loss: 0.3383716
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 41 cost time: 0.8920016288757324
Epoch: 41, Steps: 64 | Train Loss: 0.1373595 Vali Loss: 0.2926972 Test Loss: 0.3369527
Validation loss decreased (0.293482 --> 0.292697).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 42 cost time: 0.8750839233398438
Epoch: 42, Steps: 64 | Train Loss: 0.1370735 Vali Loss: 0.2912028 Test Loss: 0.3347201
Validation loss decreased (0.292697 --> 0.291203).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 43 cost time: 0.8546502590179443
Epoch: 43, Steps: 64 | Train Loss: 0.1368122 Vali Loss: 0.2953267 Test Loss: 0.3377122
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 44 cost time: 0.820441722869873
Epoch: 44, Steps: 64 | Train Loss: 0.1372928 Vali Loss: 0.2934340 Test Loss: 0.3364332
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 45 cost time: 0.8189997673034668
Epoch: 45, Steps: 64 | Train Loss: 0.1363921 Vali Loss: 0.2921964 Test Loss: 0.3367800
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 46 cost time: 0.8220009803771973
Epoch: 46, Steps: 64 | Train Loss: 0.1371971 Vali Loss: 0.2956270 Test Loss: 0.3339969
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 47 cost time: 0.8210411071777344
Epoch: 47, Steps: 64 | Train Loss: 0.1365761 Vali Loss: 0.2904746 Test Loss: 0.3326544
Validation loss decreased (0.291203 --> 0.290475).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 48 cost time: 0.8554041385650635
Epoch: 48, Steps: 64 | Train Loss: 0.1360499 Vali Loss: 0.2938550 Test Loss: 0.3349753
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 49 cost time: 0.8457846641540527
Epoch: 49, Steps: 64 | Train Loss: 0.1370230 Vali Loss: 0.2922074 Test Loss: 0.3333532
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 50 cost time: 0.8449983596801758
Epoch: 50, Steps: 64 | Train Loss: 0.1368491 Vali Loss: 0.2927523 Test Loss: 0.3364004
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 51 cost time: 0.8288702964782715
Epoch: 51, Steps: 64 | Train Loss: 0.1365671 Vali Loss: 0.2910008 Test Loss: 0.3324929
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 52 cost time: 0.8666181564331055
Epoch: 52, Steps: 64 | Train Loss: 0.1366946 Vali Loss: 0.2883623 Test Loss: 0.3355312
Validation loss decreased (0.290475 --> 0.288362).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 53 cost time: 0.8161029815673828
Epoch: 53, Steps: 64 | Train Loss: 0.1369866 Vali Loss: 0.2925101 Test Loss: 0.3344000
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 54 cost time: 0.8454506397247314
Epoch: 54, Steps: 64 | Train Loss: 0.1365640 Vali Loss: 0.2900811 Test Loss: 0.3311813
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 55 cost time: 0.8599953651428223
Epoch: 55, Steps: 64 | Train Loss: 0.1362104 Vali Loss: 0.2895581 Test Loss: 0.3353512
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 56 cost time: 0.8535699844360352
Epoch: 56, Steps: 64 | Train Loss: 0.1354645 Vali Loss: 0.2908595 Test Loss: 0.3336723
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 57 cost time: 0.8585240840911865
Epoch: 57, Steps: 64 | Train Loss: 0.1368410 Vali Loss: 0.2914234 Test Loss: 0.3320952
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 58 cost time: 0.8614447116851807
Epoch: 58, Steps: 64 | Train Loss: 0.1360799 Vali Loss: 0.2895913 Test Loss: 0.3329471
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 59 cost time: 0.8553361892700195
Epoch: 59, Steps: 64 | Train Loss: 0.1364919 Vali Loss: 0.2933497 Test Loss: 0.3334800
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 60 cost time: 0.8729996681213379
Epoch: 60, Steps: 64 | Train Loss: 0.1356080 Vali Loss: 0.2912900 Test Loss: 0.3353818
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.33553117513656616, mae:0.39419838786125183, rse:0.26585158705711365
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.03624725341796875 GB
Epoch: 1 cost time: 2.3188493251800537
Epoch: 1, Steps: 64 | Train Loss: 1.0848802 Vali Loss: 3.2185516 Test Loss: 5.7571359
Validation loss decreased (inf --> 3.218552).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 2 cost time: 0.9351308345794678
Epoch: 2, Steps: 64 | Train Loss: 0.8797310 Vali Loss: 2.1099241 Test Loss: 3.6421959
Validation loss decreased (3.218552 --> 2.109924).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 3 cost time: 0.931959867477417
Epoch: 3, Steps: 64 | Train Loss: 0.5835991 Vali Loss: 1.3786201 Test Loss: 2.2705791
Validation loss decreased (2.109924 --> 1.378620).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 4 cost time: 0.9373776912689209
Epoch: 4, Steps: 64 | Train Loss: 0.3808249 Vali Loss: 0.8629680 Test Loss: 1.2935477
Validation loss decreased (1.378620 --> 0.862968).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 5 cost time: 0.9358475208282471
Epoch: 5, Steps: 64 | Train Loss: 0.2562147 Vali Loss: 0.5977948 Test Loss: 0.7881311
Validation loss decreased (0.862968 --> 0.597795).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 6 cost time: 0.9290463924407959
Epoch: 6, Steps: 64 | Train Loss: 0.1936550 Vali Loss: 0.4610171 Test Loss: 0.5403032
Validation loss decreased (0.597795 --> 0.461017).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 7 cost time: 0.9351863861083984
Epoch: 7, Steps: 64 | Train Loss: 0.1629251 Vali Loss: 0.3969091 Test Loss: 0.4294488
Validation loss decreased (0.461017 --> 0.396909).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 8 cost time: 0.9279999732971191
Epoch: 8, Steps: 64 | Train Loss: 0.1489453 Vali Loss: 0.3596299 Test Loss: 0.3734093
Validation loss decreased (0.396909 --> 0.359630).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 9 cost time: 0.9276232719421387
Epoch: 9, Steps: 64 | Train Loss: 0.1399298 Vali Loss: 0.3424759 Test Loss: 0.3508753
Validation loss decreased (0.359630 --> 0.342476).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 10 cost time: 0.9366359710693359
Epoch: 10, Steps: 64 | Train Loss: 0.1345155 Vali Loss: 0.3255776 Test Loss: 0.3355020
Validation loss decreased (0.342476 --> 0.325578).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 11 cost time: 0.9350316524505615
Epoch: 11, Steps: 64 | Train Loss: 0.1298069 Vali Loss: 0.3167735 Test Loss: 0.3262128
Validation loss decreased (0.325578 --> 0.316774).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 12 cost time: 0.9414098262786865
Epoch: 12, Steps: 64 | Train Loss: 0.1274773 Vali Loss: 0.3074130 Test Loss: 0.3223034
Validation loss decreased (0.316774 --> 0.307413).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 13 cost time: 0.9432432651519775
Epoch: 13, Steps: 64 | Train Loss: 0.1251930 Vali Loss: 0.3045036 Test Loss: 0.3185429
Validation loss decreased (0.307413 --> 0.304504).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 14 cost time: 0.932870626449585
Epoch: 14, Steps: 64 | Train Loss: 0.1232051 Vali Loss: 0.2996125 Test Loss: 0.3181485
Validation loss decreased (0.304504 --> 0.299613).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 15 cost time: 0.9275197982788086
Epoch: 15, Steps: 64 | Train Loss: 0.1220628 Vali Loss: 0.2948181 Test Loss: 0.3154265
Validation loss decreased (0.299613 --> 0.294818).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 16 cost time: 0.935999870300293
Epoch: 16, Steps: 64 | Train Loss: 0.1206902 Vali Loss: 0.2932879 Test Loss: 0.3131072
Validation loss decreased (0.294818 --> 0.293288).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 17 cost time: 0.9444456100463867
Epoch: 17, Steps: 64 | Train Loss: 0.1190725 Vali Loss: 0.2958367 Test Loss: 0.3136783
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 18 cost time: 0.9322664737701416
Epoch: 18, Steps: 64 | Train Loss: 0.1181540 Vali Loss: 0.2903878 Test Loss: 0.3124194
Validation loss decreased (0.293288 --> 0.290388).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 19 cost time: 0.9314179420471191
Epoch: 19, Steps: 64 | Train Loss: 0.1170677 Vali Loss: 0.2874574 Test Loss: 0.3096465
Validation loss decreased (0.290388 --> 0.287457).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 20 cost time: 0.9496643543243408
Epoch: 20, Steps: 64 | Train Loss: 0.1163590 Vali Loss: 0.2837632 Test Loss: 0.3107160
Validation loss decreased (0.287457 --> 0.283763).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 21 cost time: 0.9373888969421387
Epoch: 21, Steps: 64 | Train Loss: 0.1161540 Vali Loss: 0.2822224 Test Loss: 0.3099776
Validation loss decreased (0.283763 --> 0.282222).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 22 cost time: 0.9337685108184814
Epoch: 22, Steps: 64 | Train Loss: 0.1147952 Vali Loss: 0.2839447 Test Loss: 0.3104024
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 23 cost time: 0.9320001602172852
Epoch: 23, Steps: 64 | Train Loss: 0.1138717 Vali Loss: 0.2800302 Test Loss: 0.3094570
Validation loss decreased (0.282222 --> 0.280030).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 24 cost time: 0.9384965896606445
Epoch: 24, Steps: 64 | Train Loss: 0.1132006 Vali Loss: 0.2811794 Test Loss: 0.3095701
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 25 cost time: 0.9357590675354004
Epoch: 25, Steps: 64 | Train Loss: 0.1126168 Vali Loss: 0.2765032 Test Loss: 0.3103702
Validation loss decreased (0.280030 --> 0.276503).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 26 cost time: 0.9314043521881104
Epoch: 26, Steps: 64 | Train Loss: 0.1125714 Vali Loss: 0.2787166 Test Loss: 0.3094259
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 27 cost time: 0.9344933032989502
Epoch: 27, Steps: 64 | Train Loss: 0.1127492 Vali Loss: 0.2787454 Test Loss: 0.3105072
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 28 cost time: 0.9474246501922607
Epoch: 28, Steps: 64 | Train Loss: 0.1120020 Vali Loss: 0.2747935 Test Loss: 0.3084173
Validation loss decreased (0.276503 --> 0.274794).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 29 cost time: 0.9314320087432861
Epoch: 29, Steps: 64 | Train Loss: 0.1120095 Vali Loss: 0.2783237 Test Loss: 0.3096987
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 30 cost time: 0.9304139614105225
Epoch: 30, Steps: 64 | Train Loss: 0.1115131 Vali Loss: 0.2771385 Test Loss: 0.3090307
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 31 cost time: 0.939000129699707
Epoch: 31, Steps: 64 | Train Loss: 0.1109814 Vali Loss: 0.2788098 Test Loss: 0.3099362
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 32 cost time: 0.9356272220611572
Epoch: 32, Steps: 64 | Train Loss: 0.1105829 Vali Loss: 0.2751768 Test Loss: 0.3086147
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 33 cost time: 0.9278783798217773
Epoch: 33, Steps: 64 | Train Loss: 0.1114085 Vali Loss: 0.2730067 Test Loss: 0.3091163
Validation loss decreased (0.274794 --> 0.273007).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 34 cost time: 0.9413299560546875
Epoch: 34, Steps: 64 | Train Loss: 0.1108373 Vali Loss: 0.2768958 Test Loss: 0.3104573
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 35 cost time: 0.9343912601470947
Epoch: 35, Steps: 64 | Train Loss: 0.1100661 Vali Loss: 0.2743832 Test Loss: 0.3089665
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 36 cost time: 0.9319348335266113
Epoch: 36, Steps: 64 | Train Loss: 0.1102912 Vali Loss: 0.2759294 Test Loss: 0.3100466
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 37 cost time: 0.9337766170501709
Epoch: 37, Steps: 64 | Train Loss: 0.1101111 Vali Loss: 0.2756275 Test Loss: 0.3108434
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 38 cost time: 0.9294986724853516
Epoch: 38, Steps: 64 | Train Loss: 0.1099866 Vali Loss: 0.2712356 Test Loss: 0.3085691
Validation loss decreased (0.273007 --> 0.271236).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 39 cost time: 0.9296257495880127
Epoch: 39, Steps: 64 | Train Loss: 0.1092648 Vali Loss: 0.2694265 Test Loss: 0.3097108
Validation loss decreased (0.271236 --> 0.269426).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 40 cost time: 0.9338068962097168
Epoch: 40, Steps: 64 | Train Loss: 0.1093635 Vali Loss: 0.2731846 Test Loss: 0.3088473
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 41 cost time: 0.927377462387085
Epoch: 41, Steps: 64 | Train Loss: 0.1093739 Vali Loss: 0.2746882 Test Loss: 0.3078021
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 42 cost time: 0.9303698539733887
Epoch: 42, Steps: 64 | Train Loss: 0.1090841 Vali Loss: 0.2745434 Test Loss: 0.3107020
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 43 cost time: 0.9290387630462646
Epoch: 43, Steps: 64 | Train Loss: 0.1087690 Vali Loss: 0.2702527 Test Loss: 0.3078164
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 44 cost time: 0.9267716407775879
Epoch: 44, Steps: 64 | Train Loss: 0.1095624 Vali Loss: 0.2729957 Test Loss: 0.3090007
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 45 cost time: 0.9179999828338623
Epoch: 45, Steps: 64 | Train Loss: 0.1090876 Vali Loss: 0.2736710 Test Loss: 0.3079349
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 46 cost time: 0.9336259365081787
Epoch: 46, Steps: 64 | Train Loss: 0.1089038 Vali Loss: 0.2725236 Test Loss: 0.3089395
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 47 cost time: 0.9292473793029785
Epoch: 47, Steps: 64 | Train Loss: 0.1092615 Vali Loss: 0.2730100 Test Loss: 0.3084600
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 48 cost time: 0.9353775978088379
Epoch: 48, Steps: 64 | Train Loss: 0.1089087 Vali Loss: 0.2694367 Test Loss: 0.3081219
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 49 cost time: 0.9058644771575928
Epoch: 49, Steps: 64 | Train Loss: 0.1092511 Vali Loss: 0.2753503 Test Loss: 0.3086093
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 50 cost time: 0.9755291938781738
Epoch: 50, Steps: 64 | Train Loss: 0.1089123 Vali Loss: 0.2705995 Test Loss: 0.3086303
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 51 cost time: 0.9543933868408203
Epoch: 51, Steps: 64 | Train Loss: 0.1085899 Vali Loss: 0.2724869 Test Loss: 0.3082893
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 52 cost time: 0.9537773132324219
Epoch: 52, Steps: 64 | Train Loss: 0.1093380 Vali Loss: 0.2714050 Test Loss: 0.3095084
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 53 cost time: 0.9341144561767578
Epoch: 53, Steps: 64 | Train Loss: 0.1089486 Vali Loss: 0.2687614 Test Loss: 0.3093569
Validation loss decreased (0.269426 --> 0.268761).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 54 cost time: 0.9376273155212402
Epoch: 54, Steps: 64 | Train Loss: 0.1085056 Vali Loss: 0.2702531 Test Loss: 0.3093059
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 55 cost time: 0.9404346942901611
Epoch: 55, Steps: 64 | Train Loss: 0.1085664 Vali Loss: 0.2683196 Test Loss: 0.3086086
Validation loss decreased (0.268761 --> 0.268320).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 56 cost time: 0.9346523284912109
Epoch: 56, Steps: 64 | Train Loss: 0.1085722 Vali Loss: 0.2728702 Test Loss: 0.3087846
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 57 cost time: 0.9344081878662109
Epoch: 57, Steps: 64 | Train Loss: 0.1092718 Vali Loss: 0.2685892 Test Loss: 0.3080711
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 58 cost time: 0.9424111843109131
Epoch: 58, Steps: 64 | Train Loss: 0.1090923 Vali Loss: 0.2741534 Test Loss: 0.3095725
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 59 cost time: 0.9318397045135498
Epoch: 59, Steps: 64 | Train Loss: 0.1084740 Vali Loss: 0.2748094 Test Loss: 0.3092223
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 60 cost time: 0.9346234798431396
Epoch: 60, Steps: 64 | Train Loss: 0.1090852 Vali Loss: 0.2732601 Test Loss: 0.3095072
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.3086085915565491, mae:0.3798583149909973, rse:0.2549628019332886
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03681135177612305 GB
Epoch: 1 cost time: 2.3609907627105713
Epoch: 1, Steps: 64 | Train Loss: 0.8849538 Vali Loss: 2.7184248 Test Loss: 4.8553748
Validation loss decreased (inf --> 2.718425).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 2 cost time: 0.9746198654174805
Epoch: 2, Steps: 64 | Train Loss: 0.7571409 Vali Loss: 1.9647338 Test Loss: 3.4116883
Validation loss decreased (2.718425 --> 1.964734).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 3 cost time: 0.9776244163513184
Epoch: 3, Steps: 64 | Train Loss: 0.5277417 Vali Loss: 1.2541313 Test Loss: 2.0634608
Validation loss decreased (1.964734 --> 1.254131).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 4 cost time: 0.9770867824554443
Epoch: 4, Steps: 64 | Train Loss: 0.3247377 Vali Loss: 0.6786145 Test Loss: 0.9964454
Validation loss decreased (1.254131 --> 0.678614).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 5 cost time: 0.9753847122192383
Epoch: 5, Steps: 64 | Train Loss: 0.1978527 Vali Loss: 0.4364147 Test Loss: 0.5439887
Validation loss decreased (0.678614 --> 0.436415).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 6 cost time: 0.9753556251525879
Epoch: 6, Steps: 64 | Train Loss: 0.1508312 Vali Loss: 0.3485486 Test Loss: 0.4032619
Validation loss decreased (0.436415 --> 0.348549).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 7 cost time: 0.9775130748748779
Epoch: 7, Steps: 64 | Train Loss: 0.1342235 Vali Loss: 0.3115687 Test Loss: 0.3601411
Validation loss decreased (0.348549 --> 0.311569).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 8 cost time: 0.9713728427886963
Epoch: 8, Steps: 64 | Train Loss: 0.1269922 Vali Loss: 0.2932132 Test Loss: 0.3389919
Validation loss decreased (0.311569 --> 0.293213).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 9 cost time: 0.9758269786834717
Epoch: 9, Steps: 64 | Train Loss: 0.1219558 Vali Loss: 0.2863338 Test Loss: 0.3304802
Validation loss decreased (0.293213 --> 0.286334).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 10 cost time: 0.9797794818878174
Epoch: 10, Steps: 64 | Train Loss: 0.1179081 Vali Loss: 0.2733999 Test Loss: 0.3243237
Validation loss decreased (0.286334 --> 0.273400).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 11 cost time: 0.9787940979003906
Epoch: 11, Steps: 64 | Train Loss: 0.1161299 Vali Loss: 0.2717946 Test Loss: 0.3204691
Validation loss decreased (0.273400 --> 0.271795).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 12 cost time: 0.9875762462615967
Epoch: 12, Steps: 64 | Train Loss: 0.1133730 Vali Loss: 0.2673033 Test Loss: 0.3192726
Validation loss decreased (0.271795 --> 0.267303).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 13 cost time: 0.9849364757537842
Epoch: 13, Steps: 64 | Train Loss: 0.1113659 Vali Loss: 0.2576501 Test Loss: 0.3166977
Validation loss decreased (0.267303 --> 0.257650).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 14 cost time: 0.9766051769256592
Epoch: 14, Steps: 64 | Train Loss: 0.1109653 Vali Loss: 0.2634814 Test Loss: 0.3150114
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 15 cost time: 0.9784247875213623
Epoch: 15, Steps: 64 | Train Loss: 0.1088775 Vali Loss: 0.2597198 Test Loss: 0.3152085
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 16 cost time: 0.9713151454925537
Epoch: 16, Steps: 64 | Train Loss: 0.1077132 Vali Loss: 0.2577618 Test Loss: 0.3119280
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 17 cost time: 0.9723248481750488
Epoch: 17, Steps: 64 | Train Loss: 0.1072443 Vali Loss: 0.2568719 Test Loss: 0.3119355
Validation loss decreased (0.257650 --> 0.256872).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 18 cost time: 0.9843807220458984
Epoch: 18, Steps: 64 | Train Loss: 0.1069140 Vali Loss: 0.2549436 Test Loss: 0.3104250
Validation loss decreased (0.256872 --> 0.254944).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 19 cost time: 0.9764151573181152
Epoch: 19, Steps: 64 | Train Loss: 0.1061821 Vali Loss: 0.2585978 Test Loss: 0.3111508
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 20 cost time: 0.9794936180114746
Epoch: 20, Steps: 64 | Train Loss: 0.1050318 Vali Loss: 0.2530295 Test Loss: 0.3105187
Validation loss decreased (0.254944 --> 0.253029).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 21 cost time: 0.9871964454650879
Epoch: 21, Steps: 64 | Train Loss: 0.1055376 Vali Loss: 0.2554887 Test Loss: 0.3125857
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 22 cost time: 0.9767944812774658
Epoch: 22, Steps: 64 | Train Loss: 0.1044934 Vali Loss: 0.2533780 Test Loss: 0.3110612
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 23 cost time: 0.9709997177124023
Epoch: 23, Steps: 64 | Train Loss: 0.1040703 Vali Loss: 0.2508784 Test Loss: 0.3099847
Validation loss decreased (0.253029 --> 0.250878).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 24 cost time: 0.978600263595581
Epoch: 24, Steps: 64 | Train Loss: 0.1034333 Vali Loss: 0.2523167 Test Loss: 0.3090596
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 25 cost time: 0.9686679840087891
Epoch: 25, Steps: 64 | Train Loss: 0.1033938 Vali Loss: 0.2530862 Test Loss: 0.3109857
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 26 cost time: 0.9754016399383545
Epoch: 26, Steps: 64 | Train Loss: 0.1025944 Vali Loss: 0.2515796 Test Loss: 0.3076149
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 27 cost time: 0.9773128032684326
Epoch: 27, Steps: 64 | Train Loss: 0.1026053 Vali Loss: 0.2527159 Test Loss: 0.3090238
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 28 cost time: 0.9833571910858154
Epoch: 28, Steps: 64 | Train Loss: 0.1023863 Vali Loss: 0.2538456 Test Loss: 0.3099944
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 29 cost time: 0.9763739109039307
Epoch: 29, Steps: 64 | Train Loss: 0.1019443 Vali Loss: 0.2515309 Test Loss: 0.3091897
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 30 cost time: 0.9803886413574219
Epoch: 30, Steps: 64 | Train Loss: 0.1023522 Vali Loss: 0.2498821 Test Loss: 0.3097075
Validation loss decreased (0.250878 --> 0.249882).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 31 cost time: 0.9863646030426025
Epoch: 31, Steps: 64 | Train Loss: 0.1015841 Vali Loss: 0.2478111 Test Loss: 0.3095562
Validation loss decreased (0.249882 --> 0.247811).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 32 cost time: 0.963761568069458
Epoch: 32, Steps: 64 | Train Loss: 0.1015114 Vali Loss: 0.2491641 Test Loss: 0.3082136
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 33 cost time: 0.9780359268188477
Epoch: 33, Steps: 64 | Train Loss: 0.1018047 Vali Loss: 0.2508621 Test Loss: 0.3086826
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 34 cost time: 0.9766061305999756
Epoch: 34, Steps: 64 | Train Loss: 0.1007934 Vali Loss: 0.2494332 Test Loss: 0.3086868
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 35 cost time: 0.9816126823425293
Epoch: 35, Steps: 64 | Train Loss: 0.1013829 Vali Loss: 0.2489444 Test Loss: 0.3076847
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 36 cost time: 0.9863638877868652
Epoch: 36, Steps: 64 | Train Loss: 0.1016045 Vali Loss: 0.2513971 Test Loss: 0.3082989
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 37 cost time: 0.980830192565918
Epoch: 37, Steps: 64 | Train Loss: 0.1015117 Vali Loss: 0.2444742 Test Loss: 0.3087875
Validation loss decreased (0.247811 --> 0.244474).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 38 cost time: 0.9863338470458984
Epoch: 38, Steps: 64 | Train Loss: 0.1010717 Vali Loss: 0.2499463 Test Loss: 0.3078131
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 39 cost time: 0.9813635349273682
Epoch: 39, Steps: 64 | Train Loss: 0.1007599 Vali Loss: 0.2494672 Test Loss: 0.3064478
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 40 cost time: 0.9763269424438477
Epoch: 40, Steps: 64 | Train Loss: 0.1009520 Vali Loss: 0.2499110 Test Loss: 0.3073870
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 41 cost time: 0.9747052192687988
Epoch: 41, Steps: 64 | Train Loss: 0.1010234 Vali Loss: 0.2487305 Test Loss: 0.3084342
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 42 cost time: 0.9727435111999512
Epoch: 42, Steps: 64 | Train Loss: 0.1011365 Vali Loss: 0.2508657 Test Loss: 0.3077354
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 43 cost time: 0.9709997177124023
Epoch: 43, Steps: 64 | Train Loss: 0.1004790 Vali Loss: 0.2451330 Test Loss: 0.3083649
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 44 cost time: 0.9809999465942383
Epoch: 44, Steps: 64 | Train Loss: 0.1008520 Vali Loss: 0.2476509 Test Loss: 0.3079084
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 45 cost time: 0.9443991184234619
Epoch: 45, Steps: 64 | Train Loss: 0.1006799 Vali Loss: 0.2487528 Test Loss: 0.3075842
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 46 cost time: 0.9493498802185059
Epoch: 46, Steps: 64 | Train Loss: 0.1006266 Vali Loss: 0.2478977 Test Loss: 0.3085333
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 47 cost time: 0.9633371829986572
Epoch: 47, Steps: 64 | Train Loss: 0.1005238 Vali Loss: 0.2473376 Test Loss: 0.3070510
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 48 cost time: 0.9813234806060791
Epoch: 48, Steps: 64 | Train Loss: 0.1002927 Vali Loss: 0.2477633 Test Loss: 0.3080347
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 49 cost time: 0.9704165458679199
Epoch: 49, Steps: 64 | Train Loss: 0.1006973 Vali Loss: 0.2489603 Test Loss: 0.3096224
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 50 cost time: 0.9739995002746582
Epoch: 50, Steps: 64 | Train Loss: 0.1000433 Vali Loss: 0.2477225 Test Loss: 0.3077239
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 51 cost time: 0.9814035892486572
Epoch: 51, Steps: 64 | Train Loss: 0.1007981 Vali Loss: 0.2503124 Test Loss: 0.3083932
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 52 cost time: 0.9707651138305664
Epoch: 52, Steps: 64 | Train Loss: 0.0998166 Vali Loss: 0.2464729 Test Loss: 0.3068764
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 53 cost time: 0.9849996566772461
Epoch: 53, Steps: 64 | Train Loss: 0.1005064 Vali Loss: 0.2509453 Test Loss: 0.3067813
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 54 cost time: 0.9825954437255859
Epoch: 54, Steps: 64 | Train Loss: 0.1003446 Vali Loss: 0.2502288 Test Loss: 0.3076273
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 55 cost time: 0.9756054878234863
Epoch: 55, Steps: 64 | Train Loss: 0.1001308 Vali Loss: 0.2492801 Test Loss: 0.3085619
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 56 cost time: 0.9773967266082764
Epoch: 56, Steps: 64 | Train Loss: 0.1001849 Vali Loss: 0.2474585 Test Loss: 0.3072913
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 57 cost time: 0.9793381690979004
Epoch: 57, Steps: 64 | Train Loss: 0.1001769 Vali Loss: 0.2482224 Test Loss: 0.3076065
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 58 cost time: 0.9729330539703369
Epoch: 58, Steps: 64 | Train Loss: 0.1002293 Vali Loss: 0.2484761 Test Loss: 0.3074855
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 59 cost time: 0.9733109474182129
Epoch: 59, Steps: 64 | Train Loss: 0.1005267 Vali Loss: 0.2495226 Test Loss: 0.3086641
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 60 cost time: 0.9734063148498535
Epoch: 60, Steps: 64 | Train Loss: 0.1001573 Vali Loss: 0.2478606 Test Loss: 0.3063902
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.3087875247001648, mae:0.37432268261909485, rse:0.25503668189048767
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03570699691772461 GB
Epoch: 1 cost time: 2.2573578357696533
Epoch: 1, Steps: 64 | Train Loss: 1.2153408 Vali Loss: 3.4082935 Test Loss: 6.0541792
Validation loss decreased (inf --> 3.408293).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 2 cost time: 0.8260476589202881
Epoch: 2, Steps: 64 | Train Loss: 0.9784731 Vali Loss: 2.1663549 Test Loss: 3.7521472
Validation loss decreased (3.408293 --> 2.166355).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 3 cost time: 0.8496310710906982
Epoch: 3, Steps: 64 | Train Loss: 0.6619994 Vali Loss: 1.4140806 Test Loss: 2.3197246
Validation loss decreased (2.166355 --> 1.414081).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 4 cost time: 0.8504316806793213
Epoch: 4, Steps: 64 | Train Loss: 0.4369402 Vali Loss: 0.9588432 Test Loss: 1.4821163
Validation loss decreased (1.414081 --> 0.958843).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 5 cost time: 0.8474056720733643
Epoch: 5, Steps: 64 | Train Loss: 0.3340012 Vali Loss: 0.7764770 Test Loss: 1.1582205
Validation loss decreased (0.958843 --> 0.776477).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 6 cost time: 0.8097612857818604
Epoch: 6, Steps: 64 | Train Loss: 0.2775338 Vali Loss: 0.6552637 Test Loss: 0.9537022
Validation loss decreased (0.776477 --> 0.655264).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 7 cost time: 0.8417618274688721
Epoch: 7, Steps: 64 | Train Loss: 0.2392776 Vali Loss: 0.5730799 Test Loss: 0.8203137
Validation loss decreased (0.655264 --> 0.573080).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 8 cost time: 0.847630500793457
Epoch: 8, Steps: 64 | Train Loss: 0.2151323 Vali Loss: 0.5115326 Test Loss: 0.7229111
Validation loss decreased (0.573080 --> 0.511533).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 9 cost time: 0.8544201850891113
Epoch: 9, Steps: 64 | Train Loss: 0.1948903 Vali Loss: 0.4523060 Test Loss: 0.6461692
Validation loss decreased (0.511533 --> 0.452306).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 10 cost time: 0.8453898429870605
Epoch: 10, Steps: 64 | Train Loss: 0.1824600 Vali Loss: 0.4254894 Test Loss: 0.5882584
Validation loss decreased (0.452306 --> 0.425489).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 11 cost time: 0.8498361110687256
Epoch: 11, Steps: 64 | Train Loss: 0.1714204 Vali Loss: 0.3907227 Test Loss: 0.5351103
Validation loss decreased (0.425489 --> 0.390723).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 12 cost time: 0.8494110107421875
Epoch: 12, Steps: 64 | Train Loss: 0.1617819 Vali Loss: 0.3724893 Test Loss: 0.5089926
Validation loss decreased (0.390723 --> 0.372489).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 13 cost time: 0.850656270980835
Epoch: 13, Steps: 64 | Train Loss: 0.1550623 Vali Loss: 0.3574172 Test Loss: 0.4837708
Validation loss decreased (0.372489 --> 0.357417).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 14 cost time: 0.8543553352355957
Epoch: 14, Steps: 64 | Train Loss: 0.1506038 Vali Loss: 0.3422506 Test Loss: 0.4568540
Validation loss decreased (0.357417 --> 0.342251).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 15 cost time: 0.8474981784820557
Epoch: 15, Steps: 64 | Train Loss: 0.1461924 Vali Loss: 0.3283205 Test Loss: 0.4400649
Validation loss decreased (0.342251 --> 0.328320).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 16 cost time: 0.8607540130615234
Epoch: 16, Steps: 64 | Train Loss: 0.1433919 Vali Loss: 0.3180524 Test Loss: 0.4268462
Validation loss decreased (0.328320 --> 0.318052).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 17 cost time: 0.84963059425354
Epoch: 17, Steps: 64 | Train Loss: 0.1400500 Vali Loss: 0.3127398 Test Loss: 0.4159902
Validation loss decreased (0.318052 --> 0.312740).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 18 cost time: 0.8446345329284668
Epoch: 18, Steps: 64 | Train Loss: 0.1375508 Vali Loss: 0.3053944 Test Loss: 0.4018272
Validation loss decreased (0.312740 --> 0.305394).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 19 cost time: 0.8463544845581055
Epoch: 19, Steps: 64 | Train Loss: 0.1357913 Vali Loss: 0.3001441 Test Loss: 0.3939917
Validation loss decreased (0.305394 --> 0.300144).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 20 cost time: 0.8603501319885254
Epoch: 20, Steps: 64 | Train Loss: 0.1341530 Vali Loss: 0.2992905 Test Loss: 0.3892872
Validation loss decreased (0.300144 --> 0.299290).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 21 cost time: 0.8514404296875
Epoch: 21, Steps: 64 | Train Loss: 0.1329253 Vali Loss: 0.2928663 Test Loss: 0.3853996
Validation loss decreased (0.299290 --> 0.292866).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 22 cost time: 0.8560020923614502
Epoch: 22, Steps: 64 | Train Loss: 0.1319711 Vali Loss: 0.2930067 Test Loss: 0.3819911
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 23 cost time: 0.8516285419464111
Epoch: 23, Steps: 64 | Train Loss: 0.1308249 Vali Loss: 0.2895702 Test Loss: 0.3767440
Validation loss decreased (0.292866 --> 0.289570).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 24 cost time: 0.8373546600341797
Epoch: 24, Steps: 64 | Train Loss: 0.1297132 Vali Loss: 0.2854987 Test Loss: 0.3723916
Validation loss decreased (0.289570 --> 0.285499).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 25 cost time: 0.8314676284790039
Epoch: 25, Steps: 64 | Train Loss: 0.1281833 Vali Loss: 0.2860770 Test Loss: 0.3678478
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 26 cost time: 0.8411049842834473
Epoch: 26, Steps: 64 | Train Loss: 0.1279487 Vali Loss: 0.2851965 Test Loss: 0.3677924
Validation loss decreased (0.285499 --> 0.285196).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 27 cost time: 0.8440001010894775
Epoch: 27, Steps: 64 | Train Loss: 0.1272810 Vali Loss: 0.2800341 Test Loss: 0.3635527
Validation loss decreased (0.285196 --> 0.280034).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 28 cost time: 0.8353445529937744
Epoch: 28, Steps: 64 | Train Loss: 0.1263617 Vali Loss: 0.2787150 Test Loss: 0.3616186
Validation loss decreased (0.280034 --> 0.278715).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 29 cost time: 0.8434314727783203
Epoch: 29, Steps: 64 | Train Loss: 0.1260594 Vali Loss: 0.2775892 Test Loss: 0.3591291
Validation loss decreased (0.278715 --> 0.277589).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 30 cost time: 0.8533744812011719
Epoch: 30, Steps: 64 | Train Loss: 0.1256854 Vali Loss: 0.2784730 Test Loss: 0.3553160
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 31 cost time: 0.8582019805908203
Epoch: 31, Steps: 64 | Train Loss: 0.1257628 Vali Loss: 0.2780066 Test Loss: 0.3555840
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 32 cost time: 0.8540000915527344
Epoch: 32, Steps: 64 | Train Loss: 0.1250162 Vali Loss: 0.2741513 Test Loss: 0.3553138
Validation loss decreased (0.277589 --> 0.274151).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 33 cost time: 0.8474493026733398
Epoch: 33, Steps: 64 | Train Loss: 0.1257460 Vali Loss: 0.2749975 Test Loss: 0.3516457
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 34 cost time: 0.8443915843963623
Epoch: 34, Steps: 64 | Train Loss: 0.1239769 Vali Loss: 0.2724277 Test Loss: 0.3492971
Validation loss decreased (0.274151 --> 0.272428).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 35 cost time: 0.850022554397583
Epoch: 35, Steps: 64 | Train Loss: 0.1240990 Vali Loss: 0.2710232 Test Loss: 0.3488443
Validation loss decreased (0.272428 --> 0.271023).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 36 cost time: 0.8460018634796143
Epoch: 36, Steps: 64 | Train Loss: 0.1233205 Vali Loss: 0.2717205 Test Loss: 0.3516328
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 37 cost time: 0.8486371040344238
Epoch: 37, Steps: 64 | Train Loss: 0.1235031 Vali Loss: 0.2735999 Test Loss: 0.3496790
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 38 cost time: 0.8514022827148438
Epoch: 38, Steps: 64 | Train Loss: 0.1238925 Vali Loss: 0.2702168 Test Loss: 0.3459816
Validation loss decreased (0.271023 --> 0.270217).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 39 cost time: 0.8534724712371826
Epoch: 39, Steps: 64 | Train Loss: 0.1236422 Vali Loss: 0.2697286 Test Loss: 0.3488185
Validation loss decreased (0.270217 --> 0.269729).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 40 cost time: 0.8500311374664307
Epoch: 40, Steps: 64 | Train Loss: 0.1223623 Vali Loss: 0.2647403 Test Loss: 0.3510164
Validation loss decreased (0.269729 --> 0.264740).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 41 cost time: 0.8610010147094727
Epoch: 41, Steps: 64 | Train Loss: 0.1220389 Vali Loss: 0.2695663 Test Loss: 0.3475042
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 42 cost time: 0.8436219692230225
Epoch: 42, Steps: 64 | Train Loss: 0.1234134 Vali Loss: 0.2657861 Test Loss: 0.3424416
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 43 cost time: 0.8523893356323242
Epoch: 43, Steps: 64 | Train Loss: 0.1224124 Vali Loss: 0.2723299 Test Loss: 0.3455673
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 44 cost time: 0.843458890914917
Epoch: 44, Steps: 64 | Train Loss: 0.1224278 Vali Loss: 0.2672013 Test Loss: 0.3452503
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 45 cost time: 0.8421266078948975
Epoch: 45, Steps: 64 | Train Loss: 0.1232672 Vali Loss: 0.2690141 Test Loss: 0.3442629
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 46 cost time: 0.8690016269683838
Epoch: 46, Steps: 64 | Train Loss: 0.1229095 Vali Loss: 0.2700827 Test Loss: 0.3481710
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 47 cost time: 0.8446097373962402
Epoch: 47, Steps: 64 | Train Loss: 0.1219030 Vali Loss: 0.2681156 Test Loss: 0.3465728
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 48 cost time: 0.8453688621520996
Epoch: 48, Steps: 64 | Train Loss: 0.1228265 Vali Loss: 0.2687700 Test Loss: 0.3457610
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 49 cost time: 0.8503725528717041
Epoch: 49, Steps: 64 | Train Loss: 0.1212391 Vali Loss: 0.2692878 Test Loss: 0.3426438
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 50 cost time: 0.8544108867645264
Epoch: 50, Steps: 64 | Train Loss: 0.1215227 Vali Loss: 0.2688231 Test Loss: 0.3452187
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 51 cost time: 0.8470003604888916
Epoch: 51, Steps: 64 | Train Loss: 0.1221795 Vali Loss: 0.2680174 Test Loss: 0.3430016
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 52 cost time: 0.849384069442749
Epoch: 52, Steps: 64 | Train Loss: 0.1213747 Vali Loss: 0.2675965 Test Loss: 0.3427510
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 53 cost time: 0.8474082946777344
Epoch: 53, Steps: 64 | Train Loss: 0.1222805 Vali Loss: 0.2661801 Test Loss: 0.3393096
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 54 cost time: 0.8223817348480225
Epoch: 54, Steps: 64 | Train Loss: 0.1214059 Vali Loss: 0.2678402 Test Loss: 0.3435851
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 55 cost time: 0.806999921798706
Epoch: 55, Steps: 64 | Train Loss: 0.1221663 Vali Loss: 0.2684966 Test Loss: 0.3430359
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 56 cost time: 0.8386752605438232
Epoch: 56, Steps: 64 | Train Loss: 0.1213482 Vali Loss: 0.2666613 Test Loss: 0.3428971
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 57 cost time: 0.8464865684509277
Epoch: 57, Steps: 64 | Train Loss: 0.1227751 Vali Loss: 0.2677992 Test Loss: 0.3429388
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 58 cost time: 0.8579790592193604
Epoch: 58, Steps: 64 | Train Loss: 0.1218742 Vali Loss: 0.2683845 Test Loss: 0.3447275
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 59 cost time: 0.8551456928253174
Epoch: 59, Steps: 64 | Train Loss: 0.1221526 Vali Loss: 0.2670904 Test Loss: 0.3435946
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 60 cost time: 0.8509993553161621
Epoch: 60, Steps: 64 | Train Loss: 0.1216371 Vali Loss: 0.2673563 Test Loss: 0.3450533
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.3510163724422455, mae:0.41450417041778564, rse:0.27191707491874695
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.036408424377441406 GB
Epoch: 1 cost time: 2.317845106124878
Epoch: 1, Steps: 64 | Train Loss: 0.9045847 Vali Loss: 2.7425208 Test Loss: 4.7134833
Validation loss decreased (inf --> 2.742521).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 2 cost time: 0.9343464374542236
Epoch: 2, Steps: 64 | Train Loss: 0.7349402 Vali Loss: 1.7431273 Test Loss: 2.8545430
Validation loss decreased (2.742521 --> 1.743127).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 3 cost time: 1.031404972076416
Epoch: 3, Steps: 64 | Train Loss: 0.4575240 Vali Loss: 1.0567046 Test Loss: 1.5579304
Validation loss decreased (1.743127 --> 1.056705).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 4 cost time: 0.9455406665802002
Epoch: 4, Steps: 64 | Train Loss: 0.2846150 Vali Loss: 0.6856212 Test Loss: 0.8644031
Validation loss decreased (1.056705 --> 0.685621).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 5 cost time: 0.9605555534362793
Epoch: 5, Steps: 64 | Train Loss: 0.1988286 Vali Loss: 0.5071961 Test Loss: 0.5712830
Validation loss decreased (0.685621 --> 0.507196).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 6 cost time: 0.9074435234069824
Epoch: 6, Steps: 64 | Train Loss: 0.1613937 Vali Loss: 0.4068370 Test Loss: 0.4300250
Validation loss decreased (0.507196 --> 0.406837).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 7 cost time: 0.9372727870941162
Epoch: 7, Steps: 64 | Train Loss: 0.1408608 Vali Loss: 0.3448884 Test Loss: 0.3620419
Validation loss decreased (0.406837 --> 0.344888).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 8 cost time: 0.9405982494354248
Epoch: 8, Steps: 64 | Train Loss: 0.1292857 Vali Loss: 0.3015538 Test Loss: 0.3292918
Validation loss decreased (0.344888 --> 0.301554).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 9 cost time: 0.9120008945465088
Epoch: 9, Steps: 64 | Train Loss: 0.1218818 Vali Loss: 0.2812687 Test Loss: 0.3145444
Validation loss decreased (0.301554 --> 0.281269).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 10 cost time: 1.0086419582366943
Epoch: 10, Steps: 64 | Train Loss: 0.1177012 Vali Loss: 0.2643727 Test Loss: 0.3098814
Validation loss decreased (0.281269 --> 0.264373).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 11 cost time: 0.9876089096069336
Epoch: 11, Steps: 64 | Train Loss: 0.1145483 Vali Loss: 0.2609198 Test Loss: 0.3022661
Validation loss decreased (0.264373 --> 0.260920).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 12 cost time: 0.968153715133667
Epoch: 12, Steps: 64 | Train Loss: 0.1123255 Vali Loss: 0.2550492 Test Loss: 0.3020348
Validation loss decreased (0.260920 --> 0.255049).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 13 cost time: 0.9666237831115723
Epoch: 13, Steps: 64 | Train Loss: 0.1103024 Vali Loss: 0.2535264 Test Loss: 0.3003740
Validation loss decreased (0.255049 --> 0.253526).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 14 cost time: 0.9725291728973389
Epoch: 14, Steps: 64 | Train Loss: 0.1092051 Vali Loss: 0.2497650 Test Loss: 0.3007488
Validation loss decreased (0.253526 --> 0.249765).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 15 cost time: 0.9653415679931641
Epoch: 15, Steps: 64 | Train Loss: 0.1076663 Vali Loss: 0.2497058 Test Loss: 0.2984928
Validation loss decreased (0.249765 --> 0.249706).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 16 cost time: 0.9794020652770996
Epoch: 16, Steps: 64 | Train Loss: 0.1065043 Vali Loss: 0.2474246 Test Loss: 0.3019124
Validation loss decreased (0.249706 --> 0.247425).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 17 cost time: 0.9632785320281982
Epoch: 17, Steps: 64 | Train Loss: 0.1059706 Vali Loss: 0.2482700 Test Loss: 0.2983806
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 18 cost time: 0.979417085647583
Epoch: 18, Steps: 64 | Train Loss: 0.1050444 Vali Loss: 0.2463737 Test Loss: 0.2979201
Validation loss decreased (0.247425 --> 0.246374).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 19 cost time: 0.973527193069458
Epoch: 19, Steps: 64 | Train Loss: 0.1045629 Vali Loss: 0.2449822 Test Loss: 0.2990306
Validation loss decreased (0.246374 --> 0.244982).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 20 cost time: 1.018019676208496
Epoch: 20, Steps: 64 | Train Loss: 0.1040194 Vali Loss: 0.2454874 Test Loss: 0.2967041
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 21 cost time: 1.0309171676635742
Epoch: 21, Steps: 64 | Train Loss: 0.1033902 Vali Loss: 0.2453900 Test Loss: 0.2990309
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 22 cost time: 0.9937787055969238
Epoch: 22, Steps: 64 | Train Loss: 0.1032527 Vali Loss: 0.2449401 Test Loss: 0.2977704
Validation loss decreased (0.244982 --> 0.244940).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 23 cost time: 0.9962599277496338
Epoch: 23, Steps: 64 | Train Loss: 0.1021563 Vali Loss: 0.2408122 Test Loss: 0.2959524
Validation loss decreased (0.244940 --> 0.240812).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 24 cost time: 0.9689302444458008
Epoch: 24, Steps: 64 | Train Loss: 0.1024717 Vali Loss: 0.2464341 Test Loss: 0.3000840
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 25 cost time: 0.9516029357910156
Epoch: 25, Steps: 64 | Train Loss: 0.1021108 Vali Loss: 0.2458361 Test Loss: 0.2975176
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 26 cost time: 0.9506852626800537
Epoch: 26, Steps: 64 | Train Loss: 0.1014341 Vali Loss: 0.2426818 Test Loss: 0.2982148
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 27 cost time: 0.9283647537231445
Epoch: 27, Steps: 64 | Train Loss: 0.1022812 Vali Loss: 0.2413482 Test Loss: 0.2975827
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 28 cost time: 0.9497027397155762
Epoch: 28, Steps: 64 | Train Loss: 0.1015120 Vali Loss: 0.2463343 Test Loss: 0.2980577
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 29 cost time: 0.9275507926940918
Epoch: 29, Steps: 64 | Train Loss: 0.1011531 Vali Loss: 0.2422156 Test Loss: 0.2972980
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 30 cost time: 0.9390017986297607
Epoch: 30, Steps: 64 | Train Loss: 0.1002110 Vali Loss: 0.2435436 Test Loss: 0.2974966
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 31 cost time: 0.9379980564117432
Epoch: 31, Steps: 64 | Train Loss: 0.1010674 Vali Loss: 0.2454072 Test Loss: 0.2982376
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 32 cost time: 0.9381697177886963
Epoch: 32, Steps: 64 | Train Loss: 0.1004296 Vali Loss: 0.2437664 Test Loss: 0.2982427
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 33 cost time: 0.9362044334411621
Epoch: 33, Steps: 64 | Train Loss: 0.1006310 Vali Loss: 0.2409994 Test Loss: 0.2965560
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 34 cost time: 0.9303908348083496
Epoch: 34, Steps: 64 | Train Loss: 0.1008756 Vali Loss: 0.2434567 Test Loss: 0.2980300
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 35 cost time: 0.949476957321167
Epoch: 35, Steps: 64 | Train Loss: 0.1000537 Vali Loss: 0.2410150 Test Loss: 0.2968394
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 36 cost time: 0.9543561935424805
Epoch: 36, Steps: 64 | Train Loss: 0.0999736 Vali Loss: 0.2448430 Test Loss: 0.2972637
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 37 cost time: 0.9413788318634033
Epoch: 37, Steps: 64 | Train Loss: 0.0997105 Vali Loss: 0.2411785 Test Loss: 0.2994515
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 38 cost time: 0.9549992084503174
Epoch: 38, Steps: 64 | Train Loss: 0.0995559 Vali Loss: 0.2434551 Test Loss: 0.2972966
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 39 cost time: 0.9402437210083008
Epoch: 39, Steps: 64 | Train Loss: 0.1005429 Vali Loss: 0.2425919 Test Loss: 0.2991580
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 40 cost time: 0.8923654556274414
Epoch: 40, Steps: 64 | Train Loss: 0.0996067 Vali Loss: 0.2402532 Test Loss: 0.2972056
Validation loss decreased (0.240812 --> 0.240253).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 41 cost time: 0.9254086017608643
Epoch: 41, Steps: 64 | Train Loss: 0.0997904 Vali Loss: 0.2402076 Test Loss: 0.2964496
Validation loss decreased (0.240253 --> 0.240208).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 42 cost time: 0.9223730564117432
Epoch: 42, Steps: 64 | Train Loss: 0.0998585 Vali Loss: 0.2424724 Test Loss: 0.2962646
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 43 cost time: 0.9323816299438477
Epoch: 43, Steps: 64 | Train Loss: 0.0993700 Vali Loss: 0.2436828 Test Loss: 0.2973754
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 44 cost time: 0.9369430541992188
Epoch: 44, Steps: 64 | Train Loss: 0.0993536 Vali Loss: 0.2428247 Test Loss: 0.2969973
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 45 cost time: 0.9437003135681152
Epoch: 45, Steps: 64 | Train Loss: 0.1000888 Vali Loss: 0.2438788 Test Loss: 0.2965050
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 46 cost time: 1.0269999504089355
Epoch: 46, Steps: 64 | Train Loss: 0.0995433 Vali Loss: 0.2391151 Test Loss: 0.2972567
Validation loss decreased (0.240208 --> 0.239115).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 47 cost time: 0.9396073818206787
Epoch: 47, Steps: 64 | Train Loss: 0.1002593 Vali Loss: 0.2435600 Test Loss: 0.2972588
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 48 cost time: 0.9436328411102295
Epoch: 48, Steps: 64 | Train Loss: 0.0994993 Vali Loss: 0.2418250 Test Loss: 0.2996396
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 49 cost time: 0.9192507266998291
Epoch: 49, Steps: 64 | Train Loss: 0.0995207 Vali Loss: 0.2413308 Test Loss: 0.2965751
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 50 cost time: 0.9481110572814941
Epoch: 50, Steps: 64 | Train Loss: 0.0999652 Vali Loss: 0.2405830 Test Loss: 0.2979440
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 51 cost time: 0.9564478397369385
Epoch: 51, Steps: 64 | Train Loss: 0.0997010 Vali Loss: 0.2411340 Test Loss: 0.2982836
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 52 cost time: 0.9703428745269775
Epoch: 52, Steps: 64 | Train Loss: 0.0999945 Vali Loss: 0.2418933 Test Loss: 0.2963251
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 53 cost time: 0.9623639583587646
Epoch: 53, Steps: 64 | Train Loss: 0.0995228 Vali Loss: 0.2403403 Test Loss: 0.2986340
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 54 cost time: 0.9588980674743652
Epoch: 54, Steps: 64 | Train Loss: 0.0997078 Vali Loss: 0.2418644 Test Loss: 0.2965593
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 55 cost time: 0.9649996757507324
Epoch: 55, Steps: 64 | Train Loss: 0.0993229 Vali Loss: 0.2420777 Test Loss: 0.2983383
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 56 cost time: 0.9670796394348145
Epoch: 56, Steps: 64 | Train Loss: 0.0996922 Vali Loss: 0.2423743 Test Loss: 0.2982778
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 57 cost time: 0.9517459869384766
Epoch: 57, Steps: 64 | Train Loss: 0.0991766 Vali Loss: 0.2422367 Test Loss: 0.2972971
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 58 cost time: 0.9528062343597412
Epoch: 58, Steps: 64 | Train Loss: 0.0994910 Vali Loss: 0.2419123 Test Loss: 0.2977767
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 59 cost time: 0.9363749027252197
Epoch: 59, Steps: 64 | Train Loss: 0.0996316 Vali Loss: 0.2400197 Test Loss: 0.2959733
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 60 cost time: 0.9503819942474365
Epoch: 60, Steps: 64 | Train Loss: 0.0993468 Vali Loss: 0.2424831 Test Loss: 0.2982707
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2972567081451416, mae:0.3649766147136688, rse:0.2502295672893524
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.0369725227355957 GB
Epoch: 1 cost time: 2.389113426208496
Epoch: 1, Steps: 64 | Train Loss: 0.8660444 Vali Loss: 2.6866093 Test Loss: 4.7661753
Validation loss decreased (inf --> 2.686609).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 2 cost time: 0.9879648685455322
Epoch: 2, Steps: 64 | Train Loss: 0.7301316 Vali Loss: 1.8680780 Test Loss: 3.2336967
Validation loss decreased (2.686609 --> 1.868078).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 3 cost time: 0.9788050651550293
Epoch: 3, Steps: 64 | Train Loss: 0.4878134 Vali Loss: 1.0983696 Test Loss: 1.8117943
Validation loss decreased (1.868078 --> 1.098370).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 4 cost time: 0.9727821350097656
Epoch: 4, Steps: 64 | Train Loss: 0.2851555 Vali Loss: 0.5712463 Test Loss: 0.8476264
Validation loss decreased (1.098370 --> 0.571246).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 5 cost time: 0.976116418838501
Epoch: 5, Steps: 64 | Train Loss: 0.1674643 Vali Loss: 0.3397140 Test Loss: 0.4455291
Validation loss decreased (0.571246 --> 0.339714).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 6 cost time: 0.9680030345916748
Epoch: 6, Steps: 64 | Train Loss: 0.1272997 Vali Loss: 0.2714494 Test Loss: 0.3352981
Validation loss decreased (0.339714 --> 0.271449).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 7 cost time: 0.9676268100738525
Epoch: 7, Steps: 64 | Train Loss: 0.1155478 Vali Loss: 0.2541957 Test Loss: 0.3121023
Validation loss decreased (0.271449 --> 0.254196).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 8 cost time: 0.9668381214141846
Epoch: 8, Steps: 64 | Train Loss: 0.1122210 Vali Loss: 0.2460309 Test Loss: 0.3095808
Validation loss decreased (0.254196 --> 0.246031).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 9 cost time: 0.9596333503723145
Epoch: 9, Steps: 64 | Train Loss: 0.1084416 Vali Loss: 0.2470760 Test Loss: 0.3060521
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 10 cost time: 0.9693677425384521
Epoch: 10, Steps: 64 | Train Loss: 0.1069555 Vali Loss: 0.2444464 Test Loss: 0.3045438
Validation loss decreased (0.246031 --> 0.244446).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 11 cost time: 0.9783966541290283
Epoch: 11, Steps: 64 | Train Loss: 0.1052144 Vali Loss: 0.2420812 Test Loss: 0.3010598
Validation loss decreased (0.244446 --> 0.242081).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 12 cost time: 0.9801063537597656
Epoch: 12, Steps: 64 | Train Loss: 0.1036406 Vali Loss: 0.2419568 Test Loss: 0.3021825
Validation loss decreased (0.242081 --> 0.241957).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 13 cost time: 0.9754941463470459
Epoch: 13, Steps: 64 | Train Loss: 0.1028038 Vali Loss: 0.2402555 Test Loss: 0.3010386
Validation loss decreased (0.241957 --> 0.240255).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 14 cost time: 0.9718403816223145
Epoch: 14, Steps: 64 | Train Loss: 0.1018975 Vali Loss: 0.2382615 Test Loss: 0.3013860
Validation loss decreased (0.240255 --> 0.238262).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 15 cost time: 0.9760496616363525
Epoch: 15, Steps: 64 | Train Loss: 0.1007799 Vali Loss: 0.2409804 Test Loss: 0.3013794
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 16 cost time: 0.9660003185272217
Epoch: 16, Steps: 64 | Train Loss: 0.1004512 Vali Loss: 0.2402360 Test Loss: 0.3019184
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 17 cost time: 0.9646382331848145
Epoch: 17, Steps: 64 | Train Loss: 0.1002819 Vali Loss: 0.2363110 Test Loss: 0.2988149
Validation loss decreased (0.238262 --> 0.236311).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 18 cost time: 0.9696276187896729
Epoch: 18, Steps: 64 | Train Loss: 0.0992940 Vali Loss: 0.2376179 Test Loss: 0.2986651
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 19 cost time: 0.9753971099853516
Epoch: 19, Steps: 64 | Train Loss: 0.0986656 Vali Loss: 0.2373756 Test Loss: 0.2997836
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 20 cost time: 0.9804184436798096
Epoch: 20, Steps: 64 | Train Loss: 0.0980960 Vali Loss: 0.2378767 Test Loss: 0.2969909
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 21 cost time: 0.9671580791473389
Epoch: 21, Steps: 64 | Train Loss: 0.0983141 Vali Loss: 0.2385885 Test Loss: 0.3002190
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 22 cost time: 0.9741880893707275
Epoch: 22, Steps: 64 | Train Loss: 0.0981169 Vali Loss: 0.2364288 Test Loss: 0.2993604
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 23 cost time: 0.9683873653411865
Epoch: 23, Steps: 64 | Train Loss: 0.0967389 Vali Loss: 0.2354401 Test Loss: 0.2997443
Validation loss decreased (0.236311 --> 0.235440).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 24 cost time: 0.9838685989379883
Epoch: 24, Steps: 64 | Train Loss: 0.0975381 Vali Loss: 0.2342036 Test Loss: 0.2983370
Validation loss decreased (0.235440 --> 0.234204).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 25 cost time: 0.9703526496887207
Epoch: 25, Steps: 64 | Train Loss: 0.0959532 Vali Loss: 0.2364049 Test Loss: 0.2999305
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 26 cost time: 0.9674539566040039
Epoch: 26, Steps: 64 | Train Loss: 0.0964139 Vali Loss: 0.2364323 Test Loss: 0.2983116
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 27 cost time: 0.9706330299377441
Epoch: 27, Steps: 64 | Train Loss: 0.0965062 Vali Loss: 0.2350401 Test Loss: 0.3000839
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 28 cost time: 0.9806256294250488
Epoch: 28, Steps: 64 | Train Loss: 0.0960195 Vali Loss: 0.2367276 Test Loss: 0.2987880
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 29 cost time: 0.9743893146514893
Epoch: 29, Steps: 64 | Train Loss: 0.0957919 Vali Loss: 0.2337005 Test Loss: 0.2985422
Validation loss decreased (0.234204 --> 0.233701).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 30 cost time: 0.9730327129364014
Epoch: 30, Steps: 64 | Train Loss: 0.0956640 Vali Loss: 0.2331571 Test Loss: 0.2975036
Validation loss decreased (0.233701 --> 0.233157).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 31 cost time: 0.9644200801849365
Epoch: 31, Steps: 64 | Train Loss: 0.0957455 Vali Loss: 0.2367217 Test Loss: 0.2999315
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 32 cost time: 0.9763989448547363
Epoch: 32, Steps: 64 | Train Loss: 0.0956276 Vali Loss: 0.2355937 Test Loss: 0.2959818
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 33 cost time: 0.968421220779419
Epoch: 33, Steps: 64 | Train Loss: 0.0951848 Vali Loss: 0.2323146 Test Loss: 0.2981885
Validation loss decreased (0.233157 --> 0.232315).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 34 cost time: 0.9685196876525879
Epoch: 34, Steps: 64 | Train Loss: 0.0959217 Vali Loss: 0.2389218 Test Loss: 0.3004808
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 35 cost time: 0.981823205947876
Epoch: 35, Steps: 64 | Train Loss: 0.0956278 Vali Loss: 0.2341344 Test Loss: 0.2978731
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 36 cost time: 0.9679996967315674
Epoch: 36, Steps: 64 | Train Loss: 0.0947446 Vali Loss: 0.2350914 Test Loss: 0.2996884
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 37 cost time: 0.9696080684661865
Epoch: 37, Steps: 64 | Train Loss: 0.0952865 Vali Loss: 0.2382780 Test Loss: 0.2989338
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 38 cost time: 0.9787318706512451
Epoch: 38, Steps: 64 | Train Loss: 0.0952650 Vali Loss: 0.2339545 Test Loss: 0.2988257
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 39 cost time: 0.9651787281036377
Epoch: 39, Steps: 64 | Train Loss: 0.0956253 Vali Loss: 0.2360297 Test Loss: 0.2984248
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 40 cost time: 0.9691817760467529
Epoch: 40, Steps: 64 | Train Loss: 0.0954340 Vali Loss: 0.2376383 Test Loss: 0.2988755
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 41 cost time: 0.9664456844329834
Epoch: 41, Steps: 64 | Train Loss: 0.0954063 Vali Loss: 0.2351329 Test Loss: 0.2975287
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 42 cost time: 0.9624648094177246
Epoch: 42, Steps: 64 | Train Loss: 0.0952649 Vali Loss: 0.2349569 Test Loss: 0.2973897
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 43 cost time: 0.9644801616668701
Epoch: 43, Steps: 64 | Train Loss: 0.0946551 Vali Loss: 0.2331321 Test Loss: 0.2991919
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 44 cost time: 0.9728195667266846
Epoch: 44, Steps: 64 | Train Loss: 0.0952619 Vali Loss: 0.2358021 Test Loss: 0.2979300
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 45 cost time: 0.9767622947692871
Epoch: 45, Steps: 64 | Train Loss: 0.0951758 Vali Loss: 0.2345094 Test Loss: 0.2977670
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 46 cost time: 0.977325439453125
Epoch: 46, Steps: 64 | Train Loss: 0.0948804 Vali Loss: 0.2359837 Test Loss: 0.2981973
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 47 cost time: 0.9736127853393555
Epoch: 47, Steps: 64 | Train Loss: 0.0947896 Vali Loss: 0.2320422 Test Loss: 0.2965487
Validation loss decreased (0.232315 --> 0.232042).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 48 cost time: 0.9806323051452637
Epoch: 48, Steps: 64 | Train Loss: 0.0950496 Vali Loss: 0.2358439 Test Loss: 0.2999673
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 49 cost time: 0.9763894081115723
Epoch: 49, Steps: 64 | Train Loss: 0.0947695 Vali Loss: 0.2343313 Test Loss: 0.2991289
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 50 cost time: 0.9752151966094971
Epoch: 50, Steps: 64 | Train Loss: 0.0944902 Vali Loss: 0.2335101 Test Loss: 0.2980166
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 51 cost time: 0.9739899635314941
Epoch: 51, Steps: 64 | Train Loss: 0.0946165 Vali Loss: 0.2346936 Test Loss: 0.2969454
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 52 cost time: 0.973151445388794
Epoch: 52, Steps: 64 | Train Loss: 0.0941966 Vali Loss: 0.2382901 Test Loss: 0.2990818
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 53 cost time: 0.972153902053833
Epoch: 53, Steps: 64 | Train Loss: 0.0945909 Vali Loss: 0.2349465 Test Loss: 0.2989740
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 54 cost time: 0.9693698883056641
Epoch: 54, Steps: 64 | Train Loss: 0.0948224 Vali Loss: 0.2332149 Test Loss: 0.2974627
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 55 cost time: 0.9873921871185303
Epoch: 55, Steps: 64 | Train Loss: 0.0943429 Vali Loss: 0.2326847 Test Loss: 0.2976607
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 56 cost time: 0.9720001220703125
Epoch: 56, Steps: 64 | Train Loss: 0.0949479 Vali Loss: 0.2333507 Test Loss: 0.2975596
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 57 cost time: 0.9630007743835449
Epoch: 57, Steps: 64 | Train Loss: 0.0943479 Vali Loss: 0.2357612 Test Loss: 0.2967170
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 58 cost time: 0.9676299095153809
Epoch: 58, Steps: 64 | Train Loss: 0.0950031 Vali Loss: 0.2373310 Test Loss: 0.2973204
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 59 cost time: 0.9666347503662109
Epoch: 59, Steps: 64 | Train Loss: 0.0945547 Vali Loss: 0.2363710 Test Loss: 0.2968323
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 60 cost time: 0.9634134769439697
Epoch: 60, Steps: 64 | Train Loss: 0.0941880 Vali Loss: 0.2357209 Test Loss: 0.2980912
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2965487241744995, mae:0.3579668700695038, rse:0.24993139505386353
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.035868167877197266 GB
Epoch: 1 cost time: 2.2449982166290283
Epoch: 1, Steps: 64 | Train Loss: 1.2971154 Vali Loss: 3.5185971 Test Loss: 6.1992254
Validation loss decreased (inf --> 3.518597).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 2 cost time: 0.859440803527832
Epoch: 2, Steps: 64 | Train Loss: 0.9092904 Vali Loss: 1.4332203 Test Loss: 2.2606633
Validation loss decreased (3.518597 --> 1.433220).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 3 cost time: 0.8489980697631836
Epoch: 3, Steps: 64 | Train Loss: 0.4358682 Vali Loss: 0.8424962 Test Loss: 1.1691860
Validation loss decreased (1.433220 --> 0.842496).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 4 cost time: 0.8594570159912109
Epoch: 4, Steps: 64 | Train Loss: 0.3085032 Vali Loss: 0.6637000 Test Loss: 0.8430635
Validation loss decreased (0.842496 --> 0.663700).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 5 cost time: 0.8593904972076416
Epoch: 5, Steps: 64 | Train Loss: 0.2511077 Vali Loss: 0.5685512 Test Loss: 0.6781479
Validation loss decreased (0.663700 --> 0.568551).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 6 cost time: 0.8515002727508545
Epoch: 6, Steps: 64 | Train Loss: 0.2197669 Vali Loss: 0.5048080 Test Loss: 0.5714658
Validation loss decreased (0.568551 --> 0.504808).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 7 cost time: 0.8484170436859131
Epoch: 7, Steps: 64 | Train Loss: 0.1983877 Vali Loss: 0.4577104 Test Loss: 0.5009122
Validation loss decreased (0.504808 --> 0.457710).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 8 cost time: 0.8517460823059082
Epoch: 8, Steps: 64 | Train Loss: 0.1828495 Vali Loss: 0.4222257 Test Loss: 0.4533694
Validation loss decreased (0.457710 --> 0.422226).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 9 cost time: 0.8570001125335693
Epoch: 9, Steps: 64 | Train Loss: 0.1728631 Vali Loss: 0.3940372 Test Loss: 0.4140179
Validation loss decreased (0.422226 --> 0.394037).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 10 cost time: 0.8526298999786377
Epoch: 10, Steps: 64 | Train Loss: 0.1639354 Vali Loss: 0.3759378 Test Loss: 0.3923522
Validation loss decreased (0.394037 --> 0.375938).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 11 cost time: 0.8534607887268066
Epoch: 11, Steps: 64 | Train Loss: 0.1581512 Vali Loss: 0.3589485 Test Loss: 0.3646195
Validation loss decreased (0.375938 --> 0.358948).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 12 cost time: 0.8623697757720947
Epoch: 12, Steps: 64 | Train Loss: 0.1537488 Vali Loss: 0.3491647 Test Loss: 0.3555771
Validation loss decreased (0.358948 --> 0.349165).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 13 cost time: 0.878272294998169
Epoch: 13, Steps: 64 | Train Loss: 0.1501704 Vali Loss: 0.3346482 Test Loss: 0.3448897
Validation loss decreased (0.349165 --> 0.334648).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 14 cost time: 0.8629975318908691
Epoch: 14, Steps: 64 | Train Loss: 0.1456052 Vali Loss: 0.3295622 Test Loss: 0.3374506
Validation loss decreased (0.334648 --> 0.329562).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 15 cost time: 0.8516271114349365
Epoch: 15, Steps: 64 | Train Loss: 0.1433271 Vali Loss: 0.3231692 Test Loss: 0.3293881
Validation loss decreased (0.329562 --> 0.323169).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 16 cost time: 0.8818435668945312
Epoch: 16, Steps: 64 | Train Loss: 0.1424718 Vali Loss: 0.3192909 Test Loss: 0.3276329
Validation loss decreased (0.323169 --> 0.319291).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 17 cost time: 0.8511643409729004
Epoch: 17, Steps: 64 | Train Loss: 0.1404184 Vali Loss: 0.3117791 Test Loss: 0.3228202
Validation loss decreased (0.319291 --> 0.311779).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 18 cost time: 0.8489859104156494
Epoch: 18, Steps: 64 | Train Loss: 0.1385156 Vali Loss: 0.3063540 Test Loss: 0.3151955
Validation loss decreased (0.311779 --> 0.306354).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 19 cost time: 0.8519995212554932
Epoch: 19, Steps: 64 | Train Loss: 0.1373097 Vali Loss: 0.3019620 Test Loss: 0.3109210
Validation loss decreased (0.306354 --> 0.301962).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 20 cost time: 0.8666305541992188
Epoch: 20, Steps: 64 | Train Loss: 0.1355375 Vali Loss: 0.3018764 Test Loss: 0.3108355
Validation loss decreased (0.301962 --> 0.301876).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 21 cost time: 0.8563787937164307
Epoch: 21, Steps: 64 | Train Loss: 0.1347051 Vali Loss: 0.2954315 Test Loss: 0.3116220
Validation loss decreased (0.301876 --> 0.295431).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 22 cost time: 0.8654639720916748
Epoch: 22, Steps: 64 | Train Loss: 0.1348022 Vali Loss: 0.2970352 Test Loss: 0.3111246
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 23 cost time: 0.8507277965545654
Epoch: 23, Steps: 64 | Train Loss: 0.1329282 Vali Loss: 0.2942226 Test Loss: 0.3058491
Validation loss decreased (0.295431 --> 0.294223).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 24 cost time: 0.8459975719451904
Epoch: 24, Steps: 64 | Train Loss: 0.1320866 Vali Loss: 0.2916777 Test Loss: 0.3066485
Validation loss decreased (0.294223 --> 0.291678).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 25 cost time: 0.8496339321136475
Epoch: 25, Steps: 64 | Train Loss: 0.1313642 Vali Loss: 0.2916112 Test Loss: 0.3056605
Validation loss decreased (0.291678 --> 0.291611).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 26 cost time: 0.8493847846984863
Epoch: 26, Steps: 64 | Train Loss: 0.1305170 Vali Loss: 0.2885403 Test Loss: 0.3063475
Validation loss decreased (0.291611 --> 0.288540).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 27 cost time: 0.850102424621582
Epoch: 27, Steps: 64 | Train Loss: 0.1307040 Vali Loss: 0.2840588 Test Loss: 0.3036346
Validation loss decreased (0.288540 --> 0.284059).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 28 cost time: 0.8407497406005859
Epoch: 28, Steps: 64 | Train Loss: 0.1304952 Vali Loss: 0.2804956 Test Loss: 0.3013758
Validation loss decreased (0.284059 --> 0.280496).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 29 cost time: 0.8489999771118164
Epoch: 29, Steps: 64 | Train Loss: 0.1292071 Vali Loss: 0.2808388 Test Loss: 0.3020996
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 30 cost time: 0.8526287078857422
Epoch: 30, Steps: 64 | Train Loss: 0.1291823 Vali Loss: 0.2852287 Test Loss: 0.3032117
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 31 cost time: 0.8581087589263916
Epoch: 31, Steps: 64 | Train Loss: 0.1290039 Vali Loss: 0.2840980 Test Loss: 0.3026914
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 32 cost time: 0.8274400234222412
Epoch: 32, Steps: 64 | Train Loss: 0.1284932 Vali Loss: 0.2784062 Test Loss: 0.2999454
Validation loss decreased (0.280496 --> 0.278406).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 33 cost time: 0.8618946075439453
Epoch: 33, Steps: 64 | Train Loss: 0.1286631 Vali Loss: 0.2810290 Test Loss: 0.3011761
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 34 cost time: 0.8519999980926514
Epoch: 34, Steps: 64 | Train Loss: 0.1275898 Vali Loss: 0.2819740 Test Loss: 0.3019332
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 35 cost time: 0.8646383285522461
Epoch: 35, Steps: 64 | Train Loss: 0.1287927 Vali Loss: 0.2794701 Test Loss: 0.3002739
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 36 cost time: 0.8544101715087891
Epoch: 36, Steps: 64 | Train Loss: 0.1268221 Vali Loss: 0.2765916 Test Loss: 0.2990838
Validation loss decreased (0.278406 --> 0.276592).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 37 cost time: 0.8564631938934326
Epoch: 37, Steps: 64 | Train Loss: 0.1275158 Vali Loss: 0.2809378 Test Loss: 0.3004369
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 38 cost time: 0.8527848720550537
Epoch: 38, Steps: 64 | Train Loss: 0.1270718 Vali Loss: 0.2738368 Test Loss: 0.2972109
Validation loss decreased (0.276592 --> 0.273837).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 39 cost time: 0.8669977188110352
Epoch: 39, Steps: 64 | Train Loss: 0.1265273 Vali Loss: 0.2779353 Test Loss: 0.2985137
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 40 cost time: 0.8646342754364014
Epoch: 40, Steps: 64 | Train Loss: 0.1269938 Vali Loss: 0.2765225 Test Loss: 0.3010259
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 41 cost time: 0.8554129600524902
Epoch: 41, Steps: 64 | Train Loss: 0.1263828 Vali Loss: 0.2753012 Test Loss: 0.3002733
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 42 cost time: 0.8573789596557617
Epoch: 42, Steps: 64 | Train Loss: 0.1270458 Vali Loss: 0.2759938 Test Loss: 0.2979396
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 43 cost time: 0.8557302951812744
Epoch: 43, Steps: 64 | Train Loss: 0.1262848 Vali Loss: 0.2735815 Test Loss: 0.2988997
Validation loss decreased (0.273837 --> 0.273581).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 44 cost time: 0.8539993762969971
Epoch: 44, Steps: 64 | Train Loss: 0.1260556 Vali Loss: 0.2767916 Test Loss: 0.2983622
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 45 cost time: 0.8506295680999756
Epoch: 45, Steps: 64 | Train Loss: 0.1264639 Vali Loss: 0.2748600 Test Loss: 0.2976755
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 46 cost time: 0.8662643432617188
Epoch: 46, Steps: 64 | Train Loss: 0.1262203 Vali Loss: 0.2776712 Test Loss: 0.3008369
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 47 cost time: 0.8553566932678223
Epoch: 47, Steps: 64 | Train Loss: 0.1265377 Vali Loss: 0.2760838 Test Loss: 0.2989055
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 48 cost time: 0.8567237854003906
Epoch: 48, Steps: 64 | Train Loss: 0.1261535 Vali Loss: 0.2780322 Test Loss: 0.2969580
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 49 cost time: 0.8569998741149902
Epoch: 49, Steps: 64 | Train Loss: 0.1264063 Vali Loss: 0.2694559 Test Loss: 0.2988879
Validation loss decreased (0.273581 --> 0.269456).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 50 cost time: 0.8576304912567139
Epoch: 50, Steps: 64 | Train Loss: 0.1260977 Vali Loss: 0.2768019 Test Loss: 0.2974812
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 51 cost time: 0.8444118499755859
Epoch: 51, Steps: 64 | Train Loss: 0.1263334 Vali Loss: 0.2761477 Test Loss: 0.2976222
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 52 cost time: 0.8433434963226318
Epoch: 52, Steps: 64 | Train Loss: 0.1262323 Vali Loss: 0.2744539 Test Loss: 0.2971362
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 53 cost time: 0.8348066806793213
Epoch: 53, Steps: 64 | Train Loss: 0.1256059 Vali Loss: 0.2726358 Test Loss: 0.2978508
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 54 cost time: 0.8356373310089111
Epoch: 54, Steps: 64 | Train Loss: 0.1251998 Vali Loss: 0.2765265 Test Loss: 0.2978474
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 55 cost time: 0.8494052886962891
Epoch: 55, Steps: 64 | Train Loss: 0.1258769 Vali Loss: 0.2723673 Test Loss: 0.2980600
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 56 cost time: 0.8463771343231201
Epoch: 56, Steps: 64 | Train Loss: 0.1255455 Vali Loss: 0.2760566 Test Loss: 0.3000380
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 57 cost time: 0.8481330871582031
Epoch: 57, Steps: 64 | Train Loss: 0.1252624 Vali Loss: 0.2755201 Test Loss: 0.2964692
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 58 cost time: 0.8618597984313965
Epoch: 58, Steps: 64 | Train Loss: 0.1256819 Vali Loss: 0.2749607 Test Loss: 0.2977139
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 59 cost time: 0.8549997806549072
Epoch: 59, Steps: 64 | Train Loss: 0.1260909 Vali Loss: 0.2756931 Test Loss: 0.2985291
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 60 cost time: 0.8550205230712891
Epoch: 60, Steps: 64 | Train Loss: 0.1254246 Vali Loss: 0.2740611 Test Loss: 0.2966498
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2988879382610321, mae:0.3584490418434143, rse:0.25091519951820374
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03656959533691406 GB
Epoch: 1 cost time: 2.316946029663086
Epoch: 1, Steps: 64 | Train Loss: 0.7851085 Vali Loss: 2.3543420 Test Loss: 4.1107183
Validation loss decreased (inf --> 2.354342).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 2 cost time: 0.8924777507781982
Epoch: 2, Steps: 64 | Train Loss: 0.5864818 Vali Loss: 1.2037840 Test Loss: 1.9049108
Validation loss decreased (2.354342 --> 1.203784).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 3 cost time: 0.8959176540374756
Epoch: 3, Steps: 64 | Train Loss: 0.3069958 Vali Loss: 0.6288524 Test Loss: 0.8016099
Validation loss decreased (1.203784 --> 0.628852).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 4 cost time: 0.8918015956878662
Epoch: 4, Steps: 64 | Train Loss: 0.1782537 Vali Loss: 0.4077343 Test Loss: 0.4194990
Validation loss decreased (0.628852 --> 0.407734).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 5 cost time: 0.8810000419616699
Epoch: 5, Steps: 64 | Train Loss: 0.1366955 Vali Loss: 0.3372750 Test Loss: 0.3320431
Validation loss decreased (0.407734 --> 0.337275).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 6 cost time: 0.8786275386810303
Epoch: 6, Steps: 64 | Train Loss: 0.1244685 Vali Loss: 0.3077865 Test Loss: 0.3082611
Validation loss decreased (0.337275 --> 0.307786).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 7 cost time: 0.8894336223602295
Epoch: 7, Steps: 64 | Train Loss: 0.1184448 Vali Loss: 0.2922409 Test Loss: 0.3027286
Validation loss decreased (0.307786 --> 0.292241).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 8 cost time: 0.8843650817871094
Epoch: 8, Steps: 64 | Train Loss: 0.1140745 Vali Loss: 0.2776414 Test Loss: 0.2964993
Validation loss decreased (0.292241 --> 0.277641).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 9 cost time: 0.8774049282073975
Epoch: 9, Steps: 64 | Train Loss: 0.1121731 Vali Loss: 0.2653332 Test Loss: 0.2949803
Validation loss decreased (0.277641 --> 0.265333).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 10 cost time: 0.8883676528930664
Epoch: 10, Steps: 64 | Train Loss: 0.1098042 Vali Loss: 0.2616214 Test Loss: 0.2934109
Validation loss decreased (0.265333 --> 0.261621).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 11 cost time: 0.8849999904632568
Epoch: 11, Steps: 64 | Train Loss: 0.1087346 Vali Loss: 0.2569627 Test Loss: 0.2924653
Validation loss decreased (0.261621 --> 0.256963).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 12 cost time: 0.9026305675506592
Epoch: 12, Steps: 64 | Train Loss: 0.1065327 Vali Loss: 0.2505741 Test Loss: 0.2936574
Validation loss decreased (0.256963 --> 0.250574).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 13 cost time: 0.8843810558319092
Epoch: 13, Steps: 64 | Train Loss: 0.1053595 Vali Loss: 0.2493944 Test Loss: 0.2924010
Validation loss decreased (0.250574 --> 0.249394).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 14 cost time: 0.8873646259307861
Epoch: 14, Steps: 64 | Train Loss: 0.1052048 Vali Loss: 0.2483210 Test Loss: 0.2934234
Validation loss decreased (0.249394 --> 0.248321).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 15 cost time: 0.8837375640869141
Epoch: 15, Steps: 64 | Train Loss: 0.1038081 Vali Loss: 0.2435997 Test Loss: 0.2926692
Validation loss decreased (0.248321 --> 0.243600).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 16 cost time: 0.900303840637207
Epoch: 16, Steps: 64 | Train Loss: 0.1030799 Vali Loss: 0.2474149 Test Loss: 0.2926035
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 17 cost time: 0.8861122131347656
Epoch: 17, Steps: 64 | Train Loss: 0.1026960 Vali Loss: 0.2446662 Test Loss: 0.2930414
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 18 cost time: 0.9006080627441406
Epoch: 18, Steps: 64 | Train Loss: 0.1018752 Vali Loss: 0.2452683 Test Loss: 0.2928607
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 19 cost time: 0.915459394454956
Epoch: 19, Steps: 64 | Train Loss: 0.1019506 Vali Loss: 0.2432838 Test Loss: 0.2910579
Validation loss decreased (0.243600 --> 0.243284).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 20 cost time: 0.9039866924285889
Epoch: 20, Steps: 64 | Train Loss: 0.1012022 Vali Loss: 0.2415292 Test Loss: 0.2915686
Validation loss decreased (0.243284 --> 0.241529).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 21 cost time: 0.9063432216644287
Epoch: 21, Steps: 64 | Train Loss: 0.1008589 Vali Loss: 0.2433264 Test Loss: 0.2928181
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 22 cost time: 0.9067866802215576
Epoch: 22, Steps: 64 | Train Loss: 0.1006456 Vali Loss: 0.2448437 Test Loss: 0.2928636
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 23 cost time: 0.9099998474121094
Epoch: 23, Steps: 64 | Train Loss: 0.1005870 Vali Loss: 0.2402253 Test Loss: 0.2930139
Validation loss decreased (0.241529 --> 0.240225).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 24 cost time: 0.8985230922698975
Epoch: 24, Steps: 64 | Train Loss: 0.0997584 Vali Loss: 0.2387069 Test Loss: 0.2937973
Validation loss decreased (0.240225 --> 0.238707).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 25 cost time: 0.9012815952301025
Epoch: 25, Steps: 64 | Train Loss: 0.0996266 Vali Loss: 0.2428665 Test Loss: 0.2916826
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 26 cost time: 0.9033563137054443
Epoch: 26, Steps: 64 | Train Loss: 0.0996192 Vali Loss: 0.2403084 Test Loss: 0.2923371
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 27 cost time: 0.8633475303649902
Epoch: 27, Steps: 64 | Train Loss: 0.0997516 Vali Loss: 0.2423410 Test Loss: 0.2910835
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 28 cost time: 0.9008629322052002
Epoch: 28, Steps: 64 | Train Loss: 0.0990881 Vali Loss: 0.2418641 Test Loss: 0.2930650
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 29 cost time: 0.9026072025299072
Epoch: 29, Steps: 64 | Train Loss: 0.0986568 Vali Loss: 0.2403291 Test Loss: 0.2930729
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 30 cost time: 0.9006092548370361
Epoch: 30, Steps: 64 | Train Loss: 0.0991792 Vali Loss: 0.2392095 Test Loss: 0.2924032
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 31 cost time: 0.9003901481628418
Epoch: 31, Steps: 64 | Train Loss: 0.0989239 Vali Loss: 0.2399083 Test Loss: 0.2940642
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 32 cost time: 0.9043459892272949
Epoch: 32, Steps: 64 | Train Loss: 0.0987143 Vali Loss: 0.2380196 Test Loss: 0.2911328
Validation loss decreased (0.238707 --> 0.238020).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 33 cost time: 0.9043862819671631
Epoch: 33, Steps: 64 | Train Loss: 0.0989027 Vali Loss: 0.2413829 Test Loss: 0.2926641
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 34 cost time: 0.8987374305725098
Epoch: 34, Steps: 64 | Train Loss: 0.0986345 Vali Loss: 0.2377850 Test Loss: 0.2906738
Validation loss decreased (0.238020 --> 0.237785).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 35 cost time: 0.9018545150756836
Epoch: 35, Steps: 64 | Train Loss: 0.0983220 Vali Loss: 0.2356908 Test Loss: 0.2926194
Validation loss decreased (0.237785 --> 0.235691).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 36 cost time: 0.9020004272460938
Epoch: 36, Steps: 64 | Train Loss: 0.0979018 Vali Loss: 0.2405486 Test Loss: 0.2912404
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 37 cost time: 0.9116075038909912
Epoch: 37, Steps: 64 | Train Loss: 0.0979769 Vali Loss: 0.2390529 Test Loss: 0.2910514
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 38 cost time: 0.9061744213104248
Epoch: 38, Steps: 64 | Train Loss: 0.0981037 Vali Loss: 0.2379957 Test Loss: 0.2921561
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 39 cost time: 0.9119107723236084
Epoch: 39, Steps: 64 | Train Loss: 0.0983378 Vali Loss: 0.2393543 Test Loss: 0.2910180
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 40 cost time: 0.9077811241149902
Epoch: 40, Steps: 64 | Train Loss: 0.0982207 Vali Loss: 0.2393682 Test Loss: 0.2928482
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 41 cost time: 0.9050190448760986
Epoch: 41, Steps: 64 | Train Loss: 0.0980015 Vali Loss: 0.2394886 Test Loss: 0.2917260
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 42 cost time: 0.9047818183898926
Epoch: 42, Steps: 64 | Train Loss: 0.0982059 Vali Loss: 0.2386794 Test Loss: 0.2924397
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 43 cost time: 0.8985962867736816
Epoch: 43, Steps: 64 | Train Loss: 0.0986007 Vali Loss: 0.2363377 Test Loss: 0.2904833
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 44 cost time: 0.8924028873443604
Epoch: 44, Steps: 64 | Train Loss: 0.0979062 Vali Loss: 0.2405728 Test Loss: 0.2929262
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 45 cost time: 0.8973066806793213
Epoch: 45, Steps: 64 | Train Loss: 0.0979407 Vali Loss: 0.2374251 Test Loss: 0.2924750
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 46 cost time: 0.8972959518432617
Epoch: 46, Steps: 64 | Train Loss: 0.0978074 Vali Loss: 0.2383513 Test Loss: 0.2924022
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 47 cost time: 0.9047756195068359
Epoch: 47, Steps: 64 | Train Loss: 0.0975637 Vali Loss: 0.2377875 Test Loss: 0.2909268
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 48 cost time: 0.9159998893737793
Epoch: 48, Steps: 64 | Train Loss: 0.0977571 Vali Loss: 0.2388438 Test Loss: 0.2911785
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 49 cost time: 0.9049999713897705
Epoch: 49, Steps: 64 | Train Loss: 0.0983810 Vali Loss: 0.2410249 Test Loss: 0.2931535
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 50 cost time: 0.9086093902587891
Epoch: 50, Steps: 64 | Train Loss: 0.0977772 Vali Loss: 0.2373999 Test Loss: 0.2928203
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 51 cost time: 0.9024066925048828
Epoch: 51, Steps: 64 | Train Loss: 0.0978016 Vali Loss: 0.2390100 Test Loss: 0.2915971
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 52 cost time: 0.9040095806121826
Epoch: 52, Steps: 64 | Train Loss: 0.0975613 Vali Loss: 0.2378998 Test Loss: 0.2915662
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 53 cost time: 0.9003486633300781
Epoch: 53, Steps: 64 | Train Loss: 0.0981018 Vali Loss: 0.2332755 Test Loss: 0.2901226
Validation loss decreased (0.235691 --> 0.233276).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 54 cost time: 0.9058842658996582
Epoch: 54, Steps: 64 | Train Loss: 0.0977792 Vali Loss: 0.2361849 Test Loss: 0.2922210
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 55 cost time: 0.9065780639648438
Epoch: 55, Steps: 64 | Train Loss: 0.0975204 Vali Loss: 0.2394805 Test Loss: 0.2917486
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 56 cost time: 0.9102835655212402
Epoch: 56, Steps: 64 | Train Loss: 0.0978653 Vali Loss: 0.2383405 Test Loss: 0.2912829
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 57 cost time: 0.9085090160369873
Epoch: 57, Steps: 64 | Train Loss: 0.0973606 Vali Loss: 0.2380268 Test Loss: 0.2911392
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 58 cost time: 0.9229745864868164
Epoch: 58, Steps: 64 | Train Loss: 0.0981291 Vali Loss: 0.2371146 Test Loss: 0.2920839
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 59 cost time: 0.9023258686065674
Epoch: 59, Steps: 64 | Train Loss: 0.0975814 Vali Loss: 0.2337592 Test Loss: 0.2903087
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 60 cost time: 0.9007420539855957
Epoch: 60, Steps: 64 | Train Loss: 0.0975324 Vali Loss: 0.2383794 Test Loss: 0.2921436
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2901225984096527, mae:0.34740686416625977, rse:0.2472085803747177
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03713369369506836 GB
Epoch: 1 cost time: 2.3742072582244873
Epoch: 1, Steps: 64 | Train Loss: 0.9000441 Vali Loss: 2.8160961 Test Loss: 4.9056301
Validation loss decreased (inf --> 2.816096).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 2 cost time: 0.9710004329681396
Epoch: 2, Steps: 64 | Train Loss: 0.7934712 Vali Loss: 2.2085145 Test Loss: 3.7235036
Validation loss decreased (2.816096 --> 2.208514).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 3 cost time: 0.9720003604888916
Epoch: 3, Steps: 64 | Train Loss: 0.5967585 Vali Loss: 1.5149035 Test Loss: 2.4278212
Validation loss decreased (2.208514 --> 1.514904).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 4 cost time: 0.9776108264923096
Epoch: 4, Steps: 64 | Train Loss: 0.3693067 Vali Loss: 0.8028530 Test Loss: 1.1271664
Validation loss decreased (1.514904 --> 0.802853).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 5 cost time: 0.9682929515838623
Epoch: 5, Steps: 64 | Train Loss: 0.1987622 Vali Loss: 0.4401793 Test Loss: 0.4940864
Validation loss decreased (0.802853 --> 0.440179).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 6 cost time: 0.9656662940979004
Epoch: 6, Steps: 64 | Train Loss: 0.1379114 Vali Loss: 0.3324713 Test Loss: 0.3426676
Validation loss decreased (0.440179 --> 0.332471).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 7 cost time: 0.9658429622650146
Epoch: 7, Steps: 64 | Train Loss: 0.1241371 Vali Loss: 0.3033645 Test Loss: 0.3184559
Validation loss decreased (0.332471 --> 0.303365).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 8 cost time: 0.9613828659057617
Epoch: 8, Steps: 64 | Train Loss: 0.1173866 Vali Loss: 0.2749867 Test Loss: 0.3049456
Validation loss decreased (0.303365 --> 0.274987).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 9 cost time: 0.9694900512695312
Epoch: 9, Steps: 64 | Train Loss: 0.1139340 Vali Loss: 0.2704909 Test Loss: 0.3057901
Validation loss decreased (0.274987 --> 0.270491).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 10 cost time: 0.9741222858428955
Epoch: 10, Steps: 64 | Train Loss: 0.1107634 Vali Loss: 0.2619653 Test Loss: 0.3042683
Validation loss decreased (0.270491 --> 0.261965).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 11 cost time: 0.9837064743041992
Epoch: 11, Steps: 64 | Train Loss: 0.1087823 Vali Loss: 0.2528387 Test Loss: 0.2978532
Validation loss decreased (0.261965 --> 0.252839).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 12 cost time: 0.9813551902770996
Epoch: 12, Steps: 64 | Train Loss: 0.1069535 Vali Loss: 0.2547804 Test Loss: 0.3000038
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 13 cost time: 0.9785981178283691
Epoch: 13, Steps: 64 | Train Loss: 0.1056291 Vali Loss: 0.2510012 Test Loss: 0.2980623
Validation loss decreased (0.252839 --> 0.251001).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 14 cost time: 0.9686381816864014
Epoch: 14, Steps: 64 | Train Loss: 0.1043514 Vali Loss: 0.2471765 Test Loss: 0.2997654
Validation loss decreased (0.251001 --> 0.247177).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 15 cost time: 0.9756350517272949
Epoch: 15, Steps: 64 | Train Loss: 0.1037689 Vali Loss: 0.2478094 Test Loss: 0.2987273
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 16 cost time: 0.9664969444274902
Epoch: 16, Steps: 64 | Train Loss: 0.1025955 Vali Loss: 0.2477094 Test Loss: 0.3000609
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 17 cost time: 0.9714334011077881
Epoch: 17, Steps: 64 | Train Loss: 0.1019505 Vali Loss: 0.2471120 Test Loss: 0.2995556
Validation loss decreased (0.247177 --> 0.247112).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 18 cost time: 1.0004141330718994
Epoch: 18, Steps: 64 | Train Loss: 0.1015583 Vali Loss: 0.2452013 Test Loss: 0.2959050
Validation loss decreased (0.247112 --> 0.245201).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 19 cost time: 0.9720239639282227
Epoch: 19, Steps: 64 | Train Loss: 0.1013341 Vali Loss: 0.2420601 Test Loss: 0.2973523
Validation loss decreased (0.245201 --> 0.242060).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 20 cost time: 0.9664919376373291
Epoch: 20, Steps: 64 | Train Loss: 0.1000844 Vali Loss: 0.2444702 Test Loss: 0.2977671
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 21 cost time: 0.9714736938476562
Epoch: 21, Steps: 64 | Train Loss: 0.1007870 Vali Loss: 0.2415262 Test Loss: 0.2975090
Validation loss decreased (0.242060 --> 0.241526).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 22 cost time: 0.9737119674682617
Epoch: 22, Steps: 64 | Train Loss: 0.0995264 Vali Loss: 0.2413345 Test Loss: 0.2982045
Validation loss decreased (0.241526 --> 0.241335).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 23 cost time: 0.9712250232696533
Epoch: 23, Steps: 64 | Train Loss: 0.0994956 Vali Loss: 0.2452423 Test Loss: 0.2983773
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 24 cost time: 0.9629998207092285
Epoch: 24, Steps: 64 | Train Loss: 0.0987747 Vali Loss: 0.2417714 Test Loss: 0.2972987
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 25 cost time: 0.9596242904663086
Epoch: 25, Steps: 64 | Train Loss: 0.0989149 Vali Loss: 0.2416916 Test Loss: 0.2984394
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 26 cost time: 0.9666292667388916
Epoch: 26, Steps: 64 | Train Loss: 0.0983317 Vali Loss: 0.2431238 Test Loss: 0.2986577
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 27 cost time: 0.9740421772003174
Epoch: 27, Steps: 64 | Train Loss: 0.0983022 Vali Loss: 0.2441761 Test Loss: 0.2989165
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 28 cost time: 0.9793879985809326
Epoch: 28, Steps: 64 | Train Loss: 0.0982664 Vali Loss: 0.2413125 Test Loss: 0.2983841
Validation loss decreased (0.241335 --> 0.241313).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 29 cost time: 0.9924380779266357
Epoch: 29, Steps: 64 | Train Loss: 0.0979236 Vali Loss: 0.2408729 Test Loss: 0.2982306
Validation loss decreased (0.241313 --> 0.240873).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 30 cost time: 0.9693548679351807
Epoch: 30, Steps: 64 | Train Loss: 0.0976384 Vali Loss: 0.2395796 Test Loss: 0.2984403
Validation loss decreased (0.240873 --> 0.239580).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 31 cost time: 0.9774048328399658
Epoch: 31, Steps: 64 | Train Loss: 0.0978930 Vali Loss: 0.2402486 Test Loss: 0.2975922
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 32 cost time: 0.9684081077575684
Epoch: 32, Steps: 64 | Train Loss: 0.0980033 Vali Loss: 0.2425146 Test Loss: 0.2972929
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 33 cost time: 0.9737365245819092
Epoch: 33, Steps: 64 | Train Loss: 0.0980236 Vali Loss: 0.2393986 Test Loss: 0.2991917
Validation loss decreased (0.239580 --> 0.239399).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 34 cost time: 0.9700002670288086
Epoch: 34, Steps: 64 | Train Loss: 0.0974331 Vali Loss: 0.2412396 Test Loss: 0.2981156
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 35 cost time: 0.9803638458251953
Epoch: 35, Steps: 64 | Train Loss: 0.0970326 Vali Loss: 0.2437950 Test Loss: 0.2976133
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 36 cost time: 0.9680860042572021
Epoch: 36, Steps: 64 | Train Loss: 0.0972279 Vali Loss: 0.2406745 Test Loss: 0.2979420
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 37 cost time: 0.9624323844909668
Epoch: 37, Steps: 64 | Train Loss: 0.0969259 Vali Loss: 0.2433656 Test Loss: 0.2978734
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 38 cost time: 0.9873852729797363
Epoch: 38, Steps: 64 | Train Loss: 0.0975295 Vali Loss: 0.2409435 Test Loss: 0.2983490
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 39 cost time: 0.9663500785827637
Epoch: 39, Steps: 64 | Train Loss: 0.0973150 Vali Loss: 0.2419331 Test Loss: 0.2990773
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 40 cost time: 0.9700167179107666
Epoch: 40, Steps: 64 | Train Loss: 0.0971323 Vali Loss: 0.2410369 Test Loss: 0.2982938
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 41 cost time: 0.9689443111419678
Epoch: 41, Steps: 64 | Train Loss: 0.0973467 Vali Loss: 0.2425984 Test Loss: 0.2980160
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 42 cost time: 0.9714455604553223
Epoch: 42, Steps: 64 | Train Loss: 0.0968500 Vali Loss: 0.2407224 Test Loss: 0.2991520
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 43 cost time: 0.9728479385375977
Epoch: 43, Steps: 64 | Train Loss: 0.0970255 Vali Loss: 0.2394223 Test Loss: 0.2980269
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 44 cost time: 0.9681484699249268
Epoch: 44, Steps: 64 | Train Loss: 0.0972616 Vali Loss: 0.2409336 Test Loss: 0.2981672
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 45 cost time: 0.9689998626708984
Epoch: 45, Steps: 64 | Train Loss: 0.0963894 Vali Loss: 0.2429259 Test Loss: 0.2980226
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 46 cost time: 0.9676401615142822
Epoch: 46, Steps: 64 | Train Loss: 0.0970402 Vali Loss: 0.2407768 Test Loss: 0.2990213
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 47 cost time: 0.9744651317596436
Epoch: 47, Steps: 64 | Train Loss: 0.0966172 Vali Loss: 0.2389345 Test Loss: 0.2978993
Validation loss decreased (0.239399 --> 0.238934).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 48 cost time: 0.9684369564056396
Epoch: 48, Steps: 64 | Train Loss: 0.0968930 Vali Loss: 0.2403164 Test Loss: 0.2981580
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 49 cost time: 0.9663546085357666
Epoch: 49, Steps: 64 | Train Loss: 0.0967586 Vali Loss: 0.2429412 Test Loss: 0.2985959
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 50 cost time: 1.080498456954956
Epoch: 50, Steps: 64 | Train Loss: 0.0967778 Vali Loss: 0.2397376 Test Loss: 0.2990247
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 51 cost time: 0.9728126525878906
Epoch: 51, Steps: 64 | Train Loss: 0.0963840 Vali Loss: 0.2423860 Test Loss: 0.2997992
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 52 cost time: 0.9687743186950684
Epoch: 52, Steps: 64 | Train Loss: 0.0967391 Vali Loss: 0.2410806 Test Loss: 0.2978386
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 53 cost time: 0.9653580188751221
Epoch: 53, Steps: 64 | Train Loss: 0.0964396 Vali Loss: 0.2415297 Test Loss: 0.2983646
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 54 cost time: 0.9851946830749512
Epoch: 54, Steps: 64 | Train Loss: 0.0969826 Vali Loss: 0.2406995 Test Loss: 0.2988953
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 55 cost time: 0.9656965732574463
Epoch: 55, Steps: 64 | Train Loss: 0.0966623 Vali Loss: 0.2417462 Test Loss: 0.2996709
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 56 cost time: 0.9613590240478516
Epoch: 56, Steps: 64 | Train Loss: 0.0969948 Vali Loss: 0.2416732 Test Loss: 0.2996095
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 57 cost time: 0.9606294631958008
Epoch: 57, Steps: 64 | Train Loss: 0.0967020 Vali Loss: 0.2398285 Test Loss: 0.2986477
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 58 cost time: 0.9663317203521729
Epoch: 58, Steps: 64 | Train Loss: 0.0966269 Vali Loss: 0.2413372 Test Loss: 0.2981060
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 59 cost time: 0.95438551902771
Epoch: 59, Steps: 64 | Train Loss: 0.0964553 Vali Loss: 0.2384242 Test Loss: 0.2987771
Validation loss decreased (0.238934 --> 0.238424).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 60 cost time: 0.9573583602905273
Epoch: 60, Steps: 64 | Train Loss: 0.0960709 Vali Loss: 0.2377613 Test Loss: 0.2980445
Validation loss decreased (0.238424 --> 0.237761).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.29804447293281555, mae:0.3638762831687927, rse:0.2505609393119812
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03602886199951172 GB
Epoch: 1 cost time: 2.366425037384033
Epoch: 1, Steps: 64 | Train Loss: 1.0919858 Vali Loss: 3.0379932 Test Loss: 5.1977739
Validation loss decreased (inf --> 3.037993).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 2 cost time: 0.9380156993865967
Epoch: 2, Steps: 64 | Train Loss: 0.8709524 Vali Loss: 1.7499193 Test Loss: 2.8431976
Validation loss decreased (3.037993 --> 1.749919).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 3 cost time: 0.938530683517456
Epoch: 3, Steps: 64 | Train Loss: 0.5279045 Vali Loss: 1.1430894 Test Loss: 1.7182007
Validation loss decreased (1.749919 --> 1.143089).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 4 cost time: 0.9317436218261719
Epoch: 4, Steps: 64 | Train Loss: 0.3797286 Vali Loss: 0.8828073 Test Loss: 1.2154181
Validation loss decreased (1.143089 --> 0.882807).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 5 cost time: 0.9308581352233887
Epoch: 5, Steps: 64 | Train Loss: 0.2957770 Vali Loss: 0.6920438 Test Loss: 0.8974497
Validation loss decreased (0.882807 --> 0.692044).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 6 cost time: 0.9295971393585205
Epoch: 6, Steps: 64 | Train Loss: 0.2403006 Vali Loss: 0.5722222 Test Loss: 0.6990186
Validation loss decreased (0.692044 --> 0.572222).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 7 cost time: 0.9306237697601318
Epoch: 7, Steps: 64 | Train Loss: 0.2103687 Vali Loss: 0.5001709 Test Loss: 0.5997447
Validation loss decreased (0.572222 --> 0.500171).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 8 cost time: 0.9283382892608643
Epoch: 8, Steps: 64 | Train Loss: 0.1904886 Vali Loss: 0.4533759 Test Loss: 0.5322000
Validation loss decreased (0.500171 --> 0.453376).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 9 cost time: 0.9276893138885498
Epoch: 9, Steps: 64 | Train Loss: 0.1760924 Vali Loss: 0.4132772 Test Loss: 0.4875174
Validation loss decreased (0.453376 --> 0.413277).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 10 cost time: 0.9363372325897217
Epoch: 10, Steps: 64 | Train Loss: 0.1663874 Vali Loss: 0.3837098 Test Loss: 0.4446275
Validation loss decreased (0.413277 --> 0.383710).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 11 cost time: 0.9419717788696289
Epoch: 11, Steps: 64 | Train Loss: 0.1585635 Vali Loss: 0.3531429 Test Loss: 0.4126475
Validation loss decreased (0.383710 --> 0.353143).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 12 cost time: 0.930767297744751
Epoch: 12, Steps: 64 | Train Loss: 0.1526202 Vali Loss: 0.3435664 Test Loss: 0.4013652
Validation loss decreased (0.353143 --> 0.343566).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 13 cost time: 0.9360003471374512
Epoch: 13, Steps: 64 | Train Loss: 0.1481684 Vali Loss: 0.3293591 Test Loss: 0.3807976
Validation loss decreased (0.343566 --> 0.329359).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 14 cost time: 0.9287683963775635
Epoch: 14, Steps: 64 | Train Loss: 0.1438222 Vali Loss: 0.3234660 Test Loss: 0.3716308
Validation loss decreased (0.329359 --> 0.323466).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 15 cost time: 0.9415953159332275
Epoch: 15, Steps: 64 | Train Loss: 0.1411528 Vali Loss: 0.3055452 Test Loss: 0.3573713
Validation loss decreased (0.323466 --> 0.305545).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 16 cost time: 0.9264707565307617
Epoch: 16, Steps: 64 | Train Loss: 0.1389710 Vali Loss: 0.3003621 Test Loss: 0.3519006
Validation loss decreased (0.305545 --> 0.300362).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 17 cost time: 0.9213559627532959
Epoch: 17, Steps: 64 | Train Loss: 0.1372363 Vali Loss: 0.2983280 Test Loss: 0.3472823
Validation loss decreased (0.300362 --> 0.298328).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 18 cost time: 0.9274334907531738
Epoch: 18, Steps: 64 | Train Loss: 0.1346122 Vali Loss: 0.2966247 Test Loss: 0.3419112
Validation loss decreased (0.298328 --> 0.296625).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 19 cost time: 0.9340121746063232
Epoch: 19, Steps: 64 | Train Loss: 0.1330926 Vali Loss: 0.2884961 Test Loss: 0.3326704
Validation loss decreased (0.296625 --> 0.288496).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 20 cost time: 0.9307839870452881
Epoch: 20, Steps: 64 | Train Loss: 0.1321288 Vali Loss: 0.2827576 Test Loss: 0.3292941
Validation loss decreased (0.288496 --> 0.282758).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 21 cost time: 0.9329993724822998
Epoch: 21, Steps: 64 | Train Loss: 0.1315475 Vali Loss: 0.2817726 Test Loss: 0.3306151
Validation loss decreased (0.282758 --> 0.281773).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 22 cost time: 0.914391040802002
Epoch: 22, Steps: 64 | Train Loss: 0.1297548 Vali Loss: 0.2812077 Test Loss: 0.3258464
Validation loss decreased (0.281773 --> 0.281208).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 23 cost time: 0.8963572978973389
Epoch: 23, Steps: 64 | Train Loss: 0.1288684 Vali Loss: 0.2793631 Test Loss: 0.3205616
Validation loss decreased (0.281208 --> 0.279363).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 24 cost time: 0.9093542098999023
Epoch: 24, Steps: 64 | Train Loss: 0.1286258 Vali Loss: 0.2764360 Test Loss: 0.3202091
Validation loss decreased (0.279363 --> 0.276436).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 25 cost time: 0.9103429317474365
Epoch: 25, Steps: 64 | Train Loss: 0.1273212 Vali Loss: 0.2780348 Test Loss: 0.3226335
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 26 cost time: 0.9083998203277588
Epoch: 26, Steps: 64 | Train Loss: 0.1271563 Vali Loss: 0.2773092 Test Loss: 0.3194981
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 27 cost time: 0.9147417545318604
Epoch: 27, Steps: 64 | Train Loss: 0.1270984 Vali Loss: 0.2716653 Test Loss: 0.3188865
Validation loss decreased (0.276436 --> 0.271665).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 28 cost time: 0.9313921928405762
Epoch: 28, Steps: 64 | Train Loss: 0.1261235 Vali Loss: 0.2735201 Test Loss: 0.3166994
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 29 cost time: 0.8999874591827393
Epoch: 29, Steps: 64 | Train Loss: 0.1256886 Vali Loss: 0.2726036 Test Loss: 0.3148328
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 30 cost time: 0.8996133804321289
Epoch: 30, Steps: 64 | Train Loss: 0.1249452 Vali Loss: 0.2709383 Test Loss: 0.3142256
Validation loss decreased (0.271665 --> 0.270938).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 31 cost time: 1.0095031261444092
Epoch: 31, Steps: 64 | Train Loss: 0.1250237 Vali Loss: 0.2676614 Test Loss: 0.3142921
Validation loss decreased (0.270938 --> 0.267661).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 32 cost time: 0.9636979103088379
Epoch: 32, Steps: 64 | Train Loss: 0.1245576 Vali Loss: 0.2697436 Test Loss: 0.3137346
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 33 cost time: 0.9183413982391357
Epoch: 33, Steps: 64 | Train Loss: 0.1250382 Vali Loss: 0.2680221 Test Loss: 0.3130803
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 34 cost time: 0.9193904399871826
Epoch: 34, Steps: 64 | Train Loss: 0.1244009 Vali Loss: 0.2687612 Test Loss: 0.3107469
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 35 cost time: 0.9368090629577637
Epoch: 35, Steps: 64 | Train Loss: 0.1240173 Vali Loss: 0.2651818 Test Loss: 0.3158587
Validation loss decreased (0.267661 --> 0.265182).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 36 cost time: 0.9234757423400879
Epoch: 36, Steps: 64 | Train Loss: 0.1236943 Vali Loss: 0.2674008 Test Loss: 0.3129885
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 37 cost time: 0.9225907325744629
Epoch: 37, Steps: 64 | Train Loss: 0.1239139 Vali Loss: 0.2674730 Test Loss: 0.3123368
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 38 cost time: 0.9246203899383545
Epoch: 38, Steps: 64 | Train Loss: 0.1233509 Vali Loss: 0.2628077 Test Loss: 0.3112668
Validation loss decreased (0.265182 --> 0.262808).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 39 cost time: 0.9353718757629395
Epoch: 39, Steps: 64 | Train Loss: 0.1233921 Vali Loss: 0.2643109 Test Loss: 0.3097008
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 40 cost time: 0.9169492721557617
Epoch: 40, Steps: 64 | Train Loss: 0.1234018 Vali Loss: 0.2650912 Test Loss: 0.3118039
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 41 cost time: 0.918168306350708
Epoch: 41, Steps: 64 | Train Loss: 0.1230696 Vali Loss: 0.2633284 Test Loss: 0.3126206
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 42 cost time: 0.9209651947021484
Epoch: 42, Steps: 64 | Train Loss: 0.1232088 Vali Loss: 0.2640220 Test Loss: 0.3113847
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 43 cost time: 0.9137177467346191
Epoch: 43, Steps: 64 | Train Loss: 0.1218121 Vali Loss: 0.2664548 Test Loss: 0.3085434
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 44 cost time: 0.9200000762939453
Epoch: 44, Steps: 64 | Train Loss: 0.1222450 Vali Loss: 0.2656328 Test Loss: 0.3118544
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 45 cost time: 0.9326276779174805
Epoch: 45, Steps: 64 | Train Loss: 0.1227612 Vali Loss: 0.2679898 Test Loss: 0.3091799
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 46 cost time: 0.9353220462799072
Epoch: 46, Steps: 64 | Train Loss: 0.1219235 Vali Loss: 0.2648884 Test Loss: 0.3115000
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 47 cost time: 0.9293403625488281
Epoch: 47, Steps: 64 | Train Loss: 0.1224323 Vali Loss: 0.2637887 Test Loss: 0.3084168
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 48 cost time: 0.9314174652099609
Epoch: 48, Steps: 64 | Train Loss: 0.1219533 Vali Loss: 0.2604549 Test Loss: 0.3109601
Validation loss decreased (0.262808 --> 0.260455).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 49 cost time: 0.9249730110168457
Epoch: 49, Steps: 64 | Train Loss: 0.1216293 Vali Loss: 0.2654038 Test Loss: 0.3070347
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 50 cost time: 0.9228005409240723
Epoch: 50, Steps: 64 | Train Loss: 0.1223847 Vali Loss: 0.2672500 Test Loss: 0.3101014
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 51 cost time: 0.9210002422332764
Epoch: 51, Steps: 64 | Train Loss: 0.1217096 Vali Loss: 0.2635476 Test Loss: 0.3089725
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 52 cost time: 0.9130001068115234
Epoch: 52, Steps: 64 | Train Loss: 0.1225018 Vali Loss: 0.2641212 Test Loss: 0.3102106
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 53 cost time: 0.9180614948272705
Epoch: 53, Steps: 64 | Train Loss: 0.1220346 Vali Loss: 0.2617616 Test Loss: 0.3101748
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 54 cost time: 0.9344923496246338
Epoch: 54, Steps: 64 | Train Loss: 0.1219561 Vali Loss: 0.2636210 Test Loss: 0.3092799
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 55 cost time: 0.9254279136657715
Epoch: 55, Steps: 64 | Train Loss: 0.1214947 Vali Loss: 0.2631951 Test Loss: 0.3101015
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 56 cost time: 0.9433815479278564
Epoch: 56, Steps: 64 | Train Loss: 0.1221261 Vali Loss: 0.2637777 Test Loss: 0.3098274
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 57 cost time: 0.930842399597168
Epoch: 57, Steps: 64 | Train Loss: 0.1215288 Vali Loss: 0.2641004 Test Loss: 0.3085932
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 58 cost time: 0.9247369766235352
Epoch: 58, Steps: 64 | Train Loss: 0.1222068 Vali Loss: 0.2653028 Test Loss: 0.3102539
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 59 cost time: 0.9250001907348633
Epoch: 59, Steps: 64 | Train Loss: 0.1221215 Vali Loss: 0.2623922 Test Loss: 0.3082244
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 60 cost time: 0.9176778793334961
Epoch: 60, Steps: 64 | Train Loss: 0.1214986 Vali Loss: 0.2603858 Test Loss: 0.3087104
Validation loss decreased (0.260455 --> 0.260386).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.30871036648750305, mae:0.36918461322784424, rse:0.2550048232078552
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.036730289459228516 GB
Epoch: 1 cost time: 2.3193740844726562
Epoch: 1, Steps: 64 | Train Loss: 0.8664471 Vali Loss: 2.5203614 Test Loss: 4.5119543
Validation loss decreased (inf --> 2.520361).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 2 cost time: 0.9542107582092285
Epoch: 2, Steps: 64 | Train Loss: 0.6333054 Vali Loss: 1.2665101 Test Loss: 2.1041009
Validation loss decreased (2.520361 --> 1.266510).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 3 cost time: 0.9651083946228027
Epoch: 3, Steps: 64 | Train Loss: 0.3544635 Vali Loss: 0.7398038 Test Loss: 1.0722411
Validation loss decreased (1.266510 --> 0.739804).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 4 cost time: 0.9484186172485352
Epoch: 4, Steps: 64 | Train Loss: 0.2230328 Vali Loss: 0.4978203 Test Loss: 0.6086107
Validation loss decreased (0.739804 --> 0.497820).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 5 cost time: 0.9544162750244141
Epoch: 5, Steps: 64 | Train Loss: 0.1655966 Vali Loss: 0.3799498 Test Loss: 0.4348983
Validation loss decreased (0.497820 --> 0.379950).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 6 cost time: 0.9499025344848633
Epoch: 6, Steps: 64 | Train Loss: 0.1428126 Vali Loss: 0.3260619 Test Loss: 0.3655355
Validation loss decreased (0.379950 --> 0.326062).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 7 cost time: 0.9483249187469482
Epoch: 7, Steps: 64 | Train Loss: 0.1301772 Vali Loss: 0.2874560 Test Loss: 0.3364766
Validation loss decreased (0.326062 --> 0.287456).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 8 cost time: 0.9469997882843018
Epoch: 8, Steps: 64 | Train Loss: 0.1243939 Vali Loss: 0.2703833 Test Loss: 0.3195646
Validation loss decreased (0.287456 --> 0.270383).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 9 cost time: 0.948617696762085
Epoch: 9, Steps: 64 | Train Loss: 0.1204760 Vali Loss: 0.2610230 Test Loss: 0.3090119
Validation loss decreased (0.270383 --> 0.261023).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 10 cost time: 0.9513633251190186
Epoch: 10, Steps: 64 | Train Loss: 0.1162613 Vali Loss: 0.2551141 Test Loss: 0.3084497
Validation loss decreased (0.261023 --> 0.255114).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 11 cost time: 0.9532501697540283
Epoch: 11, Steps: 64 | Train Loss: 0.1141692 Vali Loss: 0.2491117 Test Loss: 0.3014129
Validation loss decreased (0.255114 --> 0.249112).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 12 cost time: 0.957467794418335
Epoch: 12, Steps: 64 | Train Loss: 0.1122667 Vali Loss: 0.2521046 Test Loss: 0.2977549
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 13 cost time: 0.9613463878631592
Epoch: 13, Steps: 64 | Train Loss: 0.1104299 Vali Loss: 0.2458373 Test Loss: 0.2981631
Validation loss decreased (0.249112 --> 0.245837).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 14 cost time: 0.948415994644165
Epoch: 14, Steps: 64 | Train Loss: 0.1089834 Vali Loss: 0.2449763 Test Loss: 0.2940965
Validation loss decreased (0.245837 --> 0.244976).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 15 cost time: 0.9508724212646484
Epoch: 15, Steps: 64 | Train Loss: 0.1076316 Vali Loss: 0.2422234 Test Loss: 0.2925912
Validation loss decreased (0.244976 --> 0.242223).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 16 cost time: 0.9547173976898193
Epoch: 16, Steps: 64 | Train Loss: 0.1071244 Vali Loss: 0.2389484 Test Loss: 0.2956116
Validation loss decreased (0.242223 --> 0.238948).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 17 cost time: 0.946000337600708
Epoch: 17, Steps: 64 | Train Loss: 0.1062508 Vali Loss: 0.2381464 Test Loss: 0.2913560
Validation loss decreased (0.238948 --> 0.238146).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 18 cost time: 0.9496340751647949
Epoch: 18, Steps: 64 | Train Loss: 0.1052632 Vali Loss: 0.2394785 Test Loss: 0.2927427
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 19 cost time: 0.9562442302703857
Epoch: 19, Steps: 64 | Train Loss: 0.1037640 Vali Loss: 0.2356691 Test Loss: 0.2900034
Validation loss decreased (0.238146 --> 0.235669).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 20 cost time: 0.9663345813751221
Epoch: 20, Steps: 64 | Train Loss: 0.1036111 Vali Loss: 0.2339695 Test Loss: 0.2903645
Validation loss decreased (0.235669 --> 0.233969).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 21 cost time: 0.95145583152771
Epoch: 21, Steps: 64 | Train Loss: 0.1036453 Vali Loss: 0.2359639 Test Loss: 0.2904874
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 22 cost time: 0.9533429145812988
Epoch: 22, Steps: 64 | Train Loss: 0.1029074 Vali Loss: 0.2342351 Test Loss: 0.2876859
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 23 cost time: 0.9494888782501221
Epoch: 23, Steps: 64 | Train Loss: 0.1014693 Vali Loss: 0.2315113 Test Loss: 0.2882571
Validation loss decreased (0.233969 --> 0.231511).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 24 cost time: 0.9419806003570557
Epoch: 24, Steps: 64 | Train Loss: 0.1020353 Vali Loss: 0.2321085 Test Loss: 0.2912636
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 25 cost time: 0.9448223114013672
Epoch: 25, Steps: 64 | Train Loss: 0.1020101 Vali Loss: 0.2349972 Test Loss: 0.2875884
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 26 cost time: 0.9589996337890625
Epoch: 26, Steps: 64 | Train Loss: 0.1010630 Vali Loss: 0.2338947 Test Loss: 0.2877154
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 27 cost time: 0.931990385055542
Epoch: 27, Steps: 64 | Train Loss: 0.1011067 Vali Loss: 0.2355735 Test Loss: 0.2877820
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 28 cost time: 0.9546165466308594
Epoch: 28, Steps: 64 | Train Loss: 0.1009681 Vali Loss: 0.2289310 Test Loss: 0.2877843
Validation loss decreased (0.231511 --> 0.228931).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 29 cost time: 0.9544470310211182
Epoch: 29, Steps: 64 | Train Loss: 0.1002388 Vali Loss: 0.2323694 Test Loss: 0.2876643
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 30 cost time: 0.9663503170013428
Epoch: 30, Steps: 64 | Train Loss: 0.1004433 Vali Loss: 0.2296712 Test Loss: 0.2864501
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 31 cost time: 0.9563674926757812
Epoch: 31, Steps: 64 | Train Loss: 0.1002767 Vali Loss: 0.2309248 Test Loss: 0.2876071
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 32 cost time: 0.9433629512786865
Epoch: 32, Steps: 64 | Train Loss: 0.1000612 Vali Loss: 0.2319997 Test Loss: 0.2872693
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 33 cost time: 0.9510593414306641
Epoch: 33, Steps: 64 | Train Loss: 0.0993551 Vali Loss: 0.2292252 Test Loss: 0.2858020
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 34 cost time: 0.943000078201294
Epoch: 34, Steps: 64 | Train Loss: 0.0995990 Vali Loss: 0.2262098 Test Loss: 0.2865665
Validation loss decreased (0.228931 --> 0.226210).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 35 cost time: 0.9439997673034668
Epoch: 35, Steps: 64 | Train Loss: 0.1000237 Vali Loss: 0.2282324 Test Loss: 0.2873720
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 36 cost time: 0.9476139545440674
Epoch: 36, Steps: 64 | Train Loss: 0.0993433 Vali Loss: 0.2332417 Test Loss: 0.2892150
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 37 cost time: 0.9503624439239502
Epoch: 37, Steps: 64 | Train Loss: 0.1000084 Vali Loss: 0.2331921 Test Loss: 0.2875203
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 38 cost time: 0.9543578624725342
Epoch: 38, Steps: 64 | Train Loss: 0.0995350 Vali Loss: 0.2299013 Test Loss: 0.2862791
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 39 cost time: 0.957430362701416
Epoch: 39, Steps: 64 | Train Loss: 0.0999461 Vali Loss: 0.2297825 Test Loss: 0.2858176
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 40 cost time: 0.9328994750976562
Epoch: 40, Steps: 64 | Train Loss: 0.0993602 Vali Loss: 0.2308737 Test Loss: 0.2860738
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 41 cost time: 0.9463675022125244
Epoch: 41, Steps: 64 | Train Loss: 0.0988450 Vali Loss: 0.2286175 Test Loss: 0.2879061
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 42 cost time: 0.9477648735046387
Epoch: 42, Steps: 64 | Train Loss: 0.0993552 Vali Loss: 0.2315705 Test Loss: 0.2860034
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 43 cost time: 0.9530029296875
Epoch: 43, Steps: 64 | Train Loss: 0.0990075 Vali Loss: 0.2287531 Test Loss: 0.2871678
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 44 cost time: 0.9499874114990234
Epoch: 44, Steps: 64 | Train Loss: 0.0988211 Vali Loss: 0.2289957 Test Loss: 0.2861390
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 45 cost time: 0.9556155204772949
Epoch: 45, Steps: 64 | Train Loss: 0.0988860 Vali Loss: 0.2267347 Test Loss: 0.2859100
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 46 cost time: 0.9513475894927979
Epoch: 46, Steps: 64 | Train Loss: 0.0988501 Vali Loss: 0.2289608 Test Loss: 0.2849927
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 47 cost time: 0.9590182304382324
Epoch: 47, Steps: 64 | Train Loss: 0.0986465 Vali Loss: 0.2324500 Test Loss: 0.2846221
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 48 cost time: 0.9484620094299316
Epoch: 48, Steps: 64 | Train Loss: 0.0993421 Vali Loss: 0.2288404 Test Loss: 0.2873528
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 49 cost time: 0.947350025177002
Epoch: 49, Steps: 64 | Train Loss: 0.0986696 Vali Loss: 0.2280568 Test Loss: 0.2851402
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 50 cost time: 0.954719066619873
Epoch: 50, Steps: 64 | Train Loss: 0.0983880 Vali Loss: 0.2311763 Test Loss: 0.2867629
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 51 cost time: 0.9497280120849609
Epoch: 51, Steps: 64 | Train Loss: 0.0988669 Vali Loss: 0.2279721 Test Loss: 0.2856543
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 52 cost time: 0.9473989009857178
Epoch: 52, Steps: 64 | Train Loss: 0.0989027 Vali Loss: 0.2286454 Test Loss: 0.2873511
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 53 cost time: 0.9486205577850342
Epoch: 53, Steps: 64 | Train Loss: 0.0988635 Vali Loss: 0.2305126 Test Loss: 0.2866048
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 54 cost time: 0.9523391723632812
Epoch: 54, Steps: 64 | Train Loss: 0.0983405 Vali Loss: 0.2307595 Test Loss: 0.2868514
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 55 cost time: 0.9503800868988037
Epoch: 55, Steps: 64 | Train Loss: 0.0985707 Vali Loss: 0.2289452 Test Loss: 0.2861093
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 56 cost time: 0.9559004306793213
Epoch: 56, Steps: 64 | Train Loss: 0.0982691 Vali Loss: 0.2291907 Test Loss: 0.2859538
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 57 cost time: 0.9613335132598877
Epoch: 57, Steps: 64 | Train Loss: 0.0980998 Vali Loss: 0.2265220 Test Loss: 0.2866454
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 58 cost time: 0.945375919342041
Epoch: 58, Steps: 64 | Train Loss: 0.0983657 Vali Loss: 0.2293301 Test Loss: 0.2859688
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 59 cost time: 0.9477024078369141
Epoch: 59, Steps: 64 | Train Loss: 0.0990085 Vali Loss: 0.2301614 Test Loss: 0.2864174
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 60 cost time: 0.9437165260314941
Epoch: 60, Steps: 64 | Train Loss: 0.0982889 Vali Loss: 0.2290303 Test Loss: 0.2866341
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2865664064884186, mae:0.33874231576919556, rse:0.24568885564804077
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03729438781738281 GB
Epoch: 1 cost time: 2.342721462249756
Epoch: 1, Steps: 64 | Train Loss: 0.8305170 Vali Loss: 2.5916626 Test Loss: 4.5023909
Validation loss decreased (inf --> 2.591663).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 2 cost time: 0.9816150665283203
Epoch: 2, Steps: 64 | Train Loss: 0.6972676 Vali Loss: 1.7586043 Test Loss: 2.9105771
Validation loss decreased (2.591663 --> 1.758604).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 3 cost time: 0.9833676815032959
Epoch: 3, Steps: 64 | Train Loss: 0.4409344 Vali Loss: 0.9840192 Test Loss: 1.4233148
Validation loss decreased (1.758604 --> 0.984019).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 4 cost time: 1.0664937496185303
Epoch: 4, Steps: 64 | Train Loss: 0.2439510 Vali Loss: 0.5616650 Test Loss: 0.6317726
Validation loss decreased (0.984019 --> 0.561665).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 5 cost time: 1.0687692165374756
Epoch: 5, Steps: 64 | Train Loss: 0.1544410 Vali Loss: 0.4034913 Test Loss: 0.3876596
Validation loss decreased (0.561665 --> 0.403491).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 6 cost time: 1.077085256576538
Epoch: 6, Steps: 64 | Train Loss: 0.1273039 Vali Loss: 0.3182991 Test Loss: 0.3297037
Validation loss decreased (0.403491 --> 0.318299).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 7 cost time: 0.9608759880065918
Epoch: 7, Steps: 64 | Train Loss: 0.1166221 Vali Loss: 0.2735617 Test Loss: 0.3013881
Validation loss decreased (0.318299 --> 0.273562).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 8 cost time: 0.9733407497406006
Epoch: 8, Steps: 64 | Train Loss: 0.1115074 Vali Loss: 0.2732349 Test Loss: 0.3038345
Validation loss decreased (0.273562 --> 0.273235).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 9 cost time: 0.9804236888885498
Epoch: 9, Steps: 64 | Train Loss: 0.1078518 Vali Loss: 0.2610895 Test Loss: 0.2989542
Validation loss decreased (0.273235 --> 0.261090).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 10 cost time: 0.98836350440979
Epoch: 10, Steps: 64 | Train Loss: 0.1052320 Vali Loss: 0.2576016 Test Loss: 0.3007741
Validation loss decreased (0.261090 --> 0.257602).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 11 cost time: 0.9779174327850342
Epoch: 11, Steps: 64 | Train Loss: 0.1040914 Vali Loss: 0.2467092 Test Loss: 0.2928114
Validation loss decreased (0.257602 --> 0.246709).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 12 cost time: 0.980421781539917
Epoch: 12, Steps: 64 | Train Loss: 0.1022262 Vali Loss: 0.2508835 Test Loss: 0.2993068
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 13 cost time: 0.9927287101745605
Epoch: 13, Steps: 64 | Train Loss: 0.1010773 Vali Loss: 0.2444033 Test Loss: 0.2960467
Validation loss decreased (0.246709 --> 0.244403).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 14 cost time: 0.9728209972381592
Epoch: 14, Steps: 64 | Train Loss: 0.0996440 Vali Loss: 0.2479000 Test Loss: 0.2972526
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 15 cost time: 0.9730000495910645
Epoch: 15, Steps: 64 | Train Loss: 0.0993451 Vali Loss: 0.2457496 Test Loss: 0.2950894
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 16 cost time: 0.980633020401001
Epoch: 16, Steps: 64 | Train Loss: 0.0980571 Vali Loss: 0.2463929 Test Loss: 0.2978294
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 17 cost time: 0.993032693862915
Epoch: 17, Steps: 64 | Train Loss: 0.0974118 Vali Loss: 0.2414932 Test Loss: 0.2960849
Validation loss decreased (0.244403 --> 0.241493).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 18 cost time: 0.9850378036499023
Epoch: 18, Steps: 64 | Train Loss: 0.0970998 Vali Loss: 0.2425929 Test Loss: 0.2978323
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 19 cost time: 0.9814176559448242
Epoch: 19, Steps: 64 | Train Loss: 0.0964577 Vali Loss: 0.2425527 Test Loss: 0.2960206
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 20 cost time: 0.9715743064880371
Epoch: 20, Steps: 64 | Train Loss: 0.0960866 Vali Loss: 0.2407328 Test Loss: 0.2969796
Validation loss decreased (0.241493 --> 0.240733).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 21 cost time: 0.9830114841461182
Epoch: 21, Steps: 64 | Train Loss: 0.0961456 Vali Loss: 0.2406728 Test Loss: 0.2989894
Validation loss decreased (0.240733 --> 0.240673).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 22 cost time: 0.9784884452819824
Epoch: 22, Steps: 64 | Train Loss: 0.0957066 Vali Loss: 0.2390275 Test Loss: 0.2961961
Validation loss decreased (0.240673 --> 0.239027).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 23 cost time: 0.9764306545257568
Epoch: 23, Steps: 64 | Train Loss: 0.0955321 Vali Loss: 0.2391622 Test Loss: 0.2956882
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 24 cost time: 0.9723880290985107
Epoch: 24, Steps: 64 | Train Loss: 0.0950924 Vali Loss: 0.2407504 Test Loss: 0.2957659
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 25 cost time: 0.9772670269012451
Epoch: 25, Steps: 64 | Train Loss: 0.0947330 Vali Loss: 0.2388534 Test Loss: 0.2967138
Validation loss decreased (0.239027 --> 0.238853).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 26 cost time: 0.9843106269836426
Epoch: 26, Steps: 64 | Train Loss: 0.0941625 Vali Loss: 0.2356016 Test Loss: 0.2955111
Validation loss decreased (0.238853 --> 0.235602).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 27 cost time: 0.9730000495910645
Epoch: 27, Steps: 64 | Train Loss: 0.0938748 Vali Loss: 0.2387434 Test Loss: 0.2958089
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 28 cost time: 0.9766302108764648
Epoch: 28, Steps: 64 | Train Loss: 0.0942370 Vali Loss: 0.2402962 Test Loss: 0.2964650
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 29 cost time: 0.9860579967498779
Epoch: 29, Steps: 64 | Train Loss: 0.0939734 Vali Loss: 0.2378491 Test Loss: 0.2951287
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 30 cost time: 0.9723663330078125
Epoch: 30, Steps: 64 | Train Loss: 0.0937607 Vali Loss: 0.2366651 Test Loss: 0.2951562
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 31 cost time: 0.976485013961792
Epoch: 31, Steps: 64 | Train Loss: 0.0938038 Vali Loss: 0.2352341 Test Loss: 0.2962225
Validation loss decreased (0.235602 --> 0.235234).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 32 cost time: 0.9713659286499023
Epoch: 32, Steps: 64 | Train Loss: 0.0934434 Vali Loss: 0.2402427 Test Loss: 0.2952364
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 33 cost time: 0.9824516773223877
Epoch: 33, Steps: 64 | Train Loss: 0.0936333 Vali Loss: 0.2385005 Test Loss: 0.2954446
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 34 cost time: 0.9673211574554443
Epoch: 34, Steps: 64 | Train Loss: 0.0932864 Vali Loss: 0.2347309 Test Loss: 0.2940573
Validation loss decreased (0.235234 --> 0.234731).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 35 cost time: 0.9764370918273926
Epoch: 35, Steps: 64 | Train Loss: 0.0933361 Vali Loss: 0.2333002 Test Loss: 0.2949088
Validation loss decreased (0.234731 --> 0.233300).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 36 cost time: 0.9967854022979736
Epoch: 36, Steps: 64 | Train Loss: 0.0930988 Vali Loss: 0.2367350 Test Loss: 0.2948438
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 37 cost time: 0.9732682704925537
Epoch: 37, Steps: 64 | Train Loss: 0.0932236 Vali Loss: 0.2362588 Test Loss: 0.2959349
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 38 cost time: 0.9796133041381836
Epoch: 38, Steps: 64 | Train Loss: 0.0932274 Vali Loss: 0.2385316 Test Loss: 0.2946394
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 39 cost time: 0.9786159992218018
Epoch: 39, Steps: 64 | Train Loss: 0.0933020 Vali Loss: 0.2327357 Test Loss: 0.2962599
Validation loss decreased (0.233300 --> 0.232736).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 40 cost time: 0.9706287384033203
Epoch: 40, Steps: 64 | Train Loss: 0.0934039 Vali Loss: 0.2386535 Test Loss: 0.2948776
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 41 cost time: 0.9727287292480469
Epoch: 41, Steps: 64 | Train Loss: 0.0933854 Vali Loss: 0.2323601 Test Loss: 0.2960138
Validation loss decreased (0.232736 --> 0.232360).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 42 cost time: 0.9695196151733398
Epoch: 42, Steps: 64 | Train Loss: 0.0933857 Vali Loss: 0.2358584 Test Loss: 0.2971485
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 43 cost time: 0.9664444923400879
Epoch: 43, Steps: 64 | Train Loss: 0.0928539 Vali Loss: 0.2360816 Test Loss: 0.2961812
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 44 cost time: 0.9774057865142822
Epoch: 44, Steps: 64 | Train Loss: 0.0930148 Vali Loss: 0.2342292 Test Loss: 0.2941416
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 45 cost time: 0.9763925075531006
Epoch: 45, Steps: 64 | Train Loss: 0.0928377 Vali Loss: 0.2343608 Test Loss: 0.2945925
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 46 cost time: 0.96484375
Epoch: 46, Steps: 64 | Train Loss: 0.0928495 Vali Loss: 0.2344401 Test Loss: 0.2966992
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 47 cost time: 0.9767725467681885
Epoch: 47, Steps: 64 | Train Loss: 0.0926314 Vali Loss: 0.2332297 Test Loss: 0.2951011
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 48 cost time: 0.9775512218475342
Epoch: 48, Steps: 64 | Train Loss: 0.0926986 Vali Loss: 0.2362705 Test Loss: 0.2956534
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 49 cost time: 0.9905714988708496
Epoch: 49, Steps: 64 | Train Loss: 0.0922808 Vali Loss: 0.2373389 Test Loss: 0.2960957
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 50 cost time: 0.9750003814697266
Epoch: 50, Steps: 64 | Train Loss: 0.0929727 Vali Loss: 0.2328757 Test Loss: 0.2954296
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 51 cost time: 0.9694397449493408
Epoch: 51, Steps: 64 | Train Loss: 0.0928699 Vali Loss: 0.2336722 Test Loss: 0.2960755
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 52 cost time: 0.9823884963989258
Epoch: 52, Steps: 64 | Train Loss: 0.0927119 Vali Loss: 0.2333694 Test Loss: 0.2971743
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 53 cost time: 0.9802289009094238
Epoch: 53, Steps: 64 | Train Loss: 0.0926043 Vali Loss: 0.2363623 Test Loss: 0.2961648
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 54 cost time: 0.9823369979858398
Epoch: 54, Steps: 64 | Train Loss: 0.0928453 Vali Loss: 0.2348762 Test Loss: 0.2980860
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 55 cost time: 0.9843742847442627
Epoch: 55, Steps: 64 | Train Loss: 0.0921974 Vali Loss: 0.2352366 Test Loss: 0.2969605
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 56 cost time: 0.9840183258056641
Epoch: 56, Steps: 64 | Train Loss: 0.0928255 Vali Loss: 0.2330073 Test Loss: 0.2979400
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 57 cost time: 0.9748032093048096
Epoch: 57, Steps: 64 | Train Loss: 0.0927951 Vali Loss: 0.2366899 Test Loss: 0.2955365
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 58 cost time: 0.9732944965362549
Epoch: 58, Steps: 64 | Train Loss: 0.0929997 Vali Loss: 0.2345745 Test Loss: 0.2963690
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 59 cost time: 0.9679996967315674
Epoch: 59, Steps: 64 | Train Loss: 0.0927263 Vali Loss: 0.2355850 Test Loss: 0.2960896
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 60 cost time: 0.9739997386932373
Epoch: 60, Steps: 64 | Train Loss: 0.0930333 Vali Loss: 0.2330638 Test Loss: 0.2950058
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2960137724876404, mae:0.35646361112594604, rse:0.24970588088035583
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.036190032958984375 GB
Epoch: 1 cost time: 2.2884433269500732
Epoch: 1, Steps: 64 | Train Loss: 1.1432607 Vali Loss: 3.2212367 Test Loss: 5.2837958
Validation loss decreased (inf --> 3.221237).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 2 cost time: 0.9637072086334229
Epoch: 2, Steps: 64 | Train Loss: 0.6731398 Vali Loss: 1.1406786 Test Loss: 1.6102266
Validation loss decreased (3.221237 --> 1.140679).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 3 cost time: 0.8843014240264893
Epoch: 3, Steps: 64 | Train Loss: 0.3819998 Vali Loss: 0.8711369 Test Loss: 1.1740963
Validation loss decreased (1.140679 --> 0.871137).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 4 cost time: 0.8864331245422363
Epoch: 4, Steps: 64 | Train Loss: 0.2972715 Vali Loss: 0.6998093 Test Loss: 0.8741384
Validation loss decreased (0.871137 --> 0.699809).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 5 cost time: 0.8843846321105957
Epoch: 5, Steps: 64 | Train Loss: 0.2423583 Vali Loss: 0.5769703 Test Loss: 0.6959678
Validation loss decreased (0.699809 --> 0.576970).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 6 cost time: 0.861513614654541
Epoch: 6, Steps: 64 | Train Loss: 0.2093605 Vali Loss: 0.4966809 Test Loss: 0.5762652
Validation loss decreased (0.576970 --> 0.496681).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 7 cost time: 0.8616220951080322
Epoch: 7, Steps: 64 | Train Loss: 0.1874601 Vali Loss: 0.4291422 Test Loss: 0.5064693
Validation loss decreased (0.496681 --> 0.429142).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 8 cost time: 0.8626203536987305
Epoch: 8, Steps: 64 | Train Loss: 0.1733380 Vali Loss: 0.3889995 Test Loss: 0.4552017
Validation loss decreased (0.429142 --> 0.389000).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 9 cost time: 0.8613491058349609
Epoch: 9, Steps: 64 | Train Loss: 0.1607939 Vali Loss: 0.3602044 Test Loss: 0.4125585
Validation loss decreased (0.389000 --> 0.360204).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 10 cost time: 0.860360860824585
Epoch: 10, Steps: 64 | Train Loss: 0.1532300 Vali Loss: 0.3353164 Test Loss: 0.3910973
Validation loss decreased (0.360204 --> 0.335316).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 11 cost time: 0.8724372386932373
Epoch: 11, Steps: 64 | Train Loss: 0.1465957 Vali Loss: 0.3196729 Test Loss: 0.3684363
Validation loss decreased (0.335316 --> 0.319673).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 12 cost time: 0.8749997615814209
Epoch: 12, Steps: 64 | Train Loss: 0.1429700 Vali Loss: 0.3064330 Test Loss: 0.3550352
Validation loss decreased (0.319673 --> 0.306433).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 13 cost time: 0.887608528137207
Epoch: 13, Steps: 64 | Train Loss: 0.1395015 Vali Loss: 0.3015355 Test Loss: 0.3455059
Validation loss decreased (0.306433 --> 0.301535).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 14 cost time: 0.8714301586151123
Epoch: 14, Steps: 64 | Train Loss: 0.1372476 Vali Loss: 0.2928883 Test Loss: 0.3394574
Validation loss decreased (0.301535 --> 0.292888).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 15 cost time: 0.8594932556152344
Epoch: 15, Steps: 64 | Train Loss: 0.1347564 Vali Loss: 0.2915363 Test Loss: 0.3332120
Validation loss decreased (0.292888 --> 0.291536).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 16 cost time: 0.862966775894165
Epoch: 16, Steps: 64 | Train Loss: 0.1327466 Vali Loss: 0.2817176 Test Loss: 0.3279070
Validation loss decreased (0.291536 --> 0.281718).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 17 cost time: 0.8747344017028809
Epoch: 17, Steps: 64 | Train Loss: 0.1303043 Vali Loss: 0.2790930 Test Loss: 0.3224007
Validation loss decreased (0.281718 --> 0.279093).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 18 cost time: 0.8759994506835938
Epoch: 18, Steps: 64 | Train Loss: 0.1291450 Vali Loss: 0.2791878 Test Loss: 0.3220692
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 19 cost time: 0.8846144676208496
Epoch: 19, Steps: 64 | Train Loss: 0.1285050 Vali Loss: 0.2746767 Test Loss: 0.3176427
Validation loss decreased (0.279093 --> 0.274677).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 20 cost time: 0.8870618343353271
Epoch: 20, Steps: 64 | Train Loss: 0.1267808 Vali Loss: 0.2721670 Test Loss: 0.3164544
Validation loss decreased (0.274677 --> 0.272167).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 21 cost time: 0.885826826095581
Epoch: 21, Steps: 64 | Train Loss: 0.1262363 Vali Loss: 0.2721514 Test Loss: 0.3156093
Validation loss decreased (0.272167 --> 0.272151).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 22 cost time: 0.8853566646575928
Epoch: 22, Steps: 64 | Train Loss: 0.1251619 Vali Loss: 0.2717083 Test Loss: 0.3142364
Validation loss decreased (0.272151 --> 0.271708).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 23 cost time: 0.8837072849273682
Epoch: 23, Steps: 64 | Train Loss: 0.1242322 Vali Loss: 0.2673068 Test Loss: 0.3123917
Validation loss decreased (0.271708 --> 0.267307).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 24 cost time: 0.8670086860656738
Epoch: 24, Steps: 64 | Train Loss: 0.1230474 Vali Loss: 0.2668357 Test Loss: 0.3108498
Validation loss decreased (0.267307 --> 0.266836).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 25 cost time: 0.8636195659637451
Epoch: 25, Steps: 64 | Train Loss: 0.1229781 Vali Loss: 0.2670340 Test Loss: 0.3109130
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 26 cost time: 0.8605070114135742
Epoch: 26, Steps: 64 | Train Loss: 0.1226785 Vali Loss: 0.2647834 Test Loss: 0.3093704
Validation loss decreased (0.266836 --> 0.264783).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 27 cost time: 0.8583369255065918
Epoch: 27, Steps: 64 | Train Loss: 0.1220757 Vali Loss: 0.2662204 Test Loss: 0.3104585
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 28 cost time: 0.8695149421691895
Epoch: 28, Steps: 64 | Train Loss: 0.1220735 Vali Loss: 0.2641603 Test Loss: 0.3081565
Validation loss decreased (0.264783 --> 0.264160).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 29 cost time: 0.8713607788085938
Epoch: 29, Steps: 64 | Train Loss: 0.1219353 Vali Loss: 0.2621731 Test Loss: 0.3072263
Validation loss decreased (0.264160 --> 0.262173).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 30 cost time: 0.8759994506835938
Epoch: 30, Steps: 64 | Train Loss: 0.1208763 Vali Loss: 0.2617756 Test Loss: 0.3065489
Validation loss decreased (0.262173 --> 0.261776).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 31 cost time: 0.8783643245697021
Epoch: 31, Steps: 64 | Train Loss: 0.1214012 Vali Loss: 0.2635157 Test Loss: 0.3058239
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 32 cost time: 0.8613605499267578
Epoch: 32, Steps: 64 | Train Loss: 0.1200918 Vali Loss: 0.2597673 Test Loss: 0.3072712
Validation loss decreased (0.261776 --> 0.259767).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 33 cost time: 0.8693649768829346
Epoch: 33, Steps: 64 | Train Loss: 0.1201738 Vali Loss: 0.2610345 Test Loss: 0.3061078
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 34 cost time: 0.8627419471740723
Epoch: 34, Steps: 64 | Train Loss: 0.1198270 Vali Loss: 0.2598852 Test Loss: 0.3049269
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 35 cost time: 0.875999927520752
Epoch: 35, Steps: 64 | Train Loss: 0.1208113 Vali Loss: 0.2622772 Test Loss: 0.3057977
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 36 cost time: 0.8656411170959473
Epoch: 36, Steps: 64 | Train Loss: 0.1193846 Vali Loss: 0.2615251 Test Loss: 0.3045115
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 37 cost time: 0.8633706569671631
Epoch: 37, Steps: 64 | Train Loss: 0.1197750 Vali Loss: 0.2619821 Test Loss: 0.3054037
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 38 cost time: 0.86936354637146
Epoch: 38, Steps: 64 | Train Loss: 0.1204087 Vali Loss: 0.2595925 Test Loss: 0.3051222
Validation loss decreased (0.259767 --> 0.259592).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 39 cost time: 0.887359619140625
Epoch: 39, Steps: 64 | Train Loss: 0.1199558 Vali Loss: 0.2603287 Test Loss: 0.3049168
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 40 cost time: 0.878000020980835
Epoch: 40, Steps: 64 | Train Loss: 0.1200968 Vali Loss: 0.2625815 Test Loss: 0.3051620
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 41 cost time: 0.8789992332458496
Epoch: 41, Steps: 64 | Train Loss: 0.1190826 Vali Loss: 0.2591870 Test Loss: 0.3046368
Validation loss decreased (0.259592 --> 0.259187).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 42 cost time: 0.8783414363861084
Epoch: 42, Steps: 64 | Train Loss: 0.1192692 Vali Loss: 0.2620716 Test Loss: 0.3059821
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 43 cost time: 0.8673393726348877
Epoch: 43, Steps: 64 | Train Loss: 0.1185299 Vali Loss: 0.2592982 Test Loss: 0.3034141
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 44 cost time: 0.8663864135742188
Epoch: 44, Steps: 64 | Train Loss: 0.1186014 Vali Loss: 0.2575963 Test Loss: 0.3036104
Validation loss decreased (0.259187 --> 0.257596).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 45 cost time: 0.8638584613800049
Epoch: 45, Steps: 64 | Train Loss: 0.1182985 Vali Loss: 0.2584835 Test Loss: 0.3034887
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 46 cost time: 0.8680000305175781
Epoch: 46, Steps: 64 | Train Loss: 0.1184139 Vali Loss: 0.2575352 Test Loss: 0.3038113
Validation loss decreased (0.257596 --> 0.257535).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 47 cost time: 0.8718230724334717
Epoch: 47, Steps: 64 | Train Loss: 0.1180975 Vali Loss: 0.2560799 Test Loss: 0.3034278
Validation loss decreased (0.257535 --> 0.256080).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 48 cost time: 0.8682518005371094
Epoch: 48, Steps: 64 | Train Loss: 0.1181942 Vali Loss: 0.2605714 Test Loss: 0.3042327
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 49 cost time: 0.8763916492462158
Epoch: 49, Steps: 64 | Train Loss: 0.1182798 Vali Loss: 0.2596419 Test Loss: 0.3045286
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 50 cost time: 0.8733429908752441
Epoch: 50, Steps: 64 | Train Loss: 0.1189269 Vali Loss: 0.2562176 Test Loss: 0.3038223
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 51 cost time: 0.8697502613067627
Epoch: 51, Steps: 64 | Train Loss: 0.1186827 Vali Loss: 0.2573508 Test Loss: 0.3033167
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 52 cost time: 0.8630001544952393
Epoch: 52, Steps: 64 | Train Loss: 0.1181874 Vali Loss: 0.2565873 Test Loss: 0.3040202
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 53 cost time: 0.8636126518249512
Epoch: 53, Steps: 64 | Train Loss: 0.1178039 Vali Loss: 0.2555732 Test Loss: 0.3018195
Validation loss decreased (0.256080 --> 0.255573).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 54 cost time: 0.8433234691619873
Epoch: 54, Steps: 64 | Train Loss: 0.1184739 Vali Loss: 0.2588255 Test Loss: 0.3038639
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 55 cost time: 0.8613641262054443
Epoch: 55, Steps: 64 | Train Loss: 0.1180372 Vali Loss: 0.2593050 Test Loss: 0.3039511
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 56 cost time: 0.8712377548217773
Epoch: 56, Steps: 64 | Train Loss: 0.1184318 Vali Loss: 0.2565872 Test Loss: 0.3034746
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 57 cost time: 0.8899998664855957
Epoch: 57, Steps: 64 | Train Loss: 0.1182513 Vali Loss: 0.2572981 Test Loss: 0.3023450
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 58 cost time: 0.8746531009674072
Epoch: 58, Steps: 64 | Train Loss: 0.1182385 Vali Loss: 0.2586364 Test Loss: 0.3054118
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 59 cost time: 0.8733716011047363
Epoch: 59, Steps: 64 | Train Loss: 0.1181346 Vali Loss: 0.2585558 Test Loss: 0.3024622
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 60 cost time: 0.876152515411377
Epoch: 60, Steps: 64 | Train Loss: 0.1183132 Vali Loss: 0.2562330 Test Loss: 0.3024907
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.30181944370269775, mae:0.3673849403858185, rse:0.25214269757270813
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.03689146041870117 GB
Epoch: 1 cost time: 2.321552038192749
Epoch: 1, Steps: 64 | Train Loss: 0.9505324 Vali Loss: 2.8584967 Test Loss: 4.9735761
Validation loss decreased (inf --> 2.858497).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 2 cost time: 0.9542877674102783
Epoch: 2, Steps: 64 | Train Loss: 0.6330818 Vali Loss: 1.2817103 Test Loss: 2.0262010
Validation loss decreased (2.858497 --> 1.281710).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 3 cost time: 0.9647667407989502
Epoch: 3, Steps: 64 | Train Loss: 0.3432434 Vali Loss: 0.7509286 Test Loss: 1.0405334
Validation loss decreased (1.281710 --> 0.750929).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 4 cost time: 0.9413275718688965
Epoch: 4, Steps: 64 | Train Loss: 0.2059806 Vali Loss: 0.4835292 Test Loss: 0.5740978
Validation loss decreased (0.750929 --> 0.483529).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 5 cost time: 0.9599699974060059
Epoch: 5, Steps: 64 | Train Loss: 0.1500395 Vali Loss: 0.3713573 Test Loss: 0.4052579
Validation loss decreased (0.483529 --> 0.371357).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 6 cost time: 0.9496192932128906
Epoch: 6, Steps: 64 | Train Loss: 0.1305165 Vali Loss: 0.3181479 Test Loss: 0.3454667
Validation loss decreased (0.371357 --> 0.318148).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 7 cost time: 0.9573755264282227
Epoch: 7, Steps: 64 | Train Loss: 0.1237853 Vali Loss: 0.3030855 Test Loss: 0.3284201
Validation loss decreased (0.318148 --> 0.303086).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 8 cost time: 0.9523770809173584
Epoch: 8, Steps: 64 | Train Loss: 0.1182625 Vali Loss: 0.2894674 Test Loss: 0.3192358
Validation loss decreased (0.303086 --> 0.289467).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 9 cost time: 0.953160285949707
Epoch: 9, Steps: 64 | Train Loss: 0.1152676 Vali Loss: 0.2809312 Test Loss: 0.3129147
Validation loss decreased (0.289467 --> 0.280931).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 10 cost time: 0.9674274921417236
Epoch: 10, Steps: 64 | Train Loss: 0.1129480 Vali Loss: 0.2750635 Test Loss: 0.3095362
Validation loss decreased (0.280931 --> 0.275064).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 11 cost time: 0.9614391326904297
Epoch: 11, Steps: 64 | Train Loss: 0.1111278 Vali Loss: 0.2717345 Test Loss: 0.3097072
Validation loss decreased (0.275064 --> 0.271735).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 12 cost time: 0.9664347171783447
Epoch: 12, Steps: 64 | Train Loss: 0.1096410 Vali Loss: 0.2717383 Test Loss: 0.3084072
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 13 cost time: 0.9577498435974121
Epoch: 13, Steps: 64 | Train Loss: 0.1082354 Vali Loss: 0.2662506 Test Loss: 0.3051380
Validation loss decreased (0.271735 --> 0.266251).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 14 cost time: 0.9569997787475586
Epoch: 14, Steps: 64 | Train Loss: 0.1068613 Vali Loss: 0.2679676 Test Loss: 0.3049017
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 15 cost time: 0.9490008354187012
Epoch: 15, Steps: 64 | Train Loss: 0.1055736 Vali Loss: 0.2666905 Test Loss: 0.3028618
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 16 cost time: 0.9486269950866699
Epoch: 16, Steps: 64 | Train Loss: 0.1042595 Vali Loss: 0.2603432 Test Loss: 0.3033950
Validation loss decreased (0.266251 --> 0.260343).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 17 cost time: 0.9623610973358154
Epoch: 17, Steps: 64 | Train Loss: 0.1045449 Vali Loss: 0.2630213 Test Loss: 0.3023959
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 18 cost time: 0.9594178199768066
Epoch: 18, Steps: 64 | Train Loss: 0.1034440 Vali Loss: 0.2597070 Test Loss: 0.3040774
Validation loss decreased (0.260343 --> 0.259707).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 19 cost time: 0.966332197189331
Epoch: 19, Steps: 64 | Train Loss: 0.1033956 Vali Loss: 0.2614311 Test Loss: 0.3005120
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 20 cost time: 0.9673840999603271
Epoch: 20, Steps: 64 | Train Loss: 0.1027524 Vali Loss: 0.2563669 Test Loss: 0.3015910
Validation loss decreased (0.259707 --> 0.256367).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 21 cost time: 0.9623498916625977
Epoch: 21, Steps: 64 | Train Loss: 0.1022761 Vali Loss: 0.2565804 Test Loss: 0.3025924
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 22 cost time: 0.9584579467773438
Epoch: 22, Steps: 64 | Train Loss: 0.1017066 Vali Loss: 0.2587319 Test Loss: 0.2999803
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 23 cost time: 0.9507293701171875
Epoch: 23, Steps: 64 | Train Loss: 0.1016064 Vali Loss: 0.2587036 Test Loss: 0.3010343
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 24 cost time: 0.9320008754730225
Epoch: 24, Steps: 64 | Train Loss: 0.1014814 Vali Loss: 0.2535739 Test Loss: 0.3013126
Validation loss decreased (0.256367 --> 0.253574).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 25 cost time: 0.933612585067749
Epoch: 25, Steps: 64 | Train Loss: 0.1009615 Vali Loss: 0.2561889 Test Loss: 0.2998598
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 26 cost time: 0.9483644962310791
Epoch: 26, Steps: 64 | Train Loss: 0.1003075 Vali Loss: 0.2578987 Test Loss: 0.3000837
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 27 cost time: 0.9653706550598145
Epoch: 27, Steps: 64 | Train Loss: 0.1002198 Vali Loss: 0.2587651 Test Loss: 0.2998823
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 28 cost time: 0.9673500061035156
Epoch: 28, Steps: 64 | Train Loss: 0.0999799 Vali Loss: 0.2556972 Test Loss: 0.2999611
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 29 cost time: 0.9603252410888672
Epoch: 29, Steps: 64 | Train Loss: 0.1002623 Vali Loss: 0.2591156 Test Loss: 0.3005619
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 30 cost time: 0.9608356952667236
Epoch: 30, Steps: 64 | Train Loss: 0.0998654 Vali Loss: 0.2569360 Test Loss: 0.3009016
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 31 cost time: 1.0564322471618652
Epoch: 31, Steps: 64 | Train Loss: 0.0995660 Vali Loss: 0.2559077 Test Loss: 0.3006708
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 32 cost time: 1.0583982467651367
Epoch: 32, Steps: 64 | Train Loss: 0.0998699 Vali Loss: 0.2528297 Test Loss: 0.2998035
Validation loss decreased (0.253574 --> 0.252830).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 33 cost time: 1.065443992614746
Epoch: 33, Steps: 64 | Train Loss: 0.0996087 Vali Loss: 0.2544415 Test Loss: 0.2990856
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 34 cost time: 0.9599318504333496
Epoch: 34, Steps: 64 | Train Loss: 0.0992464 Vali Loss: 0.2573495 Test Loss: 0.2999864
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 35 cost time: 0.9687209129333496
Epoch: 35, Steps: 64 | Train Loss: 0.0993997 Vali Loss: 0.2546953 Test Loss: 0.2999231
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 36 cost time: 0.9729993343353271
Epoch: 36, Steps: 64 | Train Loss: 0.0989954 Vali Loss: 0.2551590 Test Loss: 0.2993242
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 37 cost time: 0.9796125888824463
Epoch: 37, Steps: 64 | Train Loss: 0.0993138 Vali Loss: 0.2505910 Test Loss: 0.2998575
Validation loss decreased (0.252830 --> 0.250591).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 38 cost time: 0.9632289409637451
Epoch: 38, Steps: 64 | Train Loss: 0.0990632 Vali Loss: 0.2559181 Test Loss: 0.2997597
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 39 cost time: 0.9534595012664795
Epoch: 39, Steps: 64 | Train Loss: 0.0992937 Vali Loss: 0.2565960 Test Loss: 0.2988684
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 40 cost time: 0.9474496841430664
Epoch: 40, Steps: 64 | Train Loss: 0.0990878 Vali Loss: 0.2547756 Test Loss: 0.2995897
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 41 cost time: 0.9473726749420166
Epoch: 41, Steps: 64 | Train Loss: 0.0988891 Vali Loss: 0.2541333 Test Loss: 0.3004214
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 42 cost time: 0.9498157501220703
Epoch: 42, Steps: 64 | Train Loss: 0.0985468 Vali Loss: 0.2536838 Test Loss: 0.2991045
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 43 cost time: 0.9514114856719971
Epoch: 43, Steps: 64 | Train Loss: 0.0986567 Vali Loss: 0.2558534 Test Loss: 0.2989976
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 44 cost time: 0.9657232761383057
Epoch: 44, Steps: 64 | Train Loss: 0.0984419 Vali Loss: 0.2523028 Test Loss: 0.3005601
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 45 cost time: 0.9671306610107422
Epoch: 45, Steps: 64 | Train Loss: 0.0989298 Vali Loss: 0.2572170 Test Loss: 0.2997517
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 46 cost time: 0.9643440246582031
Epoch: 46, Steps: 64 | Train Loss: 0.0983887 Vali Loss: 0.2554583 Test Loss: 0.2997939
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 47 cost time: 0.9665179252624512
Epoch: 47, Steps: 64 | Train Loss: 0.0987205 Vali Loss: 0.2549505 Test Loss: 0.2993233
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 48 cost time: 0.9516434669494629
Epoch: 48, Steps: 64 | Train Loss: 0.0986357 Vali Loss: 0.2533697 Test Loss: 0.3003301
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 49 cost time: 0.9503440856933594
Epoch: 49, Steps: 64 | Train Loss: 0.0981702 Vali Loss: 0.2542971 Test Loss: 0.3005474
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 50 cost time: 0.9628250598907471
Epoch: 50, Steps: 64 | Train Loss: 0.0986013 Vali Loss: 0.2526796 Test Loss: 0.3014244
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 51 cost time: 0.9640834331512451
Epoch: 51, Steps: 64 | Train Loss: 0.0986632 Vali Loss: 0.2571606 Test Loss: 0.3005400
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 52 cost time: 0.9594428539276123
Epoch: 52, Steps: 64 | Train Loss: 0.0982007 Vali Loss: 0.2553937 Test Loss: 0.3008963
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 53 cost time: 0.9567508697509766
Epoch: 53, Steps: 64 | Train Loss: 0.0984932 Vali Loss: 0.2535964 Test Loss: 0.2986941
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 54 cost time: 0.9601953029632568
Epoch: 54, Steps: 64 | Train Loss: 0.0982324 Vali Loss: 0.2538550 Test Loss: 0.2999337
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 55 cost time: 0.9626073837280273
Epoch: 55, Steps: 64 | Train Loss: 0.0982662 Vali Loss: 0.2546538 Test Loss: 0.2998480
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 56 cost time: 0.9606156349182129
Epoch: 56, Steps: 64 | Train Loss: 0.0986566 Vali Loss: 0.2529161 Test Loss: 0.2997545
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 57 cost time: 0.961634635925293
Epoch: 57, Steps: 64 | Train Loss: 0.0986453 Vali Loss: 0.2554856 Test Loss: 0.3002783
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 58 cost time: 0.9529876708984375
Epoch: 58, Steps: 64 | Train Loss: 0.0981842 Vali Loss: 0.2522811 Test Loss: 0.2993959
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 59 cost time: 0.9538178443908691
Epoch: 59, Steps: 64 | Train Loss: 0.0984091 Vali Loss: 0.2509237 Test Loss: 0.3000452
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 60 cost time: 0.958423376083374
Epoch: 60, Steps: 64 | Train Loss: 0.0982942 Vali Loss: 0.2545165 Test Loss: 0.2997048
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2998575270175934, mae:0.36292779445648193, rse:0.2513218820095062
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03745555877685547 GB
Epoch: 1 cost time: 2.3632609844207764
Epoch: 1, Steps: 64 | Train Loss: 0.8796144 Vali Loss: 2.7618246 Test Loss: 4.8102183
Validation loss decreased (inf --> 2.761825).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 2 cost time: 0.9923758506774902
Epoch: 2, Steps: 64 | Train Loss: 0.7359873 Vali Loss: 1.8676856 Test Loss: 3.1319020
Validation loss decreased (2.761825 --> 1.867686).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 3 cost time: 0.9949753284454346
Epoch: 3, Steps: 64 | Train Loss: 0.4741607 Vali Loss: 1.0791655 Test Loss: 1.6491823
Validation loss decreased (1.867686 --> 1.079165).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 4 cost time: 0.9957602024078369
Epoch: 4, Steps: 64 | Train Loss: 0.2553076 Vali Loss: 0.5694296 Test Loss: 0.7238680
Validation loss decreased (1.079165 --> 0.569430).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 5 cost time: 0.9760899543762207
Epoch: 5, Steps: 64 | Train Loss: 0.1496776 Vali Loss: 0.3630162 Test Loss: 0.4170949
Validation loss decreased (0.569430 --> 0.363016).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 6 cost time: 0.9767882823944092
Epoch: 6, Steps: 64 | Train Loss: 0.1218718 Vali Loss: 0.2975574 Test Loss: 0.3375440
Validation loss decreased (0.363016 --> 0.297557).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 7 cost time: 0.9684431552886963
Epoch: 7, Steps: 64 | Train Loss: 0.1134688 Vali Loss: 0.2786654 Test Loss: 0.3201866
Validation loss decreased (0.297557 --> 0.278665).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 8 cost time: 0.9776256084442139
Epoch: 8, Steps: 64 | Train Loss: 0.1089974 Vali Loss: 0.2660005 Test Loss: 0.3095295
Validation loss decreased (0.278665 --> 0.266000).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 9 cost time: 0.975639820098877
Epoch: 9, Steps: 64 | Train Loss: 0.1063764 Vali Loss: 0.2658105 Test Loss: 0.3095725
Validation loss decreased (0.266000 --> 0.265811).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 10 cost time: 0.9927539825439453
Epoch: 10, Steps: 64 | Train Loss: 0.1042771 Vali Loss: 0.2569472 Test Loss: 0.3049286
Validation loss decreased (0.265811 --> 0.256947).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 11 cost time: 0.9844088554382324
Epoch: 11, Steps: 64 | Train Loss: 0.1024650 Vali Loss: 0.2549234 Test Loss: 0.3003234
Validation loss decreased (0.256947 --> 0.254923).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 12 cost time: 0.9855694770812988
Epoch: 12, Steps: 64 | Train Loss: 0.1004910 Vali Loss: 0.2550467 Test Loss: 0.3014035
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 13 cost time: 0.9994473457336426
Epoch: 13, Steps: 64 | Train Loss: 0.0998849 Vali Loss: 0.2518589 Test Loss: 0.3046853
Validation loss decreased (0.254923 --> 0.251859).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 14 cost time: 0.9763748645782471
Epoch: 14, Steps: 64 | Train Loss: 0.0986001 Vali Loss: 0.2509824 Test Loss: 0.3014232
Validation loss decreased (0.251859 --> 0.250982).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 15 cost time: 0.9719967842102051
Epoch: 15, Steps: 64 | Train Loss: 0.0978511 Vali Loss: 0.2497206 Test Loss: 0.3013608
Validation loss decreased (0.250982 --> 0.249721).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 16 cost time: 0.987424373626709
Epoch: 16, Steps: 64 | Train Loss: 0.0973364 Vali Loss: 0.2488691 Test Loss: 0.2999834
Validation loss decreased (0.249721 --> 0.248869).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 17 cost time: 0.9823486804962158
Epoch: 17, Steps: 64 | Train Loss: 0.0967964 Vali Loss: 0.2479419 Test Loss: 0.2983795
Validation loss decreased (0.248869 --> 0.247942).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 18 cost time: 0.9857335090637207
Epoch: 18, Steps: 64 | Train Loss: 0.0960919 Vali Loss: 0.2463681 Test Loss: 0.2992986
Validation loss decreased (0.247942 --> 0.246368).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 19 cost time: 0.9779818058013916
Epoch: 19, Steps: 64 | Train Loss: 0.0959420 Vali Loss: 0.2466224 Test Loss: 0.2979452
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 20 cost time: 0.9869999885559082
Epoch: 20, Steps: 64 | Train Loss: 0.0950700 Vali Loss: 0.2459647 Test Loss: 0.2997178
Validation loss decreased (0.246368 --> 0.245965).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 21 cost time: 0.9836626052856445
Epoch: 21, Steps: 64 | Train Loss: 0.0951959 Vali Loss: 0.2437997 Test Loss: 0.2981696
Validation loss decreased (0.245965 --> 0.243800).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 22 cost time: 0.9776136875152588
Epoch: 22, Steps: 64 | Train Loss: 0.0948048 Vali Loss: 0.2430958 Test Loss: 0.2975898
Validation loss decreased (0.243800 --> 0.243096).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 23 cost time: 0.9669485092163086
Epoch: 23, Steps: 64 | Train Loss: 0.0937072 Vali Loss: 0.2439232 Test Loss: 0.2984866
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 24 cost time: 0.9743895530700684
Epoch: 24, Steps: 64 | Train Loss: 0.0941091 Vali Loss: 0.2464491 Test Loss: 0.2993339
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 25 cost time: 0.9719967842102051
Epoch: 25, Steps: 64 | Train Loss: 0.0942484 Vali Loss: 0.2401533 Test Loss: 0.2999960
Validation loss decreased (0.243096 --> 0.240153).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 26 cost time: 0.9727456569671631
Epoch: 26, Steps: 64 | Train Loss: 0.0941184 Vali Loss: 0.2465291 Test Loss: 0.2987565
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 27 cost time: 0.9829933643341064
Epoch: 27, Steps: 64 | Train Loss: 0.0930929 Vali Loss: 0.2438670 Test Loss: 0.2979748
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 28 cost time: 0.9873554706573486
Epoch: 28, Steps: 64 | Train Loss: 0.0936606 Vali Loss: 0.2438959 Test Loss: 0.2980587
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 29 cost time: 0.9883942604064941
Epoch: 29, Steps: 64 | Train Loss: 0.0936302 Vali Loss: 0.2425853 Test Loss: 0.2984549
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 30 cost time: 0.9817855358123779
Epoch: 30, Steps: 64 | Train Loss: 0.0930867 Vali Loss: 0.2417041 Test Loss: 0.2998722
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 31 cost time: 0.9781849384307861
Epoch: 31, Steps: 64 | Train Loss: 0.0934106 Vali Loss: 0.2463240 Test Loss: 0.3002099
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 32 cost time: 0.9779999256134033
Epoch: 32, Steps: 64 | Train Loss: 0.0931313 Vali Loss: 0.2419921 Test Loss: 0.2975655
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 33 cost time: 0.9896135330200195
Epoch: 33, Steps: 64 | Train Loss: 0.0930734 Vali Loss: 0.2420662 Test Loss: 0.2982188
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 34 cost time: 0.9786169528961182
Epoch: 34, Steps: 64 | Train Loss: 0.0927900 Vali Loss: 0.2443578 Test Loss: 0.2982178
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 35 cost time: 0.9811608791351318
Epoch: 35, Steps: 64 | Train Loss: 0.0928315 Vali Loss: 0.2427675 Test Loss: 0.2979841
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 36 cost time: 0.997351884841919
Epoch: 36, Steps: 64 | Train Loss: 0.0926232 Vali Loss: 0.2385013 Test Loss: 0.2981384
Validation loss decreased (0.240153 --> 0.238501).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 37 cost time: 0.9808452129364014
Epoch: 37, Steps: 64 | Train Loss: 0.0929882 Vali Loss: 0.2409515 Test Loss: 0.2991608
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 38 cost time: 0.9833323955535889
Epoch: 38, Steps: 64 | Train Loss: 0.0926639 Vali Loss: 0.2404975 Test Loss: 0.2986192
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 39 cost time: 0.9712026119232178
Epoch: 39, Steps: 64 | Train Loss: 0.0926243 Vali Loss: 0.2399504 Test Loss: 0.2975257
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 40 cost time: 0.9793815612792969
Epoch: 40, Steps: 64 | Train Loss: 0.0923148 Vali Loss: 0.2437162 Test Loss: 0.2985889
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 41 cost time: 0.9757263660430908
Epoch: 41, Steps: 64 | Train Loss: 0.0927753 Vali Loss: 0.2431509 Test Loss: 0.2990824
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 42 cost time: 0.9767489433288574
Epoch: 42, Steps: 64 | Train Loss: 0.0930447 Vali Loss: 0.2418935 Test Loss: 0.2974236
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 43 cost time: 0.9839999675750732
Epoch: 43, Steps: 64 | Train Loss: 0.0925254 Vali Loss: 0.2413988 Test Loss: 0.2979816
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 44 cost time: 0.9879999160766602
Epoch: 44, Steps: 64 | Train Loss: 0.0929176 Vali Loss: 0.2411476 Test Loss: 0.2975980
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 45 cost time: 0.9866077899932861
Epoch: 45, Steps: 64 | Train Loss: 0.0932366 Vali Loss: 0.2375573 Test Loss: 0.2982336
Validation loss decreased (0.238501 --> 0.237557).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 46 cost time: 0.9956343173980713
Epoch: 46, Steps: 64 | Train Loss: 0.0924237 Vali Loss: 0.2418019 Test Loss: 0.2990040
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 47 cost time: 0.9753525257110596
Epoch: 47, Steps: 64 | Train Loss: 0.0920247 Vali Loss: 0.2409913 Test Loss: 0.2983384
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 48 cost time: 0.9794826507568359
Epoch: 48, Steps: 64 | Train Loss: 0.0922890 Vali Loss: 0.2427335 Test Loss: 0.2991706
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 49 cost time: 0.9851982593536377
Epoch: 49, Steps: 64 | Train Loss: 0.0922924 Vali Loss: 0.2396384 Test Loss: 0.2988895
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 50 cost time: 0.9767913818359375
Epoch: 50, Steps: 64 | Train Loss: 0.0924793 Vali Loss: 0.2395282 Test Loss: 0.2988011
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 51 cost time: 0.9804072380065918
Epoch: 51, Steps: 64 | Train Loss: 0.0921899 Vali Loss: 0.2414148 Test Loss: 0.2988625
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 52 cost time: 0.9984920024871826
Epoch: 52, Steps: 64 | Train Loss: 0.0924873 Vali Loss: 0.2404714 Test Loss: 0.2988113
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 53 cost time: 0.9827284812927246
Epoch: 53, Steps: 64 | Train Loss: 0.0922274 Vali Loss: 0.2400822 Test Loss: 0.2984863
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 54 cost time: 0.982722282409668
Epoch: 54, Steps: 64 | Train Loss: 0.0926034 Vali Loss: 0.2421451 Test Loss: 0.2980998
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 55 cost time: 0.9839975833892822
Epoch: 55, Steps: 64 | Train Loss: 0.0920858 Vali Loss: 0.2416914 Test Loss: 0.2993549
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 56 cost time: 0.9710006713867188
Epoch: 56, Steps: 64 | Train Loss: 0.0921992 Vali Loss: 0.2431021 Test Loss: 0.3003347
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 57 cost time: 0.973635196685791
Epoch: 57, Steps: 64 | Train Loss: 0.0924327 Vali Loss: 0.2432522 Test Loss: 0.2998674
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 58 cost time: 0.9773752689361572
Epoch: 58, Steps: 64 | Train Loss: 0.0922240 Vali Loss: 0.2381984 Test Loss: 0.2974001
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 59 cost time: 0.9573419094085693
Epoch: 59, Steps: 64 | Train Loss: 0.0928146 Vali Loss: 0.2416176 Test Loss: 0.2983797
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 60 cost time: 0.991004228591919
Epoch: 60, Steps: 64 | Train Loss: 0.0923995 Vali Loss: 0.2400135 Test Loss: 0.2977436
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.29823359847068787, mae:0.3648616075515747, rse:0.2506403923034668
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03948259353637695 GB
Epoch: 1 cost time: 2.2701637744903564
Epoch: 1, Steps: 64 | Train Loss: 0.9389031 Vali Loss: 2.5667903 Test Loss: 4.4187188
Validation loss decreased (inf --> 2.566790).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 2 cost time: 0.9051346778869629
Epoch: 2, Steps: 64 | Train Loss: 0.7811339 Vali Loss: 1.7265447 Test Loss: 2.9016731
Validation loss decreased (2.566790 --> 1.726545).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 3 cost time: 0.9807934761047363
Epoch: 3, Steps: 64 | Train Loss: 0.5559962 Vali Loss: 1.2178851 Test Loss: 1.9460760
Validation loss decreased (1.726545 --> 1.217885).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 4 cost time: 0.9145891666412354
Epoch: 4, Steps: 64 | Train Loss: 0.4039122 Vali Loss: 0.9107267 Test Loss: 1.3494358
Validation loss decreased (1.217885 --> 0.910727).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 5 cost time: 0.9066286087036133
Epoch: 5, Steps: 64 | Train Loss: 0.3119898 Vali Loss: 0.7327455 Test Loss: 1.0228941
Validation loss decreased (0.910727 --> 0.732746).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 6 cost time: 0.8976061344146729
Epoch: 6, Steps: 64 | Train Loss: 0.2599157 Vali Loss: 0.6225372 Test Loss: 0.8206078
Validation loss decreased (0.732746 --> 0.622537).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 7 cost time: 0.9025571346282959
Epoch: 7, Steps: 64 | Train Loss: 0.2257474 Vali Loss: 0.5465895 Test Loss: 0.6924666
Validation loss decreased (0.622537 --> 0.546589).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 8 cost time: 0.901353120803833
Epoch: 8, Steps: 64 | Train Loss: 0.2026843 Vali Loss: 0.4838280 Test Loss: 0.5900842
Validation loss decreased (0.546589 --> 0.483828).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 9 cost time: 0.9077956676483154
Epoch: 9, Steps: 64 | Train Loss: 0.1860426 Vali Loss: 0.4462088 Test Loss: 0.5358165
Validation loss decreased (0.483828 --> 0.446209).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 10 cost time: 0.9043416976928711
Epoch: 10, Steps: 64 | Train Loss: 0.1749843 Vali Loss: 0.4163613 Test Loss: 0.4861114
Validation loss decreased (0.446209 --> 0.416361).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 11 cost time: 0.9040002822875977
Epoch: 11, Steps: 64 | Train Loss: 0.1660445 Vali Loss: 0.3890899 Test Loss: 0.4521413
Validation loss decreased (0.416361 --> 0.389090).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 12 cost time: 0.9116337299346924
Epoch: 12, Steps: 64 | Train Loss: 0.1605295 Vali Loss: 0.3727684 Test Loss: 0.4309837
Validation loss decreased (0.389090 --> 0.372768).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 13 cost time: 0.9237701892852783
Epoch: 13, Steps: 64 | Train Loss: 0.1556700 Vali Loss: 0.3517495 Test Loss: 0.4076451
Validation loss decreased (0.372768 --> 0.351750).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 14 cost time: 0.9075019359588623
Epoch: 14, Steps: 64 | Train Loss: 0.1499762 Vali Loss: 0.3422636 Test Loss: 0.3943978
Validation loss decreased (0.351750 --> 0.342264).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 15 cost time: 0.9003968238830566
Epoch: 15, Steps: 64 | Train Loss: 0.1486750 Vali Loss: 0.3332393 Test Loss: 0.3836636
Validation loss decreased (0.342264 --> 0.333239).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 16 cost time: 0.9200584888458252
Epoch: 16, Steps: 64 | Train Loss: 0.1459137 Vali Loss: 0.3267979 Test Loss: 0.3728648
Validation loss decreased (0.333239 --> 0.326798).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 17 cost time: 0.9007623195648193
Epoch: 17, Steps: 64 | Train Loss: 0.1440448 Vali Loss: 0.3181602 Test Loss: 0.3677783
Validation loss decreased (0.326798 --> 0.318160).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 18 cost time: 0.9036247730255127
Epoch: 18, Steps: 64 | Train Loss: 0.1411350 Vali Loss: 0.3123455 Test Loss: 0.3613318
Validation loss decreased (0.318160 --> 0.312346).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 19 cost time: 0.9026165008544922
Epoch: 19, Steps: 64 | Train Loss: 0.1404758 Vali Loss: 0.3122179 Test Loss: 0.3584904
Validation loss decreased (0.312346 --> 0.312218).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 20 cost time: 0.9224257469177246
Epoch: 20, Steps: 64 | Train Loss: 0.1386027 Vali Loss: 0.3061953 Test Loss: 0.3560806
Validation loss decreased (0.312218 --> 0.306195).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 21 cost time: 0.9063799381256104
Epoch: 21, Steps: 64 | Train Loss: 0.1382852 Vali Loss: 0.3013037 Test Loss: 0.3544568
Validation loss decreased (0.306195 --> 0.301304).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 22 cost time: 0.9088633060455322
Epoch: 22, Steps: 64 | Train Loss: 0.1368253 Vali Loss: 0.3010022 Test Loss: 0.3497001
Validation loss decreased (0.301304 --> 0.301002).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 23 cost time: 0.9117388725280762
Epoch: 23, Steps: 64 | Train Loss: 0.1358396 Vali Loss: 0.2996839 Test Loss: 0.3487763
Validation loss decreased (0.301002 --> 0.299684).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 24 cost time: 0.9040000438690186
Epoch: 24, Steps: 64 | Train Loss: 0.1348645 Vali Loss: 0.2964474 Test Loss: 0.3448503
Validation loss decreased (0.299684 --> 0.296447).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 25 cost time: 0.9016239643096924
Epoch: 25, Steps: 64 | Train Loss: 0.1340390 Vali Loss: 0.2949254 Test Loss: 0.3453884
Validation loss decreased (0.296447 --> 0.294925).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 26 cost time: 0.9017388820648193
Epoch: 26, Steps: 64 | Train Loss: 0.1332251 Vali Loss: 0.2927763 Test Loss: 0.3419443
Validation loss decreased (0.294925 --> 0.292776).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 27 cost time: 0.896432638168335
Epoch: 27, Steps: 64 | Train Loss: 0.1325875 Vali Loss: 0.2949423 Test Loss: 0.3451655
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 28 cost time: 0.9013581275939941
Epoch: 28, Steps: 64 | Train Loss: 0.1321366 Vali Loss: 0.2906927 Test Loss: 0.3399387
Validation loss decreased (0.292776 --> 0.290693).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 29 cost time: 0.9067471027374268
Epoch: 29, Steps: 64 | Train Loss: 0.1308154 Vali Loss: 0.2941845 Test Loss: 0.3417998
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 30 cost time: 0.9040000438690186
Epoch: 30, Steps: 64 | Train Loss: 0.1323335 Vali Loss: 0.2878292 Test Loss: 0.3403579
Validation loss decreased (0.290693 --> 0.287829).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 31 cost time: 0.9061398506164551
Epoch: 31, Steps: 64 | Train Loss: 0.1310347 Vali Loss: 0.2900554 Test Loss: 0.3396800
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 32 cost time: 0.903416633605957
Epoch: 32, Steps: 64 | Train Loss: 0.1308030 Vali Loss: 0.2880500 Test Loss: 0.3362468
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 33 cost time: 0.9024629592895508
Epoch: 33, Steps: 64 | Train Loss: 0.1298344 Vali Loss: 0.2862631 Test Loss: 0.3389412
Validation loss decreased (0.287829 --> 0.286263).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 34 cost time: 0.9144208431243896
Epoch: 34, Steps: 64 | Train Loss: 0.1304171 Vali Loss: 0.2857834 Test Loss: 0.3395878
Validation loss decreased (0.286263 --> 0.285783).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 35 cost time: 0.9028232097625732
Epoch: 35, Steps: 64 | Train Loss: 0.1293399 Vali Loss: 0.2876595 Test Loss: 0.3385464
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 36 cost time: 0.9017255306243896
Epoch: 36, Steps: 64 | Train Loss: 0.1293745 Vali Loss: 0.2857648 Test Loss: 0.3376600
Validation loss decreased (0.285783 --> 0.285765).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 37 cost time: 0.9020006656646729
Epoch: 37, Steps: 64 | Train Loss: 0.1296729 Vali Loss: 0.2849409 Test Loss: 0.3377031
Validation loss decreased (0.285765 --> 0.284941).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 38 cost time: 0.9086101055145264
Epoch: 38, Steps: 64 | Train Loss: 0.1284659 Vali Loss: 0.2869243 Test Loss: 0.3359619
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 39 cost time: 0.9070768356323242
Epoch: 39, Steps: 64 | Train Loss: 0.1294424 Vali Loss: 0.2820354 Test Loss: 0.3354474
Validation loss decreased (0.284941 --> 0.282035).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 40 cost time: 0.9024670124053955
Epoch: 40, Steps: 64 | Train Loss: 0.1287330 Vali Loss: 0.2827350 Test Loss: 0.3342596
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 41 cost time: 0.9123280048370361
Epoch: 41, Steps: 64 | Train Loss: 0.1287390 Vali Loss: 0.2857935 Test Loss: 0.3350124
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 42 cost time: 0.9167506694793701
Epoch: 42, Steps: 64 | Train Loss: 0.1284518 Vali Loss: 0.2806616 Test Loss: 0.3324324
Validation loss decreased (0.282035 --> 0.280662).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 43 cost time: 0.9049980640411377
Epoch: 43, Steps: 64 | Train Loss: 0.1288069 Vali Loss: 0.2840917 Test Loss: 0.3353051
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 44 cost time: 0.9026193618774414
Epoch: 44, Steps: 64 | Train Loss: 0.1277839 Vali Loss: 0.2798666 Test Loss: 0.3377944
Validation loss decreased (0.280662 --> 0.279867).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 45 cost time: 0.885319709777832
Epoch: 45, Steps: 64 | Train Loss: 0.1280435 Vali Loss: 0.2847932 Test Loss: 0.3352258
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 46 cost time: 0.9023885726928711
Epoch: 46, Steps: 64 | Train Loss: 0.1289408 Vali Loss: 0.2818716 Test Loss: 0.3345683
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 47 cost time: 0.9033944606781006
Epoch: 47, Steps: 64 | Train Loss: 0.1267683 Vali Loss: 0.2822361 Test Loss: 0.3356992
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 48 cost time: 0.9111208915710449
Epoch: 48, Steps: 64 | Train Loss: 0.1287183 Vali Loss: 0.2857135 Test Loss: 0.3356729
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 49 cost time: 0.9089996814727783
Epoch: 49, Steps: 64 | Train Loss: 0.1283693 Vali Loss: 0.2811262 Test Loss: 0.3343970
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 50 cost time: 0.9066197872161865
Epoch: 50, Steps: 64 | Train Loss: 0.1282422 Vali Loss: 0.2833027 Test Loss: 0.3347995
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 51 cost time: 0.9023253917694092
Epoch: 51, Steps: 64 | Train Loss: 0.1275886 Vali Loss: 0.2840290 Test Loss: 0.3346577
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 52 cost time: 0.9167985916137695
Epoch: 52, Steps: 64 | Train Loss: 0.1283847 Vali Loss: 0.2828252 Test Loss: 0.3354457
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 53 cost time: 0.9034771919250488
Epoch: 53, Steps: 64 | Train Loss: 0.1285200 Vali Loss: 0.2829914 Test Loss: 0.3328140
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 54 cost time: 0.9004049301147461
Epoch: 54, Steps: 64 | Train Loss: 0.1279922 Vali Loss: 0.2797660 Test Loss: 0.3314481
Validation loss decreased (0.279867 --> 0.279766).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 55 cost time: 0.9140005111694336
Epoch: 55, Steps: 64 | Train Loss: 0.1281316 Vali Loss: 0.2806545 Test Loss: 0.3340990
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 56 cost time: 0.9143667221069336
Epoch: 56, Steps: 64 | Train Loss: 0.1279935 Vali Loss: 0.2832441 Test Loss: 0.3329849
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 57 cost time: 0.9186091423034668
Epoch: 57, Steps: 64 | Train Loss: 0.1283883 Vali Loss: 0.2801660 Test Loss: 0.3341464
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 58 cost time: 0.9054381847381592
Epoch: 58, Steps: 64 | Train Loss: 0.1284080 Vali Loss: 0.2781681 Test Loss: 0.3329508
Validation loss decreased (0.279766 --> 0.278168).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 59 cost time: 0.9193556308746338
Epoch: 59, Steps: 64 | Train Loss: 0.1278975 Vali Loss: 0.2809347 Test Loss: 0.3325379
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 60 cost time: 0.905785322189331
Epoch: 60, Steps: 64 | Train Loss: 0.1278530 Vali Loss: 0.2771579 Test Loss: 0.3351959
Validation loss decreased (0.278168 --> 0.277158).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.3351958692073822, mae:0.404016375541687, rse:0.2657186985015869
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.04018402099609375 GB
Epoch: 1 cost time: 2.319895029067993
Epoch: 1, Steps: 64 | Train Loss: 0.8303387 Vali Loss: 2.4582701 Test Loss: 4.4001169
Validation loss decreased (inf --> 2.458270).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 2 cost time: 0.9403724670410156
Epoch: 2, Steps: 64 | Train Loss: 0.6656542 Vali Loss: 1.5443115 Test Loss: 2.6420081
Validation loss decreased (2.458270 --> 1.544312).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 3 cost time: 0.9336199760437012
Epoch: 3, Steps: 64 | Train Loss: 0.4175916 Vali Loss: 0.9380037 Test Loss: 1.4976743
Validation loss decreased (1.544312 --> 0.938004).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 4 cost time: 0.9395391941070557
Epoch: 4, Steps: 64 | Train Loss: 0.2651050 Vali Loss: 0.5980128 Test Loss: 0.8488870
Validation loss decreased (0.938004 --> 0.598013).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 5 cost time: 0.9333794116973877
Epoch: 5, Steps: 64 | Train Loss: 0.1858946 Vali Loss: 0.4328131 Test Loss: 0.5583427
Validation loss decreased (0.598013 --> 0.432813).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 6 cost time: 0.926422119140625
Epoch: 6, Steps: 64 | Train Loss: 0.1490906 Vali Loss: 0.3557120 Test Loss: 0.4307085
Validation loss decreased (0.432813 --> 0.355712).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 7 cost time: 0.9283511638641357
Epoch: 7, Steps: 64 | Train Loss: 0.1333189 Vali Loss: 0.3153051 Test Loss: 0.3765953
Validation loss decreased (0.355712 --> 0.315305).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 8 cost time: 0.9263324737548828
Epoch: 8, Steps: 64 | Train Loss: 0.1254700 Vali Loss: 0.2952542 Test Loss: 0.3563899
Validation loss decreased (0.315305 --> 0.295254).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 9 cost time: 0.9277868270874023
Epoch: 9, Steps: 64 | Train Loss: 0.1200688 Vali Loss: 0.2839243 Test Loss: 0.3430678
Validation loss decreased (0.295254 --> 0.283924).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 10 cost time: 0.9377617835998535
Epoch: 10, Steps: 64 | Train Loss: 0.1163116 Vali Loss: 0.2729562 Test Loss: 0.3329635
Validation loss decreased (0.283924 --> 0.272956).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 11 cost time: 0.9446134567260742
Epoch: 11, Steps: 64 | Train Loss: 0.1144547 Vali Loss: 0.2736413 Test Loss: 0.3295793
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 12 cost time: 0.942432165145874
Epoch: 12, Steps: 64 | Train Loss: 0.1113809 Vali Loss: 0.2686441 Test Loss: 0.3278743
Validation loss decreased (0.272956 --> 0.268644).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 13 cost time: 0.9464089870452881
Epoch: 13, Steps: 64 | Train Loss: 0.1103613 Vali Loss: 0.2630408 Test Loss: 0.3212939
Validation loss decreased (0.268644 --> 0.263041).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 14 cost time: 0.9394371509552002
Epoch: 14, Steps: 64 | Train Loss: 0.1093372 Vali Loss: 0.2606910 Test Loss: 0.3204412
Validation loss decreased (0.263041 --> 0.260691).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 15 cost time: 0.9350571632385254
Epoch: 15, Steps: 64 | Train Loss: 0.1081980 Vali Loss: 0.2628733 Test Loss: 0.3205971
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 16 cost time: 0.9387161731719971
Epoch: 16, Steps: 64 | Train Loss: 0.1063908 Vali Loss: 0.2581995 Test Loss: 0.3191691
Validation loss decreased (0.260691 --> 0.258200).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 17 cost time: 0.9279999732971191
Epoch: 17, Steps: 64 | Train Loss: 0.1055090 Vali Loss: 0.2559589 Test Loss: 0.3178120
Validation loss decreased (0.258200 --> 0.255959).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 18 cost time: 0.9240005016326904
Epoch: 18, Steps: 64 | Train Loss: 0.1045220 Vali Loss: 0.2596437 Test Loss: 0.3162993
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 19 cost time: 0.9282622337341309
Epoch: 19, Steps: 64 | Train Loss: 0.1043002 Vali Loss: 0.2556831 Test Loss: 0.3157019
Validation loss decreased (0.255959 --> 0.255683).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 20 cost time: 0.9313778877258301
Epoch: 20, Steps: 64 | Train Loss: 0.1032082 Vali Loss: 0.2555881 Test Loss: 0.3160642
Validation loss decreased (0.255683 --> 0.255588).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 21 cost time: 0.9344217777252197
Epoch: 21, Steps: 64 | Train Loss: 0.1032267 Vali Loss: 0.2537239 Test Loss: 0.3168348
Validation loss decreased (0.255588 --> 0.253724).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 22 cost time: 0.9313714504241943
Epoch: 22, Steps: 64 | Train Loss: 0.1025057 Vali Loss: 0.2542187 Test Loss: 0.3155092
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 23 cost time: 0.9260685443878174
Epoch: 23, Steps: 64 | Train Loss: 0.1021837 Vali Loss: 0.2562069 Test Loss: 0.3160349
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 24 cost time: 0.9268243312835693
Epoch: 24, Steps: 64 | Train Loss: 0.1017552 Vali Loss: 0.2527036 Test Loss: 0.3163019
Validation loss decreased (0.253724 --> 0.252704).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 25 cost time: 0.932999849319458
Epoch: 25, Steps: 64 | Train Loss: 0.1011609 Vali Loss: 0.2557505 Test Loss: 0.3165770
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 26 cost time: 0.9276235103607178
Epoch: 26, Steps: 64 | Train Loss: 0.1006927 Vali Loss: 0.2532442 Test Loss: 0.3161642
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 27 cost time: 0.9220716953277588
Epoch: 27, Steps: 64 | Train Loss: 0.1006883 Vali Loss: 0.2519963 Test Loss: 0.3147000
Validation loss decreased (0.252704 --> 0.251996).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 28 cost time: 0.9324131011962891
Epoch: 28, Steps: 64 | Train Loss: 0.1001215 Vali Loss: 0.2507093 Test Loss: 0.3159512
Validation loss decreased (0.251996 --> 0.250709).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 29 cost time: 0.9344189167022705
Epoch: 29, Steps: 64 | Train Loss: 0.1003950 Vali Loss: 0.2511424 Test Loss: 0.3157516
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 30 cost time: 0.9443502426147461
Epoch: 30, Steps: 64 | Train Loss: 0.1000736 Vali Loss: 0.2512973 Test Loss: 0.3161146
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 31 cost time: 0.9327411651611328
Epoch: 31, Steps: 64 | Train Loss: 0.0992183 Vali Loss: 0.2489812 Test Loss: 0.3161157
Validation loss decreased (0.250709 --> 0.248981).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 32 cost time: 0.9276180267333984
Epoch: 32, Steps: 64 | Train Loss: 0.0996186 Vali Loss: 0.2469690 Test Loss: 0.3131999
Validation loss decreased (0.248981 --> 0.246969).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 33 cost time: 0.9316210746765137
Epoch: 33, Steps: 64 | Train Loss: 0.0996151 Vali Loss: 0.2485384 Test Loss: 0.3147404
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 34 cost time: 0.9293594360351562
Epoch: 34, Steps: 64 | Train Loss: 0.0998821 Vali Loss: 0.2507655 Test Loss: 0.3146725
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 35 cost time: 0.9314224720001221
Epoch: 35, Steps: 64 | Train Loss: 0.0986500 Vali Loss: 0.2485077 Test Loss: 0.3150336
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 36 cost time: 0.9273738861083984
Epoch: 36, Steps: 64 | Train Loss: 0.0988528 Vali Loss: 0.2499871 Test Loss: 0.3146439
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 37 cost time: 0.9470205307006836
Epoch: 37, Steps: 64 | Train Loss: 0.0985392 Vali Loss: 0.2460267 Test Loss: 0.3143124
Validation loss decreased (0.246969 --> 0.246027).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 38 cost time: 0.9337863922119141
Epoch: 38, Steps: 64 | Train Loss: 0.0993420 Vali Loss: 0.2477884 Test Loss: 0.3134656
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 39 cost time: 0.9369997978210449
Epoch: 39, Steps: 64 | Train Loss: 0.0980295 Vali Loss: 0.2477985 Test Loss: 0.3146843
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 40 cost time: 0.9394454956054688
Epoch: 40, Steps: 64 | Train Loss: 0.0987859 Vali Loss: 0.2505655 Test Loss: 0.3147979
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 41 cost time: 0.9316415786743164
Epoch: 41, Steps: 64 | Train Loss: 0.0986376 Vali Loss: 0.2498125 Test Loss: 0.3151096
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 42 cost time: 0.929396390914917
Epoch: 42, Steps: 64 | Train Loss: 0.0983069 Vali Loss: 0.2497114 Test Loss: 0.3155679
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 43 cost time: 0.9273593425750732
Epoch: 43, Steps: 64 | Train Loss: 0.0987562 Vali Loss: 0.2491117 Test Loss: 0.3153959
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 44 cost time: 0.9299986362457275
Epoch: 44, Steps: 64 | Train Loss: 0.0988109 Vali Loss: 0.2496377 Test Loss: 0.3154869
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 45 cost time: 0.9308507442474365
Epoch: 45, Steps: 64 | Train Loss: 0.0986821 Vali Loss: 0.2491837 Test Loss: 0.3161881
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 46 cost time: 0.929999828338623
Epoch: 46, Steps: 64 | Train Loss: 0.0981862 Vali Loss: 0.2491968 Test Loss: 0.3146514
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 47 cost time: 0.9460000991821289
Epoch: 47, Steps: 64 | Train Loss: 0.0984221 Vali Loss: 0.2490850 Test Loss: 0.3163401
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 48 cost time: 0.935614824295044
Epoch: 48, Steps: 64 | Train Loss: 0.0985191 Vali Loss: 0.2467374 Test Loss: 0.3146736
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 49 cost time: 0.9306254386901855
Epoch: 49, Steps: 64 | Train Loss: 0.0979092 Vali Loss: 0.2478433 Test Loss: 0.3135731
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 50 cost time: 0.9330220222473145
Epoch: 50, Steps: 64 | Train Loss: 0.0980113 Vali Loss: 0.2466580 Test Loss: 0.3152032
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 51 cost time: 0.9461052417755127
Epoch: 51, Steps: 64 | Train Loss: 0.0977334 Vali Loss: 0.2483964 Test Loss: 0.3139293
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 52 cost time: 0.9513247013092041
Epoch: 52, Steps: 64 | Train Loss: 0.0980025 Vali Loss: 0.2502867 Test Loss: 0.3160772
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 53 cost time: 0.9486980438232422
Epoch: 53, Steps: 64 | Train Loss: 0.0979588 Vali Loss: 0.2451208 Test Loss: 0.3140325
Validation loss decreased (0.246027 --> 0.245121).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 54 cost time: 0.9510018825531006
Epoch: 54, Steps: 64 | Train Loss: 0.0988198 Vali Loss: 0.2509622 Test Loss: 0.3144591
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 55 cost time: 0.9536037445068359
Epoch: 55, Steps: 64 | Train Loss: 0.0984182 Vali Loss: 0.2478762 Test Loss: 0.3142889
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 56 cost time: 0.9526057243347168
Epoch: 56, Steps: 64 | Train Loss: 0.0983355 Vali Loss: 0.2469087 Test Loss: 0.3142889
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 57 cost time: 0.948814868927002
Epoch: 57, Steps: 64 | Train Loss: 0.0981264 Vali Loss: 0.2473406 Test Loss: 0.3140908
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 58 cost time: 0.9543676376342773
Epoch: 58, Steps: 64 | Train Loss: 0.0981262 Vali Loss: 0.2459290 Test Loss: 0.3145718
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 59 cost time: 0.9513087272644043
Epoch: 59, Steps: 64 | Train Loss: 0.0984105 Vali Loss: 0.2500983 Test Loss: 0.3140851
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 60 cost time: 0.948336124420166
Epoch: 60, Steps: 64 | Train Loss: 0.0980884 Vali Loss: 0.2478022 Test Loss: 0.3154795
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.3140324354171753, mae:0.3812602460384369, rse:0.25719356536865234
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04074811935424805 GB
Epoch: 1 cost time: 2.316314458847046
Epoch: 1, Steps: 64 | Train Loss: 0.8145831 Vali Loss: 2.4868352 Test Loss: 4.3639159
Validation loss decreased (inf --> 2.486835).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 2 cost time: 0.9847748279571533
Epoch: 2, Steps: 64 | Train Loss: 0.6724408 Vali Loss: 1.6398458 Test Loss: 2.7531221
Validation loss decreased (2.486835 --> 1.639846).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 3 cost time: 0.9820001125335693
Epoch: 3, Steps: 64 | Train Loss: 0.4266340 Vali Loss: 0.9415665 Test Loss: 1.4293482
Validation loss decreased (1.639846 --> 0.941566).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 4 cost time: 0.9835991859436035
Epoch: 4, Steps: 64 | Train Loss: 0.2460465 Vali Loss: 0.5191640 Test Loss: 0.6383865
Validation loss decreased (0.941566 --> 0.519164).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 5 cost time: 0.9836294651031494
Epoch: 5, Steps: 64 | Train Loss: 0.1609442 Vali Loss: 0.3698487 Test Loss: 0.4018777
Validation loss decreased (0.519164 --> 0.369849).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 6 cost time: 0.9777615070343018
Epoch: 6, Steps: 64 | Train Loss: 0.1370676 Vali Loss: 0.3228727 Test Loss: 0.3431945
Validation loss decreased (0.369849 --> 0.322873).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 7 cost time: 0.9763247966766357
Epoch: 7, Steps: 64 | Train Loss: 0.1278056 Vali Loss: 0.2940319 Test Loss: 0.3269554
Validation loss decreased (0.322873 --> 0.294032).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 8 cost time: 0.9455103874206543
Epoch: 8, Steps: 64 | Train Loss: 0.1219885 Vali Loss: 0.2862034 Test Loss: 0.3170692
Validation loss decreased (0.294032 --> 0.286203).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 9 cost time: 0.9623820781707764
Epoch: 9, Steps: 64 | Train Loss: 0.1176168 Vali Loss: 0.2735881 Test Loss: 0.3109353
Validation loss decreased (0.286203 --> 0.273588).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 10 cost time: 0.9614782333374023
Epoch: 10, Steps: 64 | Train Loss: 0.1151578 Vali Loss: 0.2648999 Test Loss: 0.3087301
Validation loss decreased (0.273588 --> 0.264900).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 11 cost time: 0.9724338054656982
Epoch: 11, Steps: 64 | Train Loss: 0.1122352 Vali Loss: 0.2622266 Test Loss: 0.3054064
Validation loss decreased (0.264900 --> 0.262227).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 12 cost time: 0.9648878574371338
Epoch: 12, Steps: 64 | Train Loss: 0.1094648 Vali Loss: 0.2615370 Test Loss: 0.3047677
Validation loss decreased (0.262227 --> 0.261537).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 13 cost time: 0.9639999866485596
Epoch: 13, Steps: 64 | Train Loss: 0.1084829 Vali Loss: 0.2583353 Test Loss: 0.3030597
Validation loss decreased (0.261537 --> 0.258335).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 14 cost time: 0.9680001735687256
Epoch: 14, Steps: 64 | Train Loss: 0.1069093 Vali Loss: 0.2567770 Test Loss: 0.3035994
Validation loss decreased (0.258335 --> 0.256777).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 15 cost time: 0.9561195373535156
Epoch: 15, Steps: 64 | Train Loss: 0.1049878 Vali Loss: 0.2492499 Test Loss: 0.3037348
Validation loss decreased (0.256777 --> 0.249250).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 16 cost time: 0.9584217071533203
Epoch: 16, Steps: 64 | Train Loss: 0.1039994 Vali Loss: 0.2496771 Test Loss: 0.3033524
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 17 cost time: 0.9543633460998535
Epoch: 17, Steps: 64 | Train Loss: 0.1035942 Vali Loss: 0.2515643 Test Loss: 0.3029467
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 18 cost time: 0.9574151039123535
Epoch: 18, Steps: 64 | Train Loss: 0.1025520 Vali Loss: 0.2511264 Test Loss: 0.3042995
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 19 cost time: 0.9600963592529297
Epoch: 19, Steps: 64 | Train Loss: 0.1019754 Vali Loss: 0.2503886 Test Loss: 0.3039792
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 20 cost time: 0.9633834362030029
Epoch: 20, Steps: 64 | Train Loss: 0.1010326 Vali Loss: 0.2448589 Test Loss: 0.3033674
Validation loss decreased (0.249250 --> 0.244859).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 21 cost time: 0.9567101001739502
Epoch: 21, Steps: 64 | Train Loss: 0.1006972 Vali Loss: 0.2482531 Test Loss: 0.3035596
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 22 cost time: 0.9600000381469727
Epoch: 22, Steps: 64 | Train Loss: 0.1000680 Vali Loss: 0.2498172 Test Loss: 0.3041244
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 23 cost time: 0.9601027965545654
Epoch: 23, Steps: 64 | Train Loss: 0.0996931 Vali Loss: 0.2456253 Test Loss: 0.3042459
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 24 cost time: 0.9656074047088623
Epoch: 24, Steps: 64 | Train Loss: 0.0997465 Vali Loss: 0.2470586 Test Loss: 0.3042305
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 25 cost time: 1.0494029521942139
Epoch: 25, Steps: 64 | Train Loss: 0.0991080 Vali Loss: 0.2475096 Test Loss: 0.3042781
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 26 cost time: 0.9573702812194824
Epoch: 26, Steps: 64 | Train Loss: 0.0993081 Vali Loss: 0.2468930 Test Loss: 0.3046470
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 27 cost time: 0.9590601921081543
Epoch: 27, Steps: 64 | Train Loss: 0.0984385 Vali Loss: 0.2441669 Test Loss: 0.3049188
Validation loss decreased (0.244859 --> 0.244167).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 28 cost time: 0.970412015914917
Epoch: 28, Steps: 64 | Train Loss: 0.0991263 Vali Loss: 0.2433210 Test Loss: 0.3048244
Validation loss decreased (0.244167 --> 0.243321).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 29 cost time: 0.9614276885986328
Epoch: 29, Steps: 64 | Train Loss: 0.0975204 Vali Loss: 0.2464658 Test Loss: 0.3053800
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 30 cost time: 0.9632978439331055
Epoch: 30, Steps: 64 | Train Loss: 0.0980198 Vali Loss: 0.2415086 Test Loss: 0.3052714
Validation loss decreased (0.243321 --> 0.241509).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 31 cost time: 0.9724185466766357
Epoch: 31, Steps: 64 | Train Loss: 0.0973182 Vali Loss: 0.2431627 Test Loss: 0.3049937
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 32 cost time: 0.9559998512268066
Epoch: 32, Steps: 64 | Train Loss: 0.0977532 Vali Loss: 0.2444713 Test Loss: 0.3046978
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 33 cost time: 0.9606223106384277
Epoch: 33, Steps: 64 | Train Loss: 0.0973600 Vali Loss: 0.2419637 Test Loss: 0.3054209
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 34 cost time: 0.9688577651977539
Epoch: 34, Steps: 64 | Train Loss: 0.0979728 Vali Loss: 0.2431805 Test Loss: 0.3051342
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 35 cost time: 0.960322380065918
Epoch: 35, Steps: 64 | Train Loss: 0.0971919 Vali Loss: 0.2456257 Test Loss: 0.3061576
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 36 cost time: 0.9610352516174316
Epoch: 36, Steps: 64 | Train Loss: 0.0972051 Vali Loss: 0.2431521 Test Loss: 0.3050144
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 37 cost time: 0.961388111114502
Epoch: 37, Steps: 64 | Train Loss: 0.0973921 Vali Loss: 0.2432487 Test Loss: 0.3055441
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 38 cost time: 0.9704265594482422
Epoch: 38, Steps: 64 | Train Loss: 0.0972649 Vali Loss: 0.2412185 Test Loss: 0.3061558
Validation loss decreased (0.241509 --> 0.241218).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 39 cost time: 0.9627702236175537
Epoch: 39, Steps: 64 | Train Loss: 0.0970763 Vali Loss: 0.2414296 Test Loss: 0.3059678
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 40 cost time: 0.9586148262023926
Epoch: 40, Steps: 64 | Train Loss: 0.0962323 Vali Loss: 0.2473611 Test Loss: 0.3069556
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 41 cost time: 0.95762038230896
Epoch: 41, Steps: 64 | Train Loss: 0.0962348 Vali Loss: 0.2447897 Test Loss: 0.3058416
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 42 cost time: 0.9576144218444824
Epoch: 42, Steps: 64 | Train Loss: 0.0970120 Vali Loss: 0.2421708 Test Loss: 0.3053439
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 43 cost time: 0.9593539237976074
Epoch: 43, Steps: 64 | Train Loss: 0.0970846 Vali Loss: 0.2442587 Test Loss: 0.3056302
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 44 cost time: 0.9614131450653076
Epoch: 44, Steps: 64 | Train Loss: 0.0967562 Vali Loss: 0.2447893 Test Loss: 0.3063030
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 45 cost time: 0.9594020843505859
Epoch: 45, Steps: 64 | Train Loss: 0.0967900 Vali Loss: 0.2446498 Test Loss: 0.3059512
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 46 cost time: 0.9624056816101074
Epoch: 46, Steps: 64 | Train Loss: 0.0969735 Vali Loss: 0.2439874 Test Loss: 0.3061312
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 47 cost time: 0.9607927799224854
Epoch: 47, Steps: 64 | Train Loss: 0.0968058 Vali Loss: 0.2418838 Test Loss: 0.3060614
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 48 cost time: 0.980175256729126
Epoch: 48, Steps: 64 | Train Loss: 0.0971868 Vali Loss: 0.2425228 Test Loss: 0.3065248
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 49 cost time: 0.9600000381469727
Epoch: 49, Steps: 64 | Train Loss: 0.0969571 Vali Loss: 0.2446051 Test Loss: 0.3065404
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 50 cost time: 0.9546151161193848
Epoch: 50, Steps: 64 | Train Loss: 0.0966790 Vali Loss: 0.2420515 Test Loss: 0.3064574
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 51 cost time: 0.9648029804229736
Epoch: 51, Steps: 64 | Train Loss: 0.0968356 Vali Loss: 0.2422132 Test Loss: 0.3067095
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 52 cost time: 0.9540195465087891
Epoch: 52, Steps: 64 | Train Loss: 0.0964748 Vali Loss: 0.2437987 Test Loss: 0.3064986
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 53 cost time: 0.9623494148254395
Epoch: 53, Steps: 64 | Train Loss: 0.0960904 Vali Loss: 0.2420204 Test Loss: 0.3065679
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 54 cost time: 0.9623713493347168
Epoch: 54, Steps: 64 | Train Loss: 0.0968096 Vali Loss: 0.2416432 Test Loss: 0.3062399
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 55 cost time: 0.9703710079193115
Epoch: 55, Steps: 64 | Train Loss: 0.0971563 Vali Loss: 0.2446018 Test Loss: 0.3077262
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 56 cost time: 0.9577815532684326
Epoch: 56, Steps: 64 | Train Loss: 0.0966631 Vali Loss: 0.2435675 Test Loss: 0.3060656
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 57 cost time: 0.9609997272491455
Epoch: 57, Steps: 64 | Train Loss: 0.0967897 Vali Loss: 0.2437305 Test Loss: 0.3064471
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 58 cost time: 0.9519996643066406
Epoch: 58, Steps: 64 | Train Loss: 0.0964122 Vali Loss: 0.2412645 Test Loss: 0.3067367
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 59 cost time: 0.9596247673034668
Epoch: 59, Steps: 64 | Train Loss: 0.0963174 Vali Loss: 0.2421595 Test Loss: 0.3054009
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 60 cost time: 0.9531478881835938
Epoch: 60, Steps: 64 | Train Loss: 0.0965613 Vali Loss: 0.2421609 Test Loss: 0.3065065
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.3061557114124298, mae:0.37053415179252625, rse:0.25394752621650696
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.03964376449584961 GB
Epoch: 1 cost time: 2.2188096046447754
Epoch: 1, Steps: 64 | Train Loss: 1.1882605 Vali Loss: 3.2338839 Test Loss: 5.6574178
Validation loss decreased (inf --> 3.233884).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 2 cost time: 0.8423113822937012
Epoch: 2, Steps: 64 | Train Loss: 0.9301471 Vali Loss: 1.8431122 Test Loss: 3.0975502
Validation loss decreased (3.233884 --> 1.843112).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 3 cost time: 0.8547163009643555
Epoch: 3, Steps: 64 | Train Loss: 0.5506137 Vali Loss: 1.0475904 Test Loss: 1.6016728
Validation loss decreased (1.843112 --> 1.047590).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 4 cost time: 0.8580009937286377
Epoch: 4, Steps: 64 | Train Loss: 0.3542823 Vali Loss: 0.7726455 Test Loss: 1.0958883
Validation loss decreased (1.047590 --> 0.772645).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 5 cost time: 0.8616156578063965
Epoch: 5, Steps: 64 | Train Loss: 0.2796788 Vali Loss: 0.6328937 Test Loss: 0.8563614
Validation loss decreased (0.772645 --> 0.632894).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 6 cost time: 0.8473389148712158
Epoch: 6, Steps: 64 | Train Loss: 0.2379305 Vali Loss: 0.5413686 Test Loss: 0.6958529
Validation loss decreased (0.632894 --> 0.541369).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 7 cost time: 0.8464071750640869
Epoch: 7, Steps: 64 | Train Loss: 0.2106712 Vali Loss: 0.4799245 Test Loss: 0.5953587
Validation loss decreased (0.541369 --> 0.479925).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 8 cost time: 0.8457334041595459
Epoch: 8, Steps: 64 | Train Loss: 0.1919825 Vali Loss: 0.4309300 Test Loss: 0.5291745
Validation loss decreased (0.479925 --> 0.430930).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 9 cost time: 0.8390002250671387
Epoch: 9, Steps: 64 | Train Loss: 0.1780213 Vali Loss: 0.3907898 Test Loss: 0.4813359
Validation loss decreased (0.430930 --> 0.390790).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 10 cost time: 0.8443703651428223
Epoch: 10, Steps: 64 | Train Loss: 0.1682857 Vali Loss: 0.3628296 Test Loss: 0.4460442
Validation loss decreased (0.390790 --> 0.362830).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 11 cost time: 0.856346607208252
Epoch: 11, Steps: 64 | Train Loss: 0.1592440 Vali Loss: 0.3452929 Test Loss: 0.4230209
Validation loss decreased (0.362830 --> 0.345293).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 12 cost time: 0.8473992347717285
Epoch: 12, Steps: 64 | Train Loss: 0.1535348 Vali Loss: 0.3277029 Test Loss: 0.4015442
Validation loss decreased (0.345293 --> 0.327703).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 13 cost time: 0.8637206554412842
Epoch: 13, Steps: 64 | Train Loss: 0.1484890 Vali Loss: 0.3147386 Test Loss: 0.3871011
Validation loss decreased (0.327703 --> 0.314739).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 14 cost time: 0.8496177196502686
Epoch: 14, Steps: 64 | Train Loss: 0.1451094 Vali Loss: 0.3060164 Test Loss: 0.3743632
Validation loss decreased (0.314739 --> 0.306016).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 15 cost time: 0.8540554046630859
Epoch: 15, Steps: 64 | Train Loss: 0.1422220 Vali Loss: 0.2922662 Test Loss: 0.3631478
Validation loss decreased (0.306016 --> 0.292266).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 16 cost time: 0.8413856029510498
Epoch: 16, Steps: 64 | Train Loss: 0.1391062 Vali Loss: 0.2902562 Test Loss: 0.3592394
Validation loss decreased (0.292266 --> 0.290256).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 17 cost time: 0.8484013080596924
Epoch: 17, Steps: 64 | Train Loss: 0.1370623 Vali Loss: 0.2875763 Test Loss: 0.3560511
Validation loss decreased (0.290256 --> 0.287576).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 18 cost time: 0.845391035079956
Epoch: 18, Steps: 64 | Train Loss: 0.1347800 Vali Loss: 0.2828841 Test Loss: 0.3478709
Validation loss decreased (0.287576 --> 0.282884).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 19 cost time: 0.8440003395080566
Epoch: 19, Steps: 64 | Train Loss: 0.1336421 Vali Loss: 0.2800258 Test Loss: 0.3459240
Validation loss decreased (0.282884 --> 0.280026).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 20 cost time: 0.8606092929840088
Epoch: 20, Steps: 64 | Train Loss: 0.1319410 Vali Loss: 0.2768060 Test Loss: 0.3397323
Validation loss decreased (0.280026 --> 0.276806).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 21 cost time: 0.8534188270568848
Epoch: 21, Steps: 64 | Train Loss: 0.1318087 Vali Loss: 0.2728753 Test Loss: 0.3384884
Validation loss decreased (0.276806 --> 0.272875).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 22 cost time: 0.8503482341766357
Epoch: 22, Steps: 64 | Train Loss: 0.1297680 Vali Loss: 0.2703975 Test Loss: 0.3334730
Validation loss decreased (0.272875 --> 0.270398).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 23 cost time: 0.8477697372436523
Epoch: 23, Steps: 64 | Train Loss: 0.1293458 Vali Loss: 0.2638011 Test Loss: 0.3334399
Validation loss decreased (0.270398 --> 0.263801).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 24 cost time: 0.8454053401947021
Epoch: 24, Steps: 64 | Train Loss: 0.1285173 Vali Loss: 0.2673810 Test Loss: 0.3330576
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 25 cost time: 0.8387541770935059
Epoch: 25, Steps: 64 | Train Loss: 0.1278607 Vali Loss: 0.2643653 Test Loss: 0.3304013
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 26 cost time: 0.8503305912017822
Epoch: 26, Steps: 64 | Train Loss: 0.1271728 Vali Loss: 0.2649940 Test Loss: 0.3266636
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 27 cost time: 0.852339506149292
Epoch: 27, Steps: 64 | Train Loss: 0.1261788 Vali Loss: 0.2616728 Test Loss: 0.3266906
Validation loss decreased (0.263801 --> 0.261673).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 28 cost time: 0.8449997901916504
Epoch: 28, Steps: 64 | Train Loss: 0.1258404 Vali Loss: 0.2610391 Test Loss: 0.3231234
Validation loss decreased (0.261673 --> 0.261039).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 29 cost time: 0.8433802127838135
Epoch: 29, Steps: 64 | Train Loss: 0.1255791 Vali Loss: 0.2591501 Test Loss: 0.3251702
Validation loss decreased (0.261039 --> 0.259150).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 30 cost time: 0.8542945384979248
Epoch: 30, Steps: 64 | Train Loss: 0.1251401 Vali Loss: 0.2587668 Test Loss: 0.3225054
Validation loss decreased (0.259150 --> 0.258767).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 31 cost time: 0.8503851890563965
Epoch: 31, Steps: 64 | Train Loss: 0.1246945 Vali Loss: 0.2559588 Test Loss: 0.3232968
Validation loss decreased (0.258767 --> 0.255959).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 32 cost time: 0.8313558101654053
Epoch: 32, Steps: 64 | Train Loss: 0.1244833 Vali Loss: 0.2559810 Test Loss: 0.3228308
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 33 cost time: 0.8499999046325684
Epoch: 33, Steps: 64 | Train Loss: 0.1242978 Vali Loss: 0.2560106 Test Loss: 0.3195221
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 34 cost time: 0.8506274223327637
Epoch: 34, Steps: 64 | Train Loss: 0.1244613 Vali Loss: 0.2530759 Test Loss: 0.3181487
Validation loss decreased (0.255959 --> 0.253076).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 35 cost time: 0.8563566207885742
Epoch: 35, Steps: 64 | Train Loss: 0.1238789 Vali Loss: 0.2549534 Test Loss: 0.3211792
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 36 cost time: 0.8473553657531738
Epoch: 36, Steps: 64 | Train Loss: 0.1236103 Vali Loss: 0.2567751 Test Loss: 0.3200179
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 37 cost time: 0.8457930088043213
Epoch: 37, Steps: 64 | Train Loss: 0.1224533 Vali Loss: 0.2543496 Test Loss: 0.3185016
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 38 cost time: 0.8464536666870117
Epoch: 38, Steps: 64 | Train Loss: 0.1232805 Vali Loss: 0.2537024 Test Loss: 0.3147714
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 39 cost time: 0.8616025447845459
Epoch: 39, Steps: 64 | Train Loss: 0.1229654 Vali Loss: 0.2546698 Test Loss: 0.3163546
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 40 cost time: 0.8533494472503662
Epoch: 40, Steps: 64 | Train Loss: 0.1227679 Vali Loss: 0.2538850 Test Loss: 0.3202162
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 41 cost time: 0.852470874786377
Epoch: 41, Steps: 64 | Train Loss: 0.1229230 Vali Loss: 0.2541601 Test Loss: 0.3167825
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 42 cost time: 0.8507461547851562
Epoch: 42, Steps: 64 | Train Loss: 0.1224660 Vali Loss: 0.2531040 Test Loss: 0.3172045
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 43 cost time: 0.8644723892211914
Epoch: 43, Steps: 64 | Train Loss: 0.1228066 Vali Loss: 0.2523147 Test Loss: 0.3168127
Validation loss decreased (0.253076 --> 0.252315).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 44 cost time: 0.8536298274993896
Epoch: 44, Steps: 64 | Train Loss: 0.1224089 Vali Loss: 0.2507993 Test Loss: 0.3163493
Validation loss decreased (0.252315 --> 0.250799).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 45 cost time: 0.8503570556640625
Epoch: 45, Steps: 64 | Train Loss: 0.1232404 Vali Loss: 0.2549776 Test Loss: 0.3183849
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 46 cost time: 0.8513844013214111
Epoch: 46, Steps: 64 | Train Loss: 0.1226987 Vali Loss: 0.2547228 Test Loss: 0.3172713
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 47 cost time: 0.8333323001861572
Epoch: 47, Steps: 64 | Train Loss: 0.1229391 Vali Loss: 0.2545921 Test Loss: 0.3195701
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 48 cost time: 0.8489999771118164
Epoch: 48, Steps: 64 | Train Loss: 0.1226863 Vali Loss: 0.2510397 Test Loss: 0.3136331
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 49 cost time: 0.852602481842041
Epoch: 49, Steps: 64 | Train Loss: 0.1229181 Vali Loss: 0.2518679 Test Loss: 0.3155476
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 50 cost time: 0.8563635349273682
Epoch: 50, Steps: 64 | Train Loss: 0.1224698 Vali Loss: 0.2518391 Test Loss: 0.3150233
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 51 cost time: 0.8514025211334229
Epoch: 51, Steps: 64 | Train Loss: 0.1219120 Vali Loss: 0.2536987 Test Loss: 0.3171595
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 52 cost time: 0.8581907749176025
Epoch: 52, Steps: 64 | Train Loss: 0.1220948 Vali Loss: 0.2507266 Test Loss: 0.3154037
Validation loss decreased (0.250799 --> 0.250727).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 53 cost time: 0.8540000915527344
Epoch: 53, Steps: 64 | Train Loss: 0.1215273 Vali Loss: 0.2501658 Test Loss: 0.3163092
Validation loss decreased (0.250727 --> 0.250166).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 54 cost time: 0.8436071872711182
Epoch: 54, Steps: 64 | Train Loss: 0.1216001 Vali Loss: 0.2541910 Test Loss: 0.3169020
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 55 cost time: 0.8324227333068848
Epoch: 55, Steps: 64 | Train Loss: 0.1222945 Vali Loss: 0.2518616 Test Loss: 0.3150341
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 56 cost time: 0.8344268798828125
Epoch: 56, Steps: 64 | Train Loss: 0.1221585 Vali Loss: 0.2523108 Test Loss: 0.3148433
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 57 cost time: 0.842475175857544
Epoch: 57, Steps: 64 | Train Loss: 0.1224409 Vali Loss: 0.2515613 Test Loss: 0.3140628
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 58 cost time: 0.8639998435974121
Epoch: 58, Steps: 64 | Train Loss: 0.1220998 Vali Loss: 0.2529931 Test Loss: 0.3155826
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 59 cost time: 0.8530235290527344
Epoch: 59, Steps: 64 | Train Loss: 0.1214810 Vali Loss: 0.2488007 Test Loss: 0.3141235
Validation loss decreased (0.250166 --> 0.248801).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 60 cost time: 0.8503625392913818
Epoch: 60, Steps: 64 | Train Loss: 0.1215413 Vali Loss: 0.2531165 Test Loss: 0.3169496
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.3141235411167145, mae:0.38017672300338745, rse:0.25723081827163696
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.040345191955566406 GB
Epoch: 1 cost time: 2.2955946922302246
Epoch: 1, Steps: 64 | Train Loss: 0.9560144 Vali Loss: 2.8252678 Test Loss: 5.0740762
Validation loss decreased (inf --> 2.825268).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 2 cost time: 0.9307818412780762
Epoch: 2, Steps: 64 | Train Loss: 0.7656120 Vali Loss: 1.7266042 Test Loss: 2.9494324
Validation loss decreased (2.825268 --> 1.726604).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 3 cost time: 0.9409999847412109
Epoch: 3, Steps: 64 | Train Loss: 0.4652333 Vali Loss: 0.9778081 Test Loss: 1.5153974
Validation loss decreased (1.726604 --> 0.977808).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 4 cost time: 0.9459998607635498
Epoch: 4, Steps: 64 | Train Loss: 0.2715564 Vali Loss: 0.5819425 Test Loss: 0.7774341
Validation loss decreased (0.977808 --> 0.581942).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 5 cost time: 0.946622371673584
Epoch: 5, Steps: 64 | Train Loss: 0.1784141 Vali Loss: 0.4105767 Test Loss: 0.4904717
Validation loss decreased (0.581942 --> 0.410577).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 6 cost time: 1.02388334274292
Epoch: 6, Steps: 64 | Train Loss: 0.1428037 Vali Loss: 0.3215613 Test Loss: 0.3767800
Validation loss decreased (0.410577 --> 0.321561).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 7 cost time: 1.0354015827178955
Epoch: 7, Steps: 64 | Train Loss: 0.1285217 Vali Loss: 0.2782295 Test Loss: 0.3304073
Validation loss decreased (0.321561 --> 0.278230).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 8 cost time: 1.0045115947723389
Epoch: 8, Steps: 64 | Train Loss: 0.1210799 Vali Loss: 0.2720238 Test Loss: 0.3167195
Validation loss decreased (0.278230 --> 0.272024).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 9 cost time: 0.9378976821899414
Epoch: 9, Steps: 64 | Train Loss: 0.1169136 Vali Loss: 0.2589338 Test Loss: 0.3078925
Validation loss decreased (0.272024 --> 0.258934).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 10 cost time: 0.9403841495513916
Epoch: 10, Steps: 64 | Train Loss: 0.1145620 Vali Loss: 0.2559915 Test Loss: 0.3022647
Validation loss decreased (0.258934 --> 0.255991).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 11 cost time: 0.9514124393463135
Epoch: 11, Steps: 64 | Train Loss: 0.1116856 Vali Loss: 0.2525139 Test Loss: 0.2993441
Validation loss decreased (0.255991 --> 0.252514).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 12 cost time: 0.9443373680114746
Epoch: 12, Steps: 64 | Train Loss: 0.1100953 Vali Loss: 0.2509829 Test Loss: 0.2998568
Validation loss decreased (0.252514 --> 0.250983).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 13 cost time: 0.9404327869415283
Epoch: 13, Steps: 64 | Train Loss: 0.1096501 Vali Loss: 0.2485678 Test Loss: 0.2988649
Validation loss decreased (0.250983 --> 0.248568).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 14 cost time: 0.932722806930542
Epoch: 14, Steps: 64 | Train Loss: 0.1076673 Vali Loss: 0.2474744 Test Loss: 0.2963722
Validation loss decreased (0.248568 --> 0.247474).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 15 cost time: 0.9480416774749756
Epoch: 15, Steps: 64 | Train Loss: 0.1069755 Vali Loss: 0.2456848 Test Loss: 0.2964127
Validation loss decreased (0.247474 --> 0.245685).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 16 cost time: 0.9383673667907715
Epoch: 16, Steps: 64 | Train Loss: 0.1062708 Vali Loss: 0.2421178 Test Loss: 0.2947442
Validation loss decreased (0.245685 --> 0.242118).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 17 cost time: 0.9364051818847656
Epoch: 17, Steps: 64 | Train Loss: 0.1044794 Vali Loss: 0.2453273 Test Loss: 0.2936673
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 18 cost time: 0.9503293037414551
Epoch: 18, Steps: 64 | Train Loss: 0.1042255 Vali Loss: 0.2426927 Test Loss: 0.2937196
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 19 cost time: 0.9469873905181885
Epoch: 19, Steps: 64 | Train Loss: 0.1037513 Vali Loss: 0.2449349 Test Loss: 0.2956444
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 20 cost time: 0.9473862648010254
Epoch: 20, Steps: 64 | Train Loss: 0.1035235 Vali Loss: 0.2405679 Test Loss: 0.2925695
Validation loss decreased (0.242118 --> 0.240568).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 21 cost time: 0.9467160701751709
Epoch: 21, Steps: 64 | Train Loss: 0.1025905 Vali Loss: 0.2406344 Test Loss: 0.2928036
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 22 cost time: 0.9329593181610107
Epoch: 22, Steps: 64 | Train Loss: 0.1023498 Vali Loss: 0.2405370 Test Loss: 0.2930623
Validation loss decreased (0.240568 --> 0.240537).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 23 cost time: 0.9392557144165039
Epoch: 23, Steps: 64 | Train Loss: 0.1023861 Vali Loss: 0.2426600 Test Loss: 0.2926513
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 24 cost time: 0.9386107921600342
Epoch: 24, Steps: 64 | Train Loss: 0.1016758 Vali Loss: 0.2373012 Test Loss: 0.2920518
Validation loss decreased (0.240537 --> 0.237301).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 25 cost time: 0.9353189468383789
Epoch: 25, Steps: 64 | Train Loss: 0.1011284 Vali Loss: 0.2385877 Test Loss: 0.2914115
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 26 cost time: 0.9223403930664062
Epoch: 26, Steps: 64 | Train Loss: 0.1007448 Vali Loss: 0.2415774 Test Loss: 0.2942092
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 27 cost time: 0.9460012912750244
Epoch: 27, Steps: 64 | Train Loss: 0.1008185 Vali Loss: 0.2403991 Test Loss: 0.2917387
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 28 cost time: 0.9413628578186035
Epoch: 28, Steps: 64 | Train Loss: 0.1008005 Vali Loss: 0.2414595 Test Loss: 0.2914551
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 29 cost time: 0.9278016090393066
Epoch: 29, Steps: 64 | Train Loss: 0.1003723 Vali Loss: 0.2395165 Test Loss: 0.2930576
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 30 cost time: 0.9430012702941895
Epoch: 30, Steps: 64 | Train Loss: 0.1001280 Vali Loss: 0.2401440 Test Loss: 0.2922022
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 31 cost time: 0.9460310935974121
Epoch: 31, Steps: 64 | Train Loss: 0.1003032 Vali Loss: 0.2362078 Test Loss: 0.2919806
Validation loss decreased (0.237301 --> 0.236208).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 32 cost time: 0.9453623294830322
Epoch: 32, Steps: 64 | Train Loss: 0.0992334 Vali Loss: 0.2352638 Test Loss: 0.2906991
Validation loss decreased (0.236208 --> 0.235264).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 33 cost time: 0.9413774013519287
Epoch: 33, Steps: 64 | Train Loss: 0.0995447 Vali Loss: 0.2388111 Test Loss: 0.2910150
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 34 cost time: 0.9363377094268799
Epoch: 34, Steps: 64 | Train Loss: 0.0997716 Vali Loss: 0.2380701 Test Loss: 0.2913041
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 35 cost time: 0.9384398460388184
Epoch: 35, Steps: 64 | Train Loss: 0.0994862 Vali Loss: 0.2367115 Test Loss: 0.2917874
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 36 cost time: 0.9437985420227051
Epoch: 36, Steps: 64 | Train Loss: 0.0987987 Vali Loss: 0.2377821 Test Loss: 0.2909558
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 37 cost time: 0.9438514709472656
Epoch: 37, Steps: 64 | Train Loss: 0.0996908 Vali Loss: 0.2378450 Test Loss: 0.2931336
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 38 cost time: 0.9420003890991211
Epoch: 38, Steps: 64 | Train Loss: 0.0994450 Vali Loss: 0.2365282 Test Loss: 0.2896408
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 39 cost time: 0.9466166496276855
Epoch: 39, Steps: 64 | Train Loss: 0.0992974 Vali Loss: 0.2392877 Test Loss: 0.2920072
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 40 cost time: 0.942615270614624
Epoch: 40, Steps: 64 | Train Loss: 0.0995988 Vali Loss: 0.2369556 Test Loss: 0.2902038
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 41 cost time: 0.9374129772186279
Epoch: 41, Steps: 64 | Train Loss: 0.0982033 Vali Loss: 0.2366859 Test Loss: 0.2914613
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 42 cost time: 0.9433145523071289
Epoch: 42, Steps: 64 | Train Loss: 0.0988894 Vali Loss: 0.2375914 Test Loss: 0.2901271
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 43 cost time: 0.9374856948852539
Epoch: 43, Steps: 64 | Train Loss: 0.0987309 Vali Loss: 0.2355608 Test Loss: 0.2908495
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 44 cost time: 0.9362115859985352
Epoch: 44, Steps: 64 | Train Loss: 0.0989984 Vali Loss: 0.2390644 Test Loss: 0.2930554
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 45 cost time: 0.943997859954834
Epoch: 45, Steps: 64 | Train Loss: 0.0990079 Vali Loss: 0.2370152 Test Loss: 0.2914614
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 46 cost time: 0.9510021209716797
Epoch: 46, Steps: 64 | Train Loss: 0.0988394 Vali Loss: 0.2357908 Test Loss: 0.2904522
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 47 cost time: 0.9446167945861816
Epoch: 47, Steps: 64 | Train Loss: 0.0984424 Vali Loss: 0.2358036 Test Loss: 0.2911922
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 48 cost time: 0.9453728199005127
Epoch: 48, Steps: 64 | Train Loss: 0.0990756 Vali Loss: 0.2351238 Test Loss: 0.2912107
Validation loss decreased (0.235264 --> 0.235124).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 49 cost time: 0.9553298950195312
Epoch: 49, Steps: 64 | Train Loss: 0.0989155 Vali Loss: 0.2382558 Test Loss: 0.2909386
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 50 cost time: 0.9403679370880127
Epoch: 50, Steps: 64 | Train Loss: 0.0984263 Vali Loss: 0.2381769 Test Loss: 0.2912990
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 51 cost time: 0.9384322166442871
Epoch: 51, Steps: 64 | Train Loss: 0.0981902 Vali Loss: 0.2363214 Test Loss: 0.2912856
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 52 cost time: 0.9374823570251465
Epoch: 52, Steps: 64 | Train Loss: 0.0989052 Vali Loss: 0.2329879 Test Loss: 0.2907995
Validation loss decreased (0.235124 --> 0.232988).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 53 cost time: 0.9389996528625488
Epoch: 53, Steps: 64 | Train Loss: 0.0984070 Vali Loss: 0.2376411 Test Loss: 0.2905307
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 54 cost time: 0.9439997673034668
Epoch: 54, Steps: 64 | Train Loss: 0.0990176 Vali Loss: 0.2363560 Test Loss: 0.2898566
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 55 cost time: 0.9416182041168213
Epoch: 55, Steps: 64 | Train Loss: 0.0981048 Vali Loss: 0.2352677 Test Loss: 0.2919644
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 56 cost time: 0.9571352005004883
Epoch: 56, Steps: 64 | Train Loss: 0.0987768 Vali Loss: 0.2401864 Test Loss: 0.2906967
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 57 cost time: 0.9453916549682617
Epoch: 57, Steps: 64 | Train Loss: 0.0985693 Vali Loss: 0.2376181 Test Loss: 0.2916317
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 58 cost time: 0.9404613971710205
Epoch: 58, Steps: 64 | Train Loss: 0.0985468 Vali Loss: 0.2364146 Test Loss: 0.2921768
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 59 cost time: 0.9539666175842285
Epoch: 59, Steps: 64 | Train Loss: 0.0991401 Vali Loss: 0.2344544 Test Loss: 0.2887957
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 60 cost time: 0.9362442493438721
Epoch: 60, Steps: 64 | Train Loss: 0.0983009 Vali Loss: 0.2385312 Test Loss: 0.2925479
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.29079946875572205, mae:0.3579709231853485, rse:0.2474967986345291
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.0409092903137207 GB
Epoch: 1 cost time: 2.248352289199829
Epoch: 1, Steps: 64 | Train Loss: 0.7999814 Vali Loss: 2.4910817 Test Loss: 4.2766929
Validation loss decreased (inf --> 2.491082).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 2 cost time: 0.9026269912719727
Epoch: 2, Steps: 64 | Train Loss: 0.6547643 Vali Loss: 1.5694861 Test Loss: 2.5720465
Validation loss decreased (2.491082 --> 1.569486).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 3 cost time: 0.8982558250427246
Epoch: 3, Steps: 64 | Train Loss: 0.3944775 Vali Loss: 0.8216676 Test Loss: 1.1730741
Validation loss decreased (1.569486 --> 0.821668).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 4 cost time: 0.9044194221496582
Epoch: 4, Steps: 64 | Train Loss: 0.2128894 Vali Loss: 0.4406594 Test Loss: 0.5250657
Validation loss decreased (0.821668 --> 0.440659).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 5 cost time: 0.9093823432922363
Epoch: 5, Steps: 64 | Train Loss: 0.1418025 Vali Loss: 0.3165039 Test Loss: 0.3564080
Validation loss decreased (0.440659 --> 0.316504).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 6 cost time: 0.9348130226135254
Epoch: 6, Steps: 64 | Train Loss: 0.1223590 Vali Loss: 0.2780591 Test Loss: 0.3233157
Validation loss decreased (0.316504 --> 0.278059).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 7 cost time: 0.8978960514068604
Epoch: 7, Steps: 64 | Train Loss: 0.1159789 Vali Loss: 0.2702909 Test Loss: 0.3155801
Validation loss decreased (0.278059 --> 0.270291).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 8 cost time: 0.8949999809265137
Epoch: 8, Steps: 64 | Train Loss: 0.1123631 Vali Loss: 0.2589630 Test Loss: 0.3094195
Validation loss decreased (0.270291 --> 0.258963).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 9 cost time: 0.8996365070343018
Epoch: 9, Steps: 64 | Train Loss: 0.1090531 Vali Loss: 0.2584248 Test Loss: 0.3077637
Validation loss decreased (0.258963 --> 0.258425).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 10 cost time: 0.9013941287994385
Epoch: 10, Steps: 64 | Train Loss: 0.1073432 Vali Loss: 0.2527202 Test Loss: 0.3068149
Validation loss decreased (0.258425 --> 0.252720).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 11 cost time: 0.9060068130493164
Epoch: 11, Steps: 64 | Train Loss: 0.1047165 Vali Loss: 0.2484322 Test Loss: 0.3030871
Validation loss decreased (0.252720 --> 0.248432).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 12 cost time: 0.9063675403594971
Epoch: 12, Steps: 64 | Train Loss: 0.1036605 Vali Loss: 0.2499767 Test Loss: 0.3019234
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 13 cost time: 0.905735969543457
Epoch: 13, Steps: 64 | Train Loss: 0.1021483 Vali Loss: 0.2466342 Test Loss: 0.3025916
Validation loss decreased (0.248432 --> 0.246634).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 14 cost time: 0.9039998054504395
Epoch: 14, Steps: 64 | Train Loss: 0.1013397 Vali Loss: 0.2424692 Test Loss: 0.3015988
Validation loss decreased (0.246634 --> 0.242469).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 15 cost time: 0.9108080863952637
Epoch: 15, Steps: 64 | Train Loss: 0.0996051 Vali Loss: 0.2439889 Test Loss: 0.2992960
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 16 cost time: 0.896364688873291
Epoch: 16, Steps: 64 | Train Loss: 0.0991346 Vali Loss: 0.2437139 Test Loss: 0.3004438
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 17 cost time: 0.9089491367340088
Epoch: 17, Steps: 64 | Train Loss: 0.0988691 Vali Loss: 0.2414384 Test Loss: 0.3001823
Validation loss decreased (0.242469 --> 0.241438).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 18 cost time: 0.8973712921142578
Epoch: 18, Steps: 64 | Train Loss: 0.0982095 Vali Loss: 0.2407220 Test Loss: 0.3006593
Validation loss decreased (0.241438 --> 0.240722).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 19 cost time: 0.8963921070098877
Epoch: 19, Steps: 64 | Train Loss: 0.0979574 Vali Loss: 0.2373349 Test Loss: 0.2991881
Validation loss decreased (0.240722 --> 0.237335).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 20 cost time: 0.903472900390625
Epoch: 20, Steps: 64 | Train Loss: 0.0970905 Vali Loss: 0.2400483 Test Loss: 0.3007728
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 21 cost time: 0.899634599685669
Epoch: 21, Steps: 64 | Train Loss: 0.0968764 Vali Loss: 0.2405815 Test Loss: 0.2997120
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 22 cost time: 0.9010961055755615
Epoch: 22, Steps: 64 | Train Loss: 0.0966757 Vali Loss: 0.2374108 Test Loss: 0.2988132
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 23 cost time: 0.9043745994567871
Epoch: 23, Steps: 64 | Train Loss: 0.0967495 Vali Loss: 0.2358078 Test Loss: 0.2990130
Validation loss decreased (0.237335 --> 0.235808).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 24 cost time: 0.8933506011962891
Epoch: 24, Steps: 64 | Train Loss: 0.0960091 Vali Loss: 0.2369710 Test Loss: 0.2995408
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 25 cost time: 0.8680219650268555
Epoch: 25, Steps: 64 | Train Loss: 0.0954709 Vali Loss: 0.2358129 Test Loss: 0.2986577
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 26 cost time: 0.8751957416534424
Epoch: 26, Steps: 64 | Train Loss: 0.0949580 Vali Loss: 0.2362408 Test Loss: 0.2988644
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 27 cost time: 0.8886246681213379
Epoch: 27, Steps: 64 | Train Loss: 0.0951120 Vali Loss: 0.2334824 Test Loss: 0.2983860
Validation loss decreased (0.235808 --> 0.233482).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 28 cost time: 0.8941960334777832
Epoch: 28, Steps: 64 | Train Loss: 0.0947689 Vali Loss: 0.2369625 Test Loss: 0.2986280
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 29 cost time: 0.9011943340301514
Epoch: 29, Steps: 64 | Train Loss: 0.0948597 Vali Loss: 0.2334216 Test Loss: 0.2968684
Validation loss decreased (0.233482 --> 0.233422).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 30 cost time: 0.9023466110229492
Epoch: 30, Steps: 64 | Train Loss: 0.0949980 Vali Loss: 0.2355036 Test Loss: 0.3001666
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 31 cost time: 0.9123938083648682
Epoch: 31, Steps: 64 | Train Loss: 0.0945879 Vali Loss: 0.2349421 Test Loss: 0.2979375
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 32 cost time: 0.9019999504089355
Epoch: 32, Steps: 64 | Train Loss: 0.0945005 Vali Loss: 0.2353505 Test Loss: 0.2976989
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 33 cost time: 0.8966362476348877
Epoch: 33, Steps: 64 | Train Loss: 0.0946427 Vali Loss: 0.2327577 Test Loss: 0.2983736
Validation loss decreased (0.233422 --> 0.232758).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 34 cost time: 0.8906190395355225
Epoch: 34, Steps: 64 | Train Loss: 0.0941255 Vali Loss: 0.2345816 Test Loss: 0.2982448
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 35 cost time: 0.9013693332672119
Epoch: 35, Steps: 64 | Train Loss: 0.0941232 Vali Loss: 0.2354458 Test Loss: 0.2986358
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 36 cost time: 0.8989205360412598
Epoch: 36, Steps: 64 | Train Loss: 0.0935835 Vali Loss: 0.2366323 Test Loss: 0.2987362
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 37 cost time: 0.8914954662322998
Epoch: 37, Steps: 64 | Train Loss: 0.0935324 Vali Loss: 0.2340977 Test Loss: 0.2987591
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 38 cost time: 0.9019997119903564
Epoch: 38, Steps: 64 | Train Loss: 0.0941664 Vali Loss: 0.2335316 Test Loss: 0.2972174
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 39 cost time: 0.9000020027160645
Epoch: 39, Steps: 64 | Train Loss: 0.0939819 Vali Loss: 0.2355000 Test Loss: 0.2981037
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 40 cost time: 0.9356179237365723
Epoch: 40, Steps: 64 | Train Loss: 0.0943410 Vali Loss: 0.2343915 Test Loss: 0.2980275
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 41 cost time: 0.9166021347045898
Epoch: 41, Steps: 64 | Train Loss: 0.0937713 Vali Loss: 0.2315911 Test Loss: 0.2978241
Validation loss decreased (0.232758 --> 0.231591).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 42 cost time: 0.8954000473022461
Epoch: 42, Steps: 64 | Train Loss: 0.0938219 Vali Loss: 0.2335593 Test Loss: 0.2977924
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 43 cost time: 0.8877224922180176
Epoch: 43, Steps: 64 | Train Loss: 0.0936583 Vali Loss: 0.2324938 Test Loss: 0.2976427
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 44 cost time: 0.8937640190124512
Epoch: 44, Steps: 64 | Train Loss: 0.0936685 Vali Loss: 0.2349957 Test Loss: 0.2987180
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 45 cost time: 0.8919999599456787
Epoch: 45, Steps: 64 | Train Loss: 0.0935496 Vali Loss: 0.2354390 Test Loss: 0.2979837
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 46 cost time: 0.8822541236877441
Epoch: 46, Steps: 64 | Train Loss: 0.0938413 Vali Loss: 0.2309531 Test Loss: 0.2986278
Validation loss decreased (0.231591 --> 0.230953).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 47 cost time: 0.9251062870025635
Epoch: 47, Steps: 64 | Train Loss: 0.0933323 Vali Loss: 0.2354851 Test Loss: 0.3000672
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 48 cost time: 0.916996955871582
Epoch: 48, Steps: 64 | Train Loss: 0.0928175 Vali Loss: 0.2342871 Test Loss: 0.2976146
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 49 cost time: 0.9311623573303223
Epoch: 49, Steps: 64 | Train Loss: 0.0931821 Vali Loss: 0.2350130 Test Loss: 0.2992661
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 50 cost time: 0.8868036270141602
Epoch: 50, Steps: 64 | Train Loss: 0.0933554 Vali Loss: 0.2361763 Test Loss: 0.2982186
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 51 cost time: 0.8929979801177979
Epoch: 51, Steps: 64 | Train Loss: 0.0940067 Vali Loss: 0.2366004 Test Loss: 0.2970568
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 52 cost time: 0.8876140117645264
Epoch: 52, Steps: 64 | Train Loss: 0.0929724 Vali Loss: 0.2360095 Test Loss: 0.2980317
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 53 cost time: 0.9154114723205566
Epoch: 53, Steps: 64 | Train Loss: 0.0934225 Vali Loss: 0.2340760 Test Loss: 0.2981149
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 54 cost time: 0.8920280933380127
Epoch: 54, Steps: 64 | Train Loss: 0.0933996 Vali Loss: 0.2317799 Test Loss: 0.2967665
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 55 cost time: 0.8976197242736816
Epoch: 55, Steps: 64 | Train Loss: 0.0933268 Vali Loss: 0.2347667 Test Loss: 0.2992042
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 56 cost time: 0.9143171310424805
Epoch: 56, Steps: 64 | Train Loss: 0.0931768 Vali Loss: 0.2343574 Test Loss: 0.2967157
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 57 cost time: 0.9020006656646729
Epoch: 57, Steps: 64 | Train Loss: 0.0933482 Vali Loss: 0.2318045 Test Loss: 0.3001521
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 58 cost time: 0.9032378196716309
Epoch: 58, Steps: 64 | Train Loss: 0.0933571 Vali Loss: 0.2325569 Test Loss: 0.2978202
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 59 cost time: 0.9079303741455078
Epoch: 59, Steps: 64 | Train Loss: 0.0935067 Vali Loss: 0.2318855 Test Loss: 0.2967893
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 60 cost time: 0.9134314060211182
Epoch: 60, Steps: 64 | Train Loss: 0.0936522 Vali Loss: 0.2321099 Test Loss: 0.2980079
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.29862773418426514, mae:0.3659948706626892, rse:0.25080597400665283
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.039804935455322266 GB
Epoch: 1 cost time: 2.309044361114502
Epoch: 1, Steps: 64 | Train Loss: 1.1936114 Vali Loss: 3.3203459 Test Loss: 5.8644485
Validation loss decreased (inf --> 3.320346).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 2 cost time: 0.9244141578674316
Epoch: 2, Steps: 64 | Train Loss: 0.9068842 Vali Loss: 1.8238262 Test Loss: 3.0417666
Validation loss decreased (3.320346 --> 1.823826).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 3 cost time: 0.9260222911834717
Epoch: 3, Steps: 64 | Train Loss: 0.5755402 Vali Loss: 1.3137224 Test Loss: 2.0763600
Validation loss decreased (1.823826 --> 1.313722).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 4 cost time: 0.903895378112793
Epoch: 4, Steps: 64 | Train Loss: 0.4329618 Vali Loss: 1.0206922 Test Loss: 1.5270295
Validation loss decreased (1.313722 --> 1.020692).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 5 cost time: 0.8931822776794434
Epoch: 5, Steps: 64 | Train Loss: 0.3421190 Vali Loss: 0.8186186 Test Loss: 1.1626343
Validation loss decreased (1.020692 --> 0.818619).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 6 cost time: 0.9233613014221191
Epoch: 6, Steps: 64 | Train Loss: 0.2792813 Vali Loss: 0.6829020 Test Loss: 0.9124534
Validation loss decreased (0.818619 --> 0.682902).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 7 cost time: 0.9244990348815918
Epoch: 7, Steps: 64 | Train Loss: 0.2395684 Vali Loss: 0.5860735 Test Loss: 0.7548962
Validation loss decreased (0.682902 --> 0.586073).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 8 cost time: 0.9093019962310791
Epoch: 8, Steps: 64 | Train Loss: 0.2122726 Vali Loss: 0.5208341 Test Loss: 0.6425312
Validation loss decreased (0.586073 --> 0.520834).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 9 cost time: 0.9145069122314453
Epoch: 9, Steps: 64 | Train Loss: 0.1940293 Vali Loss: 0.4781965 Test Loss: 0.5773753
Validation loss decreased (0.520834 --> 0.478197).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 10 cost time: 0.9333748817443848
Epoch: 10, Steps: 64 | Train Loss: 0.1789665 Vali Loss: 0.4359580 Test Loss: 0.5193536
Validation loss decreased (0.478197 --> 0.435958).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 11 cost time: 0.9218251705169678
Epoch: 11, Steps: 64 | Train Loss: 0.1696099 Vali Loss: 0.4048185 Test Loss: 0.4822572
Validation loss decreased (0.435958 --> 0.404818).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 12 cost time: 0.9216194152832031
Epoch: 12, Steps: 64 | Train Loss: 0.1608962 Vali Loss: 0.3817528 Test Loss: 0.4553407
Validation loss decreased (0.404818 --> 0.381753).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 13 cost time: 0.9265167713165283
Epoch: 13, Steps: 64 | Train Loss: 0.1548187 Vali Loss: 0.3607819 Test Loss: 0.4292524
Validation loss decreased (0.381753 --> 0.360782).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 14 cost time: 0.9305741786956787
Epoch: 14, Steps: 64 | Train Loss: 0.1491299 Vali Loss: 0.3457958 Test Loss: 0.4101719
Validation loss decreased (0.360782 --> 0.345796).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 15 cost time: 0.9251534938812256
Epoch: 15, Steps: 64 | Train Loss: 0.1447420 Vali Loss: 0.3379801 Test Loss: 0.4004573
Validation loss decreased (0.345796 --> 0.337980).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 16 cost time: 0.9234070777893066
Epoch: 16, Steps: 64 | Train Loss: 0.1421233 Vali Loss: 0.3210594 Test Loss: 0.3854333
Validation loss decreased (0.337980 --> 0.321059).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 17 cost time: 0.928802490234375
Epoch: 17, Steps: 64 | Train Loss: 0.1388716 Vali Loss: 0.3172893 Test Loss: 0.3810616
Validation loss decreased (0.321059 --> 0.317289).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 18 cost time: 1.0087676048278809
Epoch: 18, Steps: 64 | Train Loss: 0.1366988 Vali Loss: 0.3062716 Test Loss: 0.3682923
Validation loss decreased (0.317289 --> 0.306272).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 19 cost time: 1.0028035640716553
Epoch: 19, Steps: 64 | Train Loss: 0.1344337 Vali Loss: 0.3017347 Test Loss: 0.3629418
Validation loss decreased (0.306272 --> 0.301735).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 20 cost time: 0.9233415126800537
Epoch: 20, Steps: 64 | Train Loss: 0.1324396 Vali Loss: 0.2952217 Test Loss: 0.3586656
Validation loss decreased (0.301735 --> 0.295222).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 21 cost time: 0.9256165027618408
Epoch: 21, Steps: 64 | Train Loss: 0.1314239 Vali Loss: 0.2896067 Test Loss: 0.3541844
Validation loss decreased (0.295222 --> 0.289607).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 22 cost time: 0.9186108112335205
Epoch: 22, Steps: 64 | Train Loss: 0.1300381 Vali Loss: 0.2885195 Test Loss: 0.3522789
Validation loss decreased (0.289607 --> 0.288520).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 23 cost time: 0.9234554767608643
Epoch: 23, Steps: 64 | Train Loss: 0.1290113 Vali Loss: 0.2836389 Test Loss: 0.3473884
Validation loss decreased (0.288520 --> 0.283639).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 24 cost time: 0.9205024242401123
Epoch: 24, Steps: 64 | Train Loss: 0.1282581 Vali Loss: 0.2858992 Test Loss: 0.3476606
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 25 cost time: 0.9164676666259766
Epoch: 25, Steps: 64 | Train Loss: 0.1267604 Vali Loss: 0.2803999 Test Loss: 0.3425475
Validation loss decreased (0.283639 --> 0.280400).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 26 cost time: 0.9141342639923096
Epoch: 26, Steps: 64 | Train Loss: 0.1261671 Vali Loss: 0.2743930 Test Loss: 0.3387558
Validation loss decreased (0.280400 --> 0.274393).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 27 cost time: 0.9219996929168701
Epoch: 27, Steps: 64 | Train Loss: 0.1255415 Vali Loss: 0.2749497 Test Loss: 0.3400042
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 28 cost time: 0.9236166477203369
Epoch: 28, Steps: 64 | Train Loss: 0.1246394 Vali Loss: 0.2728294 Test Loss: 0.3378193
Validation loss decreased (0.274393 --> 0.272829).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 29 cost time: 0.9214127063751221
Epoch: 29, Steps: 64 | Train Loss: 0.1247372 Vali Loss: 0.2743471 Test Loss: 0.3354792
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 30 cost time: 0.9264576435089111
Epoch: 30, Steps: 64 | Train Loss: 0.1240565 Vali Loss: 0.2703238 Test Loss: 0.3365838
Validation loss decreased (0.272829 --> 0.270324).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 31 cost time: 0.9427473545074463
Epoch: 31, Steps: 64 | Train Loss: 0.1230759 Vali Loss: 0.2711039 Test Loss: 0.3329349
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 32 cost time: 0.9270384311676025
Epoch: 32, Steps: 64 | Train Loss: 0.1224513 Vali Loss: 0.2711017 Test Loss: 0.3332106
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 33 cost time: 0.921748161315918
Epoch: 33, Steps: 64 | Train Loss: 0.1229319 Vali Loss: 0.2698313 Test Loss: 0.3361210
Validation loss decreased (0.270324 --> 0.269831).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 34 cost time: 0.9224851131439209
Epoch: 34, Steps: 64 | Train Loss: 0.1220441 Vali Loss: 0.2714656 Test Loss: 0.3313831
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 35 cost time: 0.9249997138977051
Epoch: 35, Steps: 64 | Train Loss: 0.1226611 Vali Loss: 0.2652391 Test Loss: 0.3315642
Validation loss decreased (0.269831 --> 0.265239).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 36 cost time: 0.9256167411804199
Epoch: 36, Steps: 64 | Train Loss: 0.1215669 Vali Loss: 0.2665552 Test Loss: 0.3318123
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 37 cost time: 0.9234027862548828
Epoch: 37, Steps: 64 | Train Loss: 0.1223038 Vali Loss: 0.2677153 Test Loss: 0.3301570
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 38 cost time: 0.9453556537628174
Epoch: 38, Steps: 64 | Train Loss: 0.1215884 Vali Loss: 0.2635092 Test Loss: 0.3266602
Validation loss decreased (0.265239 --> 0.263509).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 39 cost time: 0.9260275363922119
Epoch: 39, Steps: 64 | Train Loss: 0.1209762 Vali Loss: 0.2641569 Test Loss: 0.3290267
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 40 cost time: 0.9273781776428223
Epoch: 40, Steps: 64 | Train Loss: 0.1212183 Vali Loss: 0.2656128 Test Loss: 0.3283900
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 41 cost time: 0.9188318252563477
Epoch: 41, Steps: 64 | Train Loss: 0.1211012 Vali Loss: 0.2650634 Test Loss: 0.3290374
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 42 cost time: 0.9210002422332764
Epoch: 42, Steps: 64 | Train Loss: 0.1206297 Vali Loss: 0.2651268 Test Loss: 0.3295382
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 43 cost time: 0.9222540855407715
Epoch: 43, Steps: 64 | Train Loss: 0.1210029 Vali Loss: 0.2625954 Test Loss: 0.3263926
Validation loss decreased (0.263509 --> 0.262595).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 44 cost time: 0.9203550815582275
Epoch: 44, Steps: 64 | Train Loss: 0.1206555 Vali Loss: 0.2634686 Test Loss: 0.3288476
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 45 cost time: 0.9233620166778564
Epoch: 45, Steps: 64 | Train Loss: 0.1211907 Vali Loss: 0.2658903 Test Loss: 0.3293344
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 46 cost time: 0.9214708805084229
Epoch: 46, Steps: 64 | Train Loss: 0.1201489 Vali Loss: 0.2630925 Test Loss: 0.3273045
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 47 cost time: 0.9231224060058594
Epoch: 47, Steps: 64 | Train Loss: 0.1200502 Vali Loss: 0.2621903 Test Loss: 0.3263098
Validation loss decreased (0.262595 --> 0.262190).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 48 cost time: 0.936826229095459
Epoch: 48, Steps: 64 | Train Loss: 0.1205576 Vali Loss: 0.2652733 Test Loss: 0.3260424
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 49 cost time: 0.903921365737915
Epoch: 49, Steps: 64 | Train Loss: 0.1202246 Vali Loss: 0.2607167 Test Loss: 0.3247293
Validation loss decreased (0.262190 --> 0.260717).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 50 cost time: 0.9006152153015137
Epoch: 50, Steps: 64 | Train Loss: 0.1203387 Vali Loss: 0.2616977 Test Loss: 0.3296704
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 51 cost time: 0.9142191410064697
Epoch: 51, Steps: 64 | Train Loss: 0.1195008 Vali Loss: 0.2621717 Test Loss: 0.3282062
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 52 cost time: 0.929314374923706
Epoch: 52, Steps: 64 | Train Loss: 0.1199442 Vali Loss: 0.2598784 Test Loss: 0.3257285
Validation loss decreased (0.260717 --> 0.259878).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 53 cost time: 0.9267246723175049
Epoch: 53, Steps: 64 | Train Loss: 0.1199936 Vali Loss: 0.2587673 Test Loss: 0.3231755
Validation loss decreased (0.259878 --> 0.258767).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 54 cost time: 0.9264609813690186
Epoch: 54, Steps: 64 | Train Loss: 0.1207443 Vali Loss: 0.2614051 Test Loss: 0.3258774
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 55 cost time: 0.9457223415374756
Epoch: 55, Steps: 64 | Train Loss: 0.1207596 Vali Loss: 0.2604920 Test Loss: 0.3274880
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 56 cost time: 0.927623987197876
Epoch: 56, Steps: 64 | Train Loss: 0.1202258 Vali Loss: 0.2618920 Test Loss: 0.3279275
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 57 cost time: 0.9266142845153809
Epoch: 57, Steps: 64 | Train Loss: 0.1196332 Vali Loss: 0.2621228 Test Loss: 0.3278071
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 58 cost time: 0.9224255084991455
Epoch: 58, Steps: 64 | Train Loss: 0.1201928 Vali Loss: 0.2625059 Test Loss: 0.3255759
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 59 cost time: 0.9273197650909424
Epoch: 59, Steps: 64 | Train Loss: 0.1201486 Vali Loss: 0.2577719 Test Loss: 0.3265428
Validation loss decreased (0.258767 --> 0.257772).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 60 cost time: 0.9157402515411377
Epoch: 60, Steps: 64 | Train Loss: 0.1205069 Vali Loss: 0.2620481 Test Loss: 0.3256395
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.32654276490211487, mae:0.39670366048812866, rse:0.26226651668548584
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04050636291503906 GB
Epoch: 1 cost time: 2.284114360809326
Epoch: 1, Steps: 64 | Train Loss: 1.0310311 Vali Loss: 3.0691791 Test Loss: 5.4574757
Validation loss decreased (inf --> 3.069179).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 2 cost time: 0.9567320346832275
Epoch: 2, Steps: 64 | Train Loss: 0.7772473 Vali Loss: 1.6834227 Test Loss: 2.8187275
Validation loss decreased (3.069179 --> 1.683423).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 3 cost time: 0.8830001354217529
Epoch: 3, Steps: 64 | Train Loss: 0.4299616 Vali Loss: 0.8925626 Test Loss: 1.3359404
Validation loss decreased (1.683423 --> 0.892563).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 4 cost time: 0.8786170482635498
Epoch: 4, Steps: 64 | Train Loss: 0.2454143 Vali Loss: 0.5303499 Test Loss: 0.6734706
Validation loss decreased (0.892563 --> 0.530350).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 5 cost time: 0.8881287574768066
Epoch: 5, Steps: 64 | Train Loss: 0.1693533 Vali Loss: 0.3917385 Test Loss: 0.4517733
Validation loss decreased (0.530350 --> 0.391738).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 6 cost time: 0.8824374675750732
Epoch: 6, Steps: 64 | Train Loss: 0.1412972 Vali Loss: 0.3270780 Test Loss: 0.3641110
Validation loss decreased (0.391738 --> 0.327078).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 7 cost time: 0.8753998279571533
Epoch: 7, Steps: 64 | Train Loss: 0.1299533 Vali Loss: 0.3002249 Test Loss: 0.3373125
Validation loss decreased (0.327078 --> 0.300225).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 8 cost time: 0.8757474422454834
Epoch: 8, Steps: 64 | Train Loss: 0.1239286 Vali Loss: 0.2754917 Test Loss: 0.3233562
Validation loss decreased (0.300225 --> 0.275492).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 9 cost time: 0.8837218284606934
Epoch: 9, Steps: 64 | Train Loss: 0.1192232 Vali Loss: 0.2632528 Test Loss: 0.3162412
Validation loss decreased (0.275492 --> 0.263253).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 10 cost time: 0.8816075325012207
Epoch: 10, Steps: 64 | Train Loss: 0.1149702 Vali Loss: 0.2568884 Test Loss: 0.3095651
Validation loss decreased (0.263253 --> 0.256888).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 11 cost time: 0.8798398971557617
Epoch: 11, Steps: 64 | Train Loss: 0.1130515 Vali Loss: 0.2453730 Test Loss: 0.3010376
Validation loss decreased (0.256888 --> 0.245373).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 12 cost time: 0.8813838958740234
Epoch: 12, Steps: 64 | Train Loss: 0.1105207 Vali Loss: 0.2498195 Test Loss: 0.3015485
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 13 cost time: 0.8973617553710938
Epoch: 13, Steps: 64 | Train Loss: 0.1086757 Vali Loss: 0.2485953 Test Loss: 0.3018056
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 14 cost time: 0.8893017768859863
Epoch: 14, Steps: 64 | Train Loss: 0.1070669 Vali Loss: 0.2436979 Test Loss: 0.3048273
Validation loss decreased (0.245373 --> 0.243698).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 15 cost time: 0.8729982376098633
Epoch: 15, Steps: 64 | Train Loss: 0.1063668 Vali Loss: 0.2399954 Test Loss: 0.2988656
Validation loss decreased (0.243698 --> 0.239995).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 16 cost time: 0.8746287822723389
Epoch: 16, Steps: 64 | Train Loss: 0.1052963 Vali Loss: 0.2436243 Test Loss: 0.2999195
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 17 cost time: 0.8863518238067627
Epoch: 17, Steps: 64 | Train Loss: 0.1041035 Vali Loss: 0.2397430 Test Loss: 0.2997342
Validation loss decreased (0.239995 --> 0.239743).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 18 cost time: 0.8831627368927002
Epoch: 18, Steps: 64 | Train Loss: 0.1038180 Vali Loss: 0.2363504 Test Loss: 0.2998726
Validation loss decreased (0.239743 --> 0.236350).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 19 cost time: 0.8743453025817871
Epoch: 19, Steps: 64 | Train Loss: 0.1034047 Vali Loss: 0.2397783 Test Loss: 0.3007616
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 20 cost time: 0.8987150192260742
Epoch: 20, Steps: 64 | Train Loss: 0.1018430 Vali Loss: 0.2396832 Test Loss: 0.2988792
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 21 cost time: 0.8839998245239258
Epoch: 21, Steps: 64 | Train Loss: 0.1023512 Vali Loss: 0.2385484 Test Loss: 0.2997634
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 22 cost time: 0.8914694786071777
Epoch: 22, Steps: 64 | Train Loss: 0.1017118 Vali Loss: 0.2378744 Test Loss: 0.2987525
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 23 cost time: 0.8873794078826904
Epoch: 23, Steps: 64 | Train Loss: 0.1012191 Vali Loss: 0.2374797 Test Loss: 0.2987914
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 24 cost time: 0.857982873916626
Epoch: 24, Steps: 64 | Train Loss: 0.1006037 Vali Loss: 0.2372656 Test Loss: 0.2971458
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 25 cost time: 0.8727412223815918
Epoch: 25, Steps: 64 | Train Loss: 0.0999518 Vali Loss: 0.2379135 Test Loss: 0.3003774
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 26 cost time: 0.8750002384185791
Epoch: 26, Steps: 64 | Train Loss: 0.1003629 Vali Loss: 0.2338188 Test Loss: 0.2997543
Validation loss decreased (0.236350 --> 0.233819).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 27 cost time: 0.8775475025177002
Epoch: 27, Steps: 64 | Train Loss: 0.0992694 Vali Loss: 0.2368165 Test Loss: 0.2985587
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 28 cost time: 0.8566458225250244
Epoch: 28, Steps: 64 | Train Loss: 0.0992878 Vali Loss: 0.2332207 Test Loss: 0.2981375
Validation loss decreased (0.233819 --> 0.233221).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 29 cost time: 0.8843328952789307
Epoch: 29, Steps: 64 | Train Loss: 0.0986635 Vali Loss: 0.2379551 Test Loss: 0.2994320
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 30 cost time: 0.8879258632659912
Epoch: 30, Steps: 64 | Train Loss: 0.0990047 Vali Loss: 0.2374722 Test Loss: 0.3007217
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 31 cost time: 0.8897261619567871
Epoch: 31, Steps: 64 | Train Loss: 0.0994128 Vali Loss: 0.2356625 Test Loss: 0.2991251
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 32 cost time: 0.8833787441253662
Epoch: 32, Steps: 64 | Train Loss: 0.0988382 Vali Loss: 0.2351620 Test Loss: 0.2990405
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 33 cost time: 0.8826456069946289
Epoch: 33, Steps: 64 | Train Loss: 0.0981735 Vali Loss: 0.2335559 Test Loss: 0.2989967
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 34 cost time: 0.8793776035308838
Epoch: 34, Steps: 64 | Train Loss: 0.0988839 Vali Loss: 0.2350406 Test Loss: 0.2977698
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 35 cost time: 0.8876833915710449
Epoch: 35, Steps: 64 | Train Loss: 0.0980035 Vali Loss: 0.2311290 Test Loss: 0.2972677
Validation loss decreased (0.233221 --> 0.231129).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 36 cost time: 0.9795441627502441
Epoch: 36, Steps: 64 | Train Loss: 0.0977445 Vali Loss: 0.2340321 Test Loss: 0.2977448
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 37 cost time: 0.9667661190032959
Epoch: 37, Steps: 64 | Train Loss: 0.0978759 Vali Loss: 0.2352803 Test Loss: 0.2997579
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 38 cost time: 0.9627285003662109
Epoch: 38, Steps: 64 | Train Loss: 0.0975588 Vali Loss: 0.2328009 Test Loss: 0.2973481
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 39 cost time: 0.8919997215270996
Epoch: 39, Steps: 64 | Train Loss: 0.0982006 Vali Loss: 0.2345143 Test Loss: 0.2981222
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 40 cost time: 0.8833506107330322
Epoch: 40, Steps: 64 | Train Loss: 0.0980055 Vali Loss: 0.2333889 Test Loss: 0.2991088
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 41 cost time: 0.8864736557006836
Epoch: 41, Steps: 64 | Train Loss: 0.0975369 Vali Loss: 0.2327930 Test Loss: 0.2982425
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 42 cost time: 0.8979980945587158
Epoch: 42, Steps: 64 | Train Loss: 0.0976683 Vali Loss: 0.2324269 Test Loss: 0.2974418
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 43 cost time: 0.8808832168579102
Epoch: 43, Steps: 64 | Train Loss: 0.0977453 Vali Loss: 0.2323788 Test Loss: 0.2981838
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 44 cost time: 0.8830041885375977
Epoch: 44, Steps: 64 | Train Loss: 0.0979802 Vali Loss: 0.2338303 Test Loss: 0.2984753
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 45 cost time: 0.8800935745239258
Epoch: 45, Steps: 64 | Train Loss: 0.0976505 Vali Loss: 0.2337812 Test Loss: 0.2992325
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 46 cost time: 0.8563337326049805
Epoch: 46, Steps: 64 | Train Loss: 0.0973036 Vali Loss: 0.2340341 Test Loss: 0.2991588
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 47 cost time: 0.8843598365783691
Epoch: 47, Steps: 64 | Train Loss: 0.0970966 Vali Loss: 0.2330956 Test Loss: 0.2992672
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 48 cost time: 0.8794937133789062
Epoch: 48, Steps: 64 | Train Loss: 0.0976158 Vali Loss: 0.2320119 Test Loss: 0.2981196
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 49 cost time: 0.8897693157196045
Epoch: 49, Steps: 64 | Train Loss: 0.0974734 Vali Loss: 0.2321382 Test Loss: 0.2995229
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 50 cost time: 0.8870000839233398
Epoch: 50, Steps: 64 | Train Loss: 0.0977730 Vali Loss: 0.2321513 Test Loss: 0.2986782
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 51 cost time: 0.8876237869262695
Epoch: 51, Steps: 64 | Train Loss: 0.0967080 Vali Loss: 0.2310513 Test Loss: 0.2987959
Validation loss decreased (0.231129 --> 0.231051).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 52 cost time: 0.887465238571167
Epoch: 52, Steps: 64 | Train Loss: 0.0978792 Vali Loss: 0.2351110 Test Loss: 0.3006893
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 53 cost time: 0.8703205585479736
Epoch: 53, Steps: 64 | Train Loss: 0.0972322 Vali Loss: 0.2318524 Test Loss: 0.2987058
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 54 cost time: 0.8797638416290283
Epoch: 54, Steps: 64 | Train Loss: 0.0973264 Vali Loss: 0.2334124 Test Loss: 0.2987917
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 55 cost time: 0.8814284801483154
Epoch: 55, Steps: 64 | Train Loss: 0.0972698 Vali Loss: 0.2334282 Test Loss: 0.2995546
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 56 cost time: 0.8926198482513428
Epoch: 56, Steps: 64 | Train Loss: 0.0978827 Vali Loss: 0.2345982 Test Loss: 0.2995022
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 57 cost time: 0.8823542594909668
Epoch: 57, Steps: 64 | Train Loss: 0.0972993 Vali Loss: 0.2346324 Test Loss: 0.2996508
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 58 cost time: 0.8853976726531982
Epoch: 58, Steps: 64 | Train Loss: 0.0970141 Vali Loss: 0.2315112 Test Loss: 0.2975177
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 59 cost time: 0.8890578746795654
Epoch: 59, Steps: 64 | Train Loss: 0.0975176 Vali Loss: 0.2319843 Test Loss: 0.2978323
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 60 cost time: 0.8997526168823242
Epoch: 60, Steps: 64 | Train Loss: 0.0977430 Vali Loss: 0.2332260 Test Loss: 0.2991216
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2987959682941437, mae:0.3673362731933594, rse:0.25087660551071167
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04107046127319336 GB
Epoch: 1 cost time: 2.374764919281006
Epoch: 1, Steps: 64 | Train Loss: 0.9246130 Vali Loss: 2.8359532 Test Loss: 5.0832233
Validation loss decreased (inf --> 2.835953).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 2 cost time: 0.9700002670288086
Epoch: 2, Steps: 64 | Train Loss: 0.7297011 Vali Loss: 1.6843436 Test Loss: 2.8842771
Validation loss decreased (2.835953 --> 1.684344).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 3 cost time: 0.9796149730682373
Epoch: 3, Steps: 64 | Train Loss: 0.4192322 Vali Loss: 0.8725176 Test Loss: 1.3370754
Validation loss decreased (1.684344 --> 0.872518).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 4 cost time: 0.9720659255981445
Epoch: 4, Steps: 64 | Train Loss: 0.2182038 Vali Loss: 0.4609462 Test Loss: 0.5730844
Validation loss decreased (0.872518 --> 0.460946).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 5 cost time: 0.9683918952941895
Epoch: 5, Steps: 64 | Train Loss: 0.1410855 Vali Loss: 0.3331352 Test Loss: 0.3692301
Validation loss decreased (0.460946 --> 0.333135).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 6 cost time: 0.9674718379974365
Epoch: 6, Steps: 64 | Train Loss: 0.1234061 Vali Loss: 0.2856376 Test Loss: 0.3275468
Validation loss decreased (0.333135 --> 0.285638).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 7 cost time: 0.9565000534057617
Epoch: 7, Steps: 64 | Train Loss: 0.1162191 Vali Loss: 0.2701160 Test Loss: 0.3147743
Validation loss decreased (0.285638 --> 0.270116).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 8 cost time: 0.9690494537353516
Epoch: 8, Steps: 64 | Train Loss: 0.1120555 Vali Loss: 0.2597712 Test Loss: 0.3099523
Validation loss decreased (0.270116 --> 0.259771).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 9 cost time: 0.9608137607574463
Epoch: 9, Steps: 64 | Train Loss: 0.1091519 Vali Loss: 0.2546595 Test Loss: 0.3081151
Validation loss decreased (0.259771 --> 0.254660).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 10 cost time: 0.98333740234375
Epoch: 10, Steps: 64 | Train Loss: 0.1076496 Vali Loss: 0.2464772 Test Loss: 0.3023288
Validation loss decreased (0.254660 --> 0.246477).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 11 cost time: 0.9657554626464844
Epoch: 11, Steps: 64 | Train Loss: 0.1055046 Vali Loss: 0.2506695 Test Loss: 0.3016169
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 12 cost time: 0.9737465381622314
Epoch: 12, Steps: 64 | Train Loss: 0.1034878 Vali Loss: 0.2484246 Test Loss: 0.3020913
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 13 cost time: 0.9839992523193359
Epoch: 13, Steps: 64 | Train Loss: 0.1030656 Vali Loss: 0.2470807 Test Loss: 0.3013569
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 14 cost time: 0.9636123180389404
Epoch: 14, Steps: 64 | Train Loss: 0.1018947 Vali Loss: 0.2399361 Test Loss: 0.3011321
Validation loss decreased (0.246477 --> 0.239936).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 15 cost time: 0.9593546390533447
Epoch: 15, Steps: 64 | Train Loss: 0.1010319 Vali Loss: 0.2398455 Test Loss: 0.3005198
Validation loss decreased (0.239936 --> 0.239845).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 16 cost time: 0.9643375873565674
Epoch: 16, Steps: 64 | Train Loss: 0.0999478 Vali Loss: 0.2409190 Test Loss: 0.2995810
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 17 cost time: 0.9764449596405029
Epoch: 17, Steps: 64 | Train Loss: 0.0992417 Vali Loss: 0.2366524 Test Loss: 0.2999433
Validation loss decreased (0.239845 --> 0.236652).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 18 cost time: 0.9914703369140625
Epoch: 18, Steps: 64 | Train Loss: 0.0988803 Vali Loss: 0.2353756 Test Loss: 0.2986990
Validation loss decreased (0.236652 --> 0.235376).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 19 cost time: 0.9864406585693359
Epoch: 19, Steps: 64 | Train Loss: 0.0985560 Vali Loss: 0.2334697 Test Loss: 0.2973237
Validation loss decreased (0.235376 --> 0.233470).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 20 cost time: 1.0009925365447998
Epoch: 20, Steps: 64 | Train Loss: 0.0980509 Vali Loss: 0.2389795 Test Loss: 0.2986074
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 21 cost time: 0.9913153648376465
Epoch: 21, Steps: 64 | Train Loss: 0.0975389 Vali Loss: 0.2349120 Test Loss: 0.2988061
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 22 cost time: 0.9937474727630615
Epoch: 22, Steps: 64 | Train Loss: 0.0974729 Vali Loss: 0.2324869 Test Loss: 0.2974604
Validation loss decreased (0.233470 --> 0.232487).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 23 cost time: 0.9747164249420166
Epoch: 23, Steps: 64 | Train Loss: 0.0964074 Vali Loss: 0.2324482 Test Loss: 0.2973841
Validation loss decreased (0.232487 --> 0.232448).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 24 cost time: 0.9874231815338135
Epoch: 24, Steps: 64 | Train Loss: 0.0965388 Vali Loss: 0.2363514 Test Loss: 0.2976178
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 25 cost time: 0.9946002960205078
Epoch: 25, Steps: 64 | Train Loss: 0.0964017 Vali Loss: 0.2367447 Test Loss: 0.2983296
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 26 cost time: 0.9925901889801025
Epoch: 26, Steps: 64 | Train Loss: 0.0955364 Vali Loss: 0.2310806 Test Loss: 0.2989516
Validation loss decreased (0.232448 --> 0.231081).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 27 cost time: 1.0086023807525635
Epoch: 27, Steps: 64 | Train Loss: 0.0958360 Vali Loss: 0.2337444 Test Loss: 0.2975109
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 28 cost time: 0.9978950023651123
Epoch: 28, Steps: 64 | Train Loss: 0.0951920 Vali Loss: 0.2339011 Test Loss: 0.2990581
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 29 cost time: 0.9884209632873535
Epoch: 29, Steps: 64 | Train Loss: 0.0951939 Vali Loss: 0.2350452 Test Loss: 0.3002063
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 30 cost time: 0.9923141002655029
Epoch: 30, Steps: 64 | Train Loss: 0.0950311 Vali Loss: 0.2346073 Test Loss: 0.2988496
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 31 cost time: 0.9943215847015381
Epoch: 31, Steps: 64 | Train Loss: 0.0951051 Vali Loss: 0.2358950 Test Loss: 0.2989479
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 32 cost time: 0.9913511276245117
Epoch: 32, Steps: 64 | Train Loss: 0.0945608 Vali Loss: 0.2335720 Test Loss: 0.2978677
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 33 cost time: 0.9923861026763916
Epoch: 33, Steps: 64 | Train Loss: 0.0945864 Vali Loss: 0.2347689 Test Loss: 0.2971917
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 34 cost time: 0.9858484268188477
Epoch: 34, Steps: 64 | Train Loss: 0.0946798 Vali Loss: 0.2313245 Test Loss: 0.2976583
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 35 cost time: 0.9867398738861084
Epoch: 35, Steps: 64 | Train Loss: 0.0942589 Vali Loss: 0.2328856 Test Loss: 0.2980681
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 36 cost time: 1.00242018699646
Epoch: 36, Steps: 64 | Train Loss: 0.0942224 Vali Loss: 0.2323162 Test Loss: 0.2983511
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 37 cost time: 0.9953455924987793
Epoch: 37, Steps: 64 | Train Loss: 0.0946590 Vali Loss: 0.2332116 Test Loss: 0.2983522
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 38 cost time: 0.9925966262817383
Epoch: 38, Steps: 64 | Train Loss: 0.0941942 Vali Loss: 0.2332187 Test Loss: 0.2965210
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 39 cost time: 0.9935958385467529
Epoch: 39, Steps: 64 | Train Loss: 0.0940756 Vali Loss: 0.2306588 Test Loss: 0.2976853
Validation loss decreased (0.231081 --> 0.230659).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 40 cost time: 0.9779129028320312
Epoch: 40, Steps: 64 | Train Loss: 0.0939410 Vali Loss: 0.2344342 Test Loss: 0.2977664
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 41 cost time: 0.9839813709259033
Epoch: 41, Steps: 64 | Train Loss: 0.0943418 Vali Loss: 0.2337462 Test Loss: 0.2983990
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 42 cost time: 0.9813089370727539
Epoch: 42, Steps: 64 | Train Loss: 0.0943604 Vali Loss: 0.2341411 Test Loss: 0.2981326
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 43 cost time: 0.9793503284454346
Epoch: 43, Steps: 64 | Train Loss: 0.0943938 Vali Loss: 0.2329039 Test Loss: 0.2968805
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 44 cost time: 0.9942929744720459
Epoch: 44, Steps: 64 | Train Loss: 0.0939603 Vali Loss: 0.2329758 Test Loss: 0.2995301
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 45 cost time: 0.9903569221496582
Epoch: 45, Steps: 64 | Train Loss: 0.0936352 Vali Loss: 0.2318341 Test Loss: 0.2987373
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 46 cost time: 0.9728734493255615
Epoch: 46, Steps: 64 | Train Loss: 0.0942964 Vali Loss: 0.2322006 Test Loss: 0.2982634
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 47 cost time: 0.9974038600921631
Epoch: 47, Steps: 64 | Train Loss: 0.0940951 Vali Loss: 0.2312671 Test Loss: 0.2982163
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 48 cost time: 0.9873812198638916
Epoch: 48, Steps: 64 | Train Loss: 0.0939511 Vali Loss: 0.2322619 Test Loss: 0.2959854
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 49 cost time: 0.9964988231658936
Epoch: 49, Steps: 64 | Train Loss: 0.0935543 Vali Loss: 0.2343135 Test Loss: 0.2966639
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 50 cost time: 0.9610214233398438
Epoch: 50, Steps: 64 | Train Loss: 0.0940988 Vali Loss: 0.2335127 Test Loss: 0.2983076
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 51 cost time: 0.9633762836456299
Epoch: 51, Steps: 64 | Train Loss: 0.0934521 Vali Loss: 0.2341922 Test Loss: 0.2985055
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 52 cost time: 0.9709501266479492
Epoch: 52, Steps: 64 | Train Loss: 0.0940628 Vali Loss: 0.2316753 Test Loss: 0.2978276
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 53 cost time: 0.9673421382904053
Epoch: 53, Steps: 64 | Train Loss: 0.0936707 Vali Loss: 0.2315691 Test Loss: 0.2979636
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 54 cost time: 0.9695658683776855
Epoch: 54, Steps: 64 | Train Loss: 0.0933771 Vali Loss: 0.2338343 Test Loss: 0.2977831
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 55 cost time: 0.9773523807525635
Epoch: 55, Steps: 64 | Train Loss: 0.0934663 Vali Loss: 0.2327647 Test Loss: 0.2971160
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 56 cost time: 0.9753932952880859
Epoch: 56, Steps: 64 | Train Loss: 0.0937431 Vali Loss: 0.2343933 Test Loss: 0.2978145
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 57 cost time: 0.9658093452453613
Epoch: 57, Steps: 64 | Train Loss: 0.0936492 Vali Loss: 0.2333297 Test Loss: 0.2978801
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 58 cost time: 0.9590001106262207
Epoch: 58, Steps: 64 | Train Loss: 0.0933915 Vali Loss: 0.2338902 Test Loss: 0.2975009
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 59 cost time: 0.9720015525817871
Epoch: 59, Steps: 64 | Train Loss: 0.0937922 Vali Loss: 0.2285778 Test Loss: 0.2965912
Validation loss decreased (0.230659 --> 0.228578).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 60 cost time: 0.960075855255127
Epoch: 60, Steps: 64 | Train Loss: 0.0935286 Vali Loss: 0.2305554 Test Loss: 0.2964783
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.29659122228622437, mae:0.36503058671951294, rse:0.24994932115077972
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.03996562957763672 GB
Epoch: 1 cost time: 2.2644145488739014
Epoch: 1, Steps: 64 | Train Loss: 0.9513112 Vali Loss: 2.5921035 Test Loss: 4.1512079
Validation loss decreased (inf --> 2.592103).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 2 cost time: 0.926342248916626
Epoch: 2, Steps: 64 | Train Loss: 0.6885324 Vali Loss: 1.3000299 Test Loss: 1.9580342
Validation loss decreased (2.592103 --> 1.300030).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 3 cost time: 0.9015557765960693
Epoch: 3, Steps: 64 | Train Loss: 0.4325657 Vali Loss: 0.9240842 Test Loss: 1.2761949
Validation loss decreased (1.300030 --> 0.924084).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 4 cost time: 0.9254262447357178
Epoch: 4, Steps: 64 | Train Loss: 0.3199735 Vali Loss: 0.7304767 Test Loss: 0.9192383
Validation loss decreased (0.924084 --> 0.730477).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 5 cost time: 0.9327261447906494
Epoch: 5, Steps: 64 | Train Loss: 0.2525819 Vali Loss: 0.6022611 Test Loss: 0.7176836
Validation loss decreased (0.730477 --> 0.602261).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 6 cost time: 0.9194812774658203
Epoch: 6, Steps: 64 | Train Loss: 0.2132605 Vali Loss: 0.4946416 Test Loss: 0.5804995
Validation loss decreased (0.602261 --> 0.494642).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 7 cost time: 0.9176123142242432
Epoch: 7, Steps: 64 | Train Loss: 0.1874958 Vali Loss: 0.4249213 Test Loss: 0.4835664
Validation loss decreased (0.494642 --> 0.424921).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 8 cost time: 0.9192318916320801
Epoch: 8, Steps: 64 | Train Loss: 0.1703335 Vali Loss: 0.3703877 Test Loss: 0.4289861
Validation loss decreased (0.424921 --> 0.370388).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 9 cost time: 0.9164512157440186
Epoch: 9, Steps: 64 | Train Loss: 0.1588969 Vali Loss: 0.3430082 Test Loss: 0.3992762
Validation loss decreased (0.370388 --> 0.343008).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 10 cost time: 0.9269759654998779
Epoch: 10, Steps: 64 | Train Loss: 0.1502057 Vali Loss: 0.3260646 Test Loss: 0.3692796
Validation loss decreased (0.343008 --> 0.326065).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 11 cost time: 0.9313488006591797
Epoch: 11, Steps: 64 | Train Loss: 0.1446787 Vali Loss: 0.3085077 Test Loss: 0.3540129
Validation loss decreased (0.326065 --> 0.308508).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 12 cost time: 0.932337760925293
Epoch: 12, Steps: 64 | Train Loss: 0.1404369 Vali Loss: 0.2911444 Test Loss: 0.3383221
Validation loss decreased (0.308508 --> 0.291144).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 13 cost time: 0.934725284576416
Epoch: 13, Steps: 64 | Train Loss: 0.1367700 Vali Loss: 0.2854286 Test Loss: 0.3295193
Validation loss decreased (0.291144 --> 0.285429).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 14 cost time: 0.9263756275177002
Epoch: 14, Steps: 64 | Train Loss: 0.1342427 Vali Loss: 0.2844417 Test Loss: 0.3304677
Validation loss decreased (0.285429 --> 0.284442).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 15 cost time: 0.9156062602996826
Epoch: 15, Steps: 64 | Train Loss: 0.1320976 Vali Loss: 0.2728053 Test Loss: 0.3174401
Validation loss decreased (0.284442 --> 0.272805).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 16 cost time: 0.926450252532959
Epoch: 16, Steps: 64 | Train Loss: 0.1299227 Vali Loss: 0.2670709 Test Loss: 0.3154756
Validation loss decreased (0.272805 --> 0.267071).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 17 cost time: 0.920428991317749
Epoch: 17, Steps: 64 | Train Loss: 0.1283619 Vali Loss: 0.2678176 Test Loss: 0.3124275
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 18 cost time: 0.9154825210571289
Epoch: 18, Steps: 64 | Train Loss: 0.1269873 Vali Loss: 0.2650296 Test Loss: 0.3092095
Validation loss decreased (0.267071 --> 0.265030).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 19 cost time: 0.9323465824127197
Epoch: 19, Steps: 64 | Train Loss: 0.1249919 Vali Loss: 0.2614680 Test Loss: 0.3067406
Validation loss decreased (0.265030 --> 0.261468).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 20 cost time: 0.9348604679107666
Epoch: 20, Steps: 64 | Train Loss: 0.1243022 Vali Loss: 0.2607576 Test Loss: 0.3088481
Validation loss decreased (0.261468 --> 0.260758).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 21 cost time: 0.931999921798706
Epoch: 21, Steps: 64 | Train Loss: 0.1241426 Vali Loss: 0.2583733 Test Loss: 0.3042891
Validation loss decreased (0.260758 --> 0.258373).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 22 cost time: 0.9284546375274658
Epoch: 22, Steps: 64 | Train Loss: 0.1220829 Vali Loss: 0.2576187 Test Loss: 0.3025511
Validation loss decreased (0.258373 --> 0.257619).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 23 cost time: 0.9226298332214355
Epoch: 23, Steps: 64 | Train Loss: 0.1230413 Vali Loss: 0.2553401 Test Loss: 0.3029143
Validation loss decreased (0.257619 --> 0.255340).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 24 cost time: 0.9033396244049072
Epoch: 24, Steps: 64 | Train Loss: 0.1217222 Vali Loss: 0.2518100 Test Loss: 0.3036005
Validation loss decreased (0.255340 --> 0.251810).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 25 cost time: 0.9194931983947754
Epoch: 25, Steps: 64 | Train Loss: 0.1214304 Vali Loss: 0.2532252 Test Loss: 0.3035270
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 26 cost time: 0.9118399620056152
Epoch: 26, Steps: 64 | Train Loss: 0.1200961 Vali Loss: 0.2547255 Test Loss: 0.3022276
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 27 cost time: 0.915367603302002
Epoch: 27, Steps: 64 | Train Loss: 0.1205943 Vali Loss: 0.2511297 Test Loss: 0.2983717
Validation loss decreased (0.251810 --> 0.251130).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 28 cost time: 0.9318549633026123
Epoch: 28, Steps: 64 | Train Loss: 0.1191005 Vali Loss: 0.2541929 Test Loss: 0.3032427
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 29 cost time: 0.9320001602172852
Epoch: 29, Steps: 64 | Train Loss: 0.1195714 Vali Loss: 0.2515297 Test Loss: 0.3001390
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 30 cost time: 0.9336035251617432
Epoch: 30, Steps: 64 | Train Loss: 0.1199621 Vali Loss: 0.2503532 Test Loss: 0.2990864
Validation loss decreased (0.251130 --> 0.250353).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 31 cost time: 0.9259610176086426
Epoch: 31, Steps: 64 | Train Loss: 0.1190498 Vali Loss: 0.2492333 Test Loss: 0.2977511
Validation loss decreased (0.250353 --> 0.249233).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 32 cost time: 0.9143378734588623
Epoch: 32, Steps: 64 | Train Loss: 0.1186873 Vali Loss: 0.2515152 Test Loss: 0.2989371
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 33 cost time: 0.9184596538543701
Epoch: 33, Steps: 64 | Train Loss: 0.1181801 Vali Loss: 0.2502886 Test Loss: 0.2987804
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 34 cost time: 0.919442892074585
Epoch: 34, Steps: 64 | Train Loss: 0.1181269 Vali Loss: 0.2471761 Test Loss: 0.2972186
Validation loss decreased (0.249233 --> 0.247176).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 35 cost time: 0.91727614402771
Epoch: 35, Steps: 64 | Train Loss: 0.1186568 Vali Loss: 0.2490350 Test Loss: 0.2981677
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 36 cost time: 0.9248840808868408
Epoch: 36, Steps: 64 | Train Loss: 0.1178110 Vali Loss: 0.2484495 Test Loss: 0.2990305
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 37 cost time: 0.9416220188140869
Epoch: 37, Steps: 64 | Train Loss: 0.1178528 Vali Loss: 0.2455901 Test Loss: 0.2982470
Validation loss decreased (0.247176 --> 0.245590).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 38 cost time: 0.9316308498382568
Epoch: 38, Steps: 64 | Train Loss: 0.1178944 Vali Loss: 0.2454290 Test Loss: 0.2979414
Validation loss decreased (0.245590 --> 0.245429).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 39 cost time: 0.9358880519866943
Epoch: 39, Steps: 64 | Train Loss: 0.1171784 Vali Loss: 0.2465292 Test Loss: 0.2959151
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 40 cost time: 0.931330680847168
Epoch: 40, Steps: 64 | Train Loss: 0.1174304 Vali Loss: 0.2514869 Test Loss: 0.2980000
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 41 cost time: 0.9154245853424072
Epoch: 41, Steps: 64 | Train Loss: 0.1175435 Vali Loss: 0.2496154 Test Loss: 0.2957572
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 42 cost time: 0.9174566268920898
Epoch: 42, Steps: 64 | Train Loss: 0.1176666 Vali Loss: 0.2474836 Test Loss: 0.2955063
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 43 cost time: 0.9130032062530518
Epoch: 43, Steps: 64 | Train Loss: 0.1171232 Vali Loss: 0.2454965 Test Loss: 0.2971236
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 44 cost time: 0.9200003147125244
Epoch: 44, Steps: 64 | Train Loss: 0.1166069 Vali Loss: 0.2477599 Test Loss: 0.2960104
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 45 cost time: 0.9229395389556885
Epoch: 45, Steps: 64 | Train Loss: 0.1169492 Vali Loss: 0.2451778 Test Loss: 0.2972636
Validation loss decreased (0.245429 --> 0.245178).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 46 cost time: 0.9284763336181641
Epoch: 46, Steps: 64 | Train Loss: 0.1167637 Vali Loss: 0.2438748 Test Loss: 0.2961538
Validation loss decreased (0.245178 --> 0.243875).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 47 cost time: 0.930361270904541
Epoch: 47, Steps: 64 | Train Loss: 0.1169368 Vali Loss: 0.2474021 Test Loss: 0.2980066
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 48 cost time: 0.9508488178253174
Epoch: 48, Steps: 64 | Train Loss: 0.1164060 Vali Loss: 0.2446982 Test Loss: 0.2961309
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 49 cost time: 0.923412561416626
Epoch: 49, Steps: 64 | Train Loss: 0.1163986 Vali Loss: 0.2491810 Test Loss: 0.2956913
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 50 cost time: 0.9147388935089111
Epoch: 50, Steps: 64 | Train Loss: 0.1164851 Vali Loss: 0.2470240 Test Loss: 0.2967001
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 51 cost time: 0.9149999618530273
Epoch: 51, Steps: 64 | Train Loss: 0.1168744 Vali Loss: 0.2453203 Test Loss: 0.2969167
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 52 cost time: 0.9130048751831055
Epoch: 52, Steps: 64 | Train Loss: 0.1161832 Vali Loss: 0.2480537 Test Loss: 0.2979682
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 53 cost time: 0.91432785987854
Epoch: 53, Steps: 64 | Train Loss: 0.1168181 Vali Loss: 0.2453448 Test Loss: 0.2948428
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 54 cost time: 0.9416720867156982
Epoch: 54, Steps: 64 | Train Loss: 0.1162444 Vali Loss: 0.2464682 Test Loss: 0.2993867
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 55 cost time: 0.9343645572662354
Epoch: 55, Steps: 64 | Train Loss: 0.1166177 Vali Loss: 0.2479245 Test Loss: 0.2966452
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 56 cost time: 0.9313774108886719
Epoch: 56, Steps: 64 | Train Loss: 0.1167288 Vali Loss: 0.2499372 Test Loss: 0.2970108
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 57 cost time: 0.9287381172180176
Epoch: 57, Steps: 64 | Train Loss: 0.1166739 Vali Loss: 0.2448369 Test Loss: 0.2961440
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 58 cost time: 0.9327981472015381
Epoch: 58, Steps: 64 | Train Loss: 0.1161887 Vali Loss: 0.2468492 Test Loss: 0.2962540
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 59 cost time: 0.9140002727508545
Epoch: 59, Steps: 64 | Train Loss: 0.1169183 Vali Loss: 0.2467669 Test Loss: 0.2980149
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 60 cost time: 0.9156322479248047
Epoch: 60, Steps: 64 | Train Loss: 0.1167718 Vali Loss: 0.2519166 Test Loss: 0.2993250
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.296153724193573, mae:0.35527992248535156, rse:0.24976488947868347
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.040667057037353516 GB
Epoch: 1 cost time: 2.244424343109131
Epoch: 1, Steps: 64 | Train Loss: 0.8958330 Vali Loss: 2.6479154 Test Loss: 4.5781937
Validation loss decreased (inf --> 2.647915).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 2 cost time: 0.8970463275909424
Epoch: 2, Steps: 64 | Train Loss: 0.6712952 Vali Loss: 1.4430200 Test Loss: 2.2990763
Validation loss decreased (2.647915 --> 1.443020).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 3 cost time: 0.9003622531890869
Epoch: 3, Steps: 64 | Train Loss: 0.3888977 Vali Loss: 0.8732600 Test Loss: 1.2552699
Validation loss decreased (1.443020 --> 0.873260).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 4 cost time: 0.9037330150604248
Epoch: 4, Steps: 64 | Train Loss: 0.2339662 Vali Loss: 0.5193983 Test Loss: 0.6632293
Validation loss decreased (0.873260 --> 0.519398).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 5 cost time: 0.9074368476867676
Epoch: 5, Steps: 64 | Train Loss: 0.1629050 Vali Loss: 0.3743662 Test Loss: 0.4399003
Validation loss decreased (0.519398 --> 0.374366).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 6 cost time: 0.8880000114440918
Epoch: 6, Steps: 64 | Train Loss: 0.1353261 Vali Loss: 0.3089325 Test Loss: 0.3619698
Validation loss decreased (0.374366 --> 0.308933).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 7 cost time: 0.8908026218414307
Epoch: 7, Steps: 64 | Train Loss: 0.1245800 Vali Loss: 0.2894755 Test Loss: 0.3287725
Validation loss decreased (0.308933 --> 0.289475).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 8 cost time: 0.8964343070983887
Epoch: 8, Steps: 64 | Train Loss: 0.1176955 Vali Loss: 0.2772947 Test Loss: 0.3171626
Validation loss decreased (0.289475 --> 0.277295).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 9 cost time: 0.8884153366088867
Epoch: 9, Steps: 64 | Train Loss: 0.1135362 Vali Loss: 0.2621687 Test Loss: 0.3032808
Validation loss decreased (0.277295 --> 0.262169).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 10 cost time: 0.8953485488891602
Epoch: 10, Steps: 64 | Train Loss: 0.1113093 Vali Loss: 0.2578523 Test Loss: 0.3061867
Validation loss decreased (0.262169 --> 0.257852).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 11 cost time: 0.8981471061706543
Epoch: 11, Steps: 64 | Train Loss: 0.1084243 Vali Loss: 0.2572604 Test Loss: 0.3034452
Validation loss decreased (0.257852 --> 0.257260).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 12 cost time: 0.9049999713897705
Epoch: 12, Steps: 64 | Train Loss: 0.1070937 Vali Loss: 0.2533486 Test Loss: 0.2991147
Validation loss decreased (0.257260 --> 0.253349).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 13 cost time: 0.9006221294403076
Epoch: 13, Steps: 64 | Train Loss: 0.1061425 Vali Loss: 0.2468290 Test Loss: 0.2977802
Validation loss decreased (0.253349 --> 0.246829).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 14 cost time: 0.9011993408203125
Epoch: 14, Steps: 64 | Train Loss: 0.1048095 Vali Loss: 0.2468453 Test Loss: 0.2985987
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 15 cost time: 0.8914210796356201
Epoch: 15, Steps: 64 | Train Loss: 0.1041957 Vali Loss: 0.2495832 Test Loss: 0.2976523
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 16 cost time: 0.8943076133728027
Epoch: 16, Steps: 64 | Train Loss: 0.1022802 Vali Loss: 0.2468169 Test Loss: 0.2985334
Validation loss decreased (0.246829 --> 0.246817).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 17 cost time: 0.8967618942260742
Epoch: 17, Steps: 64 | Train Loss: 0.1013565 Vali Loss: 0.2456609 Test Loss: 0.2978790
Validation loss decreased (0.246817 --> 0.245661).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 18 cost time: 0.8886115550994873
Epoch: 18, Steps: 64 | Train Loss: 0.1008379 Vali Loss: 0.2437288 Test Loss: 0.2964244
Validation loss decreased (0.245661 --> 0.243729).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 19 cost time: 0.9032599925994873
Epoch: 19, Steps: 64 | Train Loss: 0.1000633 Vali Loss: 0.2408262 Test Loss: 0.2964753
Validation loss decreased (0.243729 --> 0.240826).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 20 cost time: 0.9023432731628418
Epoch: 20, Steps: 64 | Train Loss: 0.0997822 Vali Loss: 0.2386020 Test Loss: 0.2960198
Validation loss decreased (0.240826 --> 0.238602).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 21 cost time: 0.9013667106628418
Epoch: 21, Steps: 64 | Train Loss: 0.0996683 Vali Loss: 0.2409587 Test Loss: 0.2982906
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 22 cost time: 0.8984012603759766
Epoch: 22, Steps: 64 | Train Loss: 0.0986637 Vali Loss: 0.2396918 Test Loss: 0.2970601
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 23 cost time: 0.8827893733978271
Epoch: 23, Steps: 64 | Train Loss: 0.0985499 Vali Loss: 0.2372254 Test Loss: 0.2981761
Validation loss decreased (0.238602 --> 0.237225).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 24 cost time: 0.887000560760498
Epoch: 24, Steps: 64 | Train Loss: 0.0976045 Vali Loss: 0.2399718 Test Loss: 0.2960249
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 25 cost time: 0.8906095027923584
Epoch: 25, Steps: 64 | Train Loss: 0.0979573 Vali Loss: 0.2394106 Test Loss: 0.2964370
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 26 cost time: 0.8863563537597656
Epoch: 26, Steps: 64 | Train Loss: 0.0979291 Vali Loss: 0.2374545 Test Loss: 0.2947276
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 27 cost time: 0.8923923969268799
Epoch: 27, Steps: 64 | Train Loss: 0.0977669 Vali Loss: 0.2376260 Test Loss: 0.2940666
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 28 cost time: 0.896733283996582
Epoch: 28, Steps: 64 | Train Loss: 0.0969344 Vali Loss: 0.2389193 Test Loss: 0.2954479
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 29 cost time: 0.8970928192138672
Epoch: 29, Steps: 64 | Train Loss: 0.0965525 Vali Loss: 0.2344786 Test Loss: 0.2967888
Validation loss decreased (0.237225 --> 0.234479).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 30 cost time: 0.8919224739074707
Epoch: 30, Steps: 64 | Train Loss: 0.0968834 Vali Loss: 0.2342517 Test Loss: 0.2939143
Validation loss decreased (0.234479 --> 0.234252).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 31 cost time: 0.9006137847900391
Epoch: 31, Steps: 64 | Train Loss: 0.0965667 Vali Loss: 0.2393177 Test Loss: 0.2951443
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 32 cost time: 0.8977489471435547
Epoch: 32, Steps: 64 | Train Loss: 0.0963006 Vali Loss: 0.2360581 Test Loss: 0.2941599
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 33 cost time: 0.9013950824737549
Epoch: 33, Steps: 64 | Train Loss: 0.0970470 Vali Loss: 0.2355224 Test Loss: 0.2956217
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 34 cost time: 0.8912405967712402
Epoch: 34, Steps: 64 | Train Loss: 0.0961297 Vali Loss: 0.2368588 Test Loss: 0.2942418
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 35 cost time: 0.8858435153961182
Epoch: 35, Steps: 64 | Train Loss: 0.0962507 Vali Loss: 0.2360384 Test Loss: 0.2958104
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 36 cost time: 0.8849999904632568
Epoch: 36, Steps: 64 | Train Loss: 0.0957136 Vali Loss: 0.2346987 Test Loss: 0.2949066
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 37 cost time: 0.9016144275665283
Epoch: 37, Steps: 64 | Train Loss: 0.0960425 Vali Loss: 0.2337926 Test Loss: 0.2932468
Validation loss decreased (0.234252 --> 0.233793).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 38 cost time: 0.9023823738098145
Epoch: 38, Steps: 64 | Train Loss: 0.0955339 Vali Loss: 0.2362888 Test Loss: 0.2940595
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 39 cost time: 0.8973793983459473
Epoch: 39, Steps: 64 | Train Loss: 0.0945990 Vali Loss: 0.2375888 Test Loss: 0.2949834
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 40 cost time: 0.8943319320678711
Epoch: 40, Steps: 64 | Train Loss: 0.0963679 Vali Loss: 0.2374753 Test Loss: 0.2945609
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 41 cost time: 0.8967175483703613
Epoch: 41, Steps: 64 | Train Loss: 0.0958435 Vali Loss: 0.2370371 Test Loss: 0.2939805
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 42 cost time: 0.8859996795654297
Epoch: 42, Steps: 64 | Train Loss: 0.0956059 Vali Loss: 0.2325382 Test Loss: 0.2951685
Validation loss decreased (0.233793 --> 0.232538).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 43 cost time: 0.8839998245239258
Epoch: 43, Steps: 64 | Train Loss: 0.0957356 Vali Loss: 0.2324857 Test Loss: 0.2946264
Validation loss decreased (0.232538 --> 0.232486).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 44 cost time: 0.8763771057128906
Epoch: 44, Steps: 64 | Train Loss: 0.0952252 Vali Loss: 0.2343669 Test Loss: 0.2946710
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 45 cost time: 0.8631508350372314
Epoch: 45, Steps: 64 | Train Loss: 0.0954181 Vali Loss: 0.2314745 Test Loss: 0.2941628
Validation loss decreased (0.232486 --> 0.231475).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 46 cost time: 0.8876142501831055
Epoch: 46, Steps: 64 | Train Loss: 0.0956421 Vali Loss: 0.2341509 Test Loss: 0.2937328
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 47 cost time: 0.8967418670654297
Epoch: 47, Steps: 64 | Train Loss: 0.0951439 Vali Loss: 0.2340395 Test Loss: 0.2943117
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 48 cost time: 0.8759996891021729
Epoch: 48, Steps: 64 | Train Loss: 0.0954936 Vali Loss: 0.2352052 Test Loss: 0.2942337
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 49 cost time: 0.8936216831207275
Epoch: 49, Steps: 64 | Train Loss: 0.0954922 Vali Loss: 0.2349520 Test Loss: 0.2940407
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 50 cost time: 0.8984067440032959
Epoch: 50, Steps: 64 | Train Loss: 0.0955420 Vali Loss: 0.2339131 Test Loss: 0.2941286
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 51 cost time: 0.889430046081543
Epoch: 51, Steps: 64 | Train Loss: 0.0943953 Vali Loss: 0.2346467 Test Loss: 0.2952818
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 52 cost time: 0.8672068119049072
Epoch: 52, Steps: 64 | Train Loss: 0.0949220 Vali Loss: 0.2361720 Test Loss: 0.2950601
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 53 cost time: 0.8877718448638916
Epoch: 53, Steps: 64 | Train Loss: 0.0948192 Vali Loss: 0.2346221 Test Loss: 0.2956055
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 54 cost time: 0.8880000114440918
Epoch: 54, Steps: 64 | Train Loss: 0.0959355 Vali Loss: 0.2315982 Test Loss: 0.2932724
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 55 cost time: 0.9056484699249268
Epoch: 55, Steps: 64 | Train Loss: 0.0959464 Vali Loss: 0.2336632 Test Loss: 0.2920717
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 56 cost time: 0.8933284282684326
Epoch: 56, Steps: 64 | Train Loss: 0.0959425 Vali Loss: 0.2354977 Test Loss: 0.2941359
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 57 cost time: 0.898381233215332
Epoch: 57, Steps: 64 | Train Loss: 0.0948375 Vali Loss: 0.2366352 Test Loss: 0.2934555
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 58 cost time: 0.904339075088501
Epoch: 58, Steps: 64 | Train Loss: 0.0952847 Vali Loss: 0.2315698 Test Loss: 0.2940003
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 59 cost time: 0.992652177810669
Epoch: 59, Steps: 64 | Train Loss: 0.0951668 Vali Loss: 0.2332861 Test Loss: 0.2936825
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 60 cost time: 0.8897778987884521
Epoch: 60, Steps: 64 | Train Loss: 0.0950877 Vali Loss: 0.2335983 Test Loss: 0.2953483
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.294162780046463, mae:0.36053428053855896, rse:0.24892394244670868
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04123115539550781 GB
Epoch: 1 cost time: 2.3852710723876953
Epoch: 1, Steps: 64 | Train Loss: 0.8516660 Vali Loss: 2.6590164 Test Loss: 4.6942692
Validation loss decreased (inf --> 2.659016).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 2 cost time: 0.989999532699585
Epoch: 2, Steps: 64 | Train Loss: 0.7109157 Vali Loss: 1.7686155 Test Loss: 2.9917319
Validation loss decreased (2.659016 --> 1.768615).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 3 cost time: 0.9906113147735596
Epoch: 3, Steps: 64 | Train Loss: 0.4615888 Vali Loss: 1.0927353 Test Loss: 1.6946574
Validation loss decreased (1.768615 --> 1.092735).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 4 cost time: 0.9866085052490234
Epoch: 4, Steps: 64 | Train Loss: 0.2831843 Vali Loss: 0.6646875 Test Loss: 0.9440838
Validation loss decreased (1.092735 --> 0.664687).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 5 cost time: 0.9936158657073975
Epoch: 5, Steps: 64 | Train Loss: 0.1835772 Vali Loss: 0.4173447 Test Loss: 0.5524076
Validation loss decreased (0.664687 --> 0.417345).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 6 cost time: 0.9773252010345459
Epoch: 6, Steps: 64 | Train Loss: 0.1370447 Vali Loss: 0.3136461 Test Loss: 0.3973331
Validation loss decreased (0.417345 --> 0.313646).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 7 cost time: 0.9834167957305908
Epoch: 7, Steps: 64 | Train Loss: 0.1171043 Vali Loss: 0.2732557 Test Loss: 0.3340586
Validation loss decreased (0.313646 --> 0.273256).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 8 cost time: 0.9749085903167725
Epoch: 8, Steps: 64 | Train Loss: 0.1092152 Vali Loss: 0.2517412 Test Loss: 0.3054703
Validation loss decreased (0.273256 --> 0.251741).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 9 cost time: 0.9663825035095215
Epoch: 9, Steps: 64 | Train Loss: 0.1053570 Vali Loss: 0.2452068 Test Loss: 0.3044698
Validation loss decreased (0.251741 --> 0.245207).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 10 cost time: 0.9903314113616943
Epoch: 10, Steps: 64 | Train Loss: 0.1036215 Vali Loss: 0.2476207 Test Loss: 0.2976286
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 11 cost time: 0.9883384704589844
Epoch: 11, Steps: 64 | Train Loss: 0.1020614 Vali Loss: 0.2459142 Test Loss: 0.3009788
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 12 cost time: 0.9990100860595703
Epoch: 12, Steps: 64 | Train Loss: 0.1001849 Vali Loss: 0.2399638 Test Loss: 0.2992075
Validation loss decreased (0.245207 --> 0.239964).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 13 cost time: 0.9907314777374268
Epoch: 13, Steps: 64 | Train Loss: 0.0994646 Vali Loss: 0.2366019 Test Loss: 0.2967483
Validation loss decreased (0.239964 --> 0.236602).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 14 cost time: 0.9780006408691406
Epoch: 14, Steps: 64 | Train Loss: 0.0985994 Vali Loss: 0.2368861 Test Loss: 0.2964983
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 15 cost time: 0.9950006008148193
Epoch: 15, Steps: 64 | Train Loss: 0.0983244 Vali Loss: 0.2365060 Test Loss: 0.2980802
Validation loss decreased (0.236602 --> 0.236506).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 16 cost time: 0.9832122325897217
Epoch: 16, Steps: 64 | Train Loss: 0.0965950 Vali Loss: 0.2350294 Test Loss: 0.2981372
Validation loss decreased (0.236506 --> 0.235029).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 17 cost time: 0.985619068145752
Epoch: 17, Steps: 64 | Train Loss: 0.0960489 Vali Loss: 0.2360895 Test Loss: 0.2974258
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 18 cost time: 1.0013694763183594
Epoch: 18, Steps: 64 | Train Loss: 0.0960989 Vali Loss: 0.2324872 Test Loss: 0.2992508
Validation loss decreased (0.235029 --> 0.232487).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 19 cost time: 0.9981296062469482
Epoch: 19, Steps: 64 | Train Loss: 0.0951503 Vali Loss: 0.2298298 Test Loss: 0.2952361
Validation loss decreased (0.232487 --> 0.229830).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 20 cost time: 0.9929540157318115
Epoch: 20, Steps: 64 | Train Loss: 0.0947356 Vali Loss: 0.2305048 Test Loss: 0.2969568
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 21 cost time: 0.9973924160003662
Epoch: 21, Steps: 64 | Train Loss: 0.0944293 Vali Loss: 0.2310670 Test Loss: 0.2967882
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 22 cost time: 0.9774022102355957
Epoch: 22, Steps: 64 | Train Loss: 0.0943051 Vali Loss: 0.2342726 Test Loss: 0.2969670
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 23 cost time: 0.9771208763122559
Epoch: 23, Steps: 64 | Train Loss: 0.0943353 Vali Loss: 0.2308367 Test Loss: 0.2965649
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 24 cost time: 0.9758040904998779
Epoch: 24, Steps: 64 | Train Loss: 0.0940623 Vali Loss: 0.2327045 Test Loss: 0.2959677
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 25 cost time: 0.9788463115692139
Epoch: 25, Steps: 64 | Train Loss: 0.0940113 Vali Loss: 0.2316428 Test Loss: 0.2963552
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 26 cost time: 0.9769482612609863
Epoch: 26, Steps: 64 | Train Loss: 0.0934606 Vali Loss: 0.2285271 Test Loss: 0.2963458
Validation loss decreased (0.229830 --> 0.228527).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 27 cost time: 0.9826264381408691
Epoch: 27, Steps: 64 | Train Loss: 0.0933114 Vali Loss: 0.2261952 Test Loss: 0.2961453
Validation loss decreased (0.228527 --> 0.226195).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 28 cost time: 0.9742505550384521
Epoch: 28, Steps: 64 | Train Loss: 0.0928423 Vali Loss: 0.2290590 Test Loss: 0.2972355
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 29 cost time: 0.9816186428070068
Epoch: 29, Steps: 64 | Train Loss: 0.0928632 Vali Loss: 0.2297356 Test Loss: 0.2971233
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 30 cost time: 0.9773259162902832
Epoch: 30, Steps: 64 | Train Loss: 0.0927021 Vali Loss: 0.2283516 Test Loss: 0.2963538
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 31 cost time: 0.9832565784454346
Epoch: 31, Steps: 64 | Train Loss: 0.0926191 Vali Loss: 0.2309235 Test Loss: 0.2959305
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 32 cost time: 0.9693863391876221
Epoch: 32, Steps: 64 | Train Loss: 0.0926668 Vali Loss: 0.2291248 Test Loss: 0.2959751
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 33 cost time: 0.9704174995422363
Epoch: 33, Steps: 64 | Train Loss: 0.0929997 Vali Loss: 0.2299903 Test Loss: 0.2959530
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 34 cost time: 0.9793627262115479
Epoch: 34, Steps: 64 | Train Loss: 0.0922402 Vali Loss: 0.2273601 Test Loss: 0.2953773
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 35 cost time: 0.9814064502716064
Epoch: 35, Steps: 64 | Train Loss: 0.0921512 Vali Loss: 0.2305282 Test Loss: 0.2975867
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 36 cost time: 0.9851415157318115
Epoch: 36, Steps: 64 | Train Loss: 0.0916512 Vali Loss: 0.2278815 Test Loss: 0.2964911
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 37 cost time: 0.982724666595459
Epoch: 37, Steps: 64 | Train Loss: 0.0915038 Vali Loss: 0.2286520 Test Loss: 0.2966114
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 38 cost time: 0.9925394058227539
Epoch: 38, Steps: 64 | Train Loss: 0.0915506 Vali Loss: 0.2296690 Test Loss: 0.2958933
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 39 cost time: 0.970634937286377
Epoch: 39, Steps: 64 | Train Loss: 0.0922111 Vali Loss: 0.2275441 Test Loss: 0.2969647
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 40 cost time: 0.9692361354827881
Epoch: 40, Steps: 64 | Train Loss: 0.0925979 Vali Loss: 0.2287598 Test Loss: 0.2952977
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 41 cost time: 0.9723539352416992
Epoch: 41, Steps: 64 | Train Loss: 0.0922744 Vali Loss: 0.2303507 Test Loss: 0.2955922
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 42 cost time: 0.9694092273712158
Epoch: 42, Steps: 64 | Train Loss: 0.0918587 Vali Loss: 0.2299923 Test Loss: 0.2971971
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 43 cost time: 0.983644962310791
Epoch: 43, Steps: 64 | Train Loss: 0.0917982 Vali Loss: 0.2267955 Test Loss: 0.2966828
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 44 cost time: 0.9884893894195557
Epoch: 44, Steps: 64 | Train Loss: 0.0925760 Vali Loss: 0.2282457 Test Loss: 0.2961152
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 45 cost time: 0.9804174900054932
Epoch: 45, Steps: 64 | Train Loss: 0.0915996 Vali Loss: 0.2287627 Test Loss: 0.2971942
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 46 cost time: 0.9793534278869629
Epoch: 46, Steps: 64 | Train Loss: 0.0918602 Vali Loss: 0.2265147 Test Loss: 0.2972749
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 47 cost time: 0.9787406921386719
Epoch: 47, Steps: 64 | Train Loss: 0.0922129 Vali Loss: 0.2285305 Test Loss: 0.2968236
EarlyStopping counter: 20 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 48 cost time: 0.9682366847991943
Epoch: 48, Steps: 64 | Train Loss: 0.0918200 Vali Loss: 0.2266404 Test Loss: 0.2949115
EarlyStopping counter: 21 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 49 cost time: 0.9699997901916504
Epoch: 49, Steps: 64 | Train Loss: 0.0917091 Vali Loss: 0.2271237 Test Loss: 0.2968947
EarlyStopping counter: 22 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 50 cost time: 0.9696154594421387
Epoch: 50, Steps: 64 | Train Loss: 0.0918031 Vali Loss: 0.2288630 Test Loss: 0.2976200
EarlyStopping counter: 23 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 51 cost time: 0.988614559173584
Epoch: 51, Steps: 64 | Train Loss: 0.0916780 Vali Loss: 0.2265704 Test Loss: 0.2952642
EarlyStopping counter: 24 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 52 cost time: 0.9820170402526855
Epoch: 52, Steps: 64 | Train Loss: 0.0917519 Vali Loss: 0.2281378 Test Loss: 0.2969517
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 53 cost time: 0.9783833026885986
Epoch: 53, Steps: 64 | Train Loss: 0.0912299 Vali Loss: 0.2292200 Test Loss: 0.2964846
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 54 cost time: 0.9933645725250244
Epoch: 54, Steps: 64 | Train Loss: 0.0916239 Vali Loss: 0.2255739 Test Loss: 0.2952546
Validation loss decreased (0.226195 --> 0.225574).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 55 cost time: 0.9884452819824219
Epoch: 55, Steps: 64 | Train Loss: 0.0917198 Vali Loss: 0.2279180 Test Loss: 0.2960302
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 56 cost time: 0.9694461822509766
Epoch: 56, Steps: 64 | Train Loss: 0.0916000 Vali Loss: 0.2296157 Test Loss: 0.2958776
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 57 cost time: 0.9813885688781738
Epoch: 57, Steps: 64 | Train Loss: 0.0914543 Vali Loss: 0.2281511 Test Loss: 0.2962804
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 58 cost time: 0.9707479476928711
Epoch: 58, Steps: 64 | Train Loss: 0.0919917 Vali Loss: 0.2270972 Test Loss: 0.2965183
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 59 cost time: 0.968998908996582
Epoch: 59, Steps: 64 | Train Loss: 0.0916361 Vali Loss: 0.2280759 Test Loss: 0.2951239
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 60 cost time: 0.9743807315826416
Epoch: 60, Steps: 64 | Train Loss: 0.0916927 Vali Loss: 0.2297499 Test Loss: 0.2975245
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.29525455832481384, mae:0.3638952076435089, rse:0.24938544631004333
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.040126800537109375 GB
Epoch: 1 cost time: 2.272406578063965
Epoch: 1, Steps: 64 | Train Loss: 0.7225326 Vali Loss: 1.8341032 Test Loss: 3.0752897
Validation loss decreased (inf --> 1.834103).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 2 cost time: 1.0193862915039062
Epoch: 2, Steps: 64 | Train Loss: 0.4894883 Vali Loss: 0.8956519 Test Loss: 1.3231192
Validation loss decreased (1.834103 --> 0.895652).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 3 cost time: 1.0153453350067139
Epoch: 3, Steps: 64 | Train Loss: 0.3198668 Vali Loss: 0.6608407 Test Loss: 0.9108126
Validation loss decreased (0.895652 --> 0.660841).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 4 cost time: 0.9206600189208984
Epoch: 4, Steps: 64 | Train Loss: 0.2403427 Vali Loss: 0.5113695 Test Loss: 0.6587079
Validation loss decreased (0.660841 --> 0.511369).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 5 cost time: 0.9364163875579834
Epoch: 5, Steps: 64 | Train Loss: 0.1971364 Vali Loss: 0.4254772 Test Loss: 0.5288950
Validation loss decreased (0.511369 --> 0.425477).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 6 cost time: 0.921377420425415
Epoch: 6, Steps: 64 | Train Loss: 0.1717392 Vali Loss: 0.3752763 Test Loss: 0.4529550
Validation loss decreased (0.425477 --> 0.375276).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 7 cost time: 0.9254970550537109
Epoch: 7, Steps: 64 | Train Loss: 0.1566731 Vali Loss: 0.3371583 Test Loss: 0.3986285
Validation loss decreased (0.375276 --> 0.337158).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 8 cost time: 0.9228131771087646
Epoch: 8, Steps: 64 | Train Loss: 0.1459739 Vali Loss: 0.3126040 Test Loss: 0.3667079
Validation loss decreased (0.337158 --> 0.312604).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 9 cost time: 0.9203436374664307
Epoch: 9, Steps: 64 | Train Loss: 0.1400492 Vali Loss: 0.3035235 Test Loss: 0.3512220
Validation loss decreased (0.312604 --> 0.303524).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 10 cost time: 0.9326109886169434
Epoch: 10, Steps: 64 | Train Loss: 0.1350828 Vali Loss: 0.2910155 Test Loss: 0.3340972
Validation loss decreased (0.303524 --> 0.291015).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 11 cost time: 0.936638593673706
Epoch: 11, Steps: 64 | Train Loss: 0.1313505 Vali Loss: 0.2819334 Test Loss: 0.3275312
Validation loss decreased (0.291015 --> 0.281933).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 12 cost time: 0.9343445301055908
Epoch: 12, Steps: 64 | Train Loss: 0.1287658 Vali Loss: 0.2707948 Test Loss: 0.3173052
Validation loss decreased (0.281933 --> 0.270795).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 13 cost time: 0.9288425445556641
Epoch: 13, Steps: 64 | Train Loss: 0.1269984 Vali Loss: 0.2705565 Test Loss: 0.3142617
Validation loss decreased (0.270795 --> 0.270557).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 14 cost time: 0.9337162971496582
Epoch: 14, Steps: 64 | Train Loss: 0.1244161 Vali Loss: 0.2684869 Test Loss: 0.3122488
Validation loss decreased (0.270557 --> 0.268487).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 15 cost time: 0.9203710556030273
Epoch: 15, Steps: 64 | Train Loss: 0.1234310 Vali Loss: 0.2695631 Test Loss: 0.3075703
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 16 cost time: 0.9247212409973145
Epoch: 16, Steps: 64 | Train Loss: 0.1215338 Vali Loss: 0.2661408 Test Loss: 0.3085452
Validation loss decreased (0.268487 --> 0.266141).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 17 cost time: 0.9210002422332764
Epoch: 17, Steps: 64 | Train Loss: 0.1206425 Vali Loss: 0.2600600 Test Loss: 0.3054045
Validation loss decreased (0.266141 --> 0.260060).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 18 cost time: 0.9286167621612549
Epoch: 18, Steps: 64 | Train Loss: 0.1192187 Vali Loss: 0.2592321 Test Loss: 0.3039868
Validation loss decreased (0.260060 --> 0.259232).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 19 cost time: 0.937553882598877
Epoch: 19, Steps: 64 | Train Loss: 0.1188759 Vali Loss: 0.2605536 Test Loss: 0.3033161
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 20 cost time: 0.9356632232666016
Epoch: 20, Steps: 64 | Train Loss: 0.1183132 Vali Loss: 0.2604394 Test Loss: 0.3027728
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 21 cost time: 0.9384369850158691
Epoch: 21, Steps: 64 | Train Loss: 0.1171602 Vali Loss: 0.2576138 Test Loss: 0.3013653
Validation loss decreased (0.259232 --> 0.257614).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 22 cost time: 0.9350459575653076
Epoch: 22, Steps: 64 | Train Loss: 0.1172982 Vali Loss: 0.2590356 Test Loss: 0.2997034
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 23 cost time: 0.9204065799713135
Epoch: 23, Steps: 64 | Train Loss: 0.1159425 Vali Loss: 0.2552761 Test Loss: 0.2999474
Validation loss decreased (0.257614 --> 0.255276).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 24 cost time: 0.9297575950622559
Epoch: 24, Steps: 64 | Train Loss: 0.1156784 Vali Loss: 0.2523281 Test Loss: 0.2977973
Validation loss decreased (0.255276 --> 0.252328).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 25 cost time: 0.9140000343322754
Epoch: 25, Steps: 64 | Train Loss: 0.1154614 Vali Loss: 0.2546945 Test Loss: 0.2989525
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 26 cost time: 0.9170339107513428
Epoch: 26, Steps: 64 | Train Loss: 0.1143985 Vali Loss: 0.2551484 Test Loss: 0.2977452
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 27 cost time: 0.9203414916992188
Epoch: 27, Steps: 64 | Train Loss: 0.1148303 Vali Loss: 0.2550526 Test Loss: 0.2974156
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 28 cost time: 0.9173710346221924
Epoch: 28, Steps: 64 | Train Loss: 0.1136649 Vali Loss: 0.2533601 Test Loss: 0.2967612
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 29 cost time: 0.9194769859313965
Epoch: 29, Steps: 64 | Train Loss: 0.1138914 Vali Loss: 0.2528675 Test Loss: 0.2974986
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 30 cost time: 0.9375231266021729
Epoch: 30, Steps: 64 | Train Loss: 0.1134985 Vali Loss: 0.2507972 Test Loss: 0.2978001
Validation loss decreased (0.252328 --> 0.250797).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 31 cost time: 0.9417824745178223
Epoch: 31, Steps: 64 | Train Loss: 0.1130319 Vali Loss: 0.2507586 Test Loss: 0.2964364
Validation loss decreased (0.250797 --> 0.250759).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 32 cost time: 0.9247457981109619
Epoch: 32, Steps: 64 | Train Loss: 0.1127410 Vali Loss: 0.2478149 Test Loss: 0.2944081
Validation loss decreased (0.250759 --> 0.247815).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 33 cost time: 0.9280016422271729
Epoch: 33, Steps: 64 | Train Loss: 0.1128590 Vali Loss: 0.2508799 Test Loss: 0.2961296
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 34 cost time: 0.9203672409057617
Epoch: 34, Steps: 64 | Train Loss: 0.1134177 Vali Loss: 0.2504040 Test Loss: 0.2970278
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 35 cost time: 0.9373345375061035
Epoch: 35, Steps: 64 | Train Loss: 0.1122584 Vali Loss: 0.2488153 Test Loss: 0.2959705
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 36 cost time: 0.9283294677734375
Epoch: 36, Steps: 64 | Train Loss: 0.1122827 Vali Loss: 0.2479394 Test Loss: 0.2962701
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 37 cost time: 0.9340434074401855
Epoch: 37, Steps: 64 | Train Loss: 0.1124677 Vali Loss: 0.2494822 Test Loss: 0.2953310
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 38 cost time: 0.9453930854797363
Epoch: 38, Steps: 64 | Train Loss: 0.1121091 Vali Loss: 0.2501443 Test Loss: 0.2945378
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 39 cost time: 0.9373519420623779
Epoch: 39, Steps: 64 | Train Loss: 0.1120984 Vali Loss: 0.2511741 Test Loss: 0.2946490
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 40 cost time: 0.9337780475616455
Epoch: 40, Steps: 64 | Train Loss: 0.1115815 Vali Loss: 0.2500728 Test Loss: 0.2968397
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 41 cost time: 0.924997091293335
Epoch: 41, Steps: 64 | Train Loss: 0.1126045 Vali Loss: 0.2461753 Test Loss: 0.2938257
Validation loss decreased (0.247815 --> 0.246175).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 42 cost time: 0.9156208038330078
Epoch: 42, Steps: 64 | Train Loss: 0.1121898 Vali Loss: 0.2479407 Test Loss: 0.2960983
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 43 cost time: 0.925360918045044
Epoch: 43, Steps: 64 | Train Loss: 0.1123460 Vali Loss: 0.2516958 Test Loss: 0.2966398
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 44 cost time: 0.9263956546783447
Epoch: 44, Steps: 64 | Train Loss: 0.1111982 Vali Loss: 0.2493366 Test Loss: 0.2950620
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 45 cost time: 0.9384109973907471
Epoch: 45, Steps: 64 | Train Loss: 0.1115268 Vali Loss: 0.2496697 Test Loss: 0.2959011
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 46 cost time: 0.9344179630279541
Epoch: 46, Steps: 64 | Train Loss: 0.1110015 Vali Loss: 0.2501338 Test Loss: 0.2948669
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 47 cost time: 0.9362821578979492
Epoch: 47, Steps: 64 | Train Loss: 0.1113790 Vali Loss: 0.2513977 Test Loss: 0.2946105
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 48 cost time: 0.9329993724822998
Epoch: 48, Steps: 64 | Train Loss: 0.1117421 Vali Loss: 0.2470660 Test Loss: 0.2932146
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 49 cost time: 0.9200003147125244
Epoch: 49, Steps: 64 | Train Loss: 0.1113738 Vali Loss: 0.2489120 Test Loss: 0.2949598
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 50 cost time: 0.9206171035766602
Epoch: 50, Steps: 64 | Train Loss: 0.1114929 Vali Loss: 0.2517089 Test Loss: 0.2962821
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 51 cost time: 0.9197123050689697
Epoch: 51, Steps: 64 | Train Loss: 0.1111885 Vali Loss: 0.2467617 Test Loss: 0.2951187
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 52 cost time: 0.9434759616851807
Epoch: 52, Steps: 64 | Train Loss: 0.1116211 Vali Loss: 0.2514669 Test Loss: 0.2965707
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 53 cost time: 0.9253251552581787
Epoch: 53, Steps: 64 | Train Loss: 0.1106866 Vali Loss: 0.2504976 Test Loss: 0.2935929
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 54 cost time: 0.9336326122283936
Epoch: 54, Steps: 64 | Train Loss: 0.1115721 Vali Loss: 0.2500232 Test Loss: 0.2948977
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 55 cost time: 0.9497370719909668
Epoch: 55, Steps: 64 | Train Loss: 0.1104938 Vali Loss: 0.2494727 Test Loss: 0.2950115
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 56 cost time: 0.92799973487854
Epoch: 56, Steps: 64 | Train Loss: 0.1109054 Vali Loss: 0.2509885 Test Loss: 0.2965313
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 57 cost time: 0.9336252212524414
Epoch: 57, Steps: 64 | Train Loss: 0.1115103 Vali Loss: 0.2463576 Test Loss: 0.2948147
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 58 cost time: 0.9255356788635254
Epoch: 58, Steps: 64 | Train Loss: 0.1115096 Vali Loss: 0.2485324 Test Loss: 0.2939204
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 59 cost time: 0.9395356178283691
Epoch: 59, Steps: 64 | Train Loss: 0.1115854 Vali Loss: 0.2458517 Test Loss: 0.2937206
Validation loss decreased (0.246175 --> 0.245852).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 60 cost time: 0.9300899505615234
Epoch: 60, Steps: 64 | Train Loss: 0.1116348 Vali Loss: 0.2505055 Test Loss: 0.2963271
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2937205135822296, mae:0.35586073994636536, rse:0.24873675405979156
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.04082822799682617 GB
Epoch: 1 cost time: 2.3259968757629395
Epoch: 1, Steps: 64 | Train Loss: 0.9073117 Vali Loss: 2.6944623 Test Loss: 4.6742415
Validation loss decreased (inf --> 2.694462).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 2 cost time: 0.9654476642608643
Epoch: 2, Steps: 64 | Train Loss: 0.6379467 Vali Loss: 1.2627807 Test Loss: 2.0363498
Validation loss decreased (2.694462 --> 1.262781).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 3 cost time: 1.0087299346923828
Epoch: 3, Steps: 64 | Train Loss: 0.3192857 Vali Loss: 0.6048195 Test Loss: 0.8099707
Validation loss decreased (1.262781 --> 0.604819).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 4 cost time: 0.9607579708099365
Epoch: 4, Steps: 64 | Train Loss: 0.1760426 Vali Loss: 0.3939331 Test Loss: 0.4546306
Validation loss decreased (0.604819 --> 0.393933).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 5 cost time: 0.9754433631896973
Epoch: 5, Steps: 64 | Train Loss: 0.1331772 Vali Loss: 0.3175713 Test Loss: 0.3514970
Validation loss decreased (0.393933 --> 0.317571).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 6 cost time: 0.9529998302459717
Epoch: 6, Steps: 64 | Train Loss: 0.1209868 Vali Loss: 0.2903057 Test Loss: 0.3275656
Validation loss decreased (0.317571 --> 0.290306).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 7 cost time: 0.9516291618347168
Epoch: 7, Steps: 64 | Train Loss: 0.1154061 Vali Loss: 0.2796499 Test Loss: 0.3171957
Validation loss decreased (0.290306 --> 0.279650).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 8 cost time: 0.9583449363708496
Epoch: 8, Steps: 64 | Train Loss: 0.1124469 Vali Loss: 0.2757907 Test Loss: 0.3151431
Validation loss decreased (0.279650 --> 0.275791).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 9 cost time: 0.9619736671447754
Epoch: 9, Steps: 64 | Train Loss: 0.1088028 Vali Loss: 0.2675699 Test Loss: 0.3131808
Validation loss decreased (0.275791 --> 0.267570).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 10 cost time: 0.9624066352844238
Epoch: 10, Steps: 64 | Train Loss: 0.1080072 Vali Loss: 0.2692353 Test Loss: 0.3113709
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 11 cost time: 0.9633748531341553
Epoch: 11, Steps: 64 | Train Loss: 0.1049444 Vali Loss: 0.2619675 Test Loss: 0.3088840
Validation loss decreased (0.267570 --> 0.261968).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 12 cost time: 0.9784934520721436
Epoch: 12, Steps: 64 | Train Loss: 0.1036232 Vali Loss: 0.2624679 Test Loss: 0.3089442
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 13 cost time: 0.9640538692474365
Epoch: 13, Steps: 64 | Train Loss: 0.1032985 Vali Loss: 0.2617406 Test Loss: 0.3091170
Validation loss decreased (0.261968 --> 0.261741).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 14 cost time: 0.9577713012695312
Epoch: 14, Steps: 64 | Train Loss: 0.1025208 Vali Loss: 0.2554720 Test Loss: 0.3099007
Validation loss decreased (0.261741 --> 0.255472).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 15 cost time: 0.9609999656677246
Epoch: 15, Steps: 64 | Train Loss: 0.1016677 Vali Loss: 0.2585559 Test Loss: 0.3102681
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 16 cost time: 0.9610002040863037
Epoch: 16, Steps: 64 | Train Loss: 0.1007344 Vali Loss: 0.2566257 Test Loss: 0.3078986
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 17 cost time: 0.9546215534210205
Epoch: 17, Steps: 64 | Train Loss: 0.1001368 Vali Loss: 0.2575766 Test Loss: 0.3089918
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 18 cost time: 0.9827005863189697
Epoch: 18, Steps: 64 | Train Loss: 0.0990790 Vali Loss: 0.2527670 Test Loss: 0.3067671
Validation loss decreased (0.255472 --> 0.252767).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 19 cost time: 0.9758939743041992
Epoch: 19, Steps: 64 | Train Loss: 0.0986654 Vali Loss: 0.2537369 Test Loss: 0.3082843
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 20 cost time: 0.9613573551177979
Epoch: 20, Steps: 64 | Train Loss: 0.0982330 Vali Loss: 0.2525859 Test Loss: 0.3068179
Validation loss decreased (0.252767 --> 0.252586).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 21 cost time: 0.9683914184570312
Epoch: 21, Steps: 64 | Train Loss: 0.0978552 Vali Loss: 0.2526678 Test Loss: 0.3079921
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 22 cost time: 0.9529011249542236
Epoch: 22, Steps: 64 | Train Loss: 0.0977224 Vali Loss: 0.2475478 Test Loss: 0.3064906
Validation loss decreased (0.252586 --> 0.247548).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 23 cost time: 0.9536359310150146
Epoch: 23, Steps: 64 | Train Loss: 0.0971636 Vali Loss: 0.2510087 Test Loss: 0.3068422
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 24 cost time: 0.9567317962646484
Epoch: 24, Steps: 64 | Train Loss: 0.0976874 Vali Loss: 0.2490791 Test Loss: 0.3074682
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 25 cost time: 0.9623937606811523
Epoch: 25, Steps: 64 | Train Loss: 0.0968623 Vali Loss: 0.2517276 Test Loss: 0.3077821
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 26 cost time: 0.9620141983032227
Epoch: 26, Steps: 64 | Train Loss: 0.0964730 Vali Loss: 0.2520112 Test Loss: 0.3067576
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 27 cost time: 0.964611291885376
Epoch: 27, Steps: 64 | Train Loss: 0.0965464 Vali Loss: 0.2505750 Test Loss: 0.3079155
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 28 cost time: 0.9653851985931396
Epoch: 28, Steps: 64 | Train Loss: 0.0961399 Vali Loss: 0.2514896 Test Loss: 0.3081949
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 29 cost time: 0.9512028694152832
Epoch: 29, Steps: 64 | Train Loss: 0.0964724 Vali Loss: 0.2496551 Test Loss: 0.3090777
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 30 cost time: 0.9860119819641113
Epoch: 30, Steps: 64 | Train Loss: 0.0960710 Vali Loss: 0.2506652 Test Loss: 0.3075865
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 31 cost time: 0.974482536315918
Epoch: 31, Steps: 64 | Train Loss: 0.0958317 Vali Loss: 0.2484327 Test Loss: 0.3067808
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 32 cost time: 0.9873130321502686
Epoch: 32, Steps: 64 | Train Loss: 0.0953758 Vali Loss: 0.2475996 Test Loss: 0.3071357
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 33 cost time: 0.9763691425323486
Epoch: 33, Steps: 64 | Train Loss: 0.0952187 Vali Loss: 0.2489025 Test Loss: 0.3080455
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 34 cost time: 0.9792375564575195
Epoch: 34, Steps: 64 | Train Loss: 0.0956064 Vali Loss: 0.2469574 Test Loss: 0.3063149
Validation loss decreased (0.247548 --> 0.246957).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 35 cost time: 0.9847762584686279
Epoch: 35, Steps: 64 | Train Loss: 0.0954223 Vali Loss: 0.2480378 Test Loss: 0.3095317
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 36 cost time: 0.9839999675750732
Epoch: 36, Steps: 64 | Train Loss: 0.0955725 Vali Loss: 0.2495342 Test Loss: 0.3084685
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 37 cost time: 0.9846060276031494
Epoch: 37, Steps: 64 | Train Loss: 0.0951824 Vali Loss: 0.2507513 Test Loss: 0.3087133
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 38 cost time: 0.983959436416626
Epoch: 38, Steps: 64 | Train Loss: 0.0951880 Vali Loss: 0.2468688 Test Loss: 0.3076059
Validation loss decreased (0.246957 --> 0.246869).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 39 cost time: 0.9805970191955566
Epoch: 39, Steps: 64 | Train Loss: 0.0946817 Vali Loss: 0.2485801 Test Loss: 0.3084526
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 40 cost time: 0.9834504127502441
Epoch: 40, Steps: 64 | Train Loss: 0.0949674 Vali Loss: 0.2505650 Test Loss: 0.3088261
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 41 cost time: 0.9793651103973389
Epoch: 41, Steps: 64 | Train Loss: 0.0948681 Vali Loss: 0.2512372 Test Loss: 0.3084635
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 42 cost time: 0.9693071842193604
Epoch: 42, Steps: 64 | Train Loss: 0.0948166 Vali Loss: 0.2481653 Test Loss: 0.3081164
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 43 cost time: 0.9798092842102051
Epoch: 43, Steps: 64 | Train Loss: 0.0951654 Vali Loss: 0.2478571 Test Loss: 0.3075215
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 44 cost time: 0.9884896278381348
Epoch: 44, Steps: 64 | Train Loss: 0.0947633 Vali Loss: 0.2497483 Test Loss: 0.3086531
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 45 cost time: 0.98238205909729
Epoch: 45, Steps: 64 | Train Loss: 0.0946877 Vali Loss: 0.2470539 Test Loss: 0.3077899
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 46 cost time: 0.9582295417785645
Epoch: 46, Steps: 64 | Train Loss: 0.0948169 Vali Loss: 0.2490927 Test Loss: 0.3073401
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 47 cost time: 0.956622838973999
Epoch: 47, Steps: 64 | Train Loss: 0.0944109 Vali Loss: 0.2456216 Test Loss: 0.3078468
Validation loss decreased (0.246869 --> 0.245622).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 48 cost time: 0.9639999866485596
Epoch: 48, Steps: 64 | Train Loss: 0.0946892 Vali Loss: 0.2478160 Test Loss: 0.3073544
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 49 cost time: 0.95271897315979
Epoch: 49, Steps: 64 | Train Loss: 0.0940138 Vali Loss: 0.2501540 Test Loss: 0.3074240
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 50 cost time: 0.9593727588653564
Epoch: 50, Steps: 64 | Train Loss: 0.0943770 Vali Loss: 0.2482567 Test Loss: 0.3073086
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 51 cost time: 0.9556272029876709
Epoch: 51, Steps: 64 | Train Loss: 0.0944741 Vali Loss: 0.2478145 Test Loss: 0.3082776
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 52 cost time: 0.9843788146972656
Epoch: 52, Steps: 64 | Train Loss: 0.0947793 Vali Loss: 0.2486546 Test Loss: 0.3085925
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 53 cost time: 0.9684197902679443
Epoch: 53, Steps: 64 | Train Loss: 0.0941655 Vali Loss: 0.2492088 Test Loss: 0.3075457
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 54 cost time: 0.964421272277832
Epoch: 54, Steps: 64 | Train Loss: 0.0945119 Vali Loss: 0.2486097 Test Loss: 0.3085997
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 55 cost time: 0.9821693897247314
Epoch: 55, Steps: 64 | Train Loss: 0.0949123 Vali Loss: 0.2464757 Test Loss: 0.3086942
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 56 cost time: 0.9637594223022461
Epoch: 56, Steps: 64 | Train Loss: 0.0949035 Vali Loss: 0.2469705 Test Loss: 0.3082072
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 57 cost time: 0.9619994163513184
Epoch: 57, Steps: 64 | Train Loss: 0.0944633 Vali Loss: 0.2487211 Test Loss: 0.3080097
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 58 cost time: 0.9710006713867188
Epoch: 58, Steps: 64 | Train Loss: 0.0948273 Vali Loss: 0.2476617 Test Loss: 0.3074884
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 59 cost time: 0.9610748291015625
Epoch: 59, Steps: 64 | Train Loss: 0.0942632 Vali Loss: 0.2436800 Test Loss: 0.3067585
Validation loss decreased (0.245622 --> 0.243680).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 60 cost time: 0.9583988189697266
Epoch: 60, Steps: 64 | Train Loss: 0.0942126 Vali Loss: 0.2481894 Test Loss: 0.3083753
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.3067585527896881, mae:0.3795149326324463, rse:0.2541974186897278
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04139232635498047 GB
Epoch: 1 cost time: 2.3560030460357666
Epoch: 1, Steps: 64 | Train Loss: 0.8968571 Vali Loss: 2.7611201 Test Loss: 4.8250327
Validation loss decreased (inf --> 2.761120).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 2 cost time: 0.9697108268737793
Epoch: 2, Steps: 64 | Train Loss: 0.6735919 Vali Loss: 1.5094290 Test Loss: 2.4856930
Validation loss decreased (2.761120 --> 1.509429).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 3 cost time: 1.0844438076019287
Epoch: 3, Steps: 64 | Train Loss: 0.3702564 Vali Loss: 0.7712011 Test Loss: 1.0977113
Validation loss decreased (1.509429 --> 0.771201).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 4 cost time: 0.9900200366973877
Epoch: 4, Steps: 64 | Train Loss: 0.1989196 Vali Loss: 0.4313374 Test Loss: 0.4854084
Validation loss decreased (0.771201 --> 0.431337).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 5 cost time: 0.9653291702270508
Epoch: 5, Steps: 64 | Train Loss: 0.1396554 Vali Loss: 0.3285433 Test Loss: 0.3529863
Validation loss decreased (0.431337 --> 0.328543).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 6 cost time: 0.9844188690185547
Epoch: 6, Steps: 64 | Train Loss: 0.1241652 Vali Loss: 0.2921198 Test Loss: 0.3211500
Validation loss decreased (0.328543 --> 0.292120).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 7 cost time: 0.9864177703857422
Epoch: 7, Steps: 64 | Train Loss: 0.1171553 Vali Loss: 0.2803513 Test Loss: 0.3125453
Validation loss decreased (0.292120 --> 0.280351).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 8 cost time: 0.980015754699707
Epoch: 8, Steps: 64 | Train Loss: 0.1124018 Vali Loss: 0.2670596 Test Loss: 0.3072173
Validation loss decreased (0.280351 --> 0.267060).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 9 cost time: 0.9807987213134766
Epoch: 9, Steps: 64 | Train Loss: 0.1094905 Vali Loss: 0.2643372 Test Loss: 0.3066062
Validation loss decreased (0.267060 --> 0.264337).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 10 cost time: 0.9877591133117676
Epoch: 10, Steps: 64 | Train Loss: 0.1070117 Vali Loss: 0.2564119 Test Loss: 0.3016766
Validation loss decreased (0.264337 --> 0.256412).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 11 cost time: 1.0090000629425049
Epoch: 11, Steps: 64 | Train Loss: 0.1052739 Vali Loss: 0.2542667 Test Loss: 0.3036622
Validation loss decreased (0.256412 --> 0.254267).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 12 cost time: 0.9939994812011719
Epoch: 12, Steps: 64 | Train Loss: 0.1035269 Vali Loss: 0.2458877 Test Loss: 0.3027588
Validation loss decreased (0.254267 --> 0.245888).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 13 cost time: 0.9916219711303711
Epoch: 13, Steps: 64 | Train Loss: 0.1017128 Vali Loss: 0.2480034 Test Loss: 0.3041541
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 14 cost time: 0.9886233806610107
Epoch: 14, Steps: 64 | Train Loss: 0.1011054 Vali Loss: 0.2456788 Test Loss: 0.3028049
Validation loss decreased (0.245888 --> 0.245679).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 15 cost time: 1.0324649810791016
Epoch: 15, Steps: 64 | Train Loss: 0.1001693 Vali Loss: 0.2424666 Test Loss: 0.3006229
Validation loss decreased (0.245679 --> 0.242467).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 16 cost time: 0.9789621829986572
Epoch: 16, Steps: 64 | Train Loss: 0.0992396 Vali Loss: 0.2438652 Test Loss: 0.3023740
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 17 cost time: 0.9873449802398682
Epoch: 17, Steps: 64 | Train Loss: 0.0983479 Vali Loss: 0.2414233 Test Loss: 0.3023205
Validation loss decreased (0.242467 --> 0.241423).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 18 cost time: 0.9954185485839844
Epoch: 18, Steps: 64 | Train Loss: 0.0982262 Vali Loss: 0.2379416 Test Loss: 0.2986906
Validation loss decreased (0.241423 --> 0.237942).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 19 cost time: 0.9913270473480225
Epoch: 19, Steps: 64 | Train Loss: 0.0974537 Vali Loss: 0.2384416 Test Loss: 0.2986065
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 20 cost time: 0.9953536987304688
Epoch: 20, Steps: 64 | Train Loss: 0.0974442 Vali Loss: 0.2402394 Test Loss: 0.2998926
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 21 cost time: 0.9973876476287842
Epoch: 21, Steps: 64 | Train Loss: 0.0967916 Vali Loss: 0.2390950 Test Loss: 0.3012756
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 22 cost time: 0.9803676605224609
Epoch: 22, Steps: 64 | Train Loss: 0.0964373 Vali Loss: 0.2352336 Test Loss: 0.2989001
Validation loss decreased (0.237942 --> 0.235234).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 23 cost time: 0.9767858982086182
Epoch: 23, Steps: 64 | Train Loss: 0.0962448 Vali Loss: 0.2353891 Test Loss: 0.3006308
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 24 cost time: 0.9776468276977539
Epoch: 24, Steps: 64 | Train Loss: 0.0956509 Vali Loss: 0.2355737 Test Loss: 0.2989928
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 25 cost time: 0.9660000801086426
Epoch: 25, Steps: 64 | Train Loss: 0.0955537 Vali Loss: 0.2340911 Test Loss: 0.2982955
Validation loss decreased (0.235234 --> 0.234091).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 26 cost time: 0.9586474895477295
Epoch: 26, Steps: 64 | Train Loss: 0.0949466 Vali Loss: 0.2343743 Test Loss: 0.2979971
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 27 cost time: 1.0776088237762451
Epoch: 27, Steps: 64 | Train Loss: 0.0953834 Vali Loss: 0.2303004 Test Loss: 0.2985418
Validation loss decreased (0.234091 --> 0.230300).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 28 cost time: 1.015052318572998
Epoch: 28, Steps: 64 | Train Loss: 0.0949974 Vali Loss: 0.2352325 Test Loss: 0.2988349
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 29 cost time: 1.011352300643921
Epoch: 29, Steps: 64 | Train Loss: 0.0944720 Vali Loss: 0.2339455 Test Loss: 0.2979322
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 30 cost time: 1.003373146057129
Epoch: 30, Steps: 64 | Train Loss: 0.0946387 Vali Loss: 0.2326377 Test Loss: 0.2984805
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 31 cost time: 0.9866797924041748
Epoch: 31, Steps: 64 | Train Loss: 0.0940346 Vali Loss: 0.2323512 Test Loss: 0.2976432
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 32 cost time: 0.9743764400482178
Epoch: 32, Steps: 64 | Train Loss: 0.0940691 Vali Loss: 0.2315187 Test Loss: 0.2977935
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 33 cost time: 0.9820539951324463
Epoch: 33, Steps: 64 | Train Loss: 0.0937813 Vali Loss: 0.2326295 Test Loss: 0.2982960
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 34 cost time: 0.9980032444000244
Epoch: 34, Steps: 64 | Train Loss: 0.0937729 Vali Loss: 0.2343450 Test Loss: 0.2973676
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 35 cost time: 0.9910504817962646
Epoch: 35, Steps: 64 | Train Loss: 0.0943769 Vali Loss: 0.2335201 Test Loss: 0.2999408
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 36 cost time: 0.9901633262634277
Epoch: 36, Steps: 64 | Train Loss: 0.0940764 Vali Loss: 0.2354503 Test Loss: 0.2996155
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 37 cost time: 1.0047268867492676
Epoch: 37, Steps: 64 | Train Loss: 0.0943140 Vali Loss: 0.2348778 Test Loss: 0.2987968
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 38 cost time: 0.983999490737915
Epoch: 38, Steps: 64 | Train Loss: 0.0938919 Vali Loss: 0.2334174 Test Loss: 0.2969805
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 39 cost time: 0.9770002365112305
Epoch: 39, Steps: 64 | Train Loss: 0.0939927 Vali Loss: 0.2344037 Test Loss: 0.2971962
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 40 cost time: 0.9760620594024658
Epoch: 40, Steps: 64 | Train Loss: 0.0931720 Vali Loss: 0.2347695 Test Loss: 0.2985316
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 41 cost time: 0.9759929180145264
Epoch: 41, Steps: 64 | Train Loss: 0.0939827 Vali Loss: 0.2331024 Test Loss: 0.2978680
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 42 cost time: 0.9793317317962646
Epoch: 42, Steps: 64 | Train Loss: 0.0933380 Vali Loss: 0.2298221 Test Loss: 0.2980435
Validation loss decreased (0.230300 --> 0.229822).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 43 cost time: 0.9943296909332275
Epoch: 43, Steps: 64 | Train Loss: 0.0940736 Vali Loss: 0.2328241 Test Loss: 0.2979813
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 44 cost time: 0.9702246189117432
Epoch: 44, Steps: 64 | Train Loss: 0.0938641 Vali Loss: 0.2299080 Test Loss: 0.2980771
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 45 cost time: 0.9875771999359131
Epoch: 45, Steps: 64 | Train Loss: 0.0931803 Vali Loss: 0.2356578 Test Loss: 0.2985838
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 46 cost time: 0.9943747520446777
Epoch: 46, Steps: 64 | Train Loss: 0.0937857 Vali Loss: 0.2317031 Test Loss: 0.2973305
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 47 cost time: 0.9793922901153564
Epoch: 47, Steps: 64 | Train Loss: 0.0931058 Vali Loss: 0.2303573 Test Loss: 0.2973705
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 48 cost time: 0.9764814376831055
Epoch: 48, Steps: 64 | Train Loss: 0.0931170 Vali Loss: 0.2299003 Test Loss: 0.2977316
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 49 cost time: 0.9959781169891357
Epoch: 49, Steps: 64 | Train Loss: 0.0931524 Vali Loss: 0.2329506 Test Loss: 0.2976575
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 50 cost time: 0.9869973659515381
Epoch: 50, Steps: 64 | Train Loss: 0.0931707 Vali Loss: 0.2305858 Test Loss: 0.2981946
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 51 cost time: 0.9880001544952393
Epoch: 51, Steps: 64 | Train Loss: 0.0929740 Vali Loss: 0.2310923 Test Loss: 0.2967612
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 52 cost time: 0.9930770397186279
Epoch: 52, Steps: 64 | Train Loss: 0.0928419 Vali Loss: 0.2319921 Test Loss: 0.2997294
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 53 cost time: 1.0014283657073975
Epoch: 53, Steps: 64 | Train Loss: 0.0930376 Vali Loss: 0.2308660 Test Loss: 0.2969826
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 54 cost time: 0.9913318157196045
Epoch: 54, Steps: 64 | Train Loss: 0.0936035 Vali Loss: 0.2334593 Test Loss: 0.2997717
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 55 cost time: 0.9803509712219238
Epoch: 55, Steps: 64 | Train Loss: 0.0937872 Vali Loss: 0.2277673 Test Loss: 0.2967252
Validation loss decreased (0.229822 --> 0.227767).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 56 cost time: 0.9774742126464844
Epoch: 56, Steps: 64 | Train Loss: 0.0931410 Vali Loss: 0.2294420 Test Loss: 0.2986822
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 57 cost time: 0.9863500595092773
Epoch: 57, Steps: 64 | Train Loss: 0.0930229 Vali Loss: 0.2317231 Test Loss: 0.2968388
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 58 cost time: 0.9793329238891602
Epoch: 58, Steps: 64 | Train Loss: 0.0932131 Vali Loss: 0.2325801 Test Loss: 0.2968301
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 59 cost time: 0.9813566207885742
Epoch: 59, Steps: 64 | Train Loss: 0.0931565 Vali Loss: 0.2290367 Test Loss: 0.2983989
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 60 cost time: 1.0037589073181152
Epoch: 60, Steps: 64 | Train Loss: 0.0934142 Vali Loss: 0.2313519 Test Loss: 0.2991864
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.29672518372535706, mae:0.36804795265197754, rse:0.2500057518482208
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04735612869262695 GB
Epoch: 1 cost time: 2.288581371307373
Epoch: 1, Steps: 64 | Train Loss: 0.8824189 Vali Loss: 2.3868990 Test Loss: 4.1217360
Validation loss decreased (inf --> 2.386899).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 2 cost time: 0.9179999828338623
Epoch: 2, Steps: 64 | Train Loss: 0.6343039 Vali Loss: 1.1655591 Test Loss: 1.8906908
Validation loss decreased (2.386899 --> 1.165559).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 3 cost time: 0.917616605758667
Epoch: 3, Steps: 64 | Train Loss: 0.3786314 Vali Loss: 0.7363016 Test Loss: 1.0969877
Validation loss decreased (1.165559 --> 0.736302).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 4 cost time: 0.9112980365753174
Epoch: 4, Steps: 64 | Train Loss: 0.2646669 Vali Loss: 0.5435721 Test Loss: 0.7473293
Validation loss decreased (0.736302 --> 0.543572).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 5 cost time: 0.9103848934173584
Epoch: 5, Steps: 64 | Train Loss: 0.2141757 Vali Loss: 0.4561752 Test Loss: 0.5905358
Validation loss decreased (0.543572 --> 0.456175).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 6 cost time: 0.9024312496185303
Epoch: 6, Steps: 64 | Train Loss: 0.1871838 Vali Loss: 0.4016712 Test Loss: 0.4996480
Validation loss decreased (0.456175 --> 0.401671).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 7 cost time: 0.900367259979248
Epoch: 7, Steps: 64 | Train Loss: 0.1707650 Vali Loss: 0.3613313 Test Loss: 0.4478287
Validation loss decreased (0.401671 --> 0.361331).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 8 cost time: 0.9047951698303223
Epoch: 8, Steps: 64 | Train Loss: 0.1604687 Vali Loss: 0.3384551 Test Loss: 0.4077935
Validation loss decreased (0.361331 --> 0.338455).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 9 cost time: 0.9019999504089355
Epoch: 9, Steps: 64 | Train Loss: 0.1535153 Vali Loss: 0.3175830 Test Loss: 0.3806003
Validation loss decreased (0.338455 --> 0.317583).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 10 cost time: 0.9212584495544434
Epoch: 10, Steps: 64 | Train Loss: 0.1473554 Vali Loss: 0.3108450 Test Loss: 0.3660417
Validation loss decreased (0.317583 --> 0.310845).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 11 cost time: 0.9144120216369629
Epoch: 11, Steps: 64 | Train Loss: 0.1430393 Vali Loss: 0.2925799 Test Loss: 0.3505272
Validation loss decreased (0.310845 --> 0.292580).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 12 cost time: 0.9123642444610596
Epoch: 12, Steps: 64 | Train Loss: 0.1401374 Vali Loss: 0.2891451 Test Loss: 0.3435678
Validation loss decreased (0.292580 --> 0.289145).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 13 cost time: 0.9183893203735352
Epoch: 13, Steps: 64 | Train Loss: 0.1359265 Vali Loss: 0.2846349 Test Loss: 0.3384742
Validation loss decreased (0.289145 --> 0.284635).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 14 cost time: 0.9234814643859863
Epoch: 14, Steps: 64 | Train Loss: 0.1344505 Vali Loss: 0.2784570 Test Loss: 0.3330200
Validation loss decreased (0.284635 --> 0.278457).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 15 cost time: 0.9060893058776855
Epoch: 15, Steps: 64 | Train Loss: 0.1315789 Vali Loss: 0.2742524 Test Loss: 0.3312029
Validation loss decreased (0.278457 --> 0.274252).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 16 cost time: 0.9066181182861328
Epoch: 16, Steps: 64 | Train Loss: 0.1305424 Vali Loss: 0.2724121 Test Loss: 0.3263174
Validation loss decreased (0.274252 --> 0.272412).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 17 cost time: 0.9184243679046631
Epoch: 17, Steps: 64 | Train Loss: 0.1290409 Vali Loss: 0.2702492 Test Loss: 0.3237011
Validation loss decreased (0.272412 --> 0.270249).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 18 cost time: 0.9031333923339844
Epoch: 18, Steps: 64 | Train Loss: 0.1282492 Vali Loss: 0.2651200 Test Loss: 0.3227447
Validation loss decreased (0.270249 --> 0.265120).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 19 cost time: 0.9073755741119385
Epoch: 19, Steps: 64 | Train Loss: 0.1267036 Vali Loss: 0.2674589 Test Loss: 0.3226898
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 20 cost time: 0.9100427627563477
Epoch: 20, Steps: 64 | Train Loss: 0.1265257 Vali Loss: 0.2618291 Test Loss: 0.3217927
Validation loss decreased (0.265120 --> 0.261829).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 21 cost time: 0.8964815139770508
Epoch: 21, Steps: 64 | Train Loss: 0.1244364 Vali Loss: 0.2632799 Test Loss: 0.3189637
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 22 cost time: 0.9119997024536133
Epoch: 22, Steps: 64 | Train Loss: 0.1240455 Vali Loss: 0.2623784 Test Loss: 0.3184416
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 23 cost time: 0.9146158695220947
Epoch: 23, Steps: 64 | Train Loss: 0.1236280 Vali Loss: 0.2628713 Test Loss: 0.3186981
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 24 cost time: 0.9144318103790283
Epoch: 24, Steps: 64 | Train Loss: 0.1228317 Vali Loss: 0.2585981 Test Loss: 0.3167030
Validation loss decreased (0.261829 --> 0.258598).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 25 cost time: 0.9034790992736816
Epoch: 25, Steps: 64 | Train Loss: 0.1229232 Vali Loss: 0.2603624 Test Loss: 0.3160886
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 26 cost time: 0.9053516387939453
Epoch: 26, Steps: 64 | Train Loss: 0.1225264 Vali Loss: 0.2549721 Test Loss: 0.3166547
Validation loss decreased (0.258598 --> 0.254972).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 27 cost time: 0.9017221927642822
Epoch: 27, Steps: 64 | Train Loss: 0.1212776 Vali Loss: 0.2547307 Test Loss: 0.3143137
Validation loss decreased (0.254972 --> 0.254731).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 28 cost time: 0.9040000438690186
Epoch: 28, Steps: 64 | Train Loss: 0.1214451 Vali Loss: 0.2563162 Test Loss: 0.3149590
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 29 cost time: 0.9170100688934326
Epoch: 29, Steps: 64 | Train Loss: 0.1203633 Vali Loss: 0.2532726 Test Loss: 0.3160688
Validation loss decreased (0.254731 --> 0.253273).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 30 cost time: 0.9113807678222656
Epoch: 30, Steps: 64 | Train Loss: 0.1207618 Vali Loss: 0.2549674 Test Loss: 0.3157426
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 31 cost time: 0.9254510402679443
Epoch: 31, Steps: 64 | Train Loss: 0.1203376 Vali Loss: 0.2572548 Test Loss: 0.3146950
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 32 cost time: 0.994575023651123
Epoch: 32, Steps: 64 | Train Loss: 0.1192608 Vali Loss: 0.2580263 Test Loss: 0.3148724
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 33 cost time: 0.9944539070129395
Epoch: 33, Steps: 64 | Train Loss: 0.1192349 Vali Loss: 0.2528028 Test Loss: 0.3146134
Validation loss decreased (0.253273 --> 0.252803).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 34 cost time: 0.9830124378204346
Epoch: 34, Steps: 64 | Train Loss: 0.1189630 Vali Loss: 0.2603653 Test Loss: 0.3167498
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 35 cost time: 0.9187226295471191
Epoch: 35, Steps: 64 | Train Loss: 0.1183960 Vali Loss: 0.2548634 Test Loss: 0.3151048
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 36 cost time: 0.909651517868042
Epoch: 36, Steps: 64 | Train Loss: 0.1184742 Vali Loss: 0.2556466 Test Loss: 0.3136108
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 37 cost time: 0.9046261310577393
Epoch: 37, Steps: 64 | Train Loss: 0.1183845 Vali Loss: 0.2547072 Test Loss: 0.3146717
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 38 cost time: 0.9159502983093262
Epoch: 38, Steps: 64 | Train Loss: 0.1178412 Vali Loss: 0.2551268 Test Loss: 0.3156509
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 39 cost time: 0.9064326286315918
Epoch: 39, Steps: 64 | Train Loss: 0.1183604 Vali Loss: 0.2542583 Test Loss: 0.3150058
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 40 cost time: 0.9054055213928223
Epoch: 40, Steps: 64 | Train Loss: 0.1177849 Vali Loss: 0.2570831 Test Loss: 0.3150761
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 41 cost time: 0.9113328456878662
Epoch: 41, Steps: 64 | Train Loss: 0.1180854 Vali Loss: 0.2556690 Test Loss: 0.3143914
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 42 cost time: 0.9078085422515869
Epoch: 42, Steps: 64 | Train Loss: 0.1178040 Vali Loss: 0.2542700 Test Loss: 0.3138661
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 43 cost time: 0.9009997844696045
Epoch: 43, Steps: 64 | Train Loss: 0.1177782 Vali Loss: 0.2539766 Test Loss: 0.3146524
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 44 cost time: 0.9033832550048828
Epoch: 44, Steps: 64 | Train Loss: 0.1179244 Vali Loss: 0.2535430 Test Loss: 0.3138704
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 45 cost time: 0.9033966064453125
Epoch: 45, Steps: 64 | Train Loss: 0.1173637 Vali Loss: 0.2556170 Test Loss: 0.3152613
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 46 cost time: 0.9014208316802979
Epoch: 46, Steps: 64 | Train Loss: 0.1178156 Vali Loss: 0.2541203 Test Loss: 0.3127624
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 47 cost time: 0.9049515724182129
Epoch: 47, Steps: 64 | Train Loss: 0.1179108 Vali Loss: 0.2543526 Test Loss: 0.3131129
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 48 cost time: 0.9078049659729004
Epoch: 48, Steps: 64 | Train Loss: 0.1169684 Vali Loss: 0.2539966 Test Loss: 0.3132927
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 49 cost time: 0.9078214168548584
Epoch: 49, Steps: 64 | Train Loss: 0.1176110 Vali Loss: 0.2554533 Test Loss: 0.3146074
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 50 cost time: 0.9011971950531006
Epoch: 50, Steps: 64 | Train Loss: 0.1177387 Vali Loss: 0.2546443 Test Loss: 0.3142366
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 51 cost time: 0.9029805660247803
Epoch: 51, Steps: 64 | Train Loss: 0.1175247 Vali Loss: 0.2543515 Test Loss: 0.3136704
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 52 cost time: 0.9054551124572754
Epoch: 52, Steps: 64 | Train Loss: 0.1171306 Vali Loss: 0.2546018 Test Loss: 0.3132206
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 53 cost time: 0.911677360534668
Epoch: 53, Steps: 64 | Train Loss: 0.1172023 Vali Loss: 0.2557597 Test Loss: 0.3148023
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 54 cost time: 0.9081616401672363
Epoch: 54, Steps: 64 | Train Loss: 0.1174673 Vali Loss: 0.2515993 Test Loss: 0.3137716
Validation loss decreased (0.252803 --> 0.251599).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 55 cost time: 0.9070000648498535
Epoch: 55, Steps: 64 | Train Loss: 0.1175805 Vali Loss: 0.2524597 Test Loss: 0.3134125
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 56 cost time: 0.9080178737640381
Epoch: 56, Steps: 64 | Train Loss: 0.1178472 Vali Loss: 0.2513356 Test Loss: 0.3147606
Validation loss decreased (0.251599 --> 0.251336).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 57 cost time: 0.9111449718475342
Epoch: 57, Steps: 64 | Train Loss: 0.1175652 Vali Loss: 0.2519530 Test Loss: 0.3132924
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 58 cost time: 0.9102087020874023
Epoch: 58, Steps: 64 | Train Loss: 0.1175528 Vali Loss: 0.2536814 Test Loss: 0.3141541
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 59 cost time: 0.907421350479126
Epoch: 59, Steps: 64 | Train Loss: 0.1168561 Vali Loss: 0.2522548 Test Loss: 0.3135850
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 60 cost time: 0.9067394733428955
Epoch: 60, Steps: 64 | Train Loss: 0.1168890 Vali Loss: 0.2564737 Test Loss: 0.3138832
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.31476056575775146, mae:0.38325202465057373, rse:0.2574915289878845
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.04805755615234375 GB
Epoch: 1 cost time: 2.3381459712982178
Epoch: 1, Steps: 64 | Train Loss: 0.9443603 Vali Loss: 2.8500867 Test Loss: 4.9874830
Validation loss decreased (inf --> 2.850087).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 2 cost time: 0.9373633861541748
Epoch: 2, Steps: 64 | Train Loss: 0.7372770 Vali Loss: 1.7006798 Test Loss: 2.8489914
Validation loss decreased (2.850087 --> 1.700680).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 3 cost time: 0.9276137351989746
Epoch: 3, Steps: 64 | Train Loss: 0.4492930 Vali Loss: 1.0429013 Test Loss: 1.6259530
Validation loss decreased (1.700680 --> 1.042901).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 4 cost time: 0.9413771629333496
Epoch: 4, Steps: 64 | Train Loss: 0.2833906 Vali Loss: 0.6715266 Test Loss: 0.9552497
Validation loss decreased (1.042901 --> 0.671527).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 5 cost time: 0.9379935264587402
Epoch: 5, Steps: 64 | Train Loss: 0.1967236 Vali Loss: 0.4801890 Test Loss: 0.6166668
Validation loss decreased (0.671527 --> 0.480189).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 6 cost time: 0.9385073184967041
Epoch: 6, Steps: 64 | Train Loss: 0.1562134 Vali Loss: 0.3786383 Test Loss: 0.4530222
Validation loss decreased (0.480189 --> 0.378638).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 7 cost time: 0.9300000667572021
Epoch: 7, Steps: 64 | Train Loss: 0.1372189 Vali Loss: 0.3358718 Test Loss: 0.3826740
Validation loss decreased (0.378638 --> 0.335872).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 8 cost time: 0.9287595748901367
Epoch: 8, Steps: 64 | Train Loss: 0.1280606 Vali Loss: 0.3121752 Test Loss: 0.3499319
Validation loss decreased (0.335872 --> 0.312175).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 9 cost time: 0.928999662399292
Epoch: 9, Steps: 64 | Train Loss: 0.1232466 Vali Loss: 0.2930222 Test Loss: 0.3343374
Validation loss decreased (0.312175 --> 0.293022).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 10 cost time: 0.9439997673034668
Epoch: 10, Steps: 64 | Train Loss: 0.1198803 Vali Loss: 0.2850601 Test Loss: 0.3295222
Validation loss decreased (0.293022 --> 0.285060).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 11 cost time: 0.9361579418182373
Epoch: 11, Steps: 64 | Train Loss: 0.1161903 Vali Loss: 0.2805251 Test Loss: 0.3260719
Validation loss decreased (0.285060 --> 0.280525).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 12 cost time: 0.939443826675415
Epoch: 12, Steps: 64 | Train Loss: 0.1145220 Vali Loss: 0.2716979 Test Loss: 0.3208534
Validation loss decreased (0.280525 --> 0.271698).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 13 cost time: 0.9474349021911621
Epoch: 13, Steps: 64 | Train Loss: 0.1124308 Vali Loss: 0.2673357 Test Loss: 0.3197310
Validation loss decreased (0.271698 --> 0.267336).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 14 cost time: 0.9333877563476562
Epoch: 14, Steps: 64 | Train Loss: 0.1116747 Vali Loss: 0.2709741 Test Loss: 0.3188808
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 15 cost time: 0.9343631267547607
Epoch: 15, Steps: 64 | Train Loss: 0.1096187 Vali Loss: 0.2674032 Test Loss: 0.3189918
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 16 cost time: 0.9287261962890625
Epoch: 16, Steps: 64 | Train Loss: 0.1085830 Vali Loss: 0.2659297 Test Loss: 0.3208609
Validation loss decreased (0.267336 --> 0.265930).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 17 cost time: 0.9399979114532471
Epoch: 17, Steps: 64 | Train Loss: 0.1082587 Vali Loss: 0.2670138 Test Loss: 0.3171663
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 18 cost time: 0.9326133728027344
Epoch: 18, Steps: 64 | Train Loss: 0.1071104 Vali Loss: 0.2634374 Test Loss: 0.3187542
Validation loss decreased (0.265930 --> 0.263437).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 19 cost time: 0.9392647743225098
Epoch: 19, Steps: 64 | Train Loss: 0.1065973 Vali Loss: 0.2649171 Test Loss: 0.3207375
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 20 cost time: 0.9384481906890869
Epoch: 20, Steps: 64 | Train Loss: 0.1054661 Vali Loss: 0.2606742 Test Loss: 0.3193773
Validation loss decreased (0.263437 --> 0.260674).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 21 cost time: 0.8943305015563965
Epoch: 21, Steps: 64 | Train Loss: 0.1047604 Vali Loss: 0.2605847 Test Loss: 0.3184784
Validation loss decreased (0.260674 --> 0.260585).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 22 cost time: 0.9274241924285889
Epoch: 22, Steps: 64 | Train Loss: 0.1051375 Vali Loss: 0.2633848 Test Loss: 0.3192545
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 23 cost time: 0.9308104515075684
Epoch: 23, Steps: 64 | Train Loss: 0.1041261 Vali Loss: 0.2597722 Test Loss: 0.3188562
Validation loss decreased (0.260585 --> 0.259772).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 24 cost time: 0.9440455436706543
Epoch: 24, Steps: 64 | Train Loss: 0.1035885 Vali Loss: 0.2587565 Test Loss: 0.3193773
Validation loss decreased (0.259772 --> 0.258757).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 25 cost time: 0.9350008964538574
Epoch: 25, Steps: 64 | Train Loss: 0.1034844 Vali Loss: 0.2571427 Test Loss: 0.3175016
Validation loss decreased (0.258757 --> 0.257143).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 26 cost time: 0.9365966320037842
Epoch: 26, Steps: 64 | Train Loss: 0.1032656 Vali Loss: 0.2592513 Test Loss: 0.3191540
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 27 cost time: 0.9313316345214844
Epoch: 27, Steps: 64 | Train Loss: 0.1031945 Vali Loss: 0.2583409 Test Loss: 0.3180476
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 28 cost time: 0.9493350982666016
Epoch: 28, Steps: 64 | Train Loss: 0.1025876 Vali Loss: 0.2594794 Test Loss: 0.3211460
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 29 cost time: 0.9453849792480469
Epoch: 29, Steps: 64 | Train Loss: 0.1026745 Vali Loss: 0.2605387 Test Loss: 0.3198168
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 30 cost time: 0.9483699798583984
Epoch: 30, Steps: 64 | Train Loss: 0.1024464 Vali Loss: 0.2573238 Test Loss: 0.3200750
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 31 cost time: 0.9479105472564697
Epoch: 31, Steps: 64 | Train Loss: 0.1021256 Vali Loss: 0.2571584 Test Loss: 0.3194210
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 32 cost time: 0.9404301643371582
Epoch: 32, Steps: 64 | Train Loss: 0.1024790 Vali Loss: 0.2594619 Test Loss: 0.3185221
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 33 cost time: 0.9410011768341064
Epoch: 33, Steps: 64 | Train Loss: 0.1014302 Vali Loss: 0.2595262 Test Loss: 0.3200971
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 34 cost time: 0.9506027698516846
Epoch: 34, Steps: 64 | Train Loss: 0.1018495 Vali Loss: 0.2582505 Test Loss: 0.3212404
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 35 cost time: 0.9421389102935791
Epoch: 35, Steps: 64 | Train Loss: 0.1012144 Vali Loss: 0.2557259 Test Loss: 0.3208869
Validation loss decreased (0.257143 --> 0.255726).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 36 cost time: 0.9518289566040039
Epoch: 36, Steps: 64 | Train Loss: 0.1016843 Vali Loss: 0.2570361 Test Loss: 0.3218167
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 37 cost time: 0.9593596458435059
Epoch: 37, Steps: 64 | Train Loss: 0.1011986 Vali Loss: 0.2575615 Test Loss: 0.3207215
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 38 cost time: 0.9463465213775635
Epoch: 38, Steps: 64 | Train Loss: 0.1013853 Vali Loss: 0.2545967 Test Loss: 0.3192567
Validation loss decreased (0.255726 --> 0.254597).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 39 cost time: 0.946897029876709
Epoch: 39, Steps: 64 | Train Loss: 0.1004524 Vali Loss: 0.2558531 Test Loss: 0.3205660
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 40 cost time: 0.9459793567657471
Epoch: 40, Steps: 64 | Train Loss: 0.1006074 Vali Loss: 0.2566634 Test Loss: 0.3205047
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 41 cost time: 0.9426462650299072
Epoch: 41, Steps: 64 | Train Loss: 0.1011908 Vali Loss: 0.2562656 Test Loss: 0.3206858
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 42 cost time: 0.9296407699584961
Epoch: 42, Steps: 64 | Train Loss: 0.1009278 Vali Loss: 0.2570118 Test Loss: 0.3204144
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 43 cost time: 0.9334349632263184
Epoch: 43, Steps: 64 | Train Loss: 0.1007150 Vali Loss: 0.2587205 Test Loss: 0.3215871
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 44 cost time: 0.9413607120513916
Epoch: 44, Steps: 64 | Train Loss: 0.1010897 Vali Loss: 0.2568049 Test Loss: 0.3196326
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 45 cost time: 0.9297597408294678
Epoch: 45, Steps: 64 | Train Loss: 0.1004979 Vali Loss: 0.2583502 Test Loss: 0.3210472
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 46 cost time: 0.9369750022888184
Epoch: 46, Steps: 64 | Train Loss: 0.1003331 Vali Loss: 0.2582447 Test Loss: 0.3209418
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 47 cost time: 0.9347259998321533
Epoch: 47, Steps: 64 | Train Loss: 0.1010472 Vali Loss: 0.2553341 Test Loss: 0.3198733
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 48 cost time: 0.9304685592651367
Epoch: 48, Steps: 64 | Train Loss: 0.1003273 Vali Loss: 0.2584035 Test Loss: 0.3199191
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 49 cost time: 1.0100092887878418
Epoch: 49, Steps: 64 | Train Loss: 0.1001812 Vali Loss: 0.2572531 Test Loss: 0.3217697
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 50 cost time: 0.9394125938415527
Epoch: 50, Steps: 64 | Train Loss: 0.1007459 Vali Loss: 0.2540858 Test Loss: 0.3199277
Validation loss decreased (0.254597 --> 0.254086).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 51 cost time: 0.9447472095489502
Epoch: 51, Steps: 64 | Train Loss: 0.0999153 Vali Loss: 0.2541470 Test Loss: 0.3197837
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 52 cost time: 0.9272341728210449
Epoch: 52, Steps: 64 | Train Loss: 0.1003230 Vali Loss: 0.2584704 Test Loss: 0.3198771
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 53 cost time: 0.9293699264526367
Epoch: 53, Steps: 64 | Train Loss: 0.1005409 Vali Loss: 0.2531580 Test Loss: 0.3203562
Validation loss decreased (0.254086 --> 0.253158).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 54 cost time: 0.9323639869689941
Epoch: 54, Steps: 64 | Train Loss: 0.1006866 Vali Loss: 0.2564416 Test Loss: 0.3209395
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 55 cost time: 0.9367661476135254
Epoch: 55, Steps: 64 | Train Loss: 0.1006547 Vali Loss: 0.2531423 Test Loss: 0.3200007
Validation loss decreased (0.253158 --> 0.253142).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 56 cost time: 0.9370002746582031
Epoch: 56, Steps: 64 | Train Loss: 0.1001067 Vali Loss: 0.2590649 Test Loss: 0.3204440
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 57 cost time: 0.9396243095397949
Epoch: 57, Steps: 64 | Train Loss: 0.1005840 Vali Loss: 0.2562326 Test Loss: 0.3200330
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 58 cost time: 0.9463505744934082
Epoch: 58, Steps: 64 | Train Loss: 0.1002743 Vali Loss: 0.2582573 Test Loss: 0.3214291
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 59 cost time: 0.9256701469421387
Epoch: 59, Steps: 64 | Train Loss: 0.1003686 Vali Loss: 0.2543607 Test Loss: 0.3201958
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 60 cost time: 0.9294846057891846
Epoch: 60, Steps: 64 | Train Loss: 0.1004740 Vali Loss: 0.2569955 Test Loss: 0.3209121
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.32000061869621277, mae:0.3925592005252838, rse:0.25962600111961365
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.04862165451049805 GB
Epoch: 1 cost time: 2.297379493713379
Epoch: 1, Steps: 64 | Train Loss: 0.9005570 Vali Loss: 2.7647808 Test Loss: 4.9491391
Validation loss decreased (inf --> 2.764781).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 2 cost time: 0.8751754760742188
Epoch: 2, Steps: 64 | Train Loss: 0.7240752 Vali Loss: 1.6792437 Test Loss: 2.8769295
Validation loss decreased (2.764781 --> 1.679244).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 3 cost time: 0.9025654792785645
Epoch: 3, Steps: 64 | Train Loss: 0.4241312 Vali Loss: 0.9006578 Test Loss: 1.3851858
Validation loss decreased (1.679244 --> 0.900658).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 4 cost time: 0.8974506855010986
Epoch: 4, Steps: 64 | Train Loss: 0.2306301 Vali Loss: 0.4853616 Test Loss: 0.6166797
Validation loss decreased (0.900658 --> 0.485362).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 5 cost time: 0.8984634876251221
Epoch: 5, Steps: 64 | Train Loss: 0.1496542 Vali Loss: 0.3433569 Test Loss: 0.3744270
Validation loss decreased (0.485362 --> 0.343357).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 6 cost time: 0.8904037475585938
Epoch: 6, Steps: 64 | Train Loss: 0.1268957 Vali Loss: 0.3009785 Test Loss: 0.3255849
Validation loss decreased (0.343357 --> 0.300979).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 7 cost time: 0.8933801651000977
Epoch: 7, Steps: 64 | Train Loss: 0.1194963 Vali Loss: 0.2881765 Test Loss: 0.3147493
Validation loss decreased (0.300979 --> 0.288176).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 8 cost time: 0.8887515068054199
Epoch: 8, Steps: 64 | Train Loss: 0.1154963 Vali Loss: 0.2815115 Test Loss: 0.3122602
Validation loss decreased (0.288176 --> 0.281512).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 9 cost time: 0.8819997310638428
Epoch: 9, Steps: 64 | Train Loss: 0.1117786 Vali Loss: 0.2776744 Test Loss: 0.3105946
Validation loss decreased (0.281512 --> 0.277674).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 10 cost time: 0.8916175365447998
Epoch: 10, Steps: 64 | Train Loss: 0.1094478 Vali Loss: 0.2675712 Test Loss: 0.3112141
Validation loss decreased (0.277674 --> 0.267571).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 11 cost time: 0.8883576393127441
Epoch: 11, Steps: 64 | Train Loss: 0.1077920 Vali Loss: 0.2689131 Test Loss: 0.3133399
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 12 cost time: 0.9134678840637207
Epoch: 12, Steps: 64 | Train Loss: 0.1057972 Vali Loss: 0.2672221 Test Loss: 0.3149112
Validation loss decreased (0.267571 --> 0.267222).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 13 cost time: 0.8922061920166016
Epoch: 13, Steps: 64 | Train Loss: 0.1045263 Vali Loss: 0.2637201 Test Loss: 0.3145569
Validation loss decreased (0.267222 --> 0.263720).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 14 cost time: 0.894812822341919
Epoch: 14, Steps: 64 | Train Loss: 0.1033838 Vali Loss: 0.2633360 Test Loss: 0.3168746
Validation loss decreased (0.263720 --> 0.263336).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 15 cost time: 0.8890001773834229
Epoch: 15, Steps: 64 | Train Loss: 0.1020826 Vali Loss: 0.2587540 Test Loss: 0.3160101
Validation loss decreased (0.263336 --> 0.258754).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 16 cost time: 0.8995206356048584
Epoch: 16, Steps: 64 | Train Loss: 0.1015042 Vali Loss: 0.2611760 Test Loss: 0.3172364
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 17 cost time: 0.8917112350463867
Epoch: 17, Steps: 64 | Train Loss: 0.1007637 Vali Loss: 0.2589022 Test Loss: 0.3175345
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 18 cost time: 0.8883960247039795
Epoch: 18, Steps: 64 | Train Loss: 0.1000819 Vali Loss: 0.2571474 Test Loss: 0.3179356
Validation loss decreased (0.258754 --> 0.257147).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 19 cost time: 0.8994045257568359
Epoch: 19, Steps: 64 | Train Loss: 0.0993815 Vali Loss: 0.2567691 Test Loss: 0.3197649
Validation loss decreased (0.257147 --> 0.256769).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 20 cost time: 0.8937995433807373
Epoch: 20, Steps: 64 | Train Loss: 0.0995252 Vali Loss: 0.2581645 Test Loss: 0.3202416
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 21 cost time: 0.8954401016235352
Epoch: 21, Steps: 64 | Train Loss: 0.0989343 Vali Loss: 0.2566741 Test Loss: 0.3201540
Validation loss decreased (0.256769 --> 0.256674).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 22 cost time: 0.8896234035491943
Epoch: 22, Steps: 64 | Train Loss: 0.0981578 Vali Loss: 0.2585243 Test Loss: 0.3213756
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 23 cost time: 0.9043717384338379
Epoch: 23, Steps: 64 | Train Loss: 0.0980227 Vali Loss: 0.2534398 Test Loss: 0.3209153
Validation loss decreased (0.256674 --> 0.253440).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 24 cost time: 0.8915200233459473
Epoch: 24, Steps: 64 | Train Loss: 0.0978477 Vali Loss: 0.2554449 Test Loss: 0.3210129
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 25 cost time: 0.8893940448760986
Epoch: 25, Steps: 64 | Train Loss: 0.0971630 Vali Loss: 0.2538610 Test Loss: 0.3225935
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 26 cost time: 0.8914201259613037
Epoch: 26, Steps: 64 | Train Loss: 0.0969966 Vali Loss: 0.2550880 Test Loss: 0.3236519
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 27 cost time: 0.8635151386260986
Epoch: 27, Steps: 64 | Train Loss: 0.0972749 Vali Loss: 0.2549977 Test Loss: 0.3216649
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 28 cost time: 0.8881220817565918
Epoch: 28, Steps: 64 | Train Loss: 0.0963037 Vali Loss: 0.2565448 Test Loss: 0.3226457
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 29 cost time: 0.8943448066711426
Epoch: 29, Steps: 64 | Train Loss: 0.0966823 Vali Loss: 0.2547186 Test Loss: 0.3243060
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 30 cost time: 0.9019122123718262
Epoch: 30, Steps: 64 | Train Loss: 0.0960834 Vali Loss: 0.2539759 Test Loss: 0.3236921
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 31 cost time: 0.8888871669769287
Epoch: 31, Steps: 64 | Train Loss: 0.0962238 Vali Loss: 0.2552058 Test Loss: 0.3243113
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 32 cost time: 0.892998218536377
Epoch: 32, Steps: 64 | Train Loss: 0.0965338 Vali Loss: 0.2535785 Test Loss: 0.3240245
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 33 cost time: 0.8906188011169434
Epoch: 33, Steps: 64 | Train Loss: 0.0964580 Vali Loss: 0.2530550 Test Loss: 0.3225202
Validation loss decreased (0.253440 --> 0.253055).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 34 cost time: 0.9019711017608643
Epoch: 34, Steps: 64 | Train Loss: 0.0958559 Vali Loss: 0.2523226 Test Loss: 0.3247720
Validation loss decreased (0.253055 --> 0.252323).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 35 cost time: 0.8893842697143555
Epoch: 35, Steps: 64 | Train Loss: 0.0960225 Vali Loss: 0.2557673 Test Loss: 0.3258606
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 36 cost time: 0.893376350402832
Epoch: 36, Steps: 64 | Train Loss: 0.0956294 Vali Loss: 0.2513500 Test Loss: 0.3236541
Validation loss decreased (0.252323 --> 0.251350).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 37 cost time: 0.8867559432983398
Epoch: 37, Steps: 64 | Train Loss: 0.0957265 Vali Loss: 0.2515098 Test Loss: 0.3241898
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 38 cost time: 0.8914330005645752
Epoch: 38, Steps: 64 | Train Loss: 0.0954364 Vali Loss: 0.2543341 Test Loss: 0.3243209
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 39 cost time: 0.8996264934539795
Epoch: 39, Steps: 64 | Train Loss: 0.0957234 Vali Loss: 0.2520154 Test Loss: 0.3257549
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 40 cost time: 0.8934664726257324
Epoch: 40, Steps: 64 | Train Loss: 0.0958196 Vali Loss: 0.2523122 Test Loss: 0.3248004
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 41 cost time: 0.9043557643890381
Epoch: 41, Steps: 64 | Train Loss: 0.0952485 Vali Loss: 0.2561209 Test Loss: 0.3261575
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 42 cost time: 0.8873922824859619
Epoch: 42, Steps: 64 | Train Loss: 0.0953132 Vali Loss: 0.2541186 Test Loss: 0.3252288
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 43 cost time: 0.8873052597045898
Epoch: 43, Steps: 64 | Train Loss: 0.0947546 Vali Loss: 0.2516983 Test Loss: 0.3274076
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 44 cost time: 0.8859982490539551
Epoch: 44, Steps: 64 | Train Loss: 0.0952003 Vali Loss: 0.2519701 Test Loss: 0.3242266
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 45 cost time: 0.8526463508605957
Epoch: 45, Steps: 64 | Train Loss: 0.0955834 Vali Loss: 0.2560161 Test Loss: 0.3257726
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 46 cost time: 0.8849742412567139
Epoch: 46, Steps: 64 | Train Loss: 0.0948511 Vali Loss: 0.2512145 Test Loss: 0.3251040
Validation loss decreased (0.251350 --> 0.251214).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 47 cost time: 0.889432430267334
Epoch: 47, Steps: 64 | Train Loss: 0.0953926 Vali Loss: 0.2548471 Test Loss: 0.3251875
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 48 cost time: 0.9064147472381592
Epoch: 48, Steps: 64 | Train Loss: 0.0953864 Vali Loss: 0.2537413 Test Loss: 0.3236726
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 49 cost time: 0.8930001258850098
Epoch: 49, Steps: 64 | Train Loss: 0.0953311 Vali Loss: 0.2525742 Test Loss: 0.3245423
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 50 cost time: 0.8946542739868164
Epoch: 50, Steps: 64 | Train Loss: 0.0945303 Vali Loss: 0.2537209 Test Loss: 0.3269495
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 51 cost time: 0.898404598236084
Epoch: 51, Steps: 64 | Train Loss: 0.0947976 Vali Loss: 0.2507350 Test Loss: 0.3252470
Validation loss decreased (0.251214 --> 0.250735).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 52 cost time: 0.8854563236236572
Epoch: 52, Steps: 64 | Train Loss: 0.0948037 Vali Loss: 0.2515171 Test Loss: 0.3248446
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 53 cost time: 0.8823444843292236
Epoch: 53, Steps: 64 | Train Loss: 0.0951972 Vali Loss: 0.2528031 Test Loss: 0.3244013
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 54 cost time: 0.8847997188568115
Epoch: 54, Steps: 64 | Train Loss: 0.0950429 Vali Loss: 0.2511387 Test Loss: 0.3247061
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 55 cost time: 0.8866298198699951
Epoch: 55, Steps: 64 | Train Loss: 0.0952714 Vali Loss: 0.2543061 Test Loss: 0.3253745
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 56 cost time: 0.9068772792816162
Epoch: 56, Steps: 64 | Train Loss: 0.0949421 Vali Loss: 0.2524220 Test Loss: 0.3253750
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 57 cost time: 0.8974862098693848
Epoch: 57, Steps: 64 | Train Loss: 0.0951640 Vali Loss: 0.2524618 Test Loss: 0.3258072
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 58 cost time: 0.8906502723693848
Epoch: 58, Steps: 64 | Train Loss: 0.0949011 Vali Loss: 0.2511120 Test Loss: 0.3253639
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 59 cost time: 0.909541130065918
Epoch: 59, Steps: 64 | Train Loss: 0.0948801 Vali Loss: 0.2560188 Test Loss: 0.3264084
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 60 cost time: 0.8909811973571777
Epoch: 60, Steps: 64 | Train Loss: 0.0949798 Vali Loss: 0.2550784 Test Loss: 0.3248069
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.3252470791339874, mae:0.39950257539749146, rse:0.2617456614971161
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04751729965209961 GB
Epoch: 1 cost time: 2.260709285736084
Epoch: 1, Steps: 64 | Train Loss: 0.9071916 Vali Loss: 2.3526828 Test Loss: 4.1135406
Validation loss decreased (inf --> 2.352683).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 2 cost time: 1.0094623565673828
Epoch: 2, Steps: 64 | Train Loss: 0.6312041 Vali Loss: 1.1647069 Test Loss: 1.8783798
Validation loss decreased (2.352683 --> 1.164707).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 3 cost time: 0.9336228370666504
Epoch: 3, Steps: 64 | Train Loss: 0.4145196 Vali Loss: 0.9137842 Test Loss: 1.4305131
Validation loss decreased (1.164707 --> 0.913784).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 4 cost time: 0.9123761653900146
Epoch: 4, Steps: 64 | Train Loss: 0.3260729 Vali Loss: 0.7501038 Test Loss: 1.1390413
Validation loss decreased (0.913784 --> 0.750104).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 5 cost time: 0.9183783531188965
Epoch: 5, Steps: 64 | Train Loss: 0.2671382 Vali Loss: 0.6178206 Test Loss: 0.9062629
Validation loss decreased (0.750104 --> 0.617821).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 6 cost time: 0.910815954208374
Epoch: 6, Steps: 64 | Train Loss: 0.2279999 Vali Loss: 0.5347987 Test Loss: 0.7565177
Validation loss decreased (0.617821 --> 0.534799).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 7 cost time: 0.9111487865447998
Epoch: 7, Steps: 64 | Train Loss: 0.1982200 Vali Loss: 0.4608032 Test Loss: 0.6426766
Validation loss decreased (0.534799 --> 0.460803).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 8 cost time: 0.9179990291595459
Epoch: 8, Steps: 64 | Train Loss: 0.1789416 Vali Loss: 0.4126406 Test Loss: 0.5645650
Validation loss decreased (0.460803 --> 0.412641).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 9 cost time: 0.9079978466033936
Epoch: 9, Steps: 64 | Train Loss: 0.1654835 Vali Loss: 0.3778253 Test Loss: 0.5059417
Validation loss decreased (0.412641 --> 0.377825).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 10 cost time: 0.9121842384338379
Epoch: 10, Steps: 64 | Train Loss: 0.1543253 Vali Loss: 0.3489936 Test Loss: 0.4591957
Validation loss decreased (0.377825 --> 0.348994).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 11 cost time: 0.9193787574768066
Epoch: 11, Steps: 64 | Train Loss: 0.1460264 Vali Loss: 0.3274193 Test Loss: 0.4308153
Validation loss decreased (0.348994 --> 0.327419).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 12 cost time: 0.9164772033691406
Epoch: 12, Steps: 64 | Train Loss: 0.1398077 Vali Loss: 0.3169577 Test Loss: 0.4064273
Validation loss decreased (0.327419 --> 0.316958).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 13 cost time: 0.9303789138793945
Epoch: 13, Steps: 64 | Train Loss: 0.1354018 Vali Loss: 0.3009343 Test Loss: 0.3889268
Validation loss decreased (0.316958 --> 0.300934).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 14 cost time: 0.9157421588897705
Epoch: 14, Steps: 64 | Train Loss: 0.1312437 Vali Loss: 0.2881818 Test Loss: 0.3708602
Validation loss decreased (0.300934 --> 0.288182).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 15 cost time: 0.9077756404876709
Epoch: 15, Steps: 64 | Train Loss: 0.1281001 Vali Loss: 0.2796904 Test Loss: 0.3582815
Validation loss decreased (0.288182 --> 0.279690).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 16 cost time: 0.9100019931793213
Epoch: 16, Steps: 64 | Train Loss: 0.1258434 Vali Loss: 0.2744304 Test Loss: 0.3525725
Validation loss decreased (0.279690 --> 0.274430).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 17 cost time: 0.9203729629516602
Epoch: 17, Steps: 64 | Train Loss: 0.1240025 Vali Loss: 0.2673019 Test Loss: 0.3446732
Validation loss decreased (0.274430 --> 0.267302).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 18 cost time: 0.9124431610107422
Epoch: 18, Steps: 64 | Train Loss: 0.1213335 Vali Loss: 0.2615798 Test Loss: 0.3358234
Validation loss decreased (0.267302 --> 0.261580).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 19 cost time: 0.9173367023468018
Epoch: 19, Steps: 64 | Train Loss: 0.1197841 Vali Loss: 0.2619325 Test Loss: 0.3338045
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 20 cost time: 0.9309203624725342
Epoch: 20, Steps: 64 | Train Loss: 0.1186253 Vali Loss: 0.2610734 Test Loss: 0.3309254
Validation loss decreased (0.261580 --> 0.261073).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 21 cost time: 0.9187920093536377
Epoch: 21, Steps: 64 | Train Loss: 0.1176908 Vali Loss: 0.2542976 Test Loss: 0.3218777
Validation loss decreased (0.261073 --> 0.254298).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 22 cost time: 0.9140000343322754
Epoch: 22, Steps: 64 | Train Loss: 0.1166137 Vali Loss: 0.2528603 Test Loss: 0.3182744
Validation loss decreased (0.254298 --> 0.252860).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 23 cost time: 0.9140002727508545
Epoch: 23, Steps: 64 | Train Loss: 0.1164995 Vali Loss: 0.2486903 Test Loss: 0.3161038
Validation loss decreased (0.252860 --> 0.248690).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 24 cost time: 0.9140493869781494
Epoch: 24, Steps: 64 | Train Loss: 0.1157895 Vali Loss: 0.2495329 Test Loss: 0.3139428
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 25 cost time: 0.9063279628753662
Epoch: 25, Steps: 64 | Train Loss: 0.1144464 Vali Loss: 0.2453542 Test Loss: 0.3109081
Validation loss decreased (0.248690 --> 0.245354).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 26 cost time: 0.9143908023834229
Epoch: 26, Steps: 64 | Train Loss: 0.1145940 Vali Loss: 0.2432541 Test Loss: 0.3115019
Validation loss decreased (0.245354 --> 0.243254).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 27 cost time: 0.9054632186889648
Epoch: 27, Steps: 64 | Train Loss: 0.1139789 Vali Loss: 0.2450451 Test Loss: 0.3091969
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 28 cost time: 0.9913632869720459
Epoch: 28, Steps: 64 | Train Loss: 0.1132357 Vali Loss: 0.2450713 Test Loss: 0.3104066
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 29 cost time: 0.9187288284301758
Epoch: 29, Steps: 64 | Train Loss: 0.1125618 Vali Loss: 0.2426893 Test Loss: 0.3082578
Validation loss decreased (0.243254 --> 0.242689).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 30 cost time: 0.9139997959136963
Epoch: 30, Steps: 64 | Train Loss: 0.1127025 Vali Loss: 0.2437747 Test Loss: 0.3057648
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 31 cost time: 0.9176232814788818
Epoch: 31, Steps: 64 | Train Loss: 0.1125995 Vali Loss: 0.2432140 Test Loss: 0.3088986
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 32 cost time: 0.914320707321167
Epoch: 32, Steps: 64 | Train Loss: 0.1118340 Vali Loss: 0.2392443 Test Loss: 0.3044691
Validation loss decreased (0.242689 --> 0.239244).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 33 cost time: 0.9119677543640137
Epoch: 33, Steps: 64 | Train Loss: 0.1122872 Vali Loss: 0.2408210 Test Loss: 0.3051783
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 34 cost time: 0.9255499839782715
Epoch: 34, Steps: 64 | Train Loss: 0.1115342 Vali Loss: 0.2400359 Test Loss: 0.3047617
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 35 cost time: 0.9117765426635742
Epoch: 35, Steps: 64 | Train Loss: 0.1107475 Vali Loss: 0.2407987 Test Loss: 0.3068049
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 36 cost time: 0.9129998683929443
Epoch: 36, Steps: 64 | Train Loss: 0.1106187 Vali Loss: 0.2361546 Test Loss: 0.3018588
Validation loss decreased (0.239244 --> 0.236155).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 37 cost time: 0.9184269905090332
Epoch: 37, Steps: 64 | Train Loss: 0.1114263 Vali Loss: 0.2381241 Test Loss: 0.3026317
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 38 cost time: 0.9216220378875732
Epoch: 38, Steps: 64 | Train Loss: 0.1105940 Vali Loss: 0.2371566 Test Loss: 0.3049431
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 39 cost time: 0.9213211536407471
Epoch: 39, Steps: 64 | Train Loss: 0.1106581 Vali Loss: 0.2395994 Test Loss: 0.3038930
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 40 cost time: 0.9183971881866455
Epoch: 40, Steps: 64 | Train Loss: 0.1114057 Vali Loss: 0.2374258 Test Loss: 0.2983512
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 41 cost time: 0.914492130279541
Epoch: 41, Steps: 64 | Train Loss: 0.1105511 Vali Loss: 0.2344168 Test Loss: 0.2997105
Validation loss decreased (0.236155 --> 0.234417).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 42 cost time: 0.9144880771636963
Epoch: 42, Steps: 64 | Train Loss: 0.1097086 Vali Loss: 0.2405040 Test Loss: 0.3022038
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 43 cost time: 0.9079999923706055
Epoch: 43, Steps: 64 | Train Loss: 0.1111307 Vali Loss: 0.2390620 Test Loss: 0.3018839
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 44 cost time: 0.9146218299865723
Epoch: 44, Steps: 64 | Train Loss: 0.1101757 Vali Loss: 0.2362078 Test Loss: 0.2997750
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 45 cost time: 0.9006295204162598
Epoch: 45, Steps: 64 | Train Loss: 0.1104077 Vali Loss: 0.2381236 Test Loss: 0.3004869
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 46 cost time: 0.9173343181610107
Epoch: 46, Steps: 64 | Train Loss: 0.1095564 Vali Loss: 0.2370079 Test Loss: 0.2988721
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 47 cost time: 0.9163353443145752
Epoch: 47, Steps: 64 | Train Loss: 0.1099965 Vali Loss: 0.2394264 Test Loss: 0.3009225
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 48 cost time: 0.9240267276763916
Epoch: 48, Steps: 64 | Train Loss: 0.1094314 Vali Loss: 0.2353260 Test Loss: 0.2986729
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 49 cost time: 0.9197242259979248
Epoch: 49, Steps: 64 | Train Loss: 0.1096582 Vali Loss: 0.2377968 Test Loss: 0.3007672
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 50 cost time: 0.9094257354736328
Epoch: 50, Steps: 64 | Train Loss: 0.1093374 Vali Loss: 0.2352737 Test Loss: 0.2974189
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 51 cost time: 0.9076273441314697
Epoch: 51, Steps: 64 | Train Loss: 0.1092683 Vali Loss: 0.2369149 Test Loss: 0.2994348
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 52 cost time: 0.9173367023468018
Epoch: 52, Steps: 64 | Train Loss: 0.1096581 Vali Loss: 0.2345424 Test Loss: 0.2977028
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 53 cost time: 0.907400369644165
Epoch: 53, Steps: 64 | Train Loss: 0.1096121 Vali Loss: 0.2350053 Test Loss: 0.2990916
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 54 cost time: 0.9124200344085693
Epoch: 54, Steps: 64 | Train Loss: 0.1095952 Vali Loss: 0.2386510 Test Loss: 0.3020170
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 55 cost time: 0.9253151416778564
Epoch: 55, Steps: 64 | Train Loss: 0.1096799 Vali Loss: 0.2347615 Test Loss: 0.2954808
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 56 cost time: 0.9207465648651123
Epoch: 56, Steps: 64 | Train Loss: 0.1093792 Vali Loss: 0.2336101 Test Loss: 0.2998025
Validation loss decreased (0.234417 --> 0.233610).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 57 cost time: 0.9180002212524414
Epoch: 57, Steps: 64 | Train Loss: 0.1098318 Vali Loss: 0.2351747 Test Loss: 0.3000436
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 58 cost time: 0.9173851013183594
Epoch: 58, Steps: 64 | Train Loss: 0.1098784 Vali Loss: 0.2366864 Test Loss: 0.3005301
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 59 cost time: 0.92238450050354
Epoch: 59, Steps: 64 | Train Loss: 0.1094971 Vali Loss: 0.2332824 Test Loss: 0.2997897
Validation loss decreased (0.233610 --> 0.233282).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 60 cost time: 0.9093568325042725
Epoch: 60, Steps: 64 | Train Loss: 0.1093843 Vali Loss: 0.2342227 Test Loss: 0.2986729
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2997896671295166, mae:0.3694998621940613, rse:0.251293420791626
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.048218727111816406 GB
Epoch: 1 cost time: 2.2651638984680176
Epoch: 1, Steps: 64 | Train Loss: 0.9875289 Vali Loss: 2.9368131 Test Loss: 5.2470093
Validation loss decreased (inf --> 2.936813).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 2 cost time: 0.8977704048156738
Epoch: 2, Steps: 64 | Train Loss: 0.7822096 Vali Loss: 1.8509331 Test Loss: 3.2076576
Validation loss decreased (2.936813 --> 1.850933).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 3 cost time: 0.8830001354217529
Epoch: 3, Steps: 64 | Train Loss: 0.5031296 Vali Loss: 1.1302178 Test Loss: 1.8434705
Validation loss decreased (1.850933 --> 1.130218).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 4 cost time: 0.879619836807251
Epoch: 4, Steps: 64 | Train Loss: 0.3102637 Vali Loss: 0.6640756 Test Loss: 0.9951588
Validation loss decreased (1.130218 --> 0.664076).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 5 cost time: 0.8858003616333008
Epoch: 5, Steps: 64 | Train Loss: 0.1992970 Vali Loss: 0.4437076 Test Loss: 0.6061359
Validation loss decreased (0.664076 --> 0.443708).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 6 cost time: 0.8863160610198975
Epoch: 6, Steps: 64 | Train Loss: 0.1508470 Vali Loss: 0.3389937 Test Loss: 0.4405569
Validation loss decreased (0.443708 --> 0.338994).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 7 cost time: 0.885369062423706
Epoch: 7, Steps: 64 | Train Loss: 0.1305012 Vali Loss: 0.3013845 Test Loss: 0.3755604
Validation loss decreased (0.338994 --> 0.301385).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 8 cost time: 0.8840758800506592
Epoch: 8, Steps: 64 | Train Loss: 0.1220326 Vali Loss: 0.2780332 Test Loss: 0.3410175
Validation loss decreased (0.301385 --> 0.278033).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 9 cost time: 0.8909995555877686
Epoch: 9, Steps: 64 | Train Loss: 0.1151676 Vali Loss: 0.2656439 Test Loss: 0.3239956
Validation loss decreased (0.278033 --> 0.265644).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 10 cost time: 0.8856275081634521
Epoch: 10, Steps: 64 | Train Loss: 0.1123485 Vali Loss: 0.2587276 Test Loss: 0.3145975
Validation loss decreased (0.265644 --> 0.258728).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 11 cost time: 0.8793647289276123
Epoch: 11, Steps: 64 | Train Loss: 0.1092758 Vali Loss: 0.2564871 Test Loss: 0.3077119
Validation loss decreased (0.258728 --> 0.256487).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 12 cost time: 0.8892421722412109
Epoch: 12, Steps: 64 | Train Loss: 0.1073048 Vali Loss: 0.2492942 Test Loss: 0.3038914
Validation loss decreased (0.256487 --> 0.249294).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 13 cost time: 0.900336742401123
Epoch: 13, Steps: 64 | Train Loss: 0.1050069 Vali Loss: 0.2474516 Test Loss: 0.3015930
Validation loss decreased (0.249294 --> 0.247452).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 14 cost time: 0.8931517601013184
Epoch: 14, Steps: 64 | Train Loss: 0.1033221 Vali Loss: 0.2435826 Test Loss: 0.2995529
Validation loss decreased (0.247452 --> 0.243583).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 15 cost time: 0.8850023746490479
Epoch: 15, Steps: 64 | Train Loss: 0.1019576 Vali Loss: 0.2452737 Test Loss: 0.2973309
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 16 cost time: 0.88761305809021
Epoch: 16, Steps: 64 | Train Loss: 0.1009463 Vali Loss: 0.2402446 Test Loss: 0.2983764
Validation loss decreased (0.243583 --> 0.240245).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 17 cost time: 0.8893406391143799
Epoch: 17, Steps: 64 | Train Loss: 0.1000559 Vali Loss: 0.2398685 Test Loss: 0.2974071
Validation loss decreased (0.240245 --> 0.239869).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 18 cost time: 0.8813643455505371
Epoch: 18, Steps: 64 | Train Loss: 0.0994124 Vali Loss: 0.2346284 Test Loss: 0.2956283
Validation loss decreased (0.239869 --> 0.234628).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 19 cost time: 0.8854176998138428
Epoch: 19, Steps: 64 | Train Loss: 0.0987522 Vali Loss: 0.2360149 Test Loss: 0.2960319
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 20 cost time: 0.9037413597106934
Epoch: 20, Steps: 64 | Train Loss: 0.0982877 Vali Loss: 0.2382242 Test Loss: 0.2957031
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 21 cost time: 0.8877313137054443
Epoch: 21, Steps: 64 | Train Loss: 0.0978847 Vali Loss: 0.2342580 Test Loss: 0.2922905
Validation loss decreased (0.234628 --> 0.234258).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 22 cost time: 0.8836429119110107
Epoch: 22, Steps: 64 | Train Loss: 0.0964020 Vali Loss: 0.2354313 Test Loss: 0.2946640
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 23 cost time: 0.8893375396728516
Epoch: 23, Steps: 64 | Train Loss: 0.0968553 Vali Loss: 0.2339412 Test Loss: 0.2952584
Validation loss decreased (0.234258 --> 0.233941).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 24 cost time: 0.8864161968231201
Epoch: 24, Steps: 64 | Train Loss: 0.0961925 Vali Loss: 0.2331535 Test Loss: 0.2933109
Validation loss decreased (0.233941 --> 0.233153).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 25 cost time: 0.8783330917358398
Epoch: 25, Steps: 64 | Train Loss: 0.0960215 Vali Loss: 0.2317873 Test Loss: 0.2929747
Validation loss decreased (0.233153 --> 0.231787).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 26 cost time: 0.8862404823303223
Epoch: 26, Steps: 64 | Train Loss: 0.0957526 Vali Loss: 0.2307361 Test Loss: 0.2924924
Validation loss decreased (0.231787 --> 0.230736).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 27 cost time: 0.883000373840332
Epoch: 27, Steps: 64 | Train Loss: 0.0948934 Vali Loss: 0.2322829 Test Loss: 0.2908631
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 28 cost time: 0.8745603561401367
Epoch: 28, Steps: 64 | Train Loss: 0.0955345 Vali Loss: 0.2306138 Test Loss: 0.2914952
Validation loss decreased (0.230736 --> 0.230614).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 29 cost time: 0.8784477710723877
Epoch: 29, Steps: 64 | Train Loss: 0.0946877 Vali Loss: 0.2316573 Test Loss: 0.2906592
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 30 cost time: 0.8893678188323975
Epoch: 30, Steps: 64 | Train Loss: 0.0946792 Vali Loss: 0.2294002 Test Loss: 0.2917440
Validation loss decreased (0.230614 --> 0.229400).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 31 cost time: 0.8830907344818115
Epoch: 31, Steps: 64 | Train Loss: 0.0938087 Vali Loss: 0.2314274 Test Loss: 0.2914898
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 32 cost time: 0.8924427032470703
Epoch: 32, Steps: 64 | Train Loss: 0.0947461 Vali Loss: 0.2309661 Test Loss: 0.2915233
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 33 cost time: 0.8866190910339355
Epoch: 33, Steps: 64 | Train Loss: 0.0938550 Vali Loss: 0.2298300 Test Loss: 0.2912347
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 34 cost time: 0.8833968639373779
Epoch: 34, Steps: 64 | Train Loss: 0.0938344 Vali Loss: 0.2294083 Test Loss: 0.2921351
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 35 cost time: 0.8970146179199219
Epoch: 35, Steps: 64 | Train Loss: 0.0940029 Vali Loss: 0.2300718 Test Loss: 0.2918797
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 36 cost time: 0.8823292255401611
Epoch: 36, Steps: 64 | Train Loss: 0.0937926 Vali Loss: 0.2285867 Test Loss: 0.2918975
Validation loss decreased (0.229400 --> 0.228587).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 37 cost time: 0.8818056583404541
Epoch: 37, Steps: 64 | Train Loss: 0.0931920 Vali Loss: 0.2300133 Test Loss: 0.2915403
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 38 cost time: 0.8970005512237549
Epoch: 38, Steps: 64 | Train Loss: 0.0936508 Vali Loss: 0.2275385 Test Loss: 0.2915192
Validation loss decreased (0.228587 --> 0.227538).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 39 cost time: 0.8910274505615234
Epoch: 39, Steps: 64 | Train Loss: 0.0937063 Vali Loss: 0.2293763 Test Loss: 0.2904427
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 40 cost time: 0.890345573425293
Epoch: 40, Steps: 64 | Train Loss: 0.0935662 Vali Loss: 0.2280752 Test Loss: 0.2908844
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 41 cost time: 0.8884825706481934
Epoch: 41, Steps: 64 | Train Loss: 0.0933610 Vali Loss: 0.2255219 Test Loss: 0.2904418
Validation loss decreased (0.227538 --> 0.225522).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 42 cost time: 0.8974449634552002
Epoch: 42, Steps: 64 | Train Loss: 0.0932462 Vali Loss: 0.2274078 Test Loss: 0.2897962
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 43 cost time: 0.884859561920166
Epoch: 43, Steps: 64 | Train Loss: 0.0929533 Vali Loss: 0.2286041 Test Loss: 0.2898538
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 44 cost time: 0.8836226463317871
Epoch: 44, Steps: 64 | Train Loss: 0.0937708 Vali Loss: 0.2293116 Test Loss: 0.2909152
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 45 cost time: 0.8796238899230957
Epoch: 45, Steps: 64 | Train Loss: 0.0932317 Vali Loss: 0.2296707 Test Loss: 0.2909409
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 46 cost time: 0.8803677558898926
Epoch: 46, Steps: 64 | Train Loss: 0.0931655 Vali Loss: 0.2260799 Test Loss: 0.2904107
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 47 cost time: 0.883063793182373
Epoch: 47, Steps: 64 | Train Loss: 0.0934988 Vali Loss: 0.2290438 Test Loss: 0.2896666
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 48 cost time: 0.8853564262390137
Epoch: 48, Steps: 64 | Train Loss: 0.0928614 Vali Loss: 0.2262224 Test Loss: 0.2895864
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 49 cost time: 0.8900001049041748
Epoch: 49, Steps: 64 | Train Loss: 0.0924858 Vali Loss: 0.2279397 Test Loss: 0.2899670
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 50 cost time: 0.8682410717010498
Epoch: 50, Steps: 64 | Train Loss: 0.0927811 Vali Loss: 0.2291292 Test Loss: 0.2905301
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 51 cost time: 0.888340950012207
Epoch: 51, Steps: 64 | Train Loss: 0.0928033 Vali Loss: 0.2278136 Test Loss: 0.2883412
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 52 cost time: 0.8873670101165771
Epoch: 52, Steps: 64 | Train Loss: 0.0930536 Vali Loss: 0.2277910 Test Loss: 0.2888838
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 53 cost time: 0.8810086250305176
Epoch: 53, Steps: 64 | Train Loss: 0.0929038 Vali Loss: 0.2275711 Test Loss: 0.2893944
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 54 cost time: 0.8848154544830322
Epoch: 54, Steps: 64 | Train Loss: 0.0928443 Vali Loss: 0.2264144 Test Loss: 0.2910623
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 55 cost time: 0.8818926811218262
Epoch: 55, Steps: 64 | Train Loss: 0.0926838 Vali Loss: 0.2258912 Test Loss: 0.2902361
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 56 cost time: 0.885610818862915
Epoch: 56, Steps: 64 | Train Loss: 0.0928457 Vali Loss: 0.2270485 Test Loss: 0.2896587
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 57 cost time: 0.8871133327484131
Epoch: 57, Steps: 64 | Train Loss: 0.0927781 Vali Loss: 0.2271422 Test Loss: 0.2917295
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 58 cost time: 0.8914284706115723
Epoch: 58, Steps: 64 | Train Loss: 0.0925284 Vali Loss: 0.2270906 Test Loss: 0.2892160
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 59 cost time: 0.8913378715515137
Epoch: 59, Steps: 64 | Train Loss: 0.0924775 Vali Loss: 0.2273620 Test Loss: 0.2899965
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 60 cost time: 0.8998126983642578
Epoch: 60, Steps: 64 | Train Loss: 0.0928135 Vali Loss: 0.2264261 Test Loss: 0.2903497
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2904418706893921, mae:0.3634076416492462, rse:0.24734459817409515
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.0487828254699707 GB
Epoch: 1 cost time: 2.3932597637176514
Epoch: 1, Steps: 64 | Train Loss: 0.8291858 Vali Loss: 2.5849702 Test Loss: 4.5656056
Validation loss decreased (inf --> 2.584970).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 2 cost time: 0.9710369110107422
Epoch: 2, Steps: 64 | Train Loss: 0.6926818 Vali Loss: 1.7299371 Test Loss: 2.9418037
Validation loss decreased (2.584970 --> 1.729937).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 3 cost time: 0.9726266860961914
Epoch: 3, Steps: 64 | Train Loss: 0.4468847 Vali Loss: 0.9800544 Test Loss: 1.5457674
Validation loss decreased (1.729937 --> 0.980054).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 4 cost time: 0.9734504222869873
Epoch: 4, Steps: 64 | Train Loss: 0.2460678 Vali Loss: 0.5168829 Test Loss: 0.7030618
Validation loss decreased (0.980054 --> 0.516883).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 5 cost time: 0.971468448638916
Epoch: 5, Steps: 64 | Train Loss: 0.1471860 Vali Loss: 0.3143686 Test Loss: 0.3851082
Validation loss decreased (0.516883 --> 0.314369).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 6 cost time: 0.9710226058959961
Epoch: 6, Steps: 64 | Train Loss: 0.1185129 Vali Loss: 0.2609978 Test Loss: 0.3167024
Validation loss decreased (0.314369 --> 0.260998).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 7 cost time: 0.9643490314483643
Epoch: 7, Steps: 64 | Train Loss: 0.1104868 Vali Loss: 0.2411470 Test Loss: 0.2984532
Validation loss decreased (0.260998 --> 0.241147).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 8 cost time: 0.9733495712280273
Epoch: 8, Steps: 64 | Train Loss: 0.1069016 Vali Loss: 0.2391630 Test Loss: 0.2915828
Validation loss decreased (0.241147 --> 0.239163).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 9 cost time: 0.9664041996002197
Epoch: 9, Steps: 64 | Train Loss: 0.1035716 Vali Loss: 0.2289688 Test Loss: 0.2871847
Validation loss decreased (0.239163 --> 0.228969).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 10 cost time: 0.9897358417510986
Epoch: 10, Steps: 64 | Train Loss: 0.1013962 Vali Loss: 0.2275536 Test Loss: 0.2865728
Validation loss decreased (0.228969 --> 0.227554).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 11 cost time: 0.9721934795379639
Epoch: 11, Steps: 64 | Train Loss: 0.0994216 Vali Loss: 0.2248148 Test Loss: 0.2843266
Validation loss decreased (0.227554 --> 0.224815).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 12 cost time: 0.9730000495910645
Epoch: 12, Steps: 64 | Train Loss: 0.0984692 Vali Loss: 0.2221138 Test Loss: 0.2788328
Validation loss decreased (0.224815 --> 0.222114).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 13 cost time: 0.9786093235015869
Epoch: 13, Steps: 64 | Train Loss: 0.0970486 Vali Loss: 0.2219197 Test Loss: 0.2779759
Validation loss decreased (0.222114 --> 0.221920).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 14 cost time: 0.9696168899536133
Epoch: 14, Steps: 64 | Train Loss: 0.0953727 Vali Loss: 0.2149207 Test Loss: 0.2762173
Validation loss decreased (0.221920 --> 0.214921).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 15 cost time: 0.9693915843963623
Epoch: 15, Steps: 64 | Train Loss: 0.0946634 Vali Loss: 0.2173277 Test Loss: 0.2758777
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 16 cost time: 0.9744536876678467
Epoch: 16, Steps: 64 | Train Loss: 0.0942120 Vali Loss: 0.2128325 Test Loss: 0.2745801
Validation loss decreased (0.214921 --> 0.212832).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 17 cost time: 0.9793403148651123
Epoch: 17, Steps: 64 | Train Loss: 0.0933783 Vali Loss: 0.2128750 Test Loss: 0.2744142
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 18 cost time: 0.9754626750946045
Epoch: 18, Steps: 64 | Train Loss: 0.0926793 Vali Loss: 0.2129581 Test Loss: 0.2733657
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 19 cost time: 0.9797303676605225
Epoch: 19, Steps: 64 | Train Loss: 0.0924194 Vali Loss: 0.2123196 Test Loss: 0.2736672
Validation loss decreased (0.212832 --> 0.212320).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 20 cost time: 0.9723272323608398
Epoch: 20, Steps: 64 | Train Loss: 0.0919879 Vali Loss: 0.2123886 Test Loss: 0.2747445
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 21 cost time: 0.9737179279327393
Epoch: 21, Steps: 64 | Train Loss: 0.0916575 Vali Loss: 0.2119302 Test Loss: 0.2721774
Validation loss decreased (0.212320 --> 0.211930).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 22 cost time: 0.9699990749359131
Epoch: 22, Steps: 64 | Train Loss: 0.0915494 Vali Loss: 0.2134781 Test Loss: 0.2720471
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 23 cost time: 0.9720101356506348
Epoch: 23, Steps: 64 | Train Loss: 0.0909279 Vali Loss: 0.2110663 Test Loss: 0.2751017
Validation loss decreased (0.211930 --> 0.211066).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 24 cost time: 0.9716129302978516
Epoch: 24, Steps: 64 | Train Loss: 0.0908842 Vali Loss: 0.2103758 Test Loss: 0.2725378
Validation loss decreased (0.211066 --> 0.210376).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 25 cost time: 0.9674537181854248
Epoch: 25, Steps: 64 | Train Loss: 0.0907461 Vali Loss: 0.2075268 Test Loss: 0.2698844
Validation loss decreased (0.210376 --> 0.207527).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 26 cost time: 0.9723474979400635
Epoch: 26, Steps: 64 | Train Loss: 0.0907807 Vali Loss: 0.2106525 Test Loss: 0.2720413
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 27 cost time: 0.950420618057251
Epoch: 27, Steps: 64 | Train Loss: 0.0898885 Vali Loss: 0.2123225 Test Loss: 0.2731483
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 28 cost time: 0.9743504524230957
Epoch: 28, Steps: 64 | Train Loss: 0.0900806 Vali Loss: 0.2109193 Test Loss: 0.2713475
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 29 cost time: 0.9783737659454346
Epoch: 29, Steps: 64 | Train Loss: 0.0898151 Vali Loss: 0.2099781 Test Loss: 0.2712856
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 30 cost time: 0.987363338470459
Epoch: 30, Steps: 64 | Train Loss: 0.0897128 Vali Loss: 0.2092758 Test Loss: 0.2724477
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 31 cost time: 0.9711990356445312
Epoch: 31, Steps: 64 | Train Loss: 0.0893723 Vali Loss: 0.2089743 Test Loss: 0.2722319
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 32 cost time: 0.9700002670288086
Epoch: 32, Steps: 64 | Train Loss: 0.0889923 Vali Loss: 0.2086769 Test Loss: 0.2722468
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 33 cost time: 0.9876234531402588
Epoch: 33, Steps: 64 | Train Loss: 0.0895538 Vali Loss: 0.2072454 Test Loss: 0.2732892
Validation loss decreased (0.207527 --> 0.207245).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 34 cost time: 0.9676253795623779
Epoch: 34, Steps: 64 | Train Loss: 0.0893048 Vali Loss: 0.2106196 Test Loss: 0.2719080
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 35 cost time: 0.9700486660003662
Epoch: 35, Steps: 64 | Train Loss: 0.0888737 Vali Loss: 0.2104677 Test Loss: 0.2753934
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 36 cost time: 0.9773752689361572
Epoch: 36, Steps: 64 | Train Loss: 0.0888226 Vali Loss: 0.2095356 Test Loss: 0.2702415
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 37 cost time: 0.971343994140625
Epoch: 37, Steps: 64 | Train Loss: 0.0887893 Vali Loss: 0.2086380 Test Loss: 0.2705181
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 38 cost time: 0.9744656085968018
Epoch: 38, Steps: 64 | Train Loss: 0.0888185 Vali Loss: 0.2083570 Test Loss: 0.2723991
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 39 cost time: 0.9744257926940918
Epoch: 39, Steps: 64 | Train Loss: 0.0887868 Vali Loss: 0.2079433 Test Loss: 0.2720183
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 40 cost time: 0.9616036415100098
Epoch: 40, Steps: 64 | Train Loss: 0.0886377 Vali Loss: 0.2094424 Test Loss: 0.2715974
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 41 cost time: 0.9657893180847168
Epoch: 41, Steps: 64 | Train Loss: 0.0888565 Vali Loss: 0.2121161 Test Loss: 0.2718345
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 42 cost time: 0.9660024642944336
Epoch: 42, Steps: 64 | Train Loss: 0.0892276 Vali Loss: 0.2102532 Test Loss: 0.2706526
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 43 cost time: 0.974381685256958
Epoch: 43, Steps: 64 | Train Loss: 0.0884597 Vali Loss: 0.2109669 Test Loss: 0.2716994
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 44 cost time: 0.9696140289306641
Epoch: 44, Steps: 64 | Train Loss: 0.0883636 Vali Loss: 0.2082490 Test Loss: 0.2707133
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 45 cost time: 0.9743258953094482
Epoch: 45, Steps: 64 | Train Loss: 0.0887603 Vali Loss: 0.2113979 Test Loss: 0.2743523
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 46 cost time: 0.9703865051269531
Epoch: 46, Steps: 64 | Train Loss: 0.0886142 Vali Loss: 0.2109269 Test Loss: 0.2735974
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 47 cost time: 0.9604754447937012
Epoch: 47, Steps: 64 | Train Loss: 0.0886042 Vali Loss: 0.2107358 Test Loss: 0.2719228
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 48 cost time: 0.9740509986877441
Epoch: 48, Steps: 64 | Train Loss: 0.0886183 Vali Loss: 0.2106352 Test Loss: 0.2721123
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 49 cost time: 0.9683742523193359
Epoch: 49, Steps: 64 | Train Loss: 0.0883855 Vali Loss: 0.2098377 Test Loss: 0.2718774
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 50 cost time: 0.9837450981140137
Epoch: 50, Steps: 64 | Train Loss: 0.0880101 Vali Loss: 0.2092436 Test Loss: 0.2716777
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 51 cost time: 0.97477126121521
Epoch: 51, Steps: 64 | Train Loss: 0.0885520 Vali Loss: 0.2088657 Test Loss: 0.2715848
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 52 cost time: 0.9726221561431885
Epoch: 52, Steps: 64 | Train Loss: 0.0879552 Vali Loss: 0.2052650 Test Loss: 0.2721749
Validation loss decreased (0.207245 --> 0.205265).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 53 cost time: 0.9866092205047607
Epoch: 53, Steps: 64 | Train Loss: 0.0885567 Vali Loss: 0.2103862 Test Loss: 0.2716686
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 54 cost time: 0.9719085693359375
Epoch: 54, Steps: 64 | Train Loss: 0.0883879 Vali Loss: 0.2095622 Test Loss: 0.2731722
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 55 cost time: 0.9803750514984131
Epoch: 55, Steps: 64 | Train Loss: 0.0888884 Vali Loss: 0.2093788 Test Loss: 0.2708074
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 56 cost time: 0.9850056171417236
Epoch: 56, Steps: 64 | Train Loss: 0.0884436 Vali Loss: 0.2104033 Test Loss: 0.2729355
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 57 cost time: 0.9644069671630859
Epoch: 57, Steps: 64 | Train Loss: 0.0886520 Vali Loss: 0.2083425 Test Loss: 0.2713609
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 58 cost time: 0.9584107398986816
Epoch: 58, Steps: 64 | Train Loss: 0.0888886 Vali Loss: 0.2111836 Test Loss: 0.2725036
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 59 cost time: 0.9703669548034668
Epoch: 59, Steps: 64 | Train Loss: 0.0888026 Vali Loss: 0.2072090 Test Loss: 0.2708123
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 60 cost time: 0.978168249130249
Epoch: 60, Steps: 64 | Train Loss: 0.0878406 Vali Loss: 0.2087509 Test Loss: 0.2712408
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2721748650074005, mae:0.34101036190986633, rse:0.23944006860256195
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.047678470611572266 GB
Epoch: 1 cost time: 2.266122817993164
Epoch: 1, Steps: 64 | Train Loss: 0.8929094 Vali Loss: 2.3754635 Test Loss: 3.9879282
Validation loss decreased (inf --> 2.375463).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 2 cost time: 0.9286210536956787
Epoch: 2, Steps: 64 | Train Loss: 0.6029676 Vali Loss: 0.9839717 Test Loss: 1.4627005
Validation loss decreased (2.375463 --> 0.983972).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 3 cost time: 0.9354574680328369
Epoch: 3, Steps: 64 | Train Loss: 0.3317298 Vali Loss: 0.5852721 Test Loss: 0.7693232
Validation loss decreased (0.983972 --> 0.585272).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 4 cost time: 0.9253883361816406
Epoch: 4, Steps: 64 | Train Loss: 0.2263123 Vali Loss: 0.4391538 Test Loss: 0.5669934
Validation loss decreased (0.585272 --> 0.439154).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 5 cost time: 0.9270145893096924
Epoch: 5, Steps: 64 | Train Loss: 0.1890875 Vali Loss: 0.3777277 Test Loss: 0.4761746
Validation loss decreased (0.439154 --> 0.377728).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 6 cost time: 0.9194495677947998
Epoch: 6, Steps: 64 | Train Loss: 0.1693398 Vali Loss: 0.3413434 Test Loss: 0.4229304
Validation loss decreased (0.377728 --> 0.341343).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 7 cost time: 0.9273388385772705
Epoch: 7, Steps: 64 | Train Loss: 0.1573872 Vali Loss: 0.3264667 Test Loss: 0.3934318
Validation loss decreased (0.341343 --> 0.326467).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 8 cost time: 0.9167935848236084
Epoch: 8, Steps: 64 | Train Loss: 0.1481033 Vali Loss: 0.3000822 Test Loss: 0.3737215
Validation loss decreased (0.326467 --> 0.300082).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 9 cost time: 0.9264125823974609
Epoch: 9, Steps: 64 | Train Loss: 0.1416659 Vali Loss: 0.2955846 Test Loss: 0.3545311
Validation loss decreased (0.300082 --> 0.295585).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 10 cost time: 0.9376101493835449
Epoch: 10, Steps: 64 | Train Loss: 0.1365030 Vali Loss: 0.2890686 Test Loss: 0.3454180
Validation loss decreased (0.295585 --> 0.289069).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 11 cost time: 0.9233644008636475
Epoch: 11, Steps: 64 | Train Loss: 0.1338346 Vali Loss: 0.2834471 Test Loss: 0.3372529
Validation loss decreased (0.289069 --> 0.283447).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 12 cost time: 0.9254715442657471
Epoch: 12, Steps: 64 | Train Loss: 0.1294658 Vali Loss: 0.2772033 Test Loss: 0.3279239
Validation loss decreased (0.283447 --> 0.277203).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 13 cost time: 0.9301540851593018
Epoch: 13, Steps: 64 | Train Loss: 0.1271990 Vali Loss: 0.2709655 Test Loss: 0.3238484
Validation loss decreased (0.277203 --> 0.270966).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 14 cost time: 0.9427745342254639
Epoch: 14, Steps: 64 | Train Loss: 0.1251658 Vali Loss: 0.2653727 Test Loss: 0.3216946
Validation loss decreased (0.270966 --> 0.265373).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 15 cost time: 0.922760009765625
Epoch: 15, Steps: 64 | Train Loss: 0.1229523 Vali Loss: 0.2610638 Test Loss: 0.3160377
Validation loss decreased (0.265373 --> 0.261064).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 16 cost time: 0.9200005531311035
Epoch: 16, Steps: 64 | Train Loss: 0.1216124 Vali Loss: 0.2664478 Test Loss: 0.3193578
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 17 cost time: 0.9245069026947021
Epoch: 17, Steps: 64 | Train Loss: 0.1208841 Vali Loss: 0.2628588 Test Loss: 0.3157004
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 18 cost time: 0.9177601337432861
Epoch: 18, Steps: 64 | Train Loss: 0.1197110 Vali Loss: 0.2660101 Test Loss: 0.3153199
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 19 cost time: 0.9203486442565918
Epoch: 19, Steps: 64 | Train Loss: 0.1183491 Vali Loss: 0.2620841 Test Loss: 0.3120644
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 20 cost time: 0.9240450859069824
Epoch: 20, Steps: 64 | Train Loss: 0.1172072 Vali Loss: 0.2570320 Test Loss: 0.3110097
Validation loss decreased (0.261064 --> 0.257032).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 21 cost time: 0.908292293548584
Epoch: 21, Steps: 64 | Train Loss: 0.1168761 Vali Loss: 0.2572644 Test Loss: 0.3094560
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 22 cost time: 0.9511208534240723
Epoch: 22, Steps: 64 | Train Loss: 0.1156646 Vali Loss: 0.2540358 Test Loss: 0.3110890
Validation loss decreased (0.257032 --> 0.254036).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 23 cost time: 0.9434902667999268
Epoch: 23, Steps: 64 | Train Loss: 0.1152844 Vali Loss: 0.2544638 Test Loss: 0.3085052
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 24 cost time: 0.9369995594024658
Epoch: 24, Steps: 64 | Train Loss: 0.1151073 Vali Loss: 0.2520027 Test Loss: 0.3087783
Validation loss decreased (0.254036 --> 0.252003).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 25 cost time: 0.9396326541900635
Epoch: 25, Steps: 64 | Train Loss: 0.1142385 Vali Loss: 0.2553602 Test Loss: 0.3098912
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 26 cost time: 0.9449608325958252
Epoch: 26, Steps: 64 | Train Loss: 0.1137751 Vali Loss: 0.2513918 Test Loss: 0.3073037
Validation loss decreased (0.252003 --> 0.251392).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 27 cost time: 0.9403815269470215
Epoch: 27, Steps: 64 | Train Loss: 0.1140431 Vali Loss: 0.2474589 Test Loss: 0.3054404
Validation loss decreased (0.251392 --> 0.247459).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 28 cost time: 0.8901522159576416
Epoch: 28, Steps: 64 | Train Loss: 0.1133735 Vali Loss: 0.2546726 Test Loss: 0.3074524
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 29 cost time: 0.8913812637329102
Epoch: 29, Steps: 64 | Train Loss: 0.1129393 Vali Loss: 0.2509960 Test Loss: 0.3082677
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 30 cost time: 0.9557573795318604
Epoch: 30, Steps: 64 | Train Loss: 0.1129004 Vali Loss: 0.2491489 Test Loss: 0.3076364
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 31 cost time: 0.9522683620452881
Epoch: 31, Steps: 64 | Train Loss: 0.1126390 Vali Loss: 0.2482721 Test Loss: 0.3061766
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 32 cost time: 0.9289987087249756
Epoch: 32, Steps: 64 | Train Loss: 0.1119753 Vali Loss: 0.2480119 Test Loss: 0.3059807
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 33 cost time: 0.9316015243530273
Epoch: 33, Steps: 64 | Train Loss: 0.1119861 Vali Loss: 0.2481022 Test Loss: 0.3069606
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 34 cost time: 0.9401516914367676
Epoch: 34, Steps: 64 | Train Loss: 0.1109733 Vali Loss: 0.2486681 Test Loss: 0.3068136
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 35 cost time: 0.9374639987945557
Epoch: 35, Steps: 64 | Train Loss: 0.1114803 Vali Loss: 0.2508422 Test Loss: 0.3077149
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 36 cost time: 0.9318132400512695
Epoch: 36, Steps: 64 | Train Loss: 0.1105304 Vali Loss: 0.2503329 Test Loss: 0.3071106
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 37 cost time: 0.9394075870513916
Epoch: 37, Steps: 64 | Train Loss: 0.1109895 Vali Loss: 0.2506509 Test Loss: 0.3065636
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 38 cost time: 0.9547233581542969
Epoch: 38, Steps: 64 | Train Loss: 0.1103912 Vali Loss: 0.2502569 Test Loss: 0.3070841
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 39 cost time: 0.9395995140075684
Epoch: 39, Steps: 64 | Train Loss: 0.1104802 Vali Loss: 0.2490747 Test Loss: 0.3067444
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 40 cost time: 0.9426054954528809
Epoch: 40, Steps: 64 | Train Loss: 0.1099248 Vali Loss: 0.2488931 Test Loss: 0.3047106
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 41 cost time: 0.9336090087890625
Epoch: 41, Steps: 64 | Train Loss: 0.1097738 Vali Loss: 0.2497276 Test Loss: 0.3056729
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 42 cost time: 0.9333219528198242
Epoch: 42, Steps: 64 | Train Loss: 0.1107599 Vali Loss: 0.2475854 Test Loss: 0.3058696
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 43 cost time: 0.9374871253967285
Epoch: 43, Steps: 64 | Train Loss: 0.1101107 Vali Loss: 0.2468004 Test Loss: 0.3059096
Validation loss decreased (0.247459 --> 0.246800).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 44 cost time: 0.9294021129608154
Epoch: 44, Steps: 64 | Train Loss: 0.1098084 Vali Loss: 0.2464323 Test Loss: 0.3053330
Validation loss decreased (0.246800 --> 0.246432).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 45 cost time: 0.9333136081695557
Epoch: 45, Steps: 64 | Train Loss: 0.1091467 Vali Loss: 0.2509056 Test Loss: 0.3058910
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 46 cost time: 0.9432103633880615
Epoch: 46, Steps: 64 | Train Loss: 0.1105455 Vali Loss: 0.2452306 Test Loss: 0.3062474
Validation loss decreased (0.246432 --> 0.245231).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 47 cost time: 0.942418098449707
Epoch: 47, Steps: 64 | Train Loss: 0.1101694 Vali Loss: 0.2480283 Test Loss: 0.3047828
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 48 cost time: 0.9306120872497559
Epoch: 48, Steps: 64 | Train Loss: 0.1099342 Vali Loss: 0.2471279 Test Loss: 0.3049392
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 49 cost time: 0.9236185550689697
Epoch: 49, Steps: 64 | Train Loss: 0.1090736 Vali Loss: 0.2438581 Test Loss: 0.3054775
Validation loss decreased (0.245231 --> 0.243858).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 50 cost time: 0.926361083984375
Epoch: 50, Steps: 64 | Train Loss: 0.1097693 Vali Loss: 0.2473103 Test Loss: 0.3046658
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 51 cost time: 0.9218182563781738
Epoch: 51, Steps: 64 | Train Loss: 0.1097455 Vali Loss: 0.2492975 Test Loss: 0.3063272
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 52 cost time: 0.925410270690918
Epoch: 52, Steps: 64 | Train Loss: 0.1092114 Vali Loss: 0.2453873 Test Loss: 0.3046944
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 53 cost time: 0.9193415641784668
Epoch: 53, Steps: 64 | Train Loss: 0.1100449 Vali Loss: 0.2469888 Test Loss: 0.3051622
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 54 cost time: 0.9250001907348633
Epoch: 54, Steps: 64 | Train Loss: 0.1090228 Vali Loss: 0.2468848 Test Loss: 0.3068768
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 55 cost time: 0.9350004196166992
Epoch: 55, Steps: 64 | Train Loss: 0.1099887 Vali Loss: 0.2473277 Test Loss: 0.3054973
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 56 cost time: 0.9316186904907227
Epoch: 56, Steps: 64 | Train Loss: 0.1099703 Vali Loss: 0.2496931 Test Loss: 0.3053241
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 57 cost time: 0.9308702945709229
Epoch: 57, Steps: 64 | Train Loss: 0.1095662 Vali Loss: 0.2494204 Test Loss: 0.3060707
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 58 cost time: 0.9323904514312744
Epoch: 58, Steps: 64 | Train Loss: 0.1093395 Vali Loss: 0.2457141 Test Loss: 0.3048995
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 59 cost time: 0.9264516830444336
Epoch: 59, Steps: 64 | Train Loss: 0.1101119 Vali Loss: 0.2448306 Test Loss: 0.3046223
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 60 cost time: 0.9207949638366699
Epoch: 60, Steps: 64 | Train Loss: 0.1094702 Vali Loss: 0.2458264 Test Loss: 0.3046978
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.3054775297641754, mae:0.3740406334400177, rse:0.25366610288619995
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04837989807128906 GB
Epoch: 1 cost time: 2.3620171546936035
Epoch: 1, Steps: 64 | Train Loss: 0.9491236 Vali Loss: 2.8136334 Test Loss: 4.9331927
Validation loss decreased (inf --> 2.813633).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 2 cost time: 0.9546763896942139
Epoch: 2, Steps: 64 | Train Loss: 0.7109845 Vali Loss: 1.6036246 Test Loss: 2.5872903
Validation loss decreased (2.813633 --> 1.603625).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 3 cost time: 0.9489998817443848
Epoch: 3, Steps: 64 | Train Loss: 0.4177261 Vali Loss: 0.9602926 Test Loss: 1.4204836
Validation loss decreased (1.603625 --> 0.960293).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 4 cost time: 0.9566421508789062
Epoch: 4, Steps: 64 | Train Loss: 0.2630390 Vali Loss: 0.6227105 Test Loss: 0.8507579
Validation loss decreased (0.960293 --> 0.622710).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 5 cost time: 0.9526219367980957
Epoch: 5, Steps: 64 | Train Loss: 0.1848488 Vali Loss: 0.4358165 Test Loss: 0.5687816
Validation loss decreased (0.622710 --> 0.435817).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 6 cost time: 1.0345544815063477
Epoch: 6, Steps: 64 | Train Loss: 0.1465569 Vali Loss: 0.3453417 Test Loss: 0.4334093
Validation loss decreased (0.435817 --> 0.345342).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 7 cost time: 1.0409269332885742
Epoch: 7, Steps: 64 | Train Loss: 0.1272988 Vali Loss: 0.3000104 Test Loss: 0.3640424
Validation loss decreased (0.345342 --> 0.300010).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 8 cost time: 1.0276963710784912
Epoch: 8, Steps: 64 | Train Loss: 0.1186508 Vali Loss: 0.2738886 Test Loss: 0.3379923
Validation loss decreased (0.300010 --> 0.273889).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 9 cost time: 0.9503920078277588
Epoch: 9, Steps: 64 | Train Loss: 0.1121777 Vali Loss: 0.2594250 Test Loss: 0.3178998
Validation loss decreased (0.273889 --> 0.259425).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 10 cost time: 0.964036226272583
Epoch: 10, Steps: 64 | Train Loss: 0.1092028 Vali Loss: 0.2546568 Test Loss: 0.3053429
Validation loss decreased (0.259425 --> 0.254657).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 11 cost time: 0.9573650360107422
Epoch: 11, Steps: 64 | Train Loss: 0.1068685 Vali Loss: 0.2503192 Test Loss: 0.3045289
Validation loss decreased (0.254657 --> 0.250319).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 12 cost time: 0.958366870880127
Epoch: 12, Steps: 64 | Train Loss: 0.1048416 Vali Loss: 0.2416749 Test Loss: 0.3003796
Validation loss decreased (0.250319 --> 0.241675).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 13 cost time: 0.9544022083282471
Epoch: 13, Steps: 64 | Train Loss: 0.1031041 Vali Loss: 0.2380731 Test Loss: 0.2989869
Validation loss decreased (0.241675 --> 0.238073).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 14 cost time: 0.9539999961853027
Epoch: 14, Steps: 64 | Train Loss: 0.1014560 Vali Loss: 0.2376583 Test Loss: 0.3004590
Validation loss decreased (0.238073 --> 0.237658).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 15 cost time: 0.9635343551635742
Epoch: 15, Steps: 64 | Train Loss: 0.0999608 Vali Loss: 0.2354673 Test Loss: 0.2992651
Validation loss decreased (0.237658 --> 0.235467).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 16 cost time: 0.9536237716674805
Epoch: 16, Steps: 64 | Train Loss: 0.1000293 Vali Loss: 0.2371393 Test Loss: 0.3002217
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 17 cost time: 0.9497816562652588
Epoch: 17, Steps: 64 | Train Loss: 0.0990455 Vali Loss: 0.2336670 Test Loss: 0.3001956
Validation loss decreased (0.235467 --> 0.233667).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 18 cost time: 0.9614155292510986
Epoch: 18, Steps: 64 | Train Loss: 0.0983950 Vali Loss: 0.2325592 Test Loss: 0.2981900
Validation loss decreased (0.233667 --> 0.232559).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 19 cost time: 0.956444263458252
Epoch: 19, Steps: 64 | Train Loss: 0.0980839 Vali Loss: 0.2321598 Test Loss: 0.3004553
Validation loss decreased (0.232559 --> 0.232160).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 20 cost time: 0.9603836536407471
Epoch: 20, Steps: 64 | Train Loss: 0.0976642 Vali Loss: 0.2315111 Test Loss: 0.3000349
Validation loss decreased (0.232160 --> 0.231511).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 21 cost time: 0.9543752670288086
Epoch: 21, Steps: 64 | Train Loss: 0.0966650 Vali Loss: 0.2304471 Test Loss: 0.2998106
Validation loss decreased (0.231511 --> 0.230447).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 22 cost time: 0.9295296669006348
Epoch: 22, Steps: 64 | Train Loss: 0.0964531 Vali Loss: 0.2293760 Test Loss: 0.3012192
Validation loss decreased (0.230447 --> 0.229376).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 23 cost time: 0.9467306137084961
Epoch: 23, Steps: 64 | Train Loss: 0.0959779 Vali Loss: 0.2315932 Test Loss: 0.3008439
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 24 cost time: 0.9439995288848877
Epoch: 24, Steps: 64 | Train Loss: 0.0960783 Vali Loss: 0.2305138 Test Loss: 0.2998637
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 25 cost time: 0.9506189823150635
Epoch: 25, Steps: 64 | Train Loss: 0.0950413 Vali Loss: 0.2286069 Test Loss: 0.3018892
Validation loss decreased (0.229376 --> 0.228607).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 26 cost time: 0.9436097145080566
Epoch: 26, Steps: 64 | Train Loss: 0.0945722 Vali Loss: 0.2297213 Test Loss: 0.3016579
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 27 cost time: 0.9564416408538818
Epoch: 27, Steps: 64 | Train Loss: 0.0950668 Vali Loss: 0.2280795 Test Loss: 0.3012424
Validation loss decreased (0.228607 --> 0.228079).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 28 cost time: 0.9643235206604004
Epoch: 28, Steps: 64 | Train Loss: 0.0937789 Vali Loss: 0.2260043 Test Loss: 0.3016663
Validation loss decreased (0.228079 --> 0.226004).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 29 cost time: 0.9663817882537842
Epoch: 29, Steps: 64 | Train Loss: 0.0948378 Vali Loss: 0.2279401 Test Loss: 0.3022034
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 30 cost time: 0.9568033218383789
Epoch: 30, Steps: 64 | Train Loss: 0.0944235 Vali Loss: 0.2260237 Test Loss: 0.3027426
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 31 cost time: 0.9477074146270752
Epoch: 31, Steps: 64 | Train Loss: 0.0938451 Vali Loss: 0.2289628 Test Loss: 0.3017396
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 32 cost time: 0.964740514755249
Epoch: 32, Steps: 64 | Train Loss: 0.0938349 Vali Loss: 0.2281680 Test Loss: 0.3027131
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 33 cost time: 0.9449999332427979
Epoch: 33, Steps: 64 | Train Loss: 0.0937634 Vali Loss: 0.2262458 Test Loss: 0.3020677
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 34 cost time: 0.9432399272918701
Epoch: 34, Steps: 64 | Train Loss: 0.0936923 Vali Loss: 0.2298081 Test Loss: 0.3026133
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 35 cost time: 0.9643986225128174
Epoch: 35, Steps: 64 | Train Loss: 0.0937565 Vali Loss: 0.2247260 Test Loss: 0.3032658
Validation loss decreased (0.226004 --> 0.224726).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 36 cost time: 0.9553680419921875
Epoch: 36, Steps: 64 | Train Loss: 0.0932831 Vali Loss: 0.2286654 Test Loss: 0.3027250
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 37 cost time: 0.9584589004516602
Epoch: 37, Steps: 64 | Train Loss: 0.0930931 Vali Loss: 0.2236904 Test Loss: 0.3024381
Validation loss decreased (0.224726 --> 0.223690).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 38 cost time: 0.9613621234893799
Epoch: 38, Steps: 64 | Train Loss: 0.0930607 Vali Loss: 0.2259511 Test Loss: 0.3017988
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 39 cost time: 0.95648193359375
Epoch: 39, Steps: 64 | Train Loss: 0.0933000 Vali Loss: 0.2267831 Test Loss: 0.3021252
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 40 cost time: 0.9437868595123291
Epoch: 40, Steps: 64 | Train Loss: 0.0930333 Vali Loss: 0.2280333 Test Loss: 0.3028716
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 41 cost time: 0.94700026512146
Epoch: 41, Steps: 64 | Train Loss: 0.0931304 Vali Loss: 0.2249863 Test Loss: 0.3015282
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 42 cost time: 0.9484348297119141
Epoch: 42, Steps: 64 | Train Loss: 0.0930934 Vali Loss: 0.2251436 Test Loss: 0.3022202
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 43 cost time: 0.9426131248474121
Epoch: 43, Steps: 64 | Train Loss: 0.0924786 Vali Loss: 0.2258160 Test Loss: 0.3029048
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 44 cost time: 0.9603226184844971
Epoch: 44, Steps: 64 | Train Loss: 0.0929119 Vali Loss: 0.2268702 Test Loss: 0.3024392
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 45 cost time: 0.9614274501800537
Epoch: 45, Steps: 64 | Train Loss: 0.0925184 Vali Loss: 0.2244530 Test Loss: 0.3039351
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 46 cost time: 1.0309958457946777
Epoch: 46, Steps: 64 | Train Loss: 0.0930840 Vali Loss: 0.2249542 Test Loss: 0.3031787
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 47 cost time: 1.0325276851654053
Epoch: 47, Steps: 64 | Train Loss: 0.0924052 Vali Loss: 0.2257501 Test Loss: 0.3028161
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 48 cost time: 1.0384738445281982
Epoch: 48, Steps: 64 | Train Loss: 0.0927473 Vali Loss: 0.2253765 Test Loss: 0.3027158
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 49 cost time: 0.9473464488983154
Epoch: 49, Steps: 64 | Train Loss: 0.0925486 Vali Loss: 0.2248510 Test Loss: 0.3026872
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 50 cost time: 0.9433770179748535
Epoch: 50, Steps: 64 | Train Loss: 0.0925916 Vali Loss: 0.2270078 Test Loss: 0.3020191
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 51 cost time: 0.948782205581665
Epoch: 51, Steps: 64 | Train Loss: 0.0930823 Vali Loss: 0.2297551 Test Loss: 0.3035931
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 52 cost time: 0.9650001525878906
Epoch: 52, Steps: 64 | Train Loss: 0.0921586 Vali Loss: 0.2260365 Test Loss: 0.3027761
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 53 cost time: 0.9536283016204834
Epoch: 53, Steps: 64 | Train Loss: 0.0924612 Vali Loss: 0.2266854 Test Loss: 0.3029081
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 54 cost time: 0.9584109783172607
Epoch: 54, Steps: 64 | Train Loss: 0.0927121 Vali Loss: 0.2246590 Test Loss: 0.3036522
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 55 cost time: 0.9723432064056396
Epoch: 55, Steps: 64 | Train Loss: 0.0925916 Vali Loss: 0.2225250 Test Loss: 0.3023511
Validation loss decreased (0.223690 --> 0.222525).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 56 cost time: 0.9544003009796143
Epoch: 56, Steps: 64 | Train Loss: 0.0921461 Vali Loss: 0.2254288 Test Loss: 0.3029246
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 57 cost time: 0.9474148750305176
Epoch: 57, Steps: 64 | Train Loss: 0.0926163 Vali Loss: 0.2254374 Test Loss: 0.3027416
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 58 cost time: 0.9481072425842285
Epoch: 58, Steps: 64 | Train Loss: 0.0925020 Vali Loss: 0.2246703 Test Loss: 0.3033186
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 59 cost time: 0.9502699375152588
Epoch: 59, Steps: 64 | Train Loss: 0.0924825 Vali Loss: 0.2248860 Test Loss: 0.3020698
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 60 cost time: 0.9457418918609619
Epoch: 60, Steps: 64 | Train Loss: 0.0928599 Vali Loss: 0.2236372 Test Loss: 0.3027639
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.30235105752944946, mae:0.37167373299598694, rse:0.2523646652698517
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.04894399642944336 GB
Epoch: 1 cost time: 2.3184823989868164
Epoch: 1, Steps: 64 | Train Loss: 0.9130142 Vali Loss: 2.8322396 Test Loss: 5.0139093
Validation loss decreased (inf --> 2.832240).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 2 cost time: 0.9196252822875977
Epoch: 2, Steps: 64 | Train Loss: 0.7597285 Vali Loss: 1.8892330 Test Loss: 3.2001140
Validation loss decreased (2.832240 --> 1.889233).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 3 cost time: 0.9134347438812256
Epoch: 3, Steps: 64 | Train Loss: 0.4770625 Vali Loss: 1.0151716 Test Loss: 1.5812639
Validation loss decreased (1.889233 --> 1.015172).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 4 cost time: 0.9143788814544678
Epoch: 4, Steps: 64 | Train Loss: 0.2610903 Vali Loss: 0.5378330 Test Loss: 0.7184354
Validation loss decreased (1.015172 --> 0.537833).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 5 cost time: 0.9261305332183838
Epoch: 5, Steps: 64 | Train Loss: 0.1517639 Vali Loss: 0.3418151 Test Loss: 0.3891396
Validation loss decreased (0.537833 --> 0.341815).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 6 cost time: 0.9054129123687744
Epoch: 6, Steps: 64 | Train Loss: 0.1214364 Vali Loss: 0.2888843 Test Loss: 0.3211542
Validation loss decreased (0.341815 --> 0.288884).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 7 cost time: 0.904728889465332
Epoch: 7, Steps: 64 | Train Loss: 0.1121800 Vali Loss: 0.2705048 Test Loss: 0.3107854
Validation loss decreased (0.288884 --> 0.270505).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 8 cost time: 0.905388593673706
Epoch: 8, Steps: 64 | Train Loss: 0.1081218 Vali Loss: 0.2550597 Test Loss: 0.3065815
Validation loss decreased (0.270505 --> 0.255060).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 9 cost time: 0.9030206203460693
Epoch: 9, Steps: 64 | Train Loss: 0.1050358 Vali Loss: 0.2456124 Test Loss: 0.3000219
Validation loss decreased (0.255060 --> 0.245612).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 10 cost time: 0.906428337097168
Epoch: 10, Steps: 64 | Train Loss: 0.1023871 Vali Loss: 0.2458077 Test Loss: 0.3006233
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 11 cost time: 0.9093477725982666
Epoch: 11, Steps: 64 | Train Loss: 0.1010298 Vali Loss: 0.2397717 Test Loss: 0.2986490
Validation loss decreased (0.245612 --> 0.239772).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 12 cost time: 0.9218971729278564
Epoch: 12, Steps: 64 | Train Loss: 0.0986434 Vali Loss: 0.2387666 Test Loss: 0.2983636
Validation loss decreased (0.239772 --> 0.238767).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 13 cost time: 0.920417070388794
Epoch: 13, Steps: 64 | Train Loss: 0.0975196 Vali Loss: 0.2340418 Test Loss: 0.2960106
Validation loss decreased (0.238767 --> 0.234042).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 14 cost time: 0.9107170104980469
Epoch: 14, Steps: 64 | Train Loss: 0.0970621 Vali Loss: 0.2344465 Test Loss: 0.2971253
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 15 cost time: 0.9039998054504395
Epoch: 15, Steps: 64 | Train Loss: 0.0959220 Vali Loss: 0.2290401 Test Loss: 0.2966529
Validation loss decreased (0.234042 --> 0.229040).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 16 cost time: 0.9129672050476074
Epoch: 16, Steps: 64 | Train Loss: 0.0954028 Vali Loss: 0.2335635 Test Loss: 0.2966759
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 17 cost time: 0.8962297439575195
Epoch: 17, Steps: 64 | Train Loss: 0.0941982 Vali Loss: 0.2312473 Test Loss: 0.2965565
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 18 cost time: 0.8983609676361084
Epoch: 18, Steps: 64 | Train Loss: 0.0941904 Vali Loss: 0.2274818 Test Loss: 0.2968806
Validation loss decreased (0.229040 --> 0.227482).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 19 cost time: 0.9093854427337646
Epoch: 19, Steps: 64 | Train Loss: 0.0934551 Vali Loss: 0.2271613 Test Loss: 0.2980789
Validation loss decreased (0.227482 --> 0.227161).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 20 cost time: 0.9098019599914551
Epoch: 20, Steps: 64 | Train Loss: 0.0931092 Vali Loss: 0.2286613 Test Loss: 0.2959231
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 21 cost time: 0.909348726272583
Epoch: 21, Steps: 64 | Train Loss: 0.0927758 Vali Loss: 0.2272697 Test Loss: 0.2977772
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 22 cost time: 0.9096119403839111
Epoch: 22, Steps: 64 | Train Loss: 0.0922984 Vali Loss: 0.2262483 Test Loss: 0.2978092
Validation loss decreased (0.227161 --> 0.226248).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 23 cost time: 0.8981292247772217
Epoch: 23, Steps: 64 | Train Loss: 0.0921908 Vali Loss: 0.2262428 Test Loss: 0.2964816
Validation loss decreased (0.226248 --> 0.226243).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 24 cost time: 0.867222785949707
Epoch: 24, Steps: 64 | Train Loss: 0.0915752 Vali Loss: 0.2247182 Test Loss: 0.2977017
Validation loss decreased (0.226243 --> 0.224718).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 25 cost time: 0.9017729759216309
Epoch: 25, Steps: 64 | Train Loss: 0.0918338 Vali Loss: 0.2232830 Test Loss: 0.2966525
Validation loss decreased (0.224718 --> 0.223283).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 26 cost time: 0.9047355651855469
Epoch: 26, Steps: 64 | Train Loss: 0.0912441 Vali Loss: 0.2235716 Test Loss: 0.2977181
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 27 cost time: 0.8920001983642578
Epoch: 27, Steps: 64 | Train Loss: 0.0909273 Vali Loss: 0.2273514 Test Loss: 0.2978094
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 28 cost time: 0.9066221714019775
Epoch: 28, Steps: 64 | Train Loss: 0.0907605 Vali Loss: 0.2273534 Test Loss: 0.2994491
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 29 cost time: 0.9137735366821289
Epoch: 29, Steps: 64 | Train Loss: 0.0904493 Vali Loss: 0.2257241 Test Loss: 0.2990070
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 30 cost time: 0.9113388061523438
Epoch: 30, Steps: 64 | Train Loss: 0.0909470 Vali Loss: 0.2245528 Test Loss: 0.2967531
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 31 cost time: 0.9103169441223145
Epoch: 31, Steps: 64 | Train Loss: 0.0905034 Vali Loss: 0.2225381 Test Loss: 0.2978758
Validation loss decreased (0.223283 --> 0.222538).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 32 cost time: 0.9113402366638184
Epoch: 32, Steps: 64 | Train Loss: 0.0906952 Vali Loss: 0.2256903 Test Loss: 0.2980946
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 33 cost time: 0.9047880172729492
Epoch: 33, Steps: 64 | Train Loss: 0.0900197 Vali Loss: 0.2237910 Test Loss: 0.2988560
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 34 cost time: 0.916846513748169
Epoch: 34, Steps: 64 | Train Loss: 0.0904545 Vali Loss: 0.2269858 Test Loss: 0.2994404
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 35 cost time: 0.903623104095459
Epoch: 35, Steps: 64 | Train Loss: 0.0900248 Vali Loss: 0.2229005 Test Loss: 0.2987401
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 36 cost time: 0.9014177322387695
Epoch: 36, Steps: 64 | Train Loss: 0.0901433 Vali Loss: 0.2250098 Test Loss: 0.2975943
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 37 cost time: 0.9193172454833984
Epoch: 37, Steps: 64 | Train Loss: 0.0899626 Vali Loss: 0.2228475 Test Loss: 0.2979519
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 38 cost time: 0.9067225456237793
Epoch: 38, Steps: 64 | Train Loss: 0.0893950 Vali Loss: 0.2260672 Test Loss: 0.2985764
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 39 cost time: 0.9117522239685059
Epoch: 39, Steps: 64 | Train Loss: 0.0896839 Vali Loss: 0.2209985 Test Loss: 0.2996990
Validation loss decreased (0.222538 --> 0.220999).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 40 cost time: 0.9059998989105225
Epoch: 40, Steps: 64 | Train Loss: 0.0896785 Vali Loss: 0.2242688 Test Loss: 0.2981741
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 41 cost time: 0.9236271381378174
Epoch: 41, Steps: 64 | Train Loss: 0.0896442 Vali Loss: 0.2231780 Test Loss: 0.2970521
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 42 cost time: 0.9024524688720703
Epoch: 42, Steps: 64 | Train Loss: 0.0897733 Vali Loss: 0.2237049 Test Loss: 0.2982374
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 43 cost time: 0.8843891620635986
Epoch: 43, Steps: 64 | Train Loss: 0.0894706 Vali Loss: 0.2222188 Test Loss: 0.2977818
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 44 cost time: 0.9083759784698486
Epoch: 44, Steps: 64 | Train Loss: 0.0892921 Vali Loss: 0.2218944 Test Loss: 0.2974880
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 45 cost time: 0.8894140720367432
Epoch: 45, Steps: 64 | Train Loss: 0.0896220 Vali Loss: 0.2251658 Test Loss: 0.2980282
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 46 cost time: 0.9029996395111084
Epoch: 46, Steps: 64 | Train Loss: 0.0894102 Vali Loss: 0.2251222 Test Loss: 0.2976618
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 47 cost time: 0.9046182632446289
Epoch: 47, Steps: 64 | Train Loss: 0.0892715 Vali Loss: 0.2218827 Test Loss: 0.2977142
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 48 cost time: 0.9202067852020264
Epoch: 48, Steps: 64 | Train Loss: 0.0892503 Vali Loss: 0.2248190 Test Loss: 0.2988047
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 49 cost time: 0.9073317050933838
Epoch: 49, Steps: 64 | Train Loss: 0.0890414 Vali Loss: 0.2217997 Test Loss: 0.2978989
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 50 cost time: 0.9084620475769043
Epoch: 50, Steps: 64 | Train Loss: 0.0894401 Vali Loss: 0.2223283 Test Loss: 0.2986278
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 51 cost time: 0.9074509143829346
Epoch: 51, Steps: 64 | Train Loss: 0.0893162 Vali Loss: 0.2234298 Test Loss: 0.2975149
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 52 cost time: 0.8550000190734863
Epoch: 52, Steps: 64 | Train Loss: 0.0896301 Vali Loss: 0.2237443 Test Loss: 0.2972387
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 53 cost time: 0.9949996471405029
Epoch: 53, Steps: 64 | Train Loss: 0.0895595 Vali Loss: 0.2225143 Test Loss: 0.3004560
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 54 cost time: 0.9562249183654785
Epoch: 54, Steps: 64 | Train Loss: 0.0895219 Vali Loss: 0.2235533 Test Loss: 0.2990130
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 55 cost time: 0.921377420425415
Epoch: 55, Steps: 64 | Train Loss: 0.0889979 Vali Loss: 0.2197851 Test Loss: 0.2976700
Validation loss decreased (0.220999 --> 0.219785).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 56 cost time: 0.9063897132873535
Epoch: 56, Steps: 64 | Train Loss: 0.0887840 Vali Loss: 0.2219454 Test Loss: 0.2983828
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 57 cost time: 0.9043505191802979
Epoch: 57, Steps: 64 | Train Loss: 0.0897221 Vali Loss: 0.2196021 Test Loss: 0.2975108
Validation loss decreased (0.219785 --> 0.219602).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 58 cost time: 0.9179682731628418
Epoch: 58, Steps: 64 | Train Loss: 0.0889560 Vali Loss: 0.2242912 Test Loss: 0.2976839
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 59 cost time: 0.9107201099395752
Epoch: 59, Steps: 64 | Train Loss: 0.0891869 Vali Loss: 0.2232694 Test Loss: 0.3002972
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 60 cost time: 0.8960001468658447
Epoch: 60, Steps: 64 | Train Loss: 0.0892655 Vali Loss: 0.2220785 Test Loss: 0.2983307
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2975107729434967, mae:0.36482080817222595, rse:0.25033649802207947
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04783916473388672 GB
Epoch: 1 cost time: 2.297283172607422
Epoch: 1, Steps: 64 | Train Loss: 1.2787545 Vali Loss: 3.5026362 Test Loss: 6.2338648
Validation loss decreased (inf --> 3.502636).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 2 cost time: 0.9347982406616211
Epoch: 2, Steps: 64 | Train Loss: 0.7724281 Vali Loss: 1.0653869 Test Loss: 1.5526890
Validation loss decreased (3.502636 --> 1.065387).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 3 cost time: 1.0239386558532715
Epoch: 3, Steps: 64 | Train Loss: 0.3542709 Vali Loss: 0.6958144 Test Loss: 0.9051849
Validation loss decreased (1.065387 --> 0.695814).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 4 cost time: 1.0204286575317383
Epoch: 4, Steps: 64 | Train Loss: 0.2539749 Vali Loss: 0.5443881 Test Loss: 0.6516925
Validation loss decreased (0.695814 --> 0.544388).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 5 cost time: 0.9324729442596436
Epoch: 5, Steps: 64 | Train Loss: 0.2081417 Vali Loss: 0.4556134 Test Loss: 0.5248514
Validation loss decreased (0.544388 --> 0.455613).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 6 cost time: 0.9193723201751709
Epoch: 6, Steps: 64 | Train Loss: 0.1827183 Vali Loss: 0.3943515 Test Loss: 0.4527957
Validation loss decreased (0.455613 --> 0.394351).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 7 cost time: 0.9203779697418213
Epoch: 7, Steps: 64 | Train Loss: 0.1672295 Vali Loss: 0.3588662 Test Loss: 0.4052348
Validation loss decreased (0.394351 --> 0.358866).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 8 cost time: 0.9201610088348389
Epoch: 8, Steps: 64 | Train Loss: 0.1554973 Vali Loss: 0.3294764 Test Loss: 0.3771208
Validation loss decreased (0.358866 --> 0.329476).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 9 cost time: 0.9090001583099365
Epoch: 9, Steps: 64 | Train Loss: 0.1487698 Vali Loss: 0.3062901 Test Loss: 0.3526962
Validation loss decreased (0.329476 --> 0.306290).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 10 cost time: 0.9376101493835449
Epoch: 10, Steps: 64 | Train Loss: 0.1419860 Vali Loss: 0.2940424 Test Loss: 0.3404565
Validation loss decreased (0.306290 --> 0.294042).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 11 cost time: 0.9333958625793457
Epoch: 11, Steps: 64 | Train Loss: 0.1367820 Vali Loss: 0.2836325 Test Loss: 0.3310827
Validation loss decreased (0.294042 --> 0.283632).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 12 cost time: 0.9471497535705566
Epoch: 12, Steps: 64 | Train Loss: 0.1345143 Vali Loss: 0.2722011 Test Loss: 0.3211577
Validation loss decreased (0.283632 --> 0.272201).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 13 cost time: 0.9353988170623779
Epoch: 13, Steps: 64 | Train Loss: 0.1310815 Vali Loss: 0.2728348 Test Loss: 0.3159356
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 14 cost time: 0.9281132221221924
Epoch: 14, Steps: 64 | Train Loss: 0.1297677 Vali Loss: 0.2631497 Test Loss: 0.3125571
Validation loss decreased (0.272201 --> 0.263150).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 15 cost time: 0.9263763427734375
Epoch: 15, Steps: 64 | Train Loss: 0.1278077 Vali Loss: 0.2613745 Test Loss: 0.3091345
Validation loss decreased (0.263150 --> 0.261375).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 16 cost time: 0.9188089370727539
Epoch: 16, Steps: 64 | Train Loss: 0.1254511 Vali Loss: 0.2586446 Test Loss: 0.3089460
Validation loss decreased (0.261375 --> 0.258645).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 17 cost time: 0.9209997653961182
Epoch: 17, Steps: 64 | Train Loss: 0.1246287 Vali Loss: 0.2529790 Test Loss: 0.3064695
Validation loss decreased (0.258645 --> 0.252979).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 18 cost time: 0.9156069755554199
Epoch: 18, Steps: 64 | Train Loss: 0.1234263 Vali Loss: 0.2538435 Test Loss: 0.3039017
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 19 cost time: 0.9424138069152832
Epoch: 19, Steps: 64 | Train Loss: 0.1225400 Vali Loss: 0.2546130 Test Loss: 0.3036205
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 20 cost time: 0.9343545436859131
Epoch: 20, Steps: 64 | Train Loss: 0.1218485 Vali Loss: 0.2485877 Test Loss: 0.3023255
Validation loss decreased (0.252979 --> 0.248588).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 21 cost time: 0.9334549903869629
Epoch: 21, Steps: 64 | Train Loss: 0.1202161 Vali Loss: 0.2499884 Test Loss: 0.3009214
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 22 cost time: 0.9374008178710938
Epoch: 22, Steps: 64 | Train Loss: 0.1197473 Vali Loss: 0.2477833 Test Loss: 0.3010150
Validation loss decreased (0.248588 --> 0.247783).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 23 cost time: 0.9187486171722412
Epoch: 23, Steps: 64 | Train Loss: 0.1190432 Vali Loss: 0.2492363 Test Loss: 0.2993563
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 24 cost time: 0.9189975261688232
Epoch: 24, Steps: 64 | Train Loss: 0.1186739 Vali Loss: 0.2471855 Test Loss: 0.2984265
Validation loss decreased (0.247783 --> 0.247186).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 25 cost time: 0.9174575805664062
Epoch: 25, Steps: 64 | Train Loss: 0.1186395 Vali Loss: 0.2434064 Test Loss: 0.2987186
Validation loss decreased (0.247186 --> 0.243406).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 26 cost time: 0.921621561050415
Epoch: 26, Steps: 64 | Train Loss: 0.1178250 Vali Loss: 0.2429483 Test Loss: 0.2984099
Validation loss decreased (0.243406 --> 0.242948).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 27 cost time: 0.9243862628936768
Epoch: 27, Steps: 64 | Train Loss: 0.1171441 Vali Loss: 0.2451070 Test Loss: 0.2968352
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 28 cost time: 0.9323186874389648
Epoch: 28, Steps: 64 | Train Loss: 0.1171311 Vali Loss: 0.2436842 Test Loss: 0.2966814
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 29 cost time: 0.9263889789581299
Epoch: 29, Steps: 64 | Train Loss: 0.1171199 Vali Loss: 0.2428929 Test Loss: 0.2959478
Validation loss decreased (0.242948 --> 0.242893).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 30 cost time: 0.9190447330474854
Epoch: 30, Steps: 64 | Train Loss: 0.1160517 Vali Loss: 0.2422602 Test Loss: 0.2973102
Validation loss decreased (0.242893 --> 0.242260).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 31 cost time: 0.9257423877716064
Epoch: 31, Steps: 64 | Train Loss: 0.1159755 Vali Loss: 0.2384161 Test Loss: 0.2967363
Validation loss decreased (0.242260 --> 0.238416).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 32 cost time: 0.9200015068054199
Epoch: 32, Steps: 64 | Train Loss: 0.1157428 Vali Loss: 0.2405693 Test Loss: 0.2957087
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 33 cost time: 0.9216363430023193
Epoch: 33, Steps: 64 | Train Loss: 0.1157817 Vali Loss: 0.2405045 Test Loss: 0.2955020
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 34 cost time: 0.9200820922851562
Epoch: 34, Steps: 64 | Train Loss: 0.1162236 Vali Loss: 0.2446722 Test Loss: 0.2968157
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 35 cost time: 0.9153547286987305
Epoch: 35, Steps: 64 | Train Loss: 0.1156732 Vali Loss: 0.2448403 Test Loss: 0.2956192
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 36 cost time: 0.9344615936279297
Epoch: 36, Steps: 64 | Train Loss: 0.1152790 Vali Loss: 0.2433016 Test Loss: 0.2953897
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 37 cost time: 0.9313845634460449
Epoch: 37, Steps: 64 | Train Loss: 0.1152331 Vali Loss: 0.2371829 Test Loss: 0.2943487
Validation loss decreased (0.238416 --> 0.237183).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 38 cost time: 0.9337165355682373
Epoch: 38, Steps: 64 | Train Loss: 0.1153131 Vali Loss: 0.2423121 Test Loss: 0.2942822
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 39 cost time: 0.9282510280609131
Epoch: 39, Steps: 64 | Train Loss: 0.1149341 Vali Loss: 0.2414606 Test Loss: 0.2946488
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 40 cost time: 0.9320003986358643
Epoch: 40, Steps: 64 | Train Loss: 0.1138929 Vali Loss: 0.2404488 Test Loss: 0.2936500
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 41 cost time: 0.9166202545166016
Epoch: 41, Steps: 64 | Train Loss: 0.1141185 Vali Loss: 0.2431558 Test Loss: 0.2941424
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 42 cost time: 0.917334794998169
Epoch: 42, Steps: 64 | Train Loss: 0.1134524 Vali Loss: 0.2415888 Test Loss: 0.2943511
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 43 cost time: 0.9113192558288574
Epoch: 43, Steps: 64 | Train Loss: 0.1145694 Vali Loss: 0.2414093 Test Loss: 0.2947744
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 44 cost time: 0.9183673858642578
Epoch: 44, Steps: 64 | Train Loss: 0.1142161 Vali Loss: 0.2394968 Test Loss: 0.2936198
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 45 cost time: 0.9274299144744873
Epoch: 45, Steps: 64 | Train Loss: 0.1142064 Vali Loss: 0.2385536 Test Loss: 0.2939933
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 46 cost time: 0.9328038692474365
Epoch: 46, Steps: 64 | Train Loss: 0.1133048 Vali Loss: 0.2393040 Test Loss: 0.2950675
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 47 cost time: 0.9021055698394775
Epoch: 47, Steps: 64 | Train Loss: 0.1139791 Vali Loss: 0.2395248 Test Loss: 0.2937521
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 48 cost time: 0.8986120223999023
Epoch: 48, Steps: 64 | Train Loss: 0.1139082 Vali Loss: 0.2397318 Test Loss: 0.2938426
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 49 cost time: 0.9333431720733643
Epoch: 49, Steps: 64 | Train Loss: 0.1139885 Vali Loss: 0.2383631 Test Loss: 0.2943887
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 50 cost time: 0.9124324321746826
Epoch: 50, Steps: 64 | Train Loss: 0.1140274 Vali Loss: 0.2399759 Test Loss: 0.2932397
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 51 cost time: 0.9188210964202881
Epoch: 51, Steps: 64 | Train Loss: 0.1134190 Vali Loss: 0.2393890 Test Loss: 0.2939539
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 52 cost time: 0.9219784736633301
Epoch: 52, Steps: 64 | Train Loss: 0.1131723 Vali Loss: 0.2396975 Test Loss: 0.2935726
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 53 cost time: 0.9227149486541748
Epoch: 53, Steps: 64 | Train Loss: 0.1136095 Vali Loss: 0.2348789 Test Loss: 0.2935659
Validation loss decreased (0.237183 --> 0.234879).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 54 cost time: 0.9319982528686523
Epoch: 54, Steps: 64 | Train Loss: 0.1140323 Vali Loss: 0.2402669 Test Loss: 0.2929207
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 55 cost time: 0.9446258544921875
Epoch: 55, Steps: 64 | Train Loss: 0.1127744 Vali Loss: 0.2381697 Test Loss: 0.2937410
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 56 cost time: 0.9328329563140869
Epoch: 56, Steps: 64 | Train Loss: 0.1135969 Vali Loss: 0.2356089 Test Loss: 0.2941446
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 57 cost time: 0.9479904174804688
Epoch: 57, Steps: 64 | Train Loss: 0.1141663 Vali Loss: 0.2380161 Test Loss: 0.2937520
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 58 cost time: 0.9344525337219238
Epoch: 58, Steps: 64 | Train Loss: 0.1138732 Vali Loss: 0.2380141 Test Loss: 0.2937445
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 59 cost time: 0.9265384674072266
Epoch: 59, Steps: 64 | Train Loss: 0.1141699 Vali Loss: 0.2389539 Test Loss: 0.2936390
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 60 cost time: 0.9430150985717773
Epoch: 60, Steps: 64 | Train Loss: 0.1133939 Vali Loss: 0.2365810 Test Loss: 0.2939772
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.29356589913368225, mae:0.358243852853775, rse:0.2486712634563446
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.048540592193603516 GB
Epoch: 1 cost time: 2.281057834625244
Epoch: 1, Steps: 64 | Train Loss: 0.9054466 Vali Loss: 2.7095561 Test Loss: 4.8002062
Validation loss decreased (inf --> 2.709556).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 2 cost time: 0.9009988307952881
Epoch: 2, Steps: 64 | Train Loss: 0.6724765 Vali Loss: 1.3919864 Test Loss: 2.2812428
Validation loss decreased (2.709556 --> 1.391986).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 3 cost time: 0.898613452911377
Epoch: 3, Steps: 64 | Train Loss: 0.3668089 Vali Loss: 0.8193120 Test Loss: 1.1844987
Validation loss decreased (1.391986 --> 0.819312).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 4 cost time: 0.9097270965576172
Epoch: 4, Steps: 64 | Train Loss: 0.2176249 Vali Loss: 0.5358387 Test Loss: 0.6683503
Validation loss decreased (0.819312 --> 0.535839).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 5 cost time: 0.8919613361358643
Epoch: 5, Steps: 64 | Train Loss: 0.1532898 Vali Loss: 0.3927406 Test Loss: 0.4628009
Validation loss decreased (0.535839 --> 0.392741).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 6 cost time: 0.8933494091033936
Epoch: 6, Steps: 64 | Train Loss: 0.1289544 Vali Loss: 0.3187371 Test Loss: 0.3716254
Validation loss decreased (0.392741 --> 0.318737).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 7 cost time: 0.8988423347473145
Epoch: 7, Steps: 64 | Train Loss: 0.1180169 Vali Loss: 0.2902799 Test Loss: 0.3339949
Validation loss decreased (0.318737 --> 0.290280).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 8 cost time: 0.8929998874664307
Epoch: 8, Steps: 64 | Train Loss: 0.1133749 Vali Loss: 0.2731465 Test Loss: 0.3222525
Validation loss decreased (0.290280 --> 0.273146).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 9 cost time: 0.8910000324249268
Epoch: 9, Steps: 64 | Train Loss: 0.1098997 Vali Loss: 0.2647806 Test Loss: 0.3169729
Validation loss decreased (0.273146 --> 0.264781).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 10 cost time: 0.8916115760803223
Epoch: 10, Steps: 64 | Train Loss: 0.1084751 Vali Loss: 0.2609403 Test Loss: 0.3148043
Validation loss decreased (0.264781 --> 0.260940).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 11 cost time: 0.9073586463928223
Epoch: 11, Steps: 64 | Train Loss: 0.1052459 Vali Loss: 0.2552176 Test Loss: 0.3086911
Validation loss decreased (0.260940 --> 0.255218).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 12 cost time: 0.8923740386962891
Epoch: 12, Steps: 64 | Train Loss: 0.1043025 Vali Loss: 0.2479734 Test Loss: 0.3076724
Validation loss decreased (0.255218 --> 0.247973).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 13 cost time: 0.9003968238830566
Epoch: 13, Steps: 64 | Train Loss: 0.1026601 Vali Loss: 0.2487399 Test Loss: 0.3055082
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 14 cost time: 0.9081368446350098
Epoch: 14, Steps: 64 | Train Loss: 0.1016935 Vali Loss: 0.2484974 Test Loss: 0.3044602
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 15 cost time: 0.8889999389648438
Epoch: 15, Steps: 64 | Train Loss: 0.1007087 Vali Loss: 0.2452688 Test Loss: 0.3034512
Validation loss decreased (0.247973 --> 0.245269).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 16 cost time: 0.8917067050933838
Epoch: 16, Steps: 64 | Train Loss: 0.1005922 Vali Loss: 0.2481527 Test Loss: 0.3039680
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 17 cost time: 0.885439395904541
Epoch: 17, Steps: 64 | Train Loss: 0.0997901 Vali Loss: 0.2452965 Test Loss: 0.3031086
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 18 cost time: 0.9082682132720947
Epoch: 18, Steps: 64 | Train Loss: 0.0979535 Vali Loss: 0.2414165 Test Loss: 0.3024137
Validation loss decreased (0.245269 --> 0.241416).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 19 cost time: 0.8917386531829834
Epoch: 19, Steps: 64 | Train Loss: 0.0981109 Vali Loss: 0.2398588 Test Loss: 0.3026049
Validation loss decreased (0.241416 --> 0.239859).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 20 cost time: 0.8977665901184082
Epoch: 20, Steps: 64 | Train Loss: 0.0974813 Vali Loss: 0.2398571 Test Loss: 0.3036882
Validation loss decreased (0.239859 --> 0.239857).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 21 cost time: 0.8980011940002441
Epoch: 21, Steps: 64 | Train Loss: 0.0973076 Vali Loss: 0.2374710 Test Loss: 0.3031223
Validation loss decreased (0.239857 --> 0.237471).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 22 cost time: 0.9016449451446533
Epoch: 22, Steps: 64 | Train Loss: 0.0963736 Vali Loss: 0.2383344 Test Loss: 0.3043364
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 23 cost time: 0.8956174850463867
Epoch: 23, Steps: 64 | Train Loss: 0.0958405 Vali Loss: 0.2368274 Test Loss: 0.3023288
Validation loss decreased (0.237471 --> 0.236827).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 24 cost time: 0.8954260349273682
Epoch: 24, Steps: 64 | Train Loss: 0.0958989 Vali Loss: 0.2392208 Test Loss: 0.3014982
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 25 cost time: 0.8904595375061035
Epoch: 25, Steps: 64 | Train Loss: 0.0956583 Vali Loss: 0.2385904 Test Loss: 0.3020240
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 26 cost time: 0.8877696990966797
Epoch: 26, Steps: 64 | Train Loss: 0.0950876 Vali Loss: 0.2382360 Test Loss: 0.3036026
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 27 cost time: 0.8893575668334961
Epoch: 27, Steps: 64 | Train Loss: 0.0955069 Vali Loss: 0.2382289 Test Loss: 0.3013635
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 28 cost time: 0.8916115760803223
Epoch: 28, Steps: 64 | Train Loss: 0.0945135 Vali Loss: 0.2382809 Test Loss: 0.3032826
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 29 cost time: 0.890397310256958
Epoch: 29, Steps: 64 | Train Loss: 0.0950765 Vali Loss: 0.2370929 Test Loss: 0.3020082
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 30 cost time: 0.8983404636383057
Epoch: 30, Steps: 64 | Train Loss: 0.0945430 Vali Loss: 0.2370895 Test Loss: 0.3029413
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 31 cost time: 0.8983592987060547
Epoch: 31, Steps: 64 | Train Loss: 0.0942546 Vali Loss: 0.2332201 Test Loss: 0.3022348
Validation loss decreased (0.236827 --> 0.233220).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 32 cost time: 0.9048726558685303
Epoch: 32, Steps: 64 | Train Loss: 0.0941035 Vali Loss: 0.2337334 Test Loss: 0.3021503
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 33 cost time: 0.8880007266998291
Epoch: 33, Steps: 64 | Train Loss: 0.0946659 Vali Loss: 0.2346143 Test Loss: 0.3023065
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 34 cost time: 0.8849999904632568
Epoch: 34, Steps: 64 | Train Loss: 0.0939579 Vali Loss: 0.2351179 Test Loss: 0.3028249
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 35 cost time: 0.8923413753509521
Epoch: 35, Steps: 64 | Train Loss: 0.0941708 Vali Loss: 0.2344593 Test Loss: 0.3034056
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 36 cost time: 0.9004149436950684
Epoch: 36, Steps: 64 | Train Loss: 0.0939284 Vali Loss: 0.2354458 Test Loss: 0.3030758
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 37 cost time: 0.892380952835083
Epoch: 37, Steps: 64 | Train Loss: 0.0933959 Vali Loss: 0.2336414 Test Loss: 0.3027366
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 38 cost time: 0.9038610458374023
Epoch: 38, Steps: 64 | Train Loss: 0.0937315 Vali Loss: 0.2345427 Test Loss: 0.3027849
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 39 cost time: 0.9000005722045898
Epoch: 39, Steps: 64 | Train Loss: 0.0938031 Vali Loss: 0.2335196 Test Loss: 0.3027567
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 40 cost time: 0.8953571319580078
Epoch: 40, Steps: 64 | Train Loss: 0.0937717 Vali Loss: 0.2315367 Test Loss: 0.3017917
Validation loss decreased (0.233220 --> 0.231537).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 41 cost time: 0.8936150074005127
Epoch: 41, Steps: 64 | Train Loss: 0.0939892 Vali Loss: 0.2317747 Test Loss: 0.3009269
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 42 cost time: 0.8874094486236572
Epoch: 42, Steps: 64 | Train Loss: 0.0935649 Vali Loss: 0.2318777 Test Loss: 0.3019224
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 43 cost time: 0.8973360061645508
Epoch: 43, Steps: 64 | Train Loss: 0.0935891 Vali Loss: 0.2331588 Test Loss: 0.3017370
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 44 cost time: 0.8903777599334717
Epoch: 44, Steps: 64 | Train Loss: 0.0938957 Vali Loss: 0.2319499 Test Loss: 0.3031526
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 45 cost time: 0.8876204490661621
Epoch: 45, Steps: 64 | Train Loss: 0.0934788 Vali Loss: 0.2358545 Test Loss: 0.3025761
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 46 cost time: 0.8890001773834229
Epoch: 46, Steps: 64 | Train Loss: 0.0935318 Vali Loss: 0.2292015 Test Loss: 0.3031288
Validation loss decreased (0.231537 --> 0.229201).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 47 cost time: 0.8926296234130859
Epoch: 47, Steps: 64 | Train Loss: 0.0929045 Vali Loss: 0.2316006 Test Loss: 0.3020546
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 48 cost time: 0.8943850994110107
Epoch: 48, Steps: 64 | Train Loss: 0.0930295 Vali Loss: 0.2337668 Test Loss: 0.3015683
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 49 cost time: 0.8874139785766602
Epoch: 49, Steps: 64 | Train Loss: 0.0936611 Vali Loss: 0.2341266 Test Loss: 0.3023290
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 50 cost time: 0.8994665145874023
Epoch: 50, Steps: 64 | Train Loss: 0.0930533 Vali Loss: 0.2339401 Test Loss: 0.3018595
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 51 cost time: 0.8897743225097656
Epoch: 51, Steps: 64 | Train Loss: 0.0935913 Vali Loss: 0.2324555 Test Loss: 0.3011850
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 52 cost time: 0.8910000324249268
Epoch: 52, Steps: 64 | Train Loss: 0.0932992 Vali Loss: 0.2323680 Test Loss: 0.3019316
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 53 cost time: 0.8894121646881104
Epoch: 53, Steps: 64 | Train Loss: 0.0928289 Vali Loss: 0.2323582 Test Loss: 0.3019483
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 54 cost time: 0.8851492404937744
Epoch: 54, Steps: 64 | Train Loss: 0.0932528 Vali Loss: 0.2328556 Test Loss: 0.3019213
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 55 cost time: 0.9033119678497314
Epoch: 55, Steps: 64 | Train Loss: 0.0929441 Vali Loss: 0.2316259 Test Loss: 0.3015061
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 56 cost time: 0.8984024524688721
Epoch: 56, Steps: 64 | Train Loss: 0.0930639 Vali Loss: 0.2321927 Test Loss: 0.3024262
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 57 cost time: 0.9047651290893555
Epoch: 57, Steps: 64 | Train Loss: 0.0932523 Vali Loss: 0.2302464 Test Loss: 0.3011250
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 58 cost time: 0.9003612995147705
Epoch: 58, Steps: 64 | Train Loss: 0.0926632 Vali Loss: 0.2330494 Test Loss: 0.3022106
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 59 cost time: 0.8986160755157471
Epoch: 59, Steps: 64 | Train Loss: 0.0927357 Vali Loss: 0.2321287 Test Loss: 0.3025602
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 60 cost time: 0.8863584995269775
Epoch: 60, Steps: 64 | Train Loss: 0.0929117 Vali Loss: 0.2301108 Test Loss: 0.3016479
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.3031288683414459, mae:0.37210798263549805, rse:0.25268906354904175
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.04910469055175781 GB
Epoch: 1 cost time: 2.300055980682373
Epoch: 1, Steps: 64 | Train Loss: 0.8713679 Vali Loss: 2.7001834 Test Loss: 4.8433466
Validation loss decreased (inf --> 2.700183).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 2 cost time: 0.947446346282959
Epoch: 2, Steps: 64 | Train Loss: 0.7260418 Vali Loss: 1.8119555 Test Loss: 3.1308720
Validation loss decreased (2.700183 --> 1.811955).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 3 cost time: 0.9181172847747803
Epoch: 3, Steps: 64 | Train Loss: 0.4714627 Vali Loss: 1.0604017 Test Loss: 1.7182159
Validation loss decreased (1.811955 --> 1.060402).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 4 cost time: 0.9238502979278564
Epoch: 4, Steps: 64 | Train Loss: 0.2645540 Vali Loss: 0.5526442 Test Loss: 0.8202494
Validation loss decreased (1.060402 --> 0.552644).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 5 cost time: 0.9210002422332764
Epoch: 5, Steps: 64 | Train Loss: 0.1539902 Vali Loss: 0.3235611 Test Loss: 0.4203520
Validation loss decreased (0.552644 --> 0.323561).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 6 cost time: 0.9096267223358154
Epoch: 6, Steps: 64 | Train Loss: 0.1191749 Vali Loss: 0.2657337 Test Loss: 0.3428958
Validation loss decreased (0.323561 --> 0.265734).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 7 cost time: 0.915992021560669
Epoch: 7, Steps: 64 | Train Loss: 0.1101561 Vali Loss: 0.2555767 Test Loss: 0.3150849
Validation loss decreased (0.265734 --> 0.255577).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 8 cost time: 0.9154210090637207
Epoch: 8, Steps: 64 | Train Loss: 0.1056704 Vali Loss: 0.2515822 Test Loss: 0.3058688
Validation loss decreased (0.255577 --> 0.251582).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 9 cost time: 0.9074370861053467
Epoch: 9, Steps: 64 | Train Loss: 0.1028314 Vali Loss: 0.2446125 Test Loss: 0.3132988
Validation loss decreased (0.251582 --> 0.244613).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 10 cost time: 0.9163944721221924
Epoch: 10, Steps: 64 | Train Loss: 0.1003825 Vali Loss: 0.2408867 Test Loss: 0.3078031
Validation loss decreased (0.244613 --> 0.240887).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 11 cost time: 0.9277899265289307
Epoch: 11, Steps: 64 | Train Loss: 0.0990097 Vali Loss: 0.2390577 Test Loss: 0.3081235
Validation loss decreased (0.240887 --> 0.239058).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 12 cost time: 0.9239997863769531
Epoch: 12, Steps: 64 | Train Loss: 0.0978647 Vali Loss: 0.2383351 Test Loss: 0.3082488
Validation loss decreased (0.239058 --> 0.238335).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 13 cost time: 0.917628288269043
Epoch: 13, Steps: 64 | Train Loss: 0.0960759 Vali Loss: 0.2401225 Test Loss: 0.3059365
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 14 cost time: 0.9153389930725098
Epoch: 14, Steps: 64 | Train Loss: 0.0948978 Vali Loss: 0.2397686 Test Loss: 0.3082798
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 15 cost time: 0.9237291812896729
Epoch: 15, Steps: 64 | Train Loss: 0.0941770 Vali Loss: 0.2364439 Test Loss: 0.3076121
Validation loss decreased (0.238335 --> 0.236444).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 16 cost time: 0.9124202728271484
Epoch: 16, Steps: 64 | Train Loss: 0.0933925 Vali Loss: 0.2368542 Test Loss: 0.3105974
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 17 cost time: 0.9207630157470703
Epoch: 17, Steps: 64 | Train Loss: 0.0930027 Vali Loss: 0.2310630 Test Loss: 0.3094027
Validation loss decreased (0.236444 --> 0.231063).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 18 cost time: 0.9177443981170654
Epoch: 18, Steps: 64 | Train Loss: 0.0924049 Vali Loss: 0.2337677 Test Loss: 0.3096446
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 19 cost time: 0.9220004081726074
Epoch: 19, Steps: 64 | Train Loss: 0.0918761 Vali Loss: 0.2329998 Test Loss: 0.3110103
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 20 cost time: 0.9179918766021729
Epoch: 20, Steps: 64 | Train Loss: 0.0909783 Vali Loss: 0.2332984 Test Loss: 0.3139934
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 21 cost time: 0.9175214767456055
Epoch: 21, Steps: 64 | Train Loss: 0.0904224 Vali Loss: 0.2333487 Test Loss: 0.3117586
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 22 cost time: 0.9209575653076172
Epoch: 22, Steps: 64 | Train Loss: 0.0902524 Vali Loss: 0.2307260 Test Loss: 0.3128849
Validation loss decreased (0.231063 --> 0.230726).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 23 cost time: 1.0114097595214844
Epoch: 23, Steps: 64 | Train Loss: 0.0896787 Vali Loss: 0.2263953 Test Loss: 0.3124475
Validation loss decreased (0.230726 --> 0.226395).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 24 cost time: 1.0184426307678223
Epoch: 24, Steps: 64 | Train Loss: 0.0892154 Vali Loss: 0.2291108 Test Loss: 0.3121433
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 25 cost time: 0.9503967761993408
Epoch: 25, Steps: 64 | Train Loss: 0.0893822 Vali Loss: 0.2324791 Test Loss: 0.3121270
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 26 cost time: 0.9091370105743408
Epoch: 26, Steps: 64 | Train Loss: 0.0889061 Vali Loss: 0.2305722 Test Loss: 0.3124713
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 27 cost time: 0.9119997024536133
Epoch: 27, Steps: 64 | Train Loss: 0.0887922 Vali Loss: 0.2289569 Test Loss: 0.3131655
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 28 cost time: 0.9264953136444092
Epoch: 28, Steps: 64 | Train Loss: 0.0883871 Vali Loss: 0.2269177 Test Loss: 0.3141053
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 29 cost time: 0.9216146469116211
Epoch: 29, Steps: 64 | Train Loss: 0.0885072 Vali Loss: 0.2296221 Test Loss: 0.3142308
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 30 cost time: 0.9063286781311035
Epoch: 30, Steps: 64 | Train Loss: 0.0884284 Vali Loss: 0.2257230 Test Loss: 0.3131521
Validation loss decreased (0.226395 --> 0.225723).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 31 cost time: 0.9194736480712891
Epoch: 31, Steps: 64 | Train Loss: 0.0882000 Vali Loss: 0.2271501 Test Loss: 0.3138202
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 32 cost time: 0.9310638904571533
Epoch: 32, Steps: 64 | Train Loss: 0.0879043 Vali Loss: 0.2249903 Test Loss: 0.3135073
Validation loss decreased (0.225723 --> 0.224990).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 33 cost time: 0.9063444137573242
Epoch: 33, Steps: 64 | Train Loss: 0.0879467 Vali Loss: 0.2249199 Test Loss: 0.3135459
Validation loss decreased (0.224990 --> 0.224920).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 34 cost time: 0.9120001792907715
Epoch: 34, Steps: 64 | Train Loss: 0.0880988 Vali Loss: 0.2269129 Test Loss: 0.3132673
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 35 cost time: 0.906625509262085
Epoch: 35, Steps: 64 | Train Loss: 0.0875421 Vali Loss: 0.2255948 Test Loss: 0.3135298
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 36 cost time: 0.9013690948486328
Epoch: 36, Steps: 64 | Train Loss: 0.0871782 Vali Loss: 0.2278570 Test Loss: 0.3136694
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 37 cost time: 0.9164202213287354
Epoch: 37, Steps: 64 | Train Loss: 0.0873068 Vali Loss: 0.2272335 Test Loss: 0.3135306
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 38 cost time: 0.9173641204833984
Epoch: 38, Steps: 64 | Train Loss: 0.0872508 Vali Loss: 0.2275208 Test Loss: 0.3131051
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 39 cost time: 0.9253745079040527
Epoch: 39, Steps: 64 | Train Loss: 0.0869378 Vali Loss: 0.2279899 Test Loss: 0.3156759
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 40 cost time: 0.9187769889831543
Epoch: 40, Steps: 64 | Train Loss: 0.0867637 Vali Loss: 0.2261683 Test Loss: 0.3141744
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 41 cost time: 0.9094502925872803
Epoch: 41, Steps: 64 | Train Loss: 0.0877394 Vali Loss: 0.2262407 Test Loss: 0.3126348
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 42 cost time: 0.9066252708435059
Epoch: 42, Steps: 64 | Train Loss: 0.0869440 Vali Loss: 0.2257388 Test Loss: 0.3140144
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 43 cost time: 0.8713967800140381
Epoch: 43, Steps: 64 | Train Loss: 0.0873714 Vali Loss: 0.2270698 Test Loss: 0.3147214
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 44 cost time: 0.9034249782562256
Epoch: 44, Steps: 64 | Train Loss: 0.0864945 Vali Loss: 0.2250491 Test Loss: 0.3133046
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 45 cost time: 0.9043388366699219
Epoch: 45, Steps: 64 | Train Loss: 0.0870233 Vali Loss: 0.2256611 Test Loss: 0.3133794
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 46 cost time: 0.910346269607544
Epoch: 46, Steps: 64 | Train Loss: 0.0864229 Vali Loss: 0.2283474 Test Loss: 0.3142860
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 47 cost time: 0.8928780555725098
Epoch: 47, Steps: 64 | Train Loss: 0.0871284 Vali Loss: 0.2250392 Test Loss: 0.3143181
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 48 cost time: 0.9196207523345947
Epoch: 48, Steps: 64 | Train Loss: 0.0869785 Vali Loss: 0.2259246 Test Loss: 0.3146488
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 49 cost time: 0.917637825012207
Epoch: 49, Steps: 64 | Train Loss: 0.0866856 Vali Loss: 0.2273189 Test Loss: 0.3133336
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 50 cost time: 0.8887448310852051
Epoch: 50, Steps: 64 | Train Loss: 0.0861899 Vali Loss: 0.2275617 Test Loss: 0.3141705
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 51 cost time: 0.9063868522644043
Epoch: 51, Steps: 64 | Train Loss: 0.0866659 Vali Loss: 0.2227670 Test Loss: 0.3143806
Validation loss decreased (0.224920 --> 0.222767).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 52 cost time: 0.9064836502075195
Epoch: 52, Steps: 64 | Train Loss: 0.0866556 Vali Loss: 0.2254451 Test Loss: 0.3134594
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 53 cost time: 0.9184091091156006
Epoch: 53, Steps: 64 | Train Loss: 0.0867649 Vali Loss: 0.2278749 Test Loss: 0.3154269
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 54 cost time: 0.9157810211181641
Epoch: 54, Steps: 64 | Train Loss: 0.0866455 Vali Loss: 0.2267674 Test Loss: 0.3152960
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 55 cost time: 0.9186201095581055
Epoch: 55, Steps: 64 | Train Loss: 0.0865164 Vali Loss: 0.2283283 Test Loss: 0.3165120
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 56 cost time: 0.9185941219329834
Epoch: 56, Steps: 64 | Train Loss: 0.0862861 Vali Loss: 0.2229089 Test Loss: 0.3139006
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 57 cost time: 0.9214725494384766
Epoch: 57, Steps: 64 | Train Loss: 0.0869263 Vali Loss: 0.2243013 Test Loss: 0.3142423
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 58 cost time: 0.9246978759765625
Epoch: 58, Steps: 64 | Train Loss: 0.0859228 Vali Loss: 0.2263387 Test Loss: 0.3148555
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 59 cost time: 0.9120006561279297
Epoch: 59, Steps: 64 | Train Loss: 0.0865077 Vali Loss: 0.2260323 Test Loss: 0.3152135
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 60 cost time: 0.9217875003814697
Epoch: 60, Steps: 64 | Train Loss: 0.0865375 Vali Loss: 0.2274084 Test Loss: 0.3147263
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.3143806755542755, mae:0.3896089792251587, rse:0.2573361098766327
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.048000335693359375 GB
Epoch: 1 cost time: 2.3381643295288086
Epoch: 1, Steps: 64 | Train Loss: 1.0350176 Vali Loss: 2.6973877 Test Loss: 4.8005838
Validation loss decreased (inf --> 2.697388).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 2 cost time: 0.9576046466827393
Epoch: 2, Steps: 64 | Train Loss: 0.5857609 Vali Loss: 0.8934534 Test Loss: 1.3171347
Validation loss decreased (2.697388 --> 0.893453).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 3 cost time: 0.9615962505340576
Epoch: 3, Steps: 64 | Train Loss: 0.3254131 Vali Loss: 0.7225494 Test Loss: 0.9944302
Validation loss decreased (0.893453 --> 0.722549).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 4 cost time: 1.0227892398834229
Epoch: 4, Steps: 64 | Train Loss: 0.2513056 Vali Loss: 0.5892285 Test Loss: 0.7824254
Validation loss decreased (0.722549 --> 0.589229).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 5 cost time: 1.0325958728790283
Epoch: 5, Steps: 64 | Train Loss: 0.2100782 Vali Loss: 0.4909625 Test Loss: 0.6297315
Validation loss decreased (0.589229 --> 0.490962).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 6 cost time: 0.9534063339233398
Epoch: 6, Steps: 64 | Train Loss: 0.1837680 Vali Loss: 0.4293021 Test Loss: 0.5459043
Validation loss decreased (0.490962 --> 0.429302).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 7 cost time: 0.9067409038543701
Epoch: 7, Steps: 64 | Train Loss: 0.1662359 Vali Loss: 0.3781961 Test Loss: 0.4746075
Validation loss decreased (0.429302 --> 0.378196).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 8 cost time: 0.9314248561859131
Epoch: 8, Steps: 64 | Train Loss: 0.1541291 Vali Loss: 0.3504084 Test Loss: 0.4323522
Validation loss decreased (0.378196 --> 0.350408).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 9 cost time: 0.9283807277679443
Epoch: 9, Steps: 64 | Train Loss: 0.1455704 Vali Loss: 0.3265066 Test Loss: 0.4012096
Validation loss decreased (0.350408 --> 0.326507).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 10 cost time: 0.9497597217559814
Epoch: 10, Steps: 64 | Train Loss: 0.1390453 Vali Loss: 0.3126469 Test Loss: 0.3767952
Validation loss decreased (0.326507 --> 0.312647).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 11 cost time: 0.9367470741271973
Epoch: 11, Steps: 64 | Train Loss: 0.1354345 Vali Loss: 0.2992191 Test Loss: 0.3638608
Validation loss decreased (0.312647 --> 0.299219).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 12 cost time: 0.9374043941497803
Epoch: 12, Steps: 64 | Train Loss: 0.1310788 Vali Loss: 0.2877380 Test Loss: 0.3502747
Validation loss decreased (0.299219 --> 0.287738).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 13 cost time: 0.9466347694396973
Epoch: 13, Steps: 64 | Train Loss: 0.1288431 Vali Loss: 0.2758329 Test Loss: 0.3408240
Validation loss decreased (0.287738 --> 0.275833).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 14 cost time: 0.9296176433563232
Epoch: 14, Steps: 64 | Train Loss: 0.1261898 Vali Loss: 0.2750826 Test Loss: 0.3337883
Validation loss decreased (0.275833 --> 0.275083).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 15 cost time: 0.9263520240783691
Epoch: 15, Steps: 64 | Train Loss: 0.1246755 Vali Loss: 0.2704861 Test Loss: 0.3287395
Validation loss decreased (0.275083 --> 0.270486).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 16 cost time: 0.9342119693756104
Epoch: 16, Steps: 64 | Train Loss: 0.1224517 Vali Loss: 0.2631929 Test Loss: 0.3225860
Validation loss decreased (0.270486 --> 0.263193).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 17 cost time: 0.9403400421142578
Epoch: 17, Steps: 64 | Train Loss: 0.1213602 Vali Loss: 0.2629049 Test Loss: 0.3178361
Validation loss decreased (0.263193 --> 0.262905).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 18 cost time: 0.9374163150787354
Epoch: 18, Steps: 64 | Train Loss: 0.1198842 Vali Loss: 0.2644073 Test Loss: 0.3200157
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 19 cost time: 0.9387543201446533
Epoch: 19, Steps: 64 | Train Loss: 0.1185568 Vali Loss: 0.2601519 Test Loss: 0.3145320
Validation loss decreased (0.262905 --> 0.260152).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 20 cost time: 0.9509992599487305
Epoch: 20, Steps: 64 | Train Loss: 0.1181463 Vali Loss: 0.2602403 Test Loss: 0.3134401
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 21 cost time: 0.9426286220550537
Epoch: 21, Steps: 64 | Train Loss: 0.1176571 Vali Loss: 0.2554300 Test Loss: 0.3124552
Validation loss decreased (0.260152 --> 0.255430).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 22 cost time: 0.935626745223999
Epoch: 22, Steps: 64 | Train Loss: 0.1168095 Vali Loss: 0.2549945 Test Loss: 0.3108260
Validation loss decreased (0.255430 --> 0.254994).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 23 cost time: 0.9324190616607666
Epoch: 23, Steps: 64 | Train Loss: 0.1168306 Vali Loss: 0.2534559 Test Loss: 0.3114201
Validation loss decreased (0.254994 --> 0.253456).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 24 cost time: 0.9148399829864502
Epoch: 24, Steps: 64 | Train Loss: 0.1159485 Vali Loss: 0.2536779 Test Loss: 0.3108691
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 25 cost time: 0.9257297515869141
Epoch: 25, Steps: 64 | Train Loss: 0.1143048 Vali Loss: 0.2520733 Test Loss: 0.3103322
Validation loss decreased (0.253456 --> 0.252073).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 26 cost time: 0.9263651371002197
Epoch: 26, Steps: 64 | Train Loss: 0.1145093 Vali Loss: 0.2493503 Test Loss: 0.3076553
Validation loss decreased (0.252073 --> 0.249350).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 27 cost time: 0.928734302520752
Epoch: 27, Steps: 64 | Train Loss: 0.1139555 Vali Loss: 0.2487867 Test Loss: 0.3064777
Validation loss decreased (0.249350 --> 0.248787).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 28 cost time: 0.9349997043609619
Epoch: 28, Steps: 64 | Train Loss: 0.1137640 Vali Loss: 0.2536666 Test Loss: 0.3068348
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 29 cost time: 0.9393975734710693
Epoch: 29, Steps: 64 | Train Loss: 0.1133902 Vali Loss: 0.2518024 Test Loss: 0.3055075
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 30 cost time: 0.9255890846252441
Epoch: 30, Steps: 64 | Train Loss: 0.1136429 Vali Loss: 0.2471903 Test Loss: 0.3039273
Validation loss decreased (0.248787 --> 0.247190).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 31 cost time: 0.9312305450439453
Epoch: 31, Steps: 64 | Train Loss: 0.1132860 Vali Loss: 0.2502208 Test Loss: 0.3048530
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 32 cost time: 0.9213993549346924
Epoch: 32, Steps: 64 | Train Loss: 0.1126092 Vali Loss: 0.2487426 Test Loss: 0.3053028
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 33 cost time: 0.9234027862548828
Epoch: 33, Steps: 64 | Train Loss: 0.1118467 Vali Loss: 0.2470264 Test Loss: 0.3050913
Validation loss decreased (0.247190 --> 0.247026).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 34 cost time: 0.933330774307251
Epoch: 34, Steps: 64 | Train Loss: 0.1123870 Vali Loss: 0.2463183 Test Loss: 0.3057030
Validation loss decreased (0.247026 --> 0.246318).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 35 cost time: 0.9250941276550293
Epoch: 35, Steps: 64 | Train Loss: 0.1120998 Vali Loss: 0.2472426 Test Loss: 0.3050575
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 36 cost time: 0.935999870300293
Epoch: 36, Steps: 64 | Train Loss: 0.1114324 Vali Loss: 0.2473249 Test Loss: 0.3029746
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 37 cost time: 0.9523899555206299
Epoch: 37, Steps: 64 | Train Loss: 0.1115870 Vali Loss: 0.2483588 Test Loss: 0.3048995
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 38 cost time: 0.9406173229217529
Epoch: 38, Steps: 64 | Train Loss: 0.1117768 Vali Loss: 0.2458193 Test Loss: 0.3034101
Validation loss decreased (0.246318 --> 0.245819).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 39 cost time: 0.942319393157959
Epoch: 39, Steps: 64 | Train Loss: 0.1112788 Vali Loss: 0.2481065 Test Loss: 0.3017304
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 40 cost time: 0.9243834018707275
Epoch: 40, Steps: 64 | Train Loss: 0.1110938 Vali Loss: 0.2445288 Test Loss: 0.3017934
Validation loss decreased (0.245819 --> 0.244529).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 41 cost time: 0.9193620681762695
Epoch: 41, Steps: 64 | Train Loss: 0.1114283 Vali Loss: 0.2455273 Test Loss: 0.3015578
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 42 cost time: 0.9209496974945068
Epoch: 42, Steps: 64 | Train Loss: 0.1110383 Vali Loss: 0.2430921 Test Loss: 0.3029195
Validation loss decreased (0.244529 --> 0.243092).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 43 cost time: 0.9227292537689209
Epoch: 43, Steps: 64 | Train Loss: 0.1112541 Vali Loss: 0.2452875 Test Loss: 0.3034036
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 44 cost time: 0.9219999313354492
Epoch: 44, Steps: 64 | Train Loss: 0.1102782 Vali Loss: 0.2456317 Test Loss: 0.3027976
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 45 cost time: 0.9436287879943848
Epoch: 45, Steps: 64 | Train Loss: 0.1116074 Vali Loss: 0.2443503 Test Loss: 0.3030334
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 46 cost time: 0.9376199245452881
Epoch: 46, Steps: 64 | Train Loss: 0.1108367 Vali Loss: 0.2478028 Test Loss: 0.3041197
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 47 cost time: 0.937371015548706
Epoch: 47, Steps: 64 | Train Loss: 0.1112752 Vali Loss: 0.2465375 Test Loss: 0.3045743
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 48 cost time: 0.9433889389038086
Epoch: 48, Steps: 64 | Train Loss: 0.1108098 Vali Loss: 0.2433135 Test Loss: 0.3003896
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 49 cost time: 0.9243626594543457
Epoch: 49, Steps: 64 | Train Loss: 0.1101413 Vali Loss: 0.2468640 Test Loss: 0.3033054
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 50 cost time: 0.9231443405151367
Epoch: 50, Steps: 64 | Train Loss: 0.1108920 Vali Loss: 0.2431160 Test Loss: 0.3013367
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 51 cost time: 0.9397141933441162
Epoch: 51, Steps: 64 | Train Loss: 0.1112098 Vali Loss: 0.2443879 Test Loss: 0.3020893
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 52 cost time: 0.9359991550445557
Epoch: 52, Steps: 64 | Train Loss: 0.1107361 Vali Loss: 0.2460058 Test Loss: 0.3015149
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 53 cost time: 0.9380004405975342
Epoch: 53, Steps: 64 | Train Loss: 0.1105559 Vali Loss: 0.2423472 Test Loss: 0.3025602
Validation loss decreased (0.243092 --> 0.242347).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 54 cost time: 0.9500796794891357
Epoch: 54, Steps: 64 | Train Loss: 0.1107379 Vali Loss: 0.2413757 Test Loss: 0.3025963
Validation loss decreased (0.242347 --> 0.241376).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 55 cost time: 1.0325307846069336
Epoch: 55, Steps: 64 | Train Loss: 0.1101897 Vali Loss: 0.2463924 Test Loss: 0.3030589
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 56 cost time: 1.028404712677002
Epoch: 56, Steps: 64 | Train Loss: 0.1105452 Vali Loss: 0.2431442 Test Loss: 0.3020522
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 57 cost time: 1.0334036350250244
Epoch: 57, Steps: 64 | Train Loss: 0.1113160 Vali Loss: 0.2430554 Test Loss: 0.3027214
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 58 cost time: 0.923992395401001
Epoch: 58, Steps: 64 | Train Loss: 0.1103056 Vali Loss: 0.2447919 Test Loss: 0.3016716
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 59 cost time: 0.9283673763275146
Epoch: 59, Steps: 64 | Train Loss: 0.1101202 Vali Loss: 0.2464144 Test Loss: 0.3010821
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 60 cost time: 0.9214200973510742
Epoch: 60, Steps: 64 | Train Loss: 0.1099461 Vali Loss: 0.2425706 Test Loss: 0.3020588
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.3025963008403778, mae:0.36578962206840515, rse:0.25246697664260864
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.04870176315307617 GB
Epoch: 1 cost time: 2.3407182693481445
Epoch: 1, Steps: 64 | Train Loss: 0.8572527 Vali Loss: 2.5949855 Test Loss: 4.5035148
Validation loss decreased (inf --> 2.594985).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 2 cost time: 0.9327125549316406
Epoch: 2, Steps: 64 | Train Loss: 0.5897095 Vali Loss: 1.1256292 Test Loss: 1.7971520
Validation loss decreased (2.594985 --> 1.125629).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 3 cost time: 0.9753854274749756
Epoch: 3, Steps: 64 | Train Loss: 0.3034036 Vali Loss: 0.6393418 Test Loss: 0.9243974
Validation loss decreased (1.125629 --> 0.639342).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 4 cost time: 0.9745461940765381
Epoch: 4, Steps: 64 | Train Loss: 0.1824768 Vali Loss: 0.4092395 Test Loss: 0.5372276
Validation loss decreased (0.639342 --> 0.409240).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 5 cost time: 0.9636087417602539
Epoch: 5, Steps: 64 | Train Loss: 0.1377613 Vali Loss: 0.3228790 Test Loss: 0.4014912
Validation loss decreased (0.409240 --> 0.322879).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 6 cost time: 0.9574418067932129
Epoch: 6, Steps: 64 | Train Loss: 0.1224364 Vali Loss: 0.2903704 Test Loss: 0.3546829
Validation loss decreased (0.322879 --> 0.290370).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 7 cost time: 0.971998929977417
Epoch: 7, Steps: 64 | Train Loss: 0.1163903 Vali Loss: 0.2803614 Test Loss: 0.3360826
Validation loss decreased (0.290370 --> 0.280361).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 8 cost time: 0.9612827301025391
Epoch: 8, Steps: 64 | Train Loss: 0.1120717 Vali Loss: 0.2737840 Test Loss: 0.3261850
Validation loss decreased (0.280361 --> 0.273784).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 9 cost time: 0.9594118595123291
Epoch: 9, Steps: 64 | Train Loss: 0.1087878 Vali Loss: 0.2641415 Test Loss: 0.3169759
Validation loss decreased (0.273784 --> 0.264141).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 10 cost time: 0.9753491878509521
Epoch: 10, Steps: 64 | Train Loss: 0.1060503 Vali Loss: 0.2626072 Test Loss: 0.3149621
Validation loss decreased (0.264141 --> 0.262607).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 11 cost time: 0.979424238204956
Epoch: 11, Steps: 64 | Train Loss: 0.1041320 Vali Loss: 0.2615562 Test Loss: 0.3136586
Validation loss decreased (0.262607 --> 0.261556).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 12 cost time: 0.9793403148651123
Epoch: 12, Steps: 64 | Train Loss: 0.1025822 Vali Loss: 0.2590853 Test Loss: 0.3099205
Validation loss decreased (0.261556 --> 0.259085).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 13 cost time: 0.9777243137359619
Epoch: 13, Steps: 64 | Train Loss: 0.1010784 Vali Loss: 0.2561881 Test Loss: 0.3074929
Validation loss decreased (0.259085 --> 0.256188).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 14 cost time: 0.9729998111724854
Epoch: 14, Steps: 64 | Train Loss: 0.1000113 Vali Loss: 0.2547151 Test Loss: 0.3073021
Validation loss decreased (0.256188 --> 0.254715).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 15 cost time: 0.9640002250671387
Epoch: 15, Steps: 64 | Train Loss: 0.0990786 Vali Loss: 0.2526106 Test Loss: 0.3063844
Validation loss decreased (0.254715 --> 0.252611).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 16 cost time: 0.9606139659881592
Epoch: 16, Steps: 64 | Train Loss: 0.0982038 Vali Loss: 0.2514610 Test Loss: 0.3046617
Validation loss decreased (0.252611 --> 0.251461).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 17 cost time: 0.9663593769073486
Epoch: 17, Steps: 64 | Train Loss: 0.0976003 Vali Loss: 0.2511235 Test Loss: 0.3038902
Validation loss decreased (0.251461 --> 0.251123).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 18 cost time: 0.9703989028930664
Epoch: 18, Steps: 64 | Train Loss: 0.0966600 Vali Loss: 0.2494840 Test Loss: 0.3050354
Validation loss decreased (0.251123 --> 0.249484).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 19 cost time: 0.9723601341247559
Epoch: 19, Steps: 64 | Train Loss: 0.0966560 Vali Loss: 0.2474089 Test Loss: 0.3029385
Validation loss decreased (0.249484 --> 0.247409).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 20 cost time: 0.9744870662689209
Epoch: 20, Steps: 64 | Train Loss: 0.0962007 Vali Loss: 0.2468908 Test Loss: 0.3031911
Validation loss decreased (0.247409 --> 0.246891).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 21 cost time: 0.9375536441802979
Epoch: 21, Steps: 64 | Train Loss: 0.0953595 Vali Loss: 0.2449211 Test Loss: 0.3023051
Validation loss decreased (0.246891 --> 0.244921).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 22 cost time: 0.958343505859375
Epoch: 22, Steps: 64 | Train Loss: 0.0949245 Vali Loss: 0.2448433 Test Loss: 0.3016832
Validation loss decreased (0.244921 --> 0.244843).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 23 cost time: 0.9587094783782959
Epoch: 23, Steps: 64 | Train Loss: 0.0949001 Vali Loss: 0.2422520 Test Loss: 0.3014131
Validation loss decreased (0.244843 --> 0.242252).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 24 cost time: 0.9601774215698242
Epoch: 24, Steps: 64 | Train Loss: 0.0945935 Vali Loss: 0.2445109 Test Loss: 0.3013121
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 25 cost time: 0.9569995403289795
Epoch: 25, Steps: 64 | Train Loss: 0.0943832 Vali Loss: 0.2457726 Test Loss: 0.3016322
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 26 cost time: 0.9666180610656738
Epoch: 26, Steps: 64 | Train Loss: 0.0940842 Vali Loss: 0.2420011 Test Loss: 0.3011083
Validation loss decreased (0.242252 --> 0.242001).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 27 cost time: 0.9776082038879395
Epoch: 27, Steps: 64 | Train Loss: 0.0932376 Vali Loss: 0.2424136 Test Loss: 0.3011835
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 28 cost time: 0.9369769096374512
Epoch: 28, Steps: 64 | Train Loss: 0.0930150 Vali Loss: 0.2423488 Test Loss: 0.3025737
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 29 cost time: 0.971386194229126
Epoch: 29, Steps: 64 | Train Loss: 0.0937128 Vali Loss: 0.2419940 Test Loss: 0.3012362
Validation loss decreased (0.242001 --> 0.241994).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 30 cost time: 0.9733562469482422
Epoch: 30, Steps: 64 | Train Loss: 0.0934249 Vali Loss: 0.2405433 Test Loss: 0.3007225
Validation loss decreased (0.241994 --> 0.240543).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 31 cost time: 0.9617908000946045
Epoch: 31, Steps: 64 | Train Loss: 0.0927610 Vali Loss: 0.2422907 Test Loss: 0.3012164
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 32 cost time: 0.9654264450073242
Epoch: 32, Steps: 64 | Train Loss: 0.0929978 Vali Loss: 0.2392688 Test Loss: 0.3011716
Validation loss decreased (0.240543 --> 0.239269).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 33 cost time: 0.9607570171356201
Epoch: 33, Steps: 64 | Train Loss: 0.0931173 Vali Loss: 0.2413365 Test Loss: 0.3003398
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 34 cost time: 0.973862886428833
Epoch: 34, Steps: 64 | Train Loss: 0.0930792 Vali Loss: 0.2398733 Test Loss: 0.3011229
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 35 cost time: 0.9676392078399658
Epoch: 35, Steps: 64 | Train Loss: 0.0925602 Vali Loss: 0.2435861 Test Loss: 0.3013210
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 36 cost time: 0.9680154323577881
Epoch: 36, Steps: 64 | Train Loss: 0.0926181 Vali Loss: 0.2405279 Test Loss: 0.3013821
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 37 cost time: 0.9836382865905762
Epoch: 37, Steps: 64 | Train Loss: 0.0923187 Vali Loss: 0.2401161 Test Loss: 0.3015102
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 38 cost time: 0.9714887142181396
Epoch: 38, Steps: 64 | Train Loss: 0.0924768 Vali Loss: 0.2424522 Test Loss: 0.3006677
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 39 cost time: 0.9617016315460205
Epoch: 39, Steps: 64 | Train Loss: 0.0921660 Vali Loss: 0.2394042 Test Loss: 0.3020085
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 40 cost time: 0.9580693244934082
Epoch: 40, Steps: 64 | Train Loss: 0.0922107 Vali Loss: 0.2417474 Test Loss: 0.3022124
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 41 cost time: 0.9603681564331055
Epoch: 41, Steps: 64 | Train Loss: 0.0924013 Vali Loss: 0.2397853 Test Loss: 0.3014884
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 42 cost time: 0.9633536338806152
Epoch: 42, Steps: 64 | Train Loss: 0.0919053 Vali Loss: 0.2373768 Test Loss: 0.3009122
Validation loss decreased (0.239269 --> 0.237377).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 43 cost time: 0.9613678455352783
Epoch: 43, Steps: 64 | Train Loss: 0.0917045 Vali Loss: 0.2358389 Test Loss: 0.3020010
Validation loss decreased (0.237377 --> 0.235839).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 44 cost time: 0.9538321495056152
Epoch: 44, Steps: 64 | Train Loss: 0.0925906 Vali Loss: 0.2376719 Test Loss: 0.3013529
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 45 cost time: 0.9690005779266357
Epoch: 45, Steps: 64 | Train Loss: 0.0919654 Vali Loss: 0.2411612 Test Loss: 0.3012864
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 46 cost time: 0.9689998626708984
Epoch: 46, Steps: 64 | Train Loss: 0.0918366 Vali Loss: 0.2407164 Test Loss: 0.3012601
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 47 cost time: 0.971635103225708
Epoch: 47, Steps: 64 | Train Loss: 0.0919087 Vali Loss: 0.2407635 Test Loss: 0.3015557
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 48 cost time: 0.9233622550964355
Epoch: 48, Steps: 64 | Train Loss: 0.0919570 Vali Loss: 0.2403067 Test Loss: 0.3007453
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 49 cost time: 0.9634158611297607
Epoch: 49, Steps: 64 | Train Loss: 0.0912737 Vali Loss: 0.2425460 Test Loss: 0.3017077
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 50 cost time: 0.9619462490081787
Epoch: 50, Steps: 64 | Train Loss: 0.0915642 Vali Loss: 0.2414951 Test Loss: 0.3014474
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 51 cost time: 0.9668409824371338
Epoch: 51, Steps: 64 | Train Loss: 0.0918537 Vali Loss: 0.2388660 Test Loss: 0.3007431
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 52 cost time: 0.9714031219482422
Epoch: 52, Steps: 64 | Train Loss: 0.0909134 Vali Loss: 0.2364166 Test Loss: 0.3003581
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 53 cost time: 0.9939916133880615
Epoch: 53, Steps: 64 | Train Loss: 0.0916361 Vali Loss: 0.2362524 Test Loss: 0.3002964
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 54 cost time: 0.986823558807373
Epoch: 54, Steps: 64 | Train Loss: 0.0915742 Vali Loss: 0.2360721 Test Loss: 0.3011011
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 55 cost time: 0.9840002059936523
Epoch: 55, Steps: 64 | Train Loss: 0.0912454 Vali Loss: 0.2412111 Test Loss: 0.3014567
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 56 cost time: 0.9630005359649658
Epoch: 56, Steps: 64 | Train Loss: 0.0918655 Vali Loss: 0.2399792 Test Loss: 0.3001940
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 57 cost time: 0.9746253490447998
Epoch: 57, Steps: 64 | Train Loss: 0.0914059 Vali Loss: 0.2397234 Test Loss: 0.3017683
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 58 cost time: 0.9643704891204834
Epoch: 58, Steps: 64 | Train Loss: 0.0916245 Vali Loss: 0.2382680 Test Loss: 0.3015364
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 59 cost time: 0.9593560695648193
Epoch: 59, Steps: 64 | Train Loss: 0.0917328 Vali Loss: 0.2397173 Test Loss: 0.3010702
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 60 cost time: 0.973505973815918
Epoch: 60, Steps: 64 | Train Loss: 0.0914870 Vali Loss: 0.2405755 Test Loss: 0.3009234
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.302001029253006, mae:0.3748907744884491, rse:0.2522185146808624
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.04926586151123047 GB
Epoch: 1 cost time: 2.379748582839966
Epoch: 1, Steps: 64 | Train Loss: 0.8574309 Vali Loss: 2.5704045 Test Loss: 4.5336771
Validation loss decreased (inf --> 2.570405).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 2 cost time: 0.9981565475463867
Epoch: 2, Steps: 64 | Train Loss: 0.5819372 Vali Loss: 1.1167074 Test Loss: 1.7921482
Validation loss decreased (2.570405 --> 1.116707).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 3 cost time: 0.9960479736328125
Epoch: 3, Steps: 64 | Train Loss: 0.2941090 Vali Loss: 0.6081035 Test Loss: 0.8857905
Validation loss decreased (1.116707 --> 0.608104).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 4 cost time: 0.9983665943145752
Epoch: 4, Steps: 64 | Train Loss: 0.1739881 Vali Loss: 0.3692055 Test Loss: 0.4737048
Validation loss decreased (0.608104 --> 0.369206).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 5 cost time: 0.9961934089660645
Epoch: 5, Steps: 64 | Train Loss: 0.1319048 Vali Loss: 0.2890670 Test Loss: 0.3474247
Validation loss decreased (0.369206 --> 0.289067).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 6 cost time: 0.990314245223999
Epoch: 6, Steps: 64 | Train Loss: 0.1192461 Vali Loss: 0.2774086 Test Loss: 0.3261996
Validation loss decreased (0.289067 --> 0.277409).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 7 cost time: 0.9880661964416504
Epoch: 7, Steps: 64 | Train Loss: 0.1133405 Vali Loss: 0.2669438 Test Loss: 0.3124842
Validation loss decreased (0.277409 --> 0.266944).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 8 cost time: 0.9830002784729004
Epoch: 8, Steps: 64 | Train Loss: 0.1101493 Vali Loss: 0.2604257 Test Loss: 0.3063918
Validation loss decreased (0.266944 --> 0.260426).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 9 cost time: 0.9729979038238525
Epoch: 9, Steps: 64 | Train Loss: 0.1071577 Vali Loss: 0.2568696 Test Loss: 0.2979255
Validation loss decreased (0.260426 --> 0.256870).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 10 cost time: 1.0066168308258057
Epoch: 10, Steps: 64 | Train Loss: 0.1056369 Vali Loss: 0.2542856 Test Loss: 0.3006644
Validation loss decreased (0.256870 --> 0.254286).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 11 cost time: 0.995614767074585
Epoch: 11, Steps: 64 | Train Loss: 0.1030337 Vali Loss: 0.2516113 Test Loss: 0.2966897
Validation loss decreased (0.254286 --> 0.251611).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 12 cost time: 0.9973649978637695
Epoch: 12, Steps: 64 | Train Loss: 0.1021494 Vali Loss: 0.2503828 Test Loss: 0.2979356
Validation loss decreased (0.251611 --> 0.250383).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 13 cost time: 1.0044634342193604
Epoch: 13, Steps: 64 | Train Loss: 0.1006001 Vali Loss: 0.2472372 Test Loss: 0.2979895
Validation loss decreased (0.250383 --> 0.247237).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 14 cost time: 0.9794197082519531
Epoch: 14, Steps: 64 | Train Loss: 0.0992875 Vali Loss: 0.2504827 Test Loss: 0.2993564
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 15 cost time: 0.9815194606781006
Epoch: 15, Steps: 64 | Train Loss: 0.0990100 Vali Loss: 0.2462065 Test Loss: 0.2953538
Validation loss decreased (0.247237 --> 0.246207).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 16 cost time: 1.0042986869812012
Epoch: 16, Steps: 64 | Train Loss: 0.0982193 Vali Loss: 0.2437818 Test Loss: 0.2962579
Validation loss decreased (0.246207 --> 0.243782).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 17 cost time: 1.0898571014404297
Epoch: 17, Steps: 64 | Train Loss: 0.0969934 Vali Loss: 0.2422237 Test Loss: 0.2960657
Validation loss decreased (0.243782 --> 0.242224).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 18 cost time: 1.0807199478149414
Epoch: 18, Steps: 64 | Train Loss: 0.0963825 Vali Loss: 0.2472728 Test Loss: 0.2980497
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 19 cost time: 0.9949629306793213
Epoch: 19, Steps: 64 | Train Loss: 0.0964881 Vali Loss: 0.2437677 Test Loss: 0.2991101
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 20 cost time: 0.9923970699310303
Epoch: 20, Steps: 64 | Train Loss: 0.0955457 Vali Loss: 0.2451639 Test Loss: 0.2992751
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 21 cost time: 0.992992639541626
Epoch: 21, Steps: 64 | Train Loss: 0.0954175 Vali Loss: 0.2463349 Test Loss: 0.2974426
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 22 cost time: 0.9843401908874512
Epoch: 22, Steps: 64 | Train Loss: 0.0946932 Vali Loss: 0.2424644 Test Loss: 0.2997540
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 23 cost time: 0.984992504119873
Epoch: 23, Steps: 64 | Train Loss: 0.0945411 Vali Loss: 0.2418398 Test Loss: 0.2963900
Validation loss decreased (0.242224 --> 0.241840).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 24 cost time: 0.9836122989654541
Epoch: 24, Steps: 64 | Train Loss: 0.0944194 Vali Loss: 0.2415524 Test Loss: 0.2982492
Validation loss decreased (0.241840 --> 0.241552).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 25 cost time: 0.9776339530944824
Epoch: 25, Steps: 64 | Train Loss: 0.0937086 Vali Loss: 0.2385216 Test Loss: 0.2964548
Validation loss decreased (0.241552 --> 0.238522).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 26 cost time: 0.9811897277832031
Epoch: 26, Steps: 64 | Train Loss: 0.0938815 Vali Loss: 0.2409685 Test Loss: 0.2979978
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 27 cost time: 0.9963502883911133
Epoch: 27, Steps: 64 | Train Loss: 0.0933783 Vali Loss: 0.2417915 Test Loss: 0.2970805
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 28 cost time: 0.9922301769256592
Epoch: 28, Steps: 64 | Train Loss: 0.0934505 Vali Loss: 0.2395121 Test Loss: 0.2984715
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 29 cost time: 1.0034918785095215
Epoch: 29, Steps: 64 | Train Loss: 0.0931063 Vali Loss: 0.2406193 Test Loss: 0.2977116
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 30 cost time: 0.9913554191589355
Epoch: 30, Steps: 64 | Train Loss: 0.0929156 Vali Loss: 0.2391616 Test Loss: 0.2980118
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 31 cost time: 0.9883744716644287
Epoch: 31, Steps: 64 | Train Loss: 0.0928157 Vali Loss: 0.2431225 Test Loss: 0.2979852
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 32 cost time: 0.9879505634307861
Epoch: 32, Steps: 64 | Train Loss: 0.0929454 Vali Loss: 0.2443879 Test Loss: 0.2977364
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 33 cost time: 1.0022845268249512
Epoch: 33, Steps: 64 | Train Loss: 0.0921701 Vali Loss: 0.2406774 Test Loss: 0.2983253
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 34 cost time: 1.0114474296569824
Epoch: 34, Steps: 64 | Train Loss: 0.0929451 Vali Loss: 0.2414891 Test Loss: 0.2974086
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 35 cost time: 1.0187175273895264
Epoch: 35, Steps: 64 | Train Loss: 0.0925732 Vali Loss: 0.2431568 Test Loss: 0.2991370
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 36 cost time: 1.0225856304168701
Epoch: 36, Steps: 64 | Train Loss: 0.0922935 Vali Loss: 0.2418104 Test Loss: 0.2977953
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 37 cost time: 1.0177054405212402
Epoch: 37, Steps: 64 | Train Loss: 0.0919722 Vali Loss: 0.2389616 Test Loss: 0.2976922
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 38 cost time: 1.0189111232757568
Epoch: 38, Steps: 64 | Train Loss: 0.0913875 Vali Loss: 0.2429132 Test Loss: 0.2990457
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 39 cost time: 1.0010013580322266
Epoch: 39, Steps: 64 | Train Loss: 0.0919628 Vali Loss: 0.2411653 Test Loss: 0.2985586
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 40 cost time: 0.9632077217102051
Epoch: 40, Steps: 64 | Train Loss: 0.0917757 Vali Loss: 0.2444372 Test Loss: 0.2990770
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 41 cost time: 0.9864668846130371
Epoch: 41, Steps: 64 | Train Loss: 0.0917524 Vali Loss: 0.2397076 Test Loss: 0.2975233
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 42 cost time: 0.9813604354858398
Epoch: 42, Steps: 64 | Train Loss: 0.0919071 Vali Loss: 0.2399464 Test Loss: 0.2975659
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 43 cost time: 0.994356632232666
Epoch: 43, Steps: 64 | Train Loss: 0.0917159 Vali Loss: 0.2400430 Test Loss: 0.2984527
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 44 cost time: 0.9960677623748779
Epoch: 44, Steps: 64 | Train Loss: 0.0920386 Vali Loss: 0.2409649 Test Loss: 0.2977926
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 45 cost time: 1.0073144435882568
Epoch: 45, Steps: 64 | Train Loss: 0.0917886 Vali Loss: 0.2413413 Test Loss: 0.2996309
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 46 cost time: 0.9764201641082764
Epoch: 46, Steps: 64 | Train Loss: 0.0914363 Vali Loss: 0.2394194 Test Loss: 0.2981221
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 47 cost time: 0.9697756767272949
Epoch: 47, Steps: 64 | Train Loss: 0.0919583 Vali Loss: 0.2403427 Test Loss: 0.2981633
EarlyStopping counter: 22 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 48 cost time: 0.9927608966827393
Epoch: 48, Steps: 64 | Train Loss: 0.0917728 Vali Loss: 0.2419049 Test Loss: 0.2982885
EarlyStopping counter: 23 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 49 cost time: 0.9909658432006836
Epoch: 49, Steps: 64 | Train Loss: 0.0915752 Vali Loss: 0.2400599 Test Loss: 0.2973438
EarlyStopping counter: 24 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 50 cost time: 0.9829998016357422
Epoch: 50, Steps: 64 | Train Loss: 0.0915794 Vali Loss: 0.2401451 Test Loss: 0.2971098
EarlyStopping counter: 25 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 51 cost time: 0.9899997711181641
Epoch: 51, Steps: 64 | Train Loss: 0.0915293 Vali Loss: 0.2394045 Test Loss: 0.2982035
EarlyStopping counter: 26 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 52 cost time: 1.003438949584961
Epoch: 52, Steps: 64 | Train Loss: 0.0913739 Vali Loss: 0.2412231 Test Loss: 0.2971956
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 53 cost time: 0.998612642288208
Epoch: 53, Steps: 64 | Train Loss: 0.0919791 Vali Loss: 0.2445145 Test Loss: 0.2984728
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 54 cost time: 0.9956159591674805
Epoch: 54, Steps: 64 | Train Loss: 0.0914282 Vali Loss: 0.2419049 Test Loss: 0.2981186
EarlyStopping counter: 29 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 55 cost time: 0.9993593692779541
Epoch: 55, Steps: 64 | Train Loss: 0.0915883 Vali Loss: 0.2400873 Test Loss: 0.2989383
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 56 cost time: 0.9816372394561768
Epoch: 56, Steps: 64 | Train Loss: 0.0916588 Vali Loss: 0.2414287 Test Loss: 0.2978921
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 57 cost time: 0.9792656898498535
Epoch: 57, Steps: 64 | Train Loss: 0.0918070 Vali Loss: 0.2390114 Test Loss: 0.2972970
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 58 cost time: 0.9864261150360107
Epoch: 58, Steps: 64 | Train Loss: 0.0917210 Vali Loss: 0.2403208 Test Loss: 0.2977878
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 59 cost time: 0.9863317012786865
Epoch: 59, Steps: 64 | Train Loss: 0.0914362 Vali Loss: 0.2390115 Test Loss: 0.2978531
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 60 cost time: 0.9924445152282715
Epoch: 60, Steps: 64 | Train Loss: 0.0913206 Vali Loss: 0.2382044 Test Loss: 0.2979578
Validation loss decreased (0.238522 --> 0.238204).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.29795780777931213, mae:0.3702543079853058, rse:0.25052449107170105
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045186519622802734 GB
Epoch: 1 cost time: 2.3357856273651123
Epoch: 1, Steps: 64 | Train Loss: 1.0945263 Vali Loss: 2.9484010 Test Loss: 5.1848335
Validation loss decreased (inf --> 2.948401).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 2 cost time: 0.875521183013916
Epoch: 2, Steps: 64 | Train Loss: 0.8034097 Vali Loss: 1.3794477 Test Loss: 2.2497129
Validation loss decreased (2.948401 --> 1.379448).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 3 cost time: 0.9056196212768555
Epoch: 3, Steps: 64 | Train Loss: 0.4109214 Vali Loss: 0.6125628 Test Loss: 0.8003986
Validation loss decreased (1.379448 --> 0.612563).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 4 cost time: 0.9024045467376709
Epoch: 4, Steps: 64 | Train Loss: 0.2420829 Vali Loss: 0.4301327 Test Loss: 0.5023050
Validation loss decreased (0.612563 --> 0.430133).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 5 cost time: 0.9060699939727783
Epoch: 5, Steps: 64 | Train Loss: 0.1917713 Vali Loss: 0.3564199 Test Loss: 0.4133872
Validation loss decreased (0.430133 --> 0.356420).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 6 cost time: 0.8904068470001221
Epoch: 6, Steps: 64 | Train Loss: 0.1677049 Vali Loss: 0.3136228 Test Loss: 0.3712580
Validation loss decreased (0.356420 --> 0.313623).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 7 cost time: 0.90179443359375
Epoch: 7, Steps: 64 | Train Loss: 0.1541893 Vali Loss: 0.2893983 Test Loss: 0.3468917
Validation loss decreased (0.313623 --> 0.289398).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 8 cost time: 0.8987433910369873
Epoch: 8, Steps: 64 | Train Loss: 0.1461938 Vali Loss: 0.2783712 Test Loss: 0.3360953
Validation loss decreased (0.289398 --> 0.278371).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 9 cost time: 0.8989996910095215
Epoch: 9, Steps: 64 | Train Loss: 0.1396823 Vali Loss: 0.2728275 Test Loss: 0.3307637
Validation loss decreased (0.278371 --> 0.272828).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 10 cost time: 0.8986122608184814
Epoch: 10, Steps: 64 | Train Loss: 0.1353675 Vali Loss: 0.2649257 Test Loss: 0.3230170
Validation loss decreased (0.272828 --> 0.264926).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 11 cost time: 0.9059765338897705
Epoch: 11, Steps: 64 | Train Loss: 0.1314312 Vali Loss: 0.2634487 Test Loss: 0.3192267
Validation loss decreased (0.264926 --> 0.263449).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 12 cost time: 0.9164047241210938
Epoch: 12, Steps: 64 | Train Loss: 0.1278433 Vali Loss: 0.2552178 Test Loss: 0.3167240
Validation loss decreased (0.263449 --> 0.255218).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 13 cost time: 0.9053456783294678
Epoch: 13, Steps: 64 | Train Loss: 0.1256122 Vali Loss: 0.2526093 Test Loss: 0.3111554
Validation loss decreased (0.255218 --> 0.252609).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 14 cost time: 0.9077849388122559
Epoch: 14, Steps: 64 | Train Loss: 0.1233746 Vali Loss: 0.2507749 Test Loss: 0.3116609
Validation loss decreased (0.252609 --> 0.250775).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 15 cost time: 0.8953852653503418
Epoch: 15, Steps: 64 | Train Loss: 0.1210414 Vali Loss: 0.2512955 Test Loss: 0.3109236
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 16 cost time: 0.9076175689697266
Epoch: 16, Steps: 64 | Train Loss: 0.1194796 Vali Loss: 0.2470258 Test Loss: 0.3071845
Validation loss decreased (0.250775 --> 0.247026).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 17 cost time: 0.8953392505645752
Epoch: 17, Steps: 64 | Train Loss: 0.1187744 Vali Loss: 0.2436396 Test Loss: 0.3041013
Validation loss decreased (0.247026 --> 0.243640).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 18 cost time: 0.896353006362915
Epoch: 18, Steps: 64 | Train Loss: 0.1170482 Vali Loss: 0.2410620 Test Loss: 0.3063773
Validation loss decreased (0.243640 --> 0.241062).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 19 cost time: 0.9083456993103027
Epoch: 19, Steps: 64 | Train Loss: 0.1153950 Vali Loss: 0.2435510 Test Loss: 0.3086453
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 20 cost time: 0.9759290218353271
Epoch: 20, Steps: 64 | Train Loss: 0.1158203 Vali Loss: 0.2388113 Test Loss: 0.3037042
Validation loss decreased (0.241062 --> 0.238811).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 21 cost time: 0.9008572101593018
Epoch: 21, Steps: 64 | Train Loss: 0.1144271 Vali Loss: 0.2422602 Test Loss: 0.3005733
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 22 cost time: 0.8989996910095215
Epoch: 22, Steps: 64 | Train Loss: 0.1133292 Vali Loss: 0.2389919 Test Loss: 0.3029255
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 23 cost time: 0.8923394680023193
Epoch: 23, Steps: 64 | Train Loss: 0.1135774 Vali Loss: 0.2415575 Test Loss: 0.3035398
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 24 cost time: 0.8970253467559814
Epoch: 24, Steps: 64 | Train Loss: 0.1120272 Vali Loss: 0.2368266 Test Loss: 0.2995455
Validation loss decreased (0.238811 --> 0.236827).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 25 cost time: 0.8969516754150391
Epoch: 25, Steps: 64 | Train Loss: 0.1114468 Vali Loss: 0.2359306 Test Loss: 0.2999759
Validation loss decreased (0.236827 --> 0.235931).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 26 cost time: 0.9073374271392822
Epoch: 26, Steps: 64 | Train Loss: 0.1110469 Vali Loss: 0.2384947 Test Loss: 0.3012064
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 27 cost time: 0.8817262649536133
Epoch: 27, Steps: 64 | Train Loss: 0.1105643 Vali Loss: 0.2343703 Test Loss: 0.3003050
Validation loss decreased (0.235931 --> 0.234370).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 28 cost time: 0.8873140811920166
Epoch: 28, Steps: 64 | Train Loss: 0.1100292 Vali Loss: 0.2354167 Test Loss: 0.2998862
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 29 cost time: 0.8715965747833252
Epoch: 29, Steps: 64 | Train Loss: 0.1096341 Vali Loss: 0.2382773 Test Loss: 0.3021111
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 30 cost time: 0.9154748916625977
Epoch: 30, Steps: 64 | Train Loss: 0.1092721 Vali Loss: 0.2341261 Test Loss: 0.3003683
Validation loss decreased (0.234370 --> 0.234126).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 31 cost time: 0.9010806083679199
Epoch: 31, Steps: 64 | Train Loss: 0.1095619 Vali Loss: 0.2331441 Test Loss: 0.2975620
Validation loss decreased (0.234126 --> 0.233144).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 32 cost time: 0.900763750076294
Epoch: 32, Steps: 64 | Train Loss: 0.1093638 Vali Loss: 0.2368716 Test Loss: 0.2995155
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 33 cost time: 0.9017233848571777
Epoch: 33, Steps: 64 | Train Loss: 0.1084413 Vali Loss: 0.2307376 Test Loss: 0.2978386
Validation loss decreased (0.233144 --> 0.230738).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 34 cost time: 0.9070360660552979
Epoch: 34, Steps: 64 | Train Loss: 0.1078970 Vali Loss: 0.2343771 Test Loss: 0.2969344
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 35 cost time: 0.912623405456543
Epoch: 35, Steps: 64 | Train Loss: 0.1083763 Vali Loss: 0.2307701 Test Loss: 0.2959368
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 36 cost time: 0.9093611240386963
Epoch: 36, Steps: 64 | Train Loss: 0.1086119 Vali Loss: 0.2285679 Test Loss: 0.2956069
Validation loss decreased (0.230738 --> 0.228568).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 37 cost time: 0.914982795715332
Epoch: 37, Steps: 64 | Train Loss: 0.1086635 Vali Loss: 0.2319471 Test Loss: 0.2983678
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 38 cost time: 0.9163734912872314
Epoch: 38, Steps: 64 | Train Loss: 0.1083616 Vali Loss: 0.2331460 Test Loss: 0.2988289
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 39 cost time: 0.9107627868652344
Epoch: 39, Steps: 64 | Train Loss: 0.1072416 Vali Loss: 0.2330379 Test Loss: 0.2984595
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 40 cost time: 0.9079999923706055
Epoch: 40, Steps: 64 | Train Loss: 0.1075129 Vali Loss: 0.2319264 Test Loss: 0.2965776
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 41 cost time: 0.9176051616668701
Epoch: 41, Steps: 64 | Train Loss: 0.1076393 Vali Loss: 0.2306170 Test Loss: 0.2983889
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 42 cost time: 0.9093596935272217
Epoch: 42, Steps: 64 | Train Loss: 0.1075131 Vali Loss: 0.2287679 Test Loss: 0.2981209
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 43 cost time: 0.9064240455627441
Epoch: 43, Steps: 64 | Train Loss: 0.1077494 Vali Loss: 0.2319610 Test Loss: 0.2981578
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 44 cost time: 0.9081060886383057
Epoch: 44, Steps: 64 | Train Loss: 0.1074345 Vali Loss: 0.2289681 Test Loss: 0.2964033
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 45 cost time: 0.9067296981811523
Epoch: 45, Steps: 64 | Train Loss: 0.1073299 Vali Loss: 0.2311047 Test Loss: 0.2946768
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 46 cost time: 0.9023981094360352
Epoch: 46, Steps: 64 | Train Loss: 0.1068797 Vali Loss: 0.2316087 Test Loss: 0.2950494
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 47 cost time: 0.9109985828399658
Epoch: 47, Steps: 64 | Train Loss: 0.1068226 Vali Loss: 0.2303611 Test Loss: 0.2968293
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 48 cost time: 0.8903191089630127
Epoch: 48, Steps: 64 | Train Loss: 0.1066171 Vali Loss: 0.2295774 Test Loss: 0.2961902
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 49 cost time: 0.8743178844451904
Epoch: 49, Steps: 64 | Train Loss: 0.1073671 Vali Loss: 0.2317748 Test Loss: 0.2967447
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 50 cost time: 0.8813095092773438
Epoch: 50, Steps: 64 | Train Loss: 0.1070109 Vali Loss: 0.2334248 Test Loss: 0.2988532
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 51 cost time: 0.9170382022857666
Epoch: 51, Steps: 64 | Train Loss: 0.1070537 Vali Loss: 0.2294077 Test Loss: 0.2964954
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 52 cost time: 0.9100003242492676
Epoch: 52, Steps: 64 | Train Loss: 0.1065575 Vali Loss: 0.2288429 Test Loss: 0.2966152
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 53 cost time: 0.9056024551391602
Epoch: 53, Steps: 64 | Train Loss: 0.1067165 Vali Loss: 0.2287276 Test Loss: 0.2943169
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 54 cost time: 0.9125533103942871
Epoch: 54, Steps: 64 | Train Loss: 0.1069381 Vali Loss: 0.2332110 Test Loss: 0.2986613
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 55 cost time: 0.9193706512451172
Epoch: 55, Steps: 64 | Train Loss: 0.1064244 Vali Loss: 0.2300592 Test Loss: 0.2957843
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 56 cost time: 0.9103705883026123
Epoch: 56, Steps: 64 | Train Loss: 0.1066836 Vali Loss: 0.2301918 Test Loss: 0.2945096
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 57 cost time: 0.911332368850708
Epoch: 57, Steps: 64 | Train Loss: 0.1070291 Vali Loss: 0.2274501 Test Loss: 0.2966954
Validation loss decreased (0.228568 --> 0.227450).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 58 cost time: 0.9127955436706543
Epoch: 58, Steps: 64 | Train Loss: 0.1067043 Vali Loss: 0.2317077 Test Loss: 0.2997983
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 59 cost time: 0.9160010814666748
Epoch: 59, Steps: 64 | Train Loss: 0.1071300 Vali Loss: 0.2309157 Test Loss: 0.2948493
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 60 cost time: 0.9066014289855957
Epoch: 60, Steps: 64 | Train Loss: 0.1072070 Vali Loss: 0.2311873 Test Loss: 0.2957670
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.29669544100761414, mae:0.3567226231098175, rse:0.2499932199716568
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.04661846160888672 GB
Epoch: 1 cost time: 2.3610424995422363
Epoch: 1, Steps: 64 | Train Loss: 0.8307956 Vali Loss: 2.4579940 Test Loss: 4.2614527
Validation loss decreased (inf --> 2.457994).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 2 cost time: 0.9345695972442627
Epoch: 2, Steps: 64 | Train Loss: 0.5258958 Vali Loss: 0.8380985 Test Loss: 1.2190259
Validation loss decreased (2.457994 --> 0.838099).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 3 cost time: 0.9343342781066895
Epoch: 3, Steps: 64 | Train Loss: 0.1953661 Vali Loss: 0.3231273 Test Loss: 0.3586083
Validation loss decreased (0.838099 --> 0.323127).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 4 cost time: 0.9313771724700928
Epoch: 4, Steps: 64 | Train Loss: 0.1219895 Vali Loss: 0.2602988 Test Loss: 0.3013156
Validation loss decreased (0.323127 --> 0.260299).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 5 cost time: 0.9437375068664551
Epoch: 5, Steps: 64 | Train Loss: 0.1101005 Vali Loss: 0.2466817 Test Loss: 0.2980800
Validation loss decreased (0.260299 --> 0.246682).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 6 cost time: 0.9310002326965332
Epoch: 6, Steps: 64 | Train Loss: 0.1037188 Vali Loss: 0.2457068 Test Loss: 0.2947885
Validation loss decreased (0.246682 --> 0.245707).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 7 cost time: 0.9309995174407959
Epoch: 7, Steps: 64 | Train Loss: 0.0998476 Vali Loss: 0.2398627 Test Loss: 0.2943214
Validation loss decreased (0.245707 --> 0.239863).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 8 cost time: 0.9286253452301025
Epoch: 8, Steps: 64 | Train Loss: 0.0971060 Vali Loss: 0.2354059 Test Loss: 0.2935299
Validation loss decreased (0.239863 --> 0.235406).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 9 cost time: 0.932304859161377
Epoch: 9, Steps: 64 | Train Loss: 0.0944271 Vali Loss: 0.2267679 Test Loss: 0.2922665
Validation loss decreased (0.235406 --> 0.226768).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 10 cost time: 0.9292356967926025
Epoch: 10, Steps: 64 | Train Loss: 0.0922847 Vali Loss: 0.2260152 Test Loss: 0.2891171
Validation loss decreased (0.226768 --> 0.226015).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 11 cost time: 0.9285032749176025
Epoch: 11, Steps: 64 | Train Loss: 0.0904629 Vali Loss: 0.2232705 Test Loss: 0.2883583
Validation loss decreased (0.226015 --> 0.223271).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 12 cost time: 0.9443838596343994
Epoch: 12, Steps: 64 | Train Loss: 0.0898578 Vali Loss: 0.2222991 Test Loss: 0.2884533
Validation loss decreased (0.223271 --> 0.222299).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 13 cost time: 1.0074059963226318
Epoch: 13, Steps: 64 | Train Loss: 0.0883397 Vali Loss: 0.2226364 Test Loss: 0.2873422
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 14 cost time: 0.9391624927520752
Epoch: 14, Steps: 64 | Train Loss: 0.0874074 Vali Loss: 0.2164109 Test Loss: 0.2882434
Validation loss decreased (0.222299 --> 0.216411).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 15 cost time: 0.930999755859375
Epoch: 15, Steps: 64 | Train Loss: 0.0865461 Vali Loss: 0.2183265 Test Loss: 0.2865436
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 16 cost time: 0.9338757991790771
Epoch: 16, Steps: 64 | Train Loss: 0.0851616 Vali Loss: 0.2130311 Test Loss: 0.2861383
Validation loss decreased (0.216411 --> 0.213031).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 17 cost time: 0.9295351505279541
Epoch: 17, Steps: 64 | Train Loss: 0.0844404 Vali Loss: 0.2124879 Test Loss: 0.2859338
Validation loss decreased (0.213031 --> 0.212488).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 18 cost time: 0.9269888401031494
Epoch: 18, Steps: 64 | Train Loss: 0.0842289 Vali Loss: 0.2135754 Test Loss: 0.2857961
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 19 cost time: 0.9444830417633057
Epoch: 19, Steps: 64 | Train Loss: 0.0836967 Vali Loss: 0.2119662 Test Loss: 0.2854744
Validation loss decreased (0.212488 --> 0.211966).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 20 cost time: 0.9315125942230225
Epoch: 20, Steps: 64 | Train Loss: 0.0830342 Vali Loss: 0.2101098 Test Loss: 0.2855310
Validation loss decreased (0.211966 --> 0.210110).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 21 cost time: 0.9347524642944336
Epoch: 21, Steps: 64 | Train Loss: 0.0827970 Vali Loss: 0.2079152 Test Loss: 0.2858496
Validation loss decreased (0.210110 --> 0.207915).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 22 cost time: 0.9337711334228516
Epoch: 22, Steps: 64 | Train Loss: 0.0825253 Vali Loss: 0.2076999 Test Loss: 0.2839316
Validation loss decreased (0.207915 --> 0.207700).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 23 cost time: 0.929999828338623
Epoch: 23, Steps: 64 | Train Loss: 0.0822976 Vali Loss: 0.2070646 Test Loss: 0.2838871
Validation loss decreased (0.207700 --> 0.207065).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 24 cost time: 0.9266202449798584
Epoch: 24, Steps: 64 | Train Loss: 0.0822702 Vali Loss: 0.2093830 Test Loss: 0.2857071
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 25 cost time: 0.9318840503692627
Epoch: 25, Steps: 64 | Train Loss: 0.0813963 Vali Loss: 0.2064385 Test Loss: 0.2826533
Validation loss decreased (0.207065 --> 0.206438).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 26 cost time: 0.9153566360473633
Epoch: 26, Steps: 64 | Train Loss: 0.0807513 Vali Loss: 0.2064608 Test Loss: 0.2837026
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 27 cost time: 0.9309985637664795
Epoch: 27, Steps: 64 | Train Loss: 0.0811943 Vali Loss: 0.2044474 Test Loss: 0.2835348
Validation loss decreased (0.206438 --> 0.204447).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 28 cost time: 0.9303395748138428
Epoch: 28, Steps: 64 | Train Loss: 0.0809405 Vali Loss: 0.2047378 Test Loss: 0.2842596
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 29 cost time: 0.9317946434020996
Epoch: 29, Steps: 64 | Train Loss: 0.0806577 Vali Loss: 0.2030871 Test Loss: 0.2846714
Validation loss decreased (0.204447 --> 0.203087).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 30 cost time: 0.9310014247894287
Epoch: 30, Steps: 64 | Train Loss: 0.0807104 Vali Loss: 0.2029705 Test Loss: 0.2819659
Validation loss decreased (0.203087 --> 0.202970).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 31 cost time: 0.9352457523345947
Epoch: 31, Steps: 64 | Train Loss: 0.0808749 Vali Loss: 0.2019239 Test Loss: 0.2822058
Validation loss decreased (0.202970 --> 0.201924).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 32 cost time: 0.9293334484100342
Epoch: 32, Steps: 64 | Train Loss: 0.0806298 Vali Loss: 0.2039703 Test Loss: 0.2833830
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 33 cost time: 0.9353878498077393
Epoch: 33, Steps: 64 | Train Loss: 0.0803033 Vali Loss: 0.2005772 Test Loss: 0.2829512
Validation loss decreased (0.201924 --> 0.200577).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 34 cost time: 0.9277961254119873
Epoch: 34, Steps: 64 | Train Loss: 0.0800852 Vali Loss: 0.2053923 Test Loss: 0.2848403
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 35 cost time: 0.9293317794799805
Epoch: 35, Steps: 64 | Train Loss: 0.0795493 Vali Loss: 0.1973970 Test Loss: 0.2825068
Validation loss decreased (0.200577 --> 0.197397).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 36 cost time: 0.9408707618713379
Epoch: 36, Steps: 64 | Train Loss: 0.0801148 Vali Loss: 0.2006782 Test Loss: 0.2833114
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 37 cost time: 1.0030004978179932
Epoch: 37, Steps: 64 | Train Loss: 0.0796276 Vali Loss: 0.2013389 Test Loss: 0.2841722
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 38 cost time: 1.0004563331604004
Epoch: 38, Steps: 64 | Train Loss: 0.0795934 Vali Loss: 0.2034848 Test Loss: 0.2838555
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 39 cost time: 1.0020666122436523
Epoch: 39, Steps: 64 | Train Loss: 0.0795772 Vali Loss: 0.1994720 Test Loss: 0.2819789
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 40 cost time: 0.9316055774688721
Epoch: 40, Steps: 64 | Train Loss: 0.0799256 Vali Loss: 0.2017252 Test Loss: 0.2833782
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 41 cost time: 0.9274282455444336
Epoch: 41, Steps: 64 | Train Loss: 0.0797319 Vali Loss: 0.2010205 Test Loss: 0.2832300
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 42 cost time: 0.9307920932769775
Epoch: 42, Steps: 64 | Train Loss: 0.0796151 Vali Loss: 0.2030133 Test Loss: 0.2845263
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 43 cost time: 0.9245507717132568
Epoch: 43, Steps: 64 | Train Loss: 0.0796389 Vali Loss: 0.2008227 Test Loss: 0.2827955
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 44 cost time: 0.929781436920166
Epoch: 44, Steps: 64 | Train Loss: 0.0795250 Vali Loss: 0.2024941 Test Loss: 0.2826016
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 45 cost time: 0.9307310581207275
Epoch: 45, Steps: 64 | Train Loss: 0.0794594 Vali Loss: 0.2010235 Test Loss: 0.2827902
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 46 cost time: 0.9340000152587891
Epoch: 46, Steps: 64 | Train Loss: 0.0790412 Vali Loss: 0.2005794 Test Loss: 0.2824712
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 47 cost time: 0.9176180362701416
Epoch: 47, Steps: 64 | Train Loss: 0.0792591 Vali Loss: 0.2008377 Test Loss: 0.2814083
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 48 cost time: 0.9300601482391357
Epoch: 48, Steps: 64 | Train Loss: 0.0796874 Vali Loss: 0.2030724 Test Loss: 0.2817681
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 49 cost time: 0.9344234466552734
Epoch: 49, Steps: 64 | Train Loss: 0.0791500 Vali Loss: 0.2029103 Test Loss: 0.2829593
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 50 cost time: 0.9365308284759521
Epoch: 50, Steps: 64 | Train Loss: 0.0788561 Vali Loss: 0.2018398 Test Loss: 0.2832183
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 51 cost time: 0.9313735961914062
Epoch: 51, Steps: 64 | Train Loss: 0.0792235 Vali Loss: 0.2003316 Test Loss: 0.2835075
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 52 cost time: 0.9331467151641846
Epoch: 52, Steps: 64 | Train Loss: 0.0797892 Vali Loss: 0.2021197 Test Loss: 0.2842370
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 53 cost time: 0.9270005226135254
Epoch: 53, Steps: 64 | Train Loss: 0.0794242 Vali Loss: 0.2020330 Test Loss: 0.2816042
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 54 cost time: 0.9306135177612305
Epoch: 54, Steps: 64 | Train Loss: 0.0792513 Vali Loss: 0.2023893 Test Loss: 0.2840064
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 55 cost time: 0.933375358581543
Epoch: 55, Steps: 64 | Train Loss: 0.0791081 Vali Loss: 0.2006271 Test Loss: 0.2822701
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 56 cost time: 0.9332654476165771
Epoch: 56, Steps: 64 | Train Loss: 0.0790529 Vali Loss: 0.2032780 Test Loss: 0.2815313
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 57 cost time: 0.943326473236084
Epoch: 57, Steps: 64 | Train Loss: 0.0789786 Vali Loss: 0.2001783 Test Loss: 0.2831660
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 58 cost time: 0.9364492893218994
Epoch: 58, Steps: 64 | Train Loss: 0.0791000 Vali Loss: 0.1999040 Test Loss: 0.2831647
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 59 cost time: 0.9322187900543213
Epoch: 59, Steps: 64 | Train Loss: 0.0790958 Vali Loss: 0.1975622 Test Loss: 0.2829593
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 60 cost time: 0.9417996406555176
Epoch: 60, Steps: 64 | Train Loss: 0.0795519 Vali Loss: 0.2025208 Test Loss: 0.2846884
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2825067639350891, mae:0.3427063226699829, rse:0.24394235014915466
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04773855209350586 GB
Epoch: 1 cost time: 2.366283416748047
Epoch: 1, Steps: 64 | Train Loss: 0.9907973 Vali Loss: 3.0626783 Test Loss: 5.4019146
Validation loss decreased (inf --> 3.062678).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 2 cost time: 0.957618236541748
Epoch: 2, Steps: 64 | Train Loss: 0.7089928 Vali Loss: 1.4241127 Test Loss: 2.2862334
Validation loss decreased (3.062678 --> 1.424113).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 3 cost time: 0.955439567565918
Epoch: 3, Steps: 64 | Train Loss: 0.2609656 Vali Loss: 0.3700007 Test Loss: 0.3679970
Validation loss decreased (1.424113 --> 0.370001).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 4 cost time: 0.9544632434844971
Epoch: 4, Steps: 64 | Train Loss: 0.1127067 Vali Loss: 0.2554974 Test Loss: 0.3041320
Validation loss decreased (0.370001 --> 0.255497).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 5 cost time: 0.955718994140625
Epoch: 5, Steps: 64 | Train Loss: 0.1023107 Vali Loss: 0.2477915 Test Loss: 0.3020895
Validation loss decreased (0.255497 --> 0.247791).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 6 cost time: 0.9493508338928223
Epoch: 6, Steps: 64 | Train Loss: 0.0972927 Vali Loss: 0.2429056 Test Loss: 0.3000209
Validation loss decreased (0.247791 --> 0.242906).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 7 cost time: 0.9550163745880127
Epoch: 7, Steps: 64 | Train Loss: 0.0943747 Vali Loss: 0.2383434 Test Loss: 0.2988482
Validation loss decreased (0.242906 --> 0.238343).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 8 cost time: 0.9477357864379883
Epoch: 8, Steps: 64 | Train Loss: 0.0921333 Vali Loss: 0.2356772 Test Loss: 0.3004862
Validation loss decreased (0.238343 --> 0.235677).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 9 cost time: 0.9488179683685303
Epoch: 9, Steps: 64 | Train Loss: 0.0904711 Vali Loss: 0.2307595 Test Loss: 0.2972167
Validation loss decreased (0.235677 --> 0.230759).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 10 cost time: 0.9530003070831299
Epoch: 10, Steps: 64 | Train Loss: 0.0890389 Vali Loss: 0.2277445 Test Loss: 0.2976719
Validation loss decreased (0.230759 --> 0.227745).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 11 cost time: 0.952613353729248
Epoch: 11, Steps: 64 | Train Loss: 0.0876253 Vali Loss: 0.2256613 Test Loss: 0.2966771
Validation loss decreased (0.227745 --> 0.225661).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 12 cost time: 0.9523606300354004
Epoch: 12, Steps: 64 | Train Loss: 0.0863535 Vali Loss: 0.2244806 Test Loss: 0.2992986
Validation loss decreased (0.225661 --> 0.224481).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 13 cost time: 0.953392505645752
Epoch: 13, Steps: 64 | Train Loss: 0.0856195 Vali Loss: 0.2208111 Test Loss: 0.2973403
Validation loss decreased (0.224481 --> 0.220811).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 14 cost time: 0.9689667224884033
Epoch: 14, Steps: 64 | Train Loss: 0.0844488 Vali Loss: 0.2174921 Test Loss: 0.2968526
Validation loss decreased (0.220811 --> 0.217492).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 15 cost time: 0.9494116306304932
Epoch: 15, Steps: 64 | Train Loss: 0.0839836 Vali Loss: 0.2155491 Test Loss: 0.2956772
Validation loss decreased (0.217492 --> 0.215549).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 16 cost time: 0.9534375667572021
Epoch: 16, Steps: 64 | Train Loss: 0.0831074 Vali Loss: 0.2163989 Test Loss: 0.2961367
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 17 cost time: 0.9557445049285889
Epoch: 17, Steps: 64 | Train Loss: 0.0829736 Vali Loss: 0.2156438 Test Loss: 0.2965750
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 18 cost time: 0.9483776092529297
Epoch: 18, Steps: 64 | Train Loss: 0.0823017 Vali Loss: 0.2135648 Test Loss: 0.2959301
Validation loss decreased (0.215549 --> 0.213565).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 19 cost time: 0.9560024738311768
Epoch: 19, Steps: 64 | Train Loss: 0.0813807 Vali Loss: 0.2141582 Test Loss: 0.2970346
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 20 cost time: 0.9526152610778809
Epoch: 20, Steps: 64 | Train Loss: 0.0810349 Vali Loss: 0.2103417 Test Loss: 0.2968794
Validation loss decreased (0.213565 --> 0.210342).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 21 cost time: 0.931840181350708
Epoch: 21, Steps: 64 | Train Loss: 0.0808907 Vali Loss: 0.2129060 Test Loss: 0.2967654
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 22 cost time: 0.9503836631774902
Epoch: 22, Steps: 64 | Train Loss: 0.0812231 Vali Loss: 0.2102486 Test Loss: 0.2964437
Validation loss decreased (0.210342 --> 0.210249).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 23 cost time: 0.9514949321746826
Epoch: 23, Steps: 64 | Train Loss: 0.0805786 Vali Loss: 0.2084227 Test Loss: 0.2961059
Validation loss decreased (0.210249 --> 0.208423).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 24 cost time: 0.9525036811828613
Epoch: 24, Steps: 64 | Train Loss: 0.0799803 Vali Loss: 0.2088823 Test Loss: 0.2971778
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 25 cost time: 0.9477365016937256
Epoch: 25, Steps: 64 | Train Loss: 0.0803435 Vali Loss: 0.2069359 Test Loss: 0.2954728
Validation loss decreased (0.208423 --> 0.206936).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 26 cost time: 0.9507656097412109
Epoch: 26, Steps: 64 | Train Loss: 0.0796609 Vali Loss: 0.2080401 Test Loss: 0.2957989
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 27 cost time: 0.9526243209838867
Epoch: 27, Steps: 64 | Train Loss: 0.0793176 Vali Loss: 0.2074540 Test Loss: 0.2958243
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 28 cost time: 0.9506306648254395
Epoch: 28, Steps: 64 | Train Loss: 0.0797082 Vali Loss: 0.2062050 Test Loss: 0.2961810
Validation loss decreased (0.206936 --> 0.206205).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 29 cost time: 0.9493522644042969
Epoch: 29, Steps: 64 | Train Loss: 0.0793618 Vali Loss: 0.2074621 Test Loss: 0.2972523
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 30 cost time: 0.9534580707550049
Epoch: 30, Steps: 64 | Train Loss: 0.0798205 Vali Loss: 0.2065352 Test Loss: 0.2958540
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 31 cost time: 0.97115159034729
Epoch: 31, Steps: 64 | Train Loss: 0.0795963 Vali Loss: 0.2054542 Test Loss: 0.2962089
Validation loss decreased (0.206205 --> 0.205454).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 32 cost time: 0.9482986927032471
Epoch: 32, Steps: 64 | Train Loss: 0.0789185 Vali Loss: 0.2064383 Test Loss: 0.2964246
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 33 cost time: 0.94938063621521
Epoch: 33, Steps: 64 | Train Loss: 0.0787566 Vali Loss: 0.2038709 Test Loss: 0.2966874
Validation loss decreased (0.205454 --> 0.203871).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 34 cost time: 0.9596648216247559
Epoch: 34, Steps: 64 | Train Loss: 0.0790463 Vali Loss: 0.2055276 Test Loss: 0.2962653
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 35 cost time: 1.034153938293457
Epoch: 35, Steps: 64 | Train Loss: 0.0793189 Vali Loss: 0.2036478 Test Loss: 0.2955022
Validation loss decreased (0.203871 --> 0.203648).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 36 cost time: 1.0339994430541992
Epoch: 36, Steps: 64 | Train Loss: 0.0788175 Vali Loss: 0.2043680 Test Loss: 0.2955906
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 37 cost time: 0.951000452041626
Epoch: 37, Steps: 64 | Train Loss: 0.0788094 Vali Loss: 0.2042218 Test Loss: 0.2961458
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 38 cost time: 0.9526212215423584
Epoch: 38, Steps: 64 | Train Loss: 0.0785793 Vali Loss: 0.2049337 Test Loss: 0.2961088
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 39 cost time: 0.9502339363098145
Epoch: 39, Steps: 64 | Train Loss: 0.0788054 Vali Loss: 0.2042539 Test Loss: 0.2957444
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 40 cost time: 0.9473845958709717
Epoch: 40, Steps: 64 | Train Loss: 0.0786153 Vali Loss: 0.2033221 Test Loss: 0.2960333
Validation loss decreased (0.203648 --> 0.203322).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 41 cost time: 0.9313676357269287
Epoch: 41, Steps: 64 | Train Loss: 0.0788199 Vali Loss: 0.2032017 Test Loss: 0.2953081
Validation loss decreased (0.203322 --> 0.203202).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 42 cost time: 0.9463410377502441
Epoch: 42, Steps: 64 | Train Loss: 0.0788861 Vali Loss: 0.2046344 Test Loss: 0.2962741
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 43 cost time: 0.9468011856079102
Epoch: 43, Steps: 64 | Train Loss: 0.0784034 Vali Loss: 0.2055374 Test Loss: 0.2960196
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 44 cost time: 0.9503986835479736
Epoch: 44, Steps: 64 | Train Loss: 0.0784840 Vali Loss: 0.2038334 Test Loss: 0.2952949
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 45 cost time: 0.9519999027252197
Epoch: 45, Steps: 64 | Train Loss: 0.0786931 Vali Loss: 0.2028140 Test Loss: 0.2958089
Validation loss decreased (0.203202 --> 0.202814).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 46 cost time: 0.9536218643188477
Epoch: 46, Steps: 64 | Train Loss: 0.0781382 Vali Loss: 0.2062234 Test Loss: 0.2966508
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 47 cost time: 0.9543898105621338
Epoch: 47, Steps: 64 | Train Loss: 0.0782500 Vali Loss: 0.2023925 Test Loss: 0.2956006
Validation loss decreased (0.202814 --> 0.202393).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 48 cost time: 0.9612126350402832
Epoch: 48, Steps: 64 | Train Loss: 0.0785218 Vali Loss: 0.2030803 Test Loss: 0.2962805
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 49 cost time: 0.9505128860473633
Epoch: 49, Steps: 64 | Train Loss: 0.0783779 Vali Loss: 0.2051202 Test Loss: 0.2956535
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 50 cost time: 0.9504032135009766
Epoch: 50, Steps: 64 | Train Loss: 0.0781790 Vali Loss: 0.2014182 Test Loss: 0.2953603
Validation loss decreased (0.202393 --> 0.201418).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 51 cost time: 0.9611973762512207
Epoch: 51, Steps: 64 | Train Loss: 0.0784625 Vali Loss: 0.2024124 Test Loss: 0.2953581
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 52 cost time: 0.9783940315246582
Epoch: 52, Steps: 64 | Train Loss: 0.0785575 Vali Loss: 0.2037998 Test Loss: 0.2960325
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 53 cost time: 0.9756178855895996
Epoch: 53, Steps: 64 | Train Loss: 0.0785128 Vali Loss: 0.2034731 Test Loss: 0.2961108
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 54 cost time: 0.9876017570495605
Epoch: 54, Steps: 64 | Train Loss: 0.0783312 Vali Loss: 0.2051938 Test Loss: 0.2961448
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 55 cost time: 1.046980381011963
Epoch: 55, Steps: 64 | Train Loss: 0.0781695 Vali Loss: 0.2046649 Test Loss: 0.2944261
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 56 cost time: 1.047593355178833
Epoch: 56, Steps: 64 | Train Loss: 0.0785763 Vali Loss: 0.2051589 Test Loss: 0.2953635
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 57 cost time: 1.0196006298065186
Epoch: 57, Steps: 64 | Train Loss: 0.0779331 Vali Loss: 0.2040562 Test Loss: 0.2958016
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 58 cost time: 0.9623775482177734
Epoch: 58, Steps: 64 | Train Loss: 0.0783034 Vali Loss: 0.2045022 Test Loss: 0.2962759
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 59 cost time: 0.9767398834228516
Epoch: 59, Steps: 64 | Train Loss: 0.0782383 Vali Loss: 0.2040692 Test Loss: 0.2955486
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 60 cost time: 0.9745736122131348
Epoch: 60, Steps: 64 | Train Loss: 0.0782891 Vali Loss: 0.2029935 Test Loss: 0.2954815
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2953602373600006, mae:0.36069831252098083, rse:0.24943006038665771
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.045348167419433594 GB
Epoch: 1 cost time: 2.3138914108276367
Epoch: 1, Steps: 64 | Train Loss: 1.0298138 Vali Loss: 2.7437160 Test Loss: 4.8019247
Validation loss decreased (inf --> 2.743716).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 2 cost time: 0.9124839305877686
Epoch: 2, Steps: 64 | Train Loss: 0.6907264 Vali Loss: 0.9368917 Test Loss: 1.3962101
Validation loss decreased (2.743716 --> 0.936892).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 3 cost time: 0.9074571132659912
Epoch: 3, Steps: 64 | Train Loss: 0.3111776 Vali Loss: 0.4615079 Test Loss: 0.5144596
Validation loss decreased (0.936892 --> 0.461508).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 4 cost time: 0.9129996299743652
Epoch: 4, Steps: 64 | Train Loss: 0.2031983 Vali Loss: 0.3616515 Test Loss: 0.3933747
Validation loss decreased (0.461508 --> 0.361651).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 5 cost time: 0.9106295108795166
Epoch: 5, Steps: 64 | Train Loss: 0.1683810 Vali Loss: 0.3003849 Test Loss: 0.3434930
Validation loss decreased (0.361651 --> 0.300385).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 6 cost time: 0.8982019424438477
Epoch: 6, Steps: 64 | Train Loss: 0.1530019 Vali Loss: 0.2820053 Test Loss: 0.3248103
Validation loss decreased (0.300385 --> 0.282005).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 7 cost time: 0.8984777927398682
Epoch: 7, Steps: 64 | Train Loss: 0.1432455 Vali Loss: 0.2643323 Test Loss: 0.3130909
Validation loss decreased (0.282005 --> 0.264332).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 8 cost time: 0.9053778648376465
Epoch: 8, Steps: 64 | Train Loss: 0.1346414 Vali Loss: 0.2531396 Test Loss: 0.3074693
Validation loss decreased (0.264332 --> 0.253140).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 9 cost time: 0.9007601737976074
Epoch: 9, Steps: 64 | Train Loss: 0.1307488 Vali Loss: 0.2442698 Test Loss: 0.3033085
Validation loss decreased (0.253140 --> 0.244270).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 10 cost time: 0.9030001163482666
Epoch: 10, Steps: 64 | Train Loss: 0.1267222 Vali Loss: 0.2414873 Test Loss: 0.2991664
Validation loss decreased (0.244270 --> 0.241487).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 11 cost time: 0.9203455448150635
Epoch: 11, Steps: 64 | Train Loss: 0.1229078 Vali Loss: 0.2382604 Test Loss: 0.2939703
Validation loss decreased (0.241487 --> 0.238260).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 12 cost time: 0.9876236915588379
Epoch: 12, Steps: 64 | Train Loss: 0.1203912 Vali Loss: 0.2365887 Test Loss: 0.2920328
Validation loss decreased (0.238260 --> 0.236589).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 13 cost time: 0.9873847961425781
Epoch: 13, Steps: 64 | Train Loss: 0.1178211 Vali Loss: 0.2336041 Test Loss: 0.2912129
Validation loss decreased (0.236589 --> 0.233604).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 14 cost time: 0.9123589992523193
Epoch: 14, Steps: 64 | Train Loss: 0.1158510 Vali Loss: 0.2302582 Test Loss: 0.2896952
Validation loss decreased (0.233604 --> 0.230258).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 15 cost time: 0.9133906364440918
Epoch: 15, Steps: 64 | Train Loss: 0.1136013 Vali Loss: 0.2295636 Test Loss: 0.2858848
Validation loss decreased (0.230258 --> 0.229564).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 16 cost time: 0.8985517024993896
Epoch: 16, Steps: 64 | Train Loss: 0.1129684 Vali Loss: 0.2296526 Test Loss: 0.2859594
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 17 cost time: 0.8997666835784912
Epoch: 17, Steps: 64 | Train Loss: 0.1108225 Vali Loss: 0.2241478 Test Loss: 0.2857694
Validation loss decreased (0.229564 --> 0.224148).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 18 cost time: 0.9079999923706055
Epoch: 18, Steps: 64 | Train Loss: 0.1107165 Vali Loss: 0.2257217 Test Loss: 0.2868084
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 19 cost time: 0.9086208343505859
Epoch: 19, Steps: 64 | Train Loss: 0.1088147 Vali Loss: 0.2246988 Test Loss: 0.2843594
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 20 cost time: 0.9135463237762451
Epoch: 20, Steps: 64 | Train Loss: 0.1083327 Vali Loss: 0.2221949 Test Loss: 0.2845522
Validation loss decreased (0.224148 --> 0.222195).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 21 cost time: 0.9113640785217285
Epoch: 21, Steps: 64 | Train Loss: 0.1073476 Vali Loss: 0.2220958 Test Loss: 0.2812825
Validation loss decreased (0.222195 --> 0.222096).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 22 cost time: 0.8953311443328857
Epoch: 22, Steps: 64 | Train Loss: 0.1071792 Vali Loss: 0.2181630 Test Loss: 0.2800832
Validation loss decreased (0.222096 --> 0.218163).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 23 cost time: 0.9184525012969971
Epoch: 23, Steps: 64 | Train Loss: 0.1065115 Vali Loss: 0.2221015 Test Loss: 0.2815390
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 24 cost time: 0.9120891094207764
Epoch: 24, Steps: 64 | Train Loss: 0.1063717 Vali Loss: 0.2202772 Test Loss: 0.2828026
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 25 cost time: 0.913999080657959
Epoch: 25, Steps: 64 | Train Loss: 0.1058065 Vali Loss: 0.2183676 Test Loss: 0.2796803
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 26 cost time: 0.8925652503967285
Epoch: 26, Steps: 64 | Train Loss: 0.1053644 Vali Loss: 0.2188249 Test Loss: 0.2810770
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 27 cost time: 0.9113631248474121
Epoch: 27, Steps: 64 | Train Loss: 0.1042696 Vali Loss: 0.2214574 Test Loss: 0.2796262
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 28 cost time: 0.9179205894470215
Epoch: 28, Steps: 64 | Train Loss: 0.1049049 Vali Loss: 0.2218689 Test Loss: 0.2803965
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 29 cost time: 0.906358003616333
Epoch: 29, Steps: 64 | Train Loss: 0.1044630 Vali Loss: 0.2195069 Test Loss: 0.2793141
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 30 cost time: 0.9087953567504883
Epoch: 30, Steps: 64 | Train Loss: 0.1034018 Vali Loss: 0.2189333 Test Loss: 0.2837474
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 31 cost time: 0.9069998264312744
Epoch: 31, Steps: 64 | Train Loss: 0.1035455 Vali Loss: 0.2187460 Test Loss: 0.2785698
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 32 cost time: 0.9186205863952637
Epoch: 32, Steps: 64 | Train Loss: 0.1033749 Vali Loss: 0.2139587 Test Loss: 0.2807259
Validation loss decreased (0.218163 --> 0.213959).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 33 cost time: 0.9022543430328369
Epoch: 33, Steps: 64 | Train Loss: 0.1027806 Vali Loss: 0.2162665 Test Loss: 0.2787257
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 34 cost time: 0.9023725986480713
Epoch: 34, Steps: 64 | Train Loss: 0.1029408 Vali Loss: 0.2180355 Test Loss: 0.2802767
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 35 cost time: 0.9084267616271973
Epoch: 35, Steps: 64 | Train Loss: 0.1025896 Vali Loss: 0.2160843 Test Loss: 0.2800264
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 36 cost time: 0.9127287864685059
Epoch: 36, Steps: 64 | Train Loss: 0.1014815 Vali Loss: 0.2178368 Test Loss: 0.2790539
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 37 cost time: 0.9054744243621826
Epoch: 37, Steps: 64 | Train Loss: 0.1029104 Vali Loss: 0.2148828 Test Loss: 0.2782139
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 38 cost time: 0.9120001792907715
Epoch: 38, Steps: 64 | Train Loss: 0.1018557 Vali Loss: 0.2171777 Test Loss: 0.2778768
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 39 cost time: 0.9123458862304688
Epoch: 39, Steps: 64 | Train Loss: 0.1026609 Vali Loss: 0.2176109 Test Loss: 0.2802884
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 40 cost time: 0.9903972148895264
Epoch: 40, Steps: 64 | Train Loss: 0.1022547 Vali Loss: 0.2164318 Test Loss: 0.2799720
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 41 cost time: 0.9521160125732422
Epoch: 41, Steps: 64 | Train Loss: 0.1015473 Vali Loss: 0.2166099 Test Loss: 0.2782259
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 42 cost time: 0.9024193286895752
Epoch: 42, Steps: 64 | Train Loss: 0.1014929 Vali Loss: 0.2165657 Test Loss: 0.2791241
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 43 cost time: 0.9048519134521484
Epoch: 43, Steps: 64 | Train Loss: 0.1017865 Vali Loss: 0.2157623 Test Loss: 0.2773149
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 44 cost time: 0.9009995460510254
Epoch: 44, Steps: 64 | Train Loss: 0.1016569 Vali Loss: 0.2141594 Test Loss: 0.2792553
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 45 cost time: 0.9049999713897705
Epoch: 45, Steps: 64 | Train Loss: 0.1017424 Vali Loss: 0.2166743 Test Loss: 0.2766437
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 46 cost time: 0.9068269729614258
Epoch: 46, Steps: 64 | Train Loss: 0.1021043 Vali Loss: 0.2160612 Test Loss: 0.2791901
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 47 cost time: 0.8947460651397705
Epoch: 47, Steps: 64 | Train Loss: 0.1018494 Vali Loss: 0.2171705 Test Loss: 0.2809830
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 48 cost time: 0.9064176082611084
Epoch: 48, Steps: 64 | Train Loss: 0.1008869 Vali Loss: 0.2171438 Test Loss: 0.2767374
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 49 cost time: 0.9104180335998535
Epoch: 49, Steps: 64 | Train Loss: 0.1009728 Vali Loss: 0.2159339 Test Loss: 0.2791006
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 50 cost time: 0.9107530117034912
Epoch: 50, Steps: 64 | Train Loss: 0.1009711 Vali Loss: 0.2153996 Test Loss: 0.2792743
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 51 cost time: 0.8989999294281006
Epoch: 51, Steps: 64 | Train Loss: 0.1017025 Vali Loss: 0.2136237 Test Loss: 0.2768848
Validation loss decreased (0.213959 --> 0.213624).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 52 cost time: 0.899620771408081
Epoch: 52, Steps: 64 | Train Loss: 0.1017999 Vali Loss: 0.2146497 Test Loss: 0.2814928
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 53 cost time: 0.9053676128387451
Epoch: 53, Steps: 64 | Train Loss: 0.1013033 Vali Loss: 0.2163661 Test Loss: 0.2806776
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 54 cost time: 0.9087872505187988
Epoch: 54, Steps: 64 | Train Loss: 0.1014698 Vali Loss: 0.2163692 Test Loss: 0.2787208
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 55 cost time: 0.9016819000244141
Epoch: 55, Steps: 64 | Train Loss: 0.1015026 Vali Loss: 0.2177716 Test Loss: 0.2769311
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 56 cost time: 0.9047343730926514
Epoch: 56, Steps: 64 | Train Loss: 0.1012636 Vali Loss: 0.2166581 Test Loss: 0.2780580
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 57 cost time: 0.9159996509552002
Epoch: 57, Steps: 64 | Train Loss: 0.1007232 Vali Loss: 0.2166715 Test Loss: 0.2775920
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 58 cost time: 0.9116256237030029
Epoch: 58, Steps: 64 | Train Loss: 0.1005064 Vali Loss: 0.2150045 Test Loss: 0.2798168
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 59 cost time: 0.9103951454162598
Epoch: 59, Steps: 64 | Train Loss: 0.1014411 Vali Loss: 0.2132534 Test Loss: 0.2754443
Validation loss decreased (0.213624 --> 0.213253).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 60 cost time: 0.9033651351928711
Epoch: 60, Steps: 64 | Train Loss: 0.1010653 Vali Loss: 0.2163195 Test Loss: 0.2796203
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.27544423937797546, mae:0.33908596634864807, rse:0.24087385833263397
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04678010940551758 GB
Epoch: 1 cost time: 2.2933080196380615
Epoch: 1, Steps: 64 | Train Loss: 0.9002114 Vali Loss: 2.6527538 Test Loss: 4.6819468
Validation loss decreased (inf --> 2.652754).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 2 cost time: 0.936964750289917
Epoch: 2, Steps: 64 | Train Loss: 0.5550097 Vali Loss: 0.8658692 Test Loss: 1.2438940
Validation loss decreased (2.652754 --> 0.865869).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 3 cost time: 1.0115184783935547
Epoch: 3, Steps: 64 | Train Loss: 0.2047428 Vali Loss: 0.3906452 Test Loss: 0.3925906
Validation loss decreased (0.865869 --> 0.390645).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 4 cost time: 0.9488513469696045
Epoch: 4, Steps: 64 | Train Loss: 0.1238704 Vali Loss: 0.2878337 Test Loss: 0.2965785
Validation loss decreased (0.390645 --> 0.287834).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 5 cost time: 0.9306213855743408
Epoch: 5, Steps: 64 | Train Loss: 0.1093520 Vali Loss: 0.2575757 Test Loss: 0.2895406
Validation loss decreased (0.287834 --> 0.257576).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 6 cost time: 0.9276251792907715
Epoch: 6, Steps: 64 | Train Loss: 0.1032878 Vali Loss: 0.2437729 Test Loss: 0.2863961
Validation loss decreased (0.257576 --> 0.243773).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 7 cost time: 0.9396064281463623
Epoch: 7, Steps: 64 | Train Loss: 0.0994689 Vali Loss: 0.2393268 Test Loss: 0.2853212
Validation loss decreased (0.243773 --> 0.239327).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 8 cost time: 0.9312746524810791
Epoch: 8, Steps: 64 | Train Loss: 0.0965045 Vali Loss: 0.2357019 Test Loss: 0.2814510
Validation loss decreased (0.239327 --> 0.235702).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 9 cost time: 0.9330236911773682
Epoch: 9, Steps: 64 | Train Loss: 0.0942527 Vali Loss: 0.2269485 Test Loss: 0.2818239
Validation loss decreased (0.235702 --> 0.226949).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 10 cost time: 0.933621883392334
Epoch: 10, Steps: 64 | Train Loss: 0.0929115 Vali Loss: 0.2265608 Test Loss: 0.2806782
Validation loss decreased (0.226949 --> 0.226561).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 11 cost time: 0.9514164924621582
Epoch: 11, Steps: 64 | Train Loss: 0.0910819 Vali Loss: 0.2269145 Test Loss: 0.2804473
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 12 cost time: 0.9338581562042236
Epoch: 12, Steps: 64 | Train Loss: 0.0895563 Vali Loss: 0.2225520 Test Loss: 0.2789592
Validation loss decreased (0.226561 --> 0.222552).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 13 cost time: 0.9374134540557861
Epoch: 13, Steps: 64 | Train Loss: 0.0885100 Vali Loss: 0.2194945 Test Loss: 0.2793073
Validation loss decreased (0.222552 --> 0.219495).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 14 cost time: 0.9466361999511719
Epoch: 14, Steps: 64 | Train Loss: 0.0877725 Vali Loss: 0.2207176 Test Loss: 0.2774257
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 15 cost time: 0.9386122226715088
Epoch: 15, Steps: 64 | Train Loss: 0.0867665 Vali Loss: 0.2184813 Test Loss: 0.2759849
Validation loss decreased (0.219495 --> 0.218481).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 16 cost time: 0.9403831958770752
Epoch: 16, Steps: 64 | Train Loss: 0.0860936 Vali Loss: 0.2163807 Test Loss: 0.2770868
Validation loss decreased (0.218481 --> 0.216381).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 17 cost time: 0.9384064674377441
Epoch: 17, Steps: 64 | Train Loss: 0.0854667 Vali Loss: 0.2160741 Test Loss: 0.2753690
Validation loss decreased (0.216381 --> 0.216074).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 18 cost time: 0.9414024353027344
Epoch: 18, Steps: 64 | Train Loss: 0.0852309 Vali Loss: 0.2159217 Test Loss: 0.2749499
Validation loss decreased (0.216074 --> 0.215922).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 19 cost time: 0.9426009654998779
Epoch: 19, Steps: 64 | Train Loss: 0.0847364 Vali Loss: 0.2160209 Test Loss: 0.2749149
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 20 cost time: 0.9458553791046143
Epoch: 20, Steps: 64 | Train Loss: 0.0839900 Vali Loss: 0.2140735 Test Loss: 0.2780445
Validation loss decreased (0.215922 --> 0.214074).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 21 cost time: 0.9391047954559326
Epoch: 21, Steps: 64 | Train Loss: 0.0840186 Vali Loss: 0.2145278 Test Loss: 0.2761295
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 22 cost time: 0.9346268177032471
Epoch: 22, Steps: 64 | Train Loss: 0.0834471 Vali Loss: 0.2119991 Test Loss: 0.2740898
Validation loss decreased (0.214074 --> 0.211999).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 23 cost time: 0.9306440353393555
Epoch: 23, Steps: 64 | Train Loss: 0.0831719 Vali Loss: 0.2115341 Test Loss: 0.2745567
Validation loss decreased (0.211999 --> 0.211534).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 24 cost time: 0.9393711090087891
Epoch: 24, Steps: 64 | Train Loss: 0.0829845 Vali Loss: 0.2123439 Test Loss: 0.2745699
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 25 cost time: 0.9139835834503174
Epoch: 25, Steps: 64 | Train Loss: 0.0823784 Vali Loss: 0.2099202 Test Loss: 0.2729376
Validation loss decreased (0.211534 --> 0.209920).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 26 cost time: 0.93044114112854
Epoch: 26, Steps: 64 | Train Loss: 0.0820796 Vali Loss: 0.2101332 Test Loss: 0.2749811
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 27 cost time: 0.9383435249328613
Epoch: 27, Steps: 64 | Train Loss: 0.0824794 Vali Loss: 0.2085989 Test Loss: 0.2739030
Validation loss decreased (0.209920 --> 0.208599).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 28 cost time: 0.9487414360046387
Epoch: 28, Steps: 64 | Train Loss: 0.0818459 Vali Loss: 0.2076323 Test Loss: 0.2721149
Validation loss decreased (0.208599 --> 0.207632).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 29 cost time: 0.9350008964538574
Epoch: 29, Steps: 64 | Train Loss: 0.0813943 Vali Loss: 0.2074066 Test Loss: 0.2720807
Validation loss decreased (0.207632 --> 0.207407).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 30 cost time: 0.9335782527923584
Epoch: 30, Steps: 64 | Train Loss: 0.0818495 Vali Loss: 0.2100038 Test Loss: 0.2736543
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 31 cost time: 0.944443941116333
Epoch: 31, Steps: 64 | Train Loss: 0.0815577 Vali Loss: 0.2104046 Test Loss: 0.2745871
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 32 cost time: 0.9313516616821289
Epoch: 32, Steps: 64 | Train Loss: 0.0813414 Vali Loss: 0.2107388 Test Loss: 0.2730791
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 33 cost time: 0.9343216419219971
Epoch: 33, Steps: 64 | Train Loss: 0.0814081 Vali Loss: 0.2097043 Test Loss: 0.2725176
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 34 cost time: 0.9312794208526611
Epoch: 34, Steps: 64 | Train Loss: 0.0808285 Vali Loss: 0.2074146 Test Loss: 0.2715405
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 35 cost time: 0.9407086372375488
Epoch: 35, Steps: 64 | Train Loss: 0.0809411 Vali Loss: 0.2099765 Test Loss: 0.2723709
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 36 cost time: 0.9347538948059082
Epoch: 36, Steps: 64 | Train Loss: 0.0807762 Vali Loss: 0.2071885 Test Loss: 0.2725905
Validation loss decreased (0.207407 --> 0.207188).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 37 cost time: 0.9353799819946289
Epoch: 37, Steps: 64 | Train Loss: 0.0806756 Vali Loss: 0.2065658 Test Loss: 0.2734639
Validation loss decreased (0.207188 --> 0.206566).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 38 cost time: 0.9526140689849854
Epoch: 38, Steps: 64 | Train Loss: 0.0808501 Vali Loss: 0.2085242 Test Loss: 0.2737529
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 39 cost time: 0.935621976852417
Epoch: 39, Steps: 64 | Train Loss: 0.0805626 Vali Loss: 0.2036396 Test Loss: 0.2729627
Validation loss decreased (0.206566 --> 0.203640).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 40 cost time: 0.9373939037322998
Epoch: 40, Steps: 64 | Train Loss: 0.0804881 Vali Loss: 0.2047266 Test Loss: 0.2725808
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 41 cost time: 0.9273443222045898
Epoch: 41, Steps: 64 | Train Loss: 0.0806331 Vali Loss: 0.2049998 Test Loss: 0.2705668
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 42 cost time: 0.9264416694641113
Epoch: 42, Steps: 64 | Train Loss: 0.0801550 Vali Loss: 0.2080670 Test Loss: 0.2718953
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 43 cost time: 0.9312319755554199
Epoch: 43, Steps: 64 | Train Loss: 0.0803478 Vali Loss: 0.2059783 Test Loss: 0.2727218
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 44 cost time: 0.9250009059906006
Epoch: 44, Steps: 64 | Train Loss: 0.0802232 Vali Loss: 0.2075409 Test Loss: 0.2704238
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 45 cost time: 0.9376280307769775
Epoch: 45, Steps: 64 | Train Loss: 0.0802940 Vali Loss: 0.2053194 Test Loss: 0.2747869
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 46 cost time: 0.9336111545562744
Epoch: 46, Steps: 64 | Train Loss: 0.0801989 Vali Loss: 0.2039581 Test Loss: 0.2698657
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 47 cost time: 0.9316787719726562
Epoch: 47, Steps: 64 | Train Loss: 0.0804581 Vali Loss: 0.2057910 Test Loss: 0.2710786
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 48 cost time: 0.9364898204803467
Epoch: 48, Steps: 64 | Train Loss: 0.0801882 Vali Loss: 0.2047203 Test Loss: 0.2719603
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 49 cost time: 0.9353587627410889
Epoch: 49, Steps: 64 | Train Loss: 0.0799131 Vali Loss: 0.2065251 Test Loss: 0.2713993
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 50 cost time: 0.9293689727783203
Epoch: 50, Steps: 64 | Train Loss: 0.0801746 Vali Loss: 0.2041458 Test Loss: 0.2708180
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 51 cost time: 0.9328677654266357
Epoch: 51, Steps: 64 | Train Loss: 0.0806361 Vali Loss: 0.2076149 Test Loss: 0.2733144
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 52 cost time: 0.9426932334899902
Epoch: 52, Steps: 64 | Train Loss: 0.0797295 Vali Loss: 0.2047698 Test Loss: 0.2715676
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 53 cost time: 0.931628942489624
Epoch: 53, Steps: 64 | Train Loss: 0.0796664 Vali Loss: 0.2047856 Test Loss: 0.2708123
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 54 cost time: 0.9383633136749268
Epoch: 54, Steps: 64 | Train Loss: 0.0799838 Vali Loss: 0.2075510 Test Loss: 0.2705451
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 55 cost time: 0.9413385391235352
Epoch: 55, Steps: 64 | Train Loss: 0.0801171 Vali Loss: 0.2067432 Test Loss: 0.2703623
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 56 cost time: 1.0192019939422607
Epoch: 56, Steps: 64 | Train Loss: 0.0799279 Vali Loss: 0.2060716 Test Loss: 0.2701460
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 57 cost time: 1.0274786949157715
Epoch: 57, Steps: 64 | Train Loss: 0.0798172 Vali Loss: 0.2052412 Test Loss: 0.2699016
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 58 cost time: 1.0203843116760254
Epoch: 58, Steps: 64 | Train Loss: 0.0800282 Vali Loss: 0.2032695 Test Loss: 0.2700555
Validation loss decreased (0.203640 --> 0.203269).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 59 cost time: 0.9342892169952393
Epoch: 59, Steps: 64 | Train Loss: 0.0800063 Vali Loss: 0.2057885 Test Loss: 0.2703829
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 60 cost time: 0.9314014911651611
Epoch: 60, Steps: 64 | Train Loss: 0.0798621 Vali Loss: 0.2076305 Test Loss: 0.2720717
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.27005550265312195, mae:0.330885648727417, rse:0.2385060042142868
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04790019989013672 GB
Epoch: 1 cost time: 2.3243870735168457
Epoch: 1, Steps: 64 | Train Loss: 0.8312525 Vali Loss: 2.5542529 Test Loss: 4.5155020
Validation loss decreased (inf --> 2.554253).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 2 cost time: 0.9619824886322021
Epoch: 2, Steps: 64 | Train Loss: 0.5525358 Vali Loss: 0.8557700 Test Loss: 1.2838897
Validation loss decreased (2.554253 --> 0.855770).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 3 cost time: 1.050633192062378
Epoch: 3, Steps: 64 | Train Loss: 0.1819905 Vali Loss: 0.3188100 Test Loss: 0.3214399
Validation loss decreased (0.855770 --> 0.318810).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 4 cost time: 1.0516955852508545
Epoch: 4, Steps: 64 | Train Loss: 0.1084155 Vali Loss: 0.2642622 Test Loss: 0.3011309
Validation loss decreased (0.318810 --> 0.264262).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 5 cost time: 1.015660285949707
Epoch: 5, Steps: 64 | Train Loss: 0.0987511 Vali Loss: 0.2467039 Test Loss: 0.2918764
Validation loss decreased (0.264262 --> 0.246704).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 6 cost time: 0.9623687267303467
Epoch: 6, Steps: 64 | Train Loss: 0.0938911 Vali Loss: 0.2381331 Test Loss: 0.2893065
Validation loss decreased (0.246704 --> 0.238133).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 7 cost time: 0.965364933013916
Epoch: 7, Steps: 64 | Train Loss: 0.0914431 Vali Loss: 0.2355692 Test Loss: 0.2863680
Validation loss decreased (0.238133 --> 0.235569).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 8 cost time: 0.9736921787261963
Epoch: 8, Steps: 64 | Train Loss: 0.0890323 Vali Loss: 0.2286974 Test Loss: 0.2842503
Validation loss decreased (0.235569 --> 0.228697).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 9 cost time: 0.9643580913543701
Epoch: 9, Steps: 64 | Train Loss: 0.0875709 Vali Loss: 0.2303096 Test Loss: 0.2827622
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 10 cost time: 0.9715158939361572
Epoch: 10, Steps: 64 | Train Loss: 0.0859906 Vali Loss: 0.2254522 Test Loss: 0.2828390
Validation loss decreased (0.228697 --> 0.225452).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 11 cost time: 0.9723999500274658
Epoch: 11, Steps: 64 | Train Loss: 0.0849984 Vali Loss: 0.2245557 Test Loss: 0.2829288
Validation loss decreased (0.225452 --> 0.224556).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 12 cost time: 0.9739181995391846
Epoch: 12, Steps: 64 | Train Loss: 0.0842086 Vali Loss: 0.2205547 Test Loss: 0.2814083
Validation loss decreased (0.224556 --> 0.220555).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 13 cost time: 0.9648113250732422
Epoch: 13, Steps: 64 | Train Loss: 0.0833252 Vali Loss: 0.2193991 Test Loss: 0.2796191
Validation loss decreased (0.220555 --> 0.219399).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 14 cost time: 0.9670002460479736
Epoch: 14, Steps: 64 | Train Loss: 0.0826041 Vali Loss: 0.2182200 Test Loss: 0.2808240
Validation loss decreased (0.219399 --> 0.218220).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 15 cost time: 0.974942684173584
Epoch: 15, Steps: 64 | Train Loss: 0.0821194 Vali Loss: 0.2172090 Test Loss: 0.2816164
Validation loss decreased (0.218220 --> 0.217209).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 16 cost time: 1.057537317276001
Epoch: 16, Steps: 64 | Train Loss: 0.0817507 Vali Loss: 0.2139734 Test Loss: 0.2793722
Validation loss decreased (0.217209 --> 0.213973).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 17 cost time: 1.046614170074463
Epoch: 17, Steps: 64 | Train Loss: 0.0812798 Vali Loss: 0.2147964 Test Loss: 0.2773713
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 18 cost time: 1.0253734588623047
Epoch: 18, Steps: 64 | Train Loss: 0.0802989 Vali Loss: 0.2147389 Test Loss: 0.2775154
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 19 cost time: 0.974360466003418
Epoch: 19, Steps: 64 | Train Loss: 0.0802081 Vali Loss: 0.2119318 Test Loss: 0.2786884
Validation loss decreased (0.213973 --> 0.211932).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 20 cost time: 0.9667179584503174
Epoch: 20, Steps: 64 | Train Loss: 0.0803080 Vali Loss: 0.2118032 Test Loss: 0.2782245
Validation loss decreased (0.211932 --> 0.211803).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 21 cost time: 0.9783897399902344
Epoch: 21, Steps: 64 | Train Loss: 0.0797781 Vali Loss: 0.2116653 Test Loss: 0.2757091
Validation loss decreased (0.211803 --> 0.211665).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 22 cost time: 0.9634521007537842
Epoch: 22, Steps: 64 | Train Loss: 0.0792485 Vali Loss: 0.2102733 Test Loss: 0.2772941
Validation loss decreased (0.211665 --> 0.210273).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 23 cost time: 0.9592351913452148
Epoch: 23, Steps: 64 | Train Loss: 0.0790768 Vali Loss: 0.2107397 Test Loss: 0.2761073
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 24 cost time: 0.9607162475585938
Epoch: 24, Steps: 64 | Train Loss: 0.0792510 Vali Loss: 0.2085641 Test Loss: 0.2746939
Validation loss decreased (0.210273 --> 0.208564).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 25 cost time: 0.9367380142211914
Epoch: 25, Steps: 64 | Train Loss: 0.0788830 Vali Loss: 0.2083982 Test Loss: 0.2742745
Validation loss decreased (0.208564 --> 0.208398).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 26 cost time: 0.9589986801147461
Epoch: 26, Steps: 64 | Train Loss: 0.0786195 Vali Loss: 0.2061408 Test Loss: 0.2766958
Validation loss decreased (0.208398 --> 0.206141).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 27 cost time: 0.9696133136749268
Epoch: 27, Steps: 64 | Train Loss: 0.0788221 Vali Loss: 0.2080390 Test Loss: 0.2740676
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 28 cost time: 0.960392951965332
Epoch: 28, Steps: 64 | Train Loss: 0.0778150 Vali Loss: 0.2075474 Test Loss: 0.2745348
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 29 cost time: 0.965376615524292
Epoch: 29, Steps: 64 | Train Loss: 0.0776345 Vali Loss: 0.2041644 Test Loss: 0.2730573
Validation loss decreased (0.206141 --> 0.204164).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 30 cost time: 0.9683647155761719
Epoch: 30, Steps: 64 | Train Loss: 0.0780415 Vali Loss: 0.2055130 Test Loss: 0.2735326
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 31 cost time: 0.9613683223724365
Epoch: 31, Steps: 64 | Train Loss: 0.0779572 Vali Loss: 0.2066753 Test Loss: 0.2745029
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 32 cost time: 0.9613232612609863
Epoch: 32, Steps: 64 | Train Loss: 0.0779093 Vali Loss: 0.2042510 Test Loss: 0.2724524
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 33 cost time: 0.9610979557037354
Epoch: 33, Steps: 64 | Train Loss: 0.0780507 Vali Loss: 0.2041364 Test Loss: 0.2740747
Validation loss decreased (0.204164 --> 0.204136).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 34 cost time: 0.9607715606689453
Epoch: 34, Steps: 64 | Train Loss: 0.0774791 Vali Loss: 0.2034697 Test Loss: 0.2721851
Validation loss decreased (0.204136 --> 0.203470).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 35 cost time: 0.9759995937347412
Epoch: 35, Steps: 64 | Train Loss: 0.0772104 Vali Loss: 0.2052927 Test Loss: 0.2721618
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 36 cost time: 0.9690015316009521
Epoch: 36, Steps: 64 | Train Loss: 0.0773463 Vali Loss: 0.2057619 Test Loss: 0.2731325
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 37 cost time: 0.9696273803710938
Epoch: 37, Steps: 64 | Train Loss: 0.0769654 Vali Loss: 0.2047803 Test Loss: 0.2728344
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 38 cost time: 0.9803447723388672
Epoch: 38, Steps: 64 | Train Loss: 0.0773522 Vali Loss: 0.2017407 Test Loss: 0.2726720
Validation loss decreased (0.203470 --> 0.201741).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 39 cost time: 0.9673910140991211
Epoch: 39, Steps: 64 | Train Loss: 0.0774318 Vali Loss: 0.2028875 Test Loss: 0.2721952
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 40 cost time: 0.957402229309082
Epoch: 40, Steps: 64 | Train Loss: 0.0771451 Vali Loss: 0.2037141 Test Loss: 0.2725144
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 41 cost time: 0.9607234001159668
Epoch: 41, Steps: 64 | Train Loss: 0.0773771 Vali Loss: 0.2039579 Test Loss: 0.2711380
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 42 cost time: 0.9603748321533203
Epoch: 42, Steps: 64 | Train Loss: 0.0769562 Vali Loss: 0.2033551 Test Loss: 0.2728777
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 43 cost time: 0.959770917892456
Epoch: 43, Steps: 64 | Train Loss: 0.0771072 Vali Loss: 0.2010586 Test Loss: 0.2722308
Validation loss decreased (0.201741 --> 0.201059).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 44 cost time: 0.9809093475341797
Epoch: 44, Steps: 64 | Train Loss: 0.0769065 Vali Loss: 0.2010871 Test Loss: 0.2720651
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 45 cost time: 0.9494361877441406
Epoch: 45, Steps: 64 | Train Loss: 0.0769038 Vali Loss: 0.2011812 Test Loss: 0.2720200
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 46 cost time: 0.9686088562011719
Epoch: 46, Steps: 64 | Train Loss: 0.0774560 Vali Loss: 0.2018381 Test Loss: 0.2718623
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 47 cost time: 0.9716231822967529
Epoch: 47, Steps: 64 | Train Loss: 0.0770177 Vali Loss: 0.2006730 Test Loss: 0.2727011
Validation loss decreased (0.201059 --> 0.200673).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 48 cost time: 0.97536301612854
Epoch: 48, Steps: 64 | Train Loss: 0.0766559 Vali Loss: 0.2026088 Test Loss: 0.2718619
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 49 cost time: 0.9623405933380127
Epoch: 49, Steps: 64 | Train Loss: 0.0766770 Vali Loss: 0.2023693 Test Loss: 0.2713951
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 50 cost time: 0.9694118499755859
Epoch: 50, Steps: 64 | Train Loss: 0.0769068 Vali Loss: 0.2026143 Test Loss: 0.2725844
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 51 cost time: 0.9654219150543213
Epoch: 51, Steps: 64 | Train Loss: 0.0771172 Vali Loss: 0.2019280 Test Loss: 0.2735354
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 52 cost time: 0.9664294719696045
Epoch: 52, Steps: 64 | Train Loss: 0.0769338 Vali Loss: 0.2014290 Test Loss: 0.2723005
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 53 cost time: 0.9673972129821777
Epoch: 53, Steps: 64 | Train Loss: 0.0773769 Vali Loss: 0.2022486 Test Loss: 0.2717576
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 54 cost time: 0.9700610637664795
Epoch: 54, Steps: 64 | Train Loss: 0.0768376 Vali Loss: 0.2029172 Test Loss: 0.2730773
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 55 cost time: 0.9850001335144043
Epoch: 55, Steps: 64 | Train Loss: 0.0767895 Vali Loss: 0.2009145 Test Loss: 0.2728508
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 56 cost time: 0.9835605621337891
Epoch: 56, Steps: 64 | Train Loss: 0.0771601 Vali Loss: 0.2033905 Test Loss: 0.2706653
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 57 cost time: 0.9694969654083252
Epoch: 57, Steps: 64 | Train Loss: 0.0767807 Vali Loss: 0.2011182 Test Loss: 0.2711816
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 58 cost time: 0.9773991107940674
Epoch: 58, Steps: 64 | Train Loss: 0.0766207 Vali Loss: 0.1995509 Test Loss: 0.2719558
Validation loss decreased (0.200673 --> 0.199551).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 59 cost time: 0.9496564865112305
Epoch: 59, Steps: 64 | Train Loss: 0.0765142 Vali Loss: 0.2021962 Test Loss: 0.2718118
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 60 cost time: 0.9644439220428467
Epoch: 60, Steps: 64 | Train Loss: 0.0768226 Vali Loss: 0.2033169 Test Loss: 0.2710864
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.27195578813552856, mae:0.33325302600860596, rse:0.23934367299079895
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.045510292053222656 GB
Epoch: 1 cost time: 2.280432939529419
Epoch: 1, Steps: 64 | Train Loss: 1.1348334 Vali Loss: 3.0631540 Test Loss: 5.4863291
Validation loss decreased (inf --> 3.063154).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 2 cost time: 0.8951742649078369
Epoch: 2, Steps: 64 | Train Loss: 0.7379888 Vali Loss: 1.0835371 Test Loss: 1.7612472
Validation loss decreased (3.063154 --> 1.083537).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 3 cost time: 0.9120001792907715
Epoch: 3, Steps: 64 | Train Loss: 0.3534509 Vali Loss: 0.5900536 Test Loss: 0.8027698
Validation loss decreased (1.083537 --> 0.590054).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 4 cost time: 0.9189999103546143
Epoch: 4, Steps: 64 | Train Loss: 0.2234355 Vali Loss: 0.3953726 Test Loss: 0.4763412
Validation loss decreased (0.590054 --> 0.395373).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 5 cost time: 0.921630859375
Epoch: 5, Steps: 64 | Train Loss: 0.1738459 Vali Loss: 0.3204937 Test Loss: 0.3626266
Validation loss decreased (0.395373 --> 0.320494).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 6 cost time: 0.9071657657623291
Epoch: 6, Steps: 64 | Train Loss: 0.1522481 Vali Loss: 0.2941164 Test Loss: 0.3259129
Validation loss decreased (0.320494 --> 0.294116).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 7 cost time: 0.9123873710632324
Epoch: 7, Steps: 64 | Train Loss: 0.1411782 Vali Loss: 0.2758305 Test Loss: 0.3088892
Validation loss decreased (0.294116 --> 0.275831).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 8 cost time: 0.9094698429107666
Epoch: 8, Steps: 64 | Train Loss: 0.1340512 Vali Loss: 0.2661965 Test Loss: 0.3004073
Validation loss decreased (0.275831 --> 0.266196).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 9 cost time: 0.905148983001709
Epoch: 9, Steps: 64 | Train Loss: 0.1291818 Vali Loss: 0.2599950 Test Loss: 0.2937935
Validation loss decreased (0.266196 --> 0.259995).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 10 cost time: 0.9140000343322754
Epoch: 10, Steps: 64 | Train Loss: 0.1258619 Vali Loss: 0.2548081 Test Loss: 0.2900489
Validation loss decreased (0.259995 --> 0.254808).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 11 cost time: 0.9143948554992676
Epoch: 11, Steps: 64 | Train Loss: 0.1222859 Vali Loss: 0.2481250 Test Loss: 0.2892538
Validation loss decreased (0.254808 --> 0.248125).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 12 cost time: 0.9296302795410156
Epoch: 12, Steps: 64 | Train Loss: 0.1197817 Vali Loss: 0.2482278 Test Loss: 0.2880993
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 13 cost time: 0.9173400402069092
Epoch: 13, Steps: 64 | Train Loss: 0.1178422 Vali Loss: 0.2423664 Test Loss: 0.2865795
Validation loss decreased (0.248125 --> 0.242366).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 14 cost time: 0.9144444465637207
Epoch: 14, Steps: 64 | Train Loss: 0.1158603 Vali Loss: 0.2408752 Test Loss: 0.2853917
Validation loss decreased (0.242366 --> 0.240875).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 15 cost time: 0.9123644828796387
Epoch: 15, Steps: 64 | Train Loss: 0.1142231 Vali Loss: 0.2418945 Test Loss: 0.2857040
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 16 cost time: 0.9134058952331543
Epoch: 16, Steps: 64 | Train Loss: 0.1129081 Vali Loss: 0.2371436 Test Loss: 0.2842903
Validation loss decreased (0.240875 --> 0.237144).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 17 cost time: 0.9059998989105225
Epoch: 17, Steps: 64 | Train Loss: 0.1130127 Vali Loss: 0.2349972 Test Loss: 0.2832590
Validation loss decreased (0.237144 --> 0.234997).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 18 cost time: 0.9079999923706055
Epoch: 18, Steps: 64 | Train Loss: 0.1111643 Vali Loss: 0.2346305 Test Loss: 0.2851579
Validation loss decreased (0.234997 --> 0.234631).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 19 cost time: 0.9316215515136719
Epoch: 19, Steps: 64 | Train Loss: 0.1101766 Vali Loss: 0.2328966 Test Loss: 0.2837042
Validation loss decreased (0.234631 --> 0.232897).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 20 cost time: 0.9182372093200684
Epoch: 20, Steps: 64 | Train Loss: 0.1096154 Vali Loss: 0.2316855 Test Loss: 0.2821640
Validation loss decreased (0.232897 --> 0.231685).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 21 cost time: 0.9173529148101807
Epoch: 21, Steps: 64 | Train Loss: 0.1083703 Vali Loss: 0.2316304 Test Loss: 0.2834214
Validation loss decreased (0.231685 --> 0.231630).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 22 cost time: 0.9213285446166992
Epoch: 22, Steps: 64 | Train Loss: 0.1079399 Vali Loss: 0.2295547 Test Loss: 0.2825935
Validation loss decreased (0.231630 --> 0.229555).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 23 cost time: 0.8851418495178223
Epoch: 23, Steps: 64 | Train Loss: 0.1072287 Vali Loss: 0.2307433 Test Loss: 0.2830414
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 24 cost time: 0.9318125247955322
Epoch: 24, Steps: 64 | Train Loss: 0.1074229 Vali Loss: 0.2308101 Test Loss: 0.2835909
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 25 cost time: 0.9354562759399414
Epoch: 25, Steps: 64 | Train Loss: 0.1062593 Vali Loss: 0.2276436 Test Loss: 0.2833716
Validation loss decreased (0.229555 --> 0.227644).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 26 cost time: 0.9125971794128418
Epoch: 26, Steps: 64 | Train Loss: 0.1065332 Vali Loss: 0.2286835 Test Loss: 0.2815454
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 27 cost time: 0.9199528694152832
Epoch: 27, Steps: 64 | Train Loss: 0.1058753 Vali Loss: 0.2275105 Test Loss: 0.2822595
Validation loss decreased (0.227644 --> 0.227511).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 28 cost time: 0.9374415874481201
Epoch: 28, Steps: 64 | Train Loss: 0.1051473 Vali Loss: 0.2261517 Test Loss: 0.2819258
Validation loss decreased (0.227511 --> 0.226152).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 29 cost time: 0.947047233581543
Epoch: 29, Steps: 64 | Train Loss: 0.1048657 Vali Loss: 0.2261765 Test Loss: 0.2823615
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 30 cost time: 0.9185333251953125
Epoch: 30, Steps: 64 | Train Loss: 0.1050470 Vali Loss: 0.2259573 Test Loss: 0.2822798
Validation loss decreased (0.226152 --> 0.225957).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 31 cost time: 0.9168119430541992
Epoch: 31, Steps: 64 | Train Loss: 0.1051361 Vali Loss: 0.2272608 Test Loss: 0.2813121
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 32 cost time: 0.9170002937316895
Epoch: 32, Steps: 64 | Train Loss: 0.1049975 Vali Loss: 0.2251436 Test Loss: 0.2818632
Validation loss decreased (0.225957 --> 0.225144).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 33 cost time: 0.9209158420562744
Epoch: 33, Steps: 64 | Train Loss: 0.1040154 Vali Loss: 0.2262486 Test Loss: 0.2804327
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 34 cost time: 0.9103305339813232
Epoch: 34, Steps: 64 | Train Loss: 0.1043956 Vali Loss: 0.2237049 Test Loss: 0.2815290
Validation loss decreased (0.225144 --> 0.223705).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 35 cost time: 0.9063739776611328
Epoch: 35, Steps: 64 | Train Loss: 0.1038706 Vali Loss: 0.2223805 Test Loss: 0.2821088
Validation loss decreased (0.223705 --> 0.222381).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 36 cost time: 0.9204537868499756
Epoch: 36, Steps: 64 | Train Loss: 0.1037958 Vali Loss: 0.2264074 Test Loss: 0.2809032
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 37 cost time: 0.9195852279663086
Epoch: 37, Steps: 64 | Train Loss: 0.1033898 Vali Loss: 0.2231656 Test Loss: 0.2822185
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 38 cost time: 0.9254150390625
Epoch: 38, Steps: 64 | Train Loss: 0.1034082 Vali Loss: 0.2276500 Test Loss: 0.2815470
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 39 cost time: 0.9210002422332764
Epoch: 39, Steps: 64 | Train Loss: 0.1034445 Vali Loss: 0.2248794 Test Loss: 0.2813178
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 40 cost time: 0.9296233654022217
Epoch: 40, Steps: 64 | Train Loss: 0.1037825 Vali Loss: 0.2243988 Test Loss: 0.2802173
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 41 cost time: 0.9093527793884277
Epoch: 41, Steps: 64 | Train Loss: 0.1034984 Vali Loss: 0.2240737 Test Loss: 0.2811659
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 42 cost time: 0.906721830368042
Epoch: 42, Steps: 64 | Train Loss: 0.1032399 Vali Loss: 0.2237829 Test Loss: 0.2815805
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 43 cost time: 0.9087610244750977
Epoch: 43, Steps: 64 | Train Loss: 0.1026083 Vali Loss: 0.2268346 Test Loss: 0.2818397
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 44 cost time: 0.906449556350708
Epoch: 44, Steps: 64 | Train Loss: 0.1029884 Vali Loss: 0.2243388 Test Loss: 0.2803393
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 45 cost time: 0.9058215618133545
Epoch: 45, Steps: 64 | Train Loss: 0.1028878 Vali Loss: 0.2252551 Test Loss: 0.2813146
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 46 cost time: 0.9180002212524414
Epoch: 46, Steps: 64 | Train Loss: 0.1036724 Vali Loss: 0.2208663 Test Loss: 0.2810929
Validation loss decreased (0.222381 --> 0.220866).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 47 cost time: 0.9110062122344971
Epoch: 47, Steps: 64 | Train Loss: 0.1032436 Vali Loss: 0.2240817 Test Loss: 0.2810566
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 48 cost time: 0.910358190536499
Epoch: 48, Steps: 64 | Train Loss: 0.1024132 Vali Loss: 0.2235244 Test Loss: 0.2807653
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 49 cost time: 0.9163391590118408
Epoch: 49, Steps: 64 | Train Loss: 0.1023300 Vali Loss: 0.2247515 Test Loss: 0.2805851
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 50 cost time: 0.9204933643341064
Epoch: 50, Steps: 64 | Train Loss: 0.1025611 Vali Loss: 0.2248461 Test Loss: 0.2819679
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 51 cost time: 0.8976850509643555
Epoch: 51, Steps: 64 | Train Loss: 0.1027749 Vali Loss: 0.2231220 Test Loss: 0.2812694
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 52 cost time: 0.9336118698120117
Epoch: 52, Steps: 64 | Train Loss: 0.1024785 Vali Loss: 0.2259926 Test Loss: 0.2822864
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 53 cost time: 0.919517993927002
Epoch: 53, Steps: 64 | Train Loss: 0.1029432 Vali Loss: 0.2232238 Test Loss: 0.2804461
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 54 cost time: 0.926624059677124
Epoch: 54, Steps: 64 | Train Loss: 0.1026148 Vali Loss: 0.2211759 Test Loss: 0.2817325
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 55 cost time: 0.9184033870697021
Epoch: 55, Steps: 64 | Train Loss: 0.1025863 Vali Loss: 0.2251832 Test Loss: 0.2805285
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 56 cost time: 0.9191529750823975
Epoch: 56, Steps: 64 | Train Loss: 0.1021687 Vali Loss: 0.2250459 Test Loss: 0.2806582
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 57 cost time: 0.9245178699493408
Epoch: 57, Steps: 64 | Train Loss: 0.1021069 Vali Loss: 0.2248342 Test Loss: 0.2797798
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 58 cost time: 0.9938256740570068
Epoch: 58, Steps: 64 | Train Loss: 0.1018667 Vali Loss: 0.2263218 Test Loss: 0.2834313
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 59 cost time: 0.9833896160125732
Epoch: 59, Steps: 64 | Train Loss: 0.1019206 Vali Loss: 0.2245405 Test Loss: 0.2815699
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 60 cost time: 0.9097261428833008
Epoch: 60, Steps: 64 | Train Loss: 0.1027548 Vali Loss: 0.2233726 Test Loss: 0.2810071
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2810928225517273, mae:0.3365388810634613, rse:0.24333111941814423
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04694223403930664 GB
Epoch: 1 cost time: 2.231621742248535
Epoch: 1, Steps: 64 | Train Loss: 0.9352782 Vali Loss: 2.7724538 Test Loss: 4.8933549
Validation loss decreased (inf --> 2.772454).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 2 cost time: 0.8643274307250977
Epoch: 2, Steps: 64 | Train Loss: 0.5472604 Vali Loss: 0.7359279 Test Loss: 1.0633621
Validation loss decreased (2.772454 --> 0.735928).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 3 cost time: 0.8923547267913818
Epoch: 3, Steps: 64 | Train Loss: 0.1743089 Vali Loss: 0.3015897 Test Loss: 0.3251950
Validation loss decreased (0.735928 --> 0.301590).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 4 cost time: 0.8924157619476318
Epoch: 4, Steps: 64 | Train Loss: 0.1162310 Vali Loss: 0.2608389 Test Loss: 0.3060116
Validation loss decreased (0.301590 --> 0.260839).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 5 cost time: 0.8629679679870605
Epoch: 5, Steps: 64 | Train Loss: 0.1068029 Vali Loss: 0.2535808 Test Loss: 0.3042484
Validation loss decreased (0.260839 --> 0.253581).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 6 cost time: 0.8804266452789307
Epoch: 6, Steps: 64 | Train Loss: 0.1011978 Vali Loss: 0.2426585 Test Loss: 0.3007139
Validation loss decreased (0.253581 --> 0.242658).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 7 cost time: 0.8780014514923096
Epoch: 7, Steps: 64 | Train Loss: 0.0981805 Vali Loss: 0.2366834 Test Loss: 0.2968166
Validation loss decreased (0.242658 --> 0.236683).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 8 cost time: 0.859630823135376
Epoch: 8, Steps: 64 | Train Loss: 0.0947833 Vali Loss: 0.2330279 Test Loss: 0.2949693
Validation loss decreased (0.236683 --> 0.233028).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 9 cost time: 0.8824586868286133
Epoch: 9, Steps: 64 | Train Loss: 0.0930096 Vali Loss: 0.2289468 Test Loss: 0.2934241
Validation loss decreased (0.233028 --> 0.228947).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 10 cost time: 0.8824043273925781
Epoch: 10, Steps: 64 | Train Loss: 0.0913102 Vali Loss: 0.2292528 Test Loss: 0.2904617
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 11 cost time: 0.8847870826721191
Epoch: 11, Steps: 64 | Train Loss: 0.0896894 Vali Loss: 0.2228923 Test Loss: 0.2900874
Validation loss decreased (0.228947 --> 0.222892).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 12 cost time: 0.8836233615875244
Epoch: 12, Steps: 64 | Train Loss: 0.0878818 Vali Loss: 0.2195924 Test Loss: 0.2880668
Validation loss decreased (0.222892 --> 0.219592).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 13 cost time: 0.8936235904693604
Epoch: 13, Steps: 64 | Train Loss: 0.0877189 Vali Loss: 0.2186613 Test Loss: 0.2864524
Validation loss decreased (0.219592 --> 0.218661).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 14 cost time: 0.8956305980682373
Epoch: 14, Steps: 64 | Train Loss: 0.0863752 Vali Loss: 0.2191983 Test Loss: 0.2866430
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 15 cost time: 0.8874189853668213
Epoch: 15, Steps: 64 | Train Loss: 0.0855415 Vali Loss: 0.2179521 Test Loss: 0.2874544
Validation loss decreased (0.218661 --> 0.217952).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 16 cost time: 0.975567102432251
Epoch: 16, Steps: 64 | Train Loss: 0.0847819 Vali Loss: 0.2150177 Test Loss: 0.2858032
Validation loss decreased (0.217952 --> 0.215018).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 17 cost time: 0.92140793800354
Epoch: 17, Steps: 64 | Train Loss: 0.0844898 Vali Loss: 0.2153974 Test Loss: 0.2845606
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 18 cost time: 0.881765604019165
Epoch: 18, Steps: 64 | Train Loss: 0.0842516 Vali Loss: 0.2120359 Test Loss: 0.2839269
Validation loss decreased (0.215018 --> 0.212036).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 19 cost time: 0.8867101669311523
Epoch: 19, Steps: 64 | Train Loss: 0.0836647 Vali Loss: 0.2115488 Test Loss: 0.2854214
Validation loss decreased (0.212036 --> 0.211549).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 20 cost time: 0.8826110363006592
Epoch: 20, Steps: 64 | Train Loss: 0.0829370 Vali Loss: 0.2093872 Test Loss: 0.2825660
Validation loss decreased (0.211549 --> 0.209387).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 21 cost time: 0.8882503509521484
Epoch: 21, Steps: 64 | Train Loss: 0.0827753 Vali Loss: 0.2118725 Test Loss: 0.2846989
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 22 cost time: 0.8884332180023193
Epoch: 22, Steps: 64 | Train Loss: 0.0820538 Vali Loss: 0.2095514 Test Loss: 0.2838342
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 23 cost time: 0.888477087020874
Epoch: 23, Steps: 64 | Train Loss: 0.0818808 Vali Loss: 0.2070882 Test Loss: 0.2841119
Validation loss decreased (0.209387 --> 0.207088).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 24 cost time: 0.87371826171875
Epoch: 24, Steps: 64 | Train Loss: 0.0812887 Vali Loss: 0.2056786 Test Loss: 0.2832314
Validation loss decreased (0.207088 --> 0.205679).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 25 cost time: 0.8759996891021729
Epoch: 25, Steps: 64 | Train Loss: 0.0815173 Vali Loss: 0.2056491 Test Loss: 0.2831235
Validation loss decreased (0.205679 --> 0.205649).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 26 cost time: 0.867652177810669
Epoch: 26, Steps: 64 | Train Loss: 0.0812152 Vali Loss: 0.2030278 Test Loss: 0.2829344
Validation loss decreased (0.205649 --> 0.203028).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 27 cost time: 0.8483223915100098
Epoch: 27, Steps: 64 | Train Loss: 0.0806729 Vali Loss: 0.2043403 Test Loss: 0.2822412
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 28 cost time: 0.8793308734893799
Epoch: 28, Steps: 64 | Train Loss: 0.0803689 Vali Loss: 0.2042653 Test Loss: 0.2807269
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 29 cost time: 0.8857569694519043
Epoch: 29, Steps: 64 | Train Loss: 0.0806729 Vali Loss: 0.2046453 Test Loss: 0.2811818
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 30 cost time: 0.8496453762054443
Epoch: 30, Steps: 64 | Train Loss: 0.0806195 Vali Loss: 0.2072649 Test Loss: 0.2832603
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 31 cost time: 0.879615306854248
Epoch: 31, Steps: 64 | Train Loss: 0.0801970 Vali Loss: 0.2030720 Test Loss: 0.2816467
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 32 cost time: 0.8853857517242432
Epoch: 32, Steps: 64 | Train Loss: 0.0798745 Vali Loss: 0.2042322 Test Loss: 0.2806511
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 33 cost time: 0.8964533805847168
Epoch: 33, Steps: 64 | Train Loss: 0.0800804 Vali Loss: 0.2030174 Test Loss: 0.2806322
Validation loss decreased (0.203028 --> 0.203017).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 34 cost time: 0.8821492195129395
Epoch: 34, Steps: 64 | Train Loss: 0.0798878 Vali Loss: 0.2032384 Test Loss: 0.2827766
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 35 cost time: 0.8847806453704834
Epoch: 35, Steps: 64 | Train Loss: 0.0797229 Vali Loss: 0.2022514 Test Loss: 0.2803195
Validation loss decreased (0.203017 --> 0.202251).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 36 cost time: 0.8779997825622559
Epoch: 36, Steps: 64 | Train Loss: 0.0793169 Vali Loss: 0.2062322 Test Loss: 0.2812552
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 37 cost time: 0.8982639312744141
Epoch: 37, Steps: 64 | Train Loss: 0.0789742 Vali Loss: 0.2037551 Test Loss: 0.2797916
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 38 cost time: 0.8833637237548828
Epoch: 38, Steps: 64 | Train Loss: 0.0794204 Vali Loss: 0.2022719 Test Loss: 0.2803677
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 39 cost time: 0.8873641490936279
Epoch: 39, Steps: 64 | Train Loss: 0.0796321 Vali Loss: 0.2028088 Test Loss: 0.2817467
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 40 cost time: 0.9004240036010742
Epoch: 40, Steps: 64 | Train Loss: 0.0792488 Vali Loss: 0.2007931 Test Loss: 0.2802104
Validation loss decreased (0.202251 --> 0.200793).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 41 cost time: 0.9677081108093262
Epoch: 41, Steps: 64 | Train Loss: 0.0788957 Vali Loss: 0.2047205 Test Loss: 0.2816796
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 42 cost time: 0.8879992961883545
Epoch: 42, Steps: 64 | Train Loss: 0.0793596 Vali Loss: 0.2029213 Test Loss: 0.2809034
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 43 cost time: 0.8816170692443848
Epoch: 43, Steps: 64 | Train Loss: 0.0792810 Vali Loss: 0.2042902 Test Loss: 0.2824711
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 44 cost time: 0.8523380756378174
Epoch: 44, Steps: 64 | Train Loss: 0.0789347 Vali Loss: 0.2035370 Test Loss: 0.2804636
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 45 cost time: 0.879431962966919
Epoch: 45, Steps: 64 | Train Loss: 0.0792191 Vali Loss: 0.2018884 Test Loss: 0.2817709
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 46 cost time: 0.880805253982544
Epoch: 46, Steps: 64 | Train Loss: 0.0790859 Vali Loss: 0.2047024 Test Loss: 0.2821237
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 47 cost time: 0.8880002498626709
Epoch: 47, Steps: 64 | Train Loss: 0.0789459 Vali Loss: 0.2024527 Test Loss: 0.2823690
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 48 cost time: 0.8829996585845947
Epoch: 48, Steps: 64 | Train Loss: 0.0788360 Vali Loss: 0.2012144 Test Loss: 0.2814571
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 49 cost time: 0.8821735382080078
Epoch: 49, Steps: 64 | Train Loss: 0.0789900 Vali Loss: 0.1998008 Test Loss: 0.2799565
Validation loss decreased (0.200793 --> 0.199801).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 50 cost time: 0.8847024440765381
Epoch: 50, Steps: 64 | Train Loss: 0.0789978 Vali Loss: 0.2031372 Test Loss: 0.2803374
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 51 cost time: 0.8943545818328857
Epoch: 51, Steps: 64 | Train Loss: 0.0789790 Vali Loss: 0.2021686 Test Loss: 0.2804624
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 52 cost time: 0.8757669925689697
Epoch: 52, Steps: 64 | Train Loss: 0.0788408 Vali Loss: 0.2013514 Test Loss: 0.2795922
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 53 cost time: 0.8970000743865967
Epoch: 53, Steps: 64 | Train Loss: 0.0788136 Vali Loss: 0.2031975 Test Loss: 0.2806481
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 54 cost time: 0.8829045295715332
Epoch: 54, Steps: 64 | Train Loss: 0.0785870 Vali Loss: 0.2029700 Test Loss: 0.2803687
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 55 cost time: 0.8878068923950195
Epoch: 55, Steps: 64 | Train Loss: 0.0792434 Vali Loss: 0.2020272 Test Loss: 0.2802259
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 56 cost time: 0.8863964080810547
Epoch: 56, Steps: 64 | Train Loss: 0.0784770 Vali Loss: 0.2052931 Test Loss: 0.2811305
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 57 cost time: 0.8874185085296631
Epoch: 57, Steps: 64 | Train Loss: 0.0791738 Vali Loss: 0.2041157 Test Loss: 0.2804617
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 58 cost time: 0.8937435150146484
Epoch: 58, Steps: 64 | Train Loss: 0.0788882 Vali Loss: 0.2005118 Test Loss: 0.2809518
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 59 cost time: 0.8854663372039795
Epoch: 59, Steps: 64 | Train Loss: 0.0786652 Vali Loss: 0.2015004 Test Loss: 0.2797176
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 60 cost time: 0.8816237449645996
Epoch: 60, Steps: 64 | Train Loss: 0.0787022 Vali Loss: 0.2001791 Test Loss: 0.2802661
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.27995651960372925, mae:0.33908531069755554, rse:0.2428387850522995
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.04806232452392578 GB
Epoch: 1 cost time: 2.272061824798584
Epoch: 1, Steps: 64 | Train Loss: 0.8787795 Vali Loss: 2.6746678 Test Loss: 4.7758141
Validation loss decreased (inf --> 2.674668).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 2 cost time: 0.929607629776001
Epoch: 2, Steps: 64 | Train Loss: 0.6135890 Vali Loss: 1.0525900 Test Loss: 1.6756026
Validation loss decreased (2.674668 --> 1.052590).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 3 cost time: 0.8973052501678467
Epoch: 3, Steps: 64 | Train Loss: 0.2039296 Vali Loss: 0.3053635 Test Loss: 0.3216097
Validation loss decreased (1.052590 --> 0.305364).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 4 cost time: 0.9108734130859375
Epoch: 4, Steps: 64 | Train Loss: 0.1079121 Vali Loss: 0.2462846 Test Loss: 0.3105043
Validation loss decreased (0.305364 --> 0.246285).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 5 cost time: 0.9174249172210693
Epoch: 5, Steps: 64 | Train Loss: 0.0977257 Vali Loss: 0.2339425 Test Loss: 0.2880593
Validation loss decreased (0.246285 --> 0.233943).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 6 cost time: 0.8970003128051758
Epoch: 6, Steps: 64 | Train Loss: 0.0923909 Vali Loss: 0.2283830 Test Loss: 0.2874582
Validation loss decreased (0.233943 --> 0.228383).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 7 cost time: 0.8996231555938721
Epoch: 7, Steps: 64 | Train Loss: 0.0899482 Vali Loss: 0.2197493 Test Loss: 0.2849316
Validation loss decreased (0.228383 --> 0.219749).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 8 cost time: 0.9074447154998779
Epoch: 8, Steps: 64 | Train Loss: 0.0873503 Vali Loss: 0.2175215 Test Loss: 0.2856361
Validation loss decreased (0.219749 --> 0.217522).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 9 cost time: 0.9044070243835449
Epoch: 9, Steps: 64 | Train Loss: 0.0858284 Vali Loss: 0.2184350 Test Loss: 0.2842116
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 10 cost time: 0.9010891914367676
Epoch: 10, Steps: 64 | Train Loss: 0.0846082 Vali Loss: 0.2136471 Test Loss: 0.2836897
Validation loss decreased (0.217522 --> 0.213647).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 11 cost time: 0.9037961959838867
Epoch: 11, Steps: 64 | Train Loss: 0.0829209 Vali Loss: 0.2143162 Test Loss: 0.2818454
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 12 cost time: 0.9059996604919434
Epoch: 12, Steps: 64 | Train Loss: 0.0822101 Vali Loss: 0.2117967 Test Loss: 0.2843911
Validation loss decreased (0.213647 --> 0.211797).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 13 cost time: 0.9056286811828613
Epoch: 13, Steps: 64 | Train Loss: 0.0812266 Vali Loss: 0.2076598 Test Loss: 0.2824895
Validation loss decreased (0.211797 --> 0.207660).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 14 cost time: 0.9068558216094971
Epoch: 14, Steps: 64 | Train Loss: 0.0800977 Vali Loss: 0.2068018 Test Loss: 0.2813264
Validation loss decreased (0.207660 --> 0.206802).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 15 cost time: 0.9003398418426514
Epoch: 15, Steps: 64 | Train Loss: 0.0795768 Vali Loss: 0.2043363 Test Loss: 0.2821262
Validation loss decreased (0.206802 --> 0.204336).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 16 cost time: 0.9155597686767578
Epoch: 16, Steps: 64 | Train Loss: 0.0786880 Vali Loss: 0.2035779 Test Loss: 0.2813211
Validation loss decreased (0.204336 --> 0.203578).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 17 cost time: 0.9064431190490723
Epoch: 17, Steps: 64 | Train Loss: 0.0786939 Vali Loss: 0.2007693 Test Loss: 0.2812123
Validation loss decreased (0.203578 --> 0.200769).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 18 cost time: 0.9047629833221436
Epoch: 18, Steps: 64 | Train Loss: 0.0775493 Vali Loss: 0.2001201 Test Loss: 0.2823961
Validation loss decreased (0.200769 --> 0.200120).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 19 cost time: 0.9086155891418457
Epoch: 19, Steps: 64 | Train Loss: 0.0768068 Vali Loss: 0.1973466 Test Loss: 0.2814291
Validation loss decreased (0.200120 --> 0.197347).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 20 cost time: 0.9126217365264893
Epoch: 20, Steps: 64 | Train Loss: 0.0768449 Vali Loss: 0.1971006 Test Loss: 0.2796072
Validation loss decreased (0.197347 --> 0.197101).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 21 cost time: 0.9103820323944092
Epoch: 21, Steps: 64 | Train Loss: 0.0762771 Vali Loss: 0.1932533 Test Loss: 0.2804895
Validation loss decreased (0.197101 --> 0.193253).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 22 cost time: 0.9094035625457764
Epoch: 22, Steps: 64 | Train Loss: 0.0764383 Vali Loss: 0.1949695 Test Loss: 0.2793935
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 23 cost time: 0.9140477180480957
Epoch: 23, Steps: 64 | Train Loss: 0.0760577 Vali Loss: 0.1926815 Test Loss: 0.2795838
Validation loss decreased (0.193253 --> 0.192681).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 24 cost time: 0.9017834663391113
Epoch: 24, Steps: 64 | Train Loss: 0.0756470 Vali Loss: 0.1955978 Test Loss: 0.2789832
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 25 cost time: 0.9019978046417236
Epoch: 25, Steps: 64 | Train Loss: 0.0753823 Vali Loss: 0.1942571 Test Loss: 0.2779399
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 26 cost time: 0.9053511619567871
Epoch: 26, Steps: 64 | Train Loss: 0.0751494 Vali Loss: 0.1939157 Test Loss: 0.2777332
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 27 cost time: 0.892789363861084
Epoch: 27, Steps: 64 | Train Loss: 0.0752453 Vali Loss: 0.1958295 Test Loss: 0.2784432
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 28 cost time: 0.9039840698242188
Epoch: 28, Steps: 64 | Train Loss: 0.0748841 Vali Loss: 0.1921172 Test Loss: 0.2788568
Validation loss decreased (0.192681 --> 0.192117).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 29 cost time: 0.9104342460632324
Epoch: 29, Steps: 64 | Train Loss: 0.0747008 Vali Loss: 0.1931716 Test Loss: 0.2798536
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 30 cost time: 0.9109046459197998
Epoch: 30, Steps: 64 | Train Loss: 0.0748418 Vali Loss: 0.1928945 Test Loss: 0.2777681
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 31 cost time: 0.9263491630554199
Epoch: 31, Steps: 64 | Train Loss: 0.0746023 Vali Loss: 0.1915343 Test Loss: 0.2777969
Validation loss decreased (0.192117 --> 0.191534).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 32 cost time: 0.9246256351470947
Epoch: 32, Steps: 64 | Train Loss: 0.0745105 Vali Loss: 0.1888279 Test Loss: 0.2771087
Validation loss decreased (0.191534 --> 0.188828).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 33 cost time: 0.9225974082946777
Epoch: 33, Steps: 64 | Train Loss: 0.0746218 Vali Loss: 0.1927769 Test Loss: 0.2769104
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 34 cost time: 0.9267137050628662
Epoch: 34, Steps: 64 | Train Loss: 0.0742506 Vali Loss: 0.1902215 Test Loss: 0.2785078
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 35 cost time: 0.9273960590362549
Epoch: 35, Steps: 64 | Train Loss: 0.0744826 Vali Loss: 0.1902817 Test Loss: 0.2773415
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 36 cost time: 0.9219152927398682
Epoch: 36, Steps: 64 | Train Loss: 0.0742862 Vali Loss: 0.1923530 Test Loss: 0.2777534
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 37 cost time: 0.9333219528198242
Epoch: 37, Steps: 64 | Train Loss: 0.0742949 Vali Loss: 0.1937887 Test Loss: 0.2774530
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 38 cost time: 0.9298043251037598
Epoch: 38, Steps: 64 | Train Loss: 0.0739154 Vali Loss: 0.1891297 Test Loss: 0.2767456
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 39 cost time: 0.931999921798706
Epoch: 39, Steps: 64 | Train Loss: 0.0738972 Vali Loss: 0.1900930 Test Loss: 0.2766089
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 40 cost time: 0.9240014553070068
Epoch: 40, Steps: 64 | Train Loss: 0.0736938 Vali Loss: 0.1927737 Test Loss: 0.2776817
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 41 cost time: 0.9253489971160889
Epoch: 41, Steps: 64 | Train Loss: 0.0743742 Vali Loss: 0.1897722 Test Loss: 0.2758049
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 42 cost time: 0.9264307022094727
Epoch: 42, Steps: 64 | Train Loss: 0.0742593 Vali Loss: 0.1911556 Test Loss: 0.2776551
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 43 cost time: 0.92435622215271
Epoch: 43, Steps: 64 | Train Loss: 0.0738623 Vali Loss: 0.1905626 Test Loss: 0.2762643
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 44 cost time: 0.9064083099365234
Epoch: 44, Steps: 64 | Train Loss: 0.0738540 Vali Loss: 0.1919726 Test Loss: 0.2773091
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 45 cost time: 0.9267966747283936
Epoch: 45, Steps: 64 | Train Loss: 0.0738947 Vali Loss: 0.1899025 Test Loss: 0.2769025
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 46 cost time: 0.9290001392364502
Epoch: 46, Steps: 64 | Train Loss: 0.0743931 Vali Loss: 0.1902406 Test Loss: 0.2763093
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 47 cost time: 0.930595874786377
Epoch: 47, Steps: 64 | Train Loss: 0.0739912 Vali Loss: 0.1916258 Test Loss: 0.2771091
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 48 cost time: 0.8844056129455566
Epoch: 48, Steps: 64 | Train Loss: 0.0737792 Vali Loss: 0.1921649 Test Loss: 0.2767341
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 49 cost time: 0.9030396938323975
Epoch: 49, Steps: 64 | Train Loss: 0.0741013 Vali Loss: 0.1890484 Test Loss: 0.2782959
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 50 cost time: 0.9054138660430908
Epoch: 50, Steps: 64 | Train Loss: 0.0740375 Vali Loss: 0.1904358 Test Loss: 0.2767581
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 51 cost time: 0.8996973037719727
Epoch: 51, Steps: 64 | Train Loss: 0.0740723 Vali Loss: 0.1893600 Test Loss: 0.2764486
EarlyStopping counter: 19 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 52 cost time: 0.9020006656646729
Epoch: 52, Steps: 64 | Train Loss: 0.0738205 Vali Loss: 0.1900097 Test Loss: 0.2782320
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 53 cost time: 0.8986897468566895
Epoch: 53, Steps: 64 | Train Loss: 0.0738855 Vali Loss: 0.1926739 Test Loss: 0.2782513
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 54 cost time: 0.8973698616027832
Epoch: 54, Steps: 64 | Train Loss: 0.0733672 Vali Loss: 0.1866294 Test Loss: 0.2776289
Validation loss decreased (0.188828 --> 0.186629).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 55 cost time: 0.9193177223205566
Epoch: 55, Steps: 64 | Train Loss: 0.0735965 Vali Loss: 0.1915250 Test Loss: 0.2771591
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 56 cost time: 0.9074432849884033
Epoch: 56, Steps: 64 | Train Loss: 0.0738191 Vali Loss: 0.1892138 Test Loss: 0.2772748
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 57 cost time: 0.9093389511108398
Epoch: 57, Steps: 64 | Train Loss: 0.0738914 Vali Loss: 0.1880452 Test Loss: 0.2770539
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 58 cost time: 0.9186990261077881
Epoch: 58, Steps: 64 | Train Loss: 0.0740427 Vali Loss: 0.1917354 Test Loss: 0.2760127
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 59 cost time: 0.9760000705718994
Epoch: 59, Steps: 64 | Train Loss: 0.0738868 Vali Loss: 0.1881309 Test Loss: 0.2769226
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 60 cost time: 0.8976101875305176
Epoch: 60, Steps: 64 | Train Loss: 0.0738033 Vali Loss: 0.1917007 Test Loss: 0.2779385
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.27762895822525024, mae:0.3377610445022583, rse:0.24182721972465515
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.045671939849853516 GB
Epoch: 1 cost time: 2.207897901535034
Epoch: 1, Steps: 64 | Train Loss: 0.6794849 Vali Loss: 1.7358663 Test Loss: 2.8114672
Validation loss decreased (inf --> 1.735866).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 2 cost time: 0.8852112293243408
Epoch: 2, Steps: 64 | Train Loss: 0.4612650 Vali Loss: 0.6566971 Test Loss: 0.9154800
Validation loss decreased (1.735866 --> 0.656697).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 3 cost time: 0.8701920509338379
Epoch: 3, Steps: 64 | Train Loss: 0.2437245 Vali Loss: 0.3758453 Test Loss: 0.4385109
Validation loss decreased (0.656697 --> 0.375845).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 4 cost time: 0.8679318428039551
Epoch: 4, Steps: 64 | Train Loss: 0.1715915 Vali Loss: 0.2902212 Test Loss: 0.3283836
Validation loss decreased (0.375845 --> 0.290221).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 5 cost time: 0.876000165939331
Epoch: 5, Steps: 64 | Train Loss: 0.1470500 Vali Loss: 0.2491404 Test Loss: 0.3045289
Validation loss decreased (0.290221 --> 0.249140).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 6 cost time: 0.8604590892791748
Epoch: 6, Steps: 64 | Train Loss: 0.1356032 Vali Loss: 0.2448646 Test Loss: 0.3001146
Validation loss decreased (0.249140 --> 0.244865).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 7 cost time: 0.8665449619293213
Epoch: 7, Steps: 64 | Train Loss: 0.1283100 Vali Loss: 0.2418838 Test Loss: 0.2989786
Validation loss decreased (0.244865 --> 0.241884).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 8 cost time: 0.8632946014404297
Epoch: 8, Steps: 64 | Train Loss: 0.1236099 Vali Loss: 0.2380785 Test Loss: 0.2985340
Validation loss decreased (0.241884 --> 0.238079).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 9 cost time: 0.868363618850708
Epoch: 9, Steps: 64 | Train Loss: 0.1182138 Vali Loss: 0.2359136 Test Loss: 0.2970900
Validation loss decreased (0.238079 --> 0.235914).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 10 cost time: 0.8649990558624268
Epoch: 10, Steps: 64 | Train Loss: 0.1157172 Vali Loss: 0.2313169 Test Loss: 0.2974594
Validation loss decreased (0.235914 --> 0.231317).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 11 cost time: 0.870999813079834
Epoch: 11, Steps: 64 | Train Loss: 0.1133923 Vali Loss: 0.2310427 Test Loss: 0.2966332
Validation loss decreased (0.231317 --> 0.231043).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 12 cost time: 0.8713786602020264
Epoch: 12, Steps: 64 | Train Loss: 0.1112608 Vali Loss: 0.2281041 Test Loss: 0.2930734
Validation loss decreased (0.231043 --> 0.228104).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 13 cost time: 0.8832452297210693
Epoch: 13, Steps: 64 | Train Loss: 0.1089658 Vali Loss: 0.2280930 Test Loss: 0.2930449
Validation loss decreased (0.228104 --> 0.228093).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 14 cost time: 0.8723623752593994
Epoch: 14, Steps: 64 | Train Loss: 0.1082482 Vali Loss: 0.2299782 Test Loss: 0.2954941
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 15 cost time: 0.8631596565246582
Epoch: 15, Steps: 64 | Train Loss: 0.1062657 Vali Loss: 0.2232916 Test Loss: 0.2907188
Validation loss decreased (0.228093 --> 0.223292).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 16 cost time: 0.8690001964569092
Epoch: 16, Steps: 64 | Train Loss: 0.1042501 Vali Loss: 0.2217596 Test Loss: 0.2921408
Validation loss decreased (0.223292 --> 0.221760).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 17 cost time: 0.8672819137573242
Epoch: 17, Steps: 64 | Train Loss: 0.1047038 Vali Loss: 0.2215680 Test Loss: 0.2918451
Validation loss decreased (0.221760 --> 0.221568).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 18 cost time: 0.8678524494171143
Epoch: 18, Steps: 64 | Train Loss: 0.1028462 Vali Loss: 0.2217820 Test Loss: 0.2912388
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 19 cost time: 0.8684289455413818
Epoch: 19, Steps: 64 | Train Loss: 0.1015779 Vali Loss: 0.2192839 Test Loss: 0.2906694
Validation loss decreased (0.221568 --> 0.219284).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 20 cost time: 0.8803465366363525
Epoch: 20, Steps: 64 | Train Loss: 0.1006073 Vali Loss: 0.2205200 Test Loss: 0.2900512
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 21 cost time: 0.867999792098999
Epoch: 21, Steps: 64 | Train Loss: 0.1014496 Vali Loss: 0.2216218 Test Loss: 0.2901235
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 22 cost time: 0.8696188926696777
Epoch: 22, Steps: 64 | Train Loss: 0.1001294 Vali Loss: 0.2199605 Test Loss: 0.2913291
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 23 cost time: 0.8663604259490967
Epoch: 23, Steps: 64 | Train Loss: 0.1001038 Vali Loss: 0.2186942 Test Loss: 0.2918594
Validation loss decreased (0.219284 --> 0.218694).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 24 cost time: 0.8691902160644531
Epoch: 24, Steps: 64 | Train Loss: 0.0997749 Vali Loss: 0.2177913 Test Loss: 0.2911724
Validation loss decreased (0.218694 --> 0.217791).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 25 cost time: 0.8583393096923828
Epoch: 25, Steps: 64 | Train Loss: 0.0984751 Vali Loss: 0.2191605 Test Loss: 0.2914207
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 26 cost time: 0.8587665557861328
Epoch: 26, Steps: 64 | Train Loss: 0.0986687 Vali Loss: 0.2185175 Test Loss: 0.2908397
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 27 cost time: 0.8714790344238281
Epoch: 27, Steps: 64 | Train Loss: 0.0982295 Vali Loss: 0.2156659 Test Loss: 0.2894807
Validation loss decreased (0.217791 --> 0.215666).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 28 cost time: 0.8425793647766113
Epoch: 28, Steps: 64 | Train Loss: 0.0978012 Vali Loss: 0.2163626 Test Loss: 0.2910365
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 29 cost time: 0.8674342632293701
Epoch: 29, Steps: 64 | Train Loss: 0.0977163 Vali Loss: 0.2163268 Test Loss: 0.2905151
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 30 cost time: 0.8663959503173828
Epoch: 30, Steps: 64 | Train Loss: 0.0973550 Vali Loss: 0.2156624 Test Loss: 0.2880495
Validation loss decreased (0.215666 --> 0.215662).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 31 cost time: 0.8651061058044434
Epoch: 31, Steps: 64 | Train Loss: 0.0972765 Vali Loss: 0.2181621 Test Loss: 0.2891120
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 32 cost time: 0.9618270397186279
Epoch: 32, Steps: 64 | Train Loss: 0.0972136 Vali Loss: 0.2151713 Test Loss: 0.2893379
Validation loss decreased (0.215662 --> 0.215171).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 33 cost time: 0.8640003204345703
Epoch: 33, Steps: 64 | Train Loss: 0.0970796 Vali Loss: 0.2160225 Test Loss: 0.2890047
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 34 cost time: 0.8596296310424805
Epoch: 34, Steps: 64 | Train Loss: 0.0965891 Vali Loss: 0.2162370 Test Loss: 0.2894410
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 35 cost time: 0.870690107345581
Epoch: 35, Steps: 64 | Train Loss: 0.0966398 Vali Loss: 0.2159563 Test Loss: 0.2891826
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 36 cost time: 0.8627562522888184
Epoch: 36, Steps: 64 | Train Loss: 0.0962507 Vali Loss: 0.2138362 Test Loss: 0.2901142
Validation loss decreased (0.215171 --> 0.213836).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 37 cost time: 0.8637542724609375
Epoch: 37, Steps: 64 | Train Loss: 0.0958062 Vali Loss: 0.2128930 Test Loss: 0.2892867
Validation loss decreased (0.213836 --> 0.212893).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 38 cost time: 0.8780002593994141
Epoch: 38, Steps: 64 | Train Loss: 0.0961917 Vali Loss: 0.2109739 Test Loss: 0.2878646
Validation loss decreased (0.212893 --> 0.210974).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 39 cost time: 0.8686256408691406
Epoch: 39, Steps: 64 | Train Loss: 0.0964100 Vali Loss: 0.2158905 Test Loss: 0.2889389
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 40 cost time: 0.8672442436218262
Epoch: 40, Steps: 64 | Train Loss: 0.0960962 Vali Loss: 0.2152431 Test Loss: 0.2887836
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 41 cost time: 0.8699300289154053
Epoch: 41, Steps: 64 | Train Loss: 0.0962409 Vali Loss: 0.2133744 Test Loss: 0.2881771
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 42 cost time: 0.8703336715698242
Epoch: 42, Steps: 64 | Train Loss: 0.0958072 Vali Loss: 0.2150166 Test Loss: 0.2879954
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 43 cost time: 0.8570003509521484
Epoch: 43, Steps: 64 | Train Loss: 0.0957190 Vali Loss: 0.2114281 Test Loss: 0.2884337
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 44 cost time: 0.8574376106262207
Epoch: 44, Steps: 64 | Train Loss: 0.0957062 Vali Loss: 0.2129699 Test Loss: 0.2877134
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 45 cost time: 0.856212854385376
Epoch: 45, Steps: 64 | Train Loss: 0.0953797 Vali Loss: 0.2141671 Test Loss: 0.2882073
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 46 cost time: 0.8653643131256104
Epoch: 46, Steps: 64 | Train Loss: 0.0958117 Vali Loss: 0.2165471 Test Loss: 0.2876769
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 47 cost time: 0.8583505153656006
Epoch: 47, Steps: 64 | Train Loss: 0.0952556 Vali Loss: 0.2120351 Test Loss: 0.2888873
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 48 cost time: 0.8703651428222656
Epoch: 48, Steps: 64 | Train Loss: 0.0956124 Vali Loss: 0.2137732 Test Loss: 0.2882060
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 49 cost time: 0.8787131309509277
Epoch: 49, Steps: 64 | Train Loss: 0.0948190 Vali Loss: 0.2126579 Test Loss: 0.2875902
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 50 cost time: 0.8716084957122803
Epoch: 50, Steps: 64 | Train Loss: 0.0956257 Vali Loss: 0.2124579 Test Loss: 0.2893318
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 51 cost time: 0.8763282299041748
Epoch: 51, Steps: 64 | Train Loss: 0.0952654 Vali Loss: 0.2149042 Test Loss: 0.2879066
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 52 cost time: 0.8573322296142578
Epoch: 52, Steps: 64 | Train Loss: 0.0955604 Vali Loss: 0.2148208 Test Loss: 0.2889096
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 53 cost time: 0.8547244071960449
Epoch: 53, Steps: 64 | Train Loss: 0.0957458 Vali Loss: 0.2153277 Test Loss: 0.2883465
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 54 cost time: 0.8544948101043701
Epoch: 54, Steps: 64 | Train Loss: 0.0946590 Vali Loss: 0.2136298 Test Loss: 0.2889173
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 55 cost time: 0.8536231517791748
Epoch: 55, Steps: 64 | Train Loss: 0.0953127 Vali Loss: 0.2146424 Test Loss: 0.2877170
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 56 cost time: 0.853478193283081
Epoch: 56, Steps: 64 | Train Loss: 0.0952927 Vali Loss: 0.2104685 Test Loss: 0.2888659
Validation loss decreased (0.210974 --> 0.210468).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 57 cost time: 0.8813376426696777
Epoch: 57, Steps: 64 | Train Loss: 0.0949842 Vali Loss: 0.2130590 Test Loss: 0.2874607
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 58 cost time: 0.8717238903045654
Epoch: 58, Steps: 64 | Train Loss: 0.0949862 Vali Loss: 0.2140297 Test Loss: 0.2890376
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 59 cost time: 0.8709990978240967
Epoch: 59, Steps: 64 | Train Loss: 0.0952115 Vali Loss: 0.2125948 Test Loss: 0.2877794
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 60 cost time: 0.8696136474609375
Epoch: 60, Steps: 64 | Train Loss: 0.0949915 Vali Loss: 0.2155179 Test Loss: 0.2891341
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2888658940792084, mae:0.3499313294887543, rse:0.2466726005077362
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.0471038818359375 GB
Epoch: 1 cost time: 2.312255620956421
Epoch: 1, Steps: 64 | Train Loss: 0.9486648 Vali Loss: 2.7707179 Test Loss: 4.8715219
Validation loss decreased (inf --> 2.770718).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 2 cost time: 0.9545047283172607
Epoch: 2, Steps: 64 | Train Loss: 0.5514475 Vali Loss: 0.7932561 Test Loss: 1.0711259
Validation loss decreased (2.770718 --> 0.793256).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 3 cost time: 0.9522943496704102
Epoch: 3, Steps: 64 | Train Loss: 0.1931234 Vali Loss: 0.3647900 Test Loss: 0.3499229
Validation loss decreased (0.793256 --> 0.364790).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 4 cost time: 0.9522671699523926
Epoch: 4, Steps: 64 | Train Loss: 0.1252465 Vali Loss: 0.2902537 Test Loss: 0.3049414
Validation loss decreased (0.364790 --> 0.290254).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 5 cost time: 0.9493980407714844
Epoch: 5, Steps: 64 | Train Loss: 0.1117400 Vali Loss: 0.2621097 Test Loss: 0.2989742
Validation loss decreased (0.290254 --> 0.262110).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 6 cost time: 0.9518158435821533
Epoch: 6, Steps: 64 | Train Loss: 0.1049745 Vali Loss: 0.2456623 Test Loss: 0.2945355
Validation loss decreased (0.262110 --> 0.245662).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 7 cost time: 0.9519422054290771
Epoch: 7, Steps: 64 | Train Loss: 0.1007173 Vali Loss: 0.2402121 Test Loss: 0.2932038
Validation loss decreased (0.245662 --> 0.240212).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 8 cost time: 0.9406323432922363
Epoch: 8, Steps: 64 | Train Loss: 0.0973247 Vali Loss: 0.2363103 Test Loss: 0.2913136
Validation loss decreased (0.240212 --> 0.236310).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 9 cost time: 0.9496212005615234
Epoch: 9, Steps: 64 | Train Loss: 0.0951887 Vali Loss: 0.2304843 Test Loss: 0.2883187
Validation loss decreased (0.236310 --> 0.230484).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 10 cost time: 0.9624793529510498
Epoch: 10, Steps: 64 | Train Loss: 0.0931701 Vali Loss: 0.2298723 Test Loss: 0.2892043
Validation loss decreased (0.230484 --> 0.229872).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 11 cost time: 0.9586873054504395
Epoch: 11, Steps: 64 | Train Loss: 0.0919118 Vali Loss: 0.2245760 Test Loss: 0.2863288
Validation loss decreased (0.229872 --> 0.224576).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 12 cost time: 0.960906982421875
Epoch: 12, Steps: 64 | Train Loss: 0.0904693 Vali Loss: 0.2230473 Test Loss: 0.2860006
Validation loss decreased (0.224576 --> 0.223047).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 13 cost time: 0.9603843688964844
Epoch: 13, Steps: 64 | Train Loss: 0.0894878 Vali Loss: 0.2225616 Test Loss: 0.2857215
Validation loss decreased (0.223047 --> 0.222562).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 14 cost time: 0.9581027030944824
Epoch: 14, Steps: 64 | Train Loss: 0.0885956 Vali Loss: 0.2195980 Test Loss: 0.2837630
Validation loss decreased (0.222562 --> 0.219598).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 15 cost time: 0.9413595199584961
Epoch: 15, Steps: 64 | Train Loss: 0.0874742 Vali Loss: 0.2213494 Test Loss: 0.2827630
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 16 cost time: 0.9438052177429199
Epoch: 16, Steps: 64 | Train Loss: 0.0871309 Vali Loss: 0.2190012 Test Loss: 0.2830762
Validation loss decreased (0.219598 --> 0.219001).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 17 cost time: 0.9581749439239502
Epoch: 17, Steps: 64 | Train Loss: 0.0866380 Vali Loss: 0.2175329 Test Loss: 0.2821816
Validation loss decreased (0.219001 --> 0.217533).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 18 cost time: 0.9526224136352539
Epoch: 18, Steps: 64 | Train Loss: 0.0861534 Vali Loss: 0.2139670 Test Loss: 0.2824860
Validation loss decreased (0.217533 --> 0.213967).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 19 cost time: 0.9616274833679199
Epoch: 19, Steps: 64 | Train Loss: 0.0858490 Vali Loss: 0.2144530 Test Loss: 0.2829377
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 20 cost time: 0.9573593139648438
Epoch: 20, Steps: 64 | Train Loss: 0.0850000 Vali Loss: 0.2151939 Test Loss: 0.2827317
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 21 cost time: 0.956810712814331
Epoch: 21, Steps: 64 | Train Loss: 0.0847213 Vali Loss: 0.2140943 Test Loss: 0.2816629
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 22 cost time: 0.9563660621643066
Epoch: 22, Steps: 64 | Train Loss: 0.0842458 Vali Loss: 0.2125368 Test Loss: 0.2808978
Validation loss decreased (0.213967 --> 0.212537).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 23 cost time: 0.953376054763794
Epoch: 23, Steps: 64 | Train Loss: 0.0844350 Vali Loss: 0.2090891 Test Loss: 0.2819270
Validation loss decreased (0.212537 --> 0.209089).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 24 cost time: 0.9593441486358643
Epoch: 24, Steps: 64 | Train Loss: 0.0842325 Vali Loss: 0.2121277 Test Loss: 0.2804081
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 25 cost time: 0.9517455101013184
Epoch: 25, Steps: 64 | Train Loss: 0.0840755 Vali Loss: 0.2130284 Test Loss: 0.2810984
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 26 cost time: 0.9529998302459717
Epoch: 26, Steps: 64 | Train Loss: 0.0833171 Vali Loss: 0.2107150 Test Loss: 0.2802146
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 27 cost time: 0.9590001106262207
Epoch: 27, Steps: 64 | Train Loss: 0.0834268 Vali Loss: 0.2117077 Test Loss: 0.2805370
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 28 cost time: 0.9304814338684082
Epoch: 28, Steps: 64 | Train Loss: 0.0831517 Vali Loss: 0.2095925 Test Loss: 0.2799923
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 29 cost time: 0.9583699703216553
Epoch: 29, Steps: 64 | Train Loss: 0.0830613 Vali Loss: 0.2127253 Test Loss: 0.2809859
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 30 cost time: 0.9604547023773193
Epoch: 30, Steps: 64 | Train Loss: 0.0831964 Vali Loss: 0.2113318 Test Loss: 0.2795449
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 31 cost time: 0.9634363651275635
Epoch: 31, Steps: 64 | Train Loss: 0.0828046 Vali Loss: 0.2087076 Test Loss: 0.2804329
Validation loss decreased (0.209089 --> 0.208708).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 32 cost time: 0.9544529914855957
Epoch: 32, Steps: 64 | Train Loss: 0.0826899 Vali Loss: 0.2091692 Test Loss: 0.2815210
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 33 cost time: 0.95436692237854
Epoch: 33, Steps: 64 | Train Loss: 0.0828643 Vali Loss: 0.2100345 Test Loss: 0.2805809
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 34 cost time: 0.9613656997680664
Epoch: 34, Steps: 64 | Train Loss: 0.0825186 Vali Loss: 0.2112268 Test Loss: 0.2795213
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 35 cost time: 0.9537343978881836
Epoch: 35, Steps: 64 | Train Loss: 0.0823956 Vali Loss: 0.2095493 Test Loss: 0.2796973
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 36 cost time: 0.9570000171661377
Epoch: 36, Steps: 64 | Train Loss: 0.0824634 Vali Loss: 0.2074149 Test Loss: 0.2804592
Validation loss decreased (0.208708 --> 0.207415).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 37 cost time: 0.9826319217681885
Epoch: 37, Steps: 64 | Train Loss: 0.0824814 Vali Loss: 0.2098868 Test Loss: 0.2789582
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 38 cost time: 0.9626185894012451
Epoch: 38, Steps: 64 | Train Loss: 0.0820585 Vali Loss: 0.2086002 Test Loss: 0.2807398
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 39 cost time: 0.9603879451751709
Epoch: 39, Steps: 64 | Train Loss: 0.0819956 Vali Loss: 0.2099214 Test Loss: 0.2788420
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 40 cost time: 0.956498384475708
Epoch: 40, Steps: 64 | Train Loss: 0.0819284 Vali Loss: 0.2074671 Test Loss: 0.2787425
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 41 cost time: 0.9443924427032471
Epoch: 41, Steps: 64 | Train Loss: 0.0821183 Vali Loss: 0.2080187 Test Loss: 0.2801480
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 42 cost time: 0.9547054767608643
Epoch: 42, Steps: 64 | Train Loss: 0.0816460 Vali Loss: 0.2100730 Test Loss: 0.2798707
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 43 cost time: 0.9477407932281494
Epoch: 43, Steps: 64 | Train Loss: 0.0822571 Vali Loss: 0.2072421 Test Loss: 0.2794066
Validation loss decreased (0.207415 --> 0.207242).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 44 cost time: 0.952141284942627
Epoch: 44, Steps: 64 | Train Loss: 0.0821496 Vali Loss: 0.2094827 Test Loss: 0.2800338
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 45 cost time: 0.9346723556518555
Epoch: 45, Steps: 64 | Train Loss: 0.0820454 Vali Loss: 0.2044531 Test Loss: 0.2809272
Validation loss decreased (0.207242 --> 0.204453).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 46 cost time: 0.9200282096862793
Epoch: 46, Steps: 64 | Train Loss: 0.0818101 Vali Loss: 0.2079089 Test Loss: 0.2797946
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 47 cost time: 0.9603800773620605
Epoch: 47, Steps: 64 | Train Loss: 0.0816944 Vali Loss: 0.2070301 Test Loss: 0.2805933
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 48 cost time: 0.9486961364746094
Epoch: 48, Steps: 64 | Train Loss: 0.0823473 Vali Loss: 0.2067522 Test Loss: 0.2797538
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 49 cost time: 0.9503686428070068
Epoch: 49, Steps: 64 | Train Loss: 0.0815978 Vali Loss: 0.2073282 Test Loss: 0.2806805
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 50 cost time: 0.9684851169586182
Epoch: 50, Steps: 64 | Train Loss: 0.0815253 Vali Loss: 0.2083845 Test Loss: 0.2789387
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 51 cost time: 0.9633514881134033
Epoch: 51, Steps: 64 | Train Loss: 0.0817847 Vali Loss: 0.2070427 Test Loss: 0.2799585
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 52 cost time: 0.9497482776641846
Epoch: 52, Steps: 64 | Train Loss: 0.0816379 Vali Loss: 0.2079776 Test Loss: 0.2816814
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 53 cost time: 0.954763650894165
Epoch: 53, Steps: 64 | Train Loss: 0.0819247 Vali Loss: 0.2046897 Test Loss: 0.2795702
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 54 cost time: 0.976001501083374
Epoch: 54, Steps: 64 | Train Loss: 0.0816750 Vali Loss: 0.2039162 Test Loss: 0.2797867
Validation loss decreased (0.204453 --> 0.203916).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 55 cost time: 0.9586210250854492
Epoch: 55, Steps: 64 | Train Loss: 0.0816816 Vali Loss: 0.2075964 Test Loss: 0.2800997
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 56 cost time: 0.9586231708526611
Epoch: 56, Steps: 64 | Train Loss: 0.0813517 Vali Loss: 0.2051934 Test Loss: 0.2794730
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 57 cost time: 0.9593281745910645
Epoch: 57, Steps: 64 | Train Loss: 0.0817353 Vali Loss: 0.2080156 Test Loss: 0.2797905
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 58 cost time: 0.9521398544311523
Epoch: 58, Steps: 64 | Train Loss: 0.0815366 Vali Loss: 0.2068609 Test Loss: 0.2789386
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 59 cost time: 0.9505102634429932
Epoch: 59, Steps: 64 | Train Loss: 0.0817543 Vali Loss: 0.2079983 Test Loss: 0.2805080
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 60 cost time: 0.9494218826293945
Epoch: 60, Steps: 64 | Train Loss: 0.0817323 Vali Loss: 0.2074236 Test Loss: 0.2814492
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.27978670597076416, mae:0.33928942680358887, rse:0.2427651435136795
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.04822397232055664 GB
Epoch: 1 cost time: 2.3055529594421387
Epoch: 1, Steps: 64 | Train Loss: 0.9339332 Vali Loss: 2.8563173 Test Loss: 5.1301856
Validation loss decreased (inf --> 2.856317).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 2 cost time: 0.9242355823516846
Epoch: 2, Steps: 64 | Train Loss: 0.6340220 Vali Loss: 1.0848806 Test Loss: 1.7428041
Validation loss decreased (2.856317 --> 1.084881).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 3 cost time: 0.9147818088531494
Epoch: 3, Steps: 64 | Train Loss: 0.2175009 Vali Loss: 0.3414032 Test Loss: 0.3691794
Validation loss decreased (1.084881 --> 0.341403).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 4 cost time: 0.9369418621063232
Epoch: 4, Steps: 64 | Train Loss: 0.1064831 Vali Loss: 0.2597230 Test Loss: 0.3091389
Validation loss decreased (0.341403 --> 0.259723).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 5 cost time: 0.9283838272094727
Epoch: 5, Steps: 64 | Train Loss: 0.0967568 Vali Loss: 0.2403237 Test Loss: 0.2942147
Validation loss decreased (0.259723 --> 0.240324).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 6 cost time: 0.9094719886779785
Epoch: 6, Steps: 64 | Train Loss: 0.0919407 Vali Loss: 0.2337393 Test Loss: 0.2932746
Validation loss decreased (0.240324 --> 0.233739).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 7 cost time: 0.9124445915222168
Epoch: 7, Steps: 64 | Train Loss: 0.0891211 Vali Loss: 0.2308453 Test Loss: 0.2892657
Validation loss decreased (0.233739 --> 0.230845).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 8 cost time: 0.9090242385864258
Epoch: 8, Steps: 64 | Train Loss: 0.0875127 Vali Loss: 0.2278449 Test Loss: 0.2928844
Validation loss decreased (0.230845 --> 0.227845).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 9 cost time: 0.9157633781433105
Epoch: 9, Steps: 64 | Train Loss: 0.0856453 Vali Loss: 0.2255953 Test Loss: 0.2881505
Validation loss decreased (0.227845 --> 0.225595).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 10 cost time: 0.9229998588562012
Epoch: 10, Steps: 64 | Train Loss: 0.0843205 Vali Loss: 0.2223774 Test Loss: 0.2853000
Validation loss decreased (0.225595 --> 0.222377).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 11 cost time: 0.9438722133636475
Epoch: 11, Steps: 64 | Train Loss: 0.0837830 Vali Loss: 0.2193268 Test Loss: 0.2871195
Validation loss decreased (0.222377 --> 0.219327).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 12 cost time: 0.9359312057495117
Epoch: 12, Steps: 64 | Train Loss: 0.0827127 Vali Loss: 0.2237775 Test Loss: 0.2853178
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 13 cost time: 0.9245185852050781
Epoch: 13, Steps: 64 | Train Loss: 0.0821882 Vali Loss: 0.2197533 Test Loss: 0.2857185
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 14 cost time: 0.9203550815582275
Epoch: 14, Steps: 64 | Train Loss: 0.0814015 Vali Loss: 0.2149673 Test Loss: 0.2850481
Validation loss decreased (0.219327 --> 0.214967).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 15 cost time: 0.9175913333892822
Epoch: 15, Steps: 64 | Train Loss: 0.0808478 Vali Loss: 0.2160980 Test Loss: 0.2832506
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 16 cost time: 0.9117498397827148
Epoch: 16, Steps: 64 | Train Loss: 0.0801908 Vali Loss: 0.2161329 Test Loss: 0.2832839
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 17 cost time: 0.9149999618530273
Epoch: 17, Steps: 64 | Train Loss: 0.0795776 Vali Loss: 0.2147044 Test Loss: 0.2844955
Validation loss decreased (0.214967 --> 0.214704).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 18 cost time: 0.9249320030212402
Epoch: 18, Steps: 64 | Train Loss: 0.0793426 Vali Loss: 0.2151080 Test Loss: 0.2833977
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 19 cost time: 0.9176368713378906
Epoch: 19, Steps: 64 | Train Loss: 0.0789218 Vali Loss: 0.2115494 Test Loss: 0.2837422
Validation loss decreased (0.214704 --> 0.211549).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 20 cost time: 0.9201943874359131
Epoch: 20, Steps: 64 | Train Loss: 0.0784388 Vali Loss: 0.2098138 Test Loss: 0.2845151
Validation loss decreased (0.211549 --> 0.209814).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 21 cost time: 0.9184229373931885
Epoch: 21, Steps: 64 | Train Loss: 0.0786904 Vali Loss: 0.2076381 Test Loss: 0.2833638
Validation loss decreased (0.209814 --> 0.207638).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 22 cost time: 0.8786513805389404
Epoch: 22, Steps: 64 | Train Loss: 0.0780848 Vali Loss: 0.2063221 Test Loss: 0.2829126
Validation loss decreased (0.207638 --> 0.206322).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 23 cost time: 0.8934907913208008
Epoch: 23, Steps: 64 | Train Loss: 0.0782604 Vali Loss: 0.2089131 Test Loss: 0.2837090
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 24 cost time: 0.9128737449645996
Epoch: 24, Steps: 64 | Train Loss: 0.0775187 Vali Loss: 0.2089352 Test Loss: 0.2833808
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 25 cost time: 0.9013614654541016
Epoch: 25, Steps: 64 | Train Loss: 0.0774391 Vali Loss: 0.2036278 Test Loss: 0.2838317
Validation loss decreased (0.206322 --> 0.203628).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 26 cost time: 0.8973648548126221
Epoch: 26, Steps: 64 | Train Loss: 0.0771279 Vali Loss: 0.2040394 Test Loss: 0.2831612
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 27 cost time: 0.9064085483551025
Epoch: 27, Steps: 64 | Train Loss: 0.0770111 Vali Loss: 0.2042183 Test Loss: 0.2833686
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 28 cost time: 0.9143674373626709
Epoch: 28, Steps: 64 | Train Loss: 0.0766568 Vali Loss: 0.2050741 Test Loss: 0.2823142
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 29 cost time: 0.9040639400482178
Epoch: 29, Steps: 64 | Train Loss: 0.0767853 Vali Loss: 0.2063207 Test Loss: 0.2825193
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 30 cost time: 0.9183464050292969
Epoch: 30, Steps: 64 | Train Loss: 0.0769302 Vali Loss: 0.2036806 Test Loss: 0.2824650
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 31 cost time: 0.9170000553131104
Epoch: 31, Steps: 64 | Train Loss: 0.0767074 Vali Loss: 0.2028787 Test Loss: 0.2828773
Validation loss decreased (0.203628 --> 0.202879).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 32 cost time: 0.9206335544586182
Epoch: 32, Steps: 64 | Train Loss: 0.0767178 Vali Loss: 0.2042843 Test Loss: 0.2843331
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 33 cost time: 0.9124913215637207
Epoch: 33, Steps: 64 | Train Loss: 0.0766462 Vali Loss: 0.2045832 Test Loss: 0.2825538
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 34 cost time: 0.9111649990081787
Epoch: 34, Steps: 64 | Train Loss: 0.0762534 Vali Loss: 0.2044231 Test Loss: 0.2843236
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 35 cost time: 0.9107034206390381
Epoch: 35, Steps: 64 | Train Loss: 0.0761845 Vali Loss: 0.2044529 Test Loss: 0.2832255
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 36 cost time: 0.930448055267334
Epoch: 36, Steps: 64 | Train Loss: 0.0762125 Vali Loss: 0.2046492 Test Loss: 0.2817536
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 37 cost time: 0.9188215732574463
Epoch: 37, Steps: 64 | Train Loss: 0.0763210 Vali Loss: 0.1987057 Test Loss: 0.2816261
Validation loss decreased (0.202879 --> 0.198706).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 38 cost time: 0.9230000972747803
Epoch: 38, Steps: 64 | Train Loss: 0.0762196 Vali Loss: 0.2025202 Test Loss: 0.2833332
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 39 cost time: 0.9309978485107422
Epoch: 39, Steps: 64 | Train Loss: 0.0761406 Vali Loss: 0.2037096 Test Loss: 0.2825563
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 40 cost time: 0.9113938808441162
Epoch: 40, Steps: 64 | Train Loss: 0.0761568 Vali Loss: 0.2046991 Test Loss: 0.2821907
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 41 cost time: 0.9103765487670898
Epoch: 41, Steps: 64 | Train Loss: 0.0757003 Vali Loss: 0.2042961 Test Loss: 0.2826800
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 42 cost time: 0.9124560356140137
Epoch: 42, Steps: 64 | Train Loss: 0.0759423 Vali Loss: 0.2033785 Test Loss: 0.2825493
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 43 cost time: 0.9010169506072998
Epoch: 43, Steps: 64 | Train Loss: 0.0761002 Vali Loss: 0.2027717 Test Loss: 0.2826203
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 44 cost time: 0.9087989330291748
Epoch: 44, Steps: 64 | Train Loss: 0.0757697 Vali Loss: 0.2031001 Test Loss: 0.2825485
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 45 cost time: 0.9210004806518555
Epoch: 45, Steps: 64 | Train Loss: 0.0754971 Vali Loss: 0.2028203 Test Loss: 0.2831616
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 46 cost time: 0.9256205558776855
Epoch: 46, Steps: 64 | Train Loss: 0.0758502 Vali Loss: 0.2021048 Test Loss: 0.2823184
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 47 cost time: 0.9172959327697754
Epoch: 47, Steps: 64 | Train Loss: 0.0757913 Vali Loss: 0.2021082 Test Loss: 0.2819084
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 48 cost time: 0.9113481044769287
Epoch: 48, Steps: 64 | Train Loss: 0.0762545 Vali Loss: 0.2012646 Test Loss: 0.2825158
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 49 cost time: 0.9193286895751953
Epoch: 49, Steps: 64 | Train Loss: 0.0755700 Vali Loss: 0.2011297 Test Loss: 0.2825179
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 50 cost time: 0.9147677421569824
Epoch: 50, Steps: 64 | Train Loss: 0.0760676 Vali Loss: 0.2001610 Test Loss: 0.2824295
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 51 cost time: 0.9100005626678467
Epoch: 51, Steps: 64 | Train Loss: 0.0759633 Vali Loss: 0.2041809 Test Loss: 0.2828704
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 52 cost time: 0.9106178283691406
Epoch: 52, Steps: 64 | Train Loss: 0.0755678 Vali Loss: 0.2051469 Test Loss: 0.2823273
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 53 cost time: 0.9206211566925049
Epoch: 53, Steps: 64 | Train Loss: 0.0759511 Vali Loss: 0.2023509 Test Loss: 0.2820785
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 54 cost time: 0.9083883762359619
Epoch: 54, Steps: 64 | Train Loss: 0.0756572 Vali Loss: 0.2021026 Test Loss: 0.2828634
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 55 cost time: 0.9163615703582764
Epoch: 55, Steps: 64 | Train Loss: 0.0758466 Vali Loss: 0.1988139 Test Loss: 0.2820303
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 56 cost time: 0.9119668006896973
Epoch: 56, Steps: 64 | Train Loss: 0.0760085 Vali Loss: 0.2013521 Test Loss: 0.2829551
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 57 cost time: 0.9247744083404541
Epoch: 57, Steps: 64 | Train Loss: 0.0758076 Vali Loss: 0.2025275 Test Loss: 0.2821689
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 58 cost time: 0.9160001277923584
Epoch: 58, Steps: 64 | Train Loss: 0.0761642 Vali Loss: 0.1998360 Test Loss: 0.2817447
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 59 cost time: 0.913621187210083
Epoch: 59, Steps: 64 | Train Loss: 0.0758952 Vali Loss: 0.2025849 Test Loss: 0.2833772
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 60 cost time: 0.9181528091430664
Epoch: 60, Steps: 64 | Train Loss: 0.0758806 Vali Loss: 0.2013062 Test Loss: 0.2834664
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2816261351108551, mae:0.3409542739391327, rse:0.24356184899806976
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04583406448364258 GB
Epoch: 1 cost time: 2.2407424449920654
Epoch: 1, Steps: 64 | Train Loss: 1.2189536 Vali Loss: 3.4858327 Test Loss: 5.8794317
Validation loss decreased (inf --> 3.485833).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 2 cost time: 0.877983570098877
Epoch: 2, Steps: 64 | Train Loss: 0.6711153 Vali Loss: 0.9119925 Test Loss: 1.3179624
Validation loss decreased (3.485833 --> 0.911993).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 3 cost time: 0.8727376461029053
Epoch: 3, Steps: 64 | Train Loss: 0.2956303 Vali Loss: 0.5420954 Test Loss: 0.6756217
Validation loss decreased (0.911993 --> 0.542095).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 4 cost time: 0.8638434410095215
Epoch: 4, Steps: 64 | Train Loss: 0.2003689 Vali Loss: 0.3978367 Test Loss: 0.4601329
Validation loss decreased (0.542095 --> 0.397837).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 5 cost time: 0.8686215877532959
Epoch: 5, Steps: 64 | Train Loss: 0.1633123 Vali Loss: 0.3255639 Test Loss: 0.3826848
Validation loss decreased (0.397837 --> 0.325564).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 6 cost time: 0.8656251430511475
Epoch: 6, Steps: 64 | Train Loss: 0.1455391 Vali Loss: 0.2961752 Test Loss: 0.3441383
Validation loss decreased (0.325564 --> 0.296175).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 7 cost time: 0.8715047836303711
Epoch: 7, Steps: 64 | Train Loss: 0.1355942 Vali Loss: 0.2812328 Test Loss: 0.3247443
Validation loss decreased (0.296175 --> 0.281233).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 8 cost time: 0.8661210536956787
Epoch: 8, Steps: 64 | Train Loss: 0.1291876 Vali Loss: 0.2695248 Test Loss: 0.3139343
Validation loss decreased (0.281233 --> 0.269525).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 9 cost time: 0.8597114086151123
Epoch: 9, Steps: 64 | Train Loss: 0.1246643 Vali Loss: 0.2601098 Test Loss: 0.3116352
Validation loss decreased (0.269525 --> 0.260110).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 10 cost time: 0.8654153347015381
Epoch: 10, Steps: 64 | Train Loss: 0.1214482 Vali Loss: 0.2602451 Test Loss: 0.3067406
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 11 cost time: 0.9016265869140625
Epoch: 11, Steps: 64 | Train Loss: 0.1189758 Vali Loss: 0.2558597 Test Loss: 0.3058682
Validation loss decreased (0.260110 --> 0.255860).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 12 cost time: 0.8744559288024902
Epoch: 12, Steps: 64 | Train Loss: 0.1164657 Vali Loss: 0.2502123 Test Loss: 0.3003554
Validation loss decreased (0.255860 --> 0.250212).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 13 cost time: 0.8753516674041748
Epoch: 13, Steps: 64 | Train Loss: 0.1136793 Vali Loss: 0.2476324 Test Loss: 0.2990009
Validation loss decreased (0.250212 --> 0.247632).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 14 cost time: 0.8763277530670166
Epoch: 14, Steps: 64 | Train Loss: 0.1121392 Vali Loss: 0.2449414 Test Loss: 0.2991741
Validation loss decreased (0.247632 --> 0.244941).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 15 cost time: 0.8813049793243408
Epoch: 15, Steps: 64 | Train Loss: 0.1113298 Vali Loss: 0.2450374 Test Loss: 0.2976024
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 16 cost time: 0.8826143741607666
Epoch: 16, Steps: 64 | Train Loss: 0.1097295 Vali Loss: 0.2421687 Test Loss: 0.2936378
Validation loss decreased (0.244941 --> 0.242169).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 17 cost time: 0.8886053562164307
Epoch: 17, Steps: 64 | Train Loss: 0.1088573 Vali Loss: 0.2418026 Test Loss: 0.2956638
Validation loss decreased (0.242169 --> 0.241803).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 18 cost time: 0.897374153137207
Epoch: 18, Steps: 64 | Train Loss: 0.1080105 Vali Loss: 0.2401901 Test Loss: 0.2927825
Validation loss decreased (0.241803 --> 0.240190).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 19 cost time: 0.8873805999755859
Epoch: 19, Steps: 64 | Train Loss: 0.1077680 Vali Loss: 0.2407611 Test Loss: 0.2934162
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 20 cost time: 0.8962891101837158
Epoch: 20, Steps: 64 | Train Loss: 0.1071720 Vali Loss: 0.2410599 Test Loss: 0.2928322
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 21 cost time: 0.892695426940918
Epoch: 21, Steps: 64 | Train Loss: 0.1058805 Vali Loss: 0.2361683 Test Loss: 0.2918846
Validation loss decreased (0.240190 --> 0.236168).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 22 cost time: 0.8960001468658447
Epoch: 22, Steps: 64 | Train Loss: 0.1056014 Vali Loss: 0.2368707 Test Loss: 0.2905236
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 23 cost time: 0.8946237564086914
Epoch: 23, Steps: 64 | Train Loss: 0.1049926 Vali Loss: 0.2396653 Test Loss: 0.2925898
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 24 cost time: 0.8832459449768066
Epoch: 24, Steps: 64 | Train Loss: 0.1047858 Vali Loss: 0.2360199 Test Loss: 0.2922119
Validation loss decreased (0.236168 --> 0.236020).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 25 cost time: 0.8863327503204346
Epoch: 25, Steps: 64 | Train Loss: 0.1035469 Vali Loss: 0.2355230 Test Loss: 0.2897406
Validation loss decreased (0.236020 --> 0.235523).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 26 cost time: 0.8574666976928711
Epoch: 26, Steps: 64 | Train Loss: 0.1034949 Vali Loss: 0.2357591 Test Loss: 0.2914169
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 27 cost time: 0.866793155670166
Epoch: 27, Steps: 64 | Train Loss: 0.1033717 Vali Loss: 0.2356995 Test Loss: 0.2887844
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 28 cost time: 0.8689994812011719
Epoch: 28, Steps: 64 | Train Loss: 0.1034230 Vali Loss: 0.2327062 Test Loss: 0.2893414
Validation loss decreased (0.235523 --> 0.232706).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 29 cost time: 0.8880667686462402
Epoch: 29, Steps: 64 | Train Loss: 0.1025330 Vali Loss: 0.2358224 Test Loss: 0.2929630
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 30 cost time: 0.9123973846435547
Epoch: 30, Steps: 64 | Train Loss: 0.1017855 Vali Loss: 0.2326172 Test Loss: 0.2904448
Validation loss decreased (0.232706 --> 0.232617).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 31 cost time: 0.8735051155090332
Epoch: 31, Steps: 64 | Train Loss: 0.1021133 Vali Loss: 0.2330693 Test Loss: 0.2887688
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 32 cost time: 0.8783776760101318
Epoch: 32, Steps: 64 | Train Loss: 0.1018465 Vali Loss: 0.2342733 Test Loss: 0.2887620
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 33 cost time: 0.8717608451843262
Epoch: 33, Steps: 64 | Train Loss: 0.1015604 Vali Loss: 0.2331249 Test Loss: 0.2878636
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 34 cost time: 0.871999979019165
Epoch: 34, Steps: 64 | Train Loss: 0.1013517 Vali Loss: 0.2335156 Test Loss: 0.2882822
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 35 cost time: 0.8660938739776611
Epoch: 35, Steps: 64 | Train Loss: 0.1021835 Vali Loss: 0.2336227 Test Loss: 0.2894562
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 36 cost time: 0.8713531494140625
Epoch: 36, Steps: 64 | Train Loss: 0.1012588 Vali Loss: 0.2293248 Test Loss: 0.2882693
Validation loss decreased (0.232617 --> 0.229325).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 37 cost time: 0.8637816905975342
Epoch: 37, Steps: 64 | Train Loss: 0.1013075 Vali Loss: 0.2324020 Test Loss: 0.2874455
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 38 cost time: 0.8721914291381836
Epoch: 38, Steps: 64 | Train Loss: 0.1008730 Vali Loss: 0.2312399 Test Loss: 0.2881459
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 39 cost time: 0.8780002593994141
Epoch: 39, Steps: 64 | Train Loss: 0.1009893 Vali Loss: 0.2336441 Test Loss: 0.2874016
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 40 cost time: 0.885634183883667
Epoch: 40, Steps: 64 | Train Loss: 0.1007138 Vali Loss: 0.2337533 Test Loss: 0.2900781
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 41 cost time: 0.8733916282653809
Epoch: 41, Steps: 64 | Train Loss: 0.1008009 Vali Loss: 0.2302629 Test Loss: 0.2897066
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 42 cost time: 0.8710906505584717
Epoch: 42, Steps: 64 | Train Loss: 0.1008217 Vali Loss: 0.2326457 Test Loss: 0.2894132
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 43 cost time: 0.8673667907714844
Epoch: 43, Steps: 64 | Train Loss: 0.1011640 Vali Loss: 0.2305323 Test Loss: 0.2877146
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 44 cost time: 0.8817222118377686
Epoch: 44, Steps: 64 | Train Loss: 0.1003787 Vali Loss: 0.2285852 Test Loss: 0.2904865
Validation loss decreased (0.229325 --> 0.228585).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 45 cost time: 0.8670001029968262
Epoch: 45, Steps: 64 | Train Loss: 0.1001864 Vali Loss: 0.2323456 Test Loss: 0.2897818
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 46 cost time: 0.8686187267303467
Epoch: 46, Steps: 64 | Train Loss: 0.1008684 Vali Loss: 0.2310733 Test Loss: 0.2881626
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 47 cost time: 0.8883259296417236
Epoch: 47, Steps: 64 | Train Loss: 0.1008389 Vali Loss: 0.2307868 Test Loss: 0.2884360
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 48 cost time: 0.8577146530151367
Epoch: 48, Steps: 64 | Train Loss: 0.1001957 Vali Loss: 0.2295613 Test Loss: 0.2882086
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 49 cost time: 0.8743300437927246
Epoch: 49, Steps: 64 | Train Loss: 0.1002629 Vali Loss: 0.2291415 Test Loss: 0.2878194
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 50 cost time: 0.8789997100830078
Epoch: 50, Steps: 64 | Train Loss: 0.1004241 Vali Loss: 0.2321577 Test Loss: 0.2881702
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 51 cost time: 0.8673937320709229
Epoch: 51, Steps: 64 | Train Loss: 0.1005789 Vali Loss: 0.2293330 Test Loss: 0.2884876
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 52 cost time: 0.8674049377441406
Epoch: 52, Steps: 64 | Train Loss: 0.0999526 Vali Loss: 0.2310339 Test Loss: 0.2862017
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 53 cost time: 0.868358850479126
Epoch: 53, Steps: 64 | Train Loss: 0.1002514 Vali Loss: 0.2318202 Test Loss: 0.2872419
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 54 cost time: 0.8664436340332031
Epoch: 54, Steps: 64 | Train Loss: 0.1007889 Vali Loss: 0.2296821 Test Loss: 0.2864517
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 55 cost time: 0.8528459072113037
Epoch: 55, Steps: 64 | Train Loss: 0.0999845 Vali Loss: 0.2307468 Test Loss: 0.2884150
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 56 cost time: 0.872999906539917
Epoch: 56, Steps: 64 | Train Loss: 0.0998354 Vali Loss: 0.2329052 Test Loss: 0.2880152
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 57 cost time: 0.8706183433532715
Epoch: 57, Steps: 64 | Train Loss: 0.1000638 Vali Loss: 0.2307265 Test Loss: 0.2877344
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 58 cost time: 0.8904662132263184
Epoch: 58, Steps: 64 | Train Loss: 0.1003619 Vali Loss: 0.2306193 Test Loss: 0.2869869
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 59 cost time: 0.8764133453369141
Epoch: 59, Steps: 64 | Train Loss: 0.0999834 Vali Loss: 0.2322890 Test Loss: 0.2872706
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 60 cost time: 0.8677539825439453
Epoch: 60, Steps: 64 | Train Loss: 0.1005760 Vali Loss: 0.2316796 Test Loss: 0.2883519
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.29048651456832886, mae:0.343763530254364, rse:0.2473635971546173
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.04726600646972656 GB
Epoch: 1 cost time: 2.345201015472412
Epoch: 1, Steps: 64 | Train Loss: 0.8938583 Vali Loss: 2.6480212 Test Loss: 4.6542044
Validation loss decreased (inf --> 2.648021).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 2 cost time: 0.9686973094940186
Epoch: 2, Steps: 64 | Train Loss: 0.5120870 Vali Loss: 0.6788691 Test Loss: 0.9649541
Validation loss decreased (2.648021 --> 0.678869).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 3 cost time: 0.9666187763214111
Epoch: 3, Steps: 64 | Train Loss: 0.1627978 Vali Loss: 0.3047897 Test Loss: 0.3076284
Validation loss decreased (0.678869 --> 0.304790).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 4 cost time: 0.9606153964996338
Epoch: 4, Steps: 64 | Train Loss: 0.1111141 Vali Loss: 0.2547863 Test Loss: 0.3003576
Validation loss decreased (0.304790 --> 0.254786).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 5 cost time: 0.9671618938446045
Epoch: 5, Steps: 64 | Train Loss: 0.1023389 Vali Loss: 0.2529974 Test Loss: 0.2902743
Validation loss decreased (0.254786 --> 0.252997).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 6 cost time: 0.9577383995056152
Epoch: 6, Steps: 64 | Train Loss: 0.0977314 Vali Loss: 0.2428657 Test Loss: 0.2896183
Validation loss decreased (0.252997 --> 0.242866).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 7 cost time: 0.9643735885620117
Epoch: 7, Steps: 64 | Train Loss: 0.0945564 Vali Loss: 0.2389560 Test Loss: 0.2843003
Validation loss decreased (0.242866 --> 0.238956).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 8 cost time: 0.9673283100128174
Epoch: 8, Steps: 64 | Train Loss: 0.0920191 Vali Loss: 0.2360697 Test Loss: 0.2856518
Validation loss decreased (0.238956 --> 0.236070).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 9 cost time: 0.9433255195617676
Epoch: 9, Steps: 64 | Train Loss: 0.0898305 Vali Loss: 0.2358315 Test Loss: 0.2826746
Validation loss decreased (0.236070 --> 0.235831).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 10 cost time: 0.9664454460144043
Epoch: 10, Steps: 64 | Train Loss: 0.0884265 Vali Loss: 0.2295463 Test Loss: 0.2861117
Validation loss decreased (0.235831 --> 0.229546).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 11 cost time: 0.9677932262420654
Epoch: 11, Steps: 64 | Train Loss: 0.0867510 Vali Loss: 0.2211393 Test Loss: 0.2835485
Validation loss decreased (0.229546 --> 0.221139).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 12 cost time: 0.9704082012176514
Epoch: 12, Steps: 64 | Train Loss: 0.0857494 Vali Loss: 0.2242514 Test Loss: 0.2838356
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 13 cost time: 0.9650001525878906
Epoch: 13, Steps: 64 | Train Loss: 0.0847084 Vali Loss: 0.2205045 Test Loss: 0.2830051
Validation loss decreased (0.221139 --> 0.220504).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 14 cost time: 0.9519789218902588
Epoch: 14, Steps: 64 | Train Loss: 0.0835824 Vali Loss: 0.2185130 Test Loss: 0.2831376
Validation loss decreased (0.220504 --> 0.218513).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 15 cost time: 0.9702956676483154
Epoch: 15, Steps: 64 | Train Loss: 0.0827689 Vali Loss: 0.2190857 Test Loss: 0.2826821
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 16 cost time: 0.9510397911071777
Epoch: 16, Steps: 64 | Train Loss: 0.0822099 Vali Loss: 0.2178979 Test Loss: 0.2805378
Validation loss decreased (0.218513 --> 0.217898).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 17 cost time: 0.952289342880249
Epoch: 17, Steps: 64 | Train Loss: 0.0819571 Vali Loss: 0.2124991 Test Loss: 0.2783730
Validation loss decreased (0.217898 --> 0.212499).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 18 cost time: 0.9671881198883057
Epoch: 18, Steps: 64 | Train Loss: 0.0809660 Vali Loss: 0.2117274 Test Loss: 0.2799408
Validation loss decreased (0.212499 --> 0.211727).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 19 cost time: 0.9659674167633057
Epoch: 19, Steps: 64 | Train Loss: 0.0806569 Vali Loss: 0.2124136 Test Loss: 0.2802478
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 20 cost time: 0.9593396186828613
Epoch: 20, Steps: 64 | Train Loss: 0.0798674 Vali Loss: 0.2062008 Test Loss: 0.2787789
Validation loss decreased (0.211727 --> 0.206201).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 21 cost time: 0.9598586559295654
Epoch: 21, Steps: 64 | Train Loss: 0.0794602 Vali Loss: 0.2054382 Test Loss: 0.2792016
Validation loss decreased (0.206201 --> 0.205438).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 22 cost time: 0.9438180923461914
Epoch: 22, Steps: 64 | Train Loss: 0.0792499 Vali Loss: 0.2041750 Test Loss: 0.2770192
Validation loss decreased (0.205438 --> 0.204175).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 23 cost time: 0.9409997463226318
Epoch: 23, Steps: 64 | Train Loss: 0.0783295 Vali Loss: 0.2051763 Test Loss: 0.2795453
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 24 cost time: 0.9526200294494629
Epoch: 24, Steps: 64 | Train Loss: 0.0783469 Vali Loss: 0.2037172 Test Loss: 0.2774681
Validation loss decreased (0.204175 --> 0.203717).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 25 cost time: 0.9494218826293945
Epoch: 25, Steps: 64 | Train Loss: 0.0781151 Vali Loss: 0.2044829 Test Loss: 0.2776525
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 26 cost time: 0.9554307460784912
Epoch: 26, Steps: 64 | Train Loss: 0.0778806 Vali Loss: 0.2028483 Test Loss: 0.2772604
Validation loss decreased (0.203717 --> 0.202848).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 27 cost time: 0.9684340953826904
Epoch: 27, Steps: 64 | Train Loss: 0.0778151 Vali Loss: 0.2007859 Test Loss: 0.2777759
Validation loss decreased (0.202848 --> 0.200786).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 28 cost time: 0.9693586826324463
Epoch: 28, Steps: 64 | Train Loss: 0.0774077 Vali Loss: 0.2001479 Test Loss: 0.2754411
Validation loss decreased (0.200786 --> 0.200148).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 29 cost time: 0.9203197956085205
Epoch: 29, Steps: 64 | Train Loss: 0.0771988 Vali Loss: 0.2003583 Test Loss: 0.2777546
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 30 cost time: 0.9683644771575928
Epoch: 30, Steps: 64 | Train Loss: 0.0774119 Vali Loss: 0.1995222 Test Loss: 0.2771150
Validation loss decreased (0.200148 --> 0.199522).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 31 cost time: 0.9504694938659668
Epoch: 31, Steps: 64 | Train Loss: 0.0770460 Vali Loss: 0.2021906 Test Loss: 0.2775641
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 32 cost time: 0.9659996032714844
Epoch: 32, Steps: 64 | Train Loss: 0.0770093 Vali Loss: 0.2040152 Test Loss: 0.2755564
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 33 cost time: 0.9579999446868896
Epoch: 33, Steps: 64 | Train Loss: 0.0766180 Vali Loss: 0.2004233 Test Loss: 0.2784365
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 34 cost time: 0.9526228904724121
Epoch: 34, Steps: 64 | Train Loss: 0.0762150 Vali Loss: 0.1996412 Test Loss: 0.2775521
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 35 cost time: 0.9678263664245605
Epoch: 35, Steps: 64 | Train Loss: 0.0767383 Vali Loss: 0.2002471 Test Loss: 0.2768785
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 36 cost time: 0.961331844329834
Epoch: 36, Steps: 64 | Train Loss: 0.0760893 Vali Loss: 0.1969936 Test Loss: 0.2753143
Validation loss decreased (0.199522 --> 0.196994).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 37 cost time: 0.9664037227630615
Epoch: 37, Steps: 64 | Train Loss: 0.0765866 Vali Loss: 0.2010099 Test Loss: 0.2765999
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 38 cost time: 0.967329740524292
Epoch: 38, Steps: 64 | Train Loss: 0.0762527 Vali Loss: 0.1979391 Test Loss: 0.2773637
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 39 cost time: 0.9566748142242432
Epoch: 39, Steps: 64 | Train Loss: 0.0761242 Vali Loss: 0.1978883 Test Loss: 0.2766882
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 40 cost time: 0.9488418102264404
Epoch: 40, Steps: 64 | Train Loss: 0.0759900 Vali Loss: 0.1989051 Test Loss: 0.2754984
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 41 cost time: 0.9487094879150391
Epoch: 41, Steps: 64 | Train Loss: 0.0760413 Vali Loss: 0.1964213 Test Loss: 0.2753322
Validation loss decreased (0.196994 --> 0.196421).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 42 cost time: 0.9539997577667236
Epoch: 42, Steps: 64 | Train Loss: 0.0759997 Vali Loss: 0.1988153 Test Loss: 0.2754853
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 43 cost time: 0.9506230354309082
Epoch: 43, Steps: 64 | Train Loss: 0.0756623 Vali Loss: 0.1988584 Test Loss: 0.2768590
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 44 cost time: 0.969017505645752
Epoch: 44, Steps: 64 | Train Loss: 0.0758507 Vali Loss: 0.1969386 Test Loss: 0.2756020
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 45 cost time: 0.9693360328674316
Epoch: 45, Steps: 64 | Train Loss: 0.0761435 Vali Loss: 0.1972196 Test Loss: 0.2750246
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 46 cost time: 0.9647190570831299
Epoch: 46, Steps: 64 | Train Loss: 0.0761548 Vali Loss: 0.1990636 Test Loss: 0.2757305
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 47 cost time: 0.954479455947876
Epoch: 47, Steps: 64 | Train Loss: 0.0758976 Vali Loss: 0.1991040 Test Loss: 0.2760019
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 48 cost time: 0.9567697048187256
Epoch: 48, Steps: 64 | Train Loss: 0.0761281 Vali Loss: 0.1974560 Test Loss: 0.2752918
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 49 cost time: 0.9513475894927979
Epoch: 49, Steps: 64 | Train Loss: 0.0759660 Vali Loss: 0.1986223 Test Loss: 0.2757420
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 50 cost time: 0.9528276920318604
Epoch: 50, Steps: 64 | Train Loss: 0.0757110 Vali Loss: 0.1978850 Test Loss: 0.2760752
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 51 cost time: 0.9519999027252197
Epoch: 51, Steps: 64 | Train Loss: 0.0752982 Vali Loss: 0.1960780 Test Loss: 0.2744936
Validation loss decreased (0.196421 --> 0.196078).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 52 cost time: 0.9760279655456543
Epoch: 52, Steps: 64 | Train Loss: 0.0759584 Vali Loss: 0.1980618 Test Loss: 0.2760245
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 53 cost time: 0.9626121520996094
Epoch: 53, Steps: 64 | Train Loss: 0.0757146 Vali Loss: 0.1985944 Test Loss: 0.2753648
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 54 cost time: 0.9634191989898682
Epoch: 54, Steps: 64 | Train Loss: 0.0755885 Vali Loss: 0.1976489 Test Loss: 0.2745495
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 55 cost time: 0.9733786582946777
Epoch: 55, Steps: 64 | Train Loss: 0.0757087 Vali Loss: 0.1980947 Test Loss: 0.2751711
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 56 cost time: 0.9573454856872559
Epoch: 56, Steps: 64 | Train Loss: 0.0758824 Vali Loss: 0.1992114 Test Loss: 0.2754169
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 57 cost time: 0.9523680210113525
Epoch: 57, Steps: 64 | Train Loss: 0.0757608 Vali Loss: 0.1984555 Test Loss: 0.2755061
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 58 cost time: 0.9593970775604248
Epoch: 58, Steps: 64 | Train Loss: 0.0755976 Vali Loss: 0.1999255 Test Loss: 0.2750836
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 59 cost time: 0.9518275260925293
Epoch: 59, Steps: 64 | Train Loss: 0.0753290 Vali Loss: 0.1980653 Test Loss: 0.2748907
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 60 cost time: 0.9531970024108887
Epoch: 60, Steps: 64 | Train Loss: 0.0758775 Vali Loss: 0.1980298 Test Loss: 0.2763290
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.27449357509613037, mae:0.3373832404613495, rse:0.24045781791210175
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.0483860969543457 GB
Epoch: 1 cost time: 2.330472707748413
Epoch: 1, Steps: 64 | Train Loss: 0.7576102 Vali Loss: 2.3192019 Test Loss: 4.0614924
Validation loss decreased (inf --> 2.319202).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 2 cost time: 0.9926168918609619
Epoch: 2, Steps: 64 | Train Loss: 0.4445066 Vali Loss: 0.5825995 Test Loss: 0.7318851
Validation loss decreased (2.319202 --> 0.582600).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 3 cost time: 0.9846177101135254
Epoch: 3, Steps: 64 | Train Loss: 0.1384726 Vali Loss: 0.3053199 Test Loss: 0.2891517
Validation loss decreased (0.582600 --> 0.305320).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 4 cost time: 0.9843852519989014
Epoch: 4, Steps: 64 | Train Loss: 0.1040831 Vali Loss: 0.2624383 Test Loss: 0.2902559
Validation loss decreased (0.305320 --> 0.262438).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 5 cost time: 0.9763598442077637
Epoch: 5, Steps: 64 | Train Loss: 0.0967499 Vali Loss: 0.2514605 Test Loss: 0.2820005
Validation loss decreased (0.262438 --> 0.251460).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 6 cost time: 0.975332498550415
Epoch: 6, Steps: 64 | Train Loss: 0.0931465 Vali Loss: 0.2439842 Test Loss: 0.2828358
Validation loss decreased (0.251460 --> 0.243984).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 7 cost time: 0.9754238128662109
Epoch: 7, Steps: 64 | Train Loss: 0.0901523 Vali Loss: 0.2355393 Test Loss: 0.2837764
Validation loss decreased (0.243984 --> 0.235539).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 8 cost time: 0.9903864860534668
Epoch: 8, Steps: 64 | Train Loss: 0.0884348 Vali Loss: 0.2296400 Test Loss: 0.2791905
Validation loss decreased (0.235539 --> 0.229640).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 9 cost time: 0.9788007736206055
Epoch: 9, Steps: 64 | Train Loss: 0.0866997 Vali Loss: 0.2312207 Test Loss: 0.2787772
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 10 cost time: 0.9903883934020996
Epoch: 10, Steps: 64 | Train Loss: 0.0852351 Vali Loss: 0.2255582 Test Loss: 0.2762827
Validation loss decreased (0.229640 --> 0.225558).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 11 cost time: 0.9863672256469727
Epoch: 11, Steps: 64 | Train Loss: 0.0841323 Vali Loss: 0.2182025 Test Loss: 0.2738686
Validation loss decreased (0.225558 --> 0.218202).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 12 cost time: 0.9969308376312256
Epoch: 12, Steps: 64 | Train Loss: 0.0830426 Vali Loss: 0.2191145 Test Loss: 0.2757309
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 13 cost time: 0.9911525249481201
Epoch: 13, Steps: 64 | Train Loss: 0.0819879 Vali Loss: 0.2138764 Test Loss: 0.2737596
Validation loss decreased (0.218202 --> 0.213876).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 14 cost time: 0.9780001640319824
Epoch: 14, Steps: 64 | Train Loss: 0.0811308 Vali Loss: 0.2101085 Test Loss: 0.2720962
Validation loss decreased (0.213876 --> 0.210109).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 15 cost time: 0.9951164722442627
Epoch: 15, Steps: 64 | Train Loss: 0.0804746 Vali Loss: 0.2096873 Test Loss: 0.2697526
Validation loss decreased (0.210109 --> 0.209687).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 16 cost time: 0.9776182174682617
Epoch: 16, Steps: 64 | Train Loss: 0.0795110 Vali Loss: 0.2079731 Test Loss: 0.2717921
Validation loss decreased (0.209687 --> 0.207973).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 17 cost time: 0.9784338474273682
Epoch: 17, Steps: 64 | Train Loss: 0.0790671 Vali Loss: 0.2056797 Test Loss: 0.2709106
Validation loss decreased (0.207973 --> 0.205680).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 18 cost time: 0.9914398193359375
Epoch: 18, Steps: 64 | Train Loss: 0.0786656 Vali Loss: 0.2035198 Test Loss: 0.2694393
Validation loss decreased (0.205680 --> 0.203520).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 19 cost time: 0.9883596897125244
Epoch: 19, Steps: 64 | Train Loss: 0.0785058 Vali Loss: 0.2038073 Test Loss: 0.2681023
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 20 cost time: 0.9833211898803711
Epoch: 20, Steps: 64 | Train Loss: 0.0779895 Vali Loss: 0.1962201 Test Loss: 0.2679632
Validation loss decreased (0.203520 --> 0.196220).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 21 cost time: 0.9798271656036377
Epoch: 21, Steps: 64 | Train Loss: 0.0771219 Vali Loss: 0.2012525 Test Loss: 0.2682481
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 22 cost time: 1.0695149898529053
Epoch: 22, Steps: 64 | Train Loss: 0.0770241 Vali Loss: 0.1985047 Test Loss: 0.2663660
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 23 cost time: 1.0044066905975342
Epoch: 23, Steps: 64 | Train Loss: 0.0766337 Vali Loss: 0.1997214 Test Loss: 0.2661289
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 24 cost time: 0.9805624485015869
Epoch: 24, Steps: 64 | Train Loss: 0.0768754 Vali Loss: 0.1980839 Test Loss: 0.2659081
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 25 cost time: 0.9769778251647949
Epoch: 25, Steps: 64 | Train Loss: 0.0762977 Vali Loss: 0.1969567 Test Loss: 0.2660074
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 26 cost time: 0.9837625026702881
Epoch: 26, Steps: 64 | Train Loss: 0.0764079 Vali Loss: 0.1970248 Test Loss: 0.2669241
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 27 cost time: 0.9887299537658691
Epoch: 27, Steps: 64 | Train Loss: 0.0762804 Vali Loss: 0.1980606 Test Loss: 0.2650976
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 28 cost time: 0.9552936553955078
Epoch: 28, Steps: 64 | Train Loss: 0.0759494 Vali Loss: 0.1958255 Test Loss: 0.2650000
Validation loss decreased (0.196220 --> 0.195825).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 29 cost time: 0.9916086196899414
Epoch: 29, Steps: 64 | Train Loss: 0.0756303 Vali Loss: 0.1958773 Test Loss: 0.2653268
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 30 cost time: 0.9816303253173828
Epoch: 30, Steps: 64 | Train Loss: 0.0758976 Vali Loss: 0.1959023 Test Loss: 0.2653778
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 31 cost time: 0.9934766292572021
Epoch: 31, Steps: 64 | Train Loss: 0.0756754 Vali Loss: 0.1966674 Test Loss: 0.2649629
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 32 cost time: 1.0016279220581055
Epoch: 32, Steps: 64 | Train Loss: 0.0753699 Vali Loss: 0.1964465 Test Loss: 0.2637585
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 33 cost time: 0.9838049411773682
Epoch: 33, Steps: 64 | Train Loss: 0.0751069 Vali Loss: 0.1965785 Test Loss: 0.2644304
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 34 cost time: 0.9912567138671875
Epoch: 34, Steps: 64 | Train Loss: 0.0752218 Vali Loss: 0.1974635 Test Loss: 0.2648855
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 35 cost time: 0.9875602722167969
Epoch: 35, Steps: 64 | Train Loss: 0.0750226 Vali Loss: 0.1942898 Test Loss: 0.2646661
Validation loss decreased (0.195825 --> 0.194290).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 36 cost time: 0.9974849224090576
Epoch: 36, Steps: 64 | Train Loss: 0.0751962 Vali Loss: 0.1965672 Test Loss: 0.2641574
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 37 cost time: 1.004012107849121
Epoch: 37, Steps: 64 | Train Loss: 0.0749953 Vali Loss: 0.1947434 Test Loss: 0.2650912
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 38 cost time: 0.9914307594299316
Epoch: 38, Steps: 64 | Train Loss: 0.0750062 Vali Loss: 0.1969212 Test Loss: 0.2641431
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 39 cost time: 0.9657824039459229
Epoch: 39, Steps: 64 | Train Loss: 0.0750253 Vali Loss: 0.1962617 Test Loss: 0.2640926
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 40 cost time: 0.9760003089904785
Epoch: 40, Steps: 64 | Train Loss: 0.0750160 Vali Loss: 0.1940777 Test Loss: 0.2642150
Validation loss decreased (0.194290 --> 0.194078).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 41 cost time: 0.9506287574768066
Epoch: 41, Steps: 64 | Train Loss: 0.0753141 Vali Loss: 0.1925125 Test Loss: 0.2635541
Validation loss decreased (0.194078 --> 0.192513).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 42 cost time: 0.9776062965393066
Epoch: 42, Steps: 64 | Train Loss: 0.0753434 Vali Loss: 0.1961936 Test Loss: 0.2656412
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 43 cost time: 0.9893887042999268
Epoch: 43, Steps: 64 | Train Loss: 0.0748041 Vali Loss: 0.1952920 Test Loss: 0.2638536
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 44 cost time: 0.9974777698516846
Epoch: 44, Steps: 64 | Train Loss: 0.0748068 Vali Loss: 0.1984828 Test Loss: 0.2646015
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 45 cost time: 0.9712622165679932
Epoch: 45, Steps: 64 | Train Loss: 0.0750440 Vali Loss: 0.1943980 Test Loss: 0.2639332
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 46 cost time: 0.9777088165283203
Epoch: 46, Steps: 64 | Train Loss: 0.0748407 Vali Loss: 0.1954674 Test Loss: 0.2636281
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 47 cost time: 0.9823439121246338
Epoch: 47, Steps: 64 | Train Loss: 0.0743784 Vali Loss: 0.1958095 Test Loss: 0.2644904
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 48 cost time: 0.9913911819458008
Epoch: 48, Steps: 64 | Train Loss: 0.0749073 Vali Loss: 0.1941452 Test Loss: 0.2645219
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 49 cost time: 0.9930031299591064
Epoch: 49, Steps: 64 | Train Loss: 0.0743879 Vali Loss: 0.1967651 Test Loss: 0.2640568
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 50 cost time: 1.0161046981811523
Epoch: 50, Steps: 64 | Train Loss: 0.0747704 Vali Loss: 0.1948612 Test Loss: 0.2663198
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 51 cost time: 0.9939944744110107
Epoch: 51, Steps: 64 | Train Loss: 0.0748821 Vali Loss: 0.1924527 Test Loss: 0.2637877
Validation loss decreased (0.192513 --> 0.192453).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 52 cost time: 0.995837926864624
Epoch: 52, Steps: 64 | Train Loss: 0.0751407 Vali Loss: 0.1917013 Test Loss: 0.2640774
Validation loss decreased (0.192453 --> 0.191701).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 53 cost time: 0.9946155548095703
Epoch: 53, Steps: 64 | Train Loss: 0.0751379 Vali Loss: 0.1951413 Test Loss: 0.2640857
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 54 cost time: 0.9983024597167969
Epoch: 54, Steps: 64 | Train Loss: 0.0747703 Vali Loss: 0.1939490 Test Loss: 0.2637113
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 55 cost time: 0.9786291122436523
Epoch: 55, Steps: 64 | Train Loss: 0.0750587 Vali Loss: 0.1927698 Test Loss: 0.2629722
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 56 cost time: 0.9927899837493896
Epoch: 56, Steps: 64 | Train Loss: 0.0746443 Vali Loss: 0.1929755 Test Loss: 0.2636746
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 57 cost time: 0.9886736869812012
Epoch: 57, Steps: 64 | Train Loss: 0.0745354 Vali Loss: 0.1951706 Test Loss: 0.2649015
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 58 cost time: 0.9733450412750244
Epoch: 58, Steps: 64 | Train Loss: 0.0744309 Vali Loss: 0.1962034 Test Loss: 0.2632788
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 59 cost time: 0.9853498935699463
Epoch: 59, Steps: 64 | Train Loss: 0.0747092 Vali Loss: 0.1941086 Test Loss: 0.2628994
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 60 cost time: 0.992241382598877
Epoch: 60, Steps: 64 | Train Loss: 0.0747537 Vali Loss: 0.1950834 Test Loss: 0.2640036
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.26407739520072937, mae:0.32245028018951416, rse:0.23585136234760284
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049146175384521484 GB
Epoch: 1 cost time: 2.234605073928833
Epoch: 1, Steps: 64 | Train Loss: 1.4883532 Vali Loss: 4.0851469 Test Loss: 7.4661088
Validation loss decreased (inf --> 4.085147).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 2 cost time: 0.8387751579284668
Epoch: 2, Steps: 64 | Train Loss: 1.0056600 Vali Loss: 1.5213735 Test Loss: 2.5901947
Validation loss decreased (4.085147 --> 1.521374).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 3 cost time: 0.8379998207092285
Epoch: 3, Steps: 64 | Train Loss: 0.4345497 Vali Loss: 0.6829382 Test Loss: 0.9475644
Validation loss decreased (1.521374 --> 0.682938).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 4 cost time: 0.8443963527679443
Epoch: 4, Steps: 64 | Train Loss: 0.2533022 Vali Loss: 0.4624227 Test Loss: 0.5779306
Validation loss decreased (0.682938 --> 0.462423).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 5 cost time: 0.8424127101898193
Epoch: 5, Steps: 64 | Train Loss: 0.1946379 Vali Loss: 0.3682220 Test Loss: 0.4516876
Validation loss decreased (0.462423 --> 0.368222).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 6 cost time: 0.8390429019927979
Epoch: 6, Steps: 64 | Train Loss: 0.1702649 Vali Loss: 0.3216150 Test Loss: 0.3923407
Validation loss decreased (0.368222 --> 0.321615).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 7 cost time: 0.8379998207092285
Epoch: 7, Steps: 64 | Train Loss: 0.1562313 Vali Loss: 0.2882469 Test Loss: 0.3531629
Validation loss decreased (0.321615 --> 0.288247).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 8 cost time: 0.8280808925628662
Epoch: 8, Steps: 64 | Train Loss: 0.1464083 Vali Loss: 0.2729729 Test Loss: 0.3375628
Validation loss decreased (0.288247 --> 0.272973).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 9 cost time: 0.8373665809631348
Epoch: 9, Steps: 64 | Train Loss: 0.1405808 Vali Loss: 0.2592543 Test Loss: 0.3278700
Validation loss decreased (0.272973 --> 0.259254).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 10 cost time: 0.8364729881286621
Epoch: 10, Steps: 64 | Train Loss: 0.1360645 Vali Loss: 0.2538621 Test Loss: 0.3201673
Validation loss decreased (0.259254 --> 0.253862).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 11 cost time: 0.8481752872467041
Epoch: 11, Steps: 64 | Train Loss: 0.1329868 Vali Loss: 0.2505332 Test Loss: 0.3156541
Validation loss decreased (0.253862 --> 0.250533).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 12 cost time: 0.8359999656677246
Epoch: 12, Steps: 64 | Train Loss: 0.1303624 Vali Loss: 0.2473791 Test Loss: 0.3126394
Validation loss decreased (0.250533 --> 0.247379).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 13 cost time: 0.8406307697296143
Epoch: 13, Steps: 64 | Train Loss: 0.1267244 Vali Loss: 0.2457632 Test Loss: 0.3116874
Validation loss decreased (0.247379 --> 0.245763).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 14 cost time: 0.8443398475646973
Epoch: 14, Steps: 64 | Train Loss: 0.1255335 Vali Loss: 0.2389447 Test Loss: 0.3096750
Validation loss decreased (0.245763 --> 0.238945).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 15 cost time: 0.8543863296508789
Epoch: 15, Steps: 64 | Train Loss: 0.1235176 Vali Loss: 0.2372804 Test Loss: 0.3083351
Validation loss decreased (0.238945 --> 0.237280).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 16 cost time: 0.8373630046844482
Epoch: 16, Steps: 64 | Train Loss: 0.1225503 Vali Loss: 0.2392069 Test Loss: 0.3070893
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 17 cost time: 0.8359987735748291
Epoch: 17, Steps: 64 | Train Loss: 0.1217031 Vali Loss: 0.2359227 Test Loss: 0.3070010
Validation loss decreased (0.237280 --> 0.235923).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 18 cost time: 0.8327016830444336
Epoch: 18, Steps: 64 | Train Loss: 0.1198749 Vali Loss: 0.2342162 Test Loss: 0.3050199
Validation loss decreased (0.235923 --> 0.234216).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 19 cost time: 0.8504493236541748
Epoch: 19, Steps: 64 | Train Loss: 0.1184149 Vali Loss: 0.2317889 Test Loss: 0.3021890
Validation loss decreased (0.234216 --> 0.231789).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 20 cost time: 0.84539794921875
Epoch: 20, Steps: 64 | Train Loss: 0.1177720 Vali Loss: 0.2316479 Test Loss: 0.3040802
Validation loss decreased (0.231789 --> 0.231648).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 21 cost time: 0.8469996452331543
Epoch: 21, Steps: 64 | Train Loss: 0.1169087 Vali Loss: 0.2308756 Test Loss: 0.3018054
Validation loss decreased (0.231648 --> 0.230876).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 22 cost time: 0.8467626571655273
Epoch: 22, Steps: 64 | Train Loss: 0.1159440 Vali Loss: 0.2306756 Test Loss: 0.3029945
Validation loss decreased (0.230876 --> 0.230676).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 23 cost time: 0.8536145687103271
Epoch: 23, Steps: 64 | Train Loss: 0.1153418 Vali Loss: 0.2290041 Test Loss: 0.3017696
Validation loss decreased (0.230676 --> 0.229004).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 24 cost time: 0.8463678359985352
Epoch: 24, Steps: 64 | Train Loss: 0.1152453 Vali Loss: 0.2294693 Test Loss: 0.3030664
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 25 cost time: 0.8410072326660156
Epoch: 25, Steps: 64 | Train Loss: 0.1147839 Vali Loss: 0.2270108 Test Loss: 0.3008390
Validation loss decreased (0.229004 --> 0.227011).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 26 cost time: 0.8400003910064697
Epoch: 26, Steps: 64 | Train Loss: 0.1143625 Vali Loss: 0.2258326 Test Loss: 0.3010520
Validation loss decreased (0.227011 --> 0.225833).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 27 cost time: 0.836615800857544
Epoch: 27, Steps: 64 | Train Loss: 0.1131941 Vali Loss: 0.2264911 Test Loss: 0.3001843
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 28 cost time: 0.8443198204040527
Epoch: 28, Steps: 64 | Train Loss: 0.1132595 Vali Loss: 0.2278702 Test Loss: 0.3010910
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 29 cost time: 0.8333470821380615
Epoch: 29, Steps: 64 | Train Loss: 0.1135947 Vali Loss: 0.2262721 Test Loss: 0.3026653
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 30 cost time: 0.8478255271911621
Epoch: 30, Steps: 64 | Train Loss: 0.1121305 Vali Loss: 0.2231959 Test Loss: 0.2995046
Validation loss decreased (0.225833 --> 0.223196).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 31 cost time: 0.8419992923736572
Epoch: 31, Steps: 64 | Train Loss: 0.1128926 Vali Loss: 0.2265979 Test Loss: 0.3013096
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 32 cost time: 0.8446118831634521
Epoch: 32, Steps: 64 | Train Loss: 0.1121618 Vali Loss: 0.2235111 Test Loss: 0.2994966
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 33 cost time: 0.8393301963806152
Epoch: 33, Steps: 64 | Train Loss: 0.1114622 Vali Loss: 0.2270187 Test Loss: 0.3009799
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 34 cost time: 0.8543787002563477
Epoch: 34, Steps: 64 | Train Loss: 0.1114624 Vali Loss: 0.2246513 Test Loss: 0.3006038
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 35 cost time: 0.8417799472808838
Epoch: 35, Steps: 64 | Train Loss: 0.1114474 Vali Loss: 0.2242811 Test Loss: 0.2984766
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 36 cost time: 0.8359999656677246
Epoch: 36, Steps: 64 | Train Loss: 0.1114396 Vali Loss: 0.2226446 Test Loss: 0.2987225
Validation loss decreased (0.223196 --> 0.222645).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 37 cost time: 0.8349289894104004
Epoch: 37, Steps: 64 | Train Loss: 0.1111184 Vali Loss: 0.2242204 Test Loss: 0.2998996
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 38 cost time: 0.8473947048187256
Epoch: 38, Steps: 64 | Train Loss: 0.1118892 Vali Loss: 0.2229612 Test Loss: 0.2992070
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 39 cost time: 0.8362815380096436
Epoch: 39, Steps: 64 | Train Loss: 0.1111844 Vali Loss: 0.2252944 Test Loss: 0.2987943
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 40 cost time: 0.8420000076293945
Epoch: 40, Steps: 64 | Train Loss: 0.1115805 Vali Loss: 0.2225217 Test Loss: 0.2988501
Validation loss decreased (0.222645 --> 0.222522).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 41 cost time: 0.8416244983673096
Epoch: 41, Steps: 64 | Train Loss: 0.1107028 Vali Loss: 0.2237601 Test Loss: 0.3014056
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 42 cost time: 0.857342004776001
Epoch: 42, Steps: 64 | Train Loss: 0.1109432 Vali Loss: 0.2244779 Test Loss: 0.3007666
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 43 cost time: 0.8454015254974365
Epoch: 43, Steps: 64 | Train Loss: 0.1107436 Vali Loss: 0.2200901 Test Loss: 0.3000381
Validation loss decreased (0.222522 --> 0.220090).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 44 cost time: 0.8437807559967041
Epoch: 44, Steps: 64 | Train Loss: 0.1099845 Vali Loss: 0.2242359 Test Loss: 0.2998146
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 45 cost time: 0.8380002975463867
Epoch: 45, Steps: 64 | Train Loss: 0.1096546 Vali Loss: 0.2215717 Test Loss: 0.2986520
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 46 cost time: 0.822622537612915
Epoch: 46, Steps: 64 | Train Loss: 0.1108471 Vali Loss: 0.2233780 Test Loss: 0.2983601
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 47 cost time: 0.8353238105773926
Epoch: 47, Steps: 64 | Train Loss: 0.1102132 Vali Loss: 0.2243017 Test Loss: 0.2989411
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 48 cost time: 0.8217682838439941
Epoch: 48, Steps: 64 | Train Loss: 0.1097972 Vali Loss: 0.2191942 Test Loss: 0.2976743
Validation loss decreased (0.220090 --> 0.219194).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 49 cost time: 0.8390007019042969
Epoch: 49, Steps: 64 | Train Loss: 0.1102271 Vali Loss: 0.2244596 Test Loss: 0.2994778
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 50 cost time: 0.8476128578186035
Epoch: 50, Steps: 64 | Train Loss: 0.1097772 Vali Loss: 0.2232114 Test Loss: 0.2983224
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 51 cost time: 0.8413474559783936
Epoch: 51, Steps: 64 | Train Loss: 0.1102422 Vali Loss: 0.2204982 Test Loss: 0.2990034
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 52 cost time: 0.8484315872192383
Epoch: 52, Steps: 64 | Train Loss: 0.1100991 Vali Loss: 0.2222491 Test Loss: 0.2996926
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 53 cost time: 0.8491594791412354
Epoch: 53, Steps: 64 | Train Loss: 0.1101044 Vali Loss: 0.2207749 Test Loss: 0.2980833
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 54 cost time: 0.8380000591278076
Epoch: 54, Steps: 64 | Train Loss: 0.1106749 Vali Loss: 0.2214837 Test Loss: 0.2986455
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 55 cost time: 0.838630199432373
Epoch: 55, Steps: 64 | Train Loss: 0.1099903 Vali Loss: 0.2244006 Test Loss: 0.3005978
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 56 cost time: 0.8435020446777344
Epoch: 56, Steps: 64 | Train Loss: 0.1107667 Vali Loss: 0.2226461 Test Loss: 0.2996574
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 57 cost time: 0.8453290462493896
Epoch: 57, Steps: 64 | Train Loss: 0.1096876 Vali Loss: 0.2235669 Test Loss: 0.2990833
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 58 cost time: 0.8421127796173096
Epoch: 58, Steps: 64 | Train Loss: 0.1102277 Vali Loss: 0.2206297 Test Loss: 0.2994693
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 59 cost time: 0.8366332054138184
Epoch: 59, Steps: 64 | Train Loss: 0.1096677 Vali Loss: 0.2208160 Test Loss: 0.2993468
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 60 cost time: 0.8373558521270752
Epoch: 60, Steps: 64 | Train Loss: 0.1097822 Vali Loss: 0.2230561 Test Loss: 0.2999373
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2976742386817932, mae:0.361675500869751, rse:0.2504052519798279
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.05057811737060547 GB
Epoch: 1 cost time: 2.2243051528930664
Epoch: 1, Steps: 64 | Train Loss: 0.8299004 Vali Loss: 2.4917438 Test Loss: 4.3253889
Validation loss decreased (inf --> 2.491744).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 2 cost time: 0.870112419128418
Epoch: 2, Steps: 64 | Train Loss: 0.5228720 Vali Loss: 0.8284034 Test Loss: 1.1669817
Validation loss decreased (2.491744 --> 0.828403).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 3 cost time: 0.8703629970550537
Epoch: 3, Steps: 64 | Train Loss: 0.1842799 Vali Loss: 0.3206611 Test Loss: 0.3360826
Validation loss decreased (0.828403 --> 0.320661).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 4 cost time: 0.872607946395874
Epoch: 4, Steps: 64 | Train Loss: 0.1166453 Vali Loss: 0.2519099 Test Loss: 0.3045009
Validation loss decreased (0.320661 --> 0.251910).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 5 cost time: 0.84334397315979
Epoch: 5, Steps: 64 | Train Loss: 0.1055619 Vali Loss: 0.2421021 Test Loss: 0.3035358
Validation loss decreased (0.251910 --> 0.242102).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 6 cost time: 0.8553562164306641
Epoch: 6, Steps: 64 | Train Loss: 0.1007292 Vali Loss: 0.2381591 Test Loss: 0.3015434
Validation loss decreased (0.242102 --> 0.238159).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 7 cost time: 0.8683688640594482
Epoch: 7, Steps: 64 | Train Loss: 0.0962995 Vali Loss: 0.2301112 Test Loss: 0.2982126
Validation loss decreased (0.238159 --> 0.230111).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 8 cost time: 0.8613569736480713
Epoch: 8, Steps: 64 | Train Loss: 0.0947350 Vali Loss: 0.2248086 Test Loss: 0.2975280
Validation loss decreased (0.230111 --> 0.224809).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 9 cost time: 0.8619999885559082
Epoch: 9, Steps: 64 | Train Loss: 0.0921398 Vali Loss: 0.2191948 Test Loss: 0.2961622
Validation loss decreased (0.224809 --> 0.219195).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 10 cost time: 0.8606464862823486
Epoch: 10, Steps: 64 | Train Loss: 0.0906370 Vali Loss: 0.2172732 Test Loss: 0.2954932
Validation loss decreased (0.219195 --> 0.217273).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 11 cost time: 0.8666019439697266
Epoch: 11, Steps: 64 | Train Loss: 0.0893328 Vali Loss: 0.2160070 Test Loss: 0.2943386
Validation loss decreased (0.217273 --> 0.216007).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 12 cost time: 0.8894209861755371
Epoch: 12, Steps: 64 | Train Loss: 0.0878080 Vali Loss: 0.2140789 Test Loss: 0.2937819
Validation loss decreased (0.216007 --> 0.214079).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 13 cost time: 0.8707475662231445
Epoch: 13, Steps: 64 | Train Loss: 0.0871037 Vali Loss: 0.2145604 Test Loss: 0.2950519
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 14 cost time: 0.8709995746612549
Epoch: 14, Steps: 64 | Train Loss: 0.0867391 Vali Loss: 0.2083964 Test Loss: 0.2920997
Validation loss decreased (0.214079 --> 0.208396).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 15 cost time: 0.8626084327697754
Epoch: 15, Steps: 64 | Train Loss: 0.0852396 Vali Loss: 0.2092643 Test Loss: 0.2946259
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 16 cost time: 0.8701646327972412
Epoch: 16, Steps: 64 | Train Loss: 0.0851540 Vali Loss: 0.2092967 Test Loss: 0.2946068
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 17 cost time: 0.8633894920349121
Epoch: 17, Steps: 64 | Train Loss: 0.0845982 Vali Loss: 0.2067670 Test Loss: 0.2934094
Validation loss decreased (0.208396 --> 0.206767).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 18 cost time: 0.8667600154876709
Epoch: 18, Steps: 64 | Train Loss: 0.0843473 Vali Loss: 0.2055660 Test Loss: 0.2925931
Validation loss decreased (0.206767 --> 0.205566).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 19 cost time: 0.876000165939331
Epoch: 19, Steps: 64 | Train Loss: 0.0834401 Vali Loss: 0.2038514 Test Loss: 0.2918802
Validation loss decreased (0.205566 --> 0.203851).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 20 cost time: 0.8716118335723877
Epoch: 20, Steps: 64 | Train Loss: 0.0831516 Vali Loss: 0.2019020 Test Loss: 0.2910472
Validation loss decreased (0.203851 --> 0.201902).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 21 cost time: 0.8674056529998779
Epoch: 21, Steps: 64 | Train Loss: 0.0824009 Vali Loss: 0.2032807 Test Loss: 0.2911371
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 22 cost time: 0.8680932521820068
Epoch: 22, Steps: 64 | Train Loss: 0.0825353 Vali Loss: 0.2046974 Test Loss: 0.2917240
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 23 cost time: 0.8664202690124512
Epoch: 23, Steps: 64 | Train Loss: 0.0820578 Vali Loss: 0.2025680 Test Loss: 0.2914793
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 24 cost time: 0.8918154239654541
Epoch: 24, Steps: 64 | Train Loss: 0.0819428 Vali Loss: 0.2011507 Test Loss: 0.2913652
Validation loss decreased (0.201902 --> 0.201151).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 25 cost time: 0.8599984645843506
Epoch: 25, Steps: 64 | Train Loss: 0.0814098 Vali Loss: 0.2004913 Test Loss: 0.2901661
Validation loss decreased (0.201151 --> 0.200491).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 26 cost time: 0.8596968650817871
Epoch: 26, Steps: 64 | Train Loss: 0.0813099 Vali Loss: 0.2003708 Test Loss: 0.2908175
Validation loss decreased (0.200491 --> 0.200371).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 27 cost time: 0.8503530025482178
Epoch: 27, Steps: 64 | Train Loss: 0.0809145 Vali Loss: 0.2008668 Test Loss: 0.2901527
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 28 cost time: 0.86435866355896
Epoch: 28, Steps: 64 | Train Loss: 0.0810276 Vali Loss: 0.1993219 Test Loss: 0.2908283
Validation loss decreased (0.200371 --> 0.199322).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 29 cost time: 0.8657622337341309
Epoch: 29, Steps: 64 | Train Loss: 0.0812306 Vali Loss: 0.2019562 Test Loss: 0.2901876
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 30 cost time: 0.8830001354217529
Epoch: 30, Steps: 64 | Train Loss: 0.0809926 Vali Loss: 0.1998692 Test Loss: 0.2898294
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 31 cost time: 0.8492448329925537
Epoch: 31, Steps: 64 | Train Loss: 0.0805753 Vali Loss: 0.2005608 Test Loss: 0.2897282
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 32 cost time: 0.8723421096801758
Epoch: 32, Steps: 64 | Train Loss: 0.0804363 Vali Loss: 0.1966590 Test Loss: 0.2900169
Validation loss decreased (0.199322 --> 0.196659).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 33 cost time: 0.8684158325195312
Epoch: 33, Steps: 64 | Train Loss: 0.0810381 Vali Loss: 0.1998362 Test Loss: 0.2896551
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 34 cost time: 0.8717179298400879
Epoch: 34, Steps: 64 | Train Loss: 0.0802451 Vali Loss: 0.1990386 Test Loss: 0.2902203
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 35 cost time: 0.8678121566772461
Epoch: 35, Steps: 64 | Train Loss: 0.0807225 Vali Loss: 0.1952495 Test Loss: 0.2903895
Validation loss decreased (0.196659 --> 0.195249).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 36 cost time: 0.864617109298706
Epoch: 36, Steps: 64 | Train Loss: 0.0804133 Vali Loss: 0.1995163 Test Loss: 0.2893537
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 37 cost time: 0.8593950271606445
Epoch: 37, Steps: 64 | Train Loss: 0.0802288 Vali Loss: 0.1989342 Test Loss: 0.2901962
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 38 cost time: 0.8723800182342529
Epoch: 38, Steps: 64 | Train Loss: 0.0801682 Vali Loss: 0.1977098 Test Loss: 0.2893275
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 39 cost time: 0.8774547576904297
Epoch: 39, Steps: 64 | Train Loss: 0.0798620 Vali Loss: 0.1993610 Test Loss: 0.2891837
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 40 cost time: 0.8654110431671143
Epoch: 40, Steps: 64 | Train Loss: 0.0804420 Vali Loss: 0.1981206 Test Loss: 0.2897260
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 41 cost time: 0.8686280250549316
Epoch: 41, Steps: 64 | Train Loss: 0.0802844 Vali Loss: 0.1990293 Test Loss: 0.2901981
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 42 cost time: 0.8714840412139893
Epoch: 42, Steps: 64 | Train Loss: 0.0798661 Vali Loss: 0.2017333 Test Loss: 0.2900157
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 43 cost time: 0.8767416477203369
Epoch: 43, Steps: 64 | Train Loss: 0.0797435 Vali Loss: 0.1977851 Test Loss: 0.2892223
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 44 cost time: 0.8647387027740479
Epoch: 44, Steps: 64 | Train Loss: 0.0799780 Vali Loss: 0.2009042 Test Loss: 0.2898223
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 45 cost time: 0.8686273097991943
Epoch: 45, Steps: 64 | Train Loss: 0.0799923 Vali Loss: 0.1985882 Test Loss: 0.2892964
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 46 cost time: 0.8694498538970947
Epoch: 46, Steps: 64 | Train Loss: 0.0800387 Vali Loss: 0.1985780 Test Loss: 0.2889028
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 47 cost time: 0.8645071983337402
Epoch: 47, Steps: 64 | Train Loss: 0.0796798 Vali Loss: 0.2000025 Test Loss: 0.2898229
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 48 cost time: 0.8653984069824219
Epoch: 48, Steps: 64 | Train Loss: 0.0797571 Vali Loss: 0.1989043 Test Loss: 0.2894617
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 49 cost time: 0.8537647724151611
Epoch: 49, Steps: 64 | Train Loss: 0.0797550 Vali Loss: 0.1946161 Test Loss: 0.2890182
Validation loss decreased (0.195249 --> 0.194616).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 50 cost time: 0.8659999370574951
Epoch: 50, Steps: 64 | Train Loss: 0.0800390 Vali Loss: 0.1976555 Test Loss: 0.2889822
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 51 cost time: 0.8666260242462158
Epoch: 51, Steps: 64 | Train Loss: 0.0798527 Vali Loss: 0.1993462 Test Loss: 0.2896673
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 52 cost time: 0.8683927059173584
Epoch: 52, Steps: 64 | Train Loss: 0.0796380 Vali Loss: 0.2000090 Test Loss: 0.2890052
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 53 cost time: 0.8663411140441895
Epoch: 53, Steps: 64 | Train Loss: 0.0797062 Vali Loss: 0.1981217 Test Loss: 0.2888190
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 54 cost time: 0.8657588958740234
Epoch: 54, Steps: 64 | Train Loss: 0.0797349 Vali Loss: 0.1985693 Test Loss: 0.2888074
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 55 cost time: 0.8640012741088867
Epoch: 55, Steps: 64 | Train Loss: 0.0794825 Vali Loss: 0.1988257 Test Loss: 0.2892280
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 56 cost time: 0.872664213180542
Epoch: 56, Steps: 64 | Train Loss: 0.0791669 Vali Loss: 0.1961735 Test Loss: 0.2894538
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 57 cost time: 0.8692526817321777
Epoch: 57, Steps: 64 | Train Loss: 0.0797613 Vali Loss: 0.1992978 Test Loss: 0.2889476
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 58 cost time: 0.871058464050293
Epoch: 58, Steps: 64 | Train Loss: 0.0794369 Vali Loss: 0.1937049 Test Loss: 0.2892234
Validation loss decreased (0.194616 --> 0.193705).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 59 cost time: 0.8673546314239502
Epoch: 59, Steps: 64 | Train Loss: 0.0792099 Vali Loss: 0.1977101 Test Loss: 0.2889972
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 60 cost time: 0.8807907104492188
Epoch: 60, Steps: 64 | Train Loss: 0.0796288 Vali Loss: 0.1988953 Test Loss: 0.2898529
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.28922343254089355, mae:0.3516349196434021, rse:0.2468252182006836
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05169820785522461 GB
Epoch: 1 cost time: 2.3577497005462646
Epoch: 1, Steps: 64 | Train Loss: 0.8650106 Vali Loss: 2.6628642 Test Loss: 4.7165275
Validation loss decreased (inf --> 2.662864).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 2 cost time: 0.9701189994812012
Epoch: 2, Steps: 64 | Train Loss: 0.5917818 Vali Loss: 1.0629089 Test Loss: 1.6300132
Validation loss decreased (2.662864 --> 1.062909).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 3 cost time: 0.9832758903503418
Epoch: 3, Steps: 64 | Train Loss: 0.2091675 Vali Loss: 0.3374873 Test Loss: 0.3521955
Validation loss decreased (1.062909 --> 0.337487).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 4 cost time: 0.9600844383239746
Epoch: 4, Steps: 64 | Train Loss: 0.1147214 Vali Loss: 0.2690851 Test Loss: 0.3194343
Validation loss decreased (0.337487 --> 0.269085).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 5 cost time: 0.9493470191955566
Epoch: 5, Steps: 64 | Train Loss: 0.1016375 Vali Loss: 0.2487840 Test Loss: 0.3045065
Validation loss decreased (0.269085 --> 0.248784).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 6 cost time: 0.9648878574371338
Epoch: 6, Steps: 64 | Train Loss: 0.0963353 Vali Loss: 0.2386022 Test Loss: 0.3029333
Validation loss decreased (0.248784 --> 0.238602).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 7 cost time: 0.9587829113006592
Epoch: 7, Steps: 64 | Train Loss: 0.0925521 Vali Loss: 0.2333762 Test Loss: 0.2993806
Validation loss decreased (0.238602 --> 0.233376).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 8 cost time: 0.9750268459320068
Epoch: 8, Steps: 64 | Train Loss: 0.0902432 Vali Loss: 0.2290075 Test Loss: 0.2974954
Validation loss decreased (0.233376 --> 0.229008).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 9 cost time: 0.9647996425628662
Epoch: 9, Steps: 64 | Train Loss: 0.0875440 Vali Loss: 0.2212233 Test Loss: 0.2962634
Validation loss decreased (0.229008 --> 0.221223).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 10 cost time: 0.9849998950958252
Epoch: 10, Steps: 64 | Train Loss: 0.0863006 Vali Loss: 0.2212162 Test Loss: 0.2971843
Validation loss decreased (0.221223 --> 0.221216).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 11 cost time: 0.9850001335144043
Epoch: 11, Steps: 64 | Train Loss: 0.0849065 Vali Loss: 0.2186490 Test Loss: 0.2945465
Validation loss decreased (0.221216 --> 0.218649).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 12 cost time: 0.9755978584289551
Epoch: 12, Steps: 64 | Train Loss: 0.0836677 Vali Loss: 0.2138721 Test Loss: 0.2944401
Validation loss decreased (0.218649 --> 0.213872).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 13 cost time: 0.9832441806793213
Epoch: 13, Steps: 64 | Train Loss: 0.0828679 Vali Loss: 0.2121916 Test Loss: 0.2940311
Validation loss decreased (0.213872 --> 0.212192).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 14 cost time: 0.9704346656799316
Epoch: 14, Steps: 64 | Train Loss: 0.0819227 Vali Loss: 0.2101249 Test Loss: 0.2935716
Validation loss decreased (0.212192 --> 0.210125).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 15 cost time: 0.9713773727416992
Epoch: 15, Steps: 64 | Train Loss: 0.0822078 Vali Loss: 0.2113038 Test Loss: 0.2936257
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 16 cost time: 0.9664225578308105
Epoch: 16, Steps: 64 | Train Loss: 0.0811906 Vali Loss: 0.2061857 Test Loss: 0.2932466
Validation loss decreased (0.210125 --> 0.206186).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 17 cost time: 0.9800314903259277
Epoch: 17, Steps: 64 | Train Loss: 0.0800787 Vali Loss: 0.2006500 Test Loss: 0.2910411
Validation loss decreased (0.206186 --> 0.200650).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 18 cost time: 0.9703950881958008
Epoch: 18, Steps: 64 | Train Loss: 0.0801466 Vali Loss: 0.2033240 Test Loss: 0.2908015
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 19 cost time: 0.9688153266906738
Epoch: 19, Steps: 64 | Train Loss: 0.0792788 Vali Loss: 0.2027198 Test Loss: 0.2915932
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 20 cost time: 0.9682600498199463
Epoch: 20, Steps: 64 | Train Loss: 0.0789255 Vali Loss: 0.2009746 Test Loss: 0.2908566
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 21 cost time: 0.9850003719329834
Epoch: 21, Steps: 64 | Train Loss: 0.0788299 Vali Loss: 0.1982983 Test Loss: 0.2901595
Validation loss decreased (0.200650 --> 0.198298).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 22 cost time: 0.9543287754058838
Epoch: 22, Steps: 64 | Train Loss: 0.0784405 Vali Loss: 0.2019130 Test Loss: 0.2905903
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 23 cost time: 0.9533360004425049
Epoch: 23, Steps: 64 | Train Loss: 0.0780884 Vali Loss: 0.1989277 Test Loss: 0.2885734
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 24 cost time: 0.9854230880737305
Epoch: 24, Steps: 64 | Train Loss: 0.0780032 Vali Loss: 0.1985897 Test Loss: 0.2890917
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 25 cost time: 0.9783957004547119
Epoch: 25, Steps: 64 | Train Loss: 0.0777859 Vali Loss: 0.1976728 Test Loss: 0.2892017
Validation loss decreased (0.198298 --> 0.197673).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 26 cost time: 0.9854440689086914
Epoch: 26, Steps: 64 | Train Loss: 0.0773511 Vali Loss: 0.1977115 Test Loss: 0.2882251
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 27 cost time: 0.9604537487030029
Epoch: 27, Steps: 64 | Train Loss: 0.0775301 Vali Loss: 0.1967691 Test Loss: 0.2888457
Validation loss decreased (0.197673 --> 0.196769).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 28 cost time: 0.9866061210632324
Epoch: 28, Steps: 64 | Train Loss: 0.0775355 Vali Loss: 0.1952371 Test Loss: 0.2887252
Validation loss decreased (0.196769 --> 0.195237).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 29 cost time: 0.984168529510498
Epoch: 29, Steps: 64 | Train Loss: 0.0774564 Vali Loss: 0.1991476 Test Loss: 0.2886222
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 30 cost time: 0.99778151512146
Epoch: 30, Steps: 64 | Train Loss: 0.0773194 Vali Loss: 0.1980189 Test Loss: 0.2889026
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 31 cost time: 0.980602502822876
Epoch: 31, Steps: 64 | Train Loss: 0.0766764 Vali Loss: 0.1958489 Test Loss: 0.2880569
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 32 cost time: 0.991051197052002
Epoch: 32, Steps: 64 | Train Loss: 0.0771098 Vali Loss: 0.1966794 Test Loss: 0.2887750
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 33 cost time: 0.9936168193817139
Epoch: 33, Steps: 64 | Train Loss: 0.0764177 Vali Loss: 0.1956727 Test Loss: 0.2887472
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 34 cost time: 0.9905810356140137
Epoch: 34, Steps: 64 | Train Loss: 0.0765534 Vali Loss: 0.1906649 Test Loss: 0.2882047
Validation loss decreased (0.195237 --> 0.190665).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 35 cost time: 0.989020586013794
Epoch: 35, Steps: 64 | Train Loss: 0.0766077 Vali Loss: 0.1942607 Test Loss: 0.2885374
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 36 cost time: 0.989109992980957
Epoch: 36, Steps: 64 | Train Loss: 0.0768848 Vali Loss: 0.1957441 Test Loss: 0.2872580
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 37 cost time: 0.9854047298431396
Epoch: 37, Steps: 64 | Train Loss: 0.0764236 Vali Loss: 0.1945502 Test Loss: 0.2875189
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 38 cost time: 0.9874148368835449
Epoch: 38, Steps: 64 | Train Loss: 0.0762540 Vali Loss: 0.1919580 Test Loss: 0.2877634
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 39 cost time: 0.9913403987884521
Epoch: 39, Steps: 64 | Train Loss: 0.0761100 Vali Loss: 0.1949102 Test Loss: 0.2876818
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 40 cost time: 0.9757344722747803
Epoch: 40, Steps: 64 | Train Loss: 0.0760034 Vali Loss: 0.1959175 Test Loss: 0.2873043
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 41 cost time: 0.9746983051300049
Epoch: 41, Steps: 64 | Train Loss: 0.0766154 Vali Loss: 0.1944635 Test Loss: 0.2879353
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 42 cost time: 0.9749996662139893
Epoch: 42, Steps: 64 | Train Loss: 0.0758659 Vali Loss: 0.1932076 Test Loss: 0.2875697
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 43 cost time: 0.979600191116333
Epoch: 43, Steps: 64 | Train Loss: 0.0759373 Vali Loss: 0.1949895 Test Loss: 0.2860513
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 44 cost time: 0.9824264049530029
Epoch: 44, Steps: 64 | Train Loss: 0.0766472 Vali Loss: 0.1953297 Test Loss: 0.2872310
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 45 cost time: 0.9793636798858643
Epoch: 45, Steps: 64 | Train Loss: 0.0764020 Vali Loss: 0.1951140 Test Loss: 0.2873866
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 46 cost time: 0.9905142784118652
Epoch: 46, Steps: 64 | Train Loss: 0.0757550 Vali Loss: 0.1955953 Test Loss: 0.2874476
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 47 cost time: 0.9615795612335205
Epoch: 47, Steps: 64 | Train Loss: 0.0760129 Vali Loss: 0.1946331 Test Loss: 0.2877950
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 48 cost time: 0.9623968601226807
Epoch: 48, Steps: 64 | Train Loss: 0.0761359 Vali Loss: 0.1942867 Test Loss: 0.2874549
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 49 cost time: 0.9630446434020996
Epoch: 49, Steps: 64 | Train Loss: 0.0756354 Vali Loss: 0.1989216 Test Loss: 0.2873029
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 50 cost time: 0.9761154651641846
Epoch: 50, Steps: 64 | Train Loss: 0.0760029 Vali Loss: 0.1947972 Test Loss: 0.2873133
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 51 cost time: 0.9694869518280029
Epoch: 51, Steps: 64 | Train Loss: 0.0760423 Vali Loss: 0.1949176 Test Loss: 0.2878712
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 52 cost time: 0.9649996757507324
Epoch: 52, Steps: 64 | Train Loss: 0.0762549 Vali Loss: 0.1945154 Test Loss: 0.2868899
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 53 cost time: 0.9766266345977783
Epoch: 53, Steps: 64 | Train Loss: 0.0758268 Vali Loss: 0.1963027 Test Loss: 0.2878334
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 54 cost time: 0.9711818695068359
Epoch: 54, Steps: 64 | Train Loss: 0.0761643 Vali Loss: 0.1939824 Test Loss: 0.2865008
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 55 cost time: 0.9633889198303223
Epoch: 55, Steps: 64 | Train Loss: 0.0760063 Vali Loss: 0.1933155 Test Loss: 0.2864419
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 56 cost time: 0.9729390144348145
Epoch: 56, Steps: 64 | Train Loss: 0.0760983 Vali Loss: 0.1945750 Test Loss: 0.2868695
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 57 cost time: 0.9368417263031006
Epoch: 57, Steps: 64 | Train Loss: 0.0760845 Vali Loss: 0.1959444 Test Loss: 0.2872511
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 58 cost time: 0.9714095592498779
Epoch: 58, Steps: 64 | Train Loss: 0.0759911 Vali Loss: 0.1936237 Test Loss: 0.2881264
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 59 cost time: 0.9628264904022217
Epoch: 59, Steps: 64 | Train Loss: 0.0761467 Vali Loss: 0.1938169 Test Loss: 0.2861603
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 60 cost time: 0.9685213565826416
Epoch: 60, Steps: 64 | Train Loss: 0.0757893 Vali Loss: 0.1945388 Test Loss: 0.2868243
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2882046401500702, mae:0.35210853815078735, rse:0.24639013409614563
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.049307823181152344 GB
Epoch: 1 cost time: 2.3116941452026367
Epoch: 1, Steps: 64 | Train Loss: 1.0321856 Vali Loss: 2.7793949 Test Loss: 4.8385096
Validation loss decreased (inf --> 2.779395).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 2 cost time: 0.9166300296783447
Epoch: 2, Steps: 64 | Train Loss: 0.6980656 Vali Loss: 1.1356757 Test Loss: 1.7620850
Validation loss decreased (2.779395 --> 1.135676).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 3 cost time: 0.9254536628723145
Epoch: 3, Steps: 64 | Train Loss: 0.3614584 Vali Loss: 0.5835896 Test Loss: 0.7417066
Validation loss decreased (1.135676 --> 0.583590).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 4 cost time: 0.9163656234741211
Epoch: 4, Steps: 64 | Train Loss: 0.2175991 Vali Loss: 0.4083436 Test Loss: 0.4345458
Validation loss decreased (0.583590 --> 0.408344).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 5 cost time: 0.9205043315887451
Epoch: 5, Steps: 64 | Train Loss: 0.1709349 Vali Loss: 0.3490526 Test Loss: 0.3681718
Validation loss decreased (0.408344 --> 0.349053).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 6 cost time: 0.9110686779022217
Epoch: 6, Steps: 64 | Train Loss: 0.1517877 Vali Loss: 0.3093751 Test Loss: 0.3397173
Validation loss decreased (0.349053 --> 0.309375).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 7 cost time: 0.9058723449707031
Epoch: 7, Steps: 64 | Train Loss: 0.1419910 Vali Loss: 0.2839095 Test Loss: 0.3239663
Validation loss decreased (0.309375 --> 0.283909).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 8 cost time: 0.9190008640289307
Epoch: 8, Steps: 64 | Train Loss: 0.1327025 Vali Loss: 0.2687719 Test Loss: 0.3118420
Validation loss decreased (0.283909 --> 0.268772).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 9 cost time: 0.9076249599456787
Epoch: 9, Steps: 64 | Train Loss: 0.1289776 Vali Loss: 0.2586030 Test Loss: 0.3060891
Validation loss decreased (0.268772 --> 0.258603).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 10 cost time: 0.9267909526824951
Epoch: 10, Steps: 64 | Train Loss: 0.1252382 Vali Loss: 0.2548325 Test Loss: 0.3030972
Validation loss decreased (0.258603 --> 0.254832).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 11 cost time: 0.9213719367980957
Epoch: 11, Steps: 64 | Train Loss: 0.1214509 Vali Loss: 0.2507151 Test Loss: 0.3000838
Validation loss decreased (0.254832 --> 0.250715).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 12 cost time: 0.9204521179199219
Epoch: 12, Steps: 64 | Train Loss: 0.1189033 Vali Loss: 0.2485887 Test Loss: 0.2964107
Validation loss decreased (0.250715 --> 0.248589).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 13 cost time: 0.9530167579650879
Epoch: 13, Steps: 64 | Train Loss: 0.1170173 Vali Loss: 0.2458334 Test Loss: 0.2964832
Validation loss decreased (0.248589 --> 0.245833).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 14 cost time: 0.9348371028900146
Epoch: 14, Steps: 64 | Train Loss: 0.1140917 Vali Loss: 0.2399837 Test Loss: 0.2945823
Validation loss decreased (0.245833 --> 0.239984).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 15 cost time: 0.9182620048522949
Epoch: 15, Steps: 64 | Train Loss: 0.1135423 Vali Loss: 0.2393726 Test Loss: 0.2946649
Validation loss decreased (0.239984 --> 0.239373).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 16 cost time: 0.9233145713806152
Epoch: 16, Steps: 64 | Train Loss: 0.1117254 Vali Loss: 0.2405922 Test Loss: 0.2930920
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 17 cost time: 0.9334287643432617
Epoch: 17, Steps: 64 | Train Loss: 0.1107290 Vali Loss: 0.2414060 Test Loss: 0.2928989
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 18 cost time: 0.9185342788696289
Epoch: 18, Steps: 64 | Train Loss: 0.1095674 Vali Loss: 0.2373709 Test Loss: 0.2924813
Validation loss decreased (0.239373 --> 0.237371).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 19 cost time: 0.9370827674865723
Epoch: 19, Steps: 64 | Train Loss: 0.1095392 Vali Loss: 0.2339335 Test Loss: 0.2917424
Validation loss decreased (0.237371 --> 0.233934).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 20 cost time: 0.9284918308258057
Epoch: 20, Steps: 64 | Train Loss: 0.1079071 Vali Loss: 0.2355891 Test Loss: 0.2919397
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 21 cost time: 0.9161384105682373
Epoch: 21, Steps: 64 | Train Loss: 0.1078101 Vali Loss: 0.2323746 Test Loss: 0.2910759
Validation loss decreased (0.233934 --> 0.232375).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 22 cost time: 0.911623477935791
Epoch: 22, Steps: 64 | Train Loss: 0.1063740 Vali Loss: 0.2339888 Test Loss: 0.2906340
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 23 cost time: 0.916724443435669
Epoch: 23, Steps: 64 | Train Loss: 0.1054894 Vali Loss: 0.2328020 Test Loss: 0.2918226
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 24 cost time: 0.9135932922363281
Epoch: 24, Steps: 64 | Train Loss: 0.1059066 Vali Loss: 0.2322541 Test Loss: 0.2914677
Validation loss decreased (0.232375 --> 0.232254).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 25 cost time: 0.8883767127990723
Epoch: 25, Steps: 64 | Train Loss: 0.1054894 Vali Loss: 0.2304628 Test Loss: 0.2903553
Validation loss decreased (0.232254 --> 0.230463).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 26 cost time: 0.9134845733642578
Epoch: 26, Steps: 64 | Train Loss: 0.1053090 Vali Loss: 0.2291290 Test Loss: 0.2910909
Validation loss decreased (0.230463 --> 0.229129).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 27 cost time: 0.9143855571746826
Epoch: 27, Steps: 64 | Train Loss: 0.1044063 Vali Loss: 0.2296215 Test Loss: 0.2893821
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 28 cost time: 0.9209504127502441
Epoch: 28, Steps: 64 | Train Loss: 0.1043132 Vali Loss: 0.2325514 Test Loss: 0.2914245
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 29 cost time: 0.9240000247955322
Epoch: 29, Steps: 64 | Train Loss: 0.1039891 Vali Loss: 0.2276741 Test Loss: 0.2880566
Validation loss decreased (0.229129 --> 0.227674).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 30 cost time: 0.9196267127990723
Epoch: 30, Steps: 64 | Train Loss: 0.1037993 Vali Loss: 0.2257374 Test Loss: 0.2890520
Validation loss decreased (0.227674 --> 0.225737).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 31 cost time: 0.9324290752410889
Epoch: 31, Steps: 64 | Train Loss: 0.1034458 Vali Loss: 0.2263222 Test Loss: 0.2879237
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 32 cost time: 0.9184989929199219
Epoch: 32, Steps: 64 | Train Loss: 0.1030567 Vali Loss: 0.2285591 Test Loss: 0.2892062
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 33 cost time: 0.9224288463592529
Epoch: 33, Steps: 64 | Train Loss: 0.1032705 Vali Loss: 0.2272552 Test Loss: 0.2888007
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 34 cost time: 0.9174036979675293
Epoch: 34, Steps: 64 | Train Loss: 0.1024168 Vali Loss: 0.2303485 Test Loss: 0.2894733
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 35 cost time: 0.9284694194793701
Epoch: 35, Steps: 64 | Train Loss: 0.1024320 Vali Loss: 0.2265513 Test Loss: 0.2880342
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 36 cost time: 0.9139785766601562
Epoch: 36, Steps: 64 | Train Loss: 0.1025207 Vali Loss: 0.2276170 Test Loss: 0.2882127
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 37 cost time: 0.9166314601898193
Epoch: 37, Steps: 64 | Train Loss: 0.1025398 Vali Loss: 0.2260576 Test Loss: 0.2879255
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 38 cost time: 0.9324951171875
Epoch: 38, Steps: 64 | Train Loss: 0.1022562 Vali Loss: 0.2263660 Test Loss: 0.2885802
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 39 cost time: 0.9243931770324707
Epoch: 39, Steps: 64 | Train Loss: 0.1018853 Vali Loss: 0.2278108 Test Loss: 0.2881828
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 40 cost time: 0.918400764465332
Epoch: 40, Steps: 64 | Train Loss: 0.1020552 Vali Loss: 0.2286843 Test Loss: 0.2884091
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 41 cost time: 0.914818525314331
Epoch: 41, Steps: 64 | Train Loss: 0.1025313 Vali Loss: 0.2275805 Test Loss: 0.2882907
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 42 cost time: 0.8877513408660889
Epoch: 42, Steps: 64 | Train Loss: 0.1021572 Vali Loss: 0.2272251 Test Loss: 0.2886258
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 43 cost time: 0.9069995880126953
Epoch: 43, Steps: 64 | Train Loss: 0.1013621 Vali Loss: 0.2273181 Test Loss: 0.2878379
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 44 cost time: 0.9046471118927002
Epoch: 44, Steps: 64 | Train Loss: 0.1020757 Vali Loss: 0.2273956 Test Loss: 0.2884765
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 45 cost time: 0.9142417907714844
Epoch: 45, Steps: 64 | Train Loss: 0.1014304 Vali Loss: 0.2262615 Test Loss: 0.2876855
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 46 cost time: 0.9211423397064209
Epoch: 46, Steps: 64 | Train Loss: 0.1013138 Vali Loss: 0.2272251 Test Loss: 0.2872712
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 47 cost time: 0.9183948040008545
Epoch: 47, Steps: 64 | Train Loss: 0.1012811 Vali Loss: 0.2248420 Test Loss: 0.2883725
Validation loss decreased (0.225737 --> 0.224842).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 48 cost time: 0.9188930988311768
Epoch: 48, Steps: 64 | Train Loss: 0.1011551 Vali Loss: 0.2257442 Test Loss: 0.2887174
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 49 cost time: 0.9239997863769531
Epoch: 49, Steps: 64 | Train Loss: 0.1014717 Vali Loss: 0.2267864 Test Loss: 0.2889516
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 50 cost time: 0.9179999828338623
Epoch: 50, Steps: 64 | Train Loss: 0.1011069 Vali Loss: 0.2252196 Test Loss: 0.2867848
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 51 cost time: 0.9166288375854492
Epoch: 51, Steps: 64 | Train Loss: 0.1006985 Vali Loss: 0.2284371 Test Loss: 0.2876523
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 52 cost time: 0.9273879528045654
Epoch: 52, Steps: 64 | Train Loss: 0.1011770 Vali Loss: 0.2265756 Test Loss: 0.2873546
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 53 cost time: 0.921090841293335
Epoch: 53, Steps: 64 | Train Loss: 0.1015219 Vali Loss: 0.2276203 Test Loss: 0.2869617
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 54 cost time: 0.9133255481719971
Epoch: 54, Steps: 64 | Train Loss: 0.1017121 Vali Loss: 0.2245336 Test Loss: 0.2869318
Validation loss decreased (0.224842 --> 0.224534).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 55 cost time: 0.9274191856384277
Epoch: 55, Steps: 64 | Train Loss: 0.1009438 Vali Loss: 0.2261341 Test Loss: 0.2872333
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 56 cost time: 0.9329993724822998
Epoch: 56, Steps: 64 | Train Loss: 0.1008581 Vali Loss: 0.2252854 Test Loss: 0.2876720
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 57 cost time: 0.9189996719360352
Epoch: 57, Steps: 64 | Train Loss: 0.1023832 Vali Loss: 0.2280226 Test Loss: 0.2884900
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 58 cost time: 0.9196279048919678
Epoch: 58, Steps: 64 | Train Loss: 0.1005944 Vali Loss: 0.2252681 Test Loss: 0.2878636
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 59 cost time: 0.9262301921844482
Epoch: 59, Steps: 64 | Train Loss: 0.1008920 Vali Loss: 0.2259897 Test Loss: 0.2876353
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 60 cost time: 0.918433666229248
Epoch: 60, Steps: 64 | Train Loss: 0.1009958 Vali Loss: 0.2247774 Test Loss: 0.2875071
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.28693169355392456, mae:0.345115602016449, rse:0.24584537744522095
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05073976516723633 GB
Epoch: 1 cost time: 2.311432123184204
Epoch: 1, Steps: 64 | Train Loss: 0.9082174 Vali Loss: 2.6896322 Test Loss: 4.7314863
Validation loss decreased (inf --> 2.689632).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 2 cost time: 0.944920539855957
Epoch: 2, Steps: 64 | Train Loss: 0.5255393 Vali Loss: 0.6941642 Test Loss: 0.9736666
Validation loss decreased (2.689632 --> 0.694164).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 3 cost time: 0.9419925212860107
Epoch: 3, Steps: 64 | Train Loss: 0.1762527 Vali Loss: 0.3432450 Test Loss: 0.3394091
Validation loss decreased (0.694164 --> 0.343245).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 4 cost time: 0.9477908611297607
Epoch: 4, Steps: 64 | Train Loss: 0.1195690 Vali Loss: 0.2697056 Test Loss: 0.3019890
Validation loss decreased (0.343245 --> 0.269706).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 5 cost time: 0.9476194381713867
Epoch: 5, Steps: 64 | Train Loss: 0.1086005 Vali Loss: 0.2507539 Test Loss: 0.2957430
Validation loss decreased (0.269706 --> 0.250754).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 6 cost time: 0.9584231376647949
Epoch: 6, Steps: 64 | Train Loss: 0.1022556 Vali Loss: 0.2383819 Test Loss: 0.2896302
Validation loss decreased (0.250754 --> 0.238382).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 7 cost time: 0.9483628273010254
Epoch: 7, Steps: 64 | Train Loss: 0.0976755 Vali Loss: 0.2334706 Test Loss: 0.2882922
Validation loss decreased (0.238382 --> 0.233471).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 8 cost time: 0.9483680725097656
Epoch: 8, Steps: 64 | Train Loss: 0.0952182 Vali Loss: 0.2280764 Test Loss: 0.2857373
Validation loss decreased (0.233471 --> 0.228076).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 9 cost time: 0.9515268802642822
Epoch: 9, Steps: 64 | Train Loss: 0.0925324 Vali Loss: 0.2228723 Test Loss: 0.2805611
Validation loss decreased (0.228076 --> 0.222872).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 10 cost time: 0.9413599967956543
Epoch: 10, Steps: 64 | Train Loss: 0.0914960 Vali Loss: 0.2238921 Test Loss: 0.2835795
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 11 cost time: 0.9437916278839111
Epoch: 11, Steps: 64 | Train Loss: 0.0894062 Vali Loss: 0.2196400 Test Loss: 0.2833012
Validation loss decreased (0.222872 --> 0.219640).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 12 cost time: 0.9437210559844971
Epoch: 12, Steps: 64 | Train Loss: 0.0879315 Vali Loss: 0.2143201 Test Loss: 0.2801984
Validation loss decreased (0.219640 --> 0.214320).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 13 cost time: 0.9556219577789307
Epoch: 13, Steps: 64 | Train Loss: 0.0871506 Vali Loss: 0.2150371 Test Loss: 0.2793858
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 14 cost time: 0.9386160373687744
Epoch: 14, Steps: 64 | Train Loss: 0.0859386 Vali Loss: 0.2152048 Test Loss: 0.2807698
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 15 cost time: 0.9413547515869141
Epoch: 15, Steps: 64 | Train Loss: 0.0850298 Vali Loss: 0.2118337 Test Loss: 0.2815582
Validation loss decreased (0.214320 --> 0.211834).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 16 cost time: 0.9505329132080078
Epoch: 16, Steps: 64 | Train Loss: 0.0847286 Vali Loss: 0.2087422 Test Loss: 0.2795412
Validation loss decreased (0.211834 --> 0.208742).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 17 cost time: 0.9371135234832764
Epoch: 17, Steps: 64 | Train Loss: 0.0837887 Vali Loss: 0.2094934 Test Loss: 0.2774970
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 18 cost time: 0.938232421875
Epoch: 18, Steps: 64 | Train Loss: 0.0834602 Vali Loss: 0.2088662 Test Loss: 0.2787426
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 19 cost time: 0.9377481937408447
Epoch: 19, Steps: 64 | Train Loss: 0.0830114 Vali Loss: 0.2076162 Test Loss: 0.2767690
Validation loss decreased (0.208742 --> 0.207616).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 20 cost time: 0.9398288726806641
Epoch: 20, Steps: 64 | Train Loss: 0.0826629 Vali Loss: 0.2007107 Test Loss: 0.2778419
Validation loss decreased (0.207616 --> 0.200711).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 21 cost time: 0.9435298442840576
Epoch: 21, Steps: 64 | Train Loss: 0.0818751 Vali Loss: 0.2032525 Test Loss: 0.2796646
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 22 cost time: 0.9446210861206055
Epoch: 22, Steps: 64 | Train Loss: 0.0817714 Vali Loss: 0.2042580 Test Loss: 0.2762650
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 23 cost time: 0.9373772144317627
Epoch: 23, Steps: 64 | Train Loss: 0.0817411 Vali Loss: 0.2039433 Test Loss: 0.2768670
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 24 cost time: 0.9374208450317383
Epoch: 24, Steps: 64 | Train Loss: 0.0813701 Vali Loss: 0.2040337 Test Loss: 0.2761468
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 25 cost time: 0.9400274753570557
Epoch: 25, Steps: 64 | Train Loss: 0.0808834 Vali Loss: 0.2019088 Test Loss: 0.2749117
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 26 cost time: 0.9383490085601807
Epoch: 26, Steps: 64 | Train Loss: 0.0805133 Vali Loss: 0.2025521 Test Loss: 0.2758229
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 27 cost time: 0.9288859367370605
Epoch: 27, Steps: 64 | Train Loss: 0.0801833 Vali Loss: 0.2022841 Test Loss: 0.2746496
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 28 cost time: 0.9428067207336426
Epoch: 28, Steps: 64 | Train Loss: 0.0802065 Vali Loss: 0.2021285 Test Loss: 0.2743168
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 29 cost time: 0.9372291564941406
Epoch: 29, Steps: 64 | Train Loss: 0.0797886 Vali Loss: 0.2000014 Test Loss: 0.2744192
Validation loss decreased (0.200711 --> 0.200001).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 30 cost time: 0.9496183395385742
Epoch: 30, Steps: 64 | Train Loss: 0.0799969 Vali Loss: 0.1999159 Test Loss: 0.2747092
Validation loss decreased (0.200001 --> 0.199916).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 31 cost time: 0.9433975219726562
Epoch: 31, Steps: 64 | Train Loss: 0.0796248 Vali Loss: 0.1989236 Test Loss: 0.2740744
Validation loss decreased (0.199916 --> 0.198924).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 32 cost time: 0.9343559741973877
Epoch: 32, Steps: 64 | Train Loss: 0.0795397 Vali Loss: 0.2006527 Test Loss: 0.2744102
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 33 cost time: 0.9463696479797363
Epoch: 33, Steps: 64 | Train Loss: 0.0793344 Vali Loss: 0.1997591 Test Loss: 0.2737483
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 34 cost time: 0.9329953193664551
Epoch: 34, Steps: 64 | Train Loss: 0.0792502 Vali Loss: 0.2034023 Test Loss: 0.2741947
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 35 cost time: 0.9377658367156982
Epoch: 35, Steps: 64 | Train Loss: 0.0786456 Vali Loss: 0.1978376 Test Loss: 0.2717219
Validation loss decreased (0.198924 --> 0.197838).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 36 cost time: 0.9387226104736328
Epoch: 36, Steps: 64 | Train Loss: 0.0790010 Vali Loss: 0.1980489 Test Loss: 0.2742493
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 37 cost time: 0.9519999027252197
Epoch: 37, Steps: 64 | Train Loss: 0.0789577 Vali Loss: 0.1981495 Test Loss: 0.2732809
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 38 cost time: 0.9390184879302979
Epoch: 38, Steps: 64 | Train Loss: 0.0792750 Vali Loss: 0.1968540 Test Loss: 0.2729794
Validation loss decreased (0.197838 --> 0.196854).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 39 cost time: 0.9379639625549316
Epoch: 39, Steps: 64 | Train Loss: 0.0793755 Vali Loss: 0.1983935 Test Loss: 0.2722769
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 40 cost time: 0.948214054107666
Epoch: 40, Steps: 64 | Train Loss: 0.0788635 Vali Loss: 0.1980660 Test Loss: 0.2728902
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 41 cost time: 0.9343531131744385
Epoch: 41, Steps: 64 | Train Loss: 0.0790778 Vali Loss: 0.1982589 Test Loss: 0.2728497
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 42 cost time: 0.9363851547241211
Epoch: 42, Steps: 64 | Train Loss: 0.0782775 Vali Loss: 0.2002720 Test Loss: 0.2723920
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 43 cost time: 0.9392626285552979
Epoch: 43, Steps: 64 | Train Loss: 0.0787906 Vali Loss: 0.1965825 Test Loss: 0.2726549
Validation loss decreased (0.196854 --> 0.196582).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 44 cost time: 0.944000244140625
Epoch: 44, Steps: 64 | Train Loss: 0.0787378 Vali Loss: 0.1976667 Test Loss: 0.2740646
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 45 cost time: 0.9489986896514893
Epoch: 45, Steps: 64 | Train Loss: 0.0786851 Vali Loss: 0.1980254 Test Loss: 0.2736936
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 46 cost time: 0.9486520290374756
Epoch: 46, Steps: 64 | Train Loss: 0.0785494 Vali Loss: 0.1989387 Test Loss: 0.2730241
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 47 cost time: 0.9589483737945557
Epoch: 47, Steps: 64 | Train Loss: 0.0785451 Vali Loss: 0.1999097 Test Loss: 0.2721798
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 48 cost time: 0.9291567802429199
Epoch: 48, Steps: 64 | Train Loss: 0.0781435 Vali Loss: 0.1978937 Test Loss: 0.2736661
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 49 cost time: 1.029639720916748
Epoch: 49, Steps: 64 | Train Loss: 0.0789077 Vali Loss: 0.1982421 Test Loss: 0.2728551
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 50 cost time: 1.0395748615264893
Epoch: 50, Steps: 64 | Train Loss: 0.0782495 Vali Loss: 0.1971845 Test Loss: 0.2722190
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 51 cost time: 0.9444386959075928
Epoch: 51, Steps: 64 | Train Loss: 0.0786020 Vali Loss: 0.1937882 Test Loss: 0.2715917
Validation loss decreased (0.196582 --> 0.193788).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 52 cost time: 0.9379041194915771
Epoch: 52, Steps: 64 | Train Loss: 0.0779171 Vali Loss: 0.1997544 Test Loss: 0.2728489
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 53 cost time: 0.9387681484222412
Epoch: 53, Steps: 64 | Train Loss: 0.0787396 Vali Loss: 0.1949043 Test Loss: 0.2717875
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 54 cost time: 0.9569997787475586
Epoch: 54, Steps: 64 | Train Loss: 0.0785945 Vali Loss: 0.1955491 Test Loss: 0.2728303
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 55 cost time: 0.9454381465911865
Epoch: 55, Steps: 64 | Train Loss: 0.0785277 Vali Loss: 0.1987912 Test Loss: 0.2714124
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 56 cost time: 0.945396900177002
Epoch: 56, Steps: 64 | Train Loss: 0.0780649 Vali Loss: 0.1983762 Test Loss: 0.2732036
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 57 cost time: 0.9513838291168213
Epoch: 57, Steps: 64 | Train Loss: 0.0782471 Vali Loss: 0.1977925 Test Loss: 0.2733384
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 58 cost time: 0.9394345283508301
Epoch: 58, Steps: 64 | Train Loss: 0.0788422 Vali Loss: 0.1970237 Test Loss: 0.2719902
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 59 cost time: 0.9359674453735352
Epoch: 59, Steps: 64 | Train Loss: 0.0780841 Vali Loss: 0.1967168 Test Loss: 0.2724171
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 60 cost time: 0.9343688488006592
Epoch: 60, Steps: 64 | Train Loss: 0.0782114 Vali Loss: 0.1984221 Test Loss: 0.2728583
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.27159175276756287, mae:0.33748677372932434, rse:0.2391834259033203
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05185985565185547 GB
Epoch: 1 cost time: 2.360307216644287
Epoch: 1, Steps: 64 | Train Loss: 0.8087659 Vali Loss: 2.4554470 Test Loss: 4.3499794
Validation loss decreased (inf --> 2.455447).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 2 cost time: 0.9756476879119873
Epoch: 2, Steps: 64 | Train Loss: 0.4803671 Vali Loss: 0.6244414 Test Loss: 0.8863757
Validation loss decreased (2.455447 --> 0.624441).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 3 cost time: 0.9740011692047119
Epoch: 3, Steps: 64 | Train Loss: 0.1465169 Vali Loss: 0.2855637 Test Loss: 0.3035970
Validation loss decreased (0.624441 --> 0.285564).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 4 cost time: 0.9814352989196777
Epoch: 4, Steps: 64 | Train Loss: 0.1065929 Vali Loss: 0.2554698 Test Loss: 0.3068429
Validation loss decreased (0.285564 --> 0.255470).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 5 cost time: 0.9742558002471924
Epoch: 5, Steps: 64 | Train Loss: 0.0985948 Vali Loss: 0.2489788 Test Loss: 0.2942588
Validation loss decreased (0.255470 --> 0.248979).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 6 cost time: 0.9743361473083496
Epoch: 6, Steps: 64 | Train Loss: 0.0946198 Vali Loss: 0.2440269 Test Loss: 0.2903672
Validation loss decreased (0.248979 --> 0.244027).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 7 cost time: 0.9723482131958008
Epoch: 7, Steps: 64 | Train Loss: 0.0919128 Vali Loss: 0.2326319 Test Loss: 0.2887137
Validation loss decreased (0.244027 --> 0.232632).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 8 cost time: 0.9710958003997803
Epoch: 8, Steps: 64 | Train Loss: 0.0901477 Vali Loss: 0.2306393 Test Loss: 0.2862725
Validation loss decreased (0.232632 --> 0.230639).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 9 cost time: 0.9719810485839844
Epoch: 9, Steps: 64 | Train Loss: 0.0883299 Vali Loss: 0.2295078 Test Loss: 0.2842393
Validation loss decreased (0.230639 --> 0.229508).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 10 cost time: 0.980365514755249
Epoch: 10, Steps: 64 | Train Loss: 0.0873651 Vali Loss: 0.2224936 Test Loss: 0.2816103
Validation loss decreased (0.229508 --> 0.222494).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 11 cost time: 0.9783263206481934
Epoch: 11, Steps: 64 | Train Loss: 0.0859896 Vali Loss: 0.2216599 Test Loss: 0.2815517
Validation loss decreased (0.222494 --> 0.221660).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 12 cost time: 0.9788198471069336
Epoch: 12, Steps: 64 | Train Loss: 0.0849115 Vali Loss: 0.2217697 Test Loss: 0.2786776
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 13 cost time: 0.9796226024627686
Epoch: 13, Steps: 64 | Train Loss: 0.0837206 Vali Loss: 0.2180367 Test Loss: 0.2789572
Validation loss decreased (0.221660 --> 0.218037).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 14 cost time: 0.9790000915527344
Epoch: 14, Steps: 64 | Train Loss: 0.0832326 Vali Loss: 0.2173038 Test Loss: 0.2772846
Validation loss decreased (0.218037 --> 0.217304).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 15 cost time: 0.9736175537109375
Epoch: 15, Steps: 64 | Train Loss: 0.0822316 Vali Loss: 0.2153277 Test Loss: 0.2786958
Validation loss decreased (0.217304 --> 0.215328).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 16 cost time: 0.9804039001464844
Epoch: 16, Steps: 64 | Train Loss: 0.0816653 Vali Loss: 0.2109007 Test Loss: 0.2751013
Validation loss decreased (0.215328 --> 0.210901).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 17 cost time: 0.9872498512268066
Epoch: 17, Steps: 64 | Train Loss: 0.0813282 Vali Loss: 0.2117393 Test Loss: 0.2746501
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 18 cost time: 0.9693965911865234
Epoch: 18, Steps: 64 | Train Loss: 0.0804435 Vali Loss: 0.2098529 Test Loss: 0.2741972
Validation loss decreased (0.210901 --> 0.209853).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 19 cost time: 0.973353385925293
Epoch: 19, Steps: 64 | Train Loss: 0.0802667 Vali Loss: 0.2083752 Test Loss: 0.2735797
Validation loss decreased (0.209853 --> 0.208375).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 20 cost time: 0.9793930053710938
Epoch: 20, Steps: 64 | Train Loss: 0.0796881 Vali Loss: 0.2067610 Test Loss: 0.2714254
Validation loss decreased (0.208375 --> 0.206761).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 21 cost time: 0.9493210315704346
Epoch: 21, Steps: 64 | Train Loss: 0.0795950 Vali Loss: 0.2069240 Test Loss: 0.2720216
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 22 cost time: 0.9717609882354736
Epoch: 22, Steps: 64 | Train Loss: 0.0787172 Vali Loss: 0.2029712 Test Loss: 0.2703400
Validation loss decreased (0.206761 --> 0.202971).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 23 cost time: 0.9717700481414795
Epoch: 23, Steps: 64 | Train Loss: 0.0788657 Vali Loss: 0.2035087 Test Loss: 0.2723296
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 24 cost time: 0.9429993629455566
Epoch: 24, Steps: 64 | Train Loss: 0.0785170 Vali Loss: 0.2030544 Test Loss: 0.2708597
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 25 cost time: 0.9660894870758057
Epoch: 25, Steps: 64 | Train Loss: 0.0781371 Vali Loss: 0.2044974 Test Loss: 0.2716064
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 26 cost time: 0.9684426784515381
Epoch: 26, Steps: 64 | Train Loss: 0.0777259 Vali Loss: 0.2032554 Test Loss: 0.2710022
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 27 cost time: 0.9744188785552979
Epoch: 27, Steps: 64 | Train Loss: 0.0779920 Vali Loss: 0.2002828 Test Loss: 0.2694288
Validation loss decreased (0.202971 --> 0.200283).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 28 cost time: 0.9784181118011475
Epoch: 28, Steps: 64 | Train Loss: 0.0777221 Vali Loss: 0.2019671 Test Loss: 0.2687242
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 29 cost time: 0.9853107929229736
Epoch: 29, Steps: 64 | Train Loss: 0.0774552 Vali Loss: 0.1989613 Test Loss: 0.2691227
Validation loss decreased (0.200283 --> 0.198961).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 30 cost time: 0.991342306137085
Epoch: 30, Steps: 64 | Train Loss: 0.0774121 Vali Loss: 0.1994681 Test Loss: 0.2695134
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 31 cost time: 0.9773447513580322
Epoch: 31, Steps: 64 | Train Loss: 0.0776153 Vali Loss: 0.2002853 Test Loss: 0.2680630
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 32 cost time: 0.9808173179626465
Epoch: 32, Steps: 64 | Train Loss: 0.0774472 Vali Loss: 0.2018363 Test Loss: 0.2688311
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 33 cost time: 0.9787178039550781
Epoch: 33, Steps: 64 | Train Loss: 0.0768574 Vali Loss: 0.2003512 Test Loss: 0.2689722
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 34 cost time: 0.9806051254272461
Epoch: 34, Steps: 64 | Train Loss: 0.0770344 Vali Loss: 0.1996337 Test Loss: 0.2684647
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 35 cost time: 0.9806122779846191
Epoch: 35, Steps: 64 | Train Loss: 0.0772400 Vali Loss: 0.1976358 Test Loss: 0.2680601
Validation loss decreased (0.198961 --> 0.197636).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 36 cost time: 0.9820699691772461
Epoch: 36, Steps: 64 | Train Loss: 0.0767789 Vali Loss: 0.1984875 Test Loss: 0.2681908
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 37 cost time: 1.00532865524292
Epoch: 37, Steps: 64 | Train Loss: 0.0768877 Vali Loss: 0.1981597 Test Loss: 0.2675832
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 38 cost time: 0.9892096519470215
Epoch: 38, Steps: 64 | Train Loss: 0.0772611 Vali Loss: 0.1969425 Test Loss: 0.2687324
Validation loss decreased (0.197636 --> 0.196943).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 39 cost time: 0.9863288402557373
Epoch: 39, Steps: 64 | Train Loss: 0.0767300 Vali Loss: 0.1976203 Test Loss: 0.2679876
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 40 cost time: 0.9863383769989014
Epoch: 40, Steps: 64 | Train Loss: 0.0767798 Vali Loss: 0.1964963 Test Loss: 0.2683569
Validation loss decreased (0.196943 --> 0.196496).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 41 cost time: 0.9824016094207764
Epoch: 41, Steps: 64 | Train Loss: 0.0765800 Vali Loss: 0.1978658 Test Loss: 0.2694883
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 42 cost time: 0.9869418144226074
Epoch: 42, Steps: 64 | Train Loss: 0.0765397 Vali Loss: 0.1974283 Test Loss: 0.2686222
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 43 cost time: 0.9974234104156494
Epoch: 43, Steps: 64 | Train Loss: 0.0763307 Vali Loss: 0.1969512 Test Loss: 0.2688892
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 44 cost time: 0.965843915939331
Epoch: 44, Steps: 64 | Train Loss: 0.0764018 Vali Loss: 0.1964410 Test Loss: 0.2675155
Validation loss decreased (0.196496 --> 0.196441).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 45 cost time: 0.9780001640319824
Epoch: 45, Steps: 64 | Train Loss: 0.0767163 Vali Loss: 0.1967236 Test Loss: 0.2671099
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 46 cost time: 0.9736673831939697
Epoch: 46, Steps: 64 | Train Loss: 0.0762392 Vali Loss: 0.1935677 Test Loss: 0.2673450
Validation loss decreased (0.196441 --> 0.193568).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 47 cost time: 0.9840273857116699
Epoch: 47, Steps: 64 | Train Loss: 0.0763428 Vali Loss: 0.1987430 Test Loss: 0.2691356
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 48 cost time: 0.9923379421234131
Epoch: 48, Steps: 64 | Train Loss: 0.0760816 Vali Loss: 0.1947489 Test Loss: 0.2669599
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 49 cost time: 0.9924626350402832
Epoch: 49, Steps: 64 | Train Loss: 0.0761929 Vali Loss: 0.1961110 Test Loss: 0.2668959
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 50 cost time: 0.9977788925170898
Epoch: 50, Steps: 64 | Train Loss: 0.0764089 Vali Loss: 0.1973982 Test Loss: 0.2676771
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 51 cost time: 0.9934051036834717
Epoch: 51, Steps: 64 | Train Loss: 0.0763084 Vali Loss: 0.1948909 Test Loss: 0.2676667
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 52 cost time: 0.9943363666534424
Epoch: 52, Steps: 64 | Train Loss: 0.0763106 Vali Loss: 0.1943068 Test Loss: 0.2666031
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 53 cost time: 1.0014457702636719
Epoch: 53, Steps: 64 | Train Loss: 0.0760395 Vali Loss: 0.1976351 Test Loss: 0.2671303
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 54 cost time: 0.9956679344177246
Epoch: 54, Steps: 64 | Train Loss: 0.0762058 Vali Loss: 0.1946728 Test Loss: 0.2671027
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 55 cost time: 0.9977238178253174
Epoch: 55, Steps: 64 | Train Loss: 0.0761995 Vali Loss: 0.1960593 Test Loss: 0.2669158
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 56 cost time: 0.9978265762329102
Epoch: 56, Steps: 64 | Train Loss: 0.0759147 Vali Loss: 0.1966997 Test Loss: 0.2675563
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 57 cost time: 1.0549092292785645
Epoch: 57, Steps: 64 | Train Loss: 0.0764061 Vali Loss: 0.1982815 Test Loss: 0.2672601
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 58 cost time: 1.0245990753173828
Epoch: 58, Steps: 64 | Train Loss: 0.0764995 Vali Loss: 0.1974332 Test Loss: 0.2678475
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 59 cost time: 0.9889991283416748
Epoch: 59, Steps: 64 | Train Loss: 0.0763882 Vali Loss: 0.1966819 Test Loss: 0.2672637
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 60 cost time: 0.9876043796539307
Epoch: 60, Steps: 64 | Train Loss: 0.0762956 Vali Loss: 0.1953033 Test Loss: 0.2675803
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.26734501123428345, mae:0.3338998258113861, rse:0.23730605840682983
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.049469947814941406 GB
Epoch: 1 cost time: 2.335880756378174
Epoch: 1, Steps: 64 | Train Loss: 1.2592937 Vali Loss: 3.4563100 Test Loss: 6.1461916
Validation loss decreased (inf --> 3.456310).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 2 cost time: 0.9221560955047607
Epoch: 2, Steps: 64 | Train Loss: 0.7737983 Vali Loss: 1.0531102 Test Loss: 1.6777740
Validation loss decreased (3.456310 --> 1.053110).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 3 cost time: 0.9273674488067627
Epoch: 3, Steps: 64 | Train Loss: 0.3387898 Vali Loss: 0.6128078 Test Loss: 0.8238969
Validation loss decreased (1.053110 --> 0.612808).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 4 cost time: 0.9204826354980469
Epoch: 4, Steps: 64 | Train Loss: 0.2222864 Vali Loss: 0.4559937 Test Loss: 0.5703329
Validation loss decreased (0.612808 --> 0.455994).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 5 cost time: 0.9240474700927734
Epoch: 5, Steps: 64 | Train Loss: 0.1723477 Vali Loss: 0.3725069 Test Loss: 0.4380969
Validation loss decreased (0.455994 --> 0.372507).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 6 cost time: 0.9137246608734131
Epoch: 6, Steps: 64 | Train Loss: 0.1493348 Vali Loss: 0.3190609 Test Loss: 0.3655872
Validation loss decreased (0.372507 --> 0.319061).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 7 cost time: 0.9126214981079102
Epoch: 7, Steps: 64 | Train Loss: 0.1382999 Vali Loss: 0.2974268 Test Loss: 0.3390090
Validation loss decreased (0.319061 --> 0.297427).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 8 cost time: 0.935610294342041
Epoch: 8, Steps: 64 | Train Loss: 0.1299345 Vali Loss: 0.2784935 Test Loss: 0.3194321
Validation loss decreased (0.297427 --> 0.278493).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 9 cost time: 0.9403338432312012
Epoch: 9, Steps: 64 | Train Loss: 0.1251374 Vali Loss: 0.2686241 Test Loss: 0.3097267
Validation loss decreased (0.278493 --> 0.268624).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 10 cost time: 0.9483911991119385
Epoch: 10, Steps: 64 | Train Loss: 0.1216633 Vali Loss: 0.2587712 Test Loss: 0.3059937
Validation loss decreased (0.268624 --> 0.258771).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 11 cost time: 0.9437854290008545
Epoch: 11, Steps: 64 | Train Loss: 0.1184281 Vali Loss: 0.2513205 Test Loss: 0.3029117
Validation loss decreased (0.258771 --> 0.251321).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 12 cost time: 0.9433908462524414
Epoch: 12, Steps: 64 | Train Loss: 0.1158637 Vali Loss: 0.2519663 Test Loss: 0.2986901
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 13 cost time: 0.9533681869506836
Epoch: 13, Steps: 64 | Train Loss: 0.1145445 Vali Loss: 0.2488502 Test Loss: 0.3005935
Validation loss decreased (0.251321 --> 0.248850).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 14 cost time: 0.9397358894348145
Epoch: 14, Steps: 64 | Train Loss: 0.1121022 Vali Loss: 0.2439055 Test Loss: 0.2925357
Validation loss decreased (0.248850 --> 0.243905).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 15 cost time: 0.9360992908477783
Epoch: 15, Steps: 64 | Train Loss: 0.1101855 Vali Loss: 0.2407566 Test Loss: 0.2947868
Validation loss decreased (0.243905 --> 0.240757).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 16 cost time: 0.9340000152587891
Epoch: 16, Steps: 64 | Train Loss: 0.1094169 Vali Loss: 0.2389633 Test Loss: 0.2941687
Validation loss decreased (0.240757 --> 0.238963).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 17 cost time: 0.9395966529846191
Epoch: 17, Steps: 64 | Train Loss: 0.1072136 Vali Loss: 0.2407975 Test Loss: 0.2923504
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 18 cost time: 0.9347333908081055
Epoch: 18, Steps: 64 | Train Loss: 0.1077620 Vali Loss: 0.2372290 Test Loss: 0.2932408
Validation loss decreased (0.238963 --> 0.237229).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 19 cost time: 0.942979097366333
Epoch: 19, Steps: 64 | Train Loss: 0.1058023 Vali Loss: 0.2340643 Test Loss: 0.2906616
Validation loss decreased (0.237229 --> 0.234064).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 20 cost time: 0.9523701667785645
Epoch: 20, Steps: 64 | Train Loss: 0.1046372 Vali Loss: 0.2332756 Test Loss: 0.2911156
Validation loss decreased (0.234064 --> 0.233276).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 21 cost time: 0.9383704662322998
Epoch: 21, Steps: 64 | Train Loss: 0.1050430 Vali Loss: 0.2344451 Test Loss: 0.2913102
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 22 cost time: 0.9474050998687744
Epoch: 22, Steps: 64 | Train Loss: 0.1037097 Vali Loss: 0.2300661 Test Loss: 0.2916424
Validation loss decreased (0.233276 --> 0.230066).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 23 cost time: 0.9427571296691895
Epoch: 23, Steps: 64 | Train Loss: 0.1034525 Vali Loss: 0.2302567 Test Loss: 0.2913461
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 24 cost time: 0.9259977340698242
Epoch: 24, Steps: 64 | Train Loss: 0.1034850 Vali Loss: 0.2304503 Test Loss: 0.2893093
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 25 cost time: 0.9396066665649414
Epoch: 25, Steps: 64 | Train Loss: 0.1015355 Vali Loss: 0.2251319 Test Loss: 0.2888464
Validation loss decreased (0.230066 --> 0.225132).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 26 cost time: 0.940326452255249
Epoch: 26, Steps: 64 | Train Loss: 0.1020421 Vali Loss: 0.2278397 Test Loss: 0.2884537
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 27 cost time: 0.9303553104400635
Epoch: 27, Steps: 64 | Train Loss: 0.1018632 Vali Loss: 0.2291259 Test Loss: 0.2878124
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 28 cost time: 0.9299173355102539
Epoch: 28, Steps: 64 | Train Loss: 0.1006907 Vali Loss: 0.2267887 Test Loss: 0.2882216
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 29 cost time: 0.9393961429595947
Epoch: 29, Steps: 64 | Train Loss: 0.1006327 Vali Loss: 0.2250150 Test Loss: 0.2859657
Validation loss decreased (0.225132 --> 0.225015).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 30 cost time: 0.9503781795501709
Epoch: 30, Steps: 64 | Train Loss: 0.1003290 Vali Loss: 0.2242296 Test Loss: 0.2886755
Validation loss decreased (0.225015 --> 0.224230).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 31 cost time: 0.9427773952484131
Epoch: 31, Steps: 64 | Train Loss: 0.1005656 Vali Loss: 0.2267052 Test Loss: 0.2871448
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 32 cost time: 0.9463372230529785
Epoch: 32, Steps: 64 | Train Loss: 0.1000622 Vali Loss: 0.2267026 Test Loss: 0.2881297
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 33 cost time: 0.941608190536499
Epoch: 33, Steps: 64 | Train Loss: 0.1000402 Vali Loss: 0.2247345 Test Loss: 0.2889262
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 34 cost time: 0.9408664703369141
Epoch: 34, Steps: 64 | Train Loss: 0.0998075 Vali Loss: 0.2223713 Test Loss: 0.2872031
Validation loss decreased (0.224230 --> 0.222371).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 35 cost time: 0.923454761505127
Epoch: 35, Steps: 64 | Train Loss: 0.0993143 Vali Loss: 0.2263004 Test Loss: 0.2874506
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 36 cost time: 0.9303910732269287
Epoch: 36, Steps: 64 | Train Loss: 0.0995050 Vali Loss: 0.2251509 Test Loss: 0.2872731
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 37 cost time: 0.9424433708190918
Epoch: 37, Steps: 64 | Train Loss: 0.0994007 Vali Loss: 0.2232183 Test Loss: 0.2868913
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 38 cost time: 0.9317483901977539
Epoch: 38, Steps: 64 | Train Loss: 0.0985943 Vali Loss: 0.2250035 Test Loss: 0.2882983
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 39 cost time: 0.9266901016235352
Epoch: 39, Steps: 64 | Train Loss: 0.0983442 Vali Loss: 0.2223281 Test Loss: 0.2876251
Validation loss decreased (0.222371 --> 0.222328).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 40 cost time: 0.9234156608581543
Epoch: 40, Steps: 64 | Train Loss: 0.0989961 Vali Loss: 0.2237296 Test Loss: 0.2858090
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 41 cost time: 0.9075486660003662
Epoch: 41, Steps: 64 | Train Loss: 0.0987575 Vali Loss: 0.2232364 Test Loss: 0.2865748
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 42 cost time: 0.923072338104248
Epoch: 42, Steps: 64 | Train Loss: 0.0980471 Vali Loss: 0.2220819 Test Loss: 0.2855725
Validation loss decreased (0.222328 --> 0.222082).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 43 cost time: 0.9223959445953369
Epoch: 43, Steps: 64 | Train Loss: 0.0985349 Vali Loss: 0.2229770 Test Loss: 0.2871299
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 44 cost time: 0.9143049716949463
Epoch: 44, Steps: 64 | Train Loss: 0.0985645 Vali Loss: 0.2220232 Test Loss: 0.2882547
Validation loss decreased (0.222082 --> 0.222023).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 45 cost time: 0.9194278717041016
Epoch: 45, Steps: 64 | Train Loss: 0.0977766 Vali Loss: 0.2235885 Test Loss: 0.2859853
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 46 cost time: 0.925940990447998
Epoch: 46, Steps: 64 | Train Loss: 0.0984294 Vali Loss: 0.2215119 Test Loss: 0.2875244
Validation loss decreased (0.222023 --> 0.221512).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 47 cost time: 0.9240009784698486
Epoch: 47, Steps: 64 | Train Loss: 0.0972504 Vali Loss: 0.2214383 Test Loss: 0.2867401
Validation loss decreased (0.221512 --> 0.221438).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 48 cost time: 0.911635160446167
Epoch: 48, Steps: 64 | Train Loss: 0.0980314 Vali Loss: 0.2228677 Test Loss: 0.2857668
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 49 cost time: 0.8870818614959717
Epoch: 49, Steps: 64 | Train Loss: 0.0983497 Vali Loss: 0.2226316 Test Loss: 0.2875748
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 50 cost time: 0.916301965713501
Epoch: 50, Steps: 64 | Train Loss: 0.0980233 Vali Loss: 0.2219504 Test Loss: 0.2860435
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 51 cost time: 0.9413700103759766
Epoch: 51, Steps: 64 | Train Loss: 0.0982856 Vali Loss: 0.2228575 Test Loss: 0.2881459
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 52 cost time: 0.9373469352722168
Epoch: 52, Steps: 64 | Train Loss: 0.0980652 Vali Loss: 0.2240639 Test Loss: 0.2869390
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 53 cost time: 0.9371826648712158
Epoch: 53, Steps: 64 | Train Loss: 0.0977640 Vali Loss: 0.2183275 Test Loss: 0.2853863
Validation loss decreased (0.221438 --> 0.218327).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 54 cost time: 0.9450006484985352
Epoch: 54, Steps: 64 | Train Loss: 0.0981674 Vali Loss: 0.2220134 Test Loss: 0.2855321
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 55 cost time: 0.9399995803833008
Epoch: 55, Steps: 64 | Train Loss: 0.0973327 Vali Loss: 0.2209332 Test Loss: 0.2878814
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 56 cost time: 0.9445993900299072
Epoch: 56, Steps: 64 | Train Loss: 0.0976234 Vali Loss: 0.2249467 Test Loss: 0.2872394
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 57 cost time: 0.9407205581665039
Epoch: 57, Steps: 64 | Train Loss: 0.0979504 Vali Loss: 0.2215840 Test Loss: 0.2868245
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 58 cost time: 0.9420247077941895
Epoch: 58, Steps: 64 | Train Loss: 0.0976677 Vali Loss: 0.2196371 Test Loss: 0.2848347
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 59 cost time: 0.9333631992340088
Epoch: 59, Steps: 64 | Train Loss: 0.0976759 Vali Loss: 0.2212958 Test Loss: 0.2871460
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 60 cost time: 0.9333257675170898
Epoch: 60, Steps: 64 | Train Loss: 0.0974256 Vali Loss: 0.2198437 Test Loss: 0.2862625
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2853862941265106, mae:0.33858808875083923, rse:0.24518243968486786
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05090188980102539 GB
Epoch: 1 cost time: 2.386880874633789
Epoch: 1, Steps: 64 | Train Loss: 0.8403733 Vali Loss: 2.4972730 Test Loss: 4.3002419
Validation loss decreased (inf --> 2.497273).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 2 cost time: 0.948946475982666
Epoch: 2, Steps: 64 | Train Loss: 0.4985131 Vali Loss: 0.7052209 Test Loss: 1.0035812
Validation loss decreased (2.497273 --> 0.705221).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 3 cost time: 0.9436256885528564
Epoch: 3, Steps: 64 | Train Loss: 0.1728771 Vali Loss: 0.3107658 Test Loss: 0.3298170
Validation loss decreased (0.705221 --> 0.310766).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 4 cost time: 0.9426240921020508
Epoch: 4, Steps: 64 | Train Loss: 0.1134204 Vali Loss: 0.2608371 Test Loss: 0.2905205
Validation loss decreased (0.310766 --> 0.260837).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 5 cost time: 0.9032647609710693
Epoch: 5, Steps: 64 | Train Loss: 0.1031837 Vali Loss: 0.2449717 Test Loss: 0.2899221
Validation loss decreased (0.260837 --> 0.244972).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 6 cost time: 0.9613316059112549
Epoch: 6, Steps: 64 | Train Loss: 0.0980544 Vali Loss: 0.2361654 Test Loss: 0.2881553
Validation loss decreased (0.244972 --> 0.236165).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 7 cost time: 0.9621946811676025
Epoch: 7, Steps: 64 | Train Loss: 0.0942942 Vali Loss: 0.2313561 Test Loss: 0.2874271
Validation loss decreased (0.236165 --> 0.231356).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 8 cost time: 0.9527251720428467
Epoch: 8, Steps: 64 | Train Loss: 0.0914049 Vali Loss: 0.2244006 Test Loss: 0.2846021
Validation loss decreased (0.231356 --> 0.224401).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 9 cost time: 0.9573986530303955
Epoch: 9, Steps: 64 | Train Loss: 0.0892223 Vali Loss: 0.2194703 Test Loss: 0.2823592
Validation loss decreased (0.224401 --> 0.219470).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 10 cost time: 0.9663839340209961
Epoch: 10, Steps: 64 | Train Loss: 0.0876308 Vali Loss: 0.2161853 Test Loss: 0.2836616
Validation loss decreased (0.219470 --> 0.216185).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 11 cost time: 0.9720733165740967
Epoch: 11, Steps: 64 | Train Loss: 0.0858164 Vali Loss: 0.2117618 Test Loss: 0.2848231
Validation loss decreased (0.216185 --> 0.211762).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 12 cost time: 0.9667975902557373
Epoch: 12, Steps: 64 | Train Loss: 0.0847499 Vali Loss: 0.2080569 Test Loss: 0.2843559
Validation loss decreased (0.211762 --> 0.208057).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 13 cost time: 0.9619998931884766
Epoch: 13, Steps: 64 | Train Loss: 0.0836502 Vali Loss: 0.2091376 Test Loss: 0.2825715
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 14 cost time: 0.9586029052734375
Epoch: 14, Steps: 64 | Train Loss: 0.0820558 Vali Loss: 0.2039346 Test Loss: 0.2813333
Validation loss decreased (0.208057 --> 0.203935).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 15 cost time: 0.9463558197021484
Epoch: 15, Steps: 64 | Train Loss: 0.0816295 Vali Loss: 0.2048611 Test Loss: 0.2829259
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 16 cost time: 0.9412569999694824
Epoch: 16, Steps: 64 | Train Loss: 0.0808595 Vali Loss: 0.2028112 Test Loss: 0.2815449
Validation loss decreased (0.203935 --> 0.202811).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 17 cost time: 0.9333209991455078
Epoch: 17, Steps: 64 | Train Loss: 0.0808172 Vali Loss: 0.2014848 Test Loss: 0.2810258
Validation loss decreased (0.202811 --> 0.201485).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 18 cost time: 0.9533591270446777
Epoch: 18, Steps: 64 | Train Loss: 0.0794827 Vali Loss: 0.1990725 Test Loss: 0.2810281
Validation loss decreased (0.201485 --> 0.199073).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 19 cost time: 0.9440090656280518
Epoch: 19, Steps: 64 | Train Loss: 0.0792170 Vali Loss: 0.1963149 Test Loss: 0.2810410
Validation loss decreased (0.199073 --> 0.196315).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 20 cost time: 0.9408190250396729
Epoch: 20, Steps: 64 | Train Loss: 0.0789795 Vali Loss: 0.2007076 Test Loss: 0.2826882
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 21 cost time: 0.9510002136230469
Epoch: 21, Steps: 64 | Train Loss: 0.0777876 Vali Loss: 0.1961187 Test Loss: 0.2812774
Validation loss decreased (0.196315 --> 0.196119).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 22 cost time: 0.943000078201294
Epoch: 22, Steps: 64 | Train Loss: 0.0782977 Vali Loss: 0.1971516 Test Loss: 0.2793322
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 23 cost time: 0.9359898567199707
Epoch: 23, Steps: 64 | Train Loss: 0.0779511 Vali Loss: 0.1953774 Test Loss: 0.2810962
Validation loss decreased (0.196119 --> 0.195377).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 24 cost time: 0.9354321956634521
Epoch: 24, Steps: 64 | Train Loss: 0.0779556 Vali Loss: 0.1937986 Test Loss: 0.2809415
Validation loss decreased (0.195377 --> 0.193799).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 25 cost time: 0.9430243968963623
Epoch: 25, Steps: 64 | Train Loss: 0.0778425 Vali Loss: 0.1956267 Test Loss: 0.2807361
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 26 cost time: 0.9383406639099121
Epoch: 26, Steps: 64 | Train Loss: 0.0772254 Vali Loss: 0.1941329 Test Loss: 0.2804845
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 27 cost time: 0.9417266845703125
Epoch: 27, Steps: 64 | Train Loss: 0.0768514 Vali Loss: 0.1922756 Test Loss: 0.2800469
Validation loss decreased (0.193799 --> 0.192276).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 28 cost time: 0.9557087421417236
Epoch: 28, Steps: 64 | Train Loss: 0.0770506 Vali Loss: 0.1931971 Test Loss: 0.2810071
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 29 cost time: 0.945796012878418
Epoch: 29, Steps: 64 | Train Loss: 0.0770746 Vali Loss: 0.1963100 Test Loss: 0.2792838
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 30 cost time: 0.9509997367858887
Epoch: 30, Steps: 64 | Train Loss: 0.0763013 Vali Loss: 0.1947894 Test Loss: 0.2791959
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 31 cost time: 0.946613073348999
Epoch: 31, Steps: 64 | Train Loss: 0.0764604 Vali Loss: 0.1946730 Test Loss: 0.2800543
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 32 cost time: 0.943101167678833
Epoch: 32, Steps: 64 | Train Loss: 0.0764572 Vali Loss: 0.1947743 Test Loss: 0.2792242
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 33 cost time: 0.9403643608093262
Epoch: 33, Steps: 64 | Train Loss: 0.0761402 Vali Loss: 0.1892971 Test Loss: 0.2782190
Validation loss decreased (0.192276 --> 0.189297).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 34 cost time: 0.9403824806213379
Epoch: 34, Steps: 64 | Train Loss: 0.0763855 Vali Loss: 0.1914672 Test Loss: 0.2791156
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 35 cost time: 0.964390754699707
Epoch: 35, Steps: 64 | Train Loss: 0.0762071 Vali Loss: 0.1933295 Test Loss: 0.2785309
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 36 cost time: 0.9447824954986572
Epoch: 36, Steps: 64 | Train Loss: 0.0761885 Vali Loss: 0.1951265 Test Loss: 0.2791458
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 37 cost time: 0.9487464427947998
Epoch: 37, Steps: 64 | Train Loss: 0.0758247 Vali Loss: 0.1916249 Test Loss: 0.2796361
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 38 cost time: 0.9579997062683105
Epoch: 38, Steps: 64 | Train Loss: 0.0759795 Vali Loss: 0.1912895 Test Loss: 0.2771454
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 39 cost time: 0.9456160068511963
Epoch: 39, Steps: 64 | Train Loss: 0.0759100 Vali Loss: 0.1907365 Test Loss: 0.2775557
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 40 cost time: 0.938244104385376
Epoch: 40, Steps: 64 | Train Loss: 0.0757898 Vali Loss: 0.1918452 Test Loss: 0.2787355
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 41 cost time: 0.9424235820770264
Epoch: 41, Steps: 64 | Train Loss: 0.0757940 Vali Loss: 0.1898457 Test Loss: 0.2780802
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 42 cost time: 0.9423582553863525
Epoch: 42, Steps: 64 | Train Loss: 0.0754313 Vali Loss: 0.1900292 Test Loss: 0.2782458
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 43 cost time: 0.9453675746917725
Epoch: 43, Steps: 64 | Train Loss: 0.0758733 Vali Loss: 0.1919180 Test Loss: 0.2786385
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 44 cost time: 0.9430279731750488
Epoch: 44, Steps: 64 | Train Loss: 0.0754888 Vali Loss: 0.1887007 Test Loss: 0.2780434
Validation loss decreased (0.189297 --> 0.188701).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 45 cost time: 0.9497556686401367
Epoch: 45, Steps: 64 | Train Loss: 0.0755090 Vali Loss: 0.1922507 Test Loss: 0.2776721
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 46 cost time: 0.9420006275177002
Epoch: 46, Steps: 64 | Train Loss: 0.0753759 Vali Loss: 0.1920801 Test Loss: 0.2797727
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 47 cost time: 0.9416155815124512
Epoch: 47, Steps: 64 | Train Loss: 0.0754621 Vali Loss: 0.1918139 Test Loss: 0.2776866
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 48 cost time: 0.9499881267547607
Epoch: 48, Steps: 64 | Train Loss: 0.0759347 Vali Loss: 0.1907776 Test Loss: 0.2773476
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 49 cost time: 0.9208040237426758
Epoch: 49, Steps: 64 | Train Loss: 0.0754323 Vali Loss: 0.1922071 Test Loss: 0.2796383
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 50 cost time: 0.9460489749908447
Epoch: 50, Steps: 64 | Train Loss: 0.0754022 Vali Loss: 0.1922359 Test Loss: 0.2788354
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 51 cost time: 0.9374656677246094
Epoch: 51, Steps: 64 | Train Loss: 0.0759085 Vali Loss: 0.1895169 Test Loss: 0.2785512
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 52 cost time: 0.9547488689422607
Epoch: 52, Steps: 64 | Train Loss: 0.0756758 Vali Loss: 0.1927286 Test Loss: 0.2788215
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 53 cost time: 0.9887466430664062
Epoch: 53, Steps: 64 | Train Loss: 0.0760452 Vali Loss: 0.1935005 Test Loss: 0.2795492
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 54 cost time: 0.9419999122619629
Epoch: 54, Steps: 64 | Train Loss: 0.0753247 Vali Loss: 0.1938960 Test Loss: 0.2792719
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 55 cost time: 0.9520003795623779
Epoch: 55, Steps: 64 | Train Loss: 0.0755890 Vali Loss: 0.1908772 Test Loss: 0.2780877
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 56 cost time: 0.9396162033081055
Epoch: 56, Steps: 64 | Train Loss: 0.0755626 Vali Loss: 0.1894903 Test Loss: 0.2780914
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 57 cost time: 0.9406182765960693
Epoch: 57, Steps: 64 | Train Loss: 0.0757238 Vali Loss: 0.1906706 Test Loss: 0.2781875
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 58 cost time: 0.9363675117492676
Epoch: 58, Steps: 64 | Train Loss: 0.0753914 Vali Loss: 0.1904010 Test Loss: 0.2775646
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 59 cost time: 0.9417526721954346
Epoch: 59, Steps: 64 | Train Loss: 0.0753141 Vali Loss: 0.1914223 Test Loss: 0.2779351
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 60 cost time: 0.9375035762786865
Epoch: 60, Steps: 64 | Train Loss: 0.0758971 Vali Loss: 0.1901057 Test Loss: 0.2786228
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.27804335951805115, mae:0.3388373851776123, rse:0.24200762808322906
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05202198028564453 GB
Epoch: 1 cost time: 2.319082736968994
Epoch: 1, Steps: 64 | Train Loss: 0.8800602 Vali Loss: 2.7147324 Test Loss: 4.7600393
Validation loss decreased (inf --> 2.714732).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 2 cost time: 0.9186279773712158
Epoch: 2, Steps: 64 | Train Loss: 0.5698436 Vali Loss: 0.8497819 Test Loss: 1.2292157
Validation loss decreased (2.714732 --> 0.849782).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 3 cost time: 0.9119999408721924
Epoch: 3, Steps: 64 | Train Loss: 0.1788105 Vali Loss: 0.3144740 Test Loss: 0.3051884
Validation loss decreased (0.849782 --> 0.314474).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 4 cost time: 0.9116127490997314
Epoch: 4, Steps: 64 | Train Loss: 0.1080972 Vali Loss: 0.2584371 Test Loss: 0.3018683
Validation loss decreased (0.314474 --> 0.258437).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 5 cost time: 0.9164445400238037
Epoch: 5, Steps: 64 | Train Loss: 0.0993145 Vali Loss: 0.2453481 Test Loss: 0.2921284
Validation loss decreased (0.258437 --> 0.245348).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 6 cost time: 0.8995492458343506
Epoch: 6, Steps: 64 | Train Loss: 0.0940472 Vali Loss: 0.2399537 Test Loss: 0.2886986
Validation loss decreased (0.245348 --> 0.239954).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 7 cost time: 0.9003691673278809
Epoch: 7, Steps: 64 | Train Loss: 0.0905238 Vali Loss: 0.2284024 Test Loss: 0.2886870
Validation loss decreased (0.239954 --> 0.228402).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 8 cost time: 0.8977360725402832
Epoch: 8, Steps: 64 | Train Loss: 0.0877160 Vali Loss: 0.2244841 Test Loss: 0.2850023
Validation loss decreased (0.228402 --> 0.224484).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 9 cost time: 0.8969998359680176
Epoch: 9, Steps: 64 | Train Loss: 0.0853545 Vali Loss: 0.2203185 Test Loss: 0.2868687
Validation loss decreased (0.224484 --> 0.220318).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 10 cost time: 0.9046235084533691
Epoch: 10, Steps: 64 | Train Loss: 0.0841799 Vali Loss: 0.2156116 Test Loss: 0.2849685
Validation loss decreased (0.220318 --> 0.215612).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 11 cost time: 0.9063878059387207
Epoch: 11, Steps: 64 | Train Loss: 0.0826755 Vali Loss: 0.2140683 Test Loss: 0.2831070
Validation loss decreased (0.215612 --> 0.214068).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 12 cost time: 0.9033799171447754
Epoch: 12, Steps: 64 | Train Loss: 0.0813168 Vali Loss: 0.2107699 Test Loss: 0.2822859
Validation loss decreased (0.214068 --> 0.210770).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 13 cost time: 0.9137747287750244
Epoch: 13, Steps: 64 | Train Loss: 0.0798415 Vali Loss: 0.2081151 Test Loss: 0.2812387
Validation loss decreased (0.210770 --> 0.208115).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 14 cost time: 0.9024038314819336
Epoch: 14, Steps: 64 | Train Loss: 0.0791669 Vali Loss: 0.2047007 Test Loss: 0.2825145
Validation loss decreased (0.208115 --> 0.204701).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 15 cost time: 0.8993644714355469
Epoch: 15, Steps: 64 | Train Loss: 0.0784407 Vali Loss: 0.2004548 Test Loss: 0.2806283
Validation loss decreased (0.204701 --> 0.200455).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 16 cost time: 0.9100000858306885
Epoch: 16, Steps: 64 | Train Loss: 0.0775996 Vali Loss: 0.2006977 Test Loss: 0.2808987
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 17 cost time: 0.9003679752349854
Epoch: 17, Steps: 64 | Train Loss: 0.0768605 Vali Loss: 0.1990379 Test Loss: 0.2793750
Validation loss decreased (0.200455 --> 0.199038).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 18 cost time: 0.9003863334655762
Epoch: 18, Steps: 64 | Train Loss: 0.0765392 Vali Loss: 0.1992242 Test Loss: 0.2801287
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 19 cost time: 0.9033408164978027
Epoch: 19, Steps: 64 | Train Loss: 0.0758941 Vali Loss: 0.1942162 Test Loss: 0.2790280
Validation loss decreased (0.199038 --> 0.194216).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 20 cost time: 0.9040257930755615
Epoch: 20, Steps: 64 | Train Loss: 0.0756208 Vali Loss: 0.1950264 Test Loss: 0.2773215
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 21 cost time: 0.9037694931030273
Epoch: 21, Steps: 64 | Train Loss: 0.0756159 Vali Loss: 0.1949690 Test Loss: 0.2761191
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 22 cost time: 0.9050002098083496
Epoch: 22, Steps: 64 | Train Loss: 0.0748093 Vali Loss: 0.1967630 Test Loss: 0.2764664
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 23 cost time: 0.9185185432434082
Epoch: 23, Steps: 64 | Train Loss: 0.0748131 Vali Loss: 0.1937618 Test Loss: 0.2759597
Validation loss decreased (0.194216 --> 0.193762).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 24 cost time: 0.8963727951049805
Epoch: 24, Steps: 64 | Train Loss: 0.0745279 Vali Loss: 0.1951476 Test Loss: 0.2751432
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 25 cost time: 0.8989458084106445
Epoch: 25, Steps: 64 | Train Loss: 0.0741258 Vali Loss: 0.1940364 Test Loss: 0.2752112
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 26 cost time: 0.896507740020752
Epoch: 26, Steps: 64 | Train Loss: 0.0741439 Vali Loss: 0.1904530 Test Loss: 0.2747040
Validation loss decreased (0.193762 --> 0.190453).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 27 cost time: 0.8937833309173584
Epoch: 27, Steps: 64 | Train Loss: 0.0740935 Vali Loss: 0.1937248 Test Loss: 0.2747133
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 28 cost time: 0.9007129669189453
Epoch: 28, Steps: 64 | Train Loss: 0.0738375 Vali Loss: 0.1939909 Test Loss: 0.2744930
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 29 cost time: 0.9016194343566895
Epoch: 29, Steps: 64 | Train Loss: 0.0735574 Vali Loss: 0.1913316 Test Loss: 0.2746851
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 30 cost time: 0.9083843231201172
Epoch: 30, Steps: 64 | Train Loss: 0.0731765 Vali Loss: 0.1914195 Test Loss: 0.2749361
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 31 cost time: 0.9034430980682373
Epoch: 31, Steps: 64 | Train Loss: 0.0731845 Vali Loss: 0.1911843 Test Loss: 0.2740824
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 32 cost time: 0.9083890914916992
Epoch: 32, Steps: 64 | Train Loss: 0.0735875 Vali Loss: 0.1904908 Test Loss: 0.2732361
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 33 cost time: 0.9030508995056152
Epoch: 33, Steps: 64 | Train Loss: 0.0731388 Vali Loss: 0.1933629 Test Loss: 0.2744030
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 34 cost time: 0.9079995155334473
Epoch: 34, Steps: 64 | Train Loss: 0.0726967 Vali Loss: 0.1920406 Test Loss: 0.2740962
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 35 cost time: 0.9261858463287354
Epoch: 35, Steps: 64 | Train Loss: 0.0734847 Vali Loss: 0.1948386 Test Loss: 0.2739649
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 36 cost time: 0.9007651805877686
Epoch: 36, Steps: 64 | Train Loss: 0.0733304 Vali Loss: 0.1917594 Test Loss: 0.2741375
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 37 cost time: 0.9049856662750244
Epoch: 37, Steps: 64 | Train Loss: 0.0726687 Vali Loss: 0.1901269 Test Loss: 0.2734317
Validation loss decreased (0.190453 --> 0.190127).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 38 cost time: 0.9214062690734863
Epoch: 38, Steps: 64 | Train Loss: 0.0728550 Vali Loss: 0.1922047 Test Loss: 0.2730405
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 39 cost time: 0.9089386463165283
Epoch: 39, Steps: 64 | Train Loss: 0.0726126 Vali Loss: 0.1927074 Test Loss: 0.2732467
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 40 cost time: 0.9037158489227295
Epoch: 40, Steps: 64 | Train Loss: 0.0727925 Vali Loss: 0.1922193 Test Loss: 0.2732321
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 41 cost time: 0.9251554012298584
Epoch: 41, Steps: 64 | Train Loss: 0.0724260 Vali Loss: 0.1923882 Test Loss: 0.2730243
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 42 cost time: 0.9016108512878418
Epoch: 42, Steps: 64 | Train Loss: 0.0728105 Vali Loss: 0.1913422 Test Loss: 0.2732029
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 43 cost time: 0.9018666744232178
Epoch: 43, Steps: 64 | Train Loss: 0.0728052 Vali Loss: 0.1918021 Test Loss: 0.2729748
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 44 cost time: 0.9023752212524414
Epoch: 44, Steps: 64 | Train Loss: 0.0727939 Vali Loss: 0.1910306 Test Loss: 0.2728635
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 45 cost time: 0.9034733772277832
Epoch: 45, Steps: 64 | Train Loss: 0.0726174 Vali Loss: 0.1936874 Test Loss: 0.2738796
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 46 cost time: 0.8952257633209229
Epoch: 46, Steps: 64 | Train Loss: 0.0724288 Vali Loss: 0.1925811 Test Loss: 0.2738698
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 47 cost time: 0.9030005931854248
Epoch: 47, Steps: 64 | Train Loss: 0.0723096 Vali Loss: 0.1912900 Test Loss: 0.2730809
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 48 cost time: 0.9151608943939209
Epoch: 48, Steps: 64 | Train Loss: 0.0724008 Vali Loss: 0.1903382 Test Loss: 0.2727250
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 49 cost time: 0.9064712524414062
Epoch: 49, Steps: 64 | Train Loss: 0.0727244 Vali Loss: 0.1928229 Test Loss: 0.2735620
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 50 cost time: 0.9090762138366699
Epoch: 50, Steps: 64 | Train Loss: 0.0725109 Vali Loss: 0.1925788 Test Loss: 0.2727143
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 51 cost time: 0.8993496894836426
Epoch: 51, Steps: 64 | Train Loss: 0.0727481 Vali Loss: 0.1912204 Test Loss: 0.2726670
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 52 cost time: 0.9018468856811523
Epoch: 52, Steps: 64 | Train Loss: 0.0723899 Vali Loss: 0.1942536 Test Loss: 0.2727802
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 53 cost time: 0.8999996185302734
Epoch: 53, Steps: 64 | Train Loss: 0.0727709 Vali Loss: 0.1874875 Test Loss: 0.2727027
Validation loss decreased (0.190127 --> 0.187487).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 54 cost time: 0.8964560031890869
Epoch: 54, Steps: 64 | Train Loss: 0.0727147 Vali Loss: 0.1921268 Test Loss: 0.2726980
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 55 cost time: 0.8996214866638184
Epoch: 55, Steps: 64 | Train Loss: 0.0724921 Vali Loss: 0.1896377 Test Loss: 0.2724362
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 56 cost time: 0.9243564605712891
Epoch: 56, Steps: 64 | Train Loss: 0.0725398 Vali Loss: 0.1900649 Test Loss: 0.2729903
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 57 cost time: 0.9093806743621826
Epoch: 57, Steps: 64 | Train Loss: 0.0728003 Vali Loss: 0.1913295 Test Loss: 0.2730276
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 58 cost time: 0.9048285484313965
Epoch: 58, Steps: 64 | Train Loss: 0.0727264 Vali Loss: 0.1899994 Test Loss: 0.2732317
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 59 cost time: 0.9131331443786621
Epoch: 59, Steps: 64 | Train Loss: 0.0725146 Vali Loss: 0.1914449 Test Loss: 0.2727006
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 60 cost time: 0.8980002403259277
Epoch: 60, Steps: 64 | Train Loss: 0.0722068 Vali Loss: 0.1912151 Test Loss: 0.2729099
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.27270275354385376, mae:0.3365320861339569, rse:0.23967213928699493
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.049631595611572266 GB
Epoch: 1 cost time: 2.3246028423309326
Epoch: 1, Steps: 64 | Train Loss: 0.7935903 Vali Loss: 2.0314584 Test Loss: 3.5361562
Validation loss decreased (inf --> 2.031458).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 2 cost time: 0.9346160888671875
Epoch: 2, Steps: 64 | Train Loss: 0.4464260 Vali Loss: 0.5246664 Test Loss: 0.7172247
Validation loss decreased (2.031458 --> 0.524666).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 3 cost time: 0.9293854236602783
Epoch: 3, Steps: 64 | Train Loss: 0.2147995 Vali Loss: 0.3403234 Test Loss: 0.3994368
Validation loss decreased (0.524666 --> 0.340323).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 4 cost time: 0.9314918518066406
Epoch: 4, Steps: 64 | Train Loss: 0.1577350 Vali Loss: 0.2811488 Test Loss: 0.3213009
Validation loss decreased (0.340323 --> 0.281149).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 5 cost time: 0.9269523620605469
Epoch: 5, Steps: 64 | Train Loss: 0.1359269 Vali Loss: 0.2602555 Test Loss: 0.3101923
Validation loss decreased (0.281149 --> 0.260256).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 6 cost time: 0.9107520580291748
Epoch: 6, Steps: 64 | Train Loss: 0.1287445 Vali Loss: 0.2512518 Test Loss: 0.3018774
Validation loss decreased (0.260256 --> 0.251252).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 7 cost time: 0.9237866401672363
Epoch: 7, Steps: 64 | Train Loss: 0.1220991 Vali Loss: 0.2458828 Test Loss: 0.3004847
Validation loss decreased (0.251252 --> 0.245883).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 8 cost time: 0.9214112758636475
Epoch: 8, Steps: 64 | Train Loss: 0.1172610 Vali Loss: 0.2413978 Test Loss: 0.2953194
Validation loss decreased (0.245883 --> 0.241398).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 9 cost time: 0.9296150207519531
Epoch: 9, Steps: 64 | Train Loss: 0.1128400 Vali Loss: 0.2400739 Test Loss: 0.2980793
Validation loss decreased (0.241398 --> 0.240074).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 10 cost time: 0.9265115261077881
Epoch: 10, Steps: 64 | Train Loss: 0.1109905 Vali Loss: 0.2376308 Test Loss: 0.2957568
Validation loss decreased (0.240074 --> 0.237631).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 11 cost time: 0.9243776798248291
Epoch: 11, Steps: 64 | Train Loss: 0.1090114 Vali Loss: 0.2354321 Test Loss: 0.2957587
Validation loss decreased (0.237631 --> 0.235432).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 12 cost time: 0.9301776885986328
Epoch: 12, Steps: 64 | Train Loss: 0.1074314 Vali Loss: 0.2312091 Test Loss: 0.2922369
Validation loss decreased (0.235432 --> 0.231209).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 13 cost time: 0.9373161792755127
Epoch: 13, Steps: 64 | Train Loss: 0.1046511 Vali Loss: 0.2320663 Test Loss: 0.2936922
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 14 cost time: 0.923736572265625
Epoch: 14, Steps: 64 | Train Loss: 0.1037457 Vali Loss: 0.2298632 Test Loss: 0.2932813
Validation loss decreased (0.231209 --> 0.229863).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 15 cost time: 0.9259998798370361
Epoch: 15, Steps: 64 | Train Loss: 0.1016937 Vali Loss: 0.2272522 Test Loss: 0.2908339
Validation loss decreased (0.229863 --> 0.227252).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 16 cost time: 0.9426267147064209
Epoch: 16, Steps: 64 | Train Loss: 0.1015514 Vali Loss: 0.2282203 Test Loss: 0.2899320
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 17 cost time: 0.9318313598632812
Epoch: 17, Steps: 64 | Train Loss: 0.1011191 Vali Loss: 0.2238357 Test Loss: 0.2905668
Validation loss decreased (0.227252 --> 0.223836).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 18 cost time: 0.9403419494628906
Epoch: 18, Steps: 64 | Train Loss: 0.0996125 Vali Loss: 0.2242211 Test Loss: 0.2904834
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 19 cost time: 0.9513673782348633
Epoch: 19, Steps: 64 | Train Loss: 0.0989411 Vali Loss: 0.2250056 Test Loss: 0.2893678
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 20 cost time: 0.9433314800262451
Epoch: 20, Steps: 64 | Train Loss: 0.0982746 Vali Loss: 0.2223973 Test Loss: 0.2902423
Validation loss decreased (0.223836 --> 0.222397).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 21 cost time: 0.9531445503234863
Epoch: 21, Steps: 64 | Train Loss: 0.0971118 Vali Loss: 0.2233816 Test Loss: 0.2883404
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 22 cost time: 0.9507699012756348
Epoch: 22, Steps: 64 | Train Loss: 0.0975377 Vali Loss: 0.2218068 Test Loss: 0.2881731
Validation loss decreased (0.222397 --> 0.221807).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 23 cost time: 0.9331068992614746
Epoch: 23, Steps: 64 | Train Loss: 0.0972455 Vali Loss: 0.2204195 Test Loss: 0.2897513
Validation loss decreased (0.221807 --> 0.220419).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 24 cost time: 0.9180002212524414
Epoch: 24, Steps: 64 | Train Loss: 0.0971807 Vali Loss: 0.2207654 Test Loss: 0.2868906
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 25 cost time: 0.923609733581543
Epoch: 25, Steps: 64 | Train Loss: 0.0963727 Vali Loss: 0.2200354 Test Loss: 0.2864949
Validation loss decreased (0.220419 --> 0.220035).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 26 cost time: 0.9386286735534668
Epoch: 26, Steps: 64 | Train Loss: 0.0953218 Vali Loss: 0.2213598 Test Loss: 0.2863211
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 27 cost time: 0.9263956546783447
Epoch: 27, Steps: 64 | Train Loss: 0.0950020 Vali Loss: 0.2183648 Test Loss: 0.2872250
Validation loss decreased (0.220035 --> 0.218365).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 28 cost time: 0.9283525943756104
Epoch: 28, Steps: 64 | Train Loss: 0.0948822 Vali Loss: 0.2186131 Test Loss: 0.2863557
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 29 cost time: 0.9269273281097412
Epoch: 29, Steps: 64 | Train Loss: 0.0947091 Vali Loss: 0.2180995 Test Loss: 0.2874976
Validation loss decreased (0.218365 --> 0.218099).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 30 cost time: 0.9354028701782227
Epoch: 30, Steps: 64 | Train Loss: 0.0946307 Vali Loss: 0.2148280 Test Loss: 0.2875871
Validation loss decreased (0.218099 --> 0.214828).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 31 cost time: 0.9270000457763672
Epoch: 31, Steps: 64 | Train Loss: 0.0940192 Vali Loss: 0.2183762 Test Loss: 0.2861288
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 32 cost time: 0.9250001907348633
Epoch: 32, Steps: 64 | Train Loss: 0.0940813 Vali Loss: 0.2185233 Test Loss: 0.2867015
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 33 cost time: 0.939629077911377
Epoch: 33, Steps: 64 | Train Loss: 0.0941500 Vali Loss: 0.2188367 Test Loss: 0.2862720
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 34 cost time: 0.9179127216339111
Epoch: 34, Steps: 64 | Train Loss: 0.0935337 Vali Loss: 0.2189133 Test Loss: 0.2869186
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 35 cost time: 0.9220614433288574
Epoch: 35, Steps: 64 | Train Loss: 0.0938934 Vali Loss: 0.2148220 Test Loss: 0.2855407
Validation loss decreased (0.214828 --> 0.214822).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 36 cost time: 0.9263653755187988
Epoch: 36, Steps: 64 | Train Loss: 0.0935113 Vali Loss: 0.2147048 Test Loss: 0.2861717
Validation loss decreased (0.214822 --> 0.214705).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 37 cost time: 0.946601152420044
Epoch: 37, Steps: 64 | Train Loss: 0.0929344 Vali Loss: 0.2157573 Test Loss: 0.2874046
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 38 cost time: 0.926720380783081
Epoch: 38, Steps: 64 | Train Loss: 0.0934561 Vali Loss: 0.2148503 Test Loss: 0.2853254
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 39 cost time: 0.9324171543121338
Epoch: 39, Steps: 64 | Train Loss: 0.0933243 Vali Loss: 0.2177379 Test Loss: 0.2860323
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 40 cost time: 0.9416420459747314
Epoch: 40, Steps: 64 | Train Loss: 0.0927219 Vali Loss: 0.2151451 Test Loss: 0.2863570
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 41 cost time: 0.9316256046295166
Epoch: 41, Steps: 64 | Train Loss: 0.0926979 Vali Loss: 0.2169462 Test Loss: 0.2855761
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 42 cost time: 0.9425907135009766
Epoch: 42, Steps: 64 | Train Loss: 0.0928092 Vali Loss: 0.2151190 Test Loss: 0.2865423
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 43 cost time: 0.9473927021026611
Epoch: 43, Steps: 64 | Train Loss: 0.0931981 Vali Loss: 0.2141931 Test Loss: 0.2870884
Validation loss decreased (0.214705 --> 0.214193).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 44 cost time: 0.9233701229095459
Epoch: 44, Steps: 64 | Train Loss: 0.0928515 Vali Loss: 0.2165213 Test Loss: 0.2859075
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 45 cost time: 0.9523472785949707
Epoch: 45, Steps: 64 | Train Loss: 0.0925166 Vali Loss: 0.2161534 Test Loss: 0.2860326
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 46 cost time: 0.9492931365966797
Epoch: 46, Steps: 64 | Train Loss: 0.0931270 Vali Loss: 0.2121633 Test Loss: 0.2849507
Validation loss decreased (0.214193 --> 0.212163).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 47 cost time: 0.9283113479614258
Epoch: 47, Steps: 64 | Train Loss: 0.0926040 Vali Loss: 0.2138924 Test Loss: 0.2850723
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 48 cost time: 0.973024845123291
Epoch: 48, Steps: 64 | Train Loss: 0.0926628 Vali Loss: 0.2142085 Test Loss: 0.2864939
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 49 cost time: 0.9425909519195557
Epoch: 49, Steps: 64 | Train Loss: 0.0928733 Vali Loss: 0.2132546 Test Loss: 0.2874607
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 50 cost time: 0.9493312835693359
Epoch: 50, Steps: 64 | Train Loss: 0.0924928 Vali Loss: 0.2138500 Test Loss: 0.2851037
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 51 cost time: 0.926102876663208
Epoch: 51, Steps: 64 | Train Loss: 0.0921405 Vali Loss: 0.2148692 Test Loss: 0.2855642
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 52 cost time: 0.9450042247772217
Epoch: 52, Steps: 64 | Train Loss: 0.0923041 Vali Loss: 0.2143012 Test Loss: 0.2851505
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 53 cost time: 0.9513089656829834
Epoch: 53, Steps: 64 | Train Loss: 0.0925084 Vali Loss: 0.2149965 Test Loss: 0.2856577
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 54 cost time: 0.9578030109405518
Epoch: 54, Steps: 64 | Train Loss: 0.0924173 Vali Loss: 0.2129655 Test Loss: 0.2864303
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 55 cost time: 0.9487426280975342
Epoch: 55, Steps: 64 | Train Loss: 0.0934811 Vali Loss: 0.2141405 Test Loss: 0.2861554
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 56 cost time: 0.9519639015197754
Epoch: 56, Steps: 64 | Train Loss: 0.0925902 Vali Loss: 0.2144856 Test Loss: 0.2863871
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 57 cost time: 0.9616081714630127
Epoch: 57, Steps: 64 | Train Loss: 0.0925592 Vali Loss: 0.2165215 Test Loss: 0.2864236
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 58 cost time: 0.9426040649414062
Epoch: 58, Steps: 64 | Train Loss: 0.0922993 Vali Loss: 0.2168486 Test Loss: 0.2863858
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 59 cost time: 0.9463417530059814
Epoch: 59, Steps: 64 | Train Loss: 0.0925673 Vali Loss: 0.2150607 Test Loss: 0.2855206
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 60 cost time: 0.9459249973297119
Epoch: 60, Steps: 64 | Train Loss: 0.0922488 Vali Loss: 0.2150860 Test Loss: 0.2853946
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2849506735801697, mae:0.3447500765323639, rse:0.24499525129795074
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05106353759765625 GB
Epoch: 1 cost time: 2.4089930057525635
Epoch: 1, Steps: 64 | Train Loss: 0.9032204 Vali Loss: 2.6937416 Test Loss: 4.5811830
Validation loss decreased (inf --> 2.693742).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 2 cost time: 0.9276773929595947
Epoch: 2, Steps: 64 | Train Loss: 0.5245272 Vali Loss: 0.7495353 Test Loss: 0.9864687
Validation loss decreased (2.693742 --> 0.749535).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 3 cost time: 0.9623711109161377
Epoch: 3, Steps: 64 | Train Loss: 0.1811732 Vali Loss: 0.3389565 Test Loss: 0.3461493
Validation loss decreased (0.749535 --> 0.338957).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 4 cost time: 0.955148458480835
Epoch: 4, Steps: 64 | Train Loss: 0.1139365 Vali Loss: 0.2453017 Test Loss: 0.2828226
Validation loss decreased (0.338957 --> 0.245302).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 5 cost time: 0.9592370986938477
Epoch: 5, Steps: 64 | Train Loss: 0.1004456 Vali Loss: 0.2345028 Test Loss: 0.2799329
Validation loss decreased (0.245302 --> 0.234503).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 6 cost time: 0.9554033279418945
Epoch: 6, Steps: 64 | Train Loss: 0.0961338 Vali Loss: 0.2263685 Test Loss: 0.2819350
Validation loss decreased (0.234503 --> 0.226368).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 7 cost time: 0.9624042510986328
Epoch: 7, Steps: 64 | Train Loss: 0.0928425 Vali Loss: 0.2219104 Test Loss: 0.2825633
Validation loss decreased (0.226368 --> 0.221910).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 8 cost time: 0.9516191482543945
Epoch: 8, Steps: 64 | Train Loss: 0.0902879 Vali Loss: 0.2199687 Test Loss: 0.2793625
Validation loss decreased (0.221910 --> 0.219969).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 9 cost time: 0.9552419185638428
Epoch: 9, Steps: 64 | Train Loss: 0.0886178 Vali Loss: 0.2141927 Test Loss: 0.2811379
Validation loss decreased (0.219969 --> 0.214193).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 10 cost time: 0.9733564853668213
Epoch: 10, Steps: 64 | Train Loss: 0.0873613 Vali Loss: 0.2171275 Test Loss: 0.2812397
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 11 cost time: 1.0473663806915283
Epoch: 11, Steps: 64 | Train Loss: 0.0863865 Vali Loss: 0.2120384 Test Loss: 0.2786325
Validation loss decreased (0.214193 --> 0.212038).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 12 cost time: 1.046372652053833
Epoch: 12, Steps: 64 | Train Loss: 0.0847541 Vali Loss: 0.2105656 Test Loss: 0.2803091
Validation loss decreased (0.212038 --> 0.210566).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 13 cost time: 0.9664332866668701
Epoch: 13, Steps: 64 | Train Loss: 0.0841515 Vali Loss: 0.2075306 Test Loss: 0.2793585
Validation loss decreased (0.210566 --> 0.207531).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 14 cost time: 0.9534378051757812
Epoch: 14, Steps: 64 | Train Loss: 0.0828451 Vali Loss: 0.2040694 Test Loss: 0.2788783
Validation loss decreased (0.207531 --> 0.204069).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 15 cost time: 0.9563601016998291
Epoch: 15, Steps: 64 | Train Loss: 0.0828641 Vali Loss: 0.2067843 Test Loss: 0.2779906
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 16 cost time: 0.9563601016998291
Epoch: 16, Steps: 64 | Train Loss: 0.0823269 Vali Loss: 0.2038656 Test Loss: 0.2790134
Validation loss decreased (0.204069 --> 0.203866).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 17 cost time: 0.9664885997772217
Epoch: 17, Steps: 64 | Train Loss: 0.0811368 Vali Loss: 0.2057156 Test Loss: 0.2766778
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 18 cost time: 0.9662339687347412
Epoch: 18, Steps: 64 | Train Loss: 0.0806801 Vali Loss: 0.2027532 Test Loss: 0.2762075
Validation loss decreased (0.203866 --> 0.202753).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 19 cost time: 0.9666221141815186
Epoch: 19, Steps: 64 | Train Loss: 0.0800545 Vali Loss: 0.1985887 Test Loss: 0.2774138
Validation loss decreased (0.202753 --> 0.198589).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 20 cost time: 0.970142126083374
Epoch: 20, Steps: 64 | Train Loss: 0.0793571 Vali Loss: 0.1967112 Test Loss: 0.2759920
Validation loss decreased (0.198589 --> 0.196711).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 21 cost time: 0.9622375965118408
Epoch: 21, Steps: 64 | Train Loss: 0.0800851 Vali Loss: 0.1972376 Test Loss: 0.2746008
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 22 cost time: 0.962369441986084
Epoch: 22, Steps: 64 | Train Loss: 0.0795609 Vali Loss: 0.2005963 Test Loss: 0.2761633
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 23 cost time: 0.964367151260376
Epoch: 23, Steps: 64 | Train Loss: 0.0790542 Vali Loss: 0.1967300 Test Loss: 0.2768400
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 24 cost time: 0.9574458599090576
Epoch: 24, Steps: 64 | Train Loss: 0.0784876 Vali Loss: 0.2002017 Test Loss: 0.2746390
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 25 cost time: 0.9568328857421875
Epoch: 25, Steps: 64 | Train Loss: 0.0784131 Vali Loss: 0.1965193 Test Loss: 0.2746915
Validation loss decreased (0.196711 --> 0.196519).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 26 cost time: 0.9557671546936035
Epoch: 26, Steps: 64 | Train Loss: 0.0787790 Vali Loss: 0.1972896 Test Loss: 0.2749012
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 27 cost time: 0.9579997062683105
Epoch: 27, Steps: 64 | Train Loss: 0.0778059 Vali Loss: 0.1959739 Test Loss: 0.2756747
Validation loss decreased (0.196519 --> 0.195974).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 28 cost time: 0.9595141410827637
Epoch: 28, Steps: 64 | Train Loss: 0.0775385 Vali Loss: 0.1962305 Test Loss: 0.2744979
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 29 cost time: 0.9642512798309326
Epoch: 29, Steps: 64 | Train Loss: 0.0776026 Vali Loss: 0.1946317 Test Loss: 0.2749618
Validation loss decreased (0.195974 --> 0.194632).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 30 cost time: 0.9773476123809814
Epoch: 30, Steps: 64 | Train Loss: 0.0775486 Vali Loss: 0.1961762 Test Loss: 0.2758925
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 31 cost time: 0.9583959579467773
Epoch: 31, Steps: 64 | Train Loss: 0.0778012 Vali Loss: 0.1952127 Test Loss: 0.2744671
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 32 cost time: 0.9533681869506836
Epoch: 32, Steps: 64 | Train Loss: 0.0773252 Vali Loss: 0.1921204 Test Loss: 0.2745510
Validation loss decreased (0.194632 --> 0.192120).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 33 cost time: 0.9560086727142334
Epoch: 33, Steps: 64 | Train Loss: 0.0774262 Vali Loss: 0.1967867 Test Loss: 0.2743247
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 34 cost time: 0.9601767063140869
Epoch: 34, Steps: 64 | Train Loss: 0.0767972 Vali Loss: 0.1934438 Test Loss: 0.2737999
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 35 cost time: 0.956721305847168
Epoch: 35, Steps: 64 | Train Loss: 0.0777309 Vali Loss: 0.1924407 Test Loss: 0.2737863
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 36 cost time: 0.9647316932678223
Epoch: 36, Steps: 64 | Train Loss: 0.0767520 Vali Loss: 0.1937164 Test Loss: 0.2755674
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 37 cost time: 0.9703540802001953
Epoch: 37, Steps: 64 | Train Loss: 0.0767826 Vali Loss: 0.1944992 Test Loss: 0.2730636
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 38 cost time: 0.9676163196563721
Epoch: 38, Steps: 64 | Train Loss: 0.0769227 Vali Loss: 0.1952699 Test Loss: 0.2744667
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 39 cost time: 0.9596037864685059
Epoch: 39, Steps: 64 | Train Loss: 0.0763350 Vali Loss: 0.1919418 Test Loss: 0.2739977
Validation loss decreased (0.192120 --> 0.191942).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 40 cost time: 0.9544632434844971
Epoch: 40, Steps: 64 | Train Loss: 0.0763480 Vali Loss: 0.1938874 Test Loss: 0.2734984
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 41 cost time: 0.9549846649169922
Epoch: 41, Steps: 64 | Train Loss: 0.0768188 Vali Loss: 0.1947787 Test Loss: 0.2750102
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 42 cost time: 0.9543371200561523
Epoch: 42, Steps: 64 | Train Loss: 0.0765783 Vali Loss: 0.1927539 Test Loss: 0.2740820
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 43 cost time: 0.9524331092834473
Epoch: 43, Steps: 64 | Train Loss: 0.0767544 Vali Loss: 0.1913027 Test Loss: 0.2733382
Validation loss decreased (0.191942 --> 0.191303).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 44 cost time: 0.9261035919189453
Epoch: 44, Steps: 64 | Train Loss: 0.0770001 Vali Loss: 0.1920664 Test Loss: 0.2737652
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 45 cost time: 0.9384393692016602
Epoch: 45, Steps: 64 | Train Loss: 0.0769099 Vali Loss: 0.1929556 Test Loss: 0.2744319
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 46 cost time: 0.9639997482299805
Epoch: 46, Steps: 64 | Train Loss: 0.0765900 Vali Loss: 0.1913401 Test Loss: 0.2726847
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 47 cost time: 0.9584357738494873
Epoch: 47, Steps: 64 | Train Loss: 0.0764059 Vali Loss: 0.1943981 Test Loss: 0.2740374
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 48 cost time: 0.9226198196411133
Epoch: 48, Steps: 64 | Train Loss: 0.0765968 Vali Loss: 0.1928545 Test Loss: 0.2741838
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 49 cost time: 0.9531772136688232
Epoch: 49, Steps: 64 | Train Loss: 0.0765658 Vali Loss: 0.1896410 Test Loss: 0.2745343
Validation loss decreased (0.191303 --> 0.189641).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 50 cost time: 0.9583239555358887
Epoch: 50, Steps: 64 | Train Loss: 0.0763626 Vali Loss: 0.1913630 Test Loss: 0.2726506
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 51 cost time: 0.953026294708252
Epoch: 51, Steps: 64 | Train Loss: 0.0768367 Vali Loss: 0.1916942 Test Loss: 0.2740481
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 52 cost time: 0.955359697341919
Epoch: 52, Steps: 64 | Train Loss: 0.0763326 Vali Loss: 0.1914343 Test Loss: 0.2729766
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 53 cost time: 0.9707803726196289
Epoch: 53, Steps: 64 | Train Loss: 0.0766794 Vali Loss: 0.1915015 Test Loss: 0.2737439
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 54 cost time: 0.9703278541564941
Epoch: 54, Steps: 64 | Train Loss: 0.0762872 Vali Loss: 0.1909348 Test Loss: 0.2740796
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 55 cost time: 0.9719998836517334
Epoch: 55, Steps: 64 | Train Loss: 0.0765378 Vali Loss: 0.1947058 Test Loss: 0.2743636
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 56 cost time: 0.9730000495910645
Epoch: 56, Steps: 64 | Train Loss: 0.0762547 Vali Loss: 0.1930054 Test Loss: 0.2738383
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 57 cost time: 0.9746248722076416
Epoch: 57, Steps: 64 | Train Loss: 0.0768414 Vali Loss: 0.1923872 Test Loss: 0.2739463
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 58 cost time: 0.9666166305541992
Epoch: 58, Steps: 64 | Train Loss: 0.0766634 Vali Loss: 0.1938309 Test Loss: 0.2734329
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 59 cost time: 0.9654138088226318
Epoch: 59, Steps: 64 | Train Loss: 0.0767005 Vali Loss: 0.1950556 Test Loss: 0.2727796
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 60 cost time: 0.969477653503418
Epoch: 60, Steps: 64 | Train Loss: 0.0765073 Vali Loss: 0.1918472 Test Loss: 0.2742426
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2745342552661896, mae:0.3361521065235138, rse:0.2404756247997284
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.05218362808227539 GB
Epoch: 1 cost time: 2.2850987911224365
Epoch: 1, Steps: 64 | Train Loss: 0.8087601 Vali Loss: 2.4833052 Test Loss: 4.3470469
Validation loss decreased (inf --> 2.483305).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 2 cost time: 0.9153881072998047
Epoch: 2, Steps: 64 | Train Loss: 0.5046093 Vali Loss: 0.7277557 Test Loss: 1.0148218
Validation loss decreased (2.483305 --> 0.727756).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 3 cost time: 0.9157381057739258
Epoch: 3, Steps: 64 | Train Loss: 0.1603890 Vali Loss: 0.2840866 Test Loss: 0.3338172
Validation loss decreased (0.727756 --> 0.284087).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 4 cost time: 0.9030003547668457
Epoch: 4, Steps: 64 | Train Loss: 0.1092166 Vali Loss: 0.2468776 Test Loss: 0.3179644
Validation loss decreased (0.284087 --> 0.246878).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 5 cost time: 0.9126262664794922
Epoch: 5, Steps: 64 | Train Loss: 0.0990088 Vali Loss: 0.2336517 Test Loss: 0.2992645
Validation loss decreased (0.246878 --> 0.233652).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 6 cost time: 0.9126605987548828
Epoch: 6, Steps: 64 | Train Loss: 0.0937170 Vali Loss: 0.2276910 Test Loss: 0.3009700
Validation loss decreased (0.233652 --> 0.227691).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 7 cost time: 0.9072279930114746
Epoch: 7, Steps: 64 | Train Loss: 0.0905209 Vali Loss: 0.2251006 Test Loss: 0.2863031
Validation loss decreased (0.227691 --> 0.225101).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 8 cost time: 0.9050147533416748
Epoch: 8, Steps: 64 | Train Loss: 0.0881621 Vali Loss: 0.2170788 Test Loss: 0.2896867
Validation loss decreased (0.225101 --> 0.217079).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 9 cost time: 0.9123637676239014
Epoch: 9, Steps: 64 | Train Loss: 0.0862662 Vali Loss: 0.2146062 Test Loss: 0.2869387
Validation loss decreased (0.217079 --> 0.214606).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 10 cost time: 0.9249331951141357
Epoch: 10, Steps: 64 | Train Loss: 0.0849003 Vali Loss: 0.2100408 Test Loss: 0.2876971
Validation loss decreased (0.214606 --> 0.210041).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 11 cost time: 0.9285249710083008
Epoch: 11, Steps: 64 | Train Loss: 0.0832889 Vali Loss: 0.2124909 Test Loss: 0.2821697
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 12 cost time: 0.9232470989227295
Epoch: 12, Steps: 64 | Train Loss: 0.0823740 Vali Loss: 0.2078675 Test Loss: 0.2832512
Validation loss decreased (0.210041 --> 0.207867).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 13 cost time: 0.9265298843383789
Epoch: 13, Steps: 64 | Train Loss: 0.0812700 Vali Loss: 0.2065360 Test Loss: 0.2833089
Validation loss decreased (0.207867 --> 0.206536).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 14 cost time: 0.9343175888061523
Epoch: 14, Steps: 64 | Train Loss: 0.0796720 Vali Loss: 0.1997297 Test Loss: 0.2772132
Validation loss decreased (0.206536 --> 0.199730).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 15 cost time: 0.9293570518493652
Epoch: 15, Steps: 64 | Train Loss: 0.0791007 Vali Loss: 0.2023193 Test Loss: 0.2798703
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 16 cost time: 0.9229791164398193
Epoch: 16, Steps: 64 | Train Loss: 0.0786279 Vali Loss: 0.1990226 Test Loss: 0.2771908
Validation loss decreased (0.199730 --> 0.199023).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 17 cost time: 0.926508903503418
Epoch: 17, Steps: 64 | Train Loss: 0.0783405 Vali Loss: 0.1977617 Test Loss: 0.2761995
Validation loss decreased (0.199023 --> 0.197762).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 18 cost time: 0.9326162338256836
Epoch: 18, Steps: 64 | Train Loss: 0.0779931 Vali Loss: 0.1996339 Test Loss: 0.2772191
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 19 cost time: 0.9409999847412109
Epoch: 19, Steps: 64 | Train Loss: 0.0776707 Vali Loss: 0.1978730 Test Loss: 0.2766570
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 20 cost time: 0.9416205883026123
Epoch: 20, Steps: 64 | Train Loss: 0.0771906 Vali Loss: 0.1966011 Test Loss: 0.2762567
Validation loss decreased (0.197762 --> 0.196601).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 21 cost time: 0.9474406242370605
Epoch: 21, Steps: 64 | Train Loss: 0.0765074 Vali Loss: 0.1927845 Test Loss: 0.2744516
Validation loss decreased (0.196601 --> 0.192785).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 22 cost time: 0.9223713874816895
Epoch: 22, Steps: 64 | Train Loss: 0.0762615 Vali Loss: 0.1940680 Test Loss: 0.2741416
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 23 cost time: 0.8888571262359619
Epoch: 23, Steps: 64 | Train Loss: 0.0759772 Vali Loss: 0.1938619 Test Loss: 0.2745135
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 24 cost time: 0.9223132133483887
Epoch: 24, Steps: 64 | Train Loss: 0.0756221 Vali Loss: 0.1932807 Test Loss: 0.2728679
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 25 cost time: 0.8767759799957275
Epoch: 25, Steps: 64 | Train Loss: 0.0753086 Vali Loss: 0.1904298 Test Loss: 0.2715604
Validation loss decreased (0.192785 --> 0.190430).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 26 cost time: 0.881434440612793
Epoch: 26, Steps: 64 | Train Loss: 0.0750430 Vali Loss: 0.1897717 Test Loss: 0.2735746
Validation loss decreased (0.190430 --> 0.189772).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 27 cost time: 0.9206202030181885
Epoch: 27, Steps: 64 | Train Loss: 0.0752288 Vali Loss: 0.1902551 Test Loss: 0.2698313
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 28 cost time: 0.9313936233520508
Epoch: 28, Steps: 64 | Train Loss: 0.0750147 Vali Loss: 0.1922235 Test Loss: 0.2713342
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 29 cost time: 0.9200315475463867
Epoch: 29, Steps: 64 | Train Loss: 0.0745473 Vali Loss: 0.1902858 Test Loss: 0.2720256
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 30 cost time: 0.9244272708892822
Epoch: 30, Steps: 64 | Train Loss: 0.0742857 Vali Loss: 0.1898122 Test Loss: 0.2715521
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 31 cost time: 0.9127159118652344
Epoch: 31, Steps: 64 | Train Loss: 0.0739791 Vali Loss: 0.1901514 Test Loss: 0.2703090
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 32 cost time: 0.9097938537597656
Epoch: 32, Steps: 64 | Train Loss: 0.0740592 Vali Loss: 0.1908457 Test Loss: 0.2705012
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 33 cost time: 0.9109997749328613
Epoch: 33, Steps: 64 | Train Loss: 0.0742117 Vali Loss: 0.1903128 Test Loss: 0.2719010
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 34 cost time: 0.9056222438812256
Epoch: 34, Steps: 64 | Train Loss: 0.0741226 Vali Loss: 0.1903515 Test Loss: 0.2706234
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 35 cost time: 0.9208104610443115
Epoch: 35, Steps: 64 | Train Loss: 0.0743046 Vali Loss: 0.1880874 Test Loss: 0.2708131
Validation loss decreased (0.189772 --> 0.188087).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 36 cost time: 0.9113547801971436
Epoch: 36, Steps: 64 | Train Loss: 0.0741586 Vali Loss: 0.1891862 Test Loss: 0.2713536
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 37 cost time: 0.9163806438446045
Epoch: 37, Steps: 64 | Train Loss: 0.0742787 Vali Loss: 0.1903279 Test Loss: 0.2698309
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 38 cost time: 0.9167296886444092
Epoch: 38, Steps: 64 | Train Loss: 0.0737504 Vali Loss: 0.1893079 Test Loss: 0.2692995
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 39 cost time: 0.9157705307006836
Epoch: 39, Steps: 64 | Train Loss: 0.0737608 Vali Loss: 0.1894739 Test Loss: 0.2695076
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 40 cost time: 0.9130003452301025
Epoch: 40, Steps: 64 | Train Loss: 0.0742932 Vali Loss: 0.1869970 Test Loss: 0.2682652
Validation loss decreased (0.188087 --> 0.186997).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 41 cost time: 0.9066200256347656
Epoch: 41, Steps: 64 | Train Loss: 0.0739875 Vali Loss: 0.1901067 Test Loss: 0.2711608
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 42 cost time: 0.8983964920043945
Epoch: 42, Steps: 64 | Train Loss: 0.0734158 Vali Loss: 0.1904823 Test Loss: 0.2703700
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 43 cost time: 0.9294097423553467
Epoch: 43, Steps: 64 | Train Loss: 0.0739734 Vali Loss: 0.1894993 Test Loss: 0.2706383
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 44 cost time: 0.9287424087524414
Epoch: 44, Steps: 64 | Train Loss: 0.0735363 Vali Loss: 0.1859414 Test Loss: 0.2689445
Validation loss decreased (0.186997 --> 0.185941).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 45 cost time: 0.9313287734985352
Epoch: 45, Steps: 64 | Train Loss: 0.0739030 Vali Loss: 0.1857742 Test Loss: 0.2694572
Validation loss decreased (0.185941 --> 0.185774).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 46 cost time: 0.9377446174621582
Epoch: 46, Steps: 64 | Train Loss: 0.0738376 Vali Loss: 0.1864046 Test Loss: 0.2701583
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 47 cost time: 0.93399977684021
Epoch: 47, Steps: 64 | Train Loss: 0.0735848 Vali Loss: 0.1897773 Test Loss: 0.2708809
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 48 cost time: 0.9289798736572266
Epoch: 48, Steps: 64 | Train Loss: 0.0734038 Vali Loss: 0.1884825 Test Loss: 0.2688275
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 49 cost time: 0.9159543514251709
Epoch: 49, Steps: 64 | Train Loss: 0.0730438 Vali Loss: 0.1871608 Test Loss: 0.2694562
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 50 cost time: 0.885307788848877
Epoch: 50, Steps: 64 | Train Loss: 0.0729257 Vali Loss: 0.1914326 Test Loss: 0.2692232
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 51 cost time: 0.8943705558776855
Epoch: 51, Steps: 64 | Train Loss: 0.0737178 Vali Loss: 0.1888978 Test Loss: 0.2697155
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 52 cost time: 0.9008009433746338
Epoch: 52, Steps: 64 | Train Loss: 0.0736669 Vali Loss: 0.1868676 Test Loss: 0.2688856
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 53 cost time: 0.9233551025390625
Epoch: 53, Steps: 64 | Train Loss: 0.0733622 Vali Loss: 0.1873014 Test Loss: 0.2690488
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 54 cost time: 0.931999683380127
Epoch: 54, Steps: 64 | Train Loss: 0.0737792 Vali Loss: 0.1869232 Test Loss: 0.2711421
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 55 cost time: 0.9315996170043945
Epoch: 55, Steps: 64 | Train Loss: 0.0734673 Vali Loss: 0.1878638 Test Loss: 0.2706506
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 56 cost time: 0.9433267116546631
Epoch: 56, Steps: 64 | Train Loss: 0.0733495 Vali Loss: 0.1882602 Test Loss: 0.2685268
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 57 cost time: 0.9329957962036133
Epoch: 57, Steps: 64 | Train Loss: 0.0735532 Vali Loss: 0.1887833 Test Loss: 0.2683568
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 58 cost time: 0.9333338737487793
Epoch: 58, Steps: 64 | Train Loss: 0.0731755 Vali Loss: 0.1869600 Test Loss: 0.2695068
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 59 cost time: 0.9373347759246826
Epoch: 59, Steps: 64 | Train Loss: 0.0736004 Vali Loss: 0.1866013 Test Loss: 0.2680275
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 60 cost time: 0.9327700138092041
Epoch: 60, Steps: 64 | Train Loss: 0.0731862 Vali Loss: 0.1868500 Test Loss: 0.2709723
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2694571614265442, mae:0.33521968126296997, rse:0.23824164271354675
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.04979372024536133 GB
Epoch: 1 cost time: 2.250105381011963
Epoch: 1, Steps: 64 | Train Loss: 1.2770209 Vali Loss: 3.5431817 Test Loss: 6.0664558
Validation loss decreased (inf --> 3.543182).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 2 cost time: 0.8966095447540283
Epoch: 2, Steps: 64 | Train Loss: 0.7267513 Vali Loss: 1.0243471 Test Loss: 1.5298320
Validation loss decreased (3.543182 --> 1.024347).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 3 cost time: 0.8997237682342529
Epoch: 3, Steps: 64 | Train Loss: 0.3416716 Vali Loss: 0.6045841 Test Loss: 0.8314476
Validation loss decreased (1.024347 --> 0.604584).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 4 cost time: 0.8943383693695068
Epoch: 4, Steps: 64 | Train Loss: 0.2127995 Vali Loss: 0.3647544 Test Loss: 0.4436926
Validation loss decreased (0.604584 --> 0.364754).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 5 cost time: 0.8963625431060791
Epoch: 5, Steps: 64 | Train Loss: 0.1592850 Vali Loss: 0.2997336 Test Loss: 0.3538300
Validation loss decreased (0.364754 --> 0.299734).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 6 cost time: 0.8842136859893799
Epoch: 6, Steps: 64 | Train Loss: 0.1427068 Vali Loss: 0.2728259 Test Loss: 0.3274640
Validation loss decreased (0.299734 --> 0.272826).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 7 cost time: 0.8660004138946533
Epoch: 7, Steps: 64 | Train Loss: 0.1326957 Vali Loss: 0.2531816 Test Loss: 0.3172723
Validation loss decreased (0.272826 --> 0.253182).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 8 cost time: 0.8880000114440918
Epoch: 8, Steps: 64 | Train Loss: 0.1264429 Vali Loss: 0.2509169 Test Loss: 0.3081939
Validation loss decreased (0.253182 --> 0.250917).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 9 cost time: 0.8905982971191406
Epoch: 9, Steps: 64 | Train Loss: 0.1216160 Vali Loss: 0.2438343 Test Loss: 0.3065115
Validation loss decreased (0.250917 --> 0.243834).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 10 cost time: 0.8932678699493408
Epoch: 10, Steps: 64 | Train Loss: 0.1191457 Vali Loss: 0.2377359 Test Loss: 0.2997797
Validation loss decreased (0.243834 --> 0.237736).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 11 cost time: 0.895329475402832
Epoch: 11, Steps: 64 | Train Loss: 0.1167879 Vali Loss: 0.2330781 Test Loss: 0.2991078
Validation loss decreased (0.237736 --> 0.233078).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 12 cost time: 0.8934662342071533
Epoch: 12, Steps: 64 | Train Loss: 0.1135501 Vali Loss: 0.2316491 Test Loss: 0.2959403
Validation loss decreased (0.233078 --> 0.231649).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 13 cost time: 0.8977251052856445
Epoch: 13, Steps: 64 | Train Loss: 0.1122347 Vali Loss: 0.2307034 Test Loss: 0.2973933
Validation loss decreased (0.231649 --> 0.230703).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 14 cost time: 0.8940002918243408
Epoch: 14, Steps: 64 | Train Loss: 0.1107943 Vali Loss: 0.2275175 Test Loss: 0.2946232
Validation loss decreased (0.230703 --> 0.227518).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 15 cost time: 0.890622615814209
Epoch: 15, Steps: 64 | Train Loss: 0.1093361 Vali Loss: 0.2277881 Test Loss: 0.2942458
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 16 cost time: 0.8964436054229736
Epoch: 16, Steps: 64 | Train Loss: 0.1083311 Vali Loss: 0.2271017 Test Loss: 0.2935434
Validation loss decreased (0.227518 --> 0.227102).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 17 cost time: 0.90513014793396
Epoch: 17, Steps: 64 | Train Loss: 0.1075136 Vali Loss: 0.2233433 Test Loss: 0.2932319
Validation loss decreased (0.227102 --> 0.223343).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 18 cost time: 0.8923335075378418
Epoch: 18, Steps: 64 | Train Loss: 0.1063993 Vali Loss: 0.2229654 Test Loss: 0.2936200
Validation loss decreased (0.223343 --> 0.222965).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 19 cost time: 0.8997235298156738
Epoch: 19, Steps: 64 | Train Loss: 0.1050983 Vali Loss: 0.2229173 Test Loss: 0.2931194
Validation loss decreased (0.222965 --> 0.222917).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 20 cost time: 0.8988401889801025
Epoch: 20, Steps: 64 | Train Loss: 0.1046272 Vali Loss: 0.2222117 Test Loss: 0.2925358
Validation loss decreased (0.222917 --> 0.222212).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 21 cost time: 0.8970003128051758
Epoch: 21, Steps: 64 | Train Loss: 0.1038692 Vali Loss: 0.2175536 Test Loss: 0.2920409
Validation loss decreased (0.222212 --> 0.217554).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 22 cost time: 0.8986098766326904
Epoch: 22, Steps: 64 | Train Loss: 0.1030735 Vali Loss: 0.2188794 Test Loss: 0.2916866
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 23 cost time: 0.8844044208526611
Epoch: 23, Steps: 64 | Train Loss: 0.1039053 Vali Loss: 0.2199378 Test Loss: 0.2917045
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 24 cost time: 0.8436784744262695
Epoch: 24, Steps: 64 | Train Loss: 0.1025525 Vali Loss: 0.2184522 Test Loss: 0.2918032
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 25 cost time: 0.8657116889953613
Epoch: 25, Steps: 64 | Train Loss: 0.1018638 Vali Loss: 0.2204339 Test Loss: 0.2909895
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 26 cost time: 0.8700001239776611
Epoch: 26, Steps: 64 | Train Loss: 0.1020280 Vali Loss: 0.2181301 Test Loss: 0.2917766
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 27 cost time: 0.8676114082336426
Epoch: 27, Steps: 64 | Train Loss: 0.1011807 Vali Loss: 0.2185791 Test Loss: 0.2911152
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 28 cost time: 0.8774089813232422
Epoch: 28, Steps: 64 | Train Loss: 0.1014199 Vali Loss: 0.2190607 Test Loss: 0.2910830
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 29 cost time: 0.8740930557250977
Epoch: 29, Steps: 64 | Train Loss: 0.1003929 Vali Loss: 0.2145521 Test Loss: 0.2923483
Validation loss decreased (0.217554 --> 0.214552).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 30 cost time: 0.8783869743347168
Epoch: 30, Steps: 64 | Train Loss: 0.1004682 Vali Loss: 0.2146339 Test Loss: 0.2920180
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 31 cost time: 0.872736930847168
Epoch: 31, Steps: 64 | Train Loss: 0.1000613 Vali Loss: 0.2148631 Test Loss: 0.2904134
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 32 cost time: 0.875999927520752
Epoch: 32, Steps: 64 | Train Loss: 0.0995526 Vali Loss: 0.2163543 Test Loss: 0.2897794
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 33 cost time: 0.8640255928039551
Epoch: 33, Steps: 64 | Train Loss: 0.0996174 Vali Loss: 0.2151532 Test Loss: 0.2916083
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 34 cost time: 0.8703889846801758
Epoch: 34, Steps: 64 | Train Loss: 0.0999996 Vali Loss: 0.2141665 Test Loss: 0.2913003
Validation loss decreased (0.214552 --> 0.214167).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 35 cost time: 0.8793587684631348
Epoch: 35, Steps: 64 | Train Loss: 0.0995109 Vali Loss: 0.2160877 Test Loss: 0.2894955
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 36 cost time: 0.8708596229553223
Epoch: 36, Steps: 64 | Train Loss: 0.0990152 Vali Loss: 0.2114743 Test Loss: 0.2907050
Validation loss decreased (0.214167 --> 0.211474).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 37 cost time: 0.881659984588623
Epoch: 37, Steps: 64 | Train Loss: 0.0988953 Vali Loss: 0.2149381 Test Loss: 0.2917440
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 38 cost time: 0.8783237934112549
Epoch: 38, Steps: 64 | Train Loss: 0.0993114 Vali Loss: 0.2139546 Test Loss: 0.2905378
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 39 cost time: 0.8893837928771973
Epoch: 39, Steps: 64 | Train Loss: 0.0989989 Vali Loss: 0.2132368 Test Loss: 0.2900548
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 40 cost time: 0.8805203437805176
Epoch: 40, Steps: 64 | Train Loss: 0.0983280 Vali Loss: 0.2148530 Test Loss: 0.2898666
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 41 cost time: 0.877460241317749
Epoch: 41, Steps: 64 | Train Loss: 0.0989950 Vali Loss: 0.2140621 Test Loss: 0.2905435
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 42 cost time: 0.8894660472869873
Epoch: 42, Steps: 64 | Train Loss: 0.0983986 Vali Loss: 0.2121374 Test Loss: 0.2902020
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 43 cost time: 0.875
Epoch: 43, Steps: 64 | Train Loss: 0.0981601 Vali Loss: 0.2135205 Test Loss: 0.2905180
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 44 cost time: 0.8756363391876221
Epoch: 44, Steps: 64 | Train Loss: 0.0984669 Vali Loss: 0.2104031 Test Loss: 0.2910343
Validation loss decreased (0.211474 --> 0.210403).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 45 cost time: 0.8634114265441895
Epoch: 45, Steps: 64 | Train Loss: 0.0982951 Vali Loss: 0.2123229 Test Loss: 0.2902059
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 46 cost time: 0.8754053115844727
Epoch: 46, Steps: 64 | Train Loss: 0.0977406 Vali Loss: 0.2115243 Test Loss: 0.2919299
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 47 cost time: 0.8753006458282471
Epoch: 47, Steps: 64 | Train Loss: 0.0988057 Vali Loss: 0.2126827 Test Loss: 0.2898208
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 48 cost time: 0.8717944622039795
Epoch: 48, Steps: 64 | Train Loss: 0.0980114 Vali Loss: 0.2154671 Test Loss: 0.2901779
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 49 cost time: 0.8700001239776611
Epoch: 49, Steps: 64 | Train Loss: 0.0982936 Vali Loss: 0.2122344 Test Loss: 0.2901010
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 50 cost time: 0.8781344890594482
Epoch: 50, Steps: 64 | Train Loss: 0.0985362 Vali Loss: 0.2137845 Test Loss: 0.2891177
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 51 cost time: 0.8693852424621582
Epoch: 51, Steps: 64 | Train Loss: 0.0978820 Vali Loss: 0.2128435 Test Loss: 0.2902319
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 52 cost time: 0.8659799098968506
Epoch: 52, Steps: 64 | Train Loss: 0.0982142 Vali Loss: 0.2130320 Test Loss: 0.2891457
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 53 cost time: 0.8797509670257568
Epoch: 53, Steps: 64 | Train Loss: 0.0983926 Vali Loss: 0.2135046 Test Loss: 0.2894499
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 54 cost time: 0.8250002861022949
Epoch: 54, Steps: 64 | Train Loss: 0.0983706 Vali Loss: 0.2103330 Test Loss: 0.2902662
Validation loss decreased (0.210403 --> 0.210333).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 55 cost time: 0.8331141471862793
Epoch: 55, Steps: 64 | Train Loss: 0.0981602 Vali Loss: 0.2111575 Test Loss: 0.2900189
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 56 cost time: 0.8663527965545654
Epoch: 56, Steps: 64 | Train Loss: 0.0988323 Vali Loss: 0.2125873 Test Loss: 0.2897176
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 57 cost time: 0.888338565826416
Epoch: 57, Steps: 64 | Train Loss: 0.0984995 Vali Loss: 0.2135089 Test Loss: 0.2896035
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 58 cost time: 0.8767087459564209
Epoch: 58, Steps: 64 | Train Loss: 0.0976485 Vali Loss: 0.2125084 Test Loss: 0.2895000
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 59 cost time: 0.876000165939331
Epoch: 59, Steps: 64 | Train Loss: 0.0976366 Vali Loss: 0.2150770 Test Loss: 0.2902753
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 60 cost time: 0.867638349533081
Epoch: 60, Steps: 64 | Train Loss: 0.0977356 Vali Loss: 0.2159576 Test Loss: 0.2895551
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2902661859989166, mae:0.35074764490127563, rse:0.24726976454257965
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05122566223144531 GB
Epoch: 1 cost time: 2.3393070697784424
Epoch: 1, Steps: 64 | Train Loss: 1.0554327 Vali Loss: 3.0616419 Test Loss: 5.5314384
Validation loss decreased (inf --> 3.061642).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 2 cost time: 0.9723386764526367
Epoch: 2, Steps: 64 | Train Loss: 0.5180532 Vali Loss: 0.5866758 Test Loss: 0.8114316
Validation loss decreased (3.061642 --> 0.586676).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 3 cost time: 0.975862979888916
Epoch: 3, Steps: 64 | Train Loss: 0.1557975 Vali Loss: 0.3032030 Test Loss: 0.3288943
Validation loss decreased (0.586676 --> 0.303203).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 4 cost time: 0.9773654937744141
Epoch: 4, Steps: 64 | Train Loss: 0.1123204 Vali Loss: 0.2649147 Test Loss: 0.3031448
Validation loss decreased (0.303203 --> 0.264915).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 5 cost time: 0.9728078842163086
Epoch: 5, Steps: 64 | Train Loss: 0.1046030 Vali Loss: 0.2583233 Test Loss: 0.2996365
Validation loss decreased (0.264915 --> 0.258323).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 6 cost time: 0.9648020267486572
Epoch: 6, Steps: 64 | Train Loss: 0.1011491 Vali Loss: 0.2497595 Test Loss: 0.2942499
Validation loss decreased (0.258323 --> 0.249759).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 7 cost time: 0.9663615226745605
Epoch: 7, Steps: 64 | Train Loss: 0.0971827 Vali Loss: 0.2429983 Test Loss: 0.2892411
Validation loss decreased (0.249759 --> 0.242998).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 8 cost time: 0.9647340774536133
Epoch: 8, Steps: 64 | Train Loss: 0.0946059 Vali Loss: 0.2392246 Test Loss: 0.2878018
Validation loss decreased (0.242998 --> 0.239225).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 9 cost time: 0.9609999656677246
Epoch: 9, Steps: 64 | Train Loss: 0.0928661 Vali Loss: 0.2364409 Test Loss: 0.2863188
Validation loss decreased (0.239225 --> 0.236441).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 10 cost time: 0.9658265113830566
Epoch: 10, Steps: 64 | Train Loss: 0.0919115 Vali Loss: 0.2320064 Test Loss: 0.2861224
Validation loss decreased (0.236441 --> 0.232006).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 11 cost time: 0.9726228713989258
Epoch: 11, Steps: 64 | Train Loss: 0.0899795 Vali Loss: 0.2314304 Test Loss: 0.2836695
Validation loss decreased (0.232006 --> 0.231430).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 12 cost time: 0.9696159362792969
Epoch: 12, Steps: 64 | Train Loss: 0.0891457 Vali Loss: 0.2277383 Test Loss: 0.2829561
Validation loss decreased (0.231430 --> 0.227738).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 13 cost time: 0.9763789176940918
Epoch: 13, Steps: 64 | Train Loss: 0.0881304 Vali Loss: 0.2263527 Test Loss: 0.2820251
Validation loss decreased (0.227738 --> 0.226353).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 14 cost time: 0.9791116714477539
Epoch: 14, Steps: 64 | Train Loss: 0.0872622 Vali Loss: 0.2259081 Test Loss: 0.2799654
Validation loss decreased (0.226353 --> 0.225908).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 15 cost time: 0.9633293151855469
Epoch: 15, Steps: 64 | Train Loss: 0.0861621 Vali Loss: 0.2237591 Test Loss: 0.2806108
Validation loss decreased (0.225908 --> 0.223759).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 16 cost time: 0.9653375148773193
Epoch: 16, Steps: 64 | Train Loss: 0.0855275 Vali Loss: 0.2235422 Test Loss: 0.2786864
Validation loss decreased (0.223759 --> 0.223542).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 17 cost time: 0.9658582210540771
Epoch: 17, Steps: 64 | Train Loss: 0.0853177 Vali Loss: 0.2207571 Test Loss: 0.2786488
Validation loss decreased (0.223542 --> 0.220757).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 18 cost time: 0.9713294506072998
Epoch: 18, Steps: 64 | Train Loss: 0.0842276 Vali Loss: 0.2187861 Test Loss: 0.2778091
Validation loss decreased (0.220757 --> 0.218786).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 19 cost time: 0.969733476638794
Epoch: 19, Steps: 64 | Train Loss: 0.0842424 Vali Loss: 0.2211797 Test Loss: 0.2786883
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 20 cost time: 0.9789113998413086
Epoch: 20, Steps: 64 | Train Loss: 0.0840868 Vali Loss: 0.2127217 Test Loss: 0.2779820
Validation loss decreased (0.218786 --> 0.212722).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 21 cost time: 1.050999402999878
Epoch: 21, Steps: 64 | Train Loss: 0.0831848 Vali Loss: 0.2185479 Test Loss: 0.2772452
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 22 cost time: 0.9627766609191895
Epoch: 22, Steps: 64 | Train Loss: 0.0826507 Vali Loss: 0.2149437 Test Loss: 0.2772287
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 23 cost time: 0.9636282920837402
Epoch: 23, Steps: 64 | Train Loss: 0.0825627 Vali Loss: 0.2158273 Test Loss: 0.2762401
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 24 cost time: 0.9695589542388916
Epoch: 24, Steps: 64 | Train Loss: 0.0823697 Vali Loss: 0.2174259 Test Loss: 0.2765510
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 25 cost time: 0.9623594284057617
Epoch: 25, Steps: 64 | Train Loss: 0.0821048 Vali Loss: 0.2157970 Test Loss: 0.2785357
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 26 cost time: 0.9641866683959961
Epoch: 26, Steps: 64 | Train Loss: 0.0814679 Vali Loss: 0.2139112 Test Loss: 0.2757641
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 27 cost time: 0.9731242656707764
Epoch: 27, Steps: 64 | Train Loss: 0.0815430 Vali Loss: 0.2148492 Test Loss: 0.2754341
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 28 cost time: 1.0514276027679443
Epoch: 28, Steps: 64 | Train Loss: 0.0812548 Vali Loss: 0.2128035 Test Loss: 0.2755217
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 29 cost time: 0.9693281650543213
Epoch: 29, Steps: 64 | Train Loss: 0.0813714 Vali Loss: 0.2101239 Test Loss: 0.2755276
Validation loss decreased (0.212722 --> 0.210124).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 30 cost time: 0.9774329662322998
Epoch: 30, Steps: 64 | Train Loss: 0.0811173 Vali Loss: 0.2130022 Test Loss: 0.2751997
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 31 cost time: 0.9654169082641602
Epoch: 31, Steps: 64 | Train Loss: 0.0812904 Vali Loss: 0.2106788 Test Loss: 0.2749012
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 32 cost time: 0.9620003700256348
Epoch: 32, Steps: 64 | Train Loss: 0.0807333 Vali Loss: 0.2087447 Test Loss: 0.2757472
Validation loss decreased (0.210124 --> 0.208745).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 33 cost time: 0.9684765338897705
Epoch: 33, Steps: 64 | Train Loss: 0.0809424 Vali Loss: 0.2115014 Test Loss: 0.2756902
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 34 cost time: 0.9646291732788086
Epoch: 34, Steps: 64 | Train Loss: 0.0807707 Vali Loss: 0.2111998 Test Loss: 0.2753587
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 35 cost time: 0.9666125774383545
Epoch: 35, Steps: 64 | Train Loss: 0.0804561 Vali Loss: 0.2095609 Test Loss: 0.2746759
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 36 cost time: 0.9743971824645996
Epoch: 36, Steps: 64 | Train Loss: 0.0801145 Vali Loss: 0.2082083 Test Loss: 0.2747633
Validation loss decreased (0.208745 --> 0.208208).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 37 cost time: 0.9764633178710938
Epoch: 37, Steps: 64 | Train Loss: 0.0801771 Vali Loss: 0.2126953 Test Loss: 0.2756445
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 38 cost time: 0.9703435897827148
Epoch: 38, Steps: 64 | Train Loss: 0.0803889 Vali Loss: 0.2077611 Test Loss: 0.2752725
Validation loss decreased (0.208208 --> 0.207761).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 39 cost time: 0.9660022258758545
Epoch: 39, Steps: 64 | Train Loss: 0.0802517 Vali Loss: 0.2090637 Test Loss: 0.2746359
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 40 cost time: 0.9672055244445801
Epoch: 40, Steps: 64 | Train Loss: 0.0795172 Vali Loss: 0.2070597 Test Loss: 0.2746695
Validation loss decreased (0.207761 --> 0.207060).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 41 cost time: 0.9633510112762451
Epoch: 41, Steps: 64 | Train Loss: 0.0795993 Vali Loss: 0.2095126 Test Loss: 0.2752655
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 42 cost time: 0.966742753982544
Epoch: 42, Steps: 64 | Train Loss: 0.0800861 Vali Loss: 0.2095752 Test Loss: 0.2743239
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 43 cost time: 0.9653511047363281
Epoch: 43, Steps: 64 | Train Loss: 0.0799618 Vali Loss: 0.2075953 Test Loss: 0.2744166
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 44 cost time: 0.9586105346679688
Epoch: 44, Steps: 64 | Train Loss: 0.0798182 Vali Loss: 0.2072925 Test Loss: 0.2747210
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 45 cost time: 1.0496461391448975
Epoch: 45, Steps: 64 | Train Loss: 0.0798340 Vali Loss: 0.2093088 Test Loss: 0.2754408
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 46 cost time: 1.0496184825897217
Epoch: 46, Steps: 64 | Train Loss: 0.0798442 Vali Loss: 0.2066663 Test Loss: 0.2748957
Validation loss decreased (0.207060 --> 0.206666).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 47 cost time: 0.9496166706085205
Epoch: 47, Steps: 64 | Train Loss: 0.0798308 Vali Loss: 0.2086283 Test Loss: 0.2731070
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 48 cost time: 0.953371524810791
Epoch: 48, Steps: 64 | Train Loss: 0.0801389 Vali Loss: 0.2059640 Test Loss: 0.2736779
Validation loss decreased (0.206666 --> 0.205964).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 49 cost time: 0.9653563499450684
Epoch: 49, Steps: 64 | Train Loss: 0.0794475 Vali Loss: 0.2040482 Test Loss: 0.2739675
Validation loss decreased (0.205964 --> 0.204048).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 50 cost time: 0.9813530445098877
Epoch: 50, Steps: 64 | Train Loss: 0.0796711 Vali Loss: 0.2057393 Test Loss: 0.2729339
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 51 cost time: 0.9669375419616699
Epoch: 51, Steps: 64 | Train Loss: 0.0799304 Vali Loss: 0.2085308 Test Loss: 0.2736980
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 52 cost time: 0.9693622589111328
Epoch: 52, Steps: 64 | Train Loss: 0.0797027 Vali Loss: 0.2092728 Test Loss: 0.2735202
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 53 cost time: 0.9863970279693604
Epoch: 53, Steps: 64 | Train Loss: 0.0798559 Vali Loss: 0.2110747 Test Loss: 0.2736754
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 54 cost time: 0.9673728942871094
Epoch: 54, Steps: 64 | Train Loss: 0.0798479 Vali Loss: 0.2062263 Test Loss: 0.2740128
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 55 cost time: 0.9713702201843262
Epoch: 55, Steps: 64 | Train Loss: 0.0795370 Vali Loss: 0.2046661 Test Loss: 0.2726669
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 56 cost time: 0.9620001316070557
Epoch: 56, Steps: 64 | Train Loss: 0.0798418 Vali Loss: 0.2070618 Test Loss: 0.2735527
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 57 cost time: 0.9676098823547363
Epoch: 57, Steps: 64 | Train Loss: 0.0792242 Vali Loss: 0.2064320 Test Loss: 0.2738733
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 58 cost time: 0.9631533622741699
Epoch: 58, Steps: 64 | Train Loss: 0.0794452 Vali Loss: 0.2078752 Test Loss: 0.2732864
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 59 cost time: 0.961423397064209
Epoch: 59, Steps: 64 | Train Loss: 0.0794861 Vali Loss: 0.2049658 Test Loss: 0.2739842
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 60 cost time: 0.9819643497467041
Epoch: 60, Steps: 64 | Train Loss: 0.0795359 Vali Loss: 0.2064832 Test Loss: 0.2734568
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2739674746990204, mae:0.3302372395992279, rse:0.24022725224494934
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05234575271606445 GB
Epoch: 1 cost time: 2.352548837661743
Epoch: 1, Steps: 64 | Train Loss: 0.8330165 Vali Loss: 2.5321591 Test Loss: 4.4874759
Validation loss decreased (inf --> 2.532159).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 2 cost time: 0.9930281639099121
Epoch: 2, Steps: 64 | Train Loss: 0.4915059 Vali Loss: 0.6844705 Test Loss: 0.9384186
Validation loss decreased (2.532159 --> 0.684470).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 3 cost time: 1.004164457321167
Epoch: 3, Steps: 64 | Train Loss: 0.1528607 Vali Loss: 0.3209597 Test Loss: 0.3169415
Validation loss decreased (0.684470 --> 0.320960).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 4 cost time: 1.0013577938079834
Epoch: 4, Steps: 64 | Train Loss: 0.1035444 Vali Loss: 0.2667048 Test Loss: 0.2989002
Validation loss decreased (0.320960 --> 0.266705).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 5 cost time: 0.9971952438354492
Epoch: 5, Steps: 64 | Train Loss: 0.0959151 Vali Loss: 0.2508501 Test Loss: 0.2923501
Validation loss decreased (0.266705 --> 0.250850).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 6 cost time: 1.0007975101470947
Epoch: 6, Steps: 64 | Train Loss: 0.0916809 Vali Loss: 0.2400313 Test Loss: 0.2826408
Validation loss decreased (0.250850 --> 0.240031).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 7 cost time: 0.991783618927002
Epoch: 7, Steps: 64 | Train Loss: 0.0890091 Vali Loss: 0.2348672 Test Loss: 0.2851659
Validation loss decreased (0.240031 --> 0.234867).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 8 cost time: 0.9939990043640137
Epoch: 8, Steps: 64 | Train Loss: 0.0870165 Vali Loss: 0.2285037 Test Loss: 0.2832536
Validation loss decreased (0.234867 --> 0.228504).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 9 cost time: 1.0060009956359863
Epoch: 9, Steps: 64 | Train Loss: 0.0854430 Vali Loss: 0.2208786 Test Loss: 0.2834060
Validation loss decreased (0.228504 --> 0.220879).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 10 cost time: 1.073608160018921
Epoch: 10, Steps: 64 | Train Loss: 0.0840228 Vali Loss: 0.2239509 Test Loss: 0.2812612
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 11 cost time: 1.0060386657714844
Epoch: 11, Steps: 64 | Train Loss: 0.0827951 Vali Loss: 0.2187209 Test Loss: 0.2801952
Validation loss decreased (0.220879 --> 0.218721).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 12 cost time: 0.992631196975708
Epoch: 12, Steps: 64 | Train Loss: 0.0815624 Vali Loss: 0.2104610 Test Loss: 0.2748306
Validation loss decreased (0.218721 --> 0.210461).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 13 cost time: 0.9856162071228027
Epoch: 13, Steps: 64 | Train Loss: 0.0805866 Vali Loss: 0.2095173 Test Loss: 0.2787381
Validation loss decreased (0.210461 --> 0.209517).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 14 cost time: 0.9853308200836182
Epoch: 14, Steps: 64 | Train Loss: 0.0794094 Vali Loss: 0.2070453 Test Loss: 0.2752349
Validation loss decreased (0.209517 --> 0.207045).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 15 cost time: 0.9847908020019531
Epoch: 15, Steps: 64 | Train Loss: 0.0782859 Vali Loss: 0.2033368 Test Loss: 0.2743349
Validation loss decreased (0.207045 --> 0.203337).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 16 cost time: 1.0014007091522217
Epoch: 16, Steps: 64 | Train Loss: 0.0777713 Vali Loss: 0.2029319 Test Loss: 0.2710046
Validation loss decreased (0.203337 --> 0.202932).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 17 cost time: 0.9823555946350098
Epoch: 17, Steps: 64 | Train Loss: 0.0772353 Vali Loss: 0.2020494 Test Loss: 0.2722918
Validation loss decreased (0.202932 --> 0.202049).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 18 cost time: 0.9873497486114502
Epoch: 18, Steps: 64 | Train Loss: 0.0761161 Vali Loss: 0.2009478 Test Loss: 0.2717676
Validation loss decreased (0.202049 --> 0.200948).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 19 cost time: 1.0093705654144287
Epoch: 19, Steps: 64 | Train Loss: 0.0759894 Vali Loss: 0.1968873 Test Loss: 0.2706423
Validation loss decreased (0.200948 --> 0.196887).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 20 cost time: 0.9791738986968994
Epoch: 20, Steps: 64 | Train Loss: 0.0757845 Vali Loss: 0.1948820 Test Loss: 0.2690136
Validation loss decreased (0.196887 --> 0.194882).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 21 cost time: 0.9913461208343506
Epoch: 21, Steps: 64 | Train Loss: 0.0751964 Vali Loss: 0.1953974 Test Loss: 0.2695831
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 22 cost time: 0.984729528427124
Epoch: 22, Steps: 64 | Train Loss: 0.0747347 Vali Loss: 0.1977533 Test Loss: 0.2692553
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 23 cost time: 0.983374834060669
Epoch: 23, Steps: 64 | Train Loss: 0.0744853 Vali Loss: 0.1937081 Test Loss: 0.2683680
Validation loss decreased (0.194882 --> 0.193708).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 24 cost time: 0.9849998950958252
Epoch: 24, Steps: 64 | Train Loss: 0.0741476 Vali Loss: 0.1936261 Test Loss: 0.2679254
Validation loss decreased (0.193708 --> 0.193626).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 25 cost time: 0.9975180625915527
Epoch: 25, Steps: 64 | Train Loss: 0.0737773 Vali Loss: 0.1954995 Test Loss: 0.2684399
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 26 cost time: 0.9902923107147217
Epoch: 26, Steps: 64 | Train Loss: 0.0739340 Vali Loss: 0.1922465 Test Loss: 0.2676337
Validation loss decreased (0.193626 --> 0.192246).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 27 cost time: 0.9919281005859375
Epoch: 27, Steps: 64 | Train Loss: 0.0738845 Vali Loss: 0.1947604 Test Loss: 0.2667411
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 28 cost time: 0.9903934001922607
Epoch: 28, Steps: 64 | Train Loss: 0.0732276 Vali Loss: 0.1896807 Test Loss: 0.2659927
Validation loss decreased (0.192246 --> 0.189681).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 29 cost time: 1.000382423400879
Epoch: 29, Steps: 64 | Train Loss: 0.0733547 Vali Loss: 0.1907299 Test Loss: 0.2671258
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 30 cost time: 0.989368200302124
Epoch: 30, Steps: 64 | Train Loss: 0.0734765 Vali Loss: 0.1927291 Test Loss: 0.2662970
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 31 cost time: 0.9833598136901855
Epoch: 31, Steps: 64 | Train Loss: 0.0734858 Vali Loss: 0.1896195 Test Loss: 0.2656656
Validation loss decreased (0.189681 --> 0.189619).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 32 cost time: 1.0023484230041504
Epoch: 32, Steps: 64 | Train Loss: 0.0731030 Vali Loss: 0.1909420 Test Loss: 0.2655239
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 33 cost time: 0.9897744655609131
Epoch: 33, Steps: 64 | Train Loss: 0.0729202 Vali Loss: 0.1932390 Test Loss: 0.2668836
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 34 cost time: 0.9896001815795898
Epoch: 34, Steps: 64 | Train Loss: 0.0731326 Vali Loss: 0.1929562 Test Loss: 0.2663279
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 35 cost time: 1.0001237392425537
Epoch: 35, Steps: 64 | Train Loss: 0.0727643 Vali Loss: 0.1907216 Test Loss: 0.2659215
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 36 cost time: 0.9898316860198975
Epoch: 36, Steps: 64 | Train Loss: 0.0730661 Vali Loss: 0.1917688 Test Loss: 0.2649233
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 37 cost time: 0.9900000095367432
Epoch: 37, Steps: 64 | Train Loss: 0.0728606 Vali Loss: 0.1894025 Test Loss: 0.2662284
Validation loss decreased (0.189619 --> 0.189403).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 38 cost time: 0.9943828582763672
Epoch: 38, Steps: 64 | Train Loss: 0.0726389 Vali Loss: 0.1904198 Test Loss: 0.2650595
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 39 cost time: 0.9780375957489014
Epoch: 39, Steps: 64 | Train Loss: 0.0727046 Vali Loss: 0.1937813 Test Loss: 0.2654591
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 40 cost time: 0.9834322929382324
Epoch: 40, Steps: 64 | Train Loss: 0.0730117 Vali Loss: 0.1894467 Test Loss: 0.2653012
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 41 cost time: 0.9843993186950684
Epoch: 41, Steps: 64 | Train Loss: 0.0726964 Vali Loss: 0.1882194 Test Loss: 0.2651430
Validation loss decreased (0.189403 --> 0.188219).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 42 cost time: 0.9863574504852295
Epoch: 42, Steps: 64 | Train Loss: 0.0729536 Vali Loss: 0.1917891 Test Loss: 0.2649366
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 43 cost time: 0.9913895130157471
Epoch: 43, Steps: 64 | Train Loss: 0.0721569 Vali Loss: 0.1924028 Test Loss: 0.2652891
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 44 cost time: 0.9943804740905762
Epoch: 44, Steps: 64 | Train Loss: 0.0723412 Vali Loss: 0.1910536 Test Loss: 0.2653861
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 45 cost time: 0.9979720115661621
Epoch: 45, Steps: 64 | Train Loss: 0.0725697 Vali Loss: 0.1902761 Test Loss: 0.2662249
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 46 cost time: 0.9874362945556641
Epoch: 46, Steps: 64 | Train Loss: 0.0728741 Vali Loss: 0.1931113 Test Loss: 0.2659635
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 47 cost time: 0.9768280982971191
Epoch: 47, Steps: 64 | Train Loss: 0.0724714 Vali Loss: 0.1909599 Test Loss: 0.2639529
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 48 cost time: 0.9927346706390381
Epoch: 48, Steps: 64 | Train Loss: 0.0726480 Vali Loss: 0.1871959 Test Loss: 0.2645292
Validation loss decreased (0.188219 --> 0.187196).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 49 cost time: 0.9817206859588623
Epoch: 49, Steps: 64 | Train Loss: 0.0726009 Vali Loss: 0.1882322 Test Loss: 0.2650145
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 50 cost time: 0.9830000400543213
Epoch: 50, Steps: 64 | Train Loss: 0.0722744 Vali Loss: 0.1906463 Test Loss: 0.2651349
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 51 cost time: 0.9920601844787598
Epoch: 51, Steps: 64 | Train Loss: 0.0727320 Vali Loss: 0.1884053 Test Loss: 0.2640605
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 52 cost time: 0.9876115322113037
Epoch: 52, Steps: 64 | Train Loss: 0.0723043 Vali Loss: 0.1889983 Test Loss: 0.2650549
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 53 cost time: 0.9903879165649414
Epoch: 53, Steps: 64 | Train Loss: 0.0721127 Vali Loss: 0.1874200 Test Loss: 0.2648829
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 54 cost time: 0.9924085140228271
Epoch: 54, Steps: 64 | Train Loss: 0.0724898 Vali Loss: 0.1902293 Test Loss: 0.2657061
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 55 cost time: 0.9803712368011475
Epoch: 55, Steps: 64 | Train Loss: 0.0723279 Vali Loss: 0.1907680 Test Loss: 0.2644759
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 56 cost time: 0.9794435501098633
Epoch: 56, Steps: 64 | Train Loss: 0.0722912 Vali Loss: 0.1918579 Test Loss: 0.2653114
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 57 cost time: 0.9788508415222168
Epoch: 57, Steps: 64 | Train Loss: 0.0723341 Vali Loss: 0.1889787 Test Loss: 0.2640238
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 58 cost time: 0.9833436012268066
Epoch: 58, Steps: 64 | Train Loss: 0.0720671 Vali Loss: 0.1896144 Test Loss: 0.2652275
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 59 cost time: 0.988980770111084
Epoch: 59, Steps: 64 | Train Loss: 0.0727461 Vali Loss: 0.1913125 Test Loss: 0.2652385
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 60 cost time: 0.9868855476379395
Epoch: 60, Steps: 64 | Train Loss: 0.0722876 Vali Loss: 0.1898506 Test Loss: 0.2639073
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2645292580127716, mae:0.33010393381118774, rse:0.23605306446552277
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.057065486907958984 GB
Epoch: 1 cost time: 2.344942808151245
Epoch: 1, Steps: 64 | Train Loss: 0.8696293 Vali Loss: 2.2862129 Test Loss: 3.8288054
Validation loss decreased (inf --> 2.286213).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 2 cost time: 0.9020001888275146
Epoch: 2, Steps: 64 | Train Loss: 0.4852534 Vali Loss: 0.5574256 Test Loss: 0.7283025
Validation loss decreased (2.286213 --> 0.557426).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 3 cost time: 0.9056155681610107
Epoch: 3, Steps: 64 | Train Loss: 0.2150151 Vali Loss: 0.3403398 Test Loss: 0.3791921
Validation loss decreased (0.557426 --> 0.340340).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 4 cost time: 0.9059634208679199
Epoch: 4, Steps: 64 | Train Loss: 0.1646050 Vali Loss: 0.2813557 Test Loss: 0.3314315
Validation loss decreased (0.340340 --> 0.281356).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 5 cost time: 0.9008584022521973
Epoch: 5, Steps: 64 | Train Loss: 0.1476813 Vali Loss: 0.2619970 Test Loss: 0.3183893
Validation loss decreased (0.281356 --> 0.261997).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 6 cost time: 0.9111778736114502
Epoch: 6, Steps: 64 | Train Loss: 0.1371545 Vali Loss: 0.2544600 Test Loss: 0.3137061
Validation loss decreased (0.261997 --> 0.254460).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 7 cost time: 0.9057285785675049
Epoch: 7, Steps: 64 | Train Loss: 0.1306388 Vali Loss: 0.2478750 Test Loss: 0.3075192
Validation loss decreased (0.254460 --> 0.247875).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 8 cost time: 0.905738115310669
Epoch: 8, Steps: 64 | Train Loss: 0.1258879 Vali Loss: 0.2438413 Test Loss: 0.3045252
Validation loss decreased (0.247875 --> 0.243841).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 9 cost time: 0.8996171951293945
Epoch: 9, Steps: 64 | Train Loss: 0.1217495 Vali Loss: 0.2361939 Test Loss: 0.3014573
Validation loss decreased (0.243841 --> 0.236194).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 10 cost time: 0.9053864479064941
Epoch: 10, Steps: 64 | Train Loss: 0.1168620 Vali Loss: 0.2346940 Test Loss: 0.2969389
Validation loss decreased (0.236194 --> 0.234694).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 11 cost time: 0.9053709506988525
Epoch: 11, Steps: 64 | Train Loss: 0.1152045 Vali Loss: 0.2289356 Test Loss: 0.2955423
Validation loss decreased (0.234694 --> 0.228936).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 12 cost time: 0.9193778038024902
Epoch: 12, Steps: 64 | Train Loss: 0.1128737 Vali Loss: 0.2288362 Test Loss: 0.2950843
Validation loss decreased (0.228936 --> 0.228836).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 13 cost time: 0.905991792678833
Epoch: 13, Steps: 64 | Train Loss: 0.1105335 Vali Loss: 0.2256243 Test Loss: 0.2922367
Validation loss decreased (0.228836 --> 0.225624).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 14 cost time: 0.9057502746582031
Epoch: 14, Steps: 64 | Train Loss: 0.1101523 Vali Loss: 0.2213190 Test Loss: 0.2902812
Validation loss decreased (0.225624 --> 0.221319).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 15 cost time: 0.9150607585906982
Epoch: 15, Steps: 64 | Train Loss: 0.1077004 Vali Loss: 0.2224292 Test Loss: 0.2911068
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 16 cost time: 0.901618242263794
Epoch: 16, Steps: 64 | Train Loss: 0.1064587 Vali Loss: 0.2188083 Test Loss: 0.2868735
Validation loss decreased (0.221319 --> 0.218808).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 17 cost time: 0.9019629955291748
Epoch: 17, Steps: 64 | Train Loss: 0.1049988 Vali Loss: 0.2161387 Test Loss: 0.2882779
Validation loss decreased (0.218808 --> 0.216139).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 18 cost time: 0.9063422679901123
Epoch: 18, Steps: 64 | Train Loss: 0.1042974 Vali Loss: 0.2148873 Test Loss: 0.2887705
Validation loss decreased (0.216139 --> 0.214887).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 19 cost time: 0.9205484390258789
Epoch: 19, Steps: 64 | Train Loss: 0.1032246 Vali Loss: 0.2137053 Test Loss: 0.2865412
Validation loss decreased (0.214887 --> 0.213705).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 20 cost time: 0.9047586917877197
Epoch: 20, Steps: 64 | Train Loss: 0.1026133 Vali Loss: 0.2137716 Test Loss: 0.2865928
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 21 cost time: 0.9107561111450195
Epoch: 21, Steps: 64 | Train Loss: 0.1023715 Vali Loss: 0.2136664 Test Loss: 0.2861415
Validation loss decreased (0.213705 --> 0.213666).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 22 cost time: 0.911628007888794
Epoch: 22, Steps: 64 | Train Loss: 0.1021116 Vali Loss: 0.2148137 Test Loss: 0.2859495
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 23 cost time: 0.9804630279541016
Epoch: 23, Steps: 64 | Train Loss: 0.1014727 Vali Loss: 0.2074827 Test Loss: 0.2869662
Validation loss decreased (0.213666 --> 0.207483).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 24 cost time: 0.9834425449371338
Epoch: 24, Steps: 64 | Train Loss: 0.1002807 Vali Loss: 0.2091983 Test Loss: 0.2859845
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 25 cost time: 0.9792091846466064
Epoch: 25, Steps: 64 | Train Loss: 0.1007076 Vali Loss: 0.2113106 Test Loss: 0.2866161
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 26 cost time: 0.9053878784179688
Epoch: 26, Steps: 64 | Train Loss: 0.0998459 Vali Loss: 0.2097726 Test Loss: 0.2853027
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 27 cost time: 0.8993813991546631
Epoch: 27, Steps: 64 | Train Loss: 0.0998608 Vali Loss: 0.2102022 Test Loss: 0.2837226
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 28 cost time: 0.9057502746582031
Epoch: 28, Steps: 64 | Train Loss: 0.0992229 Vali Loss: 0.2069024 Test Loss: 0.2852264
Validation loss decreased (0.207483 --> 0.206902).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 29 cost time: 0.9129998683929443
Epoch: 29, Steps: 64 | Train Loss: 0.0985353 Vali Loss: 0.2108247 Test Loss: 0.2833478
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 30 cost time: 0.875577449798584
Epoch: 30, Steps: 64 | Train Loss: 0.0985486 Vali Loss: 0.2050613 Test Loss: 0.2849832
Validation loss decreased (0.206902 --> 0.205061).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 31 cost time: 0.9114415645599365
Epoch: 31, Steps: 64 | Train Loss: 0.0984815 Vali Loss: 0.2069300 Test Loss: 0.2851760
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 32 cost time: 0.9094357490539551
Epoch: 32, Steps: 64 | Train Loss: 0.0986203 Vali Loss: 0.2080527 Test Loss: 0.2850783
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 33 cost time: 0.9261186122894287
Epoch: 33, Steps: 64 | Train Loss: 0.0976980 Vali Loss: 0.2070681 Test Loss: 0.2833488
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 34 cost time: 0.9167406558990479
Epoch: 34, Steps: 64 | Train Loss: 0.0979410 Vali Loss: 0.2062094 Test Loss: 0.2843953
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 35 cost time: 0.9190001487731934
Epoch: 35, Steps: 64 | Train Loss: 0.0976662 Vali Loss: 0.2093528 Test Loss: 0.2853344
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 36 cost time: 0.9255988597869873
Epoch: 36, Steps: 64 | Train Loss: 0.0979682 Vali Loss: 0.2063643 Test Loss: 0.2806286
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 37 cost time: 0.9234726428985596
Epoch: 37, Steps: 64 | Train Loss: 0.0969949 Vali Loss: 0.2058879 Test Loss: 0.2847162
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 38 cost time: 0.9263250827789307
Epoch: 38, Steps: 64 | Train Loss: 0.0969971 Vali Loss: 0.2070380 Test Loss: 0.2846312
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 39 cost time: 0.9233779907226562
Epoch: 39, Steps: 64 | Train Loss: 0.0974517 Vali Loss: 0.2067921 Test Loss: 0.2837120
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 40 cost time: 0.9283487796783447
Epoch: 40, Steps: 64 | Train Loss: 0.0973539 Vali Loss: 0.2053863 Test Loss: 0.2841278
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 41 cost time: 0.9228079319000244
Epoch: 41, Steps: 64 | Train Loss: 0.0971094 Vali Loss: 0.2040912 Test Loss: 0.2822268
Validation loss decreased (0.205061 --> 0.204091).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 42 cost time: 0.9149999618530273
Epoch: 42, Steps: 64 | Train Loss: 0.0966703 Vali Loss: 0.2054261 Test Loss: 0.2824789
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 43 cost time: 0.9154458045959473
Epoch: 43, Steps: 64 | Train Loss: 0.0968627 Vali Loss: 0.2024268 Test Loss: 0.2818442
Validation loss decreased (0.204091 --> 0.202427).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 44 cost time: 0.9843597412109375
Epoch: 44, Steps: 64 | Train Loss: 0.0965540 Vali Loss: 0.2030244 Test Loss: 0.2844419
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 45 cost time: 0.9177963733673096
Epoch: 45, Steps: 64 | Train Loss: 0.0971457 Vali Loss: 0.2069100 Test Loss: 0.2819101
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 46 cost time: 0.9169321060180664
Epoch: 46, Steps: 64 | Train Loss: 0.0971927 Vali Loss: 0.2033424 Test Loss: 0.2842048
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 47 cost time: 0.9022283554077148
Epoch: 47, Steps: 64 | Train Loss: 0.0967492 Vali Loss: 0.2040868 Test Loss: 0.2822832
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 48 cost time: 0.9033658504486084
Epoch: 48, Steps: 64 | Train Loss: 0.0963454 Vali Loss: 0.2032197 Test Loss: 0.2819152
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 49 cost time: 0.8999993801116943
Epoch: 49, Steps: 64 | Train Loss: 0.0970036 Vali Loss: 0.2043103 Test Loss: 0.2831664
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 50 cost time: 0.914637565612793
Epoch: 50, Steps: 64 | Train Loss: 0.0962235 Vali Loss: 0.2048326 Test Loss: 0.2854978
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 51 cost time: 0.90134596824646
Epoch: 51, Steps: 64 | Train Loss: 0.0966783 Vali Loss: 0.2036537 Test Loss: 0.2814800
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 52 cost time: 0.9033660888671875
Epoch: 52, Steps: 64 | Train Loss: 0.0962165 Vali Loss: 0.2037305 Test Loss: 0.2830988
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 53 cost time: 0.9013786315917969
Epoch: 53, Steps: 64 | Train Loss: 0.0960493 Vali Loss: 0.2053385 Test Loss: 0.2828314
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 54 cost time: 0.9183814525604248
Epoch: 54, Steps: 64 | Train Loss: 0.0962739 Vali Loss: 0.2049125 Test Loss: 0.2829130
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 55 cost time: 0.8959994316101074
Epoch: 55, Steps: 64 | Train Loss: 0.0964342 Vali Loss: 0.2060277 Test Loss: 0.2819272
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 56 cost time: 0.9063992500305176
Epoch: 56, Steps: 64 | Train Loss: 0.0960649 Vali Loss: 0.2040754 Test Loss: 0.2842432
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 57 cost time: 0.9183595180511475
Epoch: 57, Steps: 64 | Train Loss: 0.0961235 Vali Loss: 0.2033889 Test Loss: 0.2829440
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 58 cost time: 0.9093704223632812
Epoch: 58, Steps: 64 | Train Loss: 0.0963317 Vali Loss: 0.2042180 Test Loss: 0.2848615
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 59 cost time: 0.9117922782897949
Epoch: 59, Steps: 64 | Train Loss: 0.0960141 Vali Loss: 0.2041250 Test Loss: 0.2830396
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 60 cost time: 0.902336835861206
Epoch: 60, Steps: 64 | Train Loss: 0.0958344 Vali Loss: 0.2040151 Test Loss: 0.2812987
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.28184425830841064, mae:0.33499038219451904, rse:0.24365614354610443
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.05849742889404297 GB
Epoch: 1 cost time: 2.3947598934173584
Epoch: 1, Steps: 64 | Train Loss: 0.9703023 Vali Loss: 2.8235433 Test Loss: 4.9083552
Validation loss decreased (inf --> 2.823543).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 2 cost time: 0.9670000076293945
Epoch: 2, Steps: 64 | Train Loss: 0.5813834 Vali Loss: 0.7747780 Test Loss: 1.1335748
Validation loss decreased (2.823543 --> 0.774778).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 3 cost time: 0.965609073638916
Epoch: 3, Steps: 64 | Train Loss: 0.1928380 Vali Loss: 0.2983519 Test Loss: 0.3285749
Validation loss decreased (0.774778 --> 0.298352).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 4 cost time: 0.9455780982971191
Epoch: 4, Steps: 64 | Train Loss: 0.1227849 Vali Loss: 0.2564228 Test Loss: 0.2978259
Validation loss decreased (0.298352 --> 0.256423).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 5 cost time: 0.9445130825042725
Epoch: 5, Steps: 64 | Train Loss: 0.1111985 Vali Loss: 0.2434386 Test Loss: 0.2952602
Validation loss decreased (0.256423 --> 0.243439).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 6 cost time: 0.9396491050720215
Epoch: 6, Steps: 64 | Train Loss: 0.1052110 Vali Loss: 0.2356884 Test Loss: 0.2932433
Validation loss decreased (0.243439 --> 0.235688).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 7 cost time: 0.9422223567962646
Epoch: 7, Steps: 64 | Train Loss: 0.1006982 Vali Loss: 0.2288541 Test Loss: 0.2904378
Validation loss decreased (0.235688 --> 0.228854).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 8 cost time: 0.9184396266937256
Epoch: 8, Steps: 64 | Train Loss: 0.0974382 Vali Loss: 0.2248348 Test Loss: 0.2890628
Validation loss decreased (0.228854 --> 0.224835).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 9 cost time: 0.9377951622009277
Epoch: 9, Steps: 64 | Train Loss: 0.0950332 Vali Loss: 0.2214145 Test Loss: 0.2899859
Validation loss decreased (0.224835 --> 0.221414).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 10 cost time: 0.951225996017456
Epoch: 10, Steps: 64 | Train Loss: 0.0928196 Vali Loss: 0.2205009 Test Loss: 0.2890865
Validation loss decreased (0.221414 --> 0.220501).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 11 cost time: 0.9539999961853027
Epoch: 11, Steps: 64 | Train Loss: 0.0914281 Vali Loss: 0.2161306 Test Loss: 0.2897712
Validation loss decreased (0.220501 --> 0.216131).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 12 cost time: 0.9366140365600586
Epoch: 12, Steps: 64 | Train Loss: 0.0901568 Vali Loss: 0.2152475 Test Loss: 0.2893869
Validation loss decreased (0.216131 --> 0.215248).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 13 cost time: 0.9363372325897217
Epoch: 13, Steps: 64 | Train Loss: 0.0883714 Vali Loss: 0.2143716 Test Loss: 0.2917560
Validation loss decreased (0.215248 --> 0.214372).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 14 cost time: 0.9385621547698975
Epoch: 14, Steps: 64 | Train Loss: 0.0881778 Vali Loss: 0.2127631 Test Loss: 0.2900053
Validation loss decreased (0.214372 --> 0.212763).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 15 cost time: 0.9390411376953125
Epoch: 15, Steps: 64 | Train Loss: 0.0869809 Vali Loss: 0.2048696 Test Loss: 0.2908687
Validation loss decreased (0.212763 --> 0.204870).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 16 cost time: 0.9274189472198486
Epoch: 16, Steps: 64 | Train Loss: 0.0865643 Vali Loss: 0.2101104 Test Loss: 0.2887214
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 17 cost time: 0.9314944744110107
Epoch: 17, Steps: 64 | Train Loss: 0.0862562 Vali Loss: 0.2064457 Test Loss: 0.2894709
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 18 cost time: 0.9399974346160889
Epoch: 18, Steps: 64 | Train Loss: 0.0849559 Vali Loss: 0.2037838 Test Loss: 0.2888805
Validation loss decreased (0.204870 --> 0.203784).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 19 cost time: 0.9344112873077393
Epoch: 19, Steps: 64 | Train Loss: 0.0845351 Vali Loss: 0.2023543 Test Loss: 0.2900162
Validation loss decreased (0.203784 --> 0.202354).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 20 cost time: 0.9321608543395996
Epoch: 20, Steps: 64 | Train Loss: 0.0837847 Vali Loss: 0.2040976 Test Loss: 0.2907526
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 21 cost time: 0.9273929595947266
Epoch: 21, Steps: 64 | Train Loss: 0.0838207 Vali Loss: 0.1995915 Test Loss: 0.2896420
Validation loss decreased (0.202354 --> 0.199591).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 22 cost time: 1.005350112915039
Epoch: 22, Steps: 64 | Train Loss: 0.0836893 Vali Loss: 0.1976967 Test Loss: 0.2897010
Validation loss decreased (0.199591 --> 0.197697).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 23 cost time: 0.9413516521453857
Epoch: 23, Steps: 64 | Train Loss: 0.0833074 Vali Loss: 0.2002237 Test Loss: 0.2893592
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 24 cost time: 0.9378116130828857
Epoch: 24, Steps: 64 | Train Loss: 0.0822862 Vali Loss: 0.1984724 Test Loss: 0.2888472
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 25 cost time: 0.9117693901062012
Epoch: 25, Steps: 64 | Train Loss: 0.0829568 Vali Loss: 0.2002283 Test Loss: 0.2887616
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 26 cost time: 0.9289999008178711
Epoch: 26, Steps: 64 | Train Loss: 0.0824050 Vali Loss: 0.1977792 Test Loss: 0.2881182
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 27 cost time: 0.9370002746582031
Epoch: 27, Steps: 64 | Train Loss: 0.0821461 Vali Loss: 0.1967021 Test Loss: 0.2886749
Validation loss decreased (0.197697 --> 0.196702).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 28 cost time: 0.9460344314575195
Epoch: 28, Steps: 64 | Train Loss: 0.0817723 Vali Loss: 0.1980815 Test Loss: 0.2889484
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 29 cost time: 0.916374683380127
Epoch: 29, Steps: 64 | Train Loss: 0.0817523 Vali Loss: 0.1988260 Test Loss: 0.2892320
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 30 cost time: 0.9434282779693604
Epoch: 30, Steps: 64 | Train Loss: 0.0815295 Vali Loss: 0.1966801 Test Loss: 0.2894796
Validation loss decreased (0.196702 --> 0.196680).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 31 cost time: 0.9434032440185547
Epoch: 31, Steps: 64 | Train Loss: 0.0811814 Vali Loss: 0.1985160 Test Loss: 0.2883908
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 32 cost time: 0.9435715675354004
Epoch: 32, Steps: 64 | Train Loss: 0.0811391 Vali Loss: 0.1988573 Test Loss: 0.2885365
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 33 cost time: 0.9334440231323242
Epoch: 33, Steps: 64 | Train Loss: 0.0812400 Vali Loss: 0.1985438 Test Loss: 0.2887335
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 34 cost time: 0.934999942779541
Epoch: 34, Steps: 64 | Train Loss: 0.0812379 Vali Loss: 0.1953533 Test Loss: 0.2886813
Validation loss decreased (0.196680 --> 0.195353).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 35 cost time: 0.9386141300201416
Epoch: 35, Steps: 64 | Train Loss: 0.0811079 Vali Loss: 0.1965498 Test Loss: 0.2881078
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 36 cost time: 0.9323756694793701
Epoch: 36, Steps: 64 | Train Loss: 0.0805974 Vali Loss: 0.1969484 Test Loss: 0.2875051
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 37 cost time: 0.9354143142700195
Epoch: 37, Steps: 64 | Train Loss: 0.0806002 Vali Loss: 0.1977082 Test Loss: 0.2878737
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 38 cost time: 0.9343624114990234
Epoch: 38, Steps: 64 | Train Loss: 0.0808734 Vali Loss: 0.1975463 Test Loss: 0.2879252
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 39 cost time: 0.9342508316040039
Epoch: 39, Steps: 64 | Train Loss: 0.0806025 Vali Loss: 0.1973161 Test Loss: 0.2880920
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 40 cost time: 0.9337635040283203
Epoch: 40, Steps: 64 | Train Loss: 0.0809937 Vali Loss: 0.1969727 Test Loss: 0.2883900
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 41 cost time: 0.9323484897613525
Epoch: 41, Steps: 64 | Train Loss: 0.0806163 Vali Loss: 0.1979621 Test Loss: 0.2878728
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 42 cost time: 0.9246141910552979
Epoch: 42, Steps: 64 | Train Loss: 0.0803419 Vali Loss: 0.1963777 Test Loss: 0.2883107
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 43 cost time: 0.9256796836853027
Epoch: 43, Steps: 64 | Train Loss: 0.0805915 Vali Loss: 0.1982827 Test Loss: 0.2875608
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 44 cost time: 0.9293687343597412
Epoch: 44, Steps: 64 | Train Loss: 0.0800141 Vali Loss: 0.1936757 Test Loss: 0.2875189
Validation loss decreased (0.195353 --> 0.193676).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 45 cost time: 0.9354655742645264
Epoch: 45, Steps: 64 | Train Loss: 0.0803316 Vali Loss: 0.1949127 Test Loss: 0.2880974
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 46 cost time: 0.9131731986999512
Epoch: 46, Steps: 64 | Train Loss: 0.0802692 Vali Loss: 0.1948259 Test Loss: 0.2878112
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 47 cost time: 0.9347493648529053
Epoch: 47, Steps: 64 | Train Loss: 0.0800078 Vali Loss: 0.1968862 Test Loss: 0.2881495
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 48 cost time: 0.93399977684021
Epoch: 48, Steps: 64 | Train Loss: 0.0801131 Vali Loss: 0.1947184 Test Loss: 0.2883768
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 49 cost time: 0.9413981437683105
Epoch: 49, Steps: 64 | Train Loss: 0.0799779 Vali Loss: 0.1953457 Test Loss: 0.2882935
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 50 cost time: 0.9326212406158447
Epoch: 50, Steps: 64 | Train Loss: 0.0800508 Vali Loss: 0.1971144 Test Loss: 0.2875008
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 51 cost time: 0.9313507080078125
Epoch: 51, Steps: 64 | Train Loss: 0.0796629 Vali Loss: 0.1952155 Test Loss: 0.2879654
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 52 cost time: 0.9323368072509766
Epoch: 52, Steps: 64 | Train Loss: 0.0800840 Vali Loss: 0.1960511 Test Loss: 0.2882719
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 53 cost time: 0.9274559020996094
Epoch: 53, Steps: 64 | Train Loss: 0.0792086 Vali Loss: 0.1955728 Test Loss: 0.2872992
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 54 cost time: 0.9315388202667236
Epoch: 54, Steps: 64 | Train Loss: 0.0802155 Vali Loss: 0.1967854 Test Loss: 0.2878935
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 55 cost time: 0.9287374019622803
Epoch: 55, Steps: 64 | Train Loss: 0.0806707 Vali Loss: 0.1955632 Test Loss: 0.2876998
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 56 cost time: 0.9389994144439697
Epoch: 56, Steps: 64 | Train Loss: 0.0795820 Vali Loss: 0.1943481 Test Loss: 0.2876495
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 57 cost time: 0.9306197166442871
Epoch: 57, Steps: 64 | Train Loss: 0.0802919 Vali Loss: 0.1950187 Test Loss: 0.2876023
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 58 cost time: 0.9323604106903076
Epoch: 58, Steps: 64 | Train Loss: 0.0798702 Vali Loss: 0.1962021 Test Loss: 0.2879898
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 59 cost time: 0.9268608093261719
Epoch: 59, Steps: 64 | Train Loss: 0.0797805 Vali Loss: 0.1967750 Test Loss: 0.2873930
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 60 cost time: 0.9273700714111328
Epoch: 60, Steps: 64 | Train Loss: 0.0798171 Vali Loss: 0.1950127 Test Loss: 0.2876360
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.28751885890960693, mae:0.35272547602653503, rse:0.24609678983688354
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.05961751937866211 GB
Epoch: 1 cost time: 2.299330949783325
Epoch: 1, Steps: 64 | Train Loss: 0.9502390 Vali Loss: 2.8801713 Test Loss: 5.1366234
Validation loss decreased (inf --> 2.880171).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 2 cost time: 0.9692645072937012
Epoch: 2, Steps: 64 | Train Loss: 0.6194217 Vali Loss: 0.9894418 Test Loss: 1.5025551
Validation loss decreased (2.880171 --> 0.989442).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 3 cost time: 0.9657988548278809
Epoch: 3, Steps: 64 | Train Loss: 0.2003880 Vali Loss: 0.3134963 Test Loss: 0.3297860
Validation loss decreased (0.989442 --> 0.313496).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 4 cost time: 0.9656262397766113
Epoch: 4, Steps: 64 | Train Loss: 0.1134012 Vali Loss: 0.2568428 Test Loss: 0.3187130
Validation loss decreased (0.313496 --> 0.256843).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 5 cost time: 0.9736227989196777
Epoch: 5, Steps: 64 | Train Loss: 0.1024575 Vali Loss: 0.2420276 Test Loss: 0.3005502
Validation loss decreased (0.256843 --> 0.242028).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 6 cost time: 0.9689347743988037
Epoch: 6, Steps: 64 | Train Loss: 0.0973951 Vali Loss: 0.2357638 Test Loss: 0.2968331
Validation loss decreased (0.242028 --> 0.235764).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 7 cost time: 1.0529601573944092
Epoch: 7, Steps: 64 | Train Loss: 0.0939303 Vali Loss: 0.2265909 Test Loss: 0.2938718
Validation loss decreased (0.235764 --> 0.226591).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 8 cost time: 0.9990692138671875
Epoch: 8, Steps: 64 | Train Loss: 0.0915460 Vali Loss: 0.2248345 Test Loss: 0.2913665
Validation loss decreased (0.226591 --> 0.224835).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 9 cost time: 0.9674479961395264
Epoch: 9, Steps: 64 | Train Loss: 0.0888794 Vali Loss: 0.2174493 Test Loss: 0.2916597
Validation loss decreased (0.224835 --> 0.217449).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 10 cost time: 0.9643373489379883
Epoch: 10, Steps: 64 | Train Loss: 0.0877235 Vali Loss: 0.2145182 Test Loss: 0.2928386
Validation loss decreased (0.217449 --> 0.214518).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 11 cost time: 0.9671823978424072
Epoch: 11, Steps: 64 | Train Loss: 0.0856639 Vali Loss: 0.2100679 Test Loss: 0.2920523
Validation loss decreased (0.214518 --> 0.210068).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 12 cost time: 0.9684062004089355
Epoch: 12, Steps: 64 | Train Loss: 0.0844648 Vali Loss: 0.2095824 Test Loss: 0.2902222
Validation loss decreased (0.210068 --> 0.209582).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 13 cost time: 0.9807183742523193
Epoch: 13, Steps: 64 | Train Loss: 0.0839659 Vali Loss: 0.2075966 Test Loss: 0.2919454
Validation loss decreased (0.209582 --> 0.207597).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 14 cost time: 0.9660000801086426
Epoch: 14, Steps: 64 | Train Loss: 0.0828733 Vali Loss: 0.2021585 Test Loss: 0.2903048
Validation loss decreased (0.207597 --> 0.202158).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 15 cost time: 0.9614269733428955
Epoch: 15, Steps: 64 | Train Loss: 0.0821130 Vali Loss: 0.2032598 Test Loss: 0.2904435
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 16 cost time: 0.9750003814697266
Epoch: 16, Steps: 64 | Train Loss: 0.0810542 Vali Loss: 0.2003502 Test Loss: 0.2900207
Validation loss decreased (0.202158 --> 0.200350).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 17 cost time: 0.9689671993255615
Epoch: 17, Steps: 64 | Train Loss: 0.0811298 Vali Loss: 0.2009845 Test Loss: 0.2893355
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 18 cost time: 0.9584178924560547
Epoch: 18, Steps: 64 | Train Loss: 0.0804635 Vali Loss: 0.1996337 Test Loss: 0.2894863
Validation loss decreased (0.200350 --> 0.199634).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 19 cost time: 0.975426435470581
Epoch: 19, Steps: 64 | Train Loss: 0.0797319 Vali Loss: 0.1985801 Test Loss: 0.2898686
Validation loss decreased (0.199634 --> 0.198580).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 20 cost time: 0.9302449226379395
Epoch: 20, Steps: 64 | Train Loss: 0.0800934 Vali Loss: 0.1981726 Test Loss: 0.2901830
Validation loss decreased (0.198580 --> 0.198173).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 21 cost time: 0.9654595851898193
Epoch: 21, Steps: 64 | Train Loss: 0.0789348 Vali Loss: 0.1948696 Test Loss: 0.2890649
Validation loss decreased (0.198173 --> 0.194870).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 22 cost time: 0.9647595882415771
Epoch: 22, Steps: 64 | Train Loss: 0.0789144 Vali Loss: 0.1960469 Test Loss: 0.2891920
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 23 cost time: 0.9597499370574951
Epoch: 23, Steps: 64 | Train Loss: 0.0783469 Vali Loss: 0.1937922 Test Loss: 0.2898917
Validation loss decreased (0.194870 --> 0.193792).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 24 cost time: 0.9583992958068848
Epoch: 24, Steps: 64 | Train Loss: 0.0786497 Vali Loss: 0.1928240 Test Loss: 0.2895074
Validation loss decreased (0.193792 --> 0.192824).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 25 cost time: 0.9626095294952393
Epoch: 25, Steps: 64 | Train Loss: 0.0781354 Vali Loss: 0.1930877 Test Loss: 0.2890254
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 26 cost time: 0.9633147716522217
Epoch: 26, Steps: 64 | Train Loss: 0.0777516 Vali Loss: 0.1944768 Test Loss: 0.2890513
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 27 cost time: 0.9583785533905029
Epoch: 27, Steps: 64 | Train Loss: 0.0776316 Vali Loss: 0.1964331 Test Loss: 0.2887154
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 28 cost time: 0.9638566970825195
Epoch: 28, Steps: 64 | Train Loss: 0.0773282 Vali Loss: 0.1927436 Test Loss: 0.2886897
Validation loss decreased (0.192824 --> 0.192744).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 29 cost time: 0.9643843173980713
Epoch: 29, Steps: 64 | Train Loss: 0.0773411 Vali Loss: 0.1920301 Test Loss: 0.2894378
Validation loss decreased (0.192744 --> 0.192030).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 30 cost time: 0.9653739929199219
Epoch: 30, Steps: 64 | Train Loss: 0.0774663 Vali Loss: 0.1930351 Test Loss: 0.2893885
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 31 cost time: 0.9637401103973389
Epoch: 31, Steps: 64 | Train Loss: 0.0770156 Vali Loss: 0.1926674 Test Loss: 0.2879376
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 32 cost time: 0.9597606658935547
Epoch: 32, Steps: 64 | Train Loss: 0.0767525 Vali Loss: 0.1926880 Test Loss: 0.2882589
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 33 cost time: 0.9756355285644531
Epoch: 33, Steps: 64 | Train Loss: 0.0767624 Vali Loss: 0.1930211 Test Loss: 0.2885977
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 34 cost time: 0.9576144218444824
Epoch: 34, Steps: 64 | Train Loss: 0.0766005 Vali Loss: 0.1926310 Test Loss: 0.2889516
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 35 cost time: 0.9576215744018555
Epoch: 35, Steps: 64 | Train Loss: 0.0765947 Vali Loss: 0.1924440 Test Loss: 0.2888753
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 36 cost time: 0.9693558216094971
Epoch: 36, Steps: 64 | Train Loss: 0.0769430 Vali Loss: 0.1921359 Test Loss: 0.2873535
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 37 cost time: 0.961005449295044
Epoch: 37, Steps: 64 | Train Loss: 0.0766083 Vali Loss: 0.1922387 Test Loss: 0.2881311
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 38 cost time: 0.9614012241363525
Epoch: 38, Steps: 64 | Train Loss: 0.0763908 Vali Loss: 0.1921727 Test Loss: 0.2882404
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 39 cost time: 0.966463565826416
Epoch: 39, Steps: 64 | Train Loss: 0.0759923 Vali Loss: 0.1891068 Test Loss: 0.2880770
Validation loss decreased (0.192030 --> 0.189107).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 40 cost time: 0.9495410919189453
Epoch: 40, Steps: 64 | Train Loss: 0.0761910 Vali Loss: 0.1879797 Test Loss: 0.2881483
Validation loss decreased (0.189107 --> 0.187980).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 41 cost time: 0.9822597503662109
Epoch: 41, Steps: 64 | Train Loss: 0.0764395 Vali Loss: 0.1898183 Test Loss: 0.2888889
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 42 cost time: 0.9779999256134033
Epoch: 42, Steps: 64 | Train Loss: 0.0760504 Vali Loss: 0.1903914 Test Loss: 0.2879149
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 43 cost time: 0.974602222442627
Epoch: 43, Steps: 64 | Train Loss: 0.0762254 Vali Loss: 0.1913238 Test Loss: 0.2877096
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 44 cost time: 0.9765942096710205
Epoch: 44, Steps: 64 | Train Loss: 0.0760966 Vali Loss: 0.1928984 Test Loss: 0.2868718
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 45 cost time: 0.9883313179016113
Epoch: 45, Steps: 64 | Train Loss: 0.0764102 Vali Loss: 0.1913266 Test Loss: 0.2880159
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 46 cost time: 0.9773464202880859
Epoch: 46, Steps: 64 | Train Loss: 0.0757341 Vali Loss: 0.1912062 Test Loss: 0.2878225
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 47 cost time: 1.0394198894500732
Epoch: 47, Steps: 64 | Train Loss: 0.0763034 Vali Loss: 0.1892561 Test Loss: 0.2875888
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 48 cost time: 0.984351634979248
Epoch: 48, Steps: 64 | Train Loss: 0.0763751 Vali Loss: 0.1914641 Test Loss: 0.2876489
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 49 cost time: 0.9640214443206787
Epoch: 49, Steps: 64 | Train Loss: 0.0763609 Vali Loss: 0.1893234 Test Loss: 0.2877896
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 50 cost time: 0.9724159240722656
Epoch: 50, Steps: 64 | Train Loss: 0.0760197 Vali Loss: 0.1894521 Test Loss: 0.2879683
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 51 cost time: 0.9642524719238281
Epoch: 51, Steps: 64 | Train Loss: 0.0758571 Vali Loss: 0.1906919 Test Loss: 0.2876487
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 52 cost time: 0.9660000801086426
Epoch: 52, Steps: 64 | Train Loss: 0.0757684 Vali Loss: 0.1909540 Test Loss: 0.2876546
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 53 cost time: 0.9820001125335693
Epoch: 53, Steps: 64 | Train Loss: 0.0760957 Vali Loss: 0.1915736 Test Loss: 0.2878477
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 54 cost time: 0.9692263603210449
Epoch: 54, Steps: 64 | Train Loss: 0.0754001 Vali Loss: 0.1906484 Test Loss: 0.2878971
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 55 cost time: 0.9759964942932129
Epoch: 55, Steps: 64 | Train Loss: 0.0759230 Vali Loss: 0.1893122 Test Loss: 0.2876213
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 56 cost time: 0.9814023971557617
Epoch: 56, Steps: 64 | Train Loss: 0.0762881 Vali Loss: 0.1907591 Test Loss: 0.2879184
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 57 cost time: 0.9739131927490234
Epoch: 57, Steps: 64 | Train Loss: 0.0764141 Vali Loss: 0.1885592 Test Loss: 0.2882956
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 58 cost time: 0.9664161205291748
Epoch: 58, Steps: 64 | Train Loss: 0.0758210 Vali Loss: 0.1903652 Test Loss: 0.2876803
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 59 cost time: 0.9663803577423096
Epoch: 59, Steps: 64 | Train Loss: 0.0761160 Vali Loss: 0.1913656 Test Loss: 0.2876056
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 60 cost time: 0.964848518371582
Epoch: 60, Steps: 64 | Train Loss: 0.0760899 Vali Loss: 0.1909952 Test Loss: 0.2879392
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.28814828395843506, mae:0.3544914126396179, rse:0.24636602401733398
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.057227134704589844 GB
Epoch: 1 cost time: 2.2796642780303955
Epoch: 1, Steps: 64 | Train Loss: 0.7184875 Vali Loss: 1.8679384 Test Loss: 3.0820687
Validation loss decreased (inf --> 1.867938).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 2 cost time: 0.9133999347686768
Epoch: 2, Steps: 64 | Train Loss: 0.4244445 Vali Loss: 0.5204399 Test Loss: 0.6487342
Validation loss decreased (1.867938 --> 0.520440).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 3 cost time: 0.9149501323699951
Epoch: 3, Steps: 64 | Train Loss: 0.2003768 Vali Loss: 0.3487971 Test Loss: 0.3869437
Validation loss decreased (0.520440 --> 0.348797).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 4 cost time: 0.9155247211456299
Epoch: 4, Steps: 64 | Train Loss: 0.1508785 Vali Loss: 0.2802497 Test Loss: 0.3309024
Validation loss decreased (0.348797 --> 0.280250).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 5 cost time: 0.9104781150817871
Epoch: 5, Steps: 64 | Train Loss: 0.1312535 Vali Loss: 0.2492468 Test Loss: 0.3012866
Validation loss decreased (0.280250 --> 0.249247).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 6 cost time: 0.909151554107666
Epoch: 6, Steps: 64 | Train Loss: 0.1219203 Vali Loss: 0.2388384 Test Loss: 0.2969346
Validation loss decreased (0.249247 --> 0.238838).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 7 cost time: 0.9097900390625
Epoch: 7, Steps: 64 | Train Loss: 0.1152270 Vali Loss: 0.2329378 Test Loss: 0.2928682
Validation loss decreased (0.238838 --> 0.232938).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 8 cost time: 0.907381534576416
Epoch: 8, Steps: 64 | Train Loss: 0.1108805 Vali Loss: 0.2275282 Test Loss: 0.2871654
Validation loss decreased (0.232938 --> 0.227528).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 9 cost time: 0.9126155376434326
Epoch: 9, Steps: 64 | Train Loss: 0.1076470 Vali Loss: 0.2241401 Test Loss: 0.2863867
Validation loss decreased (0.227528 --> 0.224140).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 10 cost time: 0.923337459564209
Epoch: 10, Steps: 64 | Train Loss: 0.1056931 Vali Loss: 0.2216164 Test Loss: 0.2859477
Validation loss decreased (0.224140 --> 0.221616).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 11 cost time: 0.9153635501861572
Epoch: 11, Steps: 64 | Train Loss: 0.1023645 Vali Loss: 0.2191139 Test Loss: 0.2858459
Validation loss decreased (0.221616 --> 0.219114).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 12 cost time: 0.9194064140319824
Epoch: 12, Steps: 64 | Train Loss: 0.1021660 Vali Loss: 0.2192114 Test Loss: 0.2837237
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 13 cost time: 0.9173295497894287
Epoch: 13, Steps: 64 | Train Loss: 0.1004861 Vali Loss: 0.2176300 Test Loss: 0.2843231
Validation loss decreased (0.219114 --> 0.217630).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 14 cost time: 0.9137413501739502
Epoch: 14, Steps: 64 | Train Loss: 0.0991115 Vali Loss: 0.2163275 Test Loss: 0.2848285
Validation loss decreased (0.217630 --> 0.216327).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 15 cost time: 0.9090003967285156
Epoch: 15, Steps: 64 | Train Loss: 0.0985105 Vali Loss: 0.2159505 Test Loss: 0.2856163
Validation loss decreased (0.216327 --> 0.215950).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 16 cost time: 0.9124100208282471
Epoch: 16, Steps: 64 | Train Loss: 0.0973147 Vali Loss: 0.2144868 Test Loss: 0.2836088
Validation loss decreased (0.215950 --> 0.214487).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 17 cost time: 0.9245853424072266
Epoch: 17, Steps: 64 | Train Loss: 0.0965565 Vali Loss: 0.2119991 Test Loss: 0.2815377
Validation loss decreased (0.214487 --> 0.211999).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 18 cost time: 0.928417444229126
Epoch: 18, Steps: 64 | Train Loss: 0.0955371 Vali Loss: 0.2113675 Test Loss: 0.2825340
Validation loss decreased (0.211999 --> 0.211368).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 19 cost time: 0.9323515892028809
Epoch: 19, Steps: 64 | Train Loss: 0.0943170 Vali Loss: 0.2091138 Test Loss: 0.2811415
Validation loss decreased (0.211368 --> 0.209114).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 20 cost time: 0.9463763236999512
Epoch: 20, Steps: 64 | Train Loss: 0.0943349 Vali Loss: 0.2115986 Test Loss: 0.2839112
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 21 cost time: 0.930356502532959
Epoch: 21, Steps: 64 | Train Loss: 0.0929316 Vali Loss: 0.2112447 Test Loss: 0.2805766
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 22 cost time: 0.9307205677032471
Epoch: 22, Steps: 64 | Train Loss: 0.0927508 Vali Loss: 0.2093241 Test Loss: 0.2793550
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 23 cost time: 0.9320001602172852
Epoch: 23, Steps: 64 | Train Loss: 0.0920514 Vali Loss: 0.2092463 Test Loss: 0.2804798
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 24 cost time: 0.90411376953125
Epoch: 24, Steps: 64 | Train Loss: 0.0917323 Vali Loss: 0.2068176 Test Loss: 0.2797149
Validation loss decreased (0.209114 --> 0.206818).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 25 cost time: 0.8783450126647949
Epoch: 25, Steps: 64 | Train Loss: 0.0920101 Vali Loss: 0.2064376 Test Loss: 0.2792784
Validation loss decreased (0.206818 --> 0.206438).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 26 cost time: 0.905426025390625
Epoch: 26, Steps: 64 | Train Loss: 0.0912758 Vali Loss: 0.2066634 Test Loss: 0.2792843
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 27 cost time: 0.9154448509216309
Epoch: 27, Steps: 64 | Train Loss: 0.0907520 Vali Loss: 0.2077451 Test Loss: 0.2783470
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 28 cost time: 0.9098708629608154
Epoch: 28, Steps: 64 | Train Loss: 0.0912894 Vali Loss: 0.2060932 Test Loss: 0.2785653
Validation loss decreased (0.206438 --> 0.206093).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 29 cost time: 0.9124679565429688
Epoch: 29, Steps: 64 | Train Loss: 0.0905742 Vali Loss: 0.2051679 Test Loss: 0.2780642
Validation loss decreased (0.206093 --> 0.205168).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 30 cost time: 0.9126033782958984
Epoch: 30, Steps: 64 | Train Loss: 0.0905611 Vali Loss: 0.2059097 Test Loss: 0.2793407
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 31 cost time: 0.9234709739685059
Epoch: 31, Steps: 64 | Train Loss: 0.0907293 Vali Loss: 0.2069101 Test Loss: 0.2798664
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 32 cost time: 0.912348747253418
Epoch: 32, Steps: 64 | Train Loss: 0.0899555 Vali Loss: 0.2046974 Test Loss: 0.2790471
Validation loss decreased (0.205168 --> 0.204697).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 33 cost time: 0.9083662033081055
Epoch: 33, Steps: 64 | Train Loss: 0.0903009 Vali Loss: 0.2056789 Test Loss: 0.2790143
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 34 cost time: 0.9130074977874756
Epoch: 34, Steps: 64 | Train Loss: 0.0900785 Vali Loss: 0.2065014 Test Loss: 0.2778354
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 35 cost time: 0.923738956451416
Epoch: 35, Steps: 64 | Train Loss: 0.0898960 Vali Loss: 0.2051315 Test Loss: 0.2768736
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 36 cost time: 0.9050002098083496
Epoch: 36, Steps: 64 | Train Loss: 0.0895038 Vali Loss: 0.2056384 Test Loss: 0.2784174
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 37 cost time: 0.9156301021575928
Epoch: 37, Steps: 64 | Train Loss: 0.0890363 Vali Loss: 0.2026975 Test Loss: 0.2768874
Validation loss decreased (0.204697 --> 0.202697).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 38 cost time: 0.9313936233520508
Epoch: 38, Steps: 64 | Train Loss: 0.0889054 Vali Loss: 0.2036368 Test Loss: 0.2778714
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 39 cost time: 0.9093549251556396
Epoch: 39, Steps: 64 | Train Loss: 0.0894588 Vali Loss: 0.2046120 Test Loss: 0.2781248
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 40 cost time: 0.9161043167114258
Epoch: 40, Steps: 64 | Train Loss: 0.0891860 Vali Loss: 0.2030125 Test Loss: 0.2785655
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 41 cost time: 0.9133784770965576
Epoch: 41, Steps: 64 | Train Loss: 0.0890103 Vali Loss: 0.2044052 Test Loss: 0.2768594
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 42 cost time: 0.9014058113098145
Epoch: 42, Steps: 64 | Train Loss: 0.0889098 Vali Loss: 0.2017731 Test Loss: 0.2766751
Validation loss decreased (0.202697 --> 0.201773).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 43 cost time: 0.9090003967285156
Epoch: 43, Steps: 64 | Train Loss: 0.0891376 Vali Loss: 0.2043099 Test Loss: 0.2763188
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 44 cost time: 0.9106266498565674
Epoch: 44, Steps: 64 | Train Loss: 0.0893338 Vali Loss: 0.2028304 Test Loss: 0.2776526
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 45 cost time: 0.9043986797332764
Epoch: 45, Steps: 64 | Train Loss: 0.0887022 Vali Loss: 0.2033149 Test Loss: 0.2771544
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 46 cost time: 0.9104511737823486
Epoch: 46, Steps: 64 | Train Loss: 0.0886430 Vali Loss: 0.2016190 Test Loss: 0.2783363
Validation loss decreased (0.201773 --> 0.201619).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 47 cost time: 0.9139571189880371
Epoch: 47, Steps: 64 | Train Loss: 0.0889970 Vali Loss: 0.2043643 Test Loss: 0.2770708
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 48 cost time: 0.9117541313171387
Epoch: 48, Steps: 64 | Train Loss: 0.0890948 Vali Loss: 0.2015503 Test Loss: 0.2770064
Validation loss decreased (0.201619 --> 0.201550).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 49 cost time: 0.8908250331878662
Epoch: 49, Steps: 64 | Train Loss: 0.0884422 Vali Loss: 0.2032799 Test Loss: 0.2766685
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 50 cost time: 0.9086103439331055
Epoch: 50, Steps: 64 | Train Loss: 0.0890893 Vali Loss: 0.2003091 Test Loss: 0.2781559
Validation loss decreased (0.201550 --> 0.200309).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 51 cost time: 0.911388635635376
Epoch: 51, Steps: 64 | Train Loss: 0.0883687 Vali Loss: 0.2054489 Test Loss: 0.2787172
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 52 cost time: 0.9247031211853027
Epoch: 52, Steps: 64 | Train Loss: 0.0889135 Vali Loss: 0.2007446 Test Loss: 0.2780169
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 53 cost time: 0.9166021347045898
Epoch: 53, Steps: 64 | Train Loss: 0.0886350 Vali Loss: 0.2036846 Test Loss: 0.2769755
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 54 cost time: 0.9129719734191895
Epoch: 54, Steps: 64 | Train Loss: 0.0886363 Vali Loss: 0.2016897 Test Loss: 0.2770763
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 55 cost time: 0.9133920669555664
Epoch: 55, Steps: 64 | Train Loss: 0.0889678 Vali Loss: 0.2032572 Test Loss: 0.2764648
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 56 cost time: 0.9169998168945312
Epoch: 56, Steps: 64 | Train Loss: 0.0885367 Vali Loss: 0.2030959 Test Loss: 0.2784260
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 57 cost time: 0.9076263904571533
Epoch: 57, Steps: 64 | Train Loss: 0.0881319 Vali Loss: 0.2004727 Test Loss: 0.2773001
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 58 cost time: 0.9139478206634521
Epoch: 58, Steps: 64 | Train Loss: 0.0885112 Vali Loss: 0.2019212 Test Loss: 0.2774319
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 59 cost time: 0.9224133491516113
Epoch: 59, Steps: 64 | Train Loss: 0.0891201 Vali Loss: 0.2015379 Test Loss: 0.2761803
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 60 cost time: 0.9080190658569336
Epoch: 60, Steps: 64 | Train Loss: 0.0881281 Vali Loss: 0.2022493 Test Loss: 0.2781746
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2781558930873871, mae:0.3412966728210449, rse:0.24205659329891205
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.05865907669067383 GB
Epoch: 1 cost time: 2.3156867027282715
Epoch: 1, Steps: 64 | Train Loss: 1.1180548 Vali Loss: 3.2820289 Test Loss: 5.8758078
Validation loss decreased (inf --> 3.282029).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 2 cost time: 0.9578571319580078
Epoch: 2, Steps: 64 | Train Loss: 0.6324297 Vali Loss: 0.9063439 Test Loss: 1.3590778
Validation loss decreased (3.282029 --> 0.906344).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 3 cost time: 0.9105885028839111
Epoch: 3, Steps: 64 | Train Loss: 0.2173130 Vali Loss: 0.3900587 Test Loss: 0.4171502
Validation loss decreased (0.906344 --> 0.390059).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 4 cost time: 0.9486284255981445
Epoch: 4, Steps: 64 | Train Loss: 0.1289015 Vali Loss: 0.2859883 Test Loss: 0.3104876
Validation loss decreased (0.390059 --> 0.285988).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 5 cost time: 0.9496254920959473
Epoch: 5, Steps: 64 | Train Loss: 0.1130620 Vali Loss: 0.2530266 Test Loss: 0.2935879
Validation loss decreased (0.285988 --> 0.253027).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 6 cost time: 0.9401249885559082
Epoch: 6, Steps: 64 | Train Loss: 0.1051794 Vali Loss: 0.2434122 Test Loss: 0.2893716
Validation loss decreased (0.253027 --> 0.243412).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 7 cost time: 0.9463660717010498
Epoch: 7, Steps: 64 | Train Loss: 0.1010527 Vali Loss: 0.2337279 Test Loss: 0.2791846
Validation loss decreased (0.243412 --> 0.233728).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 8 cost time: 0.9319407939910889
Epoch: 8, Steps: 64 | Train Loss: 0.0975169 Vali Loss: 0.2259556 Test Loss: 0.2766853
Validation loss decreased (0.233728 --> 0.225956).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 9 cost time: 0.9450225830078125
Epoch: 9, Steps: 64 | Train Loss: 0.0946430 Vali Loss: 0.2199311 Test Loss: 0.2715499
Validation loss decreased (0.225956 --> 0.219931).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 10 cost time: 0.9478483200073242
Epoch: 10, Steps: 64 | Train Loss: 0.0920613 Vali Loss: 0.2150271 Test Loss: 0.2715553
Validation loss decreased (0.219931 --> 0.215027).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 11 cost time: 0.9449999332427979
Epoch: 11, Steps: 64 | Train Loss: 0.0906831 Vali Loss: 0.2161824 Test Loss: 0.2686374
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 12 cost time: 0.9426157474517822
Epoch: 12, Steps: 64 | Train Loss: 0.0891612 Vali Loss: 0.2140014 Test Loss: 0.2683695
Validation loss decreased (0.215027 --> 0.214001).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 13 cost time: 0.9572315216064453
Epoch: 13, Steps: 64 | Train Loss: 0.0876845 Vali Loss: 0.2118884 Test Loss: 0.2639502
Validation loss decreased (0.214001 --> 0.211888).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 14 cost time: 0.9464230537414551
Epoch: 14, Steps: 64 | Train Loss: 0.0870197 Vali Loss: 0.2103866 Test Loss: 0.2671901
Validation loss decreased (0.211888 --> 0.210387).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 15 cost time: 0.9371347427368164
Epoch: 15, Steps: 64 | Train Loss: 0.0855642 Vali Loss: 0.2085008 Test Loss: 0.2610763
Validation loss decreased (0.210387 --> 0.208501).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 16 cost time: 0.9493622779846191
Epoch: 16, Steps: 64 | Train Loss: 0.0851622 Vali Loss: 0.2068038 Test Loss: 0.2635921
Validation loss decreased (0.208501 --> 0.206804).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 17 cost time: 0.9389469623565674
Epoch: 17, Steps: 64 | Train Loss: 0.0845335 Vali Loss: 0.2051040 Test Loss: 0.2601848
Validation loss decreased (0.206804 --> 0.205104).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 18 cost time: 0.9372456073760986
Epoch: 18, Steps: 64 | Train Loss: 0.0835588 Vali Loss: 0.2053043 Test Loss: 0.2624008
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 19 cost time: 0.9437339305877686
Epoch: 19, Steps: 64 | Train Loss: 0.0833939 Vali Loss: 0.2020730 Test Loss: 0.2612527
Validation loss decreased (0.205104 --> 0.202073).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 20 cost time: 0.9459500312805176
Epoch: 20, Steps: 64 | Train Loss: 0.0830863 Vali Loss: 0.2026167 Test Loss: 0.2591029
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 21 cost time: 0.9470579624176025
Epoch: 21, Steps: 64 | Train Loss: 0.0827685 Vali Loss: 0.2041948 Test Loss: 0.2578965
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 22 cost time: 0.9463992118835449
Epoch: 22, Steps: 64 | Train Loss: 0.0817985 Vali Loss: 0.2016570 Test Loss: 0.2609240
Validation loss decreased (0.202073 --> 0.201657).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 23 cost time: 0.9303488731384277
Epoch: 23, Steps: 64 | Train Loss: 0.0820514 Vali Loss: 0.2024610 Test Loss: 0.2601779
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 24 cost time: 0.9039816856384277
Epoch: 24, Steps: 64 | Train Loss: 0.0813805 Vali Loss: 0.2002817 Test Loss: 0.2580716
Validation loss decreased (0.201657 --> 0.200282).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 25 cost time: 0.9133613109588623
Epoch: 25, Steps: 64 | Train Loss: 0.0813294 Vali Loss: 0.2021125 Test Loss: 0.2608221
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 26 cost time: 0.9565093517303467
Epoch: 26, Steps: 64 | Train Loss: 0.0808605 Vali Loss: 0.1996318 Test Loss: 0.2580251
Validation loss decreased (0.200282 --> 0.199632).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 27 cost time: 0.9129996299743652
Epoch: 27, Steps: 64 | Train Loss: 0.0806195 Vali Loss: 0.2011285 Test Loss: 0.2582588
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 28 cost time: 0.9500000476837158
Epoch: 28, Steps: 64 | Train Loss: 0.0805989 Vali Loss: 0.1983590 Test Loss: 0.2573944
Validation loss decreased (0.199632 --> 0.198359).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 29 cost time: 0.9506254196166992
Epoch: 29, Steps: 64 | Train Loss: 0.0801938 Vali Loss: 0.1998280 Test Loss: 0.2585769
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 30 cost time: 0.9696059226989746
Epoch: 30, Steps: 64 | Train Loss: 0.0802225 Vali Loss: 0.1979470 Test Loss: 0.2585429
Validation loss decreased (0.198359 --> 0.197947).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 31 cost time: 0.9604907035827637
Epoch: 31, Steps: 64 | Train Loss: 0.0799589 Vali Loss: 0.1970915 Test Loss: 0.2569201
Validation loss decreased (0.197947 --> 0.197092).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 32 cost time: 0.9484341144561768
Epoch: 32, Steps: 64 | Train Loss: 0.0799964 Vali Loss: 0.1968582 Test Loss: 0.2586029
Validation loss decreased (0.197092 --> 0.196858).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 33 cost time: 0.9563612937927246
Epoch: 33, Steps: 64 | Train Loss: 0.0796009 Vali Loss: 0.1978904 Test Loss: 0.2572764
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 34 cost time: 0.9367103576660156
Epoch: 34, Steps: 64 | Train Loss: 0.0797885 Vali Loss: 0.1974886 Test Loss: 0.2576337
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 35 cost time: 0.9407317638397217
Epoch: 35, Steps: 64 | Train Loss: 0.0794200 Vali Loss: 0.1984969 Test Loss: 0.2586326
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 36 cost time: 0.9460000991821289
Epoch: 36, Steps: 64 | Train Loss: 0.0797097 Vali Loss: 0.1975020 Test Loss: 0.2579333
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 37 cost time: 0.9466228485107422
Epoch: 37, Steps: 64 | Train Loss: 0.0786728 Vali Loss: 0.1960775 Test Loss: 0.2571957
Validation loss decreased (0.196858 --> 0.196077).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 38 cost time: 0.9433295726776123
Epoch: 38, Steps: 64 | Train Loss: 0.0791972 Vali Loss: 0.1963242 Test Loss: 0.2573524
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 39 cost time: 0.9432268142700195
Epoch: 39, Steps: 64 | Train Loss: 0.0791229 Vali Loss: 0.1986478 Test Loss: 0.2573979
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 40 cost time: 0.9314026832580566
Epoch: 40, Steps: 64 | Train Loss: 0.0793668 Vali Loss: 0.1975437 Test Loss: 0.2567149
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 41 cost time: 0.9403796195983887
Epoch: 41, Steps: 64 | Train Loss: 0.0788349 Vali Loss: 0.1981098 Test Loss: 0.2581441
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 42 cost time: 0.9383575916290283
Epoch: 42, Steps: 64 | Train Loss: 0.0789995 Vali Loss: 0.2000891 Test Loss: 0.2578435
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 43 cost time: 0.9501917362213135
Epoch: 43, Steps: 64 | Train Loss: 0.0789515 Vali Loss: 0.1966033 Test Loss: 0.2568057
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 44 cost time: 0.9406144618988037
Epoch: 44, Steps: 64 | Train Loss: 0.0788934 Vali Loss: 0.1964733 Test Loss: 0.2571204
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 45 cost time: 0.9456262588500977
Epoch: 45, Steps: 64 | Train Loss: 0.0785775 Vali Loss: 0.1996016 Test Loss: 0.2572957
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 46 cost time: 0.9413473606109619
Epoch: 46, Steps: 64 | Train Loss: 0.0791838 Vali Loss: 0.1939322 Test Loss: 0.2573375
Validation loss decreased (0.196077 --> 0.193932).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 47 cost time: 0.9428939819335938
Epoch: 47, Steps: 64 | Train Loss: 0.0792974 Vali Loss: 0.1967248 Test Loss: 0.2569059
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 48 cost time: 0.9514548778533936
Epoch: 48, Steps: 64 | Train Loss: 0.0788002 Vali Loss: 0.1946813 Test Loss: 0.2568847
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 49 cost time: 0.9430863857269287
Epoch: 49, Steps: 64 | Train Loss: 0.0782172 Vali Loss: 0.1963907 Test Loss: 0.2568177
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 50 cost time: 0.950369119644165
Epoch: 50, Steps: 64 | Train Loss: 0.0787609 Vali Loss: 0.1940922 Test Loss: 0.2577614
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 51 cost time: 0.9427139759063721
Epoch: 51, Steps: 64 | Train Loss: 0.0787358 Vali Loss: 0.1954464 Test Loss: 0.2567093
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 52 cost time: 0.9413814544677734
Epoch: 52, Steps: 64 | Train Loss: 0.0786386 Vali Loss: 0.1981467 Test Loss: 0.2592057
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 53 cost time: 0.9416143894195557
Epoch: 53, Steps: 64 | Train Loss: 0.0787614 Vali Loss: 0.1979119 Test Loss: 0.2565539
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 54 cost time: 0.9692397117614746
Epoch: 54, Steps: 64 | Train Loss: 0.0786644 Vali Loss: 0.1955233 Test Loss: 0.2578584
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 55 cost time: 0.9493546485900879
Epoch: 55, Steps: 64 | Train Loss: 0.0786116 Vali Loss: 0.1969663 Test Loss: 0.2564028
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 56 cost time: 0.946758508682251
Epoch: 56, Steps: 64 | Train Loss: 0.0784999 Vali Loss: 0.1986648 Test Loss: 0.2563296
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 57 cost time: 0.9857041835784912
Epoch: 57, Steps: 64 | Train Loss: 0.0784028 Vali Loss: 0.1997823 Test Loss: 0.2579779
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 58 cost time: 1.007523775100708
Epoch: 58, Steps: 64 | Train Loss: 0.0781342 Vali Loss: 0.1968509 Test Loss: 0.2566206
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 59 cost time: 0.937481164932251
Epoch: 59, Steps: 64 | Train Loss: 0.0783648 Vali Loss: 0.1946035 Test Loss: 0.2562975
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 60 cost time: 0.9780700206756592
Epoch: 60, Steps: 64 | Train Loss: 0.0780358 Vali Loss: 0.1955160 Test Loss: 0.2571322
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2573375105857849, mae:0.3246303200721741, rse:0.23282216489315033
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.05977916717529297 GB
Epoch: 1 cost time: 2.286240339279175
Epoch: 1, Steps: 64 | Train Loss: 0.8389725 Vali Loss: 2.5693054 Test Loss: 4.5303054
Validation loss decreased (inf --> 2.569305).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 2 cost time: 0.902611494064331
Epoch: 2, Steps: 64 | Train Loss: 0.5172477 Vali Loss: 0.7296864 Test Loss: 1.0032228
Validation loss decreased (2.569305 --> 0.729686).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 3 cost time: 0.90240478515625
Epoch: 3, Steps: 64 | Train Loss: 0.1557160 Vali Loss: 0.2791710 Test Loss: 0.3090026
Validation loss decreased (0.729686 --> 0.279171).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 4 cost time: 0.8925457000732422
Epoch: 4, Steps: 64 | Train Loss: 0.0984981 Vali Loss: 0.2345812 Test Loss: 0.2851981
Validation loss decreased (0.279171 --> 0.234581).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 5 cost time: 0.9033825397491455
Epoch: 5, Steps: 64 | Train Loss: 0.0918032 Vali Loss: 0.2271954 Test Loss: 0.2863642
Validation loss decreased (0.234581 --> 0.227195).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 6 cost time: 0.8957042694091797
Epoch: 6, Steps: 64 | Train Loss: 0.0883557 Vali Loss: 0.2203589 Test Loss: 0.2811459
Validation loss decreased (0.227195 --> 0.220359).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 7 cost time: 0.901771068572998
Epoch: 7, Steps: 64 | Train Loss: 0.0851871 Vali Loss: 0.2128604 Test Loss: 0.2803330
Validation loss decreased (0.220359 --> 0.212860).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 8 cost time: 0.8979995250701904
Epoch: 8, Steps: 64 | Train Loss: 0.0836868 Vali Loss: 0.2090806 Test Loss: 0.2800904
Validation loss decreased (0.212860 --> 0.209081).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 9 cost time: 0.8926334381103516
Epoch: 9, Steps: 64 | Train Loss: 0.0818309 Vali Loss: 0.2055062 Test Loss: 0.2781374
Validation loss decreased (0.209081 --> 0.205506).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 10 cost time: 0.8964033126831055
Epoch: 10, Steps: 64 | Train Loss: 0.0811048 Vali Loss: 0.2035795 Test Loss: 0.2776438
Validation loss decreased (0.205506 --> 0.203580).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 11 cost time: 0.9123337268829346
Epoch: 11, Steps: 64 | Train Loss: 0.0798343 Vali Loss: 0.2016824 Test Loss: 0.2782805
Validation loss decreased (0.203580 --> 0.201682).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 12 cost time: 0.9033715724945068
Epoch: 12, Steps: 64 | Train Loss: 0.0785849 Vali Loss: 0.1967786 Test Loss: 0.2742218
Validation loss decreased (0.201682 --> 0.196779).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 13 cost time: 0.9037652015686035
Epoch: 13, Steps: 64 | Train Loss: 0.0772917 Vali Loss: 0.1976391 Test Loss: 0.2747670
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 14 cost time: 0.9079999923706055
Epoch: 14, Steps: 64 | Train Loss: 0.0770737 Vali Loss: 0.1969062 Test Loss: 0.2727874
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 15 cost time: 0.900615930557251
Epoch: 15, Steps: 64 | Train Loss: 0.0762158 Vali Loss: 0.1951290 Test Loss: 0.2725296
Validation loss decreased (0.196779 --> 0.195129).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 16 cost time: 0.9014487266540527
Epoch: 16, Steps: 64 | Train Loss: 0.0762603 Vali Loss: 0.1908746 Test Loss: 0.2712725
Validation loss decreased (0.195129 --> 0.190875).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 17 cost time: 0.8993971347808838
Epoch: 17, Steps: 64 | Train Loss: 0.0747856 Vali Loss: 0.1909993 Test Loss: 0.2699594
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 18 cost time: 0.912006139755249
Epoch: 18, Steps: 64 | Train Loss: 0.0748569 Vali Loss: 0.1924490 Test Loss: 0.2694955
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 19 cost time: 0.9007275104522705
Epoch: 19, Steps: 64 | Train Loss: 0.0738836 Vali Loss: 0.1898567 Test Loss: 0.2674847
Validation loss decreased (0.190875 --> 0.189857).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 20 cost time: 0.914172887802124
Epoch: 20, Steps: 64 | Train Loss: 0.0742196 Vali Loss: 0.1902998 Test Loss: 0.2682740
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 21 cost time: 0.8966357707977295
Epoch: 21, Steps: 64 | Train Loss: 0.0740171 Vali Loss: 0.1874349 Test Loss: 0.2663835
Validation loss decreased (0.189857 --> 0.187435).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 22 cost time: 0.8817858695983887
Epoch: 22, Steps: 64 | Train Loss: 0.0736609 Vali Loss: 0.1874895 Test Loss: 0.2669258
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 23 cost time: 0.8986139297485352
Epoch: 23, Steps: 64 | Train Loss: 0.0731372 Vali Loss: 0.1869475 Test Loss: 0.2659301
Validation loss decreased (0.187435 --> 0.186948).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 24 cost time: 0.8962266445159912
Epoch: 24, Steps: 64 | Train Loss: 0.0729151 Vali Loss: 0.1873764 Test Loss: 0.2645906
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 25 cost time: 0.9027302265167236
Epoch: 25, Steps: 64 | Train Loss: 0.0726255 Vali Loss: 0.1857968 Test Loss: 0.2659148
Validation loss decreased (0.186948 --> 0.185797).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 26 cost time: 0.8700017929077148
Epoch: 26, Steps: 64 | Train Loss: 0.0728041 Vali Loss: 0.1857357 Test Loss: 0.2642522
Validation loss decreased (0.185797 --> 0.185736).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 27 cost time: 0.8986151218414307
Epoch: 27, Steps: 64 | Train Loss: 0.0721367 Vali Loss: 0.1869105 Test Loss: 0.2643667
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 28 cost time: 0.9003462791442871
Epoch: 28, Steps: 64 | Train Loss: 0.0723772 Vali Loss: 0.1860992 Test Loss: 0.2633947
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 29 cost time: 0.8934826850891113
Epoch: 29, Steps: 64 | Train Loss: 0.0718651 Vali Loss: 0.1875892 Test Loss: 0.2643750
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 30 cost time: 0.9045443534851074
Epoch: 30, Steps: 64 | Train Loss: 0.0719396 Vali Loss: 0.1855558 Test Loss: 0.2635533
Validation loss decreased (0.185736 --> 0.185556).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 31 cost time: 0.903723955154419
Epoch: 31, Steps: 64 | Train Loss: 0.0716084 Vali Loss: 0.1870721 Test Loss: 0.2643610
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 32 cost time: 0.9176425933837891
Epoch: 32, Steps: 64 | Train Loss: 0.0717160 Vali Loss: 0.1859706 Test Loss: 0.2629444
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 33 cost time: 0.9003894329071045
Epoch: 33, Steps: 64 | Train Loss: 0.0718150 Vali Loss: 0.1831125 Test Loss: 0.2631169
Validation loss decreased (0.185556 --> 0.183112).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 34 cost time: 0.8973839282989502
Epoch: 34, Steps: 64 | Train Loss: 0.0718180 Vali Loss: 0.1878986 Test Loss: 0.2647087
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 35 cost time: 0.8953795433044434
Epoch: 35, Steps: 64 | Train Loss: 0.0718764 Vali Loss: 0.1864600 Test Loss: 0.2633522
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 36 cost time: 0.9083845615386963
Epoch: 36, Steps: 64 | Train Loss: 0.0717289 Vali Loss: 0.1849054 Test Loss: 0.2637230
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 37 cost time: 0.8987412452697754
Epoch: 37, Steps: 64 | Train Loss: 0.0715301 Vali Loss: 0.1842017 Test Loss: 0.2637540
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 38 cost time: 0.9086353778839111
Epoch: 38, Steps: 64 | Train Loss: 0.0716690 Vali Loss: 0.1856352 Test Loss: 0.2632985
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 39 cost time: 0.9070000648498535
Epoch: 39, Steps: 64 | Train Loss: 0.0714151 Vali Loss: 0.1844799 Test Loss: 0.2621033
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 40 cost time: 0.9056174755096436
Epoch: 40, Steps: 64 | Train Loss: 0.0718071 Vali Loss: 0.1858601 Test Loss: 0.2625255
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 41 cost time: 0.9033632278442383
Epoch: 41, Steps: 64 | Train Loss: 0.0712564 Vali Loss: 0.1834648 Test Loss: 0.2623283
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 42 cost time: 0.9054832458496094
Epoch: 42, Steps: 64 | Train Loss: 0.0713745 Vali Loss: 0.1829994 Test Loss: 0.2618646
Validation loss decreased (0.183112 --> 0.182999).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 43 cost time: 0.9173810482025146
Epoch: 43, Steps: 64 | Train Loss: 0.0711418 Vali Loss: 0.1850313 Test Loss: 0.2627032
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 44 cost time: 0.9106700420379639
Epoch: 44, Steps: 64 | Train Loss: 0.0709851 Vali Loss: 0.1833631 Test Loss: 0.2630205
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 45 cost time: 0.9059998989105225
Epoch: 45, Steps: 64 | Train Loss: 0.0715515 Vali Loss: 0.1832439 Test Loss: 0.2620142
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 46 cost time: 0.9034483432769775
Epoch: 46, Steps: 64 | Train Loss: 0.0713387 Vali Loss: 0.1839980 Test Loss: 0.2630383
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 47 cost time: 0.8902029991149902
Epoch: 47, Steps: 64 | Train Loss: 0.0715057 Vali Loss: 0.1843448 Test Loss: 0.2623961
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 48 cost time: 0.8845915794372559
Epoch: 48, Steps: 64 | Train Loss: 0.0710269 Vali Loss: 0.1851333 Test Loss: 0.2631118
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 49 cost time: 0.9093959331512451
Epoch: 49, Steps: 64 | Train Loss: 0.0713777 Vali Loss: 0.1812655 Test Loss: 0.2625329
Validation loss decreased (0.182999 --> 0.181266).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 50 cost time: 0.9218039512634277
Epoch: 50, Steps: 64 | Train Loss: 0.0712226 Vali Loss: 0.1858824 Test Loss: 0.2618584
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 51 cost time: 0.8706710338592529
Epoch: 51, Steps: 64 | Train Loss: 0.0711109 Vali Loss: 0.1824163 Test Loss: 0.2618953
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 52 cost time: 0.9006199836730957
Epoch: 52, Steps: 64 | Train Loss: 0.0712781 Vali Loss: 0.1839035 Test Loss: 0.2644958
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 53 cost time: 0.9024529457092285
Epoch: 53, Steps: 64 | Train Loss: 0.0708626 Vali Loss: 0.1836802 Test Loss: 0.2619987
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 54 cost time: 0.9054975509643555
Epoch: 54, Steps: 64 | Train Loss: 0.0712523 Vali Loss: 0.1833794 Test Loss: 0.2631750
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 55 cost time: 0.8953452110290527
Epoch: 55, Steps: 64 | Train Loss: 0.0710241 Vali Loss: 0.1872818 Test Loss: 0.2635363
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 56 cost time: 0.9062669277191162
Epoch: 56, Steps: 64 | Train Loss: 0.0713340 Vali Loss: 0.1848889 Test Loss: 0.2627752
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 57 cost time: 0.9150009155273438
Epoch: 57, Steps: 64 | Train Loss: 0.0713365 Vali Loss: 0.1824293 Test Loss: 0.2622515
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 58 cost time: 0.9056270122528076
Epoch: 58, Steps: 64 | Train Loss: 0.0713261 Vali Loss: 0.1832018 Test Loss: 0.2621897
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 59 cost time: 0.9024639129638672
Epoch: 59, Steps: 64 | Train Loss: 0.0712617 Vali Loss: 0.1855995 Test Loss: 0.2630261
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 60 cost time: 0.9003860950469971
Epoch: 60, Steps: 64 | Train Loss: 0.0710766 Vali Loss: 0.1805793 Test Loss: 0.2618431
Validation loss decreased (0.181266 --> 0.180579).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.26184314489364624, mae:0.3340059220790863, rse:0.23485153913497925
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.057389259338378906 GB
Epoch: 1 cost time: 2.2644026279449463
Epoch: 1, Steps: 64 | Train Loss: 1.1432633 Vali Loss: 2.9417870 Test Loss: 5.2343979
Validation loss decreased (inf --> 2.941787).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 2 cost time: 0.9253833293914795
Epoch: 2, Steps: 64 | Train Loss: 0.5690724 Vali Loss: 0.5599053 Test Loss: 0.7291284
Validation loss decreased (2.941787 --> 0.559905).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 3 cost time: 0.9260005950927734
Epoch: 3, Steps: 64 | Train Loss: 0.2206396 Vali Loss: 0.3453835 Test Loss: 0.3590415
Validation loss decreased (0.559905 --> 0.345383).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 4 cost time: 0.9286212921142578
Epoch: 4, Steps: 64 | Train Loss: 0.1681660 Vali Loss: 0.2925292 Test Loss: 0.3194574
Validation loss decreased (0.345383 --> 0.292529).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 5 cost time: 0.9274337291717529
Epoch: 5, Steps: 64 | Train Loss: 0.1492565 Vali Loss: 0.2788380 Test Loss: 0.3064682
Validation loss decreased (0.292529 --> 0.278838).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 6 cost time: 0.9282493591308594
Epoch: 6, Steps: 64 | Train Loss: 0.1381561 Vali Loss: 0.2612578 Test Loss: 0.3039277
Validation loss decreased (0.278838 --> 0.261258).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 7 cost time: 0.9244320392608643
Epoch: 7, Steps: 64 | Train Loss: 0.1304340 Vali Loss: 0.2505739 Test Loss: 0.2996993
Validation loss decreased (0.261258 --> 0.250574).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 8 cost time: 0.9284884929656982
Epoch: 8, Steps: 64 | Train Loss: 0.1242839 Vali Loss: 0.2422861 Test Loss: 0.2994195
Validation loss decreased (0.250574 --> 0.242286).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 9 cost time: 0.9184694290161133
Epoch: 9, Steps: 64 | Train Loss: 0.1197570 Vali Loss: 0.2395123 Test Loss: 0.2969863
Validation loss decreased (0.242286 --> 0.239512).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 10 cost time: 0.9291510581970215
Epoch: 10, Steps: 64 | Train Loss: 0.1168409 Vali Loss: 0.2317148 Test Loss: 0.2939837
Validation loss decreased (0.239512 --> 0.231715).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 11 cost time: 0.9456241130828857
Epoch: 11, Steps: 64 | Train Loss: 0.1137865 Vali Loss: 0.2253961 Test Loss: 0.2943417
Validation loss decreased (0.231715 --> 0.225396).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 12 cost time: 0.9300003051757812
Epoch: 12, Steps: 64 | Train Loss: 0.1111177 Vali Loss: 0.2235808 Test Loss: 0.2960133
Validation loss decreased (0.225396 --> 0.223581).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 13 cost time: 0.9286208152770996
Epoch: 13, Steps: 64 | Train Loss: 0.1103439 Vali Loss: 0.2219604 Test Loss: 0.2935331
Validation loss decreased (0.223581 --> 0.221960).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 14 cost time: 0.9240307807922363
Epoch: 14, Steps: 64 | Train Loss: 0.1080310 Vali Loss: 0.2199169 Test Loss: 0.2941386
Validation loss decreased (0.221960 --> 0.219917).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 15 cost time: 0.9353728294372559
Epoch: 15, Steps: 64 | Train Loss: 0.1061116 Vali Loss: 0.2165949 Test Loss: 0.2943413
Validation loss decreased (0.219917 --> 0.216595).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 16 cost time: 0.9213805198669434
Epoch: 16, Steps: 64 | Train Loss: 0.1050340 Vali Loss: 0.2162919 Test Loss: 0.2934838
Validation loss decreased (0.216595 --> 0.216292).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 17 cost time: 0.920391321182251
Epoch: 17, Steps: 64 | Train Loss: 0.1044231 Vali Loss: 0.2151041 Test Loss: 0.2918690
Validation loss decreased (0.216292 --> 0.215104).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 18 cost time: 0.9391353130340576
Epoch: 18, Steps: 64 | Train Loss: 0.1033392 Vali Loss: 0.2155479 Test Loss: 0.2909086
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 19 cost time: 0.9383397102355957
Epoch: 19, Steps: 64 | Train Loss: 0.1020613 Vali Loss: 0.2136548 Test Loss: 0.2924808
Validation loss decreased (0.215104 --> 0.213655).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 20 cost time: 0.9306461811065674
Epoch: 20, Steps: 64 | Train Loss: 0.1014880 Vali Loss: 0.2111491 Test Loss: 0.2918577
Validation loss decreased (0.213655 --> 0.211149).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 21 cost time: 0.9376089572906494
Epoch: 21, Steps: 64 | Train Loss: 0.1009103 Vali Loss: 0.2111278 Test Loss: 0.2912246
Validation loss decreased (0.211149 --> 0.211128).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 22 cost time: 0.9168896675109863
Epoch: 22, Steps: 64 | Train Loss: 0.0999242 Vali Loss: 0.2078257 Test Loss: 0.2914503
Validation loss decreased (0.211128 --> 0.207826).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 23 cost time: 0.9430112838745117
Epoch: 23, Steps: 64 | Train Loss: 0.0992250 Vali Loss: 0.2098575 Test Loss: 0.2909256
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 24 cost time: 0.9393601417541504
Epoch: 24, Steps: 64 | Train Loss: 0.0990562 Vali Loss: 0.2099101 Test Loss: 0.2912440
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 25 cost time: 0.9385013580322266
Epoch: 25, Steps: 64 | Train Loss: 0.0985123 Vali Loss: 0.2097101 Test Loss: 0.2907050
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 26 cost time: 0.9197850227355957
Epoch: 26, Steps: 64 | Train Loss: 0.0984728 Vali Loss: 0.2086901 Test Loss: 0.2897241
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 27 cost time: 0.9239997863769531
Epoch: 27, Steps: 64 | Train Loss: 0.0980786 Vali Loss: 0.2079662 Test Loss: 0.2892046
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 28 cost time: 0.9236218929290771
Epoch: 28, Steps: 64 | Train Loss: 0.0975890 Vali Loss: 0.2042641 Test Loss: 0.2898409
Validation loss decreased (0.207826 --> 0.204264).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 29 cost time: 0.9283642768859863
Epoch: 29, Steps: 64 | Train Loss: 0.0968627 Vali Loss: 0.2043757 Test Loss: 0.2900419
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 30 cost time: 0.9264054298400879
Epoch: 30, Steps: 64 | Train Loss: 0.0970143 Vali Loss: 0.2045596 Test Loss: 0.2902538
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 31 cost time: 0.9213790893554688
Epoch: 31, Steps: 64 | Train Loss: 0.0964639 Vali Loss: 0.2044584 Test Loss: 0.2907909
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 32 cost time: 0.9337718486785889
Epoch: 32, Steps: 64 | Train Loss: 0.0958780 Vali Loss: 0.2078694 Test Loss: 0.2898989
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 33 cost time: 0.9187743663787842
Epoch: 33, Steps: 64 | Train Loss: 0.0960755 Vali Loss: 0.2051524 Test Loss: 0.2906197
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 34 cost time: 0.9199998378753662
Epoch: 34, Steps: 64 | Train Loss: 0.0959960 Vali Loss: 0.2029119 Test Loss: 0.2904443
Validation loss decreased (0.204264 --> 0.202912).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 35 cost time: 0.9346299171447754
Epoch: 35, Steps: 64 | Train Loss: 0.0954346 Vali Loss: 0.2059942 Test Loss: 0.2903554
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 36 cost time: 0.9257502555847168
Epoch: 36, Steps: 64 | Train Loss: 0.0955872 Vali Loss: 0.2028582 Test Loss: 0.2898396
Validation loss decreased (0.202912 --> 0.202858).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 37 cost time: 0.9223694801330566
Epoch: 37, Steps: 64 | Train Loss: 0.0953229 Vali Loss: 0.2045982 Test Loss: 0.2883232
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 38 cost time: 0.929354190826416
Epoch: 38, Steps: 64 | Train Loss: 0.0953645 Vali Loss: 0.2043351 Test Loss: 0.2899736
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 39 cost time: 0.9384808540344238
Epoch: 39, Steps: 64 | Train Loss: 0.0950068 Vali Loss: 0.2034895 Test Loss: 0.2886163
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 40 cost time: 0.9247422218322754
Epoch: 40, Steps: 64 | Train Loss: 0.0956258 Vali Loss: 0.2035293 Test Loss: 0.2885875
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 41 cost time: 0.9224529266357422
Epoch: 41, Steps: 64 | Train Loss: 0.0949266 Vali Loss: 0.2044562 Test Loss: 0.2889016
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 42 cost time: 0.933643102645874
Epoch: 42, Steps: 64 | Train Loss: 0.0950898 Vali Loss: 0.2056951 Test Loss: 0.2881482
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 43 cost time: 0.9166233539581299
Epoch: 43, Steps: 64 | Train Loss: 0.0948453 Vali Loss: 0.2052353 Test Loss: 0.2881027
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 44 cost time: 0.9203939437866211
Epoch: 44, Steps: 64 | Train Loss: 0.0948850 Vali Loss: 0.2039955 Test Loss: 0.2884112
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 45 cost time: 0.9233503341674805
Epoch: 45, Steps: 64 | Train Loss: 0.0949206 Vali Loss: 0.2038915 Test Loss: 0.2895317
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 46 cost time: 0.9160652160644531
Epoch: 46, Steps: 64 | Train Loss: 0.0948998 Vali Loss: 0.2047476 Test Loss: 0.2879332
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 47 cost time: 0.9104194641113281
Epoch: 47, Steps: 64 | Train Loss: 0.0941605 Vali Loss: 0.2001525 Test Loss: 0.2882403
Validation loss decreased (0.202858 --> 0.200152).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 48 cost time: 0.9529998302459717
Epoch: 48, Steps: 64 | Train Loss: 0.0945911 Vali Loss: 0.2030123 Test Loss: 0.2891891
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 49 cost time: 0.9559733867645264
Epoch: 49, Steps: 64 | Train Loss: 0.0938573 Vali Loss: 0.2041992 Test Loss: 0.2882949
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 50 cost time: 0.8997900485992432
Epoch: 50, Steps: 64 | Train Loss: 0.0942380 Vali Loss: 0.2023063 Test Loss: 0.2884420
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 51 cost time: 0.9302847385406494
Epoch: 51, Steps: 64 | Train Loss: 0.0947165 Vali Loss: 0.2038591 Test Loss: 0.2894695
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 52 cost time: 0.9244389533996582
Epoch: 52, Steps: 64 | Train Loss: 0.0939501 Vali Loss: 0.2049788 Test Loss: 0.2879253
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 53 cost time: 0.9464325904846191
Epoch: 53, Steps: 64 | Train Loss: 0.0945373 Vali Loss: 0.2025459 Test Loss: 0.2883912
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 54 cost time: 0.9363417625427246
Epoch: 54, Steps: 64 | Train Loss: 0.0941773 Vali Loss: 0.2030449 Test Loss: 0.2886513
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 55 cost time: 0.9307568073272705
Epoch: 55, Steps: 64 | Train Loss: 0.0944799 Vali Loss: 0.2005247 Test Loss: 0.2886378
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 56 cost time: 0.937000036239624
Epoch: 56, Steps: 64 | Train Loss: 0.0940740 Vali Loss: 0.2021439 Test Loss: 0.2868783
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 57 cost time: 0.9226157665252686
Epoch: 57, Steps: 64 | Train Loss: 0.0939611 Vali Loss: 0.2012946 Test Loss: 0.2880171
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 58 cost time: 0.9242532253265381
Epoch: 58, Steps: 64 | Train Loss: 0.0942804 Vali Loss: 0.2011273 Test Loss: 0.2881876
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 59 cost time: 0.9239435195922852
Epoch: 59, Steps: 64 | Train Loss: 0.0936769 Vali Loss: 0.2035193 Test Loss: 0.2890728
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 60 cost time: 0.9354043006896973
Epoch: 60, Steps: 64 | Train Loss: 0.0940645 Vali Loss: 0.2009894 Test Loss: 0.2887590
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2882402539253235, mae:0.34859079122543335, rse:0.24640534818172455
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.05882120132446289 GB
Epoch: 1 cost time: 2.3451197147369385
Epoch: 1, Steps: 64 | Train Loss: 0.9125455 Vali Loss: 2.7133975 Test Loss: 4.7093678
Validation loss decreased (inf --> 2.713398).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 2 cost time: 0.9497084617614746
Epoch: 2, Steps: 64 | Train Loss: 0.5088486 Vali Loss: 0.7032119 Test Loss: 0.8934815
Validation loss decreased (2.713398 --> 0.703212).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 3 cost time: 0.9541459083557129
Epoch: 3, Steps: 64 | Train Loss: 0.1680698 Vali Loss: 0.3224320 Test Loss: 0.3067628
Validation loss decreased (0.703212 --> 0.322432).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 4 cost time: 1.0110023021697998
Epoch: 4, Steps: 64 | Train Loss: 0.1132992 Vali Loss: 0.2652355 Test Loss: 0.2870890
Validation loss decreased (0.322432 --> 0.265236).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 5 cost time: 0.9619390964508057
Epoch: 5, Steps: 64 | Train Loss: 0.1040090 Vali Loss: 0.2436018 Test Loss: 0.2850967
Validation loss decreased (0.265236 --> 0.243602).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 6 cost time: 0.9616389274597168
Epoch: 6, Steps: 64 | Train Loss: 0.0987279 Vali Loss: 0.2314874 Test Loss: 0.2858180
Validation loss decreased (0.243602 --> 0.231487).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 7 cost time: 0.9506320953369141
Epoch: 7, Steps: 64 | Train Loss: 0.0946233 Vali Loss: 0.2258481 Test Loss: 0.2871777
Validation loss decreased (0.231487 --> 0.225848).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 8 cost time: 0.9533843994140625
Epoch: 8, Steps: 64 | Train Loss: 0.0918691 Vali Loss: 0.2220375 Test Loss: 0.2845222
Validation loss decreased (0.225848 --> 0.222038).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 9 cost time: 0.9603908061981201
Epoch: 9, Steps: 64 | Train Loss: 0.0897380 Vali Loss: 0.2208844 Test Loss: 0.2835955
Validation loss decreased (0.222038 --> 0.220884).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 10 cost time: 0.9611682891845703
Epoch: 10, Steps: 64 | Train Loss: 0.0884743 Vali Loss: 0.2121965 Test Loss: 0.2842937
Validation loss decreased (0.220884 --> 0.212196).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 11 cost time: 0.9573779106140137
Epoch: 11, Steps: 64 | Train Loss: 0.0870946 Vali Loss: 0.2113629 Test Loss: 0.2849466
Validation loss decreased (0.212196 --> 0.211363).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 12 cost time: 0.9584488868713379
Epoch: 12, Steps: 64 | Train Loss: 0.0858339 Vali Loss: 0.2080567 Test Loss: 0.2834365
Validation loss decreased (0.211363 --> 0.208057).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 13 cost time: 0.97684645652771
Epoch: 13, Steps: 64 | Train Loss: 0.0846623 Vali Loss: 0.2066519 Test Loss: 0.2837383
Validation loss decreased (0.208057 --> 0.206652).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 14 cost time: 0.9550001621246338
Epoch: 14, Steps: 64 | Train Loss: 0.0839636 Vali Loss: 0.2056262 Test Loss: 0.2848764
Validation loss decreased (0.206652 --> 0.205626).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 15 cost time: 0.956733226776123
Epoch: 15, Steps: 64 | Train Loss: 0.0831121 Vali Loss: 0.2028597 Test Loss: 0.2836793
Validation loss decreased (0.205626 --> 0.202860).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 16 cost time: 0.9646284580230713
Epoch: 16, Steps: 64 | Train Loss: 0.0821896 Vali Loss: 0.2019883 Test Loss: 0.2824581
Validation loss decreased (0.202860 --> 0.201988).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 17 cost time: 0.9464359283447266
Epoch: 17, Steps: 64 | Train Loss: 0.0816045 Vali Loss: 0.2005030 Test Loss: 0.2830459
Validation loss decreased (0.201988 --> 0.200503).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 18 cost time: 0.9604606628417969
Epoch: 18, Steps: 64 | Train Loss: 0.0810935 Vali Loss: 0.1973414 Test Loss: 0.2821744
Validation loss decreased (0.200503 --> 0.197341).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 19 cost time: 0.9600231647491455
Epoch: 19, Steps: 64 | Train Loss: 0.0805988 Vali Loss: 0.1990255 Test Loss: 0.2814875
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 20 cost time: 0.9589707851409912
Epoch: 20, Steps: 64 | Train Loss: 0.0802983 Vali Loss: 0.1989465 Test Loss: 0.2827758
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 21 cost time: 0.9613814353942871
Epoch: 21, Steps: 64 | Train Loss: 0.0797792 Vali Loss: 0.1980489 Test Loss: 0.2819286
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 22 cost time: 0.9540138244628906
Epoch: 22, Steps: 64 | Train Loss: 0.0794878 Vali Loss: 0.1959392 Test Loss: 0.2813907
Validation loss decreased (0.197341 --> 0.195939).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 23 cost time: 0.9294049739837646
Epoch: 23, Steps: 64 | Train Loss: 0.0794208 Vali Loss: 0.1947088 Test Loss: 0.2809918
Validation loss decreased (0.195939 --> 0.194709).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 24 cost time: 0.9108912944793701
Epoch: 24, Steps: 64 | Train Loss: 0.0787453 Vali Loss: 0.1976943 Test Loss: 0.2804879
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 25 cost time: 0.9276289939880371
Epoch: 25, Steps: 64 | Train Loss: 0.0783827 Vali Loss: 0.1930574 Test Loss: 0.2808670
Validation loss decreased (0.194709 --> 0.193057).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 26 cost time: 0.9503467082977295
Epoch: 26, Steps: 64 | Train Loss: 0.0781019 Vali Loss: 0.1936106 Test Loss: 0.2803322
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 27 cost time: 0.933194637298584
Epoch: 27, Steps: 64 | Train Loss: 0.0784087 Vali Loss: 0.1942621 Test Loss: 0.2798670
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 28 cost time: 0.9356796741485596
Epoch: 28, Steps: 64 | Train Loss: 0.0778321 Vali Loss: 0.1943167 Test Loss: 0.2798719
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 29 cost time: 0.9653992652893066
Epoch: 29, Steps: 64 | Train Loss: 0.0776451 Vali Loss: 0.1926958 Test Loss: 0.2798384
Validation loss decreased (0.193057 --> 0.192696).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 30 cost time: 0.9692449569702148
Epoch: 30, Steps: 64 | Train Loss: 0.0775724 Vali Loss: 0.1945711 Test Loss: 0.2791493
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 31 cost time: 0.9529576301574707
Epoch: 31, Steps: 64 | Train Loss: 0.0774773 Vali Loss: 0.1917340 Test Loss: 0.2809416
Validation loss decreased (0.192696 --> 0.191734).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 32 cost time: 0.9513916969299316
Epoch: 32, Steps: 64 | Train Loss: 0.0774950 Vali Loss: 0.1927296 Test Loss: 0.2804987
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 33 cost time: 0.9666352272033691
Epoch: 33, Steps: 64 | Train Loss: 0.0772723 Vali Loss: 0.1936690 Test Loss: 0.2807383
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 34 cost time: 0.9496221542358398
Epoch: 34, Steps: 64 | Train Loss: 0.0770069 Vali Loss: 0.1912021 Test Loss: 0.2803622
Validation loss decreased (0.191734 --> 0.191202).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 35 cost time: 0.9514737129211426
Epoch: 35, Steps: 64 | Train Loss: 0.0768086 Vali Loss: 0.1923889 Test Loss: 0.2795155
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 36 cost time: 0.9583368301391602
Epoch: 36, Steps: 64 | Train Loss: 0.0768884 Vali Loss: 0.1926126 Test Loss: 0.2796825
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 37 cost time: 0.9584555625915527
Epoch: 37, Steps: 64 | Train Loss: 0.0768560 Vali Loss: 0.1915614 Test Loss: 0.2791471
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 38 cost time: 0.9503600597381592
Epoch: 38, Steps: 64 | Train Loss: 0.0766820 Vali Loss: 0.1906044 Test Loss: 0.2802743
Validation loss decreased (0.191202 --> 0.190604).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 39 cost time: 0.9437978267669678
Epoch: 39, Steps: 64 | Train Loss: 0.0767158 Vali Loss: 0.1930382 Test Loss: 0.2794866
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 40 cost time: 0.9284088611602783
Epoch: 40, Steps: 64 | Train Loss: 0.0766559 Vali Loss: 0.1922673 Test Loss: 0.2801766
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 41 cost time: 0.9420011043548584
Epoch: 41, Steps: 64 | Train Loss: 0.0769752 Vali Loss: 0.1895115 Test Loss: 0.2796460
Validation loss decreased (0.190604 --> 0.189511).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 42 cost time: 0.9436371326446533
Epoch: 42, Steps: 64 | Train Loss: 0.0762484 Vali Loss: 0.1919127 Test Loss: 0.2794870
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 43 cost time: 0.9485132694244385
Epoch: 43, Steps: 64 | Train Loss: 0.0762812 Vali Loss: 0.1916258 Test Loss: 0.2796277
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 44 cost time: 0.9475784301757812
Epoch: 44, Steps: 64 | Train Loss: 0.0763808 Vali Loss: 0.1912064 Test Loss: 0.2801727
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 45 cost time: 0.9483833312988281
Epoch: 45, Steps: 64 | Train Loss: 0.0768351 Vali Loss: 0.1915770 Test Loss: 0.2806207
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 46 cost time: 0.9483802318572998
Epoch: 46, Steps: 64 | Train Loss: 0.0766792 Vali Loss: 0.1916623 Test Loss: 0.2801312
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 47 cost time: 0.9366066455841064
Epoch: 47, Steps: 64 | Train Loss: 0.0767751 Vali Loss: 0.1928708 Test Loss: 0.2797204
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 48 cost time: 0.9447357654571533
Epoch: 48, Steps: 64 | Train Loss: 0.0761344 Vali Loss: 0.1873345 Test Loss: 0.2803907
Validation loss decreased (0.189511 --> 0.187334).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 49 cost time: 0.9476168155670166
Epoch: 49, Steps: 64 | Train Loss: 0.0766524 Vali Loss: 0.1898997 Test Loss: 0.2791649
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 50 cost time: 0.9626142978668213
Epoch: 50, Steps: 64 | Train Loss: 0.0764993 Vali Loss: 0.1911602 Test Loss: 0.2797936
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 51 cost time: 0.9483764171600342
Epoch: 51, Steps: 64 | Train Loss: 0.0766802 Vali Loss: 0.1921732 Test Loss: 0.2794277
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 52 cost time: 0.9513816833496094
Epoch: 52, Steps: 64 | Train Loss: 0.0767183 Vali Loss: 0.1931185 Test Loss: 0.2794107
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 53 cost time: 0.950669527053833
Epoch: 53, Steps: 64 | Train Loss: 0.0763246 Vali Loss: 0.1923481 Test Loss: 0.2799838
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 54 cost time: 0.9643750190734863
Epoch: 54, Steps: 64 | Train Loss: 0.0765604 Vali Loss: 0.1896696 Test Loss: 0.2790703
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 55 cost time: 0.9582257270812988
Epoch: 55, Steps: 64 | Train Loss: 0.0765516 Vali Loss: 0.1909646 Test Loss: 0.2791533
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 56 cost time: 0.9562740325927734
Epoch: 56, Steps: 64 | Train Loss: 0.0763524 Vali Loss: 0.1901638 Test Loss: 0.2795417
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 57 cost time: 0.9611716270446777
Epoch: 57, Steps: 64 | Train Loss: 0.0763491 Vali Loss: 0.1926787 Test Loss: 0.2794237
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 58 cost time: 0.9580001831054688
Epoch: 58, Steps: 64 | Train Loss: 0.0761214 Vali Loss: 0.1930645 Test Loss: 0.2790654
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 59 cost time: 0.95863938331604
Epoch: 59, Steps: 64 | Train Loss: 0.0764409 Vali Loss: 0.1907690 Test Loss: 0.2802519
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 60 cost time: 0.9676225185394287
Epoch: 60, Steps: 64 | Train Loss: 0.0763574 Vali Loss: 0.1916673 Test Loss: 0.2791553
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.28039076924324036, mae:0.3432883620262146, rse:0.24302706122398376
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.05994129180908203 GB
Epoch: 1 cost time: 2.361260414123535
Epoch: 1, Steps: 64 | Train Loss: 0.8116796 Vali Loss: 2.4968226 Test Loss: 4.3980980
Validation loss decreased (inf --> 2.496823).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 2 cost time: 0.9899725914001465
Epoch: 2, Steps: 64 | Train Loss: 0.4933393 Vali Loss: 0.6065515 Test Loss: 0.8622389
Validation loss decreased (2.496823 --> 0.606551).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 3 cost time: 0.9924073219299316
Epoch: 3, Steps: 64 | Train Loss: 0.1401767 Vali Loss: 0.2806150 Test Loss: 0.3279351
Validation loss decreased (0.606551 --> 0.280615).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 4 cost time: 0.9655711650848389
Epoch: 4, Steps: 64 | Train Loss: 0.1026404 Vali Loss: 0.2504011 Test Loss: 0.3040403
Validation loss decreased (0.280615 --> 0.250401).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 5 cost time: 0.9816300868988037
Epoch: 5, Steps: 64 | Train Loss: 0.0940232 Vali Loss: 0.2341533 Test Loss: 0.2879797
Validation loss decreased (0.250401 --> 0.234153).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 6 cost time: 0.9823768138885498
Epoch: 6, Steps: 64 | Train Loss: 0.0898113 Vali Loss: 0.2255058 Test Loss: 0.2857453
Validation loss decreased (0.234153 --> 0.225506).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 7 cost time: 0.9777476787567139
Epoch: 7, Steps: 64 | Train Loss: 0.0872853 Vali Loss: 0.2199397 Test Loss: 0.2790609
Validation loss decreased (0.225506 --> 0.219940).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 8 cost time: 0.9837539196014404
Epoch: 8, Steps: 64 | Train Loss: 0.0853733 Vali Loss: 0.2214047 Test Loss: 0.2802537
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 9 cost time: 0.9870004653930664
Epoch: 9, Steps: 64 | Train Loss: 0.0835064 Vali Loss: 0.2156570 Test Loss: 0.2781331
Validation loss decreased (0.219940 --> 0.215657).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 10 cost time: 0.995248556137085
Epoch: 10, Steps: 64 | Train Loss: 0.0815662 Vali Loss: 0.2141942 Test Loss: 0.2791477
Validation loss decreased (0.215657 --> 0.214194).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 11 cost time: 0.9836146831512451
Epoch: 11, Steps: 64 | Train Loss: 0.0807676 Vali Loss: 0.2080718 Test Loss: 0.2778601
Validation loss decreased (0.214194 --> 0.208072).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 12 cost time: 0.9864242076873779
Epoch: 12, Steps: 64 | Train Loss: 0.0792167 Vali Loss: 0.2040281 Test Loss: 0.2786995
Validation loss decreased (0.208072 --> 0.204028).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 13 cost time: 0.9973893165588379
Epoch: 13, Steps: 64 | Train Loss: 0.0784253 Vali Loss: 0.2074475 Test Loss: 0.2764395
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 14 cost time: 0.981788158416748
Epoch: 14, Steps: 64 | Train Loss: 0.0774054 Vali Loss: 0.2006171 Test Loss: 0.2743279
Validation loss decreased (0.204028 --> 0.200617).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 15 cost time: 0.9793558120727539
Epoch: 15, Steps: 64 | Train Loss: 0.0770763 Vali Loss: 0.2006610 Test Loss: 0.2754799
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 16 cost time: 0.9774816036224365
Epoch: 16, Steps: 64 | Train Loss: 0.0761826 Vali Loss: 0.1980950 Test Loss: 0.2763430
Validation loss decreased (0.200617 --> 0.198095).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 17 cost time: 0.9863989353179932
Epoch: 17, Steps: 64 | Train Loss: 0.0763896 Vali Loss: 0.2006684 Test Loss: 0.2751175
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 18 cost time: 0.9826626777648926
Epoch: 18, Steps: 64 | Train Loss: 0.0759469 Vali Loss: 0.1981395 Test Loss: 0.2734940
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 19 cost time: 0.9827353954315186
Epoch: 19, Steps: 64 | Train Loss: 0.0749641 Vali Loss: 0.1960367 Test Loss: 0.2726068
Validation loss decreased (0.198095 --> 0.196037).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 20 cost time: 0.9819977283477783
Epoch: 20, Steps: 64 | Train Loss: 0.0747867 Vali Loss: 0.1962310 Test Loss: 0.2737764
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 21 cost time: 0.983999490737915
Epoch: 21, Steps: 64 | Train Loss: 0.0740830 Vali Loss: 0.1959079 Test Loss: 0.2738231
Validation loss decreased (0.196037 --> 0.195908).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 22 cost time: 0.9862360954284668
Epoch: 22, Steps: 64 | Train Loss: 0.0737605 Vali Loss: 0.1947200 Test Loss: 0.2722703
Validation loss decreased (0.195908 --> 0.194720).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 23 cost time: 0.9846222400665283
Epoch: 23, Steps: 64 | Train Loss: 0.0739881 Vali Loss: 0.1942271 Test Loss: 0.2710437
Validation loss decreased (0.194720 --> 0.194227).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 24 cost time: 0.9783704280853271
Epoch: 24, Steps: 64 | Train Loss: 0.0734498 Vali Loss: 0.1926617 Test Loss: 0.2723988
Validation loss decreased (0.194227 --> 0.192662).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 25 cost time: 0.9793493747711182
Epoch: 25, Steps: 64 | Train Loss: 0.0736133 Vali Loss: 0.1910846 Test Loss: 0.2707846
Validation loss decreased (0.192662 --> 0.191085).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 26 cost time: 0.9783554077148438
Epoch: 26, Steps: 64 | Train Loss: 0.0733056 Vali Loss: 0.1923135 Test Loss: 0.2717046
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 27 cost time: 0.9823803901672363
Epoch: 27, Steps: 64 | Train Loss: 0.0729245 Vali Loss: 0.1913946 Test Loss: 0.2710246
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 28 cost time: 0.981823205947876
Epoch: 28, Steps: 64 | Train Loss: 0.0729488 Vali Loss: 0.1911295 Test Loss: 0.2718900
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 29 cost time: 0.9843876361846924
Epoch: 29, Steps: 64 | Train Loss: 0.0730501 Vali Loss: 0.1903526 Test Loss: 0.2698891
Validation loss decreased (0.191085 --> 0.190353).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 30 cost time: 0.997124195098877
Epoch: 30, Steps: 64 | Train Loss: 0.0727502 Vali Loss: 0.1923065 Test Loss: 0.2705875
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 31 cost time: 0.9797561168670654
Epoch: 31, Steps: 64 | Train Loss: 0.0724349 Vali Loss: 0.1906462 Test Loss: 0.2718956
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 32 cost time: 0.9810001850128174
Epoch: 32, Steps: 64 | Train Loss: 0.0724098 Vali Loss: 0.1887831 Test Loss: 0.2704601
Validation loss decreased (0.190353 --> 0.188783).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 33 cost time: 0.9906156063079834
Epoch: 33, Steps: 64 | Train Loss: 0.0723057 Vali Loss: 0.1904606 Test Loss: 0.2698577
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 34 cost time: 1.0630176067352295
Epoch: 34, Steps: 64 | Train Loss: 0.0723918 Vali Loss: 0.1901416 Test Loss: 0.2717921
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 35 cost time: 1.060615062713623
Epoch: 35, Steps: 64 | Train Loss: 0.0716669 Vali Loss: 0.1901817 Test Loss: 0.2713175
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 36 cost time: 1.0406172275543213
Epoch: 36, Steps: 64 | Train Loss: 0.0723818 Vali Loss: 0.1889388 Test Loss: 0.2705778
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 37 cost time: 0.9813852310180664
Epoch: 37, Steps: 64 | Train Loss: 0.0718514 Vali Loss: 0.1891813 Test Loss: 0.2707523
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 38 cost time: 0.9813401699066162
Epoch: 38, Steps: 64 | Train Loss: 0.0720706 Vali Loss: 0.1889668 Test Loss: 0.2706308
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 39 cost time: 0.9853806495666504
Epoch: 39, Steps: 64 | Train Loss: 0.0718302 Vali Loss: 0.1884546 Test Loss: 0.2712808
Validation loss decreased (0.188783 --> 0.188455).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 40 cost time: 1.059966802597046
Epoch: 40, Steps: 64 | Train Loss: 0.0720752 Vali Loss: 0.1870597 Test Loss: 0.2701510
Validation loss decreased (0.188455 --> 0.187060).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 41 cost time: 1.0618507862091064
Epoch: 41, Steps: 64 | Train Loss: 0.0718623 Vali Loss: 0.1890489 Test Loss: 0.2710145
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 42 cost time: 1.0603523254394531
Epoch: 42, Steps: 64 | Train Loss: 0.0718359 Vali Loss: 0.1906290 Test Loss: 0.2698128
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 43 cost time: 0.9753422737121582
Epoch: 43, Steps: 64 | Train Loss: 0.0718432 Vali Loss: 0.1897278 Test Loss: 0.2718523
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 44 cost time: 0.9763197898864746
Epoch: 44, Steps: 64 | Train Loss: 0.0712222 Vali Loss: 0.1899209 Test Loss: 0.2702755
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 45 cost time: 0.9863743782043457
Epoch: 45, Steps: 64 | Train Loss: 0.0719907 Vali Loss: 0.1873278 Test Loss: 0.2699336
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 46 cost time: 0.9764981269836426
Epoch: 46, Steps: 64 | Train Loss: 0.0714024 Vali Loss: 0.1885401 Test Loss: 0.2701706
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 47 cost time: 1.0621299743652344
Epoch: 47, Steps: 64 | Train Loss: 0.0715734 Vali Loss: 0.1862292 Test Loss: 0.2701369
Validation loss decreased (0.187060 --> 0.186229).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 48 cost time: 1.0613064765930176
Epoch: 48, Steps: 64 | Train Loss: 0.0714526 Vali Loss: 0.1870920 Test Loss: 0.2696067
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 49 cost time: 1.0242204666137695
Epoch: 49, Steps: 64 | Train Loss: 0.0718249 Vali Loss: 0.1881728 Test Loss: 0.2702831
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 50 cost time: 0.9814262390136719
Epoch: 50, Steps: 64 | Train Loss: 0.0715351 Vali Loss: 0.1859021 Test Loss: 0.2701057
Validation loss decreased (0.186229 --> 0.185902).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 51 cost time: 0.9776475429534912
Epoch: 51, Steps: 64 | Train Loss: 0.0721996 Vali Loss: 0.1862442 Test Loss: 0.2703200
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 52 cost time: 0.9906272888183594
Epoch: 52, Steps: 64 | Train Loss: 0.0718695 Vali Loss: 0.1883191 Test Loss: 0.2702502
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 53 cost time: 0.9833803176879883
Epoch: 53, Steps: 64 | Train Loss: 0.0713944 Vali Loss: 0.1865764 Test Loss: 0.2699831
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 54 cost time: 0.984391450881958
Epoch: 54, Steps: 64 | Train Loss: 0.0714111 Vali Loss: 0.1883328 Test Loss: 0.2699406
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 55 cost time: 0.9933657646179199
Epoch: 55, Steps: 64 | Train Loss: 0.0714793 Vali Loss: 0.1888853 Test Loss: 0.2707294
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 56 cost time: 0.9779551029205322
Epoch: 56, Steps: 64 | Train Loss: 0.0717927 Vali Loss: 0.1865183 Test Loss: 0.2697758
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 57 cost time: 0.9773674011230469
Epoch: 57, Steps: 64 | Train Loss: 0.0716214 Vali Loss: 0.1884765 Test Loss: 0.2699851
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 58 cost time: 0.9808261394500732
Epoch: 58, Steps: 64 | Train Loss: 0.0715968 Vali Loss: 0.1868992 Test Loss: 0.2693995
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 59 cost time: 0.9517669677734375
Epoch: 59, Steps: 64 | Train Loss: 0.0717192 Vali Loss: 0.1855666 Test Loss: 0.2705631
Validation loss decreased (0.185902 --> 0.185567).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 60 cost time: 0.9757297039031982
Epoch: 60, Steps: 64 | Train Loss: 0.0713868 Vali Loss: 0.1873244 Test Loss: 0.2692228
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2705630958080292, mae:0.33522942662239075, rse:0.2387300580739975
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.057550907135009766 GB
Epoch: 1 cost time: 2.218323230743408
Epoch: 1, Steps: 64 | Train Loss: 0.9540357 Vali Loss: 2.4518669 Test Loss: 4.3965774
Validation loss decreased (inf --> 2.451867).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 2 cost time: 0.8693435192108154
Epoch: 2, Steps: 64 | Train Loss: 0.4518717 Vali Loss: 0.3781043 Test Loss: 0.4482846
Validation loss decreased (2.451867 --> 0.378104).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 3 cost time: 0.8704204559326172
Epoch: 3, Steps: 64 | Train Loss: 0.1774999 Vali Loss: 0.2851411 Test Loss: 0.3174576
Validation loss decreased (0.378104 --> 0.285141).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 4 cost time: 0.8693833351135254
Epoch: 4, Steps: 64 | Train Loss: 0.1458304 Vali Loss: 0.2604183 Test Loss: 0.3076676
Validation loss decreased (0.285141 --> 0.260418).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 5 cost time: 0.8627965450286865
Epoch: 5, Steps: 64 | Train Loss: 0.1328484 Vali Loss: 0.2515842 Test Loss: 0.3034824
Validation loss decreased (0.260418 --> 0.251584).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 6 cost time: 0.8549997806549072
Epoch: 6, Steps: 64 | Train Loss: 0.1245108 Vali Loss: 0.2458556 Test Loss: 0.2945721
Validation loss decreased (0.251584 --> 0.245856).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 7 cost time: 0.8656220436096191
Epoch: 7, Steps: 64 | Train Loss: 0.1177299 Vali Loss: 0.2411010 Test Loss: 0.2916045
Validation loss decreased (0.245856 --> 0.241101).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 8 cost time: 0.8592448234558105
Epoch: 8, Steps: 64 | Train Loss: 0.1135360 Vali Loss: 0.2363032 Test Loss: 0.2916892
Validation loss decreased (0.241101 --> 0.236303).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 9 cost time: 0.8634133338928223
Epoch: 9, Steps: 64 | Train Loss: 0.1106078 Vali Loss: 0.2341477 Test Loss: 0.2909539
Validation loss decreased (0.236303 --> 0.234148).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 10 cost time: 0.8567543029785156
Epoch: 10, Steps: 64 | Train Loss: 0.1084601 Vali Loss: 0.2360088 Test Loss: 0.2904173
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 11 cost time: 0.8719995021820068
Epoch: 11, Steps: 64 | Train Loss: 0.1057528 Vali Loss: 0.2272439 Test Loss: 0.2890062
Validation loss decreased (0.234148 --> 0.227244).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 12 cost time: 0.8704640865325928
Epoch: 12, Steps: 64 | Train Loss: 0.1038047 Vali Loss: 0.2280018 Test Loss: 0.2906860
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 13 cost time: 0.8814117908477783
Epoch: 13, Steps: 64 | Train Loss: 0.1023427 Vali Loss: 0.2281475 Test Loss: 0.2898310
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 14 cost time: 0.8683435916900635
Epoch: 14, Steps: 64 | Train Loss: 0.1017065 Vali Loss: 0.2246097 Test Loss: 0.2880215
Validation loss decreased (0.227244 --> 0.224610).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 15 cost time: 0.8673727512359619
Epoch: 15, Steps: 64 | Train Loss: 0.1007065 Vali Loss: 0.2268577 Test Loss: 0.2876539
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 16 cost time: 0.8672797679901123
Epoch: 16, Steps: 64 | Train Loss: 0.0994998 Vali Loss: 0.2228123 Test Loss: 0.2868002
Validation loss decreased (0.224610 --> 0.222812).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 17 cost time: 0.8736228942871094
Epoch: 17, Steps: 64 | Train Loss: 0.0985521 Vali Loss: 0.2227684 Test Loss: 0.2867526
Validation loss decreased (0.222812 --> 0.222768).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 18 cost time: 0.866626501083374
Epoch: 18, Steps: 64 | Train Loss: 0.0980456 Vali Loss: 0.2212028 Test Loss: 0.2881902
Validation loss decreased (0.222768 --> 0.221203).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 19 cost time: 0.8640801906585693
Epoch: 19, Steps: 64 | Train Loss: 0.0977628 Vali Loss: 0.2227400 Test Loss: 0.2862315
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 20 cost time: 0.8733508586883545
Epoch: 20, Steps: 64 | Train Loss: 0.0968331 Vali Loss: 0.2195447 Test Loss: 0.2854487
Validation loss decreased (0.221203 --> 0.219545).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 21 cost time: 0.8789591789245605
Epoch: 21, Steps: 64 | Train Loss: 0.0967127 Vali Loss: 0.2214898 Test Loss: 0.2861571
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 22 cost time: 0.8760364055633545
Epoch: 22, Steps: 64 | Train Loss: 0.0960565 Vali Loss: 0.2159662 Test Loss: 0.2860820
Validation loss decreased (0.219545 --> 0.215966).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 23 cost time: 0.8846838474273682
Epoch: 23, Steps: 64 | Train Loss: 0.0956393 Vali Loss: 0.2182475 Test Loss: 0.2855926
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 24 cost time: 0.9199247360229492
Epoch: 24, Steps: 64 | Train Loss: 0.0945890 Vali Loss: 0.2182200 Test Loss: 0.2855865
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 25 cost time: 0.839169979095459
Epoch: 25, Steps: 64 | Train Loss: 0.0944460 Vali Loss: 0.2172531 Test Loss: 0.2859748
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 26 cost time: 0.8539764881134033
Epoch: 26, Steps: 64 | Train Loss: 0.0938554 Vali Loss: 0.2174620 Test Loss: 0.2845230
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 27 cost time: 0.9346208572387695
Epoch: 27, Steps: 64 | Train Loss: 0.0936003 Vali Loss: 0.2163831 Test Loss: 0.2844200
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 28 cost time: 0.840001106262207
Epoch: 28, Steps: 64 | Train Loss: 0.0933620 Vali Loss: 0.2146067 Test Loss: 0.2855546
Validation loss decreased (0.215966 --> 0.214607).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 29 cost time: 0.8409996032714844
Epoch: 29, Steps: 64 | Train Loss: 0.0930399 Vali Loss: 0.2168415 Test Loss: 0.2846965
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 30 cost time: 0.8296101093292236
Epoch: 30, Steps: 64 | Train Loss: 0.0933377 Vali Loss: 0.2147817 Test Loss: 0.2849139
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 31 cost time: 0.8415317535400391
Epoch: 31, Steps: 64 | Train Loss: 0.0935149 Vali Loss: 0.2158549 Test Loss: 0.2842015
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 32 cost time: 0.8984475135803223
Epoch: 32, Steps: 64 | Train Loss: 0.0928311 Vali Loss: 0.2152253 Test Loss: 0.2848590
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 33 cost time: 0.9284541606903076
Epoch: 33, Steps: 64 | Train Loss: 0.0924480 Vali Loss: 0.2154559 Test Loss: 0.2851755
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 34 cost time: 0.8866968154907227
Epoch: 34, Steps: 64 | Train Loss: 0.0919545 Vali Loss: 0.2123737 Test Loss: 0.2846761
Validation loss decreased (0.214607 --> 0.212374).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 35 cost time: 0.8922903537750244
Epoch: 35, Steps: 64 | Train Loss: 0.0923407 Vali Loss: 0.2136973 Test Loss: 0.2852531
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 36 cost time: 0.8775510787963867
Epoch: 36, Steps: 64 | Train Loss: 0.0917725 Vali Loss: 0.2125892 Test Loss: 0.2846636
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 37 cost time: 0.8824410438537598
Epoch: 37, Steps: 64 | Train Loss: 0.0922855 Vali Loss: 0.2124721 Test Loss: 0.2849516
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 38 cost time: 0.8940000534057617
Epoch: 38, Steps: 64 | Train Loss: 0.0912885 Vali Loss: 0.2152142 Test Loss: 0.2857659
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 39 cost time: 0.9075849056243896
Epoch: 39, Steps: 64 | Train Loss: 0.0913425 Vali Loss: 0.2160632 Test Loss: 0.2843911
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 40 cost time: 0.9040017127990723
Epoch: 40, Steps: 64 | Train Loss: 0.0919591 Vali Loss: 0.2142012 Test Loss: 0.2848284
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 41 cost time: 0.8826456069946289
Epoch: 41, Steps: 64 | Train Loss: 0.0915364 Vali Loss: 0.2147987 Test Loss: 0.2836581
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 42 cost time: 0.8955416679382324
Epoch: 42, Steps: 64 | Train Loss: 0.0920168 Vali Loss: 0.2154277 Test Loss: 0.2843594
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 43 cost time: 0.8913795948028564
Epoch: 43, Steps: 64 | Train Loss: 0.0916804 Vali Loss: 0.2111643 Test Loss: 0.2842051
Validation loss decreased (0.212374 --> 0.211164).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 44 cost time: 0.8976395130157471
Epoch: 44, Steps: 64 | Train Loss: 0.0913102 Vali Loss: 0.2132082 Test Loss: 0.2840638
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 45 cost time: 0.8921561241149902
Epoch: 45, Steps: 64 | Train Loss: 0.0908738 Vali Loss: 0.2154535 Test Loss: 0.2849422
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 46 cost time: 0.8569998741149902
Epoch: 46, Steps: 64 | Train Loss: 0.0916172 Vali Loss: 0.2142885 Test Loss: 0.2853611
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 47 cost time: 0.8695216178894043
Epoch: 47, Steps: 64 | Train Loss: 0.0915279 Vali Loss: 0.2130282 Test Loss: 0.2841887
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 48 cost time: 0.8542497158050537
Epoch: 48, Steps: 64 | Train Loss: 0.0911913 Vali Loss: 0.2129600 Test Loss: 0.2845888
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 49 cost time: 0.8739984035491943
Epoch: 49, Steps: 64 | Train Loss: 0.0913451 Vali Loss: 0.2133579 Test Loss: 0.2849832
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 50 cost time: 0.846315860748291
Epoch: 50, Steps: 64 | Train Loss: 0.0911954 Vali Loss: 0.2130587 Test Loss: 0.2856814
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 51 cost time: 0.8229999542236328
Epoch: 51, Steps: 64 | Train Loss: 0.0911641 Vali Loss: 0.2131804 Test Loss: 0.2837642
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 52 cost time: 0.8466155529022217
Epoch: 52, Steps: 64 | Train Loss: 0.0911199 Vali Loss: 0.2130534 Test Loss: 0.2845370
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 53 cost time: 0.8479371070861816
Epoch: 53, Steps: 64 | Train Loss: 0.0910491 Vali Loss: 0.2107578 Test Loss: 0.2845256
Validation loss decreased (0.211164 --> 0.210758).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 54 cost time: 0.975489616394043
Epoch: 54, Steps: 64 | Train Loss: 0.0910966 Vali Loss: 0.2136105 Test Loss: 0.2850628
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 55 cost time: 0.9690110683441162
Epoch: 55, Steps: 64 | Train Loss: 0.0906552 Vali Loss: 0.2111716 Test Loss: 0.2849908
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 56 cost time: 0.9066195487976074
Epoch: 56, Steps: 64 | Train Loss: 0.0910812 Vali Loss: 0.2138780 Test Loss: 0.2858917
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 57 cost time: 0.8773329257965088
Epoch: 57, Steps: 64 | Train Loss: 0.0912270 Vali Loss: 0.2124942 Test Loss: 0.2841713
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 58 cost time: 0.872999906539917
Epoch: 58, Steps: 64 | Train Loss: 0.0913934 Vali Loss: 0.2118321 Test Loss: 0.2840941
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 59 cost time: 0.8786275386810303
Epoch: 59, Steps: 64 | Train Loss: 0.0908738 Vali Loss: 0.2136298 Test Loss: 0.2839777
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 60 cost time: 0.8680002689361572
Epoch: 60, Steps: 64 | Train Loss: 0.0910137 Vali Loss: 0.2133497 Test Loss: 0.2847160
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2845255434513092, mae:0.34135371446609497, rse:0.24481241405010223
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.05898284912109375 GB
Epoch: 1 cost time: 2.3382866382598877
Epoch: 1, Steps: 64 | Train Loss: 1.0242553 Vali Loss: 2.9881909 Test Loss: 5.2370086
Validation loss decreased (inf --> 2.988191).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 2 cost time: 0.9371414184570312
Epoch: 2, Steps: 64 | Train Loss: 0.5307267 Vali Loss: 0.6946284 Test Loss: 0.8806846
Validation loss decreased (2.988191 --> 0.694628).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 3 cost time: 0.9486801624298096
Epoch: 3, Steps: 64 | Train Loss: 0.1706942 Vali Loss: 0.3385500 Test Loss: 0.3423101
Validation loss decreased (0.694628 --> 0.338550).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 4 cost time: 0.9770550727844238
Epoch: 4, Steps: 64 | Train Loss: 0.1151178 Vali Loss: 0.2531852 Test Loss: 0.2993130
Validation loss decreased (0.338550 --> 0.253185).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 5 cost time: 0.9310259819030762
Epoch: 5, Steps: 64 | Train Loss: 0.1047139 Vali Loss: 0.2453950 Test Loss: 0.2868084
Validation loss decreased (0.253185 --> 0.245395).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 6 cost time: 0.9659996032714844
Epoch: 6, Steps: 64 | Train Loss: 0.0994989 Vali Loss: 0.2353366 Test Loss: 0.2841440
Validation loss decreased (0.245395 --> 0.235337).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 7 cost time: 0.9722576141357422
Epoch: 7, Steps: 64 | Train Loss: 0.0965196 Vali Loss: 0.2312772 Test Loss: 0.2781858
Validation loss decreased (0.235337 --> 0.231277).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 8 cost time: 0.9820001125335693
Epoch: 8, Steps: 64 | Train Loss: 0.0938487 Vali Loss: 0.2254419 Test Loss: 0.2805862
Validation loss decreased (0.231277 --> 0.225442).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 9 cost time: 0.9670002460479736
Epoch: 9, Steps: 64 | Train Loss: 0.0919222 Vali Loss: 0.2207064 Test Loss: 0.2772386
Validation loss decreased (0.225442 --> 0.220706).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 10 cost time: 0.9766213893890381
Epoch: 10, Steps: 64 | Train Loss: 0.0898536 Vali Loss: 0.2156962 Test Loss: 0.2800106
Validation loss decreased (0.220706 --> 0.215696).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 11 cost time: 0.988412618637085
Epoch: 11, Steps: 64 | Train Loss: 0.0883085 Vali Loss: 0.2165190 Test Loss: 0.2732142
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 12 cost time: 0.9934766292572021
Epoch: 12, Steps: 64 | Train Loss: 0.0874576 Vali Loss: 0.2124068 Test Loss: 0.2755684
Validation loss decreased (0.215696 --> 0.212407).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 13 cost time: 0.9914112091064453
Epoch: 13, Steps: 64 | Train Loss: 0.0862294 Vali Loss: 0.2115280 Test Loss: 0.2750474
Validation loss decreased (0.212407 --> 0.211528).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 14 cost time: 0.9793777465820312
Epoch: 14, Steps: 64 | Train Loss: 0.0852490 Vali Loss: 0.2080678 Test Loss: 0.2737854
Validation loss decreased (0.211528 --> 0.208068).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 15 cost time: 0.9921846389770508
Epoch: 15, Steps: 64 | Train Loss: 0.0840219 Vali Loss: 0.2091810 Test Loss: 0.2729872
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 16 cost time: 0.9910001754760742
Epoch: 16, Steps: 64 | Train Loss: 0.0836098 Vali Loss: 0.2061731 Test Loss: 0.2726863
Validation loss decreased (0.208068 --> 0.206173).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 17 cost time: 0.9766473770141602
Epoch: 17, Steps: 64 | Train Loss: 0.0828890 Vali Loss: 0.2033205 Test Loss: 0.2725946
Validation loss decreased (0.206173 --> 0.203320).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 18 cost time: 0.9824366569519043
Epoch: 18, Steps: 64 | Train Loss: 0.0820013 Vali Loss: 0.2020757 Test Loss: 0.2718768
Validation loss decreased (0.203320 --> 0.202076).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 19 cost time: 0.9910006523132324
Epoch: 19, Steps: 64 | Train Loss: 0.0815460 Vali Loss: 0.2022426 Test Loss: 0.2725193
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 20 cost time: 0.9629461765289307
Epoch: 20, Steps: 64 | Train Loss: 0.0815188 Vali Loss: 0.1976150 Test Loss: 0.2721387
Validation loss decreased (0.202076 --> 0.197615).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 21 cost time: 0.9476251602172852
Epoch: 21, Steps: 64 | Train Loss: 0.0802564 Vali Loss: 0.2007750 Test Loss: 0.2713631
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 22 cost time: 0.9479997158050537
Epoch: 22, Steps: 64 | Train Loss: 0.0798892 Vali Loss: 0.1993833 Test Loss: 0.2715921
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 23 cost time: 0.9786243438720703
Epoch: 23, Steps: 64 | Train Loss: 0.0793810 Vali Loss: 0.1982421 Test Loss: 0.2707416
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 24 cost time: 0.9457662105560303
Epoch: 24, Steps: 64 | Train Loss: 0.0790282 Vali Loss: 0.1970832 Test Loss: 0.2716630
Validation loss decreased (0.197615 --> 0.197083).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 25 cost time: 0.9823837280273438
Epoch: 25, Steps: 64 | Train Loss: 0.0787969 Vali Loss: 0.1959275 Test Loss: 0.2704059
Validation loss decreased (0.197083 --> 0.195927).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 26 cost time: 0.9393191337585449
Epoch: 26, Steps: 64 | Train Loss: 0.0789086 Vali Loss: 0.1931961 Test Loss: 0.2693610
Validation loss decreased (0.195927 --> 0.193196).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 27 cost time: 0.9379189014434814
Epoch: 27, Steps: 64 | Train Loss: 0.0785572 Vali Loss: 0.1929249 Test Loss: 0.2704715
Validation loss decreased (0.193196 --> 0.192925).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 28 cost time: 0.9267306327819824
Epoch: 28, Steps: 64 | Train Loss: 0.0780871 Vali Loss: 0.1937840 Test Loss: 0.2693870
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 29 cost time: 0.9600002765655518
Epoch: 29, Steps: 64 | Train Loss: 0.0783516 Vali Loss: 0.1907275 Test Loss: 0.2695246
Validation loss decreased (0.192925 --> 0.190728).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 30 cost time: 0.9640214443206787
Epoch: 30, Steps: 64 | Train Loss: 0.0777254 Vali Loss: 0.1893101 Test Loss: 0.2691964
Validation loss decreased (0.190728 --> 0.189310).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 31 cost time: 0.9489998817443848
Epoch: 31, Steps: 64 | Train Loss: 0.0779012 Vali Loss: 0.1906058 Test Loss: 0.2697965
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 32 cost time: 0.9536435604095459
Epoch: 32, Steps: 64 | Train Loss: 0.0773290 Vali Loss: 0.1903275 Test Loss: 0.2695955
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 33 cost time: 0.9623768329620361
Epoch: 33, Steps: 64 | Train Loss: 0.0775487 Vali Loss: 0.1889853 Test Loss: 0.2692372
Validation loss decreased (0.189310 --> 0.188985).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 34 cost time: 0.9570004940032959
Epoch: 34, Steps: 64 | Train Loss: 0.0773851 Vali Loss: 0.1906264 Test Loss: 0.2690997
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 35 cost time: 0.9686031341552734
Epoch: 35, Steps: 64 | Train Loss: 0.0771320 Vali Loss: 0.1899888 Test Loss: 0.2690099
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 36 cost time: 0.9629237651824951
Epoch: 36, Steps: 64 | Train Loss: 0.0773161 Vali Loss: 0.1916702 Test Loss: 0.2689565
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 37 cost time: 0.9649999141693115
Epoch: 37, Steps: 64 | Train Loss: 0.0771502 Vali Loss: 0.1899097 Test Loss: 0.2690029
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 38 cost time: 0.9656069278717041
Epoch: 38, Steps: 64 | Train Loss: 0.0771151 Vali Loss: 0.1876670 Test Loss: 0.2691426
Validation loss decreased (0.188985 --> 0.187667).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 39 cost time: 0.9479997158050537
Epoch: 39, Steps: 64 | Train Loss: 0.0771485 Vali Loss: 0.1888622 Test Loss: 0.2684213
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 40 cost time: 0.9509997367858887
Epoch: 40, Steps: 64 | Train Loss: 0.0770698 Vali Loss: 0.1885461 Test Loss: 0.2685039
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 41 cost time: 0.9490010738372803
Epoch: 41, Steps: 64 | Train Loss: 0.0765968 Vali Loss: 0.1912043 Test Loss: 0.2687583
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 42 cost time: 0.9466123580932617
Epoch: 42, Steps: 64 | Train Loss: 0.0766484 Vali Loss: 0.1919213 Test Loss: 0.2698271
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 43 cost time: 0.9666125774383545
Epoch: 43, Steps: 64 | Train Loss: 0.0766345 Vali Loss: 0.1899758 Test Loss: 0.2691989
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 44 cost time: 0.9542908668518066
Epoch: 44, Steps: 64 | Train Loss: 0.0766954 Vali Loss: 0.1889063 Test Loss: 0.2688739
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 45 cost time: 0.964625358581543
Epoch: 45, Steps: 64 | Train Loss: 0.0767075 Vali Loss: 0.1891251 Test Loss: 0.2681914
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 46 cost time: 0.9676029682159424
Epoch: 46, Steps: 64 | Train Loss: 0.0764497 Vali Loss: 0.1883428 Test Loss: 0.2684079
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 47 cost time: 0.9454097747802734
Epoch: 47, Steps: 64 | Train Loss: 0.0767036 Vali Loss: 0.1875052 Test Loss: 0.2685936
Validation loss decreased (0.187667 --> 0.187505).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 48 cost time: 0.9496128559112549
Epoch: 48, Steps: 64 | Train Loss: 0.0761942 Vali Loss: 0.1894586 Test Loss: 0.2683423
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 49 cost time: 0.9496169090270996
Epoch: 49, Steps: 64 | Train Loss: 0.0767070 Vali Loss: 0.1866335 Test Loss: 0.2679684
Validation loss decreased (0.187505 --> 0.186634).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 50 cost time: 0.9670000076293945
Epoch: 50, Steps: 64 | Train Loss: 0.0764531 Vali Loss: 0.1889155 Test Loss: 0.2682534
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 51 cost time: 0.9526219367980957
Epoch: 51, Steps: 64 | Train Loss: 0.0767881 Vali Loss: 0.1878737 Test Loss: 0.2686749
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 52 cost time: 0.9674637317657471
Epoch: 52, Steps: 64 | Train Loss: 0.0768428 Vali Loss: 0.1864976 Test Loss: 0.2684285
Validation loss decreased (0.186634 --> 0.186498).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 53 cost time: 0.9730560779571533
Epoch: 53, Steps: 64 | Train Loss: 0.0767613 Vali Loss: 0.1904029 Test Loss: 0.2675471
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 54 cost time: 0.962395429611206
Epoch: 54, Steps: 64 | Train Loss: 0.0762329 Vali Loss: 0.1875082 Test Loss: 0.2681067
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 55 cost time: 0.9597682952880859
Epoch: 55, Steps: 64 | Train Loss: 0.0764454 Vali Loss: 0.1883130 Test Loss: 0.2680214
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 56 cost time: 0.9469995498657227
Epoch: 56, Steps: 64 | Train Loss: 0.0764346 Vali Loss: 0.1887331 Test Loss: 0.2685057
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 57 cost time: 0.963489294052124
Epoch: 57, Steps: 64 | Train Loss: 0.0761181 Vali Loss: 0.1890728 Test Loss: 0.2688836
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 58 cost time: 0.9496304988861084
Epoch: 58, Steps: 64 | Train Loss: 0.0763523 Vali Loss: 0.1912661 Test Loss: 0.2688224
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 59 cost time: 0.9503839015960693
Epoch: 59, Steps: 64 | Train Loss: 0.0766692 Vali Loss: 0.1859348 Test Loss: 0.2682008
Validation loss decreased (0.186498 --> 0.185935).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 60 cost time: 0.9533722400665283
Epoch: 60, Steps: 64 | Train Loss: 0.0764781 Vali Loss: 0.1868383 Test Loss: 0.2679019
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2682007849216461, mae:0.331939160823822, rse:0.23768559098243713
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.06010293960571289 GB
Epoch: 1 cost time: 2.317563772201538
Epoch: 1, Steps: 64 | Train Loss: 0.7992472 Vali Loss: 2.4422138 Test Loss: 4.3105011
Validation loss decreased (inf --> 2.442214).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 2 cost time: 0.9990127086639404
Epoch: 2, Steps: 64 | Train Loss: 0.4682216 Vali Loss: 0.5148307 Test Loss: 0.6726943
Validation loss decreased (2.442214 --> 0.514831).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 3 cost time: 1.007486343383789
Epoch: 3, Steps: 64 | Train Loss: 0.1289126 Vali Loss: 0.2467041 Test Loss: 0.2972537
Validation loss decreased (0.514831 --> 0.246704).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 4 cost time: 0.9583995342254639
Epoch: 4, Steps: 64 | Train Loss: 0.0996112 Vali Loss: 0.2452371 Test Loss: 0.2972380
Validation loss decreased (0.246704 --> 0.245237).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 5 cost time: 0.9712345600128174
Epoch: 5, Steps: 64 | Train Loss: 0.0932928 Vali Loss: 0.2292276 Test Loss: 0.2951555
Validation loss decreased (0.245237 --> 0.229228).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 6 cost time: 0.9913721084594727
Epoch: 6, Steps: 64 | Train Loss: 0.0897051 Vali Loss: 0.2267972 Test Loss: 0.2915115
Validation loss decreased (0.229228 --> 0.226797).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 7 cost time: 0.9829998016357422
Epoch: 7, Steps: 64 | Train Loss: 0.0864297 Vali Loss: 0.2246822 Test Loss: 0.2883085
Validation loss decreased (0.226797 --> 0.224682).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 8 cost time: 1.0026273727416992
Epoch: 8, Steps: 64 | Train Loss: 0.0848487 Vali Loss: 0.2172406 Test Loss: 0.2906199
Validation loss decreased (0.224682 --> 0.217241).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 9 cost time: 0.9731988906860352
Epoch: 9, Steps: 64 | Train Loss: 0.0824660 Vali Loss: 0.2108972 Test Loss: 0.2876165
Validation loss decreased (0.217241 --> 0.210897).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 10 cost time: 1.0034534931182861
Epoch: 10, Steps: 64 | Train Loss: 0.0816689 Vali Loss: 0.2097839 Test Loss: 0.2894599
Validation loss decreased (0.210897 --> 0.209784).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 11 cost time: 0.9943990707397461
Epoch: 11, Steps: 64 | Train Loss: 0.0800217 Vali Loss: 0.2076982 Test Loss: 0.2931710
Validation loss decreased (0.209784 --> 0.207698).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 12 cost time: 0.9904112815856934
Epoch: 12, Steps: 64 | Train Loss: 0.0789072 Vali Loss: 0.2031770 Test Loss: 0.2922308
Validation loss decreased (0.207698 --> 0.203177).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 13 cost time: 1.0025935173034668
Epoch: 13, Steps: 64 | Train Loss: 0.0779679 Vali Loss: 0.1984372 Test Loss: 0.2903587
Validation loss decreased (0.203177 --> 0.198437).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 14 cost time: 0.9801666736602783
Epoch: 14, Steps: 64 | Train Loss: 0.0774681 Vali Loss: 0.1972124 Test Loss: 0.2913634
Validation loss decreased (0.198437 --> 0.197212).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 15 cost time: 0.9793717861175537
Epoch: 15, Steps: 64 | Train Loss: 0.0764244 Vali Loss: 0.1932427 Test Loss: 0.2912623
Validation loss decreased (0.197212 --> 0.193243).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 16 cost time: 0.9903907775878906
Epoch: 16, Steps: 64 | Train Loss: 0.0756912 Vali Loss: 0.1927089 Test Loss: 0.2901891
Validation loss decreased (0.193243 --> 0.192709).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 17 cost time: 0.9804458618164062
Epoch: 17, Steps: 64 | Train Loss: 0.0751202 Vali Loss: 0.1898225 Test Loss: 0.2901457
Validation loss decreased (0.192709 --> 0.189823).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 18 cost time: 0.9964637756347656
Epoch: 18, Steps: 64 | Train Loss: 0.0750522 Vali Loss: 0.1885769 Test Loss: 0.2880949
Validation loss decreased (0.189823 --> 0.188577).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 19 cost time: 1.0096797943115234
Epoch: 19, Steps: 64 | Train Loss: 0.0747545 Vali Loss: 0.1903008 Test Loss: 0.2877637
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 20 cost time: 0.9813451766967773
Epoch: 20, Steps: 64 | Train Loss: 0.0742767 Vali Loss: 0.1857534 Test Loss: 0.2877113
Validation loss decreased (0.188577 --> 0.185753).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 21 cost time: 1.0155045986175537
Epoch: 21, Steps: 64 | Train Loss: 0.0741074 Vali Loss: 0.1870192 Test Loss: 0.2870148
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 22 cost time: 1.0131189823150635
Epoch: 22, Steps: 64 | Train Loss: 0.0734239 Vali Loss: 0.1862272 Test Loss: 0.2850076
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 23 cost time: 0.9800798892974854
Epoch: 23, Steps: 64 | Train Loss: 0.0732097 Vali Loss: 0.1844163 Test Loss: 0.2872856
Validation loss decreased (0.185753 --> 0.184416).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 24 cost time: 1.0063936710357666
Epoch: 24, Steps: 64 | Train Loss: 0.0734622 Vali Loss: 0.1871114 Test Loss: 0.2847804
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 25 cost time: 1.0073633193969727
Epoch: 25, Steps: 64 | Train Loss: 0.0728113 Vali Loss: 0.1869346 Test Loss: 0.2848062
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 26 cost time: 0.9972231388092041
Epoch: 26, Steps: 64 | Train Loss: 0.0725862 Vali Loss: 0.1841991 Test Loss: 0.2840344
Validation loss decreased (0.184416 --> 0.184199).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 27 cost time: 0.9983870983123779
Epoch: 27, Steps: 64 | Train Loss: 0.0723818 Vali Loss: 0.1832192 Test Loss: 0.2835376
Validation loss decreased (0.184199 --> 0.183219).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 28 cost time: 1.0074408054351807
Epoch: 28, Steps: 64 | Train Loss: 0.0717615 Vali Loss: 0.1846816 Test Loss: 0.2840181
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 29 cost time: 1.0163843631744385
Epoch: 29, Steps: 64 | Train Loss: 0.0720627 Vali Loss: 0.1821652 Test Loss: 0.2842456
Validation loss decreased (0.183219 --> 0.182165).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 30 cost time: 1.0042240619659424
Epoch: 30, Steps: 64 | Train Loss: 0.0717769 Vali Loss: 0.1828319 Test Loss: 0.2832181
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 31 cost time: 1.0023999214172363
Epoch: 31, Steps: 64 | Train Loss: 0.0723818 Vali Loss: 0.1811050 Test Loss: 0.2841341
Validation loss decreased (0.182165 --> 0.181105).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 32 cost time: 1.0073471069335938
Epoch: 32, Steps: 64 | Train Loss: 0.0720792 Vali Loss: 0.1826964 Test Loss: 0.2833788
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 33 cost time: 0.999274730682373
Epoch: 33, Steps: 64 | Train Loss: 0.0717950 Vali Loss: 0.1825082 Test Loss: 0.2826205
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 34 cost time: 1.007190465927124
Epoch: 34, Steps: 64 | Train Loss: 0.0716937 Vali Loss: 0.1811681 Test Loss: 0.2821592
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 35 cost time: 1.0069973468780518
Epoch: 35, Steps: 64 | Train Loss: 0.0717081 Vali Loss: 0.1808678 Test Loss: 0.2830414
Validation loss decreased (0.181105 --> 0.180868).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 36 cost time: 1.0099995136260986
Epoch: 36, Steps: 64 | Train Loss: 0.0716427 Vali Loss: 0.1805304 Test Loss: 0.2816532
Validation loss decreased (0.180868 --> 0.180530).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 37 cost time: 1.0046193599700928
Epoch: 37, Steps: 64 | Train Loss: 0.0715543 Vali Loss: 0.1807123 Test Loss: 0.2819779
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 38 cost time: 1.0002176761627197
Epoch: 38, Steps: 64 | Train Loss: 0.0711627 Vali Loss: 0.1811337 Test Loss: 0.2816042
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 39 cost time: 1.0013892650604248
Epoch: 39, Steps: 64 | Train Loss: 0.0712816 Vali Loss: 0.1792406 Test Loss: 0.2811754
Validation loss decreased (0.180530 --> 0.179241).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 40 cost time: 0.9983503818511963
Epoch: 40, Steps: 64 | Train Loss: 0.0719129 Vali Loss: 0.1792879 Test Loss: 0.2815119
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 41 cost time: 0.992485523223877
Epoch: 41, Steps: 64 | Train Loss: 0.0716891 Vali Loss: 0.1785918 Test Loss: 0.2811737
Validation loss decreased (0.179241 --> 0.178592).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 42 cost time: 0.9804413318634033
Epoch: 42, Steps: 64 | Train Loss: 0.0713549 Vali Loss: 0.1803131 Test Loss: 0.2815773
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 43 cost time: 0.9964168071746826
Epoch: 43, Steps: 64 | Train Loss: 0.0711790 Vali Loss: 0.1823579 Test Loss: 0.2817395
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 44 cost time: 0.9945342540740967
Epoch: 44, Steps: 64 | Train Loss: 0.0712630 Vali Loss: 0.1773382 Test Loss: 0.2810830
Validation loss decreased (0.178592 --> 0.177338).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 45 cost time: 0.9973599910736084
Epoch: 45, Steps: 64 | Train Loss: 0.0714185 Vali Loss: 0.1784817 Test Loss: 0.2814195
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 46 cost time: 0.9911401271820068
Epoch: 46, Steps: 64 | Train Loss: 0.0709375 Vali Loss: 0.1804020 Test Loss: 0.2810965
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 47 cost time: 0.9887914657592773
Epoch: 47, Steps: 64 | Train Loss: 0.0712655 Vali Loss: 0.1786174 Test Loss: 0.2808281
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 48 cost time: 0.9860565662384033
Epoch: 48, Steps: 64 | Train Loss: 0.0707312 Vali Loss: 0.1805832 Test Loss: 0.2819499
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 49 cost time: 0.9933688640594482
Epoch: 49, Steps: 64 | Train Loss: 0.0713780 Vali Loss: 0.1818915 Test Loss: 0.2819324
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 50 cost time: 0.9891533851623535
Epoch: 50, Steps: 64 | Train Loss: 0.0714978 Vali Loss: 0.1787642 Test Loss: 0.2807114
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 51 cost time: 0.9986157417297363
Epoch: 51, Steps: 64 | Train Loss: 0.0712836 Vali Loss: 0.1792123 Test Loss: 0.2810319
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 52 cost time: 1.0285794734954834
Epoch: 52, Steps: 64 | Train Loss: 0.0713582 Vali Loss: 0.1786233 Test Loss: 0.2816648
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 53 cost time: 0.9976422786712646
Epoch: 53, Steps: 64 | Train Loss: 0.0710007 Vali Loss: 0.1828866 Test Loss: 0.2811858
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 54 cost time: 0.9985504150390625
Epoch: 54, Steps: 64 | Train Loss: 0.0711549 Vali Loss: 0.1816560 Test Loss: 0.2813199
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 55 cost time: 0.9994428157806396
Epoch: 55, Steps: 64 | Train Loss: 0.0713675 Vali Loss: 0.1783861 Test Loss: 0.2801478
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 56 cost time: 0.9903960227966309
Epoch: 56, Steps: 64 | Train Loss: 0.0711727 Vali Loss: 0.1784445 Test Loss: 0.2814845
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 57 cost time: 0.9860072135925293
Epoch: 57, Steps: 64 | Train Loss: 0.0711184 Vali Loss: 0.1822603 Test Loss: 0.2810691
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 58 cost time: 0.9949009418487549
Epoch: 58, Steps: 64 | Train Loss: 0.0709225 Vali Loss: 0.1821610 Test Loss: 0.2817826
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 59 cost time: 0.9837980270385742
Epoch: 59, Steps: 64 | Train Loss: 0.0709877 Vali Loss: 0.1817153 Test Loss: 0.2815799
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 60 cost time: 0.993046760559082
Epoch: 60, Steps: 64 | Train Loss: 0.0708519 Vali Loss: 0.1806992 Test Loss: 0.2807548
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.28108298778533936, mae:0.3391770124435425, rse:0.24332687258720398
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05771303176879883 GB
Epoch: 1 cost time: 2.285719156265259
Epoch: 1, Steps: 64 | Train Loss: 1.1960168 Vali Loss: 3.1886284 Test Loss: 5.6023612
Validation loss decreased (inf --> 3.188628).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 2 cost time: 0.9213812351226807
Epoch: 2, Steps: 64 | Train Loss: 0.5610418 Vali Loss: 0.5070788 Test Loss: 0.6567111
Validation loss decreased (3.188628 --> 0.507079).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 3 cost time: 0.9406187534332275
Epoch: 3, Steps: 64 | Train Loss: 0.2039776 Vali Loss: 0.3532498 Test Loss: 0.3874573
Validation loss decreased (0.507079 --> 0.353250).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 4 cost time: 0.9443469047546387
Epoch: 4, Steps: 64 | Train Loss: 0.1535078 Vali Loss: 0.2957563 Test Loss: 0.3318183
Validation loss decreased (0.353250 --> 0.295756).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 5 cost time: 0.9253976345062256
Epoch: 5, Steps: 64 | Train Loss: 0.1351260 Vali Loss: 0.2669224 Test Loss: 0.3112440
Validation loss decreased (0.295756 --> 0.266922).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 6 cost time: 0.924419641494751
Epoch: 6, Steps: 64 | Train Loss: 0.1254201 Vali Loss: 0.2555969 Test Loss: 0.3006670
Validation loss decreased (0.266922 --> 0.255597).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 7 cost time: 0.9248936176300049
Epoch: 7, Steps: 64 | Train Loss: 0.1194610 Vali Loss: 0.2454462 Test Loss: 0.2938724
Validation loss decreased (0.255597 --> 0.245446).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 8 cost time: 0.9277806282043457
Epoch: 8, Steps: 64 | Train Loss: 0.1156071 Vali Loss: 0.2416146 Test Loss: 0.2936775
Validation loss decreased (0.245446 --> 0.241615).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 9 cost time: 0.9204232692718506
Epoch: 9, Steps: 64 | Train Loss: 0.1115673 Vali Loss: 0.2344026 Test Loss: 0.2891794
Validation loss decreased (0.241615 --> 0.234403).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 10 cost time: 0.939000129699707
Epoch: 10, Steps: 64 | Train Loss: 0.1090920 Vali Loss: 0.2344554 Test Loss: 0.2888944
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 11 cost time: 0.9390711784362793
Epoch: 11, Steps: 64 | Train Loss: 0.1072554 Vali Loss: 0.2317064 Test Loss: 0.2864220
Validation loss decreased (0.234403 --> 0.231706).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 12 cost time: 0.9496989250183105
Epoch: 12, Steps: 64 | Train Loss: 0.1053198 Vali Loss: 0.2285808 Test Loss: 0.2868184
Validation loss decreased (0.231706 --> 0.228581).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 13 cost time: 0.9393618106842041
Epoch: 13, Steps: 64 | Train Loss: 0.1038185 Vali Loss: 0.2258250 Test Loss: 0.2871147
Validation loss decreased (0.228581 --> 0.225825).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 14 cost time: 0.9283814430236816
Epoch: 14, Steps: 64 | Train Loss: 0.1026358 Vali Loss: 0.2274460 Test Loss: 0.2873066
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 15 cost time: 0.9375536441802979
Epoch: 15, Steps: 64 | Train Loss: 0.1010053 Vali Loss: 0.2232838 Test Loss: 0.2848808
Validation loss decreased (0.225825 --> 0.223284).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 16 cost time: 0.9433803558349609
Epoch: 16, Steps: 64 | Train Loss: 0.1002171 Vali Loss: 0.2230075 Test Loss: 0.2837873
Validation loss decreased (0.223284 --> 0.223008).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 17 cost time: 0.9384627342224121
Epoch: 17, Steps: 64 | Train Loss: 0.0989782 Vali Loss: 0.2202171 Test Loss: 0.2841100
Validation loss decreased (0.223008 --> 0.220217).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 18 cost time: 0.931281328201294
Epoch: 18, Steps: 64 | Train Loss: 0.0981630 Vali Loss: 0.2183356 Test Loss: 0.2827676
Validation loss decreased (0.220217 --> 0.218336).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 19 cost time: 0.9364502429962158
Epoch: 19, Steps: 64 | Train Loss: 0.0982864 Vali Loss: 0.2181284 Test Loss: 0.2820978
Validation loss decreased (0.218336 --> 0.218128).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 20 cost time: 0.9353017807006836
Epoch: 20, Steps: 64 | Train Loss: 0.0968247 Vali Loss: 0.2173071 Test Loss: 0.2818659
Validation loss decreased (0.218128 --> 0.217307).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 21 cost time: 0.9349961280822754
Epoch: 21, Steps: 64 | Train Loss: 0.0962873 Vali Loss: 0.2142984 Test Loss: 0.2815869
Validation loss decreased (0.217307 --> 0.214298).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 22 cost time: 0.9338345527648926
Epoch: 22, Steps: 64 | Train Loss: 0.0958340 Vali Loss: 0.2151939 Test Loss: 0.2804097
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 23 cost time: 0.9515383243560791
Epoch: 23, Steps: 64 | Train Loss: 0.0950692 Vali Loss: 0.2156278 Test Loss: 0.2809372
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 24 cost time: 0.9513285160064697
Epoch: 24, Steps: 64 | Train Loss: 0.0955040 Vali Loss: 0.2116951 Test Loss: 0.2813404
Validation loss decreased (0.214298 --> 0.211695).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 25 cost time: 0.9538681507110596
Epoch: 25, Steps: 64 | Train Loss: 0.0952284 Vali Loss: 0.2129520 Test Loss: 0.2792802
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 26 cost time: 0.9309999942779541
Epoch: 26, Steps: 64 | Train Loss: 0.0942688 Vali Loss: 0.2123830 Test Loss: 0.2789181
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 27 cost time: 0.9609999656677246
Epoch: 27, Steps: 64 | Train Loss: 0.0942820 Vali Loss: 0.2095850 Test Loss: 0.2797999
Validation loss decreased (0.211695 --> 0.209585).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 28 cost time: 0.9575979709625244
Epoch: 28, Steps: 64 | Train Loss: 0.0935696 Vali Loss: 0.2097784 Test Loss: 0.2795220
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 29 cost time: 0.9396023750305176
Epoch: 29, Steps: 64 | Train Loss: 0.0936216 Vali Loss: 0.2119844 Test Loss: 0.2796702
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 30 cost time: 0.9574799537658691
Epoch: 30, Steps: 64 | Train Loss: 0.0935275 Vali Loss: 0.2095253 Test Loss: 0.2777335
Validation loss decreased (0.209585 --> 0.209525).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 31 cost time: 0.9523332118988037
Epoch: 31, Steps: 64 | Train Loss: 0.0929829 Vali Loss: 0.2056513 Test Loss: 0.2780393
Validation loss decreased (0.209525 --> 0.205651).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 32 cost time: 0.9545044898986816
Epoch: 32, Steps: 64 | Train Loss: 0.0928910 Vali Loss: 0.2100968 Test Loss: 0.2788896
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 33 cost time: 0.9467222690582275
Epoch: 33, Steps: 64 | Train Loss: 0.0929201 Vali Loss: 0.2123050 Test Loss: 0.2802936
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 34 cost time: 0.9467301368713379
Epoch: 34, Steps: 64 | Train Loss: 0.0919731 Vali Loss: 0.2060282 Test Loss: 0.2778846
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 35 cost time: 0.9589998722076416
Epoch: 35, Steps: 64 | Train Loss: 0.0932073 Vali Loss: 0.2074874 Test Loss: 0.2789535
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 36 cost time: 0.9620003700256348
Epoch: 36, Steps: 64 | Train Loss: 0.0916969 Vali Loss: 0.2095570 Test Loss: 0.2796830
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 37 cost time: 0.9630460739135742
Epoch: 37, Steps: 64 | Train Loss: 0.0919196 Vali Loss: 0.2091045 Test Loss: 0.2781208
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 38 cost time: 0.9603464603424072
Epoch: 38, Steps: 64 | Train Loss: 0.0924955 Vali Loss: 0.2085979 Test Loss: 0.2784202
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 39 cost time: 0.9653260707855225
Epoch: 39, Steps: 64 | Train Loss: 0.0927299 Vali Loss: 0.2077775 Test Loss: 0.2769926
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 40 cost time: 0.9543502330780029
Epoch: 40, Steps: 64 | Train Loss: 0.0921587 Vali Loss: 0.2045110 Test Loss: 0.2782995
Validation loss decreased (0.205651 --> 0.204511).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 41 cost time: 0.9464206695556641
Epoch: 41, Steps: 64 | Train Loss: 0.0921391 Vali Loss: 0.2066163 Test Loss: 0.2790367
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 42 cost time: 0.9405624866485596
Epoch: 42, Steps: 64 | Train Loss: 0.0914430 Vali Loss: 0.2076243 Test Loss: 0.2780556
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 43 cost time: 0.9487178325653076
Epoch: 43, Steps: 64 | Train Loss: 0.0913727 Vali Loss: 0.2066393 Test Loss: 0.2796517
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 44 cost time: 0.9567983150482178
Epoch: 44, Steps: 64 | Train Loss: 0.0921022 Vali Loss: 0.2067151 Test Loss: 0.2766607
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 45 cost time: 0.9590003490447998
Epoch: 45, Steps: 64 | Train Loss: 0.0915798 Vali Loss: 0.2043159 Test Loss: 0.2788983
Validation loss decreased (0.204511 --> 0.204316).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 46 cost time: 0.9606032371520996
Epoch: 46, Steps: 64 | Train Loss: 0.0916407 Vali Loss: 0.2035160 Test Loss: 0.2795643
Validation loss decreased (0.204316 --> 0.203516).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 47 cost time: 0.9586226940155029
Epoch: 47, Steps: 64 | Train Loss: 0.0910721 Vali Loss: 0.2074040 Test Loss: 0.2767466
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 48 cost time: 0.9563643932342529
Epoch: 48, Steps: 64 | Train Loss: 0.0916697 Vali Loss: 0.2069588 Test Loss: 0.2785619
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 49 cost time: 0.9493696689605713
Epoch: 49, Steps: 64 | Train Loss: 0.0909895 Vali Loss: 0.2047697 Test Loss: 0.2785939
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 50 cost time: 0.9519600868225098
Epoch: 50, Steps: 64 | Train Loss: 0.0918874 Vali Loss: 0.2076581 Test Loss: 0.2779101
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 51 cost time: 0.9513404369354248
Epoch: 51, Steps: 64 | Train Loss: 0.0918100 Vali Loss: 0.2054582 Test Loss: 0.2772854
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 52 cost time: 0.9679462909698486
Epoch: 52, Steps: 64 | Train Loss: 0.0914516 Vali Loss: 0.2056343 Test Loss: 0.2787168
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 53 cost time: 0.9367320537567139
Epoch: 53, Steps: 64 | Train Loss: 0.0916435 Vali Loss: 0.2072319 Test Loss: 0.2785207
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 54 cost time: 0.9335076808929443
Epoch: 54, Steps: 64 | Train Loss: 0.0920403 Vali Loss: 0.2052149 Test Loss: 0.2794250
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 55 cost time: 0.9426217079162598
Epoch: 55, Steps: 64 | Train Loss: 0.0909632 Vali Loss: 0.2049982 Test Loss: 0.2781003
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 56 cost time: 0.9396073818206787
Epoch: 56, Steps: 64 | Train Loss: 0.0910925 Vali Loss: 0.2049933 Test Loss: 0.2778203
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 57 cost time: 0.9283835887908936
Epoch: 57, Steps: 64 | Train Loss: 0.0914805 Vali Loss: 0.2051156 Test Loss: 0.2778357
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 58 cost time: 0.9253900051116943
Epoch: 58, Steps: 64 | Train Loss: 0.0908940 Vali Loss: 0.2042379 Test Loss: 0.2802511
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 59 cost time: 0.9373738765716553
Epoch: 59, Steps: 64 | Train Loss: 0.0916460 Vali Loss: 0.2060169 Test Loss: 0.2789415
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 60 cost time: 0.9266386032104492
Epoch: 60, Steps: 64 | Train Loss: 0.0913159 Vali Loss: 0.2019718 Test Loss: 0.2782982
Validation loss decreased (0.203516 --> 0.201972).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.27829816937446594, mae:0.33383244276046753, rse:0.2421184927225113
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.05914497375488281 GB
Epoch: 1 cost time: 2.4000306129455566
Epoch: 1, Steps: 64 | Train Loss: 0.7567188 Vali Loss: 2.1299031 Test Loss: 3.7277491
Validation loss decreased (inf --> 2.129903).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 2 cost time: 0.9727475643157959
Epoch: 2, Steps: 64 | Train Loss: 0.3338365 Vali Loss: 0.3341887 Test Loss: 0.3400591
Validation loss decreased (2.129903 --> 0.334189).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 3 cost time: 1.0622050762176514
Epoch: 3, Steps: 64 | Train Loss: 0.1217749 Vali Loss: 0.2527096 Test Loss: 0.2937367
Validation loss decreased (0.334189 --> 0.252710).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 4 cost time: 1.0588433742523193
Epoch: 4, Steps: 64 | Train Loss: 0.1071581 Vali Loss: 0.2467853 Test Loss: 0.2846951
Validation loss decreased (0.252710 --> 0.246785).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 5 cost time: 1.0200002193450928
Epoch: 5, Steps: 64 | Train Loss: 0.1002370 Vali Loss: 0.2419473 Test Loss: 0.2862508
Validation loss decreased (0.246785 --> 0.241947).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 6 cost time: 0.9680027961730957
Epoch: 6, Steps: 64 | Train Loss: 0.0961701 Vali Loss: 0.2341997 Test Loss: 0.2840323
Validation loss decreased (0.241947 --> 0.234200).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 7 cost time: 0.9722249507904053
Epoch: 7, Steps: 64 | Train Loss: 0.0926250 Vali Loss: 0.2286148 Test Loss: 0.2848975
Validation loss decreased (0.234200 --> 0.228615).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 8 cost time: 0.9716174602508545
Epoch: 8, Steps: 64 | Train Loss: 0.0907063 Vali Loss: 0.2249433 Test Loss: 0.2816810
Validation loss decreased (0.228615 --> 0.224943).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 9 cost time: 0.9684722423553467
Epoch: 9, Steps: 64 | Train Loss: 0.0887148 Vali Loss: 0.2236364 Test Loss: 0.2830238
Validation loss decreased (0.224943 --> 0.223636).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 10 cost time: 0.982396125793457
Epoch: 10, Steps: 64 | Train Loss: 0.0868913 Vali Loss: 0.2212810 Test Loss: 0.2816676
Validation loss decreased (0.223636 --> 0.221281).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 11 cost time: 0.9770700931549072
Epoch: 11, Steps: 64 | Train Loss: 0.0859916 Vali Loss: 0.2183315 Test Loss: 0.2826096
Validation loss decreased (0.221281 --> 0.218331).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 12 cost time: 0.9893443584442139
Epoch: 12, Steps: 64 | Train Loss: 0.0849787 Vali Loss: 0.2115343 Test Loss: 0.2802862
Validation loss decreased (0.218331 --> 0.211534).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 13 cost time: 0.9874205589294434
Epoch: 13, Steps: 64 | Train Loss: 0.0843143 Vali Loss: 0.2137616 Test Loss: 0.2810512
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 14 cost time: 0.9723973274230957
Epoch: 14, Steps: 64 | Train Loss: 0.0832160 Vali Loss: 0.2092831 Test Loss: 0.2808925
Validation loss decreased (0.211534 --> 0.209283).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 15 cost time: 0.9807705879211426
Epoch: 15, Steps: 64 | Train Loss: 0.0824474 Vali Loss: 0.2065192 Test Loss: 0.2810489
Validation loss decreased (0.209283 --> 0.206519).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 16 cost time: 0.9757258892059326
Epoch: 16, Steps: 64 | Train Loss: 0.0815897 Vali Loss: 0.2068915 Test Loss: 0.2795941
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 17 cost time: 0.9750022888183594
Epoch: 17, Steps: 64 | Train Loss: 0.0813019 Vali Loss: 0.2064335 Test Loss: 0.2780215
Validation loss decreased (0.206519 --> 0.206433).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 18 cost time: 0.9890012741088867
Epoch: 18, Steps: 64 | Train Loss: 0.0810254 Vali Loss: 0.2061692 Test Loss: 0.2785501
Validation loss decreased (0.206433 --> 0.206169).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 19 cost time: 0.985245943069458
Epoch: 19, Steps: 64 | Train Loss: 0.0805693 Vali Loss: 0.2009176 Test Loss: 0.2781464
Validation loss decreased (0.206169 --> 0.200918).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 20 cost time: 0.9766194820404053
Epoch: 20, Steps: 64 | Train Loss: 0.0795995 Vali Loss: 0.2035144 Test Loss: 0.2776058
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 21 cost time: 0.9803943634033203
Epoch: 21, Steps: 64 | Train Loss: 0.0794608 Vali Loss: 0.2006311 Test Loss: 0.2778311
Validation loss decreased (0.200918 --> 0.200631).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 22 cost time: 0.9745049476623535
Epoch: 22, Steps: 64 | Train Loss: 0.0794584 Vali Loss: 0.2015413 Test Loss: 0.2769013
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 23 cost time: 0.9704349040985107
Epoch: 23, Steps: 64 | Train Loss: 0.0787798 Vali Loss: 0.2015708 Test Loss: 0.2770987
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 24 cost time: 0.9683611392974854
Epoch: 24, Steps: 64 | Train Loss: 0.0785246 Vali Loss: 0.1976590 Test Loss: 0.2766229
Validation loss decreased (0.200631 --> 0.197659).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 25 cost time: 0.961498498916626
Epoch: 25, Steps: 64 | Train Loss: 0.0783531 Vali Loss: 0.2003247 Test Loss: 0.2759922
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 26 cost time: 0.9684016704559326
Epoch: 26, Steps: 64 | Train Loss: 0.0777563 Vali Loss: 0.1983047 Test Loss: 0.2765043
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 27 cost time: 0.9742107391357422
Epoch: 27, Steps: 64 | Train Loss: 0.0783124 Vali Loss: 0.2017808 Test Loss: 0.2759953
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 28 cost time: 0.969712495803833
Epoch: 28, Steps: 64 | Train Loss: 0.0777947 Vali Loss: 0.1971708 Test Loss: 0.2760278
Validation loss decreased (0.197659 --> 0.197171).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 29 cost time: 0.969001054763794
Epoch: 29, Steps: 64 | Train Loss: 0.0777976 Vali Loss: 0.2015565 Test Loss: 0.2762876
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 30 cost time: 0.9696071147918701
Epoch: 30, Steps: 64 | Train Loss: 0.0773918 Vali Loss: 0.1969238 Test Loss: 0.2754124
Validation loss decreased (0.197171 --> 0.196924).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 31 cost time: 0.9672925472259521
Epoch: 31, Steps: 64 | Train Loss: 0.0775690 Vali Loss: 0.1982190 Test Loss: 0.2760398
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 32 cost time: 0.9703164100646973
Epoch: 32, Steps: 64 | Train Loss: 0.0773013 Vali Loss: 0.1976967 Test Loss: 0.2750420
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 33 cost time: 0.9763414859771729
Epoch: 33, Steps: 64 | Train Loss: 0.0767338 Vali Loss: 0.1989518 Test Loss: 0.2755233
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 34 cost time: 0.9703960418701172
Epoch: 34, Steps: 64 | Train Loss: 0.0771269 Vali Loss: 0.1977292 Test Loss: 0.2758202
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 35 cost time: 0.9914228916168213
Epoch: 35, Steps: 64 | Train Loss: 0.0767568 Vali Loss: 0.1979651 Test Loss: 0.2750699
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 36 cost time: 0.9733822345733643
Epoch: 36, Steps: 64 | Train Loss: 0.0770667 Vali Loss: 0.1973193 Test Loss: 0.2756593
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 37 cost time: 0.987403392791748
Epoch: 37, Steps: 64 | Train Loss: 0.0768423 Vali Loss: 0.1960142 Test Loss: 0.2743014
Validation loss decreased (0.196924 --> 0.196014).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 38 cost time: 0.9857370853424072
Epoch: 38, Steps: 64 | Train Loss: 0.0775164 Vali Loss: 0.1968218 Test Loss: 0.2746338
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 39 cost time: 0.9702005386352539
Epoch: 39, Steps: 64 | Train Loss: 0.0769417 Vali Loss: 0.1963998 Test Loss: 0.2744989
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 40 cost time: 0.9670000076293945
Epoch: 40, Steps: 64 | Train Loss: 0.0764046 Vali Loss: 0.1961739 Test Loss: 0.2751637
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 41 cost time: 0.9826240539550781
Epoch: 41, Steps: 64 | Train Loss: 0.0769293 Vali Loss: 0.1989886 Test Loss: 0.2743333
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 42 cost time: 0.9706320762634277
Epoch: 42, Steps: 64 | Train Loss: 0.0766609 Vali Loss: 0.1965933 Test Loss: 0.2745613
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 43 cost time: 0.9670364856719971
Epoch: 43, Steps: 64 | Train Loss: 0.0762638 Vali Loss: 0.1943237 Test Loss: 0.2748003
Validation loss decreased (0.196014 --> 0.194324).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 44 cost time: 0.9413721561431885
Epoch: 44, Steps: 64 | Train Loss: 0.0765218 Vali Loss: 0.1969489 Test Loss: 0.2746562
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 45 cost time: 0.9475357532501221
Epoch: 45, Steps: 64 | Train Loss: 0.0765258 Vali Loss: 0.1948452 Test Loss: 0.2745558
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 46 cost time: 1.0714492797851562
Epoch: 46, Steps: 64 | Train Loss: 0.0766293 Vali Loss: 0.1941994 Test Loss: 0.2753350
Validation loss decreased (0.194324 --> 0.194199).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 47 cost time: 0.9739439487457275
Epoch: 47, Steps: 64 | Train Loss: 0.0762994 Vali Loss: 0.1944507 Test Loss: 0.2735803
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 48 cost time: 0.9573824405670166
Epoch: 48, Steps: 64 | Train Loss: 0.0763311 Vali Loss: 0.1978182 Test Loss: 0.2740452
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 49 cost time: 0.9758219718933105
Epoch: 49, Steps: 64 | Train Loss: 0.0765753 Vali Loss: 0.1936889 Test Loss: 0.2741811
Validation loss decreased (0.194199 --> 0.193689).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 50 cost time: 0.9728958606719971
Epoch: 50, Steps: 64 | Train Loss: 0.0761990 Vali Loss: 0.1949207 Test Loss: 0.2739659
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 51 cost time: 0.9854910373687744
Epoch: 51, Steps: 64 | Train Loss: 0.0763285 Vali Loss: 0.1942609 Test Loss: 0.2753869
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 52 cost time: 0.9750001430511475
Epoch: 52, Steps: 64 | Train Loss: 0.0761644 Vali Loss: 0.1956088 Test Loss: 0.2739730
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 53 cost time: 0.9766285419464111
Epoch: 53, Steps: 64 | Train Loss: 0.0758708 Vali Loss: 0.1968350 Test Loss: 0.2744091
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 54 cost time: 0.9784743785858154
Epoch: 54, Steps: 64 | Train Loss: 0.0765344 Vali Loss: 0.1933712 Test Loss: 0.2737417
Validation loss decreased (0.193689 --> 0.193371).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 55 cost time: 0.9810636043548584
Epoch: 55, Steps: 64 | Train Loss: 0.0762443 Vali Loss: 0.1956699 Test Loss: 0.2747603
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 56 cost time: 0.9745252132415771
Epoch: 56, Steps: 64 | Train Loss: 0.0765708 Vali Loss: 0.1974081 Test Loss: 0.2739684
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 57 cost time: 0.9713780879974365
Epoch: 57, Steps: 64 | Train Loss: 0.0758980 Vali Loss: 0.1962203 Test Loss: 0.2741900
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 58 cost time: 0.9843883514404297
Epoch: 58, Steps: 64 | Train Loss: 0.0764078 Vali Loss: 0.1954671 Test Loss: 0.2744958
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 59 cost time: 1.027843713760376
Epoch: 59, Steps: 64 | Train Loss: 0.0765090 Vali Loss: 0.1932269 Test Loss: 0.2739410
Validation loss decreased (0.193371 --> 0.193227).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 60 cost time: 1.0193486213684082
Epoch: 60, Steps: 64 | Train Loss: 0.0760529 Vali Loss: 0.1955233 Test Loss: 0.2741448
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.27394092082977295, mae:0.3340609669685364, rse:0.24021561443805695
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06026506423950195 GB
Epoch: 1 cost time: 2.417189836502075
Epoch: 1, Steps: 64 | Train Loss: 0.8836254 Vali Loss: 2.6662643 Test Loss: 4.7310119
Validation loss decreased (inf --> 2.666264).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 2 cost time: 1.0066335201263428
Epoch: 2, Steps: 64 | Train Loss: 0.4892506 Vali Loss: 0.5588271 Test Loss: 0.7530960
Validation loss decreased (2.666264 --> 0.558827).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 3 cost time: 1.0076098442077637
Epoch: 3, Steps: 64 | Train Loss: 0.1366742 Vali Loss: 0.2829118 Test Loss: 0.3246044
Validation loss decreased (0.558827 --> 0.282912).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 4 cost time: 1.0012662410736084
Epoch: 4, Steps: 64 | Train Loss: 0.1017718 Vali Loss: 0.2497117 Test Loss: 0.3144026
Validation loss decreased (0.282912 --> 0.249712).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 5 cost time: 0.9955101013183594
Epoch: 5, Steps: 64 | Train Loss: 0.0945218 Vali Loss: 0.2373168 Test Loss: 0.2952518
Validation loss decreased (0.249712 --> 0.237317).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 6 cost time: 0.9911472797393799
Epoch: 6, Steps: 64 | Train Loss: 0.0905668 Vali Loss: 0.2292089 Test Loss: 0.2912976
Validation loss decreased (0.237317 --> 0.229209).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 7 cost time: 0.9911525249481201
Epoch: 7, Steps: 64 | Train Loss: 0.0873383 Vali Loss: 0.2213104 Test Loss: 0.2856982
Validation loss decreased (0.229209 --> 0.221310).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 8 cost time: 0.9884428977966309
Epoch: 8, Steps: 64 | Train Loss: 0.0859108 Vali Loss: 0.2169593 Test Loss: 0.2867713
Validation loss decreased (0.221310 --> 0.216959).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 9 cost time: 0.9889998435974121
Epoch: 9, Steps: 64 | Train Loss: 0.0839103 Vali Loss: 0.2172065 Test Loss: 0.2807965
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 10 cost time: 1.0014193058013916
Epoch: 10, Steps: 64 | Train Loss: 0.0826631 Vali Loss: 0.2097553 Test Loss: 0.2814209
Validation loss decreased (0.216959 --> 0.209755).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 11 cost time: 0.9984333515167236
Epoch: 11, Steps: 64 | Train Loss: 0.0807641 Vali Loss: 0.2076043 Test Loss: 0.2779874
Validation loss decreased (0.209755 --> 0.207604).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 12 cost time: 0.9960365295410156
Epoch: 12, Steps: 64 | Train Loss: 0.0800247 Vali Loss: 0.2055716 Test Loss: 0.2791609
Validation loss decreased (0.207604 --> 0.205572).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 13 cost time: 0.9926345348358154
Epoch: 13, Steps: 64 | Train Loss: 0.0789237 Vali Loss: 0.2026328 Test Loss: 0.2787105
Validation loss decreased (0.205572 --> 0.202633).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 14 cost time: 0.982921838760376
Epoch: 14, Steps: 64 | Train Loss: 0.0784267 Vali Loss: 0.1989295 Test Loss: 0.2787663
Validation loss decreased (0.202633 --> 0.198929).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 15 cost time: 0.9793851375579834
Epoch: 15, Steps: 64 | Train Loss: 0.0780443 Vali Loss: 0.1938542 Test Loss: 0.2753750
Validation loss decreased (0.198929 --> 0.193854).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 16 cost time: 0.9810256958007812
Epoch: 16, Steps: 64 | Train Loss: 0.0765128 Vali Loss: 0.1912673 Test Loss: 0.2745240
Validation loss decreased (0.193854 --> 0.191267).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 17 cost time: 0.9934048652648926
Epoch: 17, Steps: 64 | Train Loss: 0.0763164 Vali Loss: 0.1918737 Test Loss: 0.2740880
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 18 cost time: 0.9953551292419434
Epoch: 18, Steps: 64 | Train Loss: 0.0752259 Vali Loss: 0.1918987 Test Loss: 0.2727605
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 19 cost time: 0.9928150177001953
Epoch: 19, Steps: 64 | Train Loss: 0.0750317 Vali Loss: 0.1927243 Test Loss: 0.2738881
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 20 cost time: 0.9885063171386719
Epoch: 20, Steps: 64 | Train Loss: 0.0745168 Vali Loss: 0.1930396 Test Loss: 0.2734324
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 21 cost time: 0.9583265781402588
Epoch: 21, Steps: 64 | Train Loss: 0.0746172 Vali Loss: 0.1856599 Test Loss: 0.2722541
Validation loss decreased (0.191267 --> 0.185660).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 22 cost time: 0.9656496047973633
Epoch: 22, Steps: 64 | Train Loss: 0.0743053 Vali Loss: 0.1899457 Test Loss: 0.2714596
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 23 cost time: 0.9886343479156494
Epoch: 23, Steps: 64 | Train Loss: 0.0735428 Vali Loss: 0.1897287 Test Loss: 0.2709702
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 24 cost time: 0.9889950752258301
Epoch: 24, Steps: 64 | Train Loss: 0.0729772 Vali Loss: 0.1863399 Test Loss: 0.2706105
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 25 cost time: 0.9823434352874756
Epoch: 25, Steps: 64 | Train Loss: 0.0734428 Vali Loss: 0.1874985 Test Loss: 0.2703480
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 26 cost time: 0.9893820285797119
Epoch: 26, Steps: 64 | Train Loss: 0.0732714 Vali Loss: 0.1864301 Test Loss: 0.2699505
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 27 cost time: 0.967216968536377
Epoch: 27, Steps: 64 | Train Loss: 0.0735440 Vali Loss: 0.1879593 Test Loss: 0.2697693
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 28 cost time: 0.955418586730957
Epoch: 28, Steps: 64 | Train Loss: 0.0730234 Vali Loss: 0.1846109 Test Loss: 0.2689745
Validation loss decreased (0.185660 --> 0.184611).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 29 cost time: 1.1044387817382812
Epoch: 29, Steps: 64 | Train Loss: 0.0730597 Vali Loss: 0.1867040 Test Loss: 0.2687728
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 30 cost time: 1.0144155025482178
Epoch: 30, Steps: 64 | Train Loss: 0.0725996 Vali Loss: 0.1871252 Test Loss: 0.2697771
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 31 cost time: 0.9924685955047607
Epoch: 31, Steps: 64 | Train Loss: 0.0725043 Vali Loss: 0.1859748 Test Loss: 0.2679727
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 32 cost time: 0.9901611804962158
Epoch: 32, Steps: 64 | Train Loss: 0.0722947 Vali Loss: 0.1847866 Test Loss: 0.2687826
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 33 cost time: 1.000762939453125
Epoch: 33, Steps: 64 | Train Loss: 0.0718605 Vali Loss: 0.1838421 Test Loss: 0.2687638
Validation loss decreased (0.184611 --> 0.183842).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 34 cost time: 0.9990003108978271
Epoch: 34, Steps: 64 | Train Loss: 0.0722471 Vali Loss: 0.1853721 Test Loss: 0.2674299
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 35 cost time: 0.9960000514984131
Epoch: 35, Steps: 64 | Train Loss: 0.0718095 Vali Loss: 0.1847968 Test Loss: 0.2678422
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 36 cost time: 1.007239580154419
Epoch: 36, Steps: 64 | Train Loss: 0.0720223 Vali Loss: 0.1845474 Test Loss: 0.2686275
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 37 cost time: 0.9966156482696533
Epoch: 37, Steps: 64 | Train Loss: 0.0720377 Vali Loss: 0.1854246 Test Loss: 0.2680236
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 38 cost time: 0.9864494800567627
Epoch: 38, Steps: 64 | Train Loss: 0.0720518 Vali Loss: 0.1852047 Test Loss: 0.2687845
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 39 cost time: 0.9893443584442139
Epoch: 39, Steps: 64 | Train Loss: 0.0720097 Vali Loss: 0.1837060 Test Loss: 0.2679427
Validation loss decreased (0.183842 --> 0.183706).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 40 cost time: 0.983386754989624
Epoch: 40, Steps: 64 | Train Loss: 0.0718373 Vali Loss: 0.1860409 Test Loss: 0.2684882
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 41 cost time: 0.9833388328552246
Epoch: 41, Steps: 64 | Train Loss: 0.0721763 Vali Loss: 0.1875199 Test Loss: 0.2691327
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 42 cost time: 0.9854075908660889
Epoch: 42, Steps: 64 | Train Loss: 0.0713000 Vali Loss: 0.1823882 Test Loss: 0.2673900
Validation loss decreased (0.183706 --> 0.182388).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 43 cost time: 0.9619128704071045
Epoch: 43, Steps: 64 | Train Loss: 0.0715588 Vali Loss: 0.1834138 Test Loss: 0.2682800
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 44 cost time: 0.993732213973999
Epoch: 44, Steps: 64 | Train Loss: 0.0715502 Vali Loss: 0.1871666 Test Loss: 0.2694649
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 45 cost time: 0.9866478443145752
Epoch: 45, Steps: 64 | Train Loss: 0.0717587 Vali Loss: 0.1835945 Test Loss: 0.2682299
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 46 cost time: 1.0005955696105957
Epoch: 46, Steps: 64 | Train Loss: 0.0716186 Vali Loss: 0.1844615 Test Loss: 0.2667980
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 47 cost time: 1.0041701793670654
Epoch: 47, Steps: 64 | Train Loss: 0.0714694 Vali Loss: 0.1834344 Test Loss: 0.2667857
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 48 cost time: 1.014357089996338
Epoch: 48, Steps: 64 | Train Loss: 0.0714368 Vali Loss: 0.1849321 Test Loss: 0.2668934
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 49 cost time: 1.0216150283813477
Epoch: 49, Steps: 64 | Train Loss: 0.0715684 Vali Loss: 0.1834978 Test Loss: 0.2681975
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 50 cost time: 1.0096347332000732
Epoch: 50, Steps: 64 | Train Loss: 0.0713515 Vali Loss: 0.1839786 Test Loss: 0.2672472
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 51 cost time: 1.0206108093261719
Epoch: 51, Steps: 64 | Train Loss: 0.0714764 Vali Loss: 0.1830741 Test Loss: 0.2676090
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 52 cost time: 1.0266005992889404
Epoch: 52, Steps: 64 | Train Loss: 0.0711320 Vali Loss: 0.1839621 Test Loss: 0.2676594
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 53 cost time: 1.0126018524169922
Epoch: 53, Steps: 64 | Train Loss: 0.0714383 Vali Loss: 0.1849147 Test Loss: 0.2667816
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 54 cost time: 1.0173637866973877
Epoch: 54, Steps: 64 | Train Loss: 0.0714128 Vali Loss: 0.1828441 Test Loss: 0.2673563
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 55 cost time: 1.0062611103057861
Epoch: 55, Steps: 64 | Train Loss: 0.0717156 Vali Loss: 0.1829040 Test Loss: 0.2679186
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 56 cost time: 1.0086374282836914
Epoch: 56, Steps: 64 | Train Loss: 0.0715395 Vali Loss: 0.1851526 Test Loss: 0.2686900
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 57 cost time: 1.008460521697998
Epoch: 57, Steps: 64 | Train Loss: 0.0717214 Vali Loss: 0.1838460 Test Loss: 0.2674578
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 58 cost time: 1.0154154300689697
Epoch: 58, Steps: 64 | Train Loss: 0.0714651 Vali Loss: 0.1840457 Test Loss: 0.2670441
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 59 cost time: 1.0018494129180908
Epoch: 59, Steps: 64 | Train Loss: 0.0716295 Vali Loss: 0.1826684 Test Loss: 0.2667606
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 60 cost time: 1.0153734683990479
Epoch: 60, Steps: 64 | Train Loss: 0.0714502 Vali Loss: 0.1834073 Test Loss: 0.2676787
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2673899531364441, mae:0.3300311267375946, rse:0.2373260110616684
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.045563697814941406 GB
Epoch: 1 cost time: 2.1996917724609375
Epoch: 1, Steps: 64 | Train Loss: 0.8783259 Vali Loss: 2.6179967 Test Loss: 4.6161094
Validation loss decreased (inf --> 2.617997).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 2 cost time: 0.807321310043335
Epoch: 2, Steps: 64 | Train Loss: 0.7735392 Vali Loss: 2.0426211 Test Loss: 3.5506945
Validation loss decreased (2.617997 --> 2.042621).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 3 cost time: 0.779571533203125
Epoch: 3, Steps: 64 | Train Loss: 0.6117800 Vali Loss: 1.5965896 Test Loss: 2.7274995
Validation loss decreased (2.042621 --> 1.596590).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 4 cost time: 0.8034484386444092
Epoch: 4, Steps: 64 | Train Loss: 0.4827943 Vali Loss: 1.2679577 Test Loss: 2.1313901
Validation loss decreased (1.596590 --> 1.267958).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 5 cost time: 0.8150451183319092
Epoch: 5, Steps: 64 | Train Loss: 0.3855895 Vali Loss: 1.0277719 Test Loss: 1.7044798
Validation loss decreased (1.267958 --> 1.027772).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 6 cost time: 0.8052644729614258
Epoch: 6, Steps: 64 | Train Loss: 0.3137202 Vali Loss: 0.8412681 Test Loss: 1.3763512
Validation loss decreased (1.027772 --> 0.841268).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 7 cost time: 0.7802972793579102
Epoch: 7, Steps: 64 | Train Loss: 0.2620979 Vali Loss: 0.7177131 Test Loss: 1.1431638
Validation loss decreased (0.841268 --> 0.717713).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 8 cost time: 0.7913532257080078
Epoch: 8, Steps: 64 | Train Loss: 0.2250040 Vali Loss: 0.6067747 Test Loss: 0.9595536
Validation loss decreased (0.717713 --> 0.606775).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 9 cost time: 0.7945544719696045
Epoch: 9, Steps: 64 | Train Loss: 0.1979227 Vali Loss: 0.5391004 Test Loss: 0.8346940
Validation loss decreased (0.606775 --> 0.539100).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 10 cost time: 0.799769401550293
Epoch: 10, Steps: 64 | Train Loss: 0.1774613 Vali Loss: 0.4809808 Test Loss: 0.7307169
Validation loss decreased (0.539100 --> 0.480981).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 11 cost time: 0.800429105758667
Epoch: 11, Steps: 64 | Train Loss: 0.1629893 Vali Loss: 0.4396926 Test Loss: 0.6540921
Validation loss decreased (0.480981 --> 0.439693).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 12 cost time: 0.8004209995269775
Epoch: 12, Steps: 64 | Train Loss: 0.1514405 Vali Loss: 0.4113430 Test Loss: 0.6020478
Validation loss decreased (0.439693 --> 0.411343).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 13 cost time: 0.804424524307251
Epoch: 13, Steps: 64 | Train Loss: 0.1431791 Vali Loss: 0.3867801 Test Loss: 0.5582059
Validation loss decreased (0.411343 --> 0.386780).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 14 cost time: 0.8189980983734131
Epoch: 14, Steps: 64 | Train Loss: 0.1362239 Vali Loss: 0.3645860 Test Loss: 0.5264493
Validation loss decreased (0.386780 --> 0.364586).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 15 cost time: 0.8079988956451416
Epoch: 15, Steps: 64 | Train Loss: 0.1303157 Vali Loss: 0.3514937 Test Loss: 0.4945446
Validation loss decreased (0.364586 --> 0.351494).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 16 cost time: 0.8039724826812744
Epoch: 16, Steps: 64 | Train Loss: 0.1264876 Vali Loss: 0.3426909 Test Loss: 0.4740523
Validation loss decreased (0.351494 --> 0.342691).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 17 cost time: 0.8004593849182129
Epoch: 17, Steps: 64 | Train Loss: 0.1226399 Vali Loss: 0.3294635 Test Loss: 0.4539072
Validation loss decreased (0.342691 --> 0.329464).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 18 cost time: 0.8209075927734375
Epoch: 18, Steps: 64 | Train Loss: 0.1200172 Vali Loss: 0.3197307 Test Loss: 0.4390210
Validation loss decreased (0.329464 --> 0.319731).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 19 cost time: 0.8038320541381836
Epoch: 19, Steps: 64 | Train Loss: 0.1179719 Vali Loss: 0.3137691 Test Loss: 0.4300858
Validation loss decreased (0.319731 --> 0.313769).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 20 cost time: 0.8033530712127686
Epoch: 20, Steps: 64 | Train Loss: 0.1164774 Vali Loss: 0.3103315 Test Loss: 0.4212455
Validation loss decreased (0.313769 --> 0.310332).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 21 cost time: 0.8084022998809814
Epoch: 21, Steps: 64 | Train Loss: 0.1148137 Vali Loss: 0.3021701 Test Loss: 0.4075075
Validation loss decreased (0.310332 --> 0.302170).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 22 cost time: 0.818366527557373
Epoch: 22, Steps: 64 | Train Loss: 0.1136356 Vali Loss: 0.2975743 Test Loss: 0.4028293
Validation loss decreased (0.302170 --> 0.297574).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 23 cost time: 0.7986149787902832
Epoch: 23, Steps: 64 | Train Loss: 0.1118718 Vali Loss: 0.2977478 Test Loss: 0.3942441
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 24 cost time: 0.7966091632843018
Epoch: 24, Steps: 64 | Train Loss: 0.1115301 Vali Loss: 0.2908030 Test Loss: 0.3894412
Validation loss decreased (0.297574 --> 0.290803).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 25 cost time: 0.800410270690918
Epoch: 25, Steps: 64 | Train Loss: 0.1103929 Vali Loss: 0.2872829 Test Loss: 0.3846997
Validation loss decreased (0.290803 --> 0.287283).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 26 cost time: 0.7861218452453613
Epoch: 26, Steps: 64 | Train Loss: 0.1093288 Vali Loss: 0.2831919 Test Loss: 0.3794896
Validation loss decreased (0.287283 --> 0.283192).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 27 cost time: 0.8040013313293457
Epoch: 27, Steps: 64 | Train Loss: 0.1090094 Vali Loss: 0.2874438 Test Loss: 0.3787378
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 28 cost time: 0.8046300411224365
Epoch: 28, Steps: 64 | Train Loss: 0.1078993 Vali Loss: 0.2825898 Test Loss: 0.3712482
Validation loss decreased (0.283192 --> 0.282590).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 29 cost time: 0.8059823513031006
Epoch: 29, Steps: 64 | Train Loss: 0.1079085 Vali Loss: 0.2821121 Test Loss: 0.3707394
Validation loss decreased (0.282590 --> 0.282112).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 30 cost time: 0.7812857627868652
Epoch: 30, Steps: 64 | Train Loss: 0.1072777 Vali Loss: 0.2799290 Test Loss: 0.3682263
Validation loss decreased (0.282112 --> 0.279929).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 31 cost time: 0.8018174171447754
Epoch: 31, Steps: 64 | Train Loss: 0.1072248 Vali Loss: 0.2770128 Test Loss: 0.3669545
Validation loss decreased (0.279929 --> 0.277013).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 32 cost time: 0.807636022567749
Epoch: 32, Steps: 64 | Train Loss: 0.1060639 Vali Loss: 0.2781298 Test Loss: 0.3641900
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 33 cost time: 0.8091654777526855
Epoch: 33, Steps: 64 | Train Loss: 0.1068071 Vali Loss: 0.2796935 Test Loss: 0.3617524
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 34 cost time: 0.796506404876709
Epoch: 34, Steps: 64 | Train Loss: 0.1060248 Vali Loss: 0.2760053 Test Loss: 0.3627036
Validation loss decreased (0.277013 --> 0.276005).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 35 cost time: 0.805999755859375
Epoch: 35, Steps: 64 | Train Loss: 0.1060562 Vali Loss: 0.2761923 Test Loss: 0.3587915
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 36 cost time: 0.8099970817565918
Epoch: 36, Steps: 64 | Train Loss: 0.1055237 Vali Loss: 0.2748595 Test Loss: 0.3593912
Validation loss decreased (0.276005 --> 0.274859).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 37 cost time: 0.8034148216247559
Epoch: 37, Steps: 64 | Train Loss: 0.1059384 Vali Loss: 0.2751312 Test Loss: 0.3574855
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 38 cost time: 0.8043615818023682
Epoch: 38, Steps: 64 | Train Loss: 0.1052765 Vali Loss: 0.2734191 Test Loss: 0.3563694
Validation loss decreased (0.274859 --> 0.273419).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 39 cost time: 0.8019998073577881
Epoch: 39, Steps: 64 | Train Loss: 0.1049891 Vali Loss: 0.2758479 Test Loss: 0.3562926
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 40 cost time: 0.8026211261749268
Epoch: 40, Steps: 64 | Train Loss: 0.1058077 Vali Loss: 0.2734826 Test Loss: 0.3560331
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 41 cost time: 0.8043904304504395
Epoch: 41, Steps: 64 | Train Loss: 0.1054309 Vali Loss: 0.2717618 Test Loss: 0.3540035
Validation loss decreased (0.273419 --> 0.271762).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 42 cost time: 0.866386890411377
Epoch: 42, Steps: 64 | Train Loss: 0.1050651 Vali Loss: 0.2702062 Test Loss: 0.3538557
Validation loss decreased (0.271762 --> 0.270206).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 43 cost time: 0.8210139274597168
Epoch: 43, Steps: 64 | Train Loss: 0.1046298 Vali Loss: 0.2713989 Test Loss: 0.3535677
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 44 cost time: 0.7980003356933594
Epoch: 44, Steps: 64 | Train Loss: 0.1049449 Vali Loss: 0.2689996 Test Loss: 0.3540406
Validation loss decreased (0.270206 --> 0.269000).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 45 cost time: 0.8066112995147705
Epoch: 45, Steps: 64 | Train Loss: 0.1052285 Vali Loss: 0.2672586 Test Loss: 0.3542909
Validation loss decreased (0.269000 --> 0.267259).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 46 cost time: 0.7970840930938721
Epoch: 46, Steps: 64 | Train Loss: 0.1041030 Vali Loss: 0.2725298 Test Loss: 0.3527704
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 47 cost time: 0.7968168258666992
Epoch: 47, Steps: 64 | Train Loss: 0.1042797 Vali Loss: 0.2699907 Test Loss: 0.3508839
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 48 cost time: 0.7959995269775391
Epoch: 48, Steps: 64 | Train Loss: 0.1041306 Vali Loss: 0.2714645 Test Loss: 0.3538134
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 49 cost time: 0.7996199131011963
Epoch: 49, Steps: 64 | Train Loss: 0.1040246 Vali Loss: 0.2689224 Test Loss: 0.3510651
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 50 cost time: 0.8014678955078125
Epoch: 50, Steps: 64 | Train Loss: 0.1033379 Vali Loss: 0.2700911 Test Loss: 0.3513899
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 51 cost time: 0.8033158779144287
Epoch: 51, Steps: 64 | Train Loss: 0.1046803 Vali Loss: 0.2707117 Test Loss: 0.3520251
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 52 cost time: 0.8000001907348633
Epoch: 52, Steps: 64 | Train Loss: 0.1042332 Vali Loss: 0.2678628 Test Loss: 0.3503015
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 53 cost time: 0.8086328506469727
Epoch: 53, Steps: 64 | Train Loss: 0.1034642 Vali Loss: 0.2673228 Test Loss: 0.3480999
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 54 cost time: 0.8014557361602783
Epoch: 54, Steps: 64 | Train Loss: 0.1036300 Vali Loss: 0.2704700 Test Loss: 0.3499920
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 55 cost time: 0.7967529296875
Epoch: 55, Steps: 64 | Train Loss: 0.1039304 Vali Loss: 0.2687194 Test Loss: 0.3483028
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 56 cost time: 0.7976360321044922
Epoch: 56, Steps: 64 | Train Loss: 0.1044791 Vali Loss: 0.2694109 Test Loss: 0.3509356
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 57 cost time: 0.8006191253662109
Epoch: 57, Steps: 64 | Train Loss: 0.1037166 Vali Loss: 0.2679451 Test Loss: 0.3508932
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 58 cost time: 0.7964146137237549
Epoch: 58, Steps: 64 | Train Loss: 0.1038315 Vali Loss: 0.2662294 Test Loss: 0.3474937
Validation loss decreased (0.267259 --> 0.266229).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 59 cost time: 0.7987916469573975
Epoch: 59, Steps: 64 | Train Loss: 0.1035384 Vali Loss: 0.2703672 Test Loss: 0.3501767
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 60 cost time: 0.7987830638885498
Epoch: 60, Steps: 64 | Train Loss: 0.1039361 Vali Loss: 0.2661010 Test Loss: 0.3467636
Validation loss decreased (0.266229 --> 0.266101).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.346763551235199, mae:0.4169292747974396, rse:0.2702648341655731
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 1 cost time: 2.2161905765533447
Epoch: 1, Steps: 64 | Train Loss: 0.8471041 Vali Loss: 2.5922406 Test Loss: 4.6001587
Validation loss decreased (inf --> 2.592241).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 2 cost time: 0.8524084091186523
Epoch: 2, Steps: 64 | Train Loss: 0.5540048 Vali Loss: 0.8649234 Test Loss: 1.4675719
Validation loss decreased (2.592241 --> 0.864923).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 3 cost time: 0.8503572940826416
Epoch: 3, Steps: 64 | Train Loss: 0.1865658 Vali Loss: 0.2787627 Test Loss: 0.3385108
Validation loss decreased (0.864923 --> 0.278763).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 4 cost time: 0.8497304916381836
Epoch: 4, Steps: 64 | Train Loss: 0.1172363 Vali Loss: 0.2591505 Test Loss: 0.2964412
Validation loss decreased (0.278763 --> 0.259150).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 5 cost time: 0.8334560394287109
Epoch: 5, Steps: 64 | Train Loss: 0.1106185 Vali Loss: 0.2604309 Test Loss: 0.3006065
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 6 cost time: 0.8282408714294434
Epoch: 6, Steps: 64 | Train Loss: 0.1063668 Vali Loss: 0.2552408 Test Loss: 0.2948026
Validation loss decreased (0.259150 --> 0.255241).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 7 cost time: 0.8303687572479248
Epoch: 7, Steps: 64 | Train Loss: 0.1032007 Vali Loss: 0.2467450 Test Loss: 0.2962595
Validation loss decreased (0.255241 --> 0.246745).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 8 cost time: 0.8327353000640869
Epoch: 8, Steps: 64 | Train Loss: 0.1017344 Vali Loss: 0.2491015 Test Loss: 0.2917319
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 9 cost time: 0.8097672462463379
Epoch: 9, Steps: 64 | Train Loss: 0.0997330 Vali Loss: 0.2456843 Test Loss: 0.2949077
Validation loss decreased (0.246745 --> 0.245684).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 10 cost time: 0.8269999027252197
Epoch: 10, Steps: 64 | Train Loss: 0.0981542 Vali Loss: 0.2415942 Test Loss: 0.2936716
Validation loss decreased (0.245684 --> 0.241594).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 11 cost time: 0.8376109600067139
Epoch: 11, Steps: 64 | Train Loss: 0.0962569 Vali Loss: 0.2411223 Test Loss: 0.2913888
Validation loss decreased (0.241594 --> 0.241122).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 12 cost time: 0.8423643112182617
Epoch: 12, Steps: 64 | Train Loss: 0.0958445 Vali Loss: 0.2381047 Test Loss: 0.2927023
Validation loss decreased (0.241122 --> 0.238105).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 13 cost time: 0.9034028053283691
Epoch: 13, Steps: 64 | Train Loss: 0.0944883 Vali Loss: 0.2387712 Test Loss: 0.2925947
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 14 cost time: 0.8347461223602295
Epoch: 14, Steps: 64 | Train Loss: 0.0934660 Vali Loss: 0.2318905 Test Loss: 0.2917987
Validation loss decreased (0.238105 --> 0.231891).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 15 cost time: 0.8284397125244141
Epoch: 15, Steps: 64 | Train Loss: 0.0925425 Vali Loss: 0.2335119 Test Loss: 0.2936150
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 16 cost time: 0.8396375179290771
Epoch: 16, Steps: 64 | Train Loss: 0.0917634 Vali Loss: 0.2319131 Test Loss: 0.2935841
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 17 cost time: 0.906374454498291
Epoch: 17, Steps: 64 | Train Loss: 0.0923579 Vali Loss: 0.2319991 Test Loss: 0.2923994
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 18 cost time: 0.9043481349945068
Epoch: 18, Steps: 64 | Train Loss: 0.0909249 Vali Loss: 0.2291856 Test Loss: 0.2945905
Validation loss decreased (0.231891 --> 0.229186).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 19 cost time: 0.9034397602081299
Epoch: 19, Steps: 64 | Train Loss: 0.0906326 Vali Loss: 0.2288626 Test Loss: 0.2931857
Validation loss decreased (0.229186 --> 0.228863).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 20 cost time: 0.8407993316650391
Epoch: 20, Steps: 64 | Train Loss: 0.0900600 Vali Loss: 0.2281575 Test Loss: 0.2950442
Validation loss decreased (0.228863 --> 0.228157).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 21 cost time: 0.8329999446868896
Epoch: 21, Steps: 64 | Train Loss: 0.0893367 Vali Loss: 0.2284781 Test Loss: 0.2948436
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 22 cost time: 0.8376193046569824
Epoch: 22, Steps: 64 | Train Loss: 0.0888071 Vali Loss: 0.2279076 Test Loss: 0.2958322
Validation loss decreased (0.228157 --> 0.227908).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 23 cost time: 0.8424344062805176
Epoch: 23, Steps: 64 | Train Loss: 0.0898098 Vali Loss: 0.2276055 Test Loss: 0.2952940
Validation loss decreased (0.227908 --> 0.227606).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 24 cost time: 0.8263881206512451
Epoch: 24, Steps: 64 | Train Loss: 0.0887500 Vali Loss: 0.2266157 Test Loss: 0.2952089
Validation loss decreased (0.227606 --> 0.226616).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 25 cost time: 0.8287484645843506
Epoch: 25, Steps: 64 | Train Loss: 0.0884909 Vali Loss: 0.2248543 Test Loss: 0.2967540
Validation loss decreased (0.226616 --> 0.224854).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 26 cost time: 0.8290002346038818
Epoch: 26, Steps: 64 | Train Loss: 0.0878473 Vali Loss: 0.2275493 Test Loss: 0.2960720
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 27 cost time: 0.8333969116210938
Epoch: 27, Steps: 64 | Train Loss: 0.0881332 Vali Loss: 0.2270455 Test Loss: 0.2969089
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 28 cost time: 0.814464807510376
Epoch: 28, Steps: 64 | Train Loss: 0.0878473 Vali Loss: 0.2258457 Test Loss: 0.2958837
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 29 cost time: 0.7961719036102295
Epoch: 29, Steps: 64 | Train Loss: 0.0877481 Vali Loss: 0.2249232 Test Loss: 0.2965255
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 30 cost time: 0.836000919342041
Epoch: 30, Steps: 64 | Train Loss: 0.0874046 Vali Loss: 0.2250410 Test Loss: 0.2971264
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 31 cost time: 0.8276293277740479
Epoch: 31, Steps: 64 | Train Loss: 0.0871754 Vali Loss: 0.2252944 Test Loss: 0.2989488
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 32 cost time: 0.8283393383026123
Epoch: 32, Steps: 64 | Train Loss: 0.0869162 Vali Loss: 0.2239834 Test Loss: 0.2979408
Validation loss decreased (0.224854 --> 0.223983).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 33 cost time: 0.8313424587249756
Epoch: 33, Steps: 64 | Train Loss: 0.0872644 Vali Loss: 0.2232846 Test Loss: 0.2964675
Validation loss decreased (0.223983 --> 0.223285).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 34 cost time: 0.8278841972351074
Epoch: 34, Steps: 64 | Train Loss: 0.0871541 Vali Loss: 0.2268391 Test Loss: 0.2983990
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 35 cost time: 0.829998254776001
Epoch: 35, Steps: 64 | Train Loss: 0.0872826 Vali Loss: 0.2272342 Test Loss: 0.2987318
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 36 cost time: 0.8263192176818848
Epoch: 36, Steps: 64 | Train Loss: 0.0869124 Vali Loss: 0.2253771 Test Loss: 0.2977403
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 37 cost time: 0.8263640403747559
Epoch: 37, Steps: 64 | Train Loss: 0.0871668 Vali Loss: 0.2258548 Test Loss: 0.2978323
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 38 cost time: 0.8283531665802002
Epoch: 38, Steps: 64 | Train Loss: 0.0869352 Vali Loss: 0.2268940 Test Loss: 0.2976659
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 39 cost time: 0.8464298248291016
Epoch: 39, Steps: 64 | Train Loss: 0.0867611 Vali Loss: 0.2248377 Test Loss: 0.2976329
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 40 cost time: 0.832618236541748
Epoch: 40, Steps: 64 | Train Loss: 0.0870694 Vali Loss: 0.2247776 Test Loss: 0.2977180
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 41 cost time: 0.8394262790679932
Epoch: 41, Steps: 64 | Train Loss: 0.0866089 Vali Loss: 0.2250929 Test Loss: 0.2979365
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 42 cost time: 0.8333420753479004
Epoch: 42, Steps: 64 | Train Loss: 0.0874568 Vali Loss: 0.2261573 Test Loss: 0.2965011
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 43 cost time: 0.82674241065979
Epoch: 43, Steps: 64 | Train Loss: 0.0865150 Vali Loss: 0.2244444 Test Loss: 0.2972578
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 44 cost time: 0.8299980163574219
Epoch: 44, Steps: 64 | Train Loss: 0.0865162 Vali Loss: 0.2242903 Test Loss: 0.2978971
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 45 cost time: 0.8306212425231934
Epoch: 45, Steps: 64 | Train Loss: 0.0868853 Vali Loss: 0.2225330 Test Loss: 0.2978289
Validation loss decreased (0.223285 --> 0.222533).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 46 cost time: 0.8373696804046631
Epoch: 46, Steps: 64 | Train Loss: 0.0867936 Vali Loss: 0.2253023 Test Loss: 0.2976129
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 47 cost time: 0.8314008712768555
Epoch: 47, Steps: 64 | Train Loss: 0.0862792 Vali Loss: 0.2249858 Test Loss: 0.2988749
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 48 cost time: 0.8314754962921143
Epoch: 48, Steps: 64 | Train Loss: 0.0867838 Vali Loss: 0.2260005 Test Loss: 0.2987785
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 49 cost time: 0.8290004730224609
Epoch: 49, Steps: 64 | Train Loss: 0.0863172 Vali Loss: 0.2231631 Test Loss: 0.2990967
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 50 cost time: 0.8283729553222656
Epoch: 50, Steps: 64 | Train Loss: 0.0864401 Vali Loss: 0.2238684 Test Loss: 0.2987757
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 51 cost time: 0.8413548469543457
Epoch: 51, Steps: 64 | Train Loss: 0.0865970 Vali Loss: 0.2250390 Test Loss: 0.2979190
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 52 cost time: 0.8273448944091797
Epoch: 52, Steps: 64 | Train Loss: 0.0867545 Vali Loss: 0.2257561 Test Loss: 0.2983644
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 53 cost time: 0.8313980102539062
Epoch: 53, Steps: 64 | Train Loss: 0.0863487 Vali Loss: 0.2245992 Test Loss: 0.2985612
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 54 cost time: 0.8426153659820557
Epoch: 54, Steps: 64 | Train Loss: 0.0867396 Vali Loss: 0.2249190 Test Loss: 0.2974642
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 55 cost time: 0.8294119834899902
Epoch: 55, Steps: 64 | Train Loss: 0.0864011 Vali Loss: 0.2243257 Test Loss: 0.2977552
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 56 cost time: 0.8283717632293701
Epoch: 56, Steps: 64 | Train Loss: 0.0867390 Vali Loss: 0.2251013 Test Loss: 0.2986592
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 57 cost time: 0.834768533706665
Epoch: 57, Steps: 64 | Train Loss: 0.0860551 Vali Loss: 0.2249167 Test Loss: 0.2980686
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 58 cost time: 0.8245623111724854
Epoch: 58, Steps: 64 | Train Loss: 0.0866508 Vali Loss: 0.2237349 Test Loss: 0.2986352
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 59 cost time: 0.8316299915313721
Epoch: 59, Steps: 64 | Train Loss: 0.0863482 Vali Loss: 0.2245868 Test Loss: 0.2986265
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 60 cost time: 0.830345869064331
Epoch: 60, Steps: 64 | Train Loss: 0.0863584 Vali Loss: 0.2222779 Test Loss: 0.2982381
Validation loss decreased (0.222533 --> 0.222278).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.298238068819046, mae:0.3747505247592926, rse:0.2506422698497772
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05285072326660156 GB
Epoch: 1 cost time: 2.290210723876953
Epoch: 1, Steps: 64 | Train Loss: 0.8183588 Vali Loss: 2.5340936 Test Loss: 4.4641852
Validation loss decreased (inf --> 2.534094).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 2 cost time: 0.8134405612945557
Epoch: 2, Steps: 64 | Train Loss: 0.4435242 Vali Loss: 0.3089880 Test Loss: 0.4125866
Validation loss decreased (2.534094 --> 0.308988).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 3 cost time: 0.8297131061553955
Epoch: 3, Steps: 64 | Train Loss: 0.1268360 Vali Loss: 0.2815289 Test Loss: 0.3188758
Validation loss decreased (0.308988 --> 0.281529).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 4 cost time: 0.8513226509094238
Epoch: 4, Steps: 64 | Train Loss: 0.1125299 Vali Loss: 0.2580409 Test Loss: 0.2904123
Validation loss decreased (0.281529 --> 0.258041).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 5 cost time: 0.8534574508666992
Epoch: 5, Steps: 64 | Train Loss: 0.1068134 Vali Loss: 0.2552517 Test Loss: 0.2939351
Validation loss decreased (0.258041 --> 0.255252).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 6 cost time: 0.845391035079956
Epoch: 6, Steps: 64 | Train Loss: 0.1021884 Vali Loss: 0.2520818 Test Loss: 0.2948635
Validation loss decreased (0.255252 --> 0.252082).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 7 cost time: 0.8487377166748047
Epoch: 7, Steps: 64 | Train Loss: 0.1003359 Vali Loss: 0.2441583 Test Loss: 0.2926269
Validation loss decreased (0.252082 --> 0.244158).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 8 cost time: 0.8488209247589111
Epoch: 8, Steps: 64 | Train Loss: 0.0987026 Vali Loss: 0.2451142 Test Loss: 0.2895101
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 9 cost time: 0.8456182479858398
Epoch: 9, Steps: 64 | Train Loss: 0.0957118 Vali Loss: 0.2392011 Test Loss: 0.2885880
Validation loss decreased (0.244158 --> 0.239201).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 10 cost time: 0.8769717216491699
Epoch: 10, Steps: 64 | Train Loss: 0.0941689 Vali Loss: 0.2357559 Test Loss: 0.2891282
Validation loss decreased (0.239201 --> 0.235756).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 11 cost time: 0.8743228912353516
Epoch: 11, Steps: 64 | Train Loss: 0.0935168 Vali Loss: 0.2315065 Test Loss: 0.2890758
Validation loss decreased (0.235756 --> 0.231507).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 12 cost time: 0.8723640441894531
Epoch: 12, Steps: 64 | Train Loss: 0.0917254 Vali Loss: 0.2329342 Test Loss: 0.2909872
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 13 cost time: 0.9324605464935303
Epoch: 13, Steps: 64 | Train Loss: 0.0916036 Vali Loss: 0.2289679 Test Loss: 0.2898799
Validation loss decreased (0.231507 --> 0.228968).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 14 cost time: 0.891000509262085
Epoch: 14, Steps: 64 | Train Loss: 0.0907182 Vali Loss: 0.2322261 Test Loss: 0.2915145
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 15 cost time: 0.8436136245727539
Epoch: 15, Steps: 64 | Train Loss: 0.0900187 Vali Loss: 0.2302349 Test Loss: 0.2919428
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 16 cost time: 0.8680000305175781
Epoch: 16, Steps: 64 | Train Loss: 0.0892469 Vali Loss: 0.2265728 Test Loss: 0.2909084
Validation loss decreased (0.228968 --> 0.226573).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 17 cost time: 0.8519999980926514
Epoch: 17, Steps: 64 | Train Loss: 0.0891704 Vali Loss: 0.2280472 Test Loss: 0.2914371
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 18 cost time: 0.8479995727539062
Epoch: 18, Steps: 64 | Train Loss: 0.0886771 Vali Loss: 0.2250938 Test Loss: 0.2923994
Validation loss decreased (0.226573 --> 0.225094).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 19 cost time: 0.8435161113739014
Epoch: 19, Steps: 64 | Train Loss: 0.0879757 Vali Loss: 0.2257745 Test Loss: 0.2927920
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 20 cost time: 0.8730006217956543
Epoch: 20, Steps: 64 | Train Loss: 0.0870957 Vali Loss: 0.2275131 Test Loss: 0.2940677
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 21 cost time: 0.8506085872650146
Epoch: 21, Steps: 64 | Train Loss: 0.0870008 Vali Loss: 0.2244733 Test Loss: 0.2939581
Validation loss decreased (0.225094 --> 0.224473).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 22 cost time: 0.8516125679016113
Epoch: 22, Steps: 64 | Train Loss: 0.0864053 Vali Loss: 0.2257628 Test Loss: 0.2948664
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 23 cost time: 0.8480005264282227
Epoch: 23, Steps: 64 | Train Loss: 0.0862199 Vali Loss: 0.2250889 Test Loss: 0.2936926
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 24 cost time: 0.8563342094421387
Epoch: 24, Steps: 64 | Train Loss: 0.0862605 Vali Loss: 0.2258770 Test Loss: 0.2954488
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 25 cost time: 0.8299984931945801
Epoch: 25, Steps: 64 | Train Loss: 0.0857823 Vali Loss: 0.2261647 Test Loss: 0.2951009
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 26 cost time: 0.8439998626708984
Epoch: 26, Steps: 64 | Train Loss: 0.0854809 Vali Loss: 0.2236538 Test Loss: 0.2953212
Validation loss decreased (0.224473 --> 0.223654).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 27 cost time: 0.8535547256469727
Epoch: 27, Steps: 64 | Train Loss: 0.0856603 Vali Loss: 0.2243932 Test Loss: 0.2960041
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 28 cost time: 0.8423998355865479
Epoch: 28, Steps: 64 | Train Loss: 0.0852682 Vali Loss: 0.2253895 Test Loss: 0.2949996
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 29 cost time: 0.8437764644622803
Epoch: 29, Steps: 64 | Train Loss: 0.0848849 Vali Loss: 0.2212460 Test Loss: 0.2951289
Validation loss decreased (0.223654 --> 0.221246).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 30 cost time: 0.8466253280639648
Epoch: 30, Steps: 64 | Train Loss: 0.0854569 Vali Loss: 0.2224101 Test Loss: 0.2956991
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 31 cost time: 0.8341493606567383
Epoch: 31, Steps: 64 | Train Loss: 0.0855598 Vali Loss: 0.2265863 Test Loss: 0.2963666
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 32 cost time: 0.8453643321990967
Epoch: 32, Steps: 64 | Train Loss: 0.0849307 Vali Loss: 0.2216425 Test Loss: 0.2965022
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 33 cost time: 0.8463990688323975
Epoch: 33, Steps: 64 | Train Loss: 0.0850075 Vali Loss: 0.2204347 Test Loss: 0.2963782
Validation loss decreased (0.221246 --> 0.220435).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 34 cost time: 0.8448672294616699
Epoch: 34, Steps: 64 | Train Loss: 0.0846936 Vali Loss: 0.2198566 Test Loss: 0.2967592
Validation loss decreased (0.220435 --> 0.219857).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 35 cost time: 0.8459982872009277
Epoch: 35, Steps: 64 | Train Loss: 0.0846119 Vali Loss: 0.2221506 Test Loss: 0.2965620
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 36 cost time: 0.845618486404419
Epoch: 36, Steps: 64 | Train Loss: 0.0845212 Vali Loss: 0.2221186 Test Loss: 0.2957296
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 37 cost time: 0.8493506908416748
Epoch: 37, Steps: 64 | Train Loss: 0.0841216 Vali Loss: 0.2228290 Test Loss: 0.2971728
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 38 cost time: 0.8634142875671387
Epoch: 38, Steps: 64 | Train Loss: 0.0846023 Vali Loss: 0.2235480 Test Loss: 0.2971412
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 39 cost time: 0.8638877868652344
Epoch: 39, Steps: 64 | Train Loss: 0.0843401 Vali Loss: 0.2196547 Test Loss: 0.2957506
Validation loss decreased (0.219857 --> 0.219655).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 40 cost time: 0.8575334548950195
Epoch: 40, Steps: 64 | Train Loss: 0.0850945 Vali Loss: 0.2226814 Test Loss: 0.2979918
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 41 cost time: 0.8536286354064941
Epoch: 41, Steps: 64 | Train Loss: 0.0843604 Vali Loss: 0.2203125 Test Loss: 0.2969051
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 42 cost time: 0.8724308013916016
Epoch: 42, Steps: 64 | Train Loss: 0.0849070 Vali Loss: 0.2214076 Test Loss: 0.2956531
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 43 cost time: 0.8553643226623535
Epoch: 43, Steps: 64 | Train Loss: 0.0846256 Vali Loss: 0.2238241 Test Loss: 0.2964386
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 44 cost time: 0.8527793884277344
Epoch: 44, Steps: 64 | Train Loss: 0.0842918 Vali Loss: 0.2224490 Test Loss: 0.2974063
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 45 cost time: 0.8554205894470215
Epoch: 45, Steps: 64 | Train Loss: 0.0850684 Vali Loss: 0.2210728 Test Loss: 0.2978788
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 46 cost time: 0.8752188682556152
Epoch: 46, Steps: 64 | Train Loss: 0.0846863 Vali Loss: 0.2206448 Test Loss: 0.2975168
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 47 cost time: 0.9270777702331543
Epoch: 47, Steps: 64 | Train Loss: 0.0843661 Vali Loss: 0.2231341 Test Loss: 0.2966874
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 48 cost time: 0.8493430614471436
Epoch: 48, Steps: 64 | Train Loss: 0.0842536 Vali Loss: 0.2226314 Test Loss: 0.2977649
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 49 cost time: 0.8526020050048828
Epoch: 49, Steps: 64 | Train Loss: 0.0847029 Vali Loss: 0.2225008 Test Loss: 0.2968536
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 50 cost time: 0.8451862335205078
Epoch: 50, Steps: 64 | Train Loss: 0.0845209 Vali Loss: 0.2232978 Test Loss: 0.2973067
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 51 cost time: 0.8430001735687256
Epoch: 51, Steps: 64 | Train Loss: 0.0842901 Vali Loss: 0.2194898 Test Loss: 0.2963348
Validation loss decreased (0.219655 --> 0.219490).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 52 cost time: 0.845635175704956
Epoch: 52, Steps: 64 | Train Loss: 0.0845744 Vali Loss: 0.2227143 Test Loss: 0.2964135
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 53 cost time: 0.8503210544586182
Epoch: 53, Steps: 64 | Train Loss: 0.0845056 Vali Loss: 0.2220184 Test Loss: 0.2969467
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 54 cost time: 0.8462443351745605
Epoch: 54, Steps: 64 | Train Loss: 0.0841402 Vali Loss: 0.2210239 Test Loss: 0.2973100
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 55 cost time: 0.8455426692962646
Epoch: 55, Steps: 64 | Train Loss: 0.0844666 Vali Loss: 0.2203910 Test Loss: 0.2978727
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 56 cost time: 0.8458733558654785
Epoch: 56, Steps: 64 | Train Loss: 0.0842589 Vali Loss: 0.2196674 Test Loss: 0.2968992
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 57 cost time: 0.8366177082061768
Epoch: 57, Steps: 64 | Train Loss: 0.0842690 Vali Loss: 0.2217387 Test Loss: 0.2972663
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 58 cost time: 0.8209357261657715
Epoch: 58, Steps: 64 | Train Loss: 0.0843478 Vali Loss: 0.2227457 Test Loss: 0.2968270
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 59 cost time: 0.8453779220581055
Epoch: 59, Steps: 64 | Train Loss: 0.0844989 Vali Loss: 0.2168109 Test Loss: 0.2968957
Validation loss decreased (0.219490 --> 0.216811).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 60 cost time: 0.8415966033935547
Epoch: 60, Steps: 64 | Train Loss: 0.0839788 Vali Loss: 0.2206293 Test Loss: 0.2969969
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.29689568281173706, mae:0.37446850538253784, rse:0.25007757544517517
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04572486877441406 GB
Epoch: 1 cost time: 2.221041202545166
Epoch: 1, Steps: 64 | Train Loss: 0.8785049 Vali Loss: 2.6169260 Test Loss: 4.6068740
Validation loss decreased (inf --> 2.616926).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 2 cost time: 0.8282380104064941
Epoch: 2, Steps: 64 | Train Loss: 0.7449852 Vali Loss: 1.8874986 Test Loss: 3.2521620
Validation loss decreased (2.616926 --> 1.887499).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 3 cost time: 0.8298006057739258
Epoch: 3, Steps: 64 | Train Loss: 0.5657198 Vali Loss: 1.4385732 Test Loss: 2.3986385
Validation loss decreased (1.887499 --> 1.438573).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 4 cost time: 0.8670861721038818
Epoch: 4, Steps: 64 | Train Loss: 0.4332625 Vali Loss: 1.1172910 Test Loss: 1.8012706
Validation loss decreased (1.438573 --> 1.117291).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 5 cost time: 0.8603818416595459
Epoch: 5, Steps: 64 | Train Loss: 0.3385959 Vali Loss: 0.8959731 Test Loss: 1.4176413
Validation loss decreased (1.117291 --> 0.895973).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 6 cost time: 0.8585624694824219
Epoch: 6, Steps: 64 | Train Loss: 0.2740431 Vali Loss: 0.7387198 Test Loss: 1.1468631
Validation loss decreased (0.895973 --> 0.738720).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 7 cost time: 0.8556315898895264
Epoch: 7, Steps: 64 | Train Loss: 0.2301867 Vali Loss: 0.6172622 Test Loss: 0.9471653
Validation loss decreased (0.738720 --> 0.617262).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 8 cost time: 0.8573727607727051
Epoch: 8, Steps: 64 | Train Loss: 0.1987300 Vali Loss: 0.5355725 Test Loss: 0.8052144
Validation loss decreased (0.617262 --> 0.535573).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 9 cost time: 0.857438325881958
Epoch: 9, Steps: 64 | Train Loss: 0.1774188 Vali Loss: 0.4714486 Test Loss: 0.6979206
Validation loss decreased (0.535573 --> 0.471449).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 10 cost time: 0.853001594543457
Epoch: 10, Steps: 64 | Train Loss: 0.1615628 Vali Loss: 0.4283506 Test Loss: 0.6233185
Validation loss decreased (0.471449 --> 0.428351).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 11 cost time: 0.8660004138946533
Epoch: 11, Steps: 64 | Train Loss: 0.1499187 Vali Loss: 0.3930656 Test Loss: 0.5642382
Validation loss decreased (0.428351 --> 0.393066).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 12 cost time: 0.867999792098999
Epoch: 12, Steps: 64 | Train Loss: 0.1399527 Vali Loss: 0.3682328 Test Loss: 0.5215528
Validation loss decreased (0.393066 --> 0.368233).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 13 cost time: 0.8636167049407959
Epoch: 13, Steps: 64 | Train Loss: 0.1325489 Vali Loss: 0.3491076 Test Loss: 0.4891743
Validation loss decreased (0.368233 --> 0.349108).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 14 cost time: 0.8624134063720703
Epoch: 14, Steps: 64 | Train Loss: 0.1282680 Vali Loss: 0.3342019 Test Loss: 0.4635044
Validation loss decreased (0.349108 --> 0.334202).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 15 cost time: 0.8640081882476807
Epoch: 15, Steps: 64 | Train Loss: 0.1229794 Vali Loss: 0.3194704 Test Loss: 0.4374648
Validation loss decreased (0.334202 --> 0.319470).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 16 cost time: 0.8567488193511963
Epoch: 16, Steps: 64 | Train Loss: 0.1200970 Vali Loss: 0.3078357 Test Loss: 0.4240150
Validation loss decreased (0.319470 --> 0.307836).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 17 cost time: 0.8579998016357422
Epoch: 17, Steps: 64 | Train Loss: 0.1177349 Vali Loss: 0.3003481 Test Loss: 0.4110264
Validation loss decreased (0.307836 --> 0.300348).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 18 cost time: 0.8576149940490723
Epoch: 18, Steps: 64 | Train Loss: 0.1146938 Vali Loss: 0.2925954 Test Loss: 0.3974509
Validation loss decreased (0.300348 --> 0.292595).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 19 cost time: 0.8704371452331543
Epoch: 19, Steps: 64 | Train Loss: 0.1138643 Vali Loss: 0.2860240 Test Loss: 0.3860394
Validation loss decreased (0.292595 --> 0.286024).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 20 cost time: 0.8597145080566406
Epoch: 20, Steps: 64 | Train Loss: 0.1119694 Vali Loss: 0.2830419 Test Loss: 0.3799584
Validation loss decreased (0.286024 --> 0.283042).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 21 cost time: 0.8635141849517822
Epoch: 21, Steps: 64 | Train Loss: 0.1101663 Vali Loss: 0.2801137 Test Loss: 0.3744959
Validation loss decreased (0.283042 --> 0.280114).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 22 cost time: 0.8589997291564941
Epoch: 22, Steps: 64 | Train Loss: 0.1092694 Vali Loss: 0.2770618 Test Loss: 0.3685424
Validation loss decreased (0.280114 --> 0.277062).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 23 cost time: 0.8549990653991699
Epoch: 23, Steps: 64 | Train Loss: 0.1090334 Vali Loss: 0.2722454 Test Loss: 0.3595342
Validation loss decreased (0.277062 --> 0.272245).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 24 cost time: 0.8518328666687012
Epoch: 24, Steps: 64 | Train Loss: 0.1075400 Vali Loss: 0.2717796 Test Loss: 0.3575237
Validation loss decreased (0.272245 --> 0.271780).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 25 cost time: 0.8503701686859131
Epoch: 25, Steps: 64 | Train Loss: 0.1071802 Vali Loss: 0.2690820 Test Loss: 0.3518675
Validation loss decreased (0.271780 --> 0.269082).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 26 cost time: 0.8604214191436768
Epoch: 26, Steps: 64 | Train Loss: 0.1057939 Vali Loss: 0.2659251 Test Loss: 0.3497923
Validation loss decreased (0.269082 --> 0.265925).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 27 cost time: 0.844735860824585
Epoch: 27, Steps: 64 | Train Loss: 0.1051101 Vali Loss: 0.2658292 Test Loss: 0.3491972
Validation loss decreased (0.265925 --> 0.265829).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 28 cost time: 0.8499996662139893
Epoch: 28, Steps: 64 | Train Loss: 0.1054566 Vali Loss: 0.2645667 Test Loss: 0.3455459
Validation loss decreased (0.265829 --> 0.264567).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 29 cost time: 0.8596110343933105
Epoch: 29, Steps: 64 | Train Loss: 0.1051184 Vali Loss: 0.2591279 Test Loss: 0.3416849
Validation loss decreased (0.264567 --> 0.259128).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 30 cost time: 0.857327938079834
Epoch: 30, Steps: 64 | Train Loss: 0.1044096 Vali Loss: 0.2588938 Test Loss: 0.3413215
Validation loss decreased (0.259128 --> 0.258894).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 31 cost time: 0.8586852550506592
Epoch: 31, Steps: 64 | Train Loss: 0.1041707 Vali Loss: 0.2590461 Test Loss: 0.3403648
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 32 cost time: 0.8637158870697021
Epoch: 32, Steps: 64 | Train Loss: 0.1036987 Vali Loss: 0.2594495 Test Loss: 0.3364416
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 33 cost time: 0.855781078338623
Epoch: 33, Steps: 64 | Train Loss: 0.1037002 Vali Loss: 0.2567050 Test Loss: 0.3364260
Validation loss decreased (0.258894 --> 0.256705).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 34 cost time: 0.8506247997283936
Epoch: 34, Steps: 64 | Train Loss: 0.1035622 Vali Loss: 0.2576948 Test Loss: 0.3368956
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 35 cost time: 0.85440993309021
Epoch: 35, Steps: 64 | Train Loss: 0.1031896 Vali Loss: 0.2559355 Test Loss: 0.3325842
Validation loss decreased (0.256705 --> 0.255936).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 36 cost time: 0.8495111465454102
Epoch: 36, Steps: 64 | Train Loss: 0.1015752 Vali Loss: 0.2543603 Test Loss: 0.3343680
Validation loss decreased (0.255936 --> 0.254360).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 37 cost time: 0.856788158416748
Epoch: 37, Steps: 64 | Train Loss: 0.1028933 Vali Loss: 0.2564833 Test Loss: 0.3353170
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 38 cost time: 0.8723902702331543
Epoch: 38, Steps: 64 | Train Loss: 0.1030385 Vali Loss: 0.2555696 Test Loss: 0.3306307
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 39 cost time: 0.931633710861206
Epoch: 39, Steps: 64 | Train Loss: 0.1031937 Vali Loss: 0.2549153 Test Loss: 0.3287947
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 40 cost time: 0.872617244720459
Epoch: 40, Steps: 64 | Train Loss: 0.1021924 Vali Loss: 0.2521701 Test Loss: 0.3299746
Validation loss decreased (0.254360 --> 0.252170).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 41 cost time: 0.8724687099456787
Epoch: 41, Steps: 64 | Train Loss: 0.1018717 Vali Loss: 0.2528438 Test Loss: 0.3287758
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 42 cost time: 0.858375072479248
Epoch: 42, Steps: 64 | Train Loss: 0.1021447 Vali Loss: 0.2535443 Test Loss: 0.3294202
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 43 cost time: 0.8538398742675781
Epoch: 43, Steps: 64 | Train Loss: 0.1014589 Vali Loss: 0.2539257 Test Loss: 0.3280937
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 44 cost time: 0.8580000400543213
Epoch: 44, Steps: 64 | Train Loss: 0.1016910 Vali Loss: 0.2517759 Test Loss: 0.3301083
Validation loss decreased (0.252170 --> 0.251776).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 45 cost time: 0.8646142482757568
Epoch: 45, Steps: 64 | Train Loss: 0.1015312 Vali Loss: 0.2526697 Test Loss: 0.3287294
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 46 cost time: 0.8534073829650879
Epoch: 46, Steps: 64 | Train Loss: 0.1015604 Vali Loss: 0.2487645 Test Loss: 0.3290779
Validation loss decreased (0.251776 --> 0.248765).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 47 cost time: 0.863961935043335
Epoch: 47, Steps: 64 | Train Loss: 0.1019134 Vali Loss: 0.2515730 Test Loss: 0.3268794
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 48 cost time: 0.8707592487335205
Epoch: 48, Steps: 64 | Train Loss: 0.1017434 Vali Loss: 0.2512904 Test Loss: 0.3288065
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 49 cost time: 0.8599998950958252
Epoch: 49, Steps: 64 | Train Loss: 0.1022668 Vali Loss: 0.2532146 Test Loss: 0.3249129
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 50 cost time: 0.8616182804107666
Epoch: 50, Steps: 64 | Train Loss: 0.1011383 Vali Loss: 0.2522134 Test Loss: 0.3256110
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 51 cost time: 0.858234167098999
Epoch: 51, Steps: 64 | Train Loss: 0.1012732 Vali Loss: 0.2529930 Test Loss: 0.3277744
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 52 cost time: 0.8549654483795166
Epoch: 52, Steps: 64 | Train Loss: 0.1015656 Vali Loss: 0.2522738 Test Loss: 0.3289763
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 53 cost time: 0.8543570041656494
Epoch: 53, Steps: 64 | Train Loss: 0.1009877 Vali Loss: 0.2515054 Test Loss: 0.3251666
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 54 cost time: 0.8529999256134033
Epoch: 54, Steps: 64 | Train Loss: 0.1012760 Vali Loss: 0.2512176 Test Loss: 0.3262984
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 55 cost time: 0.8539996147155762
Epoch: 55, Steps: 64 | Train Loss: 0.1010029 Vali Loss: 0.2506494 Test Loss: 0.3267664
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 56 cost time: 0.850419282913208
Epoch: 56, Steps: 64 | Train Loss: 0.1007911 Vali Loss: 0.2516324 Test Loss: 0.3271789
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 57 cost time: 0.8643879890441895
Epoch: 57, Steps: 64 | Train Loss: 0.1007490 Vali Loss: 0.2490007 Test Loss: 0.3254353
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 58 cost time: 0.8644411563873291
Epoch: 58, Steps: 64 | Train Loss: 0.1010137 Vali Loss: 0.2517487 Test Loss: 0.3244323
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 59 cost time: 0.8667080402374268
Epoch: 59, Steps: 64 | Train Loss: 0.1014748 Vali Loss: 0.2518907 Test Loss: 0.3251073
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 60 cost time: 0.9087696075439453
Epoch: 60, Steps: 64 | Train Loss: 0.1007096 Vali Loss: 0.2507997 Test Loss: 0.3253510
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.3290778696537018, mae:0.395536333322525, rse:0.2632825970649719
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 1 cost time: 2.314366579055786
Epoch: 1, Steps: 64 | Train Loss: 0.8484241 Vali Loss: 2.5844011 Test Loss: 4.5644836
Validation loss decreased (inf --> 2.584401).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 2 cost time: 0.9022409915924072
Epoch: 2, Steps: 64 | Train Loss: 0.5427550 Vali Loss: 0.7550344 Test Loss: 1.2130058
Validation loss decreased (2.584401 --> 0.755034).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 3 cost time: 0.9034535884857178
Epoch: 3, Steps: 64 | Train Loss: 0.1643882 Vali Loss: 0.2745810 Test Loss: 0.2969209
Validation loss decreased (0.755034 --> 0.274581).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 4 cost time: 0.8883318901062012
Epoch: 4, Steps: 64 | Train Loss: 0.1156105 Vali Loss: 0.2714400 Test Loss: 0.3012792
Validation loss decreased (0.274581 --> 0.271440).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 5 cost time: 0.8958415985107422
Epoch: 5, Steps: 64 | Train Loss: 0.1094513 Vali Loss: 0.2621429 Test Loss: 0.3052915
Validation loss decreased (0.271440 --> 0.262143).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 6 cost time: 0.8959231376647949
Epoch: 6, Steps: 64 | Train Loss: 0.1057023 Vali Loss: 0.2556247 Test Loss: 0.2965872
Validation loss decreased (0.262143 --> 0.255625).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 7 cost time: 0.8929998874664307
Epoch: 7, Steps: 64 | Train Loss: 0.1026947 Vali Loss: 0.2499116 Test Loss: 0.2975727
Validation loss decreased (0.255625 --> 0.249912).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 8 cost time: 0.8936245441436768
Epoch: 8, Steps: 64 | Train Loss: 0.1000246 Vali Loss: 0.2490453 Test Loss: 0.2954834
Validation loss decreased (0.249912 --> 0.249045).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 9 cost time: 0.8934743404388428
Epoch: 9, Steps: 64 | Train Loss: 0.0987981 Vali Loss: 0.2459910 Test Loss: 0.2939359
Validation loss decreased (0.249045 --> 0.245991).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 10 cost time: 0.912513256072998
Epoch: 10, Steps: 64 | Train Loss: 0.0975135 Vali Loss: 0.2416697 Test Loss: 0.2933651
Validation loss decreased (0.245991 --> 0.241670).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 11 cost time: 0.8995931148529053
Epoch: 11, Steps: 64 | Train Loss: 0.0961815 Vali Loss: 0.2380813 Test Loss: 0.2936254
Validation loss decreased (0.241670 --> 0.238081).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 12 cost time: 0.8907363414764404
Epoch: 12, Steps: 64 | Train Loss: 0.0950912 Vali Loss: 0.2403845 Test Loss: 0.2926486
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 13 cost time: 0.9035377502441406
Epoch: 13, Steps: 64 | Train Loss: 0.0945440 Vali Loss: 0.2355916 Test Loss: 0.2934762
Validation loss decreased (0.238081 --> 0.235592).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 14 cost time: 0.8993954658508301
Epoch: 14, Steps: 64 | Train Loss: 0.0938448 Vali Loss: 0.2355059 Test Loss: 0.2935539
Validation loss decreased (0.235592 --> 0.235506).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 15 cost time: 0.8976223468780518
Epoch: 15, Steps: 64 | Train Loss: 0.0931582 Vali Loss: 0.2375386 Test Loss: 0.2928194
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 16 cost time: 0.8953590393066406
Epoch: 16, Steps: 64 | Train Loss: 0.0930318 Vali Loss: 0.2336914 Test Loss: 0.2933331
Validation loss decreased (0.235506 --> 0.233691).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 17 cost time: 0.9097650051116943
Epoch: 17, Steps: 64 | Train Loss: 0.0919569 Vali Loss: 0.2338344 Test Loss: 0.2930201
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 18 cost time: 0.8954432010650635
Epoch: 18, Steps: 64 | Train Loss: 0.0907793 Vali Loss: 0.2293059 Test Loss: 0.2938556
Validation loss decreased (0.233691 --> 0.229306).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 19 cost time: 0.8967840671539307
Epoch: 19, Steps: 64 | Train Loss: 0.0913946 Vali Loss: 0.2284002 Test Loss: 0.2929513
Validation loss decreased (0.229306 --> 0.228400).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 20 cost time: 0.895000696182251
Epoch: 20, Steps: 64 | Train Loss: 0.0907330 Vali Loss: 0.2335057 Test Loss: 0.2936677
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 21 cost time: 0.9006307125091553
Epoch: 21, Steps: 64 | Train Loss: 0.0909765 Vali Loss: 0.2340194 Test Loss: 0.2935555
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 22 cost time: 0.9044458866119385
Epoch: 22, Steps: 64 | Train Loss: 0.0896335 Vali Loss: 0.2310427 Test Loss: 0.2940180
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 23 cost time: 0.8975162506103516
Epoch: 23, Steps: 64 | Train Loss: 0.0903917 Vali Loss: 0.2309146 Test Loss: 0.2935002
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 24 cost time: 0.9006438255310059
Epoch: 24, Steps: 64 | Train Loss: 0.0897592 Vali Loss: 0.2282446 Test Loss: 0.2940505
Validation loss decreased (0.228400 --> 0.228245).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 25 cost time: 0.8923356533050537
Epoch: 25, Steps: 64 | Train Loss: 0.0888519 Vali Loss: 0.2275560 Test Loss: 0.2939084
Validation loss decreased (0.228245 --> 0.227556).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 26 cost time: 0.8954126834869385
Epoch: 26, Steps: 64 | Train Loss: 0.0896134 Vali Loss: 0.2305592 Test Loss: 0.2934369
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 27 cost time: 0.8953182697296143
Epoch: 27, Steps: 64 | Train Loss: 0.0885861 Vali Loss: 0.2322181 Test Loss: 0.2927935
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 28 cost time: 0.8949675559997559
Epoch: 28, Steps: 64 | Train Loss: 0.0887531 Vali Loss: 0.2317163 Test Loss: 0.2934085
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 29 cost time: 0.9017107486724854
Epoch: 29, Steps: 64 | Train Loss: 0.0882824 Vali Loss: 0.2296522 Test Loss: 0.2946201
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 30 cost time: 0.9013404846191406
Epoch: 30, Steps: 64 | Train Loss: 0.0890794 Vali Loss: 0.2301511 Test Loss: 0.2927415
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 31 cost time: 0.9027926921844482
Epoch: 31, Steps: 64 | Train Loss: 0.0882737 Vali Loss: 0.2294712 Test Loss: 0.2948089
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 32 cost time: 0.8997364044189453
Epoch: 32, Steps: 64 | Train Loss: 0.0886097 Vali Loss: 0.2264525 Test Loss: 0.2928271
Validation loss decreased (0.227556 --> 0.226452).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 33 cost time: 0.8960003852844238
Epoch: 33, Steps: 64 | Train Loss: 0.0883778 Vali Loss: 0.2296569 Test Loss: 0.2928208
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 34 cost time: 0.8956234455108643
Epoch: 34, Steps: 64 | Train Loss: 0.0878968 Vali Loss: 0.2290638 Test Loss: 0.2938411
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 35 cost time: 0.9083938598632812
Epoch: 35, Steps: 64 | Train Loss: 0.0885358 Vali Loss: 0.2277889 Test Loss: 0.2928016
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 36 cost time: 0.9004848003387451
Epoch: 36, Steps: 64 | Train Loss: 0.0878601 Vali Loss: 0.2263418 Test Loss: 0.2931704
Validation loss decreased (0.226452 --> 0.226342).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 37 cost time: 0.9075093269348145
Epoch: 37, Steps: 64 | Train Loss: 0.0884662 Vali Loss: 0.2281173 Test Loss: 0.2942600
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 38 cost time: 0.9134063720703125
Epoch: 38, Steps: 64 | Train Loss: 0.0878459 Vali Loss: 0.2283555 Test Loss: 0.2927206
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 39 cost time: 0.9037578105926514
Epoch: 39, Steps: 64 | Train Loss: 0.0879691 Vali Loss: 0.2273905 Test Loss: 0.2940916
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 40 cost time: 0.901437520980835
Epoch: 40, Steps: 64 | Train Loss: 0.0878271 Vali Loss: 0.2272998 Test Loss: 0.2935939
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 41 cost time: 0.900618314743042
Epoch: 41, Steps: 64 | Train Loss: 0.0883961 Vali Loss: 0.2287370 Test Loss: 0.2941183
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 42 cost time: 0.9034223556518555
Epoch: 42, Steps: 64 | Train Loss: 0.0879211 Vali Loss: 0.2305464 Test Loss: 0.2940516
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 43 cost time: 0.8966760635375977
Epoch: 43, Steps: 64 | Train Loss: 0.0877987 Vali Loss: 0.2285714 Test Loss: 0.2942560
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 44 cost time: 0.8977077007293701
Epoch: 44, Steps: 64 | Train Loss: 0.0877395 Vali Loss: 0.2294090 Test Loss: 0.2941329
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 45 cost time: 0.9059336185455322
Epoch: 45, Steps: 64 | Train Loss: 0.0880977 Vali Loss: 0.2279641 Test Loss: 0.2940474
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 46 cost time: 0.9000003337860107
Epoch: 46, Steps: 64 | Train Loss: 0.0875773 Vali Loss: 0.2302864 Test Loss: 0.2945513
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 47 cost time: 0.9016292095184326
Epoch: 47, Steps: 64 | Train Loss: 0.0873764 Vali Loss: 0.2270625 Test Loss: 0.2943760
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 48 cost time: 0.9061241149902344
Epoch: 48, Steps: 64 | Train Loss: 0.0877415 Vali Loss: 0.2268668 Test Loss: 0.2942422
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 49 cost time: 0.901465892791748
Epoch: 49, Steps: 64 | Train Loss: 0.0874015 Vali Loss: 0.2276279 Test Loss: 0.2926969
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 50 cost time: 0.8964624404907227
Epoch: 50, Steps: 64 | Train Loss: 0.0874625 Vali Loss: 0.2272761 Test Loss: 0.2942351
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 51 cost time: 0.8987641334533691
Epoch: 51, Steps: 64 | Train Loss: 0.0876344 Vali Loss: 0.2290893 Test Loss: 0.2941489
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 52 cost time: 0.9028623104095459
Epoch: 52, Steps: 64 | Train Loss: 0.0878669 Vali Loss: 0.2290985 Test Loss: 0.2941176
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 53 cost time: 0.9076814651489258
Epoch: 53, Steps: 64 | Train Loss: 0.0872195 Vali Loss: 0.2252202 Test Loss: 0.2935876
Validation loss decreased (0.226342 --> 0.225220).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 54 cost time: 0.9072391986846924
Epoch: 54, Steps: 64 | Train Loss: 0.0875746 Vali Loss: 0.2271661 Test Loss: 0.2947161
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 55 cost time: 0.9024326801300049
Epoch: 55, Steps: 64 | Train Loss: 0.0879640 Vali Loss: 0.2272495 Test Loss: 0.2937954
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 56 cost time: 0.9213933944702148
Epoch: 56, Steps: 64 | Train Loss: 0.0874532 Vali Loss: 0.2267918 Test Loss: 0.2939347
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 57 cost time: 0.9022390842437744
Epoch: 57, Steps: 64 | Train Loss: 0.0872802 Vali Loss: 0.2291787 Test Loss: 0.2944749
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 58 cost time: 0.9014148712158203
Epoch: 58, Steps: 64 | Train Loss: 0.0876672 Vali Loss: 0.2274469 Test Loss: 0.2937362
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 59 cost time: 0.9117527008056641
Epoch: 59, Steps: 64 | Train Loss: 0.0872751 Vali Loss: 0.2294671 Test Loss: 0.2951736
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 60 cost time: 0.8980002403259277
Epoch: 60, Steps: 64 | Train Loss: 0.0873723 Vali Loss: 0.2295043 Test Loss: 0.2933909
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2935875654220581, mae:0.3651392161846161, rse:0.24868044257164001
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05301189422607422 GB
Epoch: 1 cost time: 2.262317180633545
Epoch: 1, Steps: 64 | Train Loss: 0.8298413 Vali Loss: 2.5621800 Test Loss: 4.5455279
Validation loss decreased (inf --> 2.562180).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 2 cost time: 0.8634512424468994
Epoch: 2, Steps: 64 | Train Loss: 0.4512822 Vali Loss: 0.3084722 Test Loss: 0.3523486
Validation loss decreased (2.562180 --> 0.308472).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 3 cost time: 0.8548464775085449
Epoch: 3, Steps: 64 | Train Loss: 0.1253808 Vali Loss: 0.2933867 Test Loss: 0.3274601
Validation loss decreased (0.308472 --> 0.293387).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 4 cost time: 0.8640022277832031
Epoch: 4, Steps: 64 | Train Loss: 0.1096539 Vali Loss: 0.2614545 Test Loss: 0.2920520
Validation loss decreased (0.293387 --> 0.261454).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 5 cost time: 0.8661677837371826
Epoch: 5, Steps: 64 | Train Loss: 0.1051396 Vali Loss: 0.2603155 Test Loss: 0.2986636
Validation loss decreased (0.261454 --> 0.260315).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 6 cost time: 0.8529996871948242
Epoch: 6, Steps: 64 | Train Loss: 0.1015708 Vali Loss: 0.2504162 Test Loss: 0.2977606
Validation loss decreased (0.260315 --> 0.250416).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 7 cost time: 0.8600666522979736
Epoch: 7, Steps: 64 | Train Loss: 0.0994191 Vali Loss: 0.2455673 Test Loss: 0.2939849
Validation loss decreased (0.250416 --> 0.245567).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 8 cost time: 0.8575186729431152
Epoch: 8, Steps: 64 | Train Loss: 0.0972864 Vali Loss: 0.2436005 Test Loss: 0.2913842
Validation loss decreased (0.245567 --> 0.243601).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 9 cost time: 0.8546960353851318
Epoch: 9, Steps: 64 | Train Loss: 0.0962055 Vali Loss: 0.2409085 Test Loss: 0.2929566
Validation loss decreased (0.243601 --> 0.240908).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 10 cost time: 0.8673686981201172
Epoch: 10, Steps: 64 | Train Loss: 0.0948964 Vali Loss: 0.2394309 Test Loss: 0.2903564
Validation loss decreased (0.240908 --> 0.239431).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 11 cost time: 0.8670005798339844
Epoch: 11, Steps: 64 | Train Loss: 0.0936435 Vali Loss: 0.2360142 Test Loss: 0.2954995
Validation loss decreased (0.239431 --> 0.236014).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 12 cost time: 0.8616304397583008
Epoch: 12, Steps: 64 | Train Loss: 0.0928413 Vali Loss: 0.2377181 Test Loss: 0.2940531
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 13 cost time: 0.9525001049041748
Epoch: 13, Steps: 64 | Train Loss: 0.0924652 Vali Loss: 0.2349944 Test Loss: 0.2930945
Validation loss decreased (0.236014 --> 0.234994).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 14 cost time: 0.8774006366729736
Epoch: 14, Steps: 64 | Train Loss: 0.0915799 Vali Loss: 0.2327912 Test Loss: 0.2899426
Validation loss decreased (0.234994 --> 0.232791).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 15 cost time: 0.8605210781097412
Epoch: 15, Steps: 64 | Train Loss: 0.0916518 Vali Loss: 0.2333968 Test Loss: 0.2918554
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 16 cost time: 0.8659064769744873
Epoch: 16, Steps: 64 | Train Loss: 0.0903541 Vali Loss: 0.2311011 Test Loss: 0.2902715
Validation loss decreased (0.232791 --> 0.231101).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 17 cost time: 0.8700001239776611
Epoch: 17, Steps: 64 | Train Loss: 0.0903545 Vali Loss: 0.2295354 Test Loss: 0.2925080
Validation loss decreased (0.231101 --> 0.229535).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 18 cost time: 0.8650002479553223
Epoch: 18, Steps: 64 | Train Loss: 0.0897684 Vali Loss: 0.2308625 Test Loss: 0.2928315
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 19 cost time: 0.8626203536987305
Epoch: 19, Steps: 64 | Train Loss: 0.0886080 Vali Loss: 0.2282909 Test Loss: 0.2928921
Validation loss decreased (0.229535 --> 0.228291).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 20 cost time: 0.8652811050415039
Epoch: 20, Steps: 64 | Train Loss: 0.0887540 Vali Loss: 0.2259654 Test Loss: 0.2919081
Validation loss decreased (0.228291 --> 0.225965).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 21 cost time: 0.8743274211883545
Epoch: 21, Steps: 64 | Train Loss: 0.0885770 Vali Loss: 0.2272511 Test Loss: 0.2940595
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 22 cost time: 0.9404382705688477
Epoch: 22, Steps: 64 | Train Loss: 0.0876862 Vali Loss: 0.2266702 Test Loss: 0.2936157
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 23 cost time: 0.8843181133270264
Epoch: 23, Steps: 64 | Train Loss: 0.0882011 Vali Loss: 0.2268848 Test Loss: 0.2920981
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 24 cost time: 0.8553781509399414
Epoch: 24, Steps: 64 | Train Loss: 0.0876743 Vali Loss: 0.2272945 Test Loss: 0.2947817
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 25 cost time: 0.8336179256439209
Epoch: 25, Steps: 64 | Train Loss: 0.0873688 Vali Loss: 0.2273558 Test Loss: 0.2943681
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 26 cost time: 0.8584139347076416
Epoch: 26, Steps: 64 | Train Loss: 0.0873138 Vali Loss: 0.2243580 Test Loss: 0.2954618
Validation loss decreased (0.225965 --> 0.224358).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 27 cost time: 0.8593950271606445
Epoch: 27, Steps: 64 | Train Loss: 0.0871330 Vali Loss: 0.2259125 Test Loss: 0.2937315
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 28 cost time: 0.849602460861206
Epoch: 28, Steps: 64 | Train Loss: 0.0870715 Vali Loss: 0.2261119 Test Loss: 0.2937266
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 29 cost time: 0.8623969554901123
Epoch: 29, Steps: 64 | Train Loss: 0.0863438 Vali Loss: 0.2245076 Test Loss: 0.2943161
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 30 cost time: 0.8572251796722412
Epoch: 30, Steps: 64 | Train Loss: 0.0866637 Vali Loss: 0.2248213 Test Loss: 0.2935359
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 31 cost time: 0.8623549938201904
Epoch: 31, Steps: 64 | Train Loss: 0.0868120 Vali Loss: 0.2230041 Test Loss: 0.2947817
Validation loss decreased (0.224358 --> 0.223004).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 32 cost time: 0.8564231395721436
Epoch: 32, Steps: 64 | Train Loss: 0.0869511 Vali Loss: 0.2244035 Test Loss: 0.2939132
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 33 cost time: 0.8547232151031494
Epoch: 33, Steps: 64 | Train Loss: 0.0859295 Vali Loss: 0.2251429 Test Loss: 0.2947259
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 34 cost time: 0.8613858222961426
Epoch: 34, Steps: 64 | Train Loss: 0.0865398 Vali Loss: 0.2262221 Test Loss: 0.2955001
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 35 cost time: 0.8616211414337158
Epoch: 35, Steps: 64 | Train Loss: 0.0861379 Vali Loss: 0.2234245 Test Loss: 0.2950944
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 36 cost time: 0.9424588680267334
Epoch: 36, Steps: 64 | Train Loss: 0.0863692 Vali Loss: 0.2240824 Test Loss: 0.2943531
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 37 cost time: 0.9364452362060547
Epoch: 37, Steps: 64 | Train Loss: 0.0864776 Vali Loss: 0.2224928 Test Loss: 0.2944134
Validation loss decreased (0.223004 --> 0.222493).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 38 cost time: 0.8613584041595459
Epoch: 38, Steps: 64 | Train Loss: 0.0862520 Vali Loss: 0.2234526 Test Loss: 0.2956284
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 39 cost time: 0.8713338375091553
Epoch: 39, Steps: 64 | Train Loss: 0.0862816 Vali Loss: 0.2228762 Test Loss: 0.2945223
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 40 cost time: 0.8628032207489014
Epoch: 40, Steps: 64 | Train Loss: 0.0858559 Vali Loss: 0.2200354 Test Loss: 0.2947088
Validation loss decreased (0.222493 --> 0.220035).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 41 cost time: 0.8600001335144043
Epoch: 41, Steps: 64 | Train Loss: 0.0858722 Vali Loss: 0.2223445 Test Loss: 0.2951518
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 42 cost time: 0.8586139678955078
Epoch: 42, Steps: 64 | Train Loss: 0.0858930 Vali Loss: 0.2215688 Test Loss: 0.2952289
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 43 cost time: 0.8673927783966064
Epoch: 43, Steps: 64 | Train Loss: 0.0857711 Vali Loss: 0.2224952 Test Loss: 0.2949643
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 44 cost time: 0.8573477268218994
Epoch: 44, Steps: 64 | Train Loss: 0.0853885 Vali Loss: 0.2244933 Test Loss: 0.2954629
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 45 cost time: 0.8678305149078369
Epoch: 45, Steps: 64 | Train Loss: 0.0857019 Vali Loss: 0.2214965 Test Loss: 0.2957736
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 46 cost time: 0.8639998435974121
Epoch: 46, Steps: 64 | Train Loss: 0.0857559 Vali Loss: 0.2225624 Test Loss: 0.2955457
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 47 cost time: 0.8616108894348145
Epoch: 47, Steps: 64 | Train Loss: 0.0859482 Vali Loss: 0.2222075 Test Loss: 0.2956528
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 48 cost time: 0.8612606525421143
Epoch: 48, Steps: 64 | Train Loss: 0.0855915 Vali Loss: 0.2229778 Test Loss: 0.2957027
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 49 cost time: 0.8595442771911621
Epoch: 49, Steps: 64 | Train Loss: 0.0860362 Vali Loss: 0.2202780 Test Loss: 0.2952288
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 50 cost time: 0.8493192195892334
Epoch: 50, Steps: 64 | Train Loss: 0.0858313 Vali Loss: 0.2221659 Test Loss: 0.2959900
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 51 cost time: 0.8530006408691406
Epoch: 51, Steps: 64 | Train Loss: 0.0852834 Vali Loss: 0.2211037 Test Loss: 0.2955649
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 52 cost time: 0.8605284690856934
Epoch: 52, Steps: 64 | Train Loss: 0.0858936 Vali Loss: 0.2203210 Test Loss: 0.2959293
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 53 cost time: 0.8593337535858154
Epoch: 53, Steps: 64 | Train Loss: 0.0857776 Vali Loss: 0.2214738 Test Loss: 0.2954592
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 54 cost time: 0.8403303623199463
Epoch: 54, Steps: 64 | Train Loss: 0.0855139 Vali Loss: 0.2210380 Test Loss: 0.2958414
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 55 cost time: 0.8614130020141602
Epoch: 55, Steps: 64 | Train Loss: 0.0855542 Vali Loss: 0.2213210 Test Loss: 0.2959668
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 56 cost time: 0.8607916831970215
Epoch: 56, Steps: 64 | Train Loss: 0.0856219 Vali Loss: 0.2239389 Test Loss: 0.2966427
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 57 cost time: 0.86761474609375
Epoch: 57, Steps: 64 | Train Loss: 0.0855244 Vali Loss: 0.2232141 Test Loss: 0.2955612
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 58 cost time: 0.8456385135650635
Epoch: 58, Steps: 64 | Train Loss: 0.0854726 Vali Loss: 0.2224793 Test Loss: 0.2950347
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 59 cost time: 0.8493785858154297
Epoch: 59, Steps: 64 | Train Loss: 0.0859971 Vali Loss: 0.2251730 Test Loss: 0.2964335
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 60 cost time: 0.8659055233001709
Epoch: 60, Steps: 64 | Train Loss: 0.0858053 Vali Loss: 0.2215400 Test Loss: 0.2960215
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.29470881819725037, mae:0.3709424138069153, rse:0.24915485084056854
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04588603973388672 GB
Epoch: 1 cost time: 2.2081282138824463
Epoch: 1, Steps: 64 | Train Loss: 0.8783304 Vali Loss: 2.6013794 Test Loss: 4.5627704
Validation loss decreased (inf --> 2.601379).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 2 cost time: 0.8235540390014648
Epoch: 2, Steps: 64 | Train Loss: 0.7504661 Vali Loss: 1.8946675 Test Loss: 3.2422390
Validation loss decreased (2.601379 --> 1.894668).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 3 cost time: 0.8066253662109375
Epoch: 3, Steps: 64 | Train Loss: 0.5628167 Vali Loss: 1.4322633 Test Loss: 2.3610737
Validation loss decreased (1.894668 --> 1.432263).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 4 cost time: 0.8089108467102051
Epoch: 4, Steps: 64 | Train Loss: 0.4294390 Vali Loss: 1.1129025 Test Loss: 1.7687190
Validation loss decreased (1.432263 --> 1.112903).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 5 cost time: 0.811408281326294
Epoch: 5, Steps: 64 | Train Loss: 0.3348603 Vali Loss: 0.8959521 Test Loss: 1.3816025
Validation loss decreased (1.112903 --> 0.895952).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 6 cost time: 0.7980000972747803
Epoch: 6, Steps: 64 | Train Loss: 0.2708989 Vali Loss: 0.7418342 Test Loss: 1.1081821
Validation loss decreased (0.895952 --> 0.741834).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 7 cost time: 0.8033120632171631
Epoch: 7, Steps: 64 | Train Loss: 0.2271260 Vali Loss: 0.6306618 Test Loss: 0.9189724
Validation loss decreased (0.741834 --> 0.630662).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 8 cost time: 0.7974660396575928
Epoch: 8, Steps: 64 | Train Loss: 0.1965943 Vali Loss: 0.5419352 Test Loss: 0.7709596
Validation loss decreased (0.630662 --> 0.541935).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 9 cost time: 0.7903532981872559
Epoch: 9, Steps: 64 | Train Loss: 0.1742261 Vali Loss: 0.4806238 Test Loss: 0.6713000
Validation loss decreased (0.541935 --> 0.480624).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 10 cost time: 0.798712968826294
Epoch: 10, Steps: 64 | Train Loss: 0.1584167 Vali Loss: 0.4325984 Test Loss: 0.5971965
Validation loss decreased (0.480624 --> 0.432598).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 11 cost time: 0.8019998073577881
Epoch: 11, Steps: 64 | Train Loss: 0.1472010 Vali Loss: 0.3927778 Test Loss: 0.5292634
Validation loss decreased (0.432598 --> 0.392778).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 12 cost time: 0.8041441440582275
Epoch: 12, Steps: 64 | Train Loss: 0.1379734 Vali Loss: 0.3677468 Test Loss: 0.4954745
Validation loss decreased (0.392778 --> 0.367747).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 13 cost time: 0.8023862838745117
Epoch: 13, Steps: 64 | Train Loss: 0.1305299 Vali Loss: 0.3463655 Test Loss: 0.4604067
Validation loss decreased (0.367747 --> 0.346366).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 14 cost time: 0.8057198524475098
Epoch: 14, Steps: 64 | Train Loss: 0.1259218 Vali Loss: 0.3349487 Test Loss: 0.4349533
Validation loss decreased (0.346366 --> 0.334949).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 15 cost time: 0.8060002326965332
Epoch: 15, Steps: 64 | Train Loss: 0.1205677 Vali Loss: 0.3194912 Test Loss: 0.4128571
Validation loss decreased (0.334949 --> 0.319491).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 16 cost time: 0.7996103763580322
Epoch: 16, Steps: 64 | Train Loss: 0.1178304 Vali Loss: 0.3095740 Test Loss: 0.3989735
Validation loss decreased (0.319491 --> 0.309574).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 17 cost time: 0.8043456077575684
Epoch: 17, Steps: 64 | Train Loss: 0.1156469 Vali Loss: 0.3016160 Test Loss: 0.3873698
Validation loss decreased (0.309574 --> 0.301616).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 18 cost time: 0.8013114929199219
Epoch: 18, Steps: 64 | Train Loss: 0.1128941 Vali Loss: 0.2943155 Test Loss: 0.3761985
Validation loss decreased (0.301616 --> 0.294315).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 19 cost time: 0.8009998798370361
Epoch: 19, Steps: 64 | Train Loss: 0.1120413 Vali Loss: 0.2865625 Test Loss: 0.3673167
Validation loss decreased (0.294315 --> 0.286563).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 20 cost time: 0.8156187534332275
Epoch: 20, Steps: 64 | Train Loss: 0.1098251 Vali Loss: 0.2815238 Test Loss: 0.3617010
Validation loss decreased (0.286563 --> 0.281524).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 21 cost time: 0.8766129016876221
Epoch: 21, Steps: 64 | Train Loss: 0.1087573 Vali Loss: 0.2782165 Test Loss: 0.3564165
Validation loss decreased (0.281524 --> 0.278216).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 22 cost time: 0.8839807510375977
Epoch: 22, Steps: 64 | Train Loss: 0.1077312 Vali Loss: 0.2760600 Test Loss: 0.3499784
Validation loss decreased (0.278216 --> 0.276060).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 23 cost time: 0.8764603137969971
Epoch: 23, Steps: 64 | Train Loss: 0.1068351 Vali Loss: 0.2735585 Test Loss: 0.3437877
Validation loss decreased (0.276060 --> 0.273558).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 24 cost time: 0.8517823219299316
Epoch: 24, Steps: 64 | Train Loss: 0.1063229 Vali Loss: 0.2680327 Test Loss: 0.3424052
Validation loss decreased (0.273558 --> 0.268033).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 25 cost time: 0.8049979209899902
Epoch: 25, Steps: 64 | Train Loss: 0.1052610 Vali Loss: 0.2684585 Test Loss: 0.3398594
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 26 cost time: 0.7994654178619385
Epoch: 26, Steps: 64 | Train Loss: 0.1048776 Vali Loss: 0.2690340 Test Loss: 0.3373821
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 27 cost time: 0.7984054088592529
Epoch: 27, Steps: 64 | Train Loss: 0.1038705 Vali Loss: 0.2666029 Test Loss: 0.3370612
Validation loss decreased (0.268033 --> 0.266603).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 28 cost time: 0.7877006530761719
Epoch: 28, Steps: 64 | Train Loss: 0.1037099 Vali Loss: 0.2608739 Test Loss: 0.3319281
Validation loss decreased (0.266603 --> 0.260874).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 29 cost time: 0.7740020751953125
Epoch: 29, Steps: 64 | Train Loss: 0.1037177 Vali Loss: 0.2630690 Test Loss: 0.3321006
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 30 cost time: 0.8066213130950928
Epoch: 30, Steps: 64 | Train Loss: 0.1026404 Vali Loss: 0.2613231 Test Loss: 0.3271999
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 31 cost time: 0.8065133094787598
Epoch: 31, Steps: 64 | Train Loss: 0.1025838 Vali Loss: 0.2569808 Test Loss: 0.3266884
Validation loss decreased (0.260874 --> 0.256981).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 32 cost time: 0.818061113357544
Epoch: 32, Steps: 64 | Train Loss: 0.1022723 Vali Loss: 0.2569925 Test Loss: 0.3234107
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 33 cost time: 0.804999828338623
Epoch: 33, Steps: 64 | Train Loss: 0.1028002 Vali Loss: 0.2583680 Test Loss: 0.3224055
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 34 cost time: 0.8016180992126465
Epoch: 34, Steps: 64 | Train Loss: 0.1013493 Vali Loss: 0.2593291 Test Loss: 0.3238916
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 35 cost time: 0.8009181022644043
Epoch: 35, Steps: 64 | Train Loss: 0.1015508 Vali Loss: 0.2573021 Test Loss: 0.3204772
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 36 cost time: 0.7960402965545654
Epoch: 36, Steps: 64 | Train Loss: 0.1014077 Vali Loss: 0.2574538 Test Loss: 0.3224825
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 37 cost time: 0.7999999523162842
Epoch: 37, Steps: 64 | Train Loss: 0.1017092 Vali Loss: 0.2559451 Test Loss: 0.3221133
Validation loss decreased (0.256981 --> 0.255945).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 38 cost time: 0.8016290664672852
Epoch: 38, Steps: 64 | Train Loss: 0.1007416 Vali Loss: 0.2566247 Test Loss: 0.3215942
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 39 cost time: 0.8073663711547852
Epoch: 39, Steps: 64 | Train Loss: 0.1013284 Vali Loss: 0.2571291 Test Loss: 0.3196321
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 40 cost time: 0.8094098567962646
Epoch: 40, Steps: 64 | Train Loss: 0.1007099 Vali Loss: 0.2565143 Test Loss: 0.3214494
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 41 cost time: 0.8091738224029541
Epoch: 41, Steps: 64 | Train Loss: 0.1009543 Vali Loss: 0.2551115 Test Loss: 0.3191171
Validation loss decreased (0.255945 --> 0.255111).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 42 cost time: 0.80899977684021
Epoch: 42, Steps: 64 | Train Loss: 0.1005092 Vali Loss: 0.2533118 Test Loss: 0.3190349
Validation loss decreased (0.255111 --> 0.253312).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 43 cost time: 0.8103995323181152
Epoch: 43, Steps: 64 | Train Loss: 0.1005968 Vali Loss: 0.2542219 Test Loss: 0.3178107
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 44 cost time: 0.8021247386932373
Epoch: 44, Steps: 64 | Train Loss: 0.1009762 Vali Loss: 0.2552400 Test Loss: 0.3191889
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 45 cost time: 0.8017590045928955
Epoch: 45, Steps: 64 | Train Loss: 0.1007996 Vali Loss: 0.2536830 Test Loss: 0.3179540
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 46 cost time: 0.7986228466033936
Epoch: 46, Steps: 64 | Train Loss: 0.0999094 Vali Loss: 0.2527390 Test Loss: 0.3174659
Validation loss decreased (0.253312 --> 0.252739).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 47 cost time: 0.8026223182678223
Epoch: 47, Steps: 64 | Train Loss: 0.1008453 Vali Loss: 0.2536688 Test Loss: 0.3168879
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 48 cost time: 0.8013436794281006
Epoch: 48, Steps: 64 | Train Loss: 0.0999094 Vali Loss: 0.2520233 Test Loss: 0.3197687
Validation loss decreased (0.252739 --> 0.252023).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 49 cost time: 0.8114185333251953
Epoch: 49, Steps: 64 | Train Loss: 0.0997767 Vali Loss: 0.2528163 Test Loss: 0.3171092
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 50 cost time: 0.8167965412139893
Epoch: 50, Steps: 64 | Train Loss: 0.1004216 Vali Loss: 0.2524154 Test Loss: 0.3184125
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 51 cost time: 0.8256335258483887
Epoch: 51, Steps: 64 | Train Loss: 0.0998495 Vali Loss: 0.2529231 Test Loss: 0.3185282
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 52 cost time: 0.7993419170379639
Epoch: 52, Steps: 64 | Train Loss: 0.1002067 Vali Loss: 0.2534408 Test Loss: 0.3185532
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 53 cost time: 0.7823934555053711
Epoch: 53, Steps: 64 | Train Loss: 0.1002607 Vali Loss: 0.2530261 Test Loss: 0.3155839
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 54 cost time: 0.809821605682373
Epoch: 54, Steps: 64 | Train Loss: 0.1003633 Vali Loss: 0.2552060 Test Loss: 0.3168286
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 55 cost time: 0.8114016056060791
Epoch: 55, Steps: 64 | Train Loss: 0.1004084 Vali Loss: 0.2525535 Test Loss: 0.3153434
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 56 cost time: 0.8003807067871094
Epoch: 56, Steps: 64 | Train Loss: 0.1007119 Vali Loss: 0.2548557 Test Loss: 0.3162187
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 57 cost time: 0.8094320297241211
Epoch: 57, Steps: 64 | Train Loss: 0.1005741 Vali Loss: 0.2519380 Test Loss: 0.3168356
Validation loss decreased (0.252023 --> 0.251938).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 58 cost time: 0.8087456226348877
Epoch: 58, Steps: 64 | Train Loss: 0.1000777 Vali Loss: 0.2496932 Test Loss: 0.3138107
Validation loss decreased (0.251938 --> 0.249693).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 59 cost time: 0.8170006275177002
Epoch: 59, Steps: 64 | Train Loss: 0.1007127 Vali Loss: 0.2520943 Test Loss: 0.3158268
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 60 cost time: 0.8102266788482666
Epoch: 60, Steps: 64 | Train Loss: 0.1001939 Vali Loss: 0.2514604 Test Loss: 0.3162155
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.31381067633628845, mae:0.3846687376499176, rse:0.25710269808769226
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 1 cost time: 2.275385618209839
Epoch: 1, Steps: 64 | Train Loss: 0.8297024 Vali Loss: 2.5482960 Test Loss: 4.4400210
Validation loss decreased (inf --> 2.548296).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 2 cost time: 0.9050393104553223
Epoch: 2, Steps: 64 | Train Loss: 0.5473538 Vali Loss: 0.7979411 Test Loss: 1.1723835
Validation loss decreased (2.548296 --> 0.797941).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 3 cost time: 0.9010672569274902
Epoch: 3, Steps: 64 | Train Loss: 0.1735764 Vali Loss: 0.2983267 Test Loss: 0.2930050
Validation loss decreased (0.797941 --> 0.298327).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 4 cost time: 0.9597630500793457
Epoch: 4, Steps: 64 | Train Loss: 0.1196326 Vali Loss: 0.2707044 Test Loss: 0.2947332
Validation loss decreased (0.298327 --> 0.270704).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 5 cost time: 0.9054577350616455
Epoch: 5, Steps: 64 | Train Loss: 0.1110389 Vali Loss: 0.2591690 Test Loss: 0.2901863
Validation loss decreased (0.270704 --> 0.259169).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 6 cost time: 0.894514799118042
Epoch: 6, Steps: 64 | Train Loss: 0.1066987 Vali Loss: 0.2501241 Test Loss: 0.2858093
Validation loss decreased (0.259169 --> 0.250124).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 7 cost time: 0.9036223888397217
Epoch: 7, Steps: 64 | Train Loss: 0.1040826 Vali Loss: 0.2489768 Test Loss: 0.2847549
Validation loss decreased (0.250124 --> 0.248977).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 8 cost time: 0.8984229564666748
Epoch: 8, Steps: 64 | Train Loss: 0.1010448 Vali Loss: 0.2407895 Test Loss: 0.2864100
Validation loss decreased (0.248977 --> 0.240790).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 9 cost time: 0.899956226348877
Epoch: 9, Steps: 64 | Train Loss: 0.0993448 Vali Loss: 0.2396639 Test Loss: 0.2863292
Validation loss decreased (0.240790 --> 0.239664).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 10 cost time: 0.9034595489501953
Epoch: 10, Steps: 64 | Train Loss: 0.0974813 Vali Loss: 0.2336068 Test Loss: 0.2839570
Validation loss decreased (0.239664 --> 0.233607).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 11 cost time: 0.9048302173614502
Epoch: 11, Steps: 64 | Train Loss: 0.0967081 Vali Loss: 0.2351489 Test Loss: 0.2842178
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 12 cost time: 0.9059998989105225
Epoch: 12, Steps: 64 | Train Loss: 0.0953647 Vali Loss: 0.2335364 Test Loss: 0.2832354
Validation loss decreased (0.233607 --> 0.233536).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 13 cost time: 0.9249999523162842
Epoch: 13, Steps: 64 | Train Loss: 0.0940003 Vali Loss: 0.2311724 Test Loss: 0.2840487
Validation loss decreased (0.233536 --> 0.231172).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 14 cost time: 0.9006161689758301
Epoch: 14, Steps: 64 | Train Loss: 0.0934273 Vali Loss: 0.2299964 Test Loss: 0.2837022
Validation loss decreased (0.231172 --> 0.229996).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 15 cost time: 0.8983564376831055
Epoch: 15, Steps: 64 | Train Loss: 0.0928710 Vali Loss: 0.2302479 Test Loss: 0.2845671
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 16 cost time: 0.9025235176086426
Epoch: 16, Steps: 64 | Train Loss: 0.0920226 Vali Loss: 0.2252737 Test Loss: 0.2834084
Validation loss decreased (0.229996 --> 0.225274).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 17 cost time: 0.9046189785003662
Epoch: 17, Steps: 64 | Train Loss: 0.0922487 Vali Loss: 0.2291912 Test Loss: 0.2846067
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 18 cost time: 0.9047818183898926
Epoch: 18, Steps: 64 | Train Loss: 0.0913840 Vali Loss: 0.2273290 Test Loss: 0.2848704
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 19 cost time: 0.9048097133636475
Epoch: 19, Steps: 64 | Train Loss: 0.0908165 Vali Loss: 0.2253239 Test Loss: 0.2857916
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 20 cost time: 0.9179999828338623
Epoch: 20, Steps: 64 | Train Loss: 0.0902037 Vali Loss: 0.2243818 Test Loss: 0.2849505
Validation loss decreased (0.225274 --> 0.224382).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 21 cost time: 0.9107100963592529
Epoch: 21, Steps: 64 | Train Loss: 0.0894459 Vali Loss: 0.2208710 Test Loss: 0.2856563
Validation loss decreased (0.224382 --> 0.220871).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 22 cost time: 0.9078550338745117
Epoch: 22, Steps: 64 | Train Loss: 0.0898307 Vali Loss: 0.2222907 Test Loss: 0.2862185
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 23 cost time: 0.9013776779174805
Epoch: 23, Steps: 64 | Train Loss: 0.0896042 Vali Loss: 0.2205912 Test Loss: 0.2854182
Validation loss decreased (0.220871 --> 0.220591).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 24 cost time: 0.8984007835388184
Epoch: 24, Steps: 64 | Train Loss: 0.0885728 Vali Loss: 0.2219232 Test Loss: 0.2865073
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 25 cost time: 0.978461742401123
Epoch: 25, Steps: 64 | Train Loss: 0.0893059 Vali Loss: 0.2235820 Test Loss: 0.2864282
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 26 cost time: 0.9287476539611816
Epoch: 26, Steps: 64 | Train Loss: 0.0886284 Vali Loss: 0.2194956 Test Loss: 0.2855423
Validation loss decreased (0.220591 --> 0.219496).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 27 cost time: 0.9016261100769043
Epoch: 27, Steps: 64 | Train Loss: 0.0882253 Vali Loss: 0.2221746 Test Loss: 0.2871896
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 28 cost time: 0.9049999713897705
Epoch: 28, Steps: 64 | Train Loss: 0.0882647 Vali Loss: 0.2181868 Test Loss: 0.2864910
Validation loss decreased (0.219496 --> 0.218187).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 29 cost time: 0.9066088199615479
Epoch: 29, Steps: 64 | Train Loss: 0.0886547 Vali Loss: 0.2205871 Test Loss: 0.2860844
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 30 cost time: 0.9174981117248535
Epoch: 30, Steps: 64 | Train Loss: 0.0878651 Vali Loss: 0.2192603 Test Loss: 0.2875260
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 31 cost time: 0.898369312286377
Epoch: 31, Steps: 64 | Train Loss: 0.0882810 Vali Loss: 0.2196814 Test Loss: 0.2873263
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 32 cost time: 0.8983564376831055
Epoch: 32, Steps: 64 | Train Loss: 0.0879062 Vali Loss: 0.2202469 Test Loss: 0.2866841
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 33 cost time: 0.8978023529052734
Epoch: 33, Steps: 64 | Train Loss: 0.0878995 Vali Loss: 0.2189236 Test Loss: 0.2876096
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 34 cost time: 0.9099996089935303
Epoch: 34, Steps: 64 | Train Loss: 0.0881541 Vali Loss: 0.2214689 Test Loss: 0.2871819
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 35 cost time: 0.8994100093841553
Epoch: 35, Steps: 64 | Train Loss: 0.0874668 Vali Loss: 0.2202311 Test Loss: 0.2874230
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 36 cost time: 0.9066040515899658
Epoch: 36, Steps: 64 | Train Loss: 0.0878936 Vali Loss: 0.2201251 Test Loss: 0.2876983
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 37 cost time: 0.9134795665740967
Epoch: 37, Steps: 64 | Train Loss: 0.0876466 Vali Loss: 0.2177182 Test Loss: 0.2881463
Validation loss decreased (0.218187 --> 0.217718).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 38 cost time: 0.9063403606414795
Epoch: 38, Steps: 64 | Train Loss: 0.0877243 Vali Loss: 0.2193015 Test Loss: 0.2866930
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 39 cost time: 0.9033422470092773
Epoch: 39, Steps: 64 | Train Loss: 0.0870392 Vali Loss: 0.2195346 Test Loss: 0.2871325
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 40 cost time: 0.8984227180480957
Epoch: 40, Steps: 64 | Train Loss: 0.0872920 Vali Loss: 0.2185009 Test Loss: 0.2870696
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 41 cost time: 0.9119999408721924
Epoch: 41, Steps: 64 | Train Loss: 0.0877399 Vali Loss: 0.2168713 Test Loss: 0.2874509
Validation loss decreased (0.217718 --> 0.216871).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 42 cost time: 0.897620677947998
Epoch: 42, Steps: 64 | Train Loss: 0.0875546 Vali Loss: 0.2185334 Test Loss: 0.2872609
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 43 cost time: 0.8986308574676514
Epoch: 43, Steps: 64 | Train Loss: 0.0868060 Vali Loss: 0.2197265 Test Loss: 0.2873528
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 44 cost time: 0.9194202423095703
Epoch: 44, Steps: 64 | Train Loss: 0.0875453 Vali Loss: 0.2164416 Test Loss: 0.2868781
Validation loss decreased (0.216871 --> 0.216442).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 45 cost time: 0.8788888454437256
Epoch: 45, Steps: 64 | Train Loss: 0.0873148 Vali Loss: 0.2189602 Test Loss: 0.2876697
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 46 cost time: 0.9121847152709961
Epoch: 46, Steps: 64 | Train Loss: 0.0875745 Vali Loss: 0.2185486 Test Loss: 0.2878816
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 47 cost time: 0.9069492816925049
Epoch: 47, Steps: 64 | Train Loss: 0.0871542 Vali Loss: 0.2155643 Test Loss: 0.2878584
Validation loss decreased (0.216442 --> 0.215564).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 48 cost time: 0.907322883605957
Epoch: 48, Steps: 64 | Train Loss: 0.0873915 Vali Loss: 0.2188796 Test Loss: 0.2880729
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 49 cost time: 0.9010014533996582
Epoch: 49, Steps: 64 | Train Loss: 0.0871639 Vali Loss: 0.2190867 Test Loss: 0.2876551
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 50 cost time: 0.8956131935119629
Epoch: 50, Steps: 64 | Train Loss: 0.0873461 Vali Loss: 0.2191970 Test Loss: 0.2876741
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 51 cost time: 0.9023406505584717
Epoch: 51, Steps: 64 | Train Loss: 0.0875608 Vali Loss: 0.2207988 Test Loss: 0.2874973
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 52 cost time: 0.8944618701934814
Epoch: 52, Steps: 64 | Train Loss: 0.0871604 Vali Loss: 0.2184607 Test Loss: 0.2878122
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 53 cost time: 0.9094183444976807
Epoch: 53, Steps: 64 | Train Loss: 0.0871266 Vali Loss: 0.2191934 Test Loss: 0.2876773
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 54 cost time: 0.9057791233062744
Epoch: 54, Steps: 64 | Train Loss: 0.0870605 Vali Loss: 0.2207278 Test Loss: 0.2877784
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 55 cost time: 0.9180004596710205
Epoch: 55, Steps: 64 | Train Loss: 0.0871780 Vali Loss: 0.2188335 Test Loss: 0.2879936
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 56 cost time: 0.9086158275604248
Epoch: 56, Steps: 64 | Train Loss: 0.0868218 Vali Loss: 0.2192245 Test Loss: 0.2882284
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 57 cost time: 0.9044244289398193
Epoch: 57, Steps: 64 | Train Loss: 0.0872366 Vali Loss: 0.2188357 Test Loss: 0.2876479
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 58 cost time: 0.9147627353668213
Epoch: 58, Steps: 64 | Train Loss: 0.0866931 Vali Loss: 0.2182362 Test Loss: 0.2874183
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 59 cost time: 0.9003431797027588
Epoch: 59, Steps: 64 | Train Loss: 0.0868274 Vali Loss: 0.2179130 Test Loss: 0.2878172
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 60 cost time: 0.9084432125091553
Epoch: 60, Steps: 64 | Train Loss: 0.0870971 Vali Loss: 0.2176714 Test Loss: 0.2870720
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2878583073616028, mae:0.36080190539360046, rse:0.24624201655387878
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.053173065185546875 GB
Epoch: 1 cost time: 2.2423245906829834
Epoch: 1, Steps: 64 | Train Loss: 0.8206836 Vali Loss: 2.5453858 Test Loss: 4.4642220
Validation loss decreased (inf --> 2.545386).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 2 cost time: 0.8593792915344238
Epoch: 2, Steps: 64 | Train Loss: 0.4379359 Vali Loss: 0.3214508 Test Loss: 0.2912347
Validation loss decreased (2.545386 --> 0.321451).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 3 cost time: 0.8364696502685547
Epoch: 3, Steps: 64 | Train Loss: 0.1289873 Vali Loss: 0.2967964 Test Loss: 0.3265180
Validation loss decreased (0.321451 --> 0.296796).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 4 cost time: 0.8619999885559082
Epoch: 4, Steps: 64 | Train Loss: 0.1116041 Vali Loss: 0.2615016 Test Loss: 0.2848769
Validation loss decreased (0.296796 --> 0.261502).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 5 cost time: 0.8676352500915527
Epoch: 5, Steps: 64 | Train Loss: 0.1055408 Vali Loss: 0.2576615 Test Loss: 0.2879800
Validation loss decreased (0.261502 --> 0.257661).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 6 cost time: 0.8440120220184326
Epoch: 6, Steps: 64 | Train Loss: 0.1012727 Vali Loss: 0.2532977 Test Loss: 0.2844386
Validation loss decreased (0.257661 --> 0.253298).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 7 cost time: 0.8667342662811279
Epoch: 7, Steps: 64 | Train Loss: 0.0995580 Vali Loss: 0.2420366 Test Loss: 0.2869099
Validation loss decreased (0.253298 --> 0.242037).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 8 cost time: 0.862999677658081
Epoch: 8, Steps: 64 | Train Loss: 0.0976940 Vali Loss: 0.2423849 Test Loss: 0.2844919
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 9 cost time: 0.8666133880615234
Epoch: 9, Steps: 64 | Train Loss: 0.0958874 Vali Loss: 0.2419274 Test Loss: 0.2851108
Validation loss decreased (0.242037 --> 0.241927).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 10 cost time: 0.8634111881256104
Epoch: 10, Steps: 64 | Train Loss: 0.0943793 Vali Loss: 0.2366750 Test Loss: 0.2863092
Validation loss decreased (0.241927 --> 0.236675).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 11 cost time: 0.8744626045227051
Epoch: 11, Steps: 64 | Train Loss: 0.0936187 Vali Loss: 0.2351794 Test Loss: 0.2854157
Validation loss decreased (0.236675 --> 0.235179).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 12 cost time: 0.8634207248687744
Epoch: 12, Steps: 64 | Train Loss: 0.0925735 Vali Loss: 0.2349998 Test Loss: 0.2876178
Validation loss decreased (0.235179 --> 0.235000).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 13 cost time: 0.8797273635864258
Epoch: 13, Steps: 64 | Train Loss: 0.0920414 Vali Loss: 0.2311640 Test Loss: 0.2863199
Validation loss decreased (0.235000 --> 0.231164).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 14 cost time: 0.866997241973877
Epoch: 14, Steps: 64 | Train Loss: 0.0907980 Vali Loss: 0.2314281 Test Loss: 0.2868478
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 15 cost time: 0.8659000396728516
Epoch: 15, Steps: 64 | Train Loss: 0.0902005 Vali Loss: 0.2314716 Test Loss: 0.2883721
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 16 cost time: 0.8684160709381104
Epoch: 16, Steps: 64 | Train Loss: 0.0897311 Vali Loss: 0.2297095 Test Loss: 0.2899327
Validation loss decreased (0.231164 --> 0.229710).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 17 cost time: 0.8650007247924805
Epoch: 17, Steps: 64 | Train Loss: 0.0892564 Vali Loss: 0.2229508 Test Loss: 0.2891920
Validation loss decreased (0.229710 --> 0.222951).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 18 cost time: 0.8646175861358643
Epoch: 18, Steps: 64 | Train Loss: 0.0883213 Vali Loss: 0.2251408 Test Loss: 0.2894599
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 19 cost time: 0.8690004348754883
Epoch: 19, Steps: 64 | Train Loss: 0.0879378 Vali Loss: 0.2240468 Test Loss: 0.2903235
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 20 cost time: 0.8813881874084473
Epoch: 20, Steps: 64 | Train Loss: 0.0874504 Vali Loss: 0.2267372 Test Loss: 0.2913880
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 21 cost time: 0.8673744201660156
Epoch: 21, Steps: 64 | Train Loss: 0.0874390 Vali Loss: 0.2256002 Test Loss: 0.2913576
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 22 cost time: 0.8643665313720703
Epoch: 22, Steps: 64 | Train Loss: 0.0869511 Vali Loss: 0.2221645 Test Loss: 0.2910070
Validation loss decreased (0.222951 --> 0.222164).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 23 cost time: 0.8624072074890137
Epoch: 23, Steps: 64 | Train Loss: 0.0872400 Vali Loss: 0.2247924 Test Loss: 0.2914478
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 24 cost time: 0.8627510070800781
Epoch: 24, Steps: 64 | Train Loss: 0.0865550 Vali Loss: 0.2248238 Test Loss: 0.2919718
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 25 cost time: 0.8615319728851318
Epoch: 25, Steps: 64 | Train Loss: 0.0864246 Vali Loss: 0.2233585 Test Loss: 0.2933679
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 26 cost time: 0.8606386184692383
Epoch: 26, Steps: 64 | Train Loss: 0.0864233 Vali Loss: 0.2231582 Test Loss: 0.2923177
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 27 cost time: 0.8683445453643799
Epoch: 27, Steps: 64 | Train Loss: 0.0857399 Vali Loss: 0.2204420 Test Loss: 0.2926118
Validation loss decreased (0.222164 --> 0.220442).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 28 cost time: 0.8663480281829834
Epoch: 28, Steps: 64 | Train Loss: 0.0862512 Vali Loss: 0.2200968 Test Loss: 0.2933497
Validation loss decreased (0.220442 --> 0.220097).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 29 cost time: 0.8653552532196045
Epoch: 29, Steps: 64 | Train Loss: 0.0861460 Vali Loss: 0.2214451 Test Loss: 0.2921982
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 30 cost time: 0.8737587928771973
Epoch: 30, Steps: 64 | Train Loss: 0.0855247 Vali Loss: 0.2241136 Test Loss: 0.2936333
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 31 cost time: 0.8462255001068115
Epoch: 31, Steps: 64 | Train Loss: 0.0856650 Vali Loss: 0.2230386 Test Loss: 0.2918229
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 32 cost time: 0.8626341819763184
Epoch: 32, Steps: 64 | Train Loss: 0.0856197 Vali Loss: 0.2215944 Test Loss: 0.2932019
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 33 cost time: 0.8645141124725342
Epoch: 33, Steps: 64 | Train Loss: 0.0854776 Vali Loss: 0.2216871 Test Loss: 0.2932827
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 34 cost time: 0.857367992401123
Epoch: 34, Steps: 64 | Train Loss: 0.0849350 Vali Loss: 0.2229787 Test Loss: 0.2936252
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 35 cost time: 0.8647642135620117
Epoch: 35, Steps: 64 | Train Loss: 0.0857290 Vali Loss: 0.2222818 Test Loss: 0.2932971
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 36 cost time: 0.866999626159668
Epoch: 36, Steps: 64 | Train Loss: 0.0850011 Vali Loss: 0.2196098 Test Loss: 0.2936661
Validation loss decreased (0.220097 --> 0.219610).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 37 cost time: 0.867999792098999
Epoch: 37, Steps: 64 | Train Loss: 0.0848026 Vali Loss: 0.2196607 Test Loss: 0.2935842
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 38 cost time: 0.8792197704315186
Epoch: 38, Steps: 64 | Train Loss: 0.0846536 Vali Loss: 0.2201433 Test Loss: 0.2937163
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 39 cost time: 0.8703460693359375
Epoch: 39, Steps: 64 | Train Loss: 0.0851881 Vali Loss: 0.2218468 Test Loss: 0.2937687
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 40 cost time: 0.8693952560424805
Epoch: 40, Steps: 64 | Train Loss: 0.0849895 Vali Loss: 0.2210849 Test Loss: 0.2940719
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 41 cost time: 0.8697519302368164
Epoch: 41, Steps: 64 | Train Loss: 0.0850279 Vali Loss: 0.2199215 Test Loss: 0.2949449
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 42 cost time: 0.8749997615814209
Epoch: 42, Steps: 64 | Train Loss: 0.0850355 Vali Loss: 0.2206671 Test Loss: 0.2936784
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 43 cost time: 0.8592398166656494
Epoch: 43, Steps: 64 | Train Loss: 0.0845940 Vali Loss: 0.2188644 Test Loss: 0.2936949
Validation loss decreased (0.219610 --> 0.218864).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 44 cost time: 0.8622932434082031
Epoch: 44, Steps: 64 | Train Loss: 0.0847007 Vali Loss: 0.2201707 Test Loss: 0.2937396
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 45 cost time: 0.8763656616210938
Epoch: 45, Steps: 64 | Train Loss: 0.0843652 Vali Loss: 0.2178423 Test Loss: 0.2943217
Validation loss decreased (0.218864 --> 0.217842).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 46 cost time: 0.8713619709014893
Epoch: 46, Steps: 64 | Train Loss: 0.0843906 Vali Loss: 0.2158234 Test Loss: 0.2952681
Validation loss decreased (0.217842 --> 0.215823).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 47 cost time: 0.8717825412750244
Epoch: 47, Steps: 64 | Train Loss: 0.0848294 Vali Loss: 0.2217631 Test Loss: 0.2948506
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 48 cost time: 0.8699994087219238
Epoch: 48, Steps: 64 | Train Loss: 0.0840366 Vali Loss: 0.2207686 Test Loss: 0.2947499
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 49 cost time: 0.8566064834594727
Epoch: 49, Steps: 64 | Train Loss: 0.0844585 Vali Loss: 0.2208931 Test Loss: 0.2942469
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 50 cost time: 0.8644249439239502
Epoch: 50, Steps: 64 | Train Loss: 0.0845216 Vali Loss: 0.2210905 Test Loss: 0.2956130
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 51 cost time: 0.864377498626709
Epoch: 51, Steps: 64 | Train Loss: 0.0851587 Vali Loss: 0.2174352 Test Loss: 0.2949211
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 52 cost time: 0.861778974533081
Epoch: 52, Steps: 64 | Train Loss: 0.0845623 Vali Loss: 0.2178968 Test Loss: 0.2949097
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 53 cost time: 0.8577425479888916
Epoch: 53, Steps: 64 | Train Loss: 0.0845325 Vali Loss: 0.2225209 Test Loss: 0.2951044
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 54 cost time: 0.8685564994812012
Epoch: 54, Steps: 64 | Train Loss: 0.0848619 Vali Loss: 0.2194986 Test Loss: 0.2950578
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 55 cost time: 0.8656198978424072
Epoch: 55, Steps: 64 | Train Loss: 0.0847943 Vali Loss: 0.2222865 Test Loss: 0.2937827
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 56 cost time: 0.8718810081481934
Epoch: 56, Steps: 64 | Train Loss: 0.0844260 Vali Loss: 0.2183893 Test Loss: 0.2946292
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 57 cost time: 0.8653388023376465
Epoch: 57, Steps: 64 | Train Loss: 0.0848127 Vali Loss: 0.2205219 Test Loss: 0.2946299
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 58 cost time: 0.8637385368347168
Epoch: 58, Steps: 64 | Train Loss: 0.0849626 Vali Loss: 0.2198448 Test Loss: 0.2943391
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 59 cost time: 0.8639998435974121
Epoch: 59, Steps: 64 | Train Loss: 0.0846793 Vali Loss: 0.2201487 Test Loss: 0.2947313
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 60 cost time: 0.8586432933807373
Epoch: 60, Steps: 64 | Train Loss: 0.0840888 Vali Loss: 0.2214695 Test Loss: 0.2955900
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.29526811838150024, mae:0.37267372012138367, rse:0.24939118325710297
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04604673385620117 GB
Epoch: 1 cost time: 2.255685806274414
Epoch: 1, Steps: 64 | Train Loss: 0.9910807 Vali Loss: 2.9585731 Test Loss: 5.3124919
Validation loss decreased (inf --> 2.958573).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 2 cost time: 0.8780393600463867
Epoch: 2, Steps: 64 | Train Loss: 0.8240862 Vali Loss: 2.0628061 Test Loss: 3.6215520
Validation loss decreased (2.958573 --> 2.062806).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 3 cost time: 0.8824141025543213
Epoch: 3, Steps: 64 | Train Loss: 0.6072351 Vali Loss: 1.5301826 Test Loss: 2.5952282
Validation loss decreased (2.062806 --> 1.530183).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 4 cost time: 0.8709394931793213
Epoch: 4, Steps: 64 | Train Loss: 0.4492383 Vali Loss: 1.1497928 Test Loss: 1.8848841
Validation loss decreased (1.530183 --> 1.149793).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 5 cost time: 0.872999906539917
Epoch: 5, Steps: 64 | Train Loss: 0.3479602 Vali Loss: 0.9287066 Test Loss: 1.4816785
Validation loss decreased (1.149793 --> 0.928707).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 6 cost time: 0.8680858612060547
Epoch: 6, Steps: 64 | Train Loss: 0.2803262 Vali Loss: 0.7756720 Test Loss: 1.2050813
Validation loss decreased (0.928707 --> 0.775672).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 7 cost time: 0.8723814487457275
Epoch: 7, Steps: 64 | Train Loss: 0.2339785 Vali Loss: 0.6572456 Test Loss: 1.0029931
Validation loss decreased (0.775672 --> 0.657246).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 8 cost time: 0.8729836940765381
Epoch: 8, Steps: 64 | Train Loss: 0.2019288 Vali Loss: 0.5650609 Test Loss: 0.8515972
Validation loss decreased (0.657246 --> 0.565061).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 9 cost time: 0.8686017990112305
Epoch: 9, Steps: 64 | Train Loss: 0.1781882 Vali Loss: 0.5049767 Test Loss: 0.7430713
Validation loss decreased (0.565061 --> 0.504977).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 10 cost time: 0.8727350234985352
Epoch: 10, Steps: 64 | Train Loss: 0.1617427 Vali Loss: 0.4509102 Test Loss: 0.6602454
Validation loss decreased (0.504977 --> 0.450910).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 11 cost time: 0.8752329349517822
Epoch: 11, Steps: 64 | Train Loss: 0.1497521 Vali Loss: 0.4140024 Test Loss: 0.5859115
Validation loss decreased (0.450910 --> 0.414002).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 12 cost time: 0.9476125240325928
Epoch: 12, Steps: 64 | Train Loss: 0.1393187 Vali Loss: 0.3898603 Test Loss: 0.5473759
Validation loss decreased (0.414002 --> 0.389860).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 13 cost time: 0.9526112079620361
Epoch: 13, Steps: 64 | Train Loss: 0.1321209 Vali Loss: 0.3661132 Test Loss: 0.5049842
Validation loss decreased (0.389860 --> 0.366113).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 14 cost time: 0.9308726787567139
Epoch: 14, Steps: 64 | Train Loss: 0.1270024 Vali Loss: 0.3495027 Test Loss: 0.4796769
Validation loss decreased (0.366113 --> 0.349503).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 15 cost time: 0.8706295490264893
Epoch: 15, Steps: 64 | Train Loss: 0.1220515 Vali Loss: 0.3346549 Test Loss: 0.4493403
Validation loss decreased (0.349503 --> 0.334655).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 16 cost time: 0.8733866214752197
Epoch: 16, Steps: 64 | Train Loss: 0.1189642 Vali Loss: 0.3175125 Test Loss: 0.4310781
Validation loss decreased (0.334655 --> 0.317512).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 17 cost time: 0.8691284656524658
Epoch: 17, Steps: 64 | Train Loss: 0.1158375 Vali Loss: 0.3156575 Test Loss: 0.4179395
Validation loss decreased (0.317512 --> 0.315657).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 18 cost time: 0.8759963512420654
Epoch: 18, Steps: 64 | Train Loss: 0.1133779 Vali Loss: 0.3052830 Test Loss: 0.4039342
Validation loss decreased (0.315657 --> 0.305283).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 19 cost time: 0.8806259632110596
Epoch: 19, Steps: 64 | Train Loss: 0.1120962 Vali Loss: 0.2938116 Test Loss: 0.3917186
Validation loss decreased (0.305283 --> 0.293812).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 20 cost time: 0.8746421337127686
Epoch: 20, Steps: 64 | Train Loss: 0.1100319 Vali Loss: 0.2941113 Test Loss: 0.3808628
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 21 cost time: 0.8884267807006836
Epoch: 21, Steps: 64 | Train Loss: 0.1091090 Vali Loss: 0.2917225 Test Loss: 0.3785443
Validation loss decreased (0.293812 --> 0.291723).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 22 cost time: 0.885509729385376
Epoch: 22, Steps: 64 | Train Loss: 0.1078478 Vali Loss: 0.2881589 Test Loss: 0.3705744
Validation loss decreased (0.291723 --> 0.288159).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 23 cost time: 0.8707962036132812
Epoch: 23, Steps: 64 | Train Loss: 0.1070328 Vali Loss: 0.2823331 Test Loss: 0.3633527
Validation loss decreased (0.288159 --> 0.282333).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 24 cost time: 0.8714518547058105
Epoch: 24, Steps: 64 | Train Loss: 0.1058244 Vali Loss: 0.2817910 Test Loss: 0.3610217
Validation loss decreased (0.282333 --> 0.281791).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 25 cost time: 0.8756134510040283
Epoch: 25, Steps: 64 | Train Loss: 0.1054081 Vali Loss: 0.2777342 Test Loss: 0.3574335
Validation loss decreased (0.281791 --> 0.277734).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 26 cost time: 0.8693227767944336
Epoch: 26, Steps: 64 | Train Loss: 0.1046378 Vali Loss: 0.2768482 Test Loss: 0.3557908
Validation loss decreased (0.277734 --> 0.276848).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 27 cost time: 0.8693556785583496
Epoch: 27, Steps: 64 | Train Loss: 0.1044076 Vali Loss: 0.2740983 Test Loss: 0.3506269
Validation loss decreased (0.276848 --> 0.274098).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 28 cost time: 0.8873708248138428
Epoch: 28, Steps: 64 | Train Loss: 0.1035117 Vali Loss: 0.2749762 Test Loss: 0.3476570
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 29 cost time: 0.8748364448547363
Epoch: 29, Steps: 64 | Train Loss: 0.1035643 Vali Loss: 0.2741089 Test Loss: 0.3458135
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 30 cost time: 0.8749980926513672
Epoch: 30, Steps: 64 | Train Loss: 0.1028409 Vali Loss: 0.2685069 Test Loss: 0.3409387
Validation loss decreased (0.274098 --> 0.268507).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 31 cost time: 0.8816287517547607
Epoch: 31, Steps: 64 | Train Loss: 0.1027196 Vali Loss: 0.2696197 Test Loss: 0.3439786
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 32 cost time: 0.8743541240692139
Epoch: 32, Steps: 64 | Train Loss: 0.1021917 Vali Loss: 0.2677357 Test Loss: 0.3392874
Validation loss decreased (0.268507 --> 0.267736).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 33 cost time: 0.8698828220367432
Epoch: 33, Steps: 64 | Train Loss: 0.1017741 Vali Loss: 0.2685593 Test Loss: 0.3387286
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 34 cost time: 0.8733160495758057
Epoch: 34, Steps: 64 | Train Loss: 0.1022863 Vali Loss: 0.2660329 Test Loss: 0.3363303
Validation loss decreased (0.267736 --> 0.266033).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 35 cost time: 0.8717334270477295
Epoch: 35, Steps: 64 | Train Loss: 0.1020070 Vali Loss: 0.2658489 Test Loss: 0.3363967
Validation loss decreased (0.266033 --> 0.265849).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 36 cost time: 0.8667843341827393
Epoch: 36, Steps: 64 | Train Loss: 0.1021063 Vali Loss: 0.2653711 Test Loss: 0.3354129
Validation loss decreased (0.265849 --> 0.265371).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 37 cost time: 0.8786373138427734
Epoch: 37, Steps: 64 | Train Loss: 0.1012664 Vali Loss: 0.2658643 Test Loss: 0.3346823
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 38 cost time: 0.8776187896728516
Epoch: 38, Steps: 64 | Train Loss: 0.1014243 Vali Loss: 0.2643703 Test Loss: 0.3334272
Validation loss decreased (0.265371 --> 0.264370).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 39 cost time: 0.8934683799743652
Epoch: 39, Steps: 64 | Train Loss: 0.1007115 Vali Loss: 0.2610883 Test Loss: 0.3313046
Validation loss decreased (0.264370 --> 0.261088).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 40 cost time: 0.8863842487335205
Epoch: 40, Steps: 64 | Train Loss: 0.1007437 Vali Loss: 0.2630244 Test Loss: 0.3312081
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 41 cost time: 0.8687577247619629
Epoch: 41, Steps: 64 | Train Loss: 0.1007043 Vali Loss: 0.2605532 Test Loss: 0.3297580
Validation loss decreased (0.261088 --> 0.260553).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 42 cost time: 0.8653881549835205
Epoch: 42, Steps: 64 | Train Loss: 0.1006106 Vali Loss: 0.2623674 Test Loss: 0.3306792
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 43 cost time: 0.8826119899749756
Epoch: 43, Steps: 64 | Train Loss: 0.1004490 Vali Loss: 0.2612914 Test Loss: 0.3306472
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 44 cost time: 0.8623654842376709
Epoch: 44, Steps: 64 | Train Loss: 0.1005577 Vali Loss: 0.2609114 Test Loss: 0.3294922
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 45 cost time: 0.8624320030212402
Epoch: 45, Steps: 64 | Train Loss: 0.1000960 Vali Loss: 0.2615733 Test Loss: 0.3301308
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 46 cost time: 0.8783419132232666
Epoch: 46, Steps: 64 | Train Loss: 0.1001788 Vali Loss: 0.2606116 Test Loss: 0.3286634
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 47 cost time: 0.8651809692382812
Epoch: 47, Steps: 64 | Train Loss: 0.1004706 Vali Loss: 0.2594956 Test Loss: 0.3286847
Validation loss decreased (0.260553 --> 0.259496).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 48 cost time: 0.8790004253387451
Epoch: 48, Steps: 64 | Train Loss: 0.1005854 Vali Loss: 0.2591514 Test Loss: 0.3293575
Validation loss decreased (0.259496 --> 0.259151).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 49 cost time: 0.879624605178833
Epoch: 49, Steps: 64 | Train Loss: 0.1000162 Vali Loss: 0.2609222 Test Loss: 0.3280984
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 50 cost time: 0.8624053001403809
Epoch: 50, Steps: 64 | Train Loss: 0.0997276 Vali Loss: 0.2584627 Test Loss: 0.3299445
Validation loss decreased (0.259151 --> 0.258463).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 51 cost time: 0.8634903430938721
Epoch: 51, Steps: 64 | Train Loss: 0.1003506 Vali Loss: 0.2609893 Test Loss: 0.3271723
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 52 cost time: 0.8593728542327881
Epoch: 52, Steps: 64 | Train Loss: 0.0996921 Vali Loss: 0.2632292 Test Loss: 0.3262011
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 53 cost time: 0.86199951171875
Epoch: 53, Steps: 64 | Train Loss: 0.1001056 Vali Loss: 0.2591853 Test Loss: 0.3273382
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 54 cost time: 0.871300458908081
Epoch: 54, Steps: 64 | Train Loss: 0.0999950 Vali Loss: 0.2611944 Test Loss: 0.3278285
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 55 cost time: 0.8763473033905029
Epoch: 55, Steps: 64 | Train Loss: 0.0995779 Vali Loss: 0.2574061 Test Loss: 0.3285711
Validation loss decreased (0.258463 --> 0.257406).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 56 cost time: 0.8683781623840332
Epoch: 56, Steps: 64 | Train Loss: 0.0995382 Vali Loss: 0.2608820 Test Loss: 0.3286296
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 57 cost time: 0.896416187286377
Epoch: 57, Steps: 64 | Train Loss: 0.1001101 Vali Loss: 0.2611672 Test Loss: 0.3277599
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 58 cost time: 0.877781867980957
Epoch: 58, Steps: 64 | Train Loss: 0.1003208 Vali Loss: 0.2601030 Test Loss: 0.3269871
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 59 cost time: 0.8749997615814209
Epoch: 59, Steps: 64 | Train Loss: 0.1001853 Vali Loss: 0.2597357 Test Loss: 0.3262601
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 60 cost time: 0.8711426258087158
Epoch: 60, Steps: 64 | Train Loss: 0.0999237 Vali Loss: 0.2610502 Test Loss: 0.3244790
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.32857102155685425, mae:0.394548237323761, rse:0.2630797326564789
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 1 cost time: 2.2817184925079346
Epoch: 1, Steps: 64 | Train Loss: 0.8069826 Vali Loss: 2.4987833 Test Loss: 4.3448253
Validation loss decreased (inf --> 2.498783).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 2 cost time: 0.9123620986938477
Epoch: 2, Steps: 64 | Train Loss: 0.5316436 Vali Loss: 0.7607431 Test Loss: 1.1427039
Validation loss decreased (2.498783 --> 0.760743).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 3 cost time: 0.9089000225067139
Epoch: 3, Steps: 64 | Train Loss: 0.1723991 Vali Loss: 0.2960449 Test Loss: 0.2923364
Validation loss decreased (0.760743 --> 0.296045).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 4 cost time: 0.922417163848877
Epoch: 4, Steps: 64 | Train Loss: 0.1196160 Vali Loss: 0.2616139 Test Loss: 0.2819065
Validation loss decreased (0.296045 --> 0.261614).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 5 cost time: 0.9101138114929199
Epoch: 5, Steps: 64 | Train Loss: 0.1108450 Vali Loss: 0.2535911 Test Loss: 0.2803541
Validation loss decreased (0.261614 --> 0.253591).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 6 cost time: 0.9020001888275146
Epoch: 6, Steps: 64 | Train Loss: 0.1060434 Vali Loss: 0.2444107 Test Loss: 0.2810231
Validation loss decreased (0.253591 --> 0.244411).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 7 cost time: 0.9066109657287598
Epoch: 7, Steps: 64 | Train Loss: 0.1033665 Vali Loss: 0.2408608 Test Loss: 0.2758576
Validation loss decreased (0.244411 --> 0.240861).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 8 cost time: 0.9157426357269287
Epoch: 8, Steps: 64 | Train Loss: 0.1009198 Vali Loss: 0.2345118 Test Loss: 0.2762837
Validation loss decreased (0.240861 --> 0.234512).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 9 cost time: 0.9030880928039551
Epoch: 9, Steps: 64 | Train Loss: 0.0993031 Vali Loss: 0.2290826 Test Loss: 0.2769619
Validation loss decreased (0.234512 --> 0.229083).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 10 cost time: 0.9129996299743652
Epoch: 10, Steps: 64 | Train Loss: 0.0975604 Vali Loss: 0.2324068 Test Loss: 0.2798588
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 11 cost time: 0.9152448177337646
Epoch: 11, Steps: 64 | Train Loss: 0.0954849 Vali Loss: 0.2279390 Test Loss: 0.2775119
Validation loss decreased (0.229083 --> 0.227939).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 12 cost time: 0.9095041751861572
Epoch: 12, Steps: 64 | Train Loss: 0.0946395 Vali Loss: 0.2282051 Test Loss: 0.2785766
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 13 cost time: 0.9098880290985107
Epoch: 13, Steps: 64 | Train Loss: 0.0934094 Vali Loss: 0.2270240 Test Loss: 0.2773741
Validation loss decreased (0.227939 --> 0.227024).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 14 cost time: 0.9049999713897705
Epoch: 14, Steps: 64 | Train Loss: 0.0927978 Vali Loss: 0.2250747 Test Loss: 0.2779409
Validation loss decreased (0.227024 --> 0.225075).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 15 cost time: 0.9090640544891357
Epoch: 15, Steps: 64 | Train Loss: 0.0922762 Vali Loss: 0.2239446 Test Loss: 0.2791111
Validation loss decreased (0.225075 --> 0.223945).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 16 cost time: 0.9036369323730469
Epoch: 16, Steps: 64 | Train Loss: 0.0916016 Vali Loss: 0.2230187 Test Loss: 0.2791231
Validation loss decreased (0.223945 --> 0.223019).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 17 cost time: 0.906419038772583
Epoch: 17, Steps: 64 | Train Loss: 0.0909049 Vali Loss: 0.2204384 Test Loss: 0.2797716
Validation loss decreased (0.223019 --> 0.220438).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 18 cost time: 0.9229614734649658
Epoch: 18, Steps: 64 | Train Loss: 0.0904663 Vali Loss: 0.2230895 Test Loss: 0.2789235
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 19 cost time: 0.9163508415222168
Epoch: 19, Steps: 64 | Train Loss: 0.0899194 Vali Loss: 0.2218218 Test Loss: 0.2786365
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 20 cost time: 0.9117782115936279
Epoch: 20, Steps: 64 | Train Loss: 0.0892162 Vali Loss: 0.2194662 Test Loss: 0.2790575
Validation loss decreased (0.220438 --> 0.219466).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 21 cost time: 0.9147553443908691
Epoch: 21, Steps: 64 | Train Loss: 0.0894363 Vali Loss: 0.2223222 Test Loss: 0.2821554
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 22 cost time: 0.9124047756195068
Epoch: 22, Steps: 64 | Train Loss: 0.0889046 Vali Loss: 0.2167903 Test Loss: 0.2797119
Validation loss decreased (0.219466 --> 0.216790).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 23 cost time: 0.9006085395812988
Epoch: 23, Steps: 64 | Train Loss: 0.0886745 Vali Loss: 0.2182278 Test Loss: 0.2802373
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 24 cost time: 0.9063613414764404
Epoch: 24, Steps: 64 | Train Loss: 0.0887134 Vali Loss: 0.2168389 Test Loss: 0.2803911
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 25 cost time: 0.9015488624572754
Epoch: 25, Steps: 64 | Train Loss: 0.0874487 Vali Loss: 0.2181191 Test Loss: 0.2817070
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 26 cost time: 0.897423267364502
Epoch: 26, Steps: 64 | Train Loss: 0.0880099 Vali Loss: 0.2174404 Test Loss: 0.2814252
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 27 cost time: 0.9055025577545166
Epoch: 27, Steps: 64 | Train Loss: 0.0877331 Vali Loss: 0.2177874 Test Loss: 0.2810648
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 28 cost time: 0.909736156463623
Epoch: 28, Steps: 64 | Train Loss: 0.0864472 Vali Loss: 0.2163476 Test Loss: 0.2819756
Validation loss decreased (0.216790 --> 0.216348).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 29 cost time: 0.9070003032684326
Epoch: 29, Steps: 64 | Train Loss: 0.0877824 Vali Loss: 0.2182468 Test Loss: 0.2813155
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 30 cost time: 0.9114933013916016
Epoch: 30, Steps: 64 | Train Loss: 0.0871567 Vali Loss: 0.2164084 Test Loss: 0.2815710
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 31 cost time: 0.8997271060943604
Epoch: 31, Steps: 64 | Train Loss: 0.0871795 Vali Loss: 0.2136933 Test Loss: 0.2815129
Validation loss decreased (0.216348 --> 0.213693).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 32 cost time: 0.9083986282348633
Epoch: 32, Steps: 64 | Train Loss: 0.0871899 Vali Loss: 0.2161874 Test Loss: 0.2809017
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 33 cost time: 0.907395601272583
Epoch: 33, Steps: 64 | Train Loss: 0.0865105 Vali Loss: 0.2158664 Test Loss: 0.2802665
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 34 cost time: 0.9064443111419678
Epoch: 34, Steps: 64 | Train Loss: 0.0869792 Vali Loss: 0.2159391 Test Loss: 0.2812953
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 35 cost time: 0.9091973304748535
Epoch: 35, Steps: 64 | Train Loss: 0.0867460 Vali Loss: 0.2145981 Test Loss: 0.2818625
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 36 cost time: 0.9140005111694336
Epoch: 36, Steps: 64 | Train Loss: 0.0866796 Vali Loss: 0.2160847 Test Loss: 0.2814634
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 37 cost time: 0.9130980968475342
Epoch: 37, Steps: 64 | Train Loss: 0.0864892 Vali Loss: 0.2145361 Test Loss: 0.2820955
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 38 cost time: 0.9154312610626221
Epoch: 38, Steps: 64 | Train Loss: 0.0869559 Vali Loss: 0.2153734 Test Loss: 0.2821409
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 39 cost time: 0.9234230518341064
Epoch: 39, Steps: 64 | Train Loss: 0.0864783 Vali Loss: 0.2146297 Test Loss: 0.2820318
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 40 cost time: 0.9023556709289551
Epoch: 40, Steps: 64 | Train Loss: 0.0864253 Vali Loss: 0.2161794 Test Loss: 0.2823547
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 41 cost time: 0.9053990840911865
Epoch: 41, Steps: 64 | Train Loss: 0.0857888 Vali Loss: 0.2115180 Test Loss: 0.2808682
Validation loss decreased (0.213693 --> 0.211518).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 42 cost time: 0.908764123916626
Epoch: 42, Steps: 64 | Train Loss: 0.0866436 Vali Loss: 0.2125417 Test Loss: 0.2815852
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 43 cost time: 0.9044647216796875
Epoch: 43, Steps: 64 | Train Loss: 0.0862036 Vali Loss: 0.2177380 Test Loss: 0.2820342
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 44 cost time: 0.9110000133514404
Epoch: 44, Steps: 64 | Train Loss: 0.0867629 Vali Loss: 0.2114401 Test Loss: 0.2818527
Validation loss decreased (0.211518 --> 0.211440).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 45 cost time: 0.9108781814575195
Epoch: 45, Steps: 64 | Train Loss: 0.0864476 Vali Loss: 0.2138827 Test Loss: 0.2817371
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 46 cost time: 0.9054286479949951
Epoch: 46, Steps: 64 | Train Loss: 0.0866806 Vali Loss: 0.2151782 Test Loss: 0.2827856
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 47 cost time: 0.9070541858673096
Epoch: 47, Steps: 64 | Train Loss: 0.0857402 Vali Loss: 0.2137792 Test Loss: 0.2823068
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 48 cost time: 0.9024076461791992
Epoch: 48, Steps: 64 | Train Loss: 0.0862045 Vali Loss: 0.2155954 Test Loss: 0.2826161
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 49 cost time: 0.9047760963439941
Epoch: 49, Steps: 64 | Train Loss: 0.0860418 Vali Loss: 0.2136918 Test Loss: 0.2823399
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 50 cost time: 0.8958296775817871
Epoch: 50, Steps: 64 | Train Loss: 0.0860914 Vali Loss: 0.2141067 Test Loss: 0.2824897
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 51 cost time: 0.9040002822875977
Epoch: 51, Steps: 64 | Train Loss: 0.0861536 Vali Loss: 0.2148164 Test Loss: 0.2827726
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 52 cost time: 0.9036333560943604
Epoch: 52, Steps: 64 | Train Loss: 0.0866080 Vali Loss: 0.2144305 Test Loss: 0.2813771
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 53 cost time: 0.9009661674499512
Epoch: 53, Steps: 64 | Train Loss: 0.0860111 Vali Loss: 0.2146228 Test Loss: 0.2808152
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 54 cost time: 0.9144043922424316
Epoch: 54, Steps: 64 | Train Loss: 0.0857876 Vali Loss: 0.2143440 Test Loss: 0.2817174
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 55 cost time: 0.9133579730987549
Epoch: 55, Steps: 64 | Train Loss: 0.0862937 Vali Loss: 0.2130075 Test Loss: 0.2820982
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 56 cost time: 0.9231030941009521
Epoch: 56, Steps: 64 | Train Loss: 0.0855082 Vali Loss: 0.2130248 Test Loss: 0.2815100
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 57 cost time: 0.8998816013336182
Epoch: 57, Steps: 64 | Train Loss: 0.0855809 Vali Loss: 0.2137019 Test Loss: 0.2824700
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 58 cost time: 0.9010002613067627
Epoch: 58, Steps: 64 | Train Loss: 0.0856732 Vali Loss: 0.2172737 Test Loss: 0.2810041
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 59 cost time: 0.9016966819763184
Epoch: 59, Steps: 64 | Train Loss: 0.0860779 Vali Loss: 0.2109355 Test Loss: 0.2824105
Validation loss decreased (0.211440 --> 0.210935).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 60 cost time: 0.9182181358337402
Epoch: 60, Steps: 64 | Train Loss: 0.0856346 Vali Loss: 0.2138192 Test Loss: 0.2815425
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.28241047263145447, mae:0.3524596691131592, rse:0.24390079081058502
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05333375930786133 GB
Epoch: 1 cost time: 2.2971303462982178
Epoch: 1, Steps: 64 | Train Loss: 0.8476216 Vali Loss: 2.6233740 Test Loss: 4.6559782
Validation loss decreased (inf --> 2.623374).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 2 cost time: 0.9553282260894775
Epoch: 2, Steps: 64 | Train Loss: 0.4579207 Vali Loss: 0.3724607 Test Loss: 0.3582245
Validation loss decreased (2.623374 --> 0.372461).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 3 cost time: 0.9393672943115234
Epoch: 3, Steps: 64 | Train Loss: 0.1338299 Vali Loss: 0.3022582 Test Loss: 0.3328312
Validation loss decreased (0.372461 --> 0.302258).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 4 cost time: 0.9322435855865479
Epoch: 4, Steps: 64 | Train Loss: 0.1140323 Vali Loss: 0.2615499 Test Loss: 0.2877508
Validation loss decreased (0.302258 --> 0.261550).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 5 cost time: 0.934441089630127
Epoch: 5, Steps: 64 | Train Loss: 0.1068981 Vali Loss: 0.2566957 Test Loss: 0.2881751
Validation loss decreased (0.261550 --> 0.256696).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 6 cost time: 0.92799973487854
Epoch: 6, Steps: 64 | Train Loss: 0.1026057 Vali Loss: 0.2520782 Test Loss: 0.2883129
Validation loss decreased (0.256696 --> 0.252078).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 7 cost time: 0.9310562610626221
Epoch: 7, Steps: 64 | Train Loss: 0.1002139 Vali Loss: 0.2479650 Test Loss: 0.2843241
Validation loss decreased (0.252078 --> 0.247965).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 8 cost time: 0.9495975971221924
Epoch: 8, Steps: 64 | Train Loss: 0.0983896 Vali Loss: 0.2432519 Test Loss: 0.2868637
Validation loss decreased (0.247965 --> 0.243252).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 9 cost time: 0.9518086910247803
Epoch: 9, Steps: 64 | Train Loss: 0.0966809 Vali Loss: 0.2398857 Test Loss: 0.2886062
Validation loss decreased (0.243252 --> 0.239886).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 10 cost time: 0.9534258842468262
Epoch: 10, Steps: 64 | Train Loss: 0.0952912 Vali Loss: 0.2432576 Test Loss: 0.2841570
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 11 cost time: 1.0193803310394287
Epoch: 11, Steps: 64 | Train Loss: 0.0944968 Vali Loss: 0.2374258 Test Loss: 0.2801960
Validation loss decreased (0.239886 --> 0.237426).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 12 cost time: 1.0024795532226562
Epoch: 12, Steps: 64 | Train Loss: 0.0928418 Vali Loss: 0.2369428 Test Loss: 0.2832686
Validation loss decreased (0.237426 --> 0.236943).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 13 cost time: 0.961066722869873
Epoch: 13, Steps: 64 | Train Loss: 0.0919327 Vali Loss: 0.2337123 Test Loss: 0.2839890
Validation loss decreased (0.236943 --> 0.233712).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 14 cost time: 0.9533171653747559
Epoch: 14, Steps: 64 | Train Loss: 0.0915609 Vali Loss: 0.2334580 Test Loss: 0.2835888
Validation loss decreased (0.233712 --> 0.233458).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 15 cost time: 0.953413724899292
Epoch: 15, Steps: 64 | Train Loss: 0.0905019 Vali Loss: 0.2308774 Test Loss: 0.2821801
Validation loss decreased (0.233458 --> 0.230877).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 16 cost time: 0.9618768692016602
Epoch: 16, Steps: 64 | Train Loss: 0.0895907 Vali Loss: 0.2292942 Test Loss: 0.2858836
Validation loss decreased (0.230877 --> 0.229294).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 17 cost time: 0.987544059753418
Epoch: 17, Steps: 64 | Train Loss: 0.0897285 Vali Loss: 0.2305604 Test Loss: 0.2841127
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 18 cost time: 0.9379997253417969
Epoch: 18, Steps: 64 | Train Loss: 0.0893942 Vali Loss: 0.2292644 Test Loss: 0.2857297
Validation loss decreased (0.229294 --> 0.229264).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 19 cost time: 0.934999942779541
Epoch: 19, Steps: 64 | Train Loss: 0.0890188 Vali Loss: 0.2259288 Test Loss: 0.2833849
Validation loss decreased (0.229264 --> 0.225929).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 20 cost time: 0.9436099529266357
Epoch: 20, Steps: 64 | Train Loss: 0.0885334 Vali Loss: 0.2297376 Test Loss: 0.2848296
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 21 cost time: 0.9382185935974121
Epoch: 21, Steps: 64 | Train Loss: 0.0885127 Vali Loss: 0.2269189 Test Loss: 0.2852657
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 22 cost time: 0.9323794841766357
Epoch: 22, Steps: 64 | Train Loss: 0.0879820 Vali Loss: 0.2247172 Test Loss: 0.2841015
Validation loss decreased (0.225929 --> 0.224717).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 23 cost time: 0.9195566177368164
Epoch: 23, Steps: 64 | Train Loss: 0.0878572 Vali Loss: 0.2256313 Test Loss: 0.2850333
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 24 cost time: 0.9304389953613281
Epoch: 24, Steps: 64 | Train Loss: 0.0873883 Vali Loss: 0.2227289 Test Loss: 0.2844229
Validation loss decreased (0.224717 --> 0.222729).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 25 cost time: 0.9293930530548096
Epoch: 25, Steps: 64 | Train Loss: 0.0878060 Vali Loss: 0.2256096 Test Loss: 0.2842798
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 26 cost time: 0.9418811798095703
Epoch: 26, Steps: 64 | Train Loss: 0.0869326 Vali Loss: 0.2261935 Test Loss: 0.2845967
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 27 cost time: 0.9360003471374512
Epoch: 27, Steps: 64 | Train Loss: 0.0869640 Vali Loss: 0.2248770 Test Loss: 0.2865967
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 28 cost time: 0.9370005130767822
Epoch: 28, Steps: 64 | Train Loss: 0.0869934 Vali Loss: 0.2241825 Test Loss: 0.2851063
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 29 cost time: 0.9336163997650146
Epoch: 29, Steps: 64 | Train Loss: 0.0873830 Vali Loss: 0.2263194 Test Loss: 0.2866947
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 30 cost time: 0.9310808181762695
Epoch: 30, Steps: 64 | Train Loss: 0.0866869 Vali Loss: 0.2250065 Test Loss: 0.2850662
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 31 cost time: 0.9348175525665283
Epoch: 31, Steps: 64 | Train Loss: 0.0866907 Vali Loss: 0.2239127 Test Loss: 0.2858479
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 32 cost time: 0.9294722080230713
Epoch: 32, Steps: 64 | Train Loss: 0.0859513 Vali Loss: 0.2224267 Test Loss: 0.2853584
Validation loss decreased (0.222729 --> 0.222427).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 33 cost time: 0.9411373138427734
Epoch: 33, Steps: 64 | Train Loss: 0.0862247 Vali Loss: 0.2239438 Test Loss: 0.2856639
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 34 cost time: 0.9396214485168457
Epoch: 34, Steps: 64 | Train Loss: 0.0861113 Vali Loss: 0.2236004 Test Loss: 0.2866151
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 35 cost time: 0.9327826499938965
Epoch: 35, Steps: 64 | Train Loss: 0.0856579 Vali Loss: 0.2217463 Test Loss: 0.2866925
Validation loss decreased (0.222427 --> 0.221746).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 36 cost time: 0.9480009078979492
Epoch: 36, Steps: 64 | Train Loss: 0.0864827 Vali Loss: 0.2227344 Test Loss: 0.2866394
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 37 cost time: 0.9372479915618896
Epoch: 37, Steps: 64 | Train Loss: 0.0861548 Vali Loss: 0.2213983 Test Loss: 0.2872289
Validation loss decreased (0.221746 --> 0.221398).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 38 cost time: 0.9286081790924072
Epoch: 38, Steps: 64 | Train Loss: 0.0858792 Vali Loss: 0.2223106 Test Loss: 0.2861796
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 39 cost time: 0.9316160678863525
Epoch: 39, Steps: 64 | Train Loss: 0.0862376 Vali Loss: 0.2213825 Test Loss: 0.2862332
Validation loss decreased (0.221398 --> 0.221383).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 40 cost time: 0.9404435157775879
Epoch: 40, Steps: 64 | Train Loss: 0.0860643 Vali Loss: 0.2230960 Test Loss: 0.2864849
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 41 cost time: 0.9273831844329834
Epoch: 41, Steps: 64 | Train Loss: 0.0855770 Vali Loss: 0.2199748 Test Loss: 0.2865483
Validation loss decreased (0.221383 --> 0.219975).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 42 cost time: 0.9344494342803955
Epoch: 42, Steps: 64 | Train Loss: 0.0859231 Vali Loss: 0.2206358 Test Loss: 0.2865276
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 43 cost time: 0.9455022811889648
Epoch: 43, Steps: 64 | Train Loss: 0.0855917 Vali Loss: 0.2241601 Test Loss: 0.2873122
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 44 cost time: 0.9447400569915771
Epoch: 44, Steps: 64 | Train Loss: 0.0854998 Vali Loss: 0.2230419 Test Loss: 0.2871695
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 45 cost time: 0.9340007305145264
Epoch: 45, Steps: 64 | Train Loss: 0.0859158 Vali Loss: 0.2221247 Test Loss: 0.2871016
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 46 cost time: 0.9304673671722412
Epoch: 46, Steps: 64 | Train Loss: 0.0860159 Vali Loss: 0.2222496 Test Loss: 0.2872653
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 47 cost time: 0.927422046661377
Epoch: 47, Steps: 64 | Train Loss: 0.0854569 Vali Loss: 0.2215433 Test Loss: 0.2865797
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 48 cost time: 0.9283740520477295
Epoch: 48, Steps: 64 | Train Loss: 0.0852373 Vali Loss: 0.2227657 Test Loss: 0.2873406
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 49 cost time: 0.9344489574432373
Epoch: 49, Steps: 64 | Train Loss: 0.0857617 Vali Loss: 0.2188554 Test Loss: 0.2866091
Validation loss decreased (0.219975 --> 0.218855).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 50 cost time: 0.9343571662902832
Epoch: 50, Steps: 64 | Train Loss: 0.0857508 Vali Loss: 0.2221622 Test Loss: 0.2869097
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 51 cost time: 0.9421861171722412
Epoch: 51, Steps: 64 | Train Loss: 0.0857641 Vali Loss: 0.2228023 Test Loss: 0.2869152
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 52 cost time: 0.9444994926452637
Epoch: 52, Steps: 64 | Train Loss: 0.0859627 Vali Loss: 0.2208797 Test Loss: 0.2874487
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 53 cost time: 0.9447276592254639
Epoch: 53, Steps: 64 | Train Loss: 0.0857959 Vali Loss: 0.2213251 Test Loss: 0.2877875
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 54 cost time: 0.9409997463226318
Epoch: 54, Steps: 64 | Train Loss: 0.0855143 Vali Loss: 0.2235700 Test Loss: 0.2884801
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 55 cost time: 0.9379997253417969
Epoch: 55, Steps: 64 | Train Loss: 0.0853348 Vali Loss: 0.2215540 Test Loss: 0.2873731
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 56 cost time: 0.9436302185058594
Epoch: 56, Steps: 64 | Train Loss: 0.0856460 Vali Loss: 0.2205384 Test Loss: 0.2874708
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 57 cost time: 0.9362146854400635
Epoch: 57, Steps: 64 | Train Loss: 0.0855485 Vali Loss: 0.2162533 Test Loss: 0.2880711
Validation loss decreased (0.218855 --> 0.216253).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 58 cost time: 0.9349863529205322
Epoch: 58, Steps: 64 | Train Loss: 0.0852805 Vali Loss: 0.2216749 Test Loss: 0.2871796
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 59 cost time: 0.9364256858825684
Epoch: 59, Steps: 64 | Train Loss: 0.0855612 Vali Loss: 0.2197988 Test Loss: 0.2877304
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 60 cost time: 0.9537644386291504
Epoch: 60, Steps: 64 | Train Loss: 0.0856579 Vali Loss: 0.2226560 Test Loss: 0.2871043
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2880710959434509, mae:0.3601532578468323, rse:0.2463330179452896
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.04620790481567383 GB
Epoch: 1 cost time: 2.269895076751709
Epoch: 1, Steps: 64 | Train Loss: 0.8712855 Vali Loss: 2.5823195 Test Loss: 4.4864154
Validation loss decreased (inf --> 2.582319).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 2 cost time: 0.8843486309051514
Epoch: 2, Steps: 64 | Train Loss: 0.7043705 Vali Loss: 1.7203993 Test Loss: 2.9306636
Validation loss decreased (2.582319 --> 1.720399).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 3 cost time: 0.8960001468658447
Epoch: 3, Steps: 64 | Train Loss: 0.5174360 Vali Loss: 1.3154259 Test Loss: 2.1852391
Validation loss decreased (1.720399 --> 1.315426).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 4 cost time: 0.8900291919708252
Epoch: 4, Steps: 64 | Train Loss: 0.3977777 Vali Loss: 1.0262800 Test Loss: 1.6586878
Validation loss decreased (1.315426 --> 1.026280).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 5 cost time: 0.8883402347564697
Epoch: 5, Steps: 64 | Train Loss: 0.3161549 Vali Loss: 0.8223456 Test Loss: 1.3137054
Validation loss decreased (1.026280 --> 0.822346).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 6 cost time: 0.871337890625
Epoch: 6, Steps: 64 | Train Loss: 0.2580939 Vali Loss: 0.6833590 Test Loss: 1.0717936
Validation loss decreased (0.822346 --> 0.683359).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 7 cost time: 0.8829543590545654
Epoch: 7, Steps: 64 | Train Loss: 0.2180435 Vali Loss: 0.5910028 Test Loss: 0.9066594
Validation loss decreased (0.683359 --> 0.591003).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 8 cost time: 0.8704266548156738
Epoch: 8, Steps: 64 | Train Loss: 0.1899803 Vali Loss: 0.5119153 Test Loss: 0.7758595
Validation loss decreased (0.591003 --> 0.511915).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 9 cost time: 0.8743832111358643
Epoch: 9, Steps: 64 | Train Loss: 0.1702716 Vali Loss: 0.4435847 Test Loss: 0.6590557
Validation loss decreased (0.511915 --> 0.443585).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 10 cost time: 0.8890001773834229
Epoch: 10, Steps: 64 | Train Loss: 0.1547281 Vali Loss: 0.4190171 Test Loss: 0.6069686
Validation loss decreased (0.443585 --> 0.419017).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 11 cost time: 0.8856122493743896
Epoch: 11, Steps: 64 | Train Loss: 0.1439789 Vali Loss: 0.3768137 Test Loss: 0.5425832
Validation loss decreased (0.419017 --> 0.376814).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 12 cost time: 0.8794159889221191
Epoch: 12, Steps: 64 | Train Loss: 0.1353055 Vali Loss: 0.3550821 Test Loss: 0.5076478
Validation loss decreased (0.376814 --> 0.355082).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 13 cost time: 0.889336347579956
Epoch: 13, Steps: 64 | Train Loss: 0.1291927 Vali Loss: 0.3323041 Test Loss: 0.4680247
Validation loss decreased (0.355082 --> 0.332304).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 14 cost time: 0.8910930156707764
Epoch: 14, Steps: 64 | Train Loss: 0.1240006 Vali Loss: 0.3247170 Test Loss: 0.4454182
Validation loss decreased (0.332304 --> 0.324717).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 15 cost time: 0.8677403926849365
Epoch: 15, Steps: 64 | Train Loss: 0.1198523 Vali Loss: 0.3080496 Test Loss: 0.4203053
Validation loss decreased (0.324717 --> 0.308050).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 16 cost time: 0.8739991188049316
Epoch: 16, Steps: 64 | Train Loss: 0.1167503 Vali Loss: 0.3026342 Test Loss: 0.4082413
Validation loss decreased (0.308050 --> 0.302634).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 17 cost time: 0.8706095218658447
Epoch: 17, Steps: 64 | Train Loss: 0.1137519 Vali Loss: 0.2942191 Test Loss: 0.3956793
Validation loss decreased (0.302634 --> 0.294219).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 18 cost time: 0.8713624477386475
Epoch: 18, Steps: 64 | Train Loss: 0.1121769 Vali Loss: 0.2866038 Test Loss: 0.3821661
Validation loss decreased (0.294219 --> 0.286604).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 19 cost time: 0.893366813659668
Epoch: 19, Steps: 64 | Train Loss: 0.1106459 Vali Loss: 0.2784577 Test Loss: 0.3704982
Validation loss decreased (0.286604 --> 0.278458).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 20 cost time: 0.8823182582855225
Epoch: 20, Steps: 64 | Train Loss: 0.1087301 Vali Loss: 0.2765266 Test Loss: 0.3654736
Validation loss decreased (0.278458 --> 0.276527).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 21 cost time: 0.896730899810791
Epoch: 21, Steps: 64 | Train Loss: 0.1079631 Vali Loss: 0.2733966 Test Loss: 0.3602318
Validation loss decreased (0.276527 --> 0.273397).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 22 cost time: 0.8863935470581055
Epoch: 22, Steps: 64 | Train Loss: 0.1062172 Vali Loss: 0.2689684 Test Loss: 0.3519506
Validation loss decreased (0.273397 --> 0.268968).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 23 cost time: 0.8941035270690918
Epoch: 23, Steps: 64 | Train Loss: 0.1059627 Vali Loss: 0.2662441 Test Loss: 0.3481931
Validation loss decreased (0.268968 --> 0.266244).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 24 cost time: 0.875612735748291
Epoch: 24, Steps: 64 | Train Loss: 0.1046259 Vali Loss: 0.2637042 Test Loss: 0.3452609
Validation loss decreased (0.266244 --> 0.263704).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 25 cost time: 0.8717031478881836
Epoch: 25, Steps: 64 | Train Loss: 0.1045100 Vali Loss: 0.2652577 Test Loss: 0.3421025
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 26 cost time: 0.8704237937927246
Epoch: 26, Steps: 64 | Train Loss: 0.1037507 Vali Loss: 0.2599845 Test Loss: 0.3392689
Validation loss decreased (0.263704 --> 0.259985).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 27 cost time: 0.8783779144287109
Epoch: 27, Steps: 64 | Train Loss: 0.1033074 Vali Loss: 0.2579760 Test Loss: 0.3371933
Validation loss decreased (0.259985 --> 0.257976).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 28 cost time: 0.8917112350463867
Epoch: 28, Steps: 64 | Train Loss: 0.1034324 Vali Loss: 0.2577219 Test Loss: 0.3340268
Validation loss decreased (0.257976 --> 0.257722).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 29 cost time: 0.8869998455047607
Epoch: 29, Steps: 64 | Train Loss: 0.1029836 Vali Loss: 0.2577458 Test Loss: 0.3318176
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 30 cost time: 0.882610559463501
Epoch: 30, Steps: 64 | Train Loss: 0.1016044 Vali Loss: 0.2563071 Test Loss: 0.3301029
Validation loss decreased (0.257722 --> 0.256307).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 31 cost time: 0.88539719581604
Epoch: 31, Steps: 64 | Train Loss: 0.1023476 Vali Loss: 0.2555637 Test Loss: 0.3308839
Validation loss decreased (0.256307 --> 0.255564).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 32 cost time: 0.8723568916320801
Epoch: 32, Steps: 64 | Train Loss: 0.1013405 Vali Loss: 0.2554132 Test Loss: 0.3256934
Validation loss decreased (0.255564 --> 0.255413).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 33 cost time: 0.8664190769195557
Epoch: 33, Steps: 64 | Train Loss: 0.1012438 Vali Loss: 0.2520281 Test Loss: 0.3274007
Validation loss decreased (0.255413 --> 0.252028).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 34 cost time: 0.8678882122039795
Epoch: 34, Steps: 64 | Train Loss: 0.1012443 Vali Loss: 0.2543245 Test Loss: 0.3263852
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 35 cost time: 0.875830888748169
Epoch: 35, Steps: 64 | Train Loss: 0.1007369 Vali Loss: 0.2524749 Test Loss: 0.3265035
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 36 cost time: 0.8826165199279785
Epoch: 36, Steps: 64 | Train Loss: 0.1013123 Vali Loss: 0.2499799 Test Loss: 0.3237494
Validation loss decreased (0.252028 --> 0.249980).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 37 cost time: 0.896327018737793
Epoch: 37, Steps: 64 | Train Loss: 0.1004653 Vali Loss: 0.2534578 Test Loss: 0.3229125
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 38 cost time: 0.883453369140625
Epoch: 38, Steps: 64 | Train Loss: 0.1011496 Vali Loss: 0.2521634 Test Loss: 0.3211310
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 39 cost time: 0.8904595375061035
Epoch: 39, Steps: 64 | Train Loss: 0.1000114 Vali Loss: 0.2519339 Test Loss: 0.3230113
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 40 cost time: 0.884425163269043
Epoch: 40, Steps: 64 | Train Loss: 0.1003030 Vali Loss: 0.2508162 Test Loss: 0.3230664
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 41 cost time: 0.8704688549041748
Epoch: 41, Steps: 64 | Train Loss: 0.0996313 Vali Loss: 0.2491939 Test Loss: 0.3196961
Validation loss decreased (0.249980 --> 0.249194).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 42 cost time: 0.8676102161407471
Epoch: 42, Steps: 64 | Train Loss: 0.1003249 Vali Loss: 0.2475364 Test Loss: 0.3204851
Validation loss decreased (0.249194 --> 0.247536).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 43 cost time: 0.8684816360473633
Epoch: 43, Steps: 64 | Train Loss: 0.1001082 Vali Loss: 0.2507584 Test Loss: 0.3192060
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 44 cost time: 0.8704805374145508
Epoch: 44, Steps: 64 | Train Loss: 0.1002723 Vali Loss: 0.2482817 Test Loss: 0.3184941
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 45 cost time: 0.8873386383056641
Epoch: 45, Steps: 64 | Train Loss: 0.0998102 Vali Loss: 0.2488735 Test Loss: 0.3198468
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 46 cost time: 0.8877215385437012
Epoch: 46, Steps: 64 | Train Loss: 0.0996817 Vali Loss: 0.2494938 Test Loss: 0.3178307
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 47 cost time: 0.8859996795654297
Epoch: 47, Steps: 64 | Train Loss: 0.1000369 Vali Loss: 0.2474801 Test Loss: 0.3178544
Validation loss decreased (0.247536 --> 0.247480).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 48 cost time: 0.8816239833831787
Epoch: 48, Steps: 64 | Train Loss: 0.0999100 Vali Loss: 0.2506056 Test Loss: 0.3179095
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 49 cost time: 0.8806073665618896
Epoch: 49, Steps: 64 | Train Loss: 0.0994236 Vali Loss: 0.2458330 Test Loss: 0.3170758
Validation loss decreased (0.247480 --> 0.245833).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 50 cost time: 0.8575031757354736
Epoch: 50, Steps: 64 | Train Loss: 0.0990032 Vali Loss: 0.2493913 Test Loss: 0.3186909
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 51 cost time: 0.8714056015014648
Epoch: 51, Steps: 64 | Train Loss: 0.0993918 Vali Loss: 0.2470152 Test Loss: 0.3175137
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 52 cost time: 0.8697741031646729
Epoch: 52, Steps: 64 | Train Loss: 0.0991686 Vali Loss: 0.2465702 Test Loss: 0.3164467
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 53 cost time: 0.880427360534668
Epoch: 53, Steps: 64 | Train Loss: 0.0989288 Vali Loss: 0.2444838 Test Loss: 0.3167413
Validation loss decreased (0.245833 --> 0.244484).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 54 cost time: 0.8853676319122314
Epoch: 54, Steps: 64 | Train Loss: 0.0993341 Vali Loss: 0.2501746 Test Loss: 0.3168868
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 55 cost time: 0.8865358829498291
Epoch: 55, Steps: 64 | Train Loss: 0.0987367 Vali Loss: 0.2451866 Test Loss: 0.3179956
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 56 cost time: 0.8823671340942383
Epoch: 56, Steps: 64 | Train Loss: 0.0991952 Vali Loss: 0.2487247 Test Loss: 0.3177125
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 57 cost time: 0.8786931037902832
Epoch: 57, Steps: 64 | Train Loss: 0.0991866 Vali Loss: 0.2473268 Test Loss: 0.3159049
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 58 cost time: 0.8757503032684326
Epoch: 58, Steps: 64 | Train Loss: 0.0982546 Vali Loss: 0.2478168 Test Loss: 0.3168299
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 59 cost time: 0.8709986209869385
Epoch: 59, Steps: 64 | Train Loss: 0.0994149 Vali Loss: 0.2460131 Test Loss: 0.3162957
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 60 cost time: 0.8786108493804932
Epoch: 60, Steps: 64 | Train Loss: 0.0992735 Vali Loss: 0.2475407 Test Loss: 0.3154899
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.31674137711524963, mae:0.38670432567596436, rse:0.25830045342445374
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 1 cost time: 2.3423964977264404
Epoch: 1, Steps: 64 | Train Loss: 0.8320563 Vali Loss: 2.5453610 Test Loss: 4.4464655
Validation loss decreased (inf --> 2.545361).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 2 cost time: 0.9231150150299072
Epoch: 2, Steps: 64 | Train Loss: 0.5055735 Vali Loss: 0.5726153 Test Loss: 0.8500928
Validation loss decreased (2.545361 --> 0.572615).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 3 cost time: 0.9227418899536133
Epoch: 3, Steps: 64 | Train Loss: 0.1436967 Vali Loss: 0.2619548 Test Loss: 0.2849375
Validation loss decreased (0.572615 --> 0.261955).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 4 cost time: 0.9242134094238281
Epoch: 4, Steps: 64 | Train Loss: 0.1123213 Vali Loss: 0.2607575 Test Loss: 0.2977664
Validation loss decreased (0.261955 --> 0.260757).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 5 cost time: 0.9524867534637451
Epoch: 5, Steps: 64 | Train Loss: 0.1059747 Vali Loss: 0.2485266 Test Loss: 0.2892667
Validation loss decreased (0.260757 --> 0.248527).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 6 cost time: 0.9148569107055664
Epoch: 6, Steps: 64 | Train Loss: 0.1024386 Vali Loss: 0.2436011 Test Loss: 0.2884012
Validation loss decreased (0.248527 --> 0.243601).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 7 cost time: 0.9200003147125244
Epoch: 7, Steps: 64 | Train Loss: 0.1004539 Vali Loss: 0.2383920 Test Loss: 0.2877771
Validation loss decreased (0.243601 --> 0.238392).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 8 cost time: 0.9159998893737793
Epoch: 8, Steps: 64 | Train Loss: 0.0982892 Vali Loss: 0.2421451 Test Loss: 0.2845145
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 9 cost time: 0.9146242141723633
Epoch: 9, Steps: 64 | Train Loss: 0.0963886 Vali Loss: 0.2357007 Test Loss: 0.2846831
Validation loss decreased (0.238392 --> 0.235701).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 10 cost time: 0.9243326187133789
Epoch: 10, Steps: 64 | Train Loss: 0.0953651 Vali Loss: 0.2354362 Test Loss: 0.2823405
Validation loss decreased (0.235701 --> 0.235436).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 11 cost time: 0.921245813369751
Epoch: 11, Steps: 64 | Train Loss: 0.0938142 Vali Loss: 0.2350813 Test Loss: 0.2839867
Validation loss decreased (0.235436 --> 0.235081).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 12 cost time: 0.9203288555145264
Epoch: 12, Steps: 64 | Train Loss: 0.0930287 Vali Loss: 0.2305443 Test Loss: 0.2849302
Validation loss decreased (0.235081 --> 0.230544).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 13 cost time: 0.916388750076294
Epoch: 13, Steps: 64 | Train Loss: 0.0917972 Vali Loss: 0.2328170 Test Loss: 0.2826568
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 14 cost time: 0.923271656036377
Epoch: 14, Steps: 64 | Train Loss: 0.0907679 Vali Loss: 0.2305161 Test Loss: 0.2843038
Validation loss decreased (0.230544 --> 0.230516).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 15 cost time: 0.908257246017456
Epoch: 15, Steps: 64 | Train Loss: 0.0901381 Vali Loss: 0.2280049 Test Loss: 0.2845760
Validation loss decreased (0.230516 --> 0.228005).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 16 cost time: 0.9110000133514404
Epoch: 16, Steps: 64 | Train Loss: 0.0899594 Vali Loss: 0.2265508 Test Loss: 0.2852013
Validation loss decreased (0.228005 --> 0.226551).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 17 cost time: 0.9216258525848389
Epoch: 17, Steps: 64 | Train Loss: 0.0896268 Vali Loss: 0.2264830 Test Loss: 0.2843207
Validation loss decreased (0.226551 --> 0.226483).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 18 cost time: 0.9253480434417725
Epoch: 18, Steps: 64 | Train Loss: 0.0892488 Vali Loss: 0.2248694 Test Loss: 0.2852767
Validation loss decreased (0.226483 --> 0.224869).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 19 cost time: 0.9230127334594727
Epoch: 19, Steps: 64 | Train Loss: 0.0883507 Vali Loss: 0.2243050 Test Loss: 0.2843010
Validation loss decreased (0.224869 --> 0.224305).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 20 cost time: 0.9223349094390869
Epoch: 20, Steps: 64 | Train Loss: 0.0881043 Vali Loss: 0.2250525 Test Loss: 0.2849376
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 21 cost time: 0.9333493709564209
Epoch: 21, Steps: 64 | Train Loss: 0.0881762 Vali Loss: 0.2227734 Test Loss: 0.2859795
Validation loss decreased (0.224305 --> 0.222773).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 22 cost time: 0.9044711589813232
Epoch: 22, Steps: 64 | Train Loss: 0.0871453 Vali Loss: 0.2250063 Test Loss: 0.2856030
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 23 cost time: 0.9053783416748047
Epoch: 23, Steps: 64 | Train Loss: 0.0875891 Vali Loss: 0.2246869 Test Loss: 0.2851536
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 24 cost time: 0.9130001068115234
Epoch: 24, Steps: 64 | Train Loss: 0.0869745 Vali Loss: 0.2231424 Test Loss: 0.2846507
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 25 cost time: 0.9066193103790283
Epoch: 25, Steps: 64 | Train Loss: 0.0865795 Vali Loss: 0.2206528 Test Loss: 0.2850277
Validation loss decreased (0.222773 --> 0.220653).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 26 cost time: 0.9143390655517578
Epoch: 26, Steps: 64 | Train Loss: 0.0859331 Vali Loss: 0.2203558 Test Loss: 0.2863474
Validation loss decreased (0.220653 --> 0.220356).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 27 cost time: 0.9193837642669678
Epoch: 27, Steps: 64 | Train Loss: 0.0864615 Vali Loss: 0.2243320 Test Loss: 0.2874655
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 28 cost time: 0.9046421051025391
Epoch: 28, Steps: 64 | Train Loss: 0.0859831 Vali Loss: 0.2209460 Test Loss: 0.2865890
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 29 cost time: 0.9983549118041992
Epoch: 29, Steps: 64 | Train Loss: 0.0859449 Vali Loss: 0.2221824 Test Loss: 0.2863318
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 30 cost time: 0.9978055953979492
Epoch: 30, Steps: 64 | Train Loss: 0.0859323 Vali Loss: 0.2217937 Test Loss: 0.2861259
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 31 cost time: 0.9474053382873535
Epoch: 31, Steps: 64 | Train Loss: 0.0858233 Vali Loss: 0.2207465 Test Loss: 0.2865253
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 32 cost time: 0.9088134765625
Epoch: 32, Steps: 64 | Train Loss: 0.0845780 Vali Loss: 0.2202142 Test Loss: 0.2870238
Validation loss decreased (0.220356 --> 0.220214).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 33 cost time: 0.9110002517700195
Epoch: 33, Steps: 64 | Train Loss: 0.0848897 Vali Loss: 0.2204117 Test Loss: 0.2871234
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 34 cost time: 0.9206147193908691
Epoch: 34, Steps: 64 | Train Loss: 0.0854938 Vali Loss: 0.2189675 Test Loss: 0.2875494
Validation loss decreased (0.220214 --> 0.218967).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 35 cost time: 0.9983980655670166
Epoch: 35, Steps: 64 | Train Loss: 0.0851454 Vali Loss: 0.2194041 Test Loss: 0.2860385
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 36 cost time: 0.9206104278564453
Epoch: 36, Steps: 64 | Train Loss: 0.0854630 Vali Loss: 0.2206075 Test Loss: 0.2869656
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 37 cost time: 0.9215106964111328
Epoch: 37, Steps: 64 | Train Loss: 0.0848306 Vali Loss: 0.2223899 Test Loss: 0.2859806
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 38 cost time: 0.9206182956695557
Epoch: 38, Steps: 64 | Train Loss: 0.0855314 Vali Loss: 0.2187926 Test Loss: 0.2862264
Validation loss decreased (0.218967 --> 0.218793).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 39 cost time: 0.905332088470459
Epoch: 39, Steps: 64 | Train Loss: 0.0846125 Vali Loss: 0.2212724 Test Loss: 0.2865691
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 40 cost time: 0.9101474285125732
Epoch: 40, Steps: 64 | Train Loss: 0.0851786 Vali Loss: 0.2218819 Test Loss: 0.2871382
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 41 cost time: 0.9230000972747803
Epoch: 41, Steps: 64 | Train Loss: 0.0849476 Vali Loss: 0.2227677 Test Loss: 0.2872334
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 42 cost time: 0.9080002307891846
Epoch: 42, Steps: 64 | Train Loss: 0.0849777 Vali Loss: 0.2214757 Test Loss: 0.2872370
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 43 cost time: 0.9210159778594971
Epoch: 43, Steps: 64 | Train Loss: 0.0852378 Vali Loss: 0.2181303 Test Loss: 0.2870886
Validation loss decreased (0.218793 --> 0.218130).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 44 cost time: 0.9240131378173828
Epoch: 44, Steps: 64 | Train Loss: 0.0849080 Vali Loss: 0.2204014 Test Loss: 0.2874007
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 45 cost time: 0.92240309715271
Epoch: 45, Steps: 64 | Train Loss: 0.0847518 Vali Loss: 0.2216588 Test Loss: 0.2871424
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 46 cost time: 0.9234693050384521
Epoch: 46, Steps: 64 | Train Loss: 0.0846175 Vali Loss: 0.2205389 Test Loss: 0.2870599
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 47 cost time: 0.9073507785797119
Epoch: 47, Steps: 64 | Train Loss: 0.0848780 Vali Loss: 0.2196758 Test Loss: 0.2870519
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 48 cost time: 0.9088535308837891
Epoch: 48, Steps: 64 | Train Loss: 0.0846273 Vali Loss: 0.2198092 Test Loss: 0.2881742
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 49 cost time: 0.9049999713897705
Epoch: 49, Steps: 64 | Train Loss: 0.0843853 Vali Loss: 0.2187164 Test Loss: 0.2876784
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 50 cost time: 0.9146192073822021
Epoch: 50, Steps: 64 | Train Loss: 0.0847097 Vali Loss: 0.2210408 Test Loss: 0.2877994
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 51 cost time: 0.9246244430541992
Epoch: 51, Steps: 64 | Train Loss: 0.0847544 Vali Loss: 0.2207423 Test Loss: 0.2880883
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 52 cost time: 0.9231047630310059
Epoch: 52, Steps: 64 | Train Loss: 0.0850256 Vali Loss: 0.2226234 Test Loss: 0.2874815
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 53 cost time: 0.9175736904144287
Epoch: 53, Steps: 64 | Train Loss: 0.0847333 Vali Loss: 0.2209562 Test Loss: 0.2868572
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 54 cost time: 0.9034903049468994
Epoch: 54, Steps: 64 | Train Loss: 0.0843152 Vali Loss: 0.2205733 Test Loss: 0.2875714
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 55 cost time: 0.9034419059753418
Epoch: 55, Steps: 64 | Train Loss: 0.0842136 Vali Loss: 0.2186842 Test Loss: 0.2878166
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 56 cost time: 0.9118380546569824
Epoch: 56, Steps: 64 | Train Loss: 0.0842126 Vali Loss: 0.2200868 Test Loss: 0.2877560
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 57 cost time: 0.9146113395690918
Epoch: 57, Steps: 64 | Train Loss: 0.0847954 Vali Loss: 0.2197106 Test Loss: 0.2876161
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 58 cost time: 0.9256343841552734
Epoch: 58, Steps: 64 | Train Loss: 0.0849207 Vali Loss: 0.2164598 Test Loss: 0.2874902
Validation loss decreased (0.218130 --> 0.216460).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 59 cost time: 0.9148809909820557
Epoch: 59, Steps: 64 | Train Loss: 0.0845365 Vali Loss: 0.2215045 Test Loss: 0.2879432
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 60 cost time: 0.9217336177825928
Epoch: 60, Steps: 64 | Train Loss: 0.0847451 Vali Loss: 0.2186708 Test Loss: 0.2872544
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.28749024868011475, mae:0.3600907325744629, rse:0.2460845410823822
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.053494930267333984 GB
Epoch: 1 cost time: 2.3503239154815674
Epoch: 1, Steps: 64 | Train Loss: 0.8314153 Vali Loss: 2.5669374 Test Loss: 4.5733366
Validation loss decreased (inf --> 2.566937).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 2 cost time: 0.9296934604644775
Epoch: 2, Steps: 64 | Train Loss: 0.4402852 Vali Loss: 0.2707342 Test Loss: 0.3300625
Validation loss decreased (2.566937 --> 0.270734).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 3 cost time: 0.9474871158599854
Epoch: 3, Steps: 64 | Train Loss: 0.1231961 Vali Loss: 0.2859300 Test Loss: 0.3358176
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 4 cost time: 0.9505045413970947
Epoch: 4, Steps: 64 | Train Loss: 0.1084594 Vali Loss: 0.2481647 Test Loss: 0.2933205
Validation loss decreased (0.270734 --> 0.248165).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 5 cost time: 0.9466040134429932
Epoch: 5, Steps: 64 | Train Loss: 0.1037730 Vali Loss: 0.2481710 Test Loss: 0.2945105
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 6 cost time: 0.9344437122344971
Epoch: 6, Steps: 64 | Train Loss: 0.1008871 Vali Loss: 0.2461373 Test Loss: 0.2927481
Validation loss decreased (0.248165 --> 0.246137).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 7 cost time: 0.9329996109008789
Epoch: 7, Steps: 64 | Train Loss: 0.0979202 Vali Loss: 0.2434104 Test Loss: 0.2914474
Validation loss decreased (0.246137 --> 0.243410).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 8 cost time: 0.9376316070556641
Epoch: 8, Steps: 64 | Train Loss: 0.0959914 Vali Loss: 0.2413945 Test Loss: 0.2933657
Validation loss decreased (0.243410 --> 0.241395).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 9 cost time: 0.9354181289672852
Epoch: 9, Steps: 64 | Train Loss: 0.0947596 Vali Loss: 0.2382665 Test Loss: 0.2930302
Validation loss decreased (0.241395 --> 0.238267).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 10 cost time: 0.9484231472015381
Epoch: 10, Steps: 64 | Train Loss: 0.0935346 Vali Loss: 0.2358725 Test Loss: 0.2909488
Validation loss decreased (0.238267 --> 0.235873).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 11 cost time: 0.9426417350769043
Epoch: 11, Steps: 64 | Train Loss: 0.0920853 Vali Loss: 0.2348530 Test Loss: 0.2951778
Validation loss decreased (0.235873 --> 0.234853).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 12 cost time: 0.9444067478179932
Epoch: 12, Steps: 64 | Train Loss: 0.0908496 Vali Loss: 0.2353140 Test Loss: 0.2949390
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 13 cost time: 0.9433526992797852
Epoch: 13, Steps: 64 | Train Loss: 0.0905357 Vali Loss: 0.2321442 Test Loss: 0.2952092
Validation loss decreased (0.234853 --> 0.232144).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 14 cost time: 0.9635233879089355
Epoch: 14, Steps: 64 | Train Loss: 0.0898698 Vali Loss: 0.2336290 Test Loss: 0.2958940
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 15 cost time: 0.9547913074493408
Epoch: 15, Steps: 64 | Train Loss: 0.0887000 Vali Loss: 0.2279896 Test Loss: 0.2946062
Validation loss decreased (0.232144 --> 0.227990).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 16 cost time: 0.9456074237823486
Epoch: 16, Steps: 64 | Train Loss: 0.0878333 Vali Loss: 0.2283916 Test Loss: 0.2958265
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 17 cost time: 0.944000244140625
Epoch: 17, Steps: 64 | Train Loss: 0.0876992 Vali Loss: 0.2297655 Test Loss: 0.2977895
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 18 cost time: 0.9580307006835938
Epoch: 18, Steps: 64 | Train Loss: 0.0873091 Vali Loss: 0.2248296 Test Loss: 0.2958853
Validation loss decreased (0.227990 --> 0.224830).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 19 cost time: 0.9566693305969238
Epoch: 19, Steps: 64 | Train Loss: 0.0868237 Vali Loss: 0.2307734 Test Loss: 0.2976776
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 20 cost time: 0.9470129013061523
Epoch: 20, Steps: 64 | Train Loss: 0.0858977 Vali Loss: 0.2265506 Test Loss: 0.2975801
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 21 cost time: 0.9483513832092285
Epoch: 21, Steps: 64 | Train Loss: 0.0862092 Vali Loss: 0.2264987 Test Loss: 0.2993117
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 22 cost time: 0.9343199729919434
Epoch: 22, Steps: 64 | Train Loss: 0.0862605 Vali Loss: 0.2294897 Test Loss: 0.2991135
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 23 cost time: 0.9350147247314453
Epoch: 23, Steps: 64 | Train Loss: 0.0853720 Vali Loss: 0.2272561 Test Loss: 0.2991736
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 24 cost time: 0.9364409446716309
Epoch: 24, Steps: 64 | Train Loss: 0.0850471 Vali Loss: 0.2255123 Test Loss: 0.3000198
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 25 cost time: 0.9357407093048096
Epoch: 25, Steps: 64 | Train Loss: 0.0855003 Vali Loss: 0.2264549 Test Loss: 0.2998954
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 26 cost time: 0.9519996643066406
Epoch: 26, Steps: 64 | Train Loss: 0.0848734 Vali Loss: 0.2235502 Test Loss: 0.2997006
Validation loss decreased (0.224830 --> 0.223550).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 27 cost time: 0.948451042175293
Epoch: 27, Steps: 64 | Train Loss: 0.0852106 Vali Loss: 0.2256399 Test Loss: 0.3008637
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 28 cost time: 0.9416193962097168
Epoch: 28, Steps: 64 | Train Loss: 0.0845721 Vali Loss: 0.2246847 Test Loss: 0.3002217
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 29 cost time: 0.9506118297576904
Epoch: 29, Steps: 64 | Train Loss: 0.0846945 Vali Loss: 0.2245073 Test Loss: 0.3012323
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 30 cost time: 0.9404902458190918
Epoch: 30, Steps: 64 | Train Loss: 0.0846372 Vali Loss: 0.2265041 Test Loss: 0.3002129
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 31 cost time: 0.936415433883667
Epoch: 31, Steps: 64 | Train Loss: 0.0849541 Vali Loss: 0.2241985 Test Loss: 0.3011759
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 32 cost time: 0.9339909553527832
Epoch: 32, Steps: 64 | Train Loss: 0.0838114 Vali Loss: 0.2245472 Test Loss: 0.3000830
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 33 cost time: 0.9364361763000488
Epoch: 33, Steps: 64 | Train Loss: 0.0841674 Vali Loss: 0.2240678 Test Loss: 0.3002966
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 34 cost time: 0.9524195194244385
Epoch: 34, Steps: 64 | Train Loss: 0.0839033 Vali Loss: 0.2260235 Test Loss: 0.3010281
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 35 cost time: 0.9606680870056152
Epoch: 35, Steps: 64 | Train Loss: 0.0843113 Vali Loss: 0.2247357 Test Loss: 0.3002924
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 36 cost time: 0.9569969177246094
Epoch: 36, Steps: 64 | Train Loss: 0.0835913 Vali Loss: 0.2276283 Test Loss: 0.3013403
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 37 cost time: 0.9499998092651367
Epoch: 37, Steps: 64 | Train Loss: 0.0839854 Vali Loss: 0.2247507 Test Loss: 0.3024064
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 38 cost time: 0.9456217288970947
Epoch: 38, Steps: 64 | Train Loss: 0.0841312 Vali Loss: 0.2262471 Test Loss: 0.3026434
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 39 cost time: 0.937180757522583
Epoch: 39, Steps: 64 | Train Loss: 0.0839556 Vali Loss: 0.2256479 Test Loss: 0.3010353
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 40 cost time: 0.937375545501709
Epoch: 40, Steps: 64 | Train Loss: 0.0841774 Vali Loss: 0.2248914 Test Loss: 0.3021667
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 41 cost time: 0.9393556118011475
Epoch: 41, Steps: 64 | Train Loss: 0.0836687 Vali Loss: 0.2233493 Test Loss: 0.3016332
Validation loss decreased (0.223550 --> 0.223349).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 42 cost time: 0.9564275741577148
Epoch: 42, Steps: 64 | Train Loss: 0.0842639 Vali Loss: 0.2252430 Test Loss: 0.3014573
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 43 cost time: 0.9552500247955322
Epoch: 43, Steps: 64 | Train Loss: 0.0840610 Vali Loss: 0.2259965 Test Loss: 0.3012558
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 44 cost time: 0.9582841396331787
Epoch: 44, Steps: 64 | Train Loss: 0.0836628 Vali Loss: 0.2259841 Test Loss: 0.3015674
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 45 cost time: 0.9447150230407715
Epoch: 45, Steps: 64 | Train Loss: 0.0835757 Vali Loss: 0.2225234 Test Loss: 0.3022182
Validation loss decreased (0.223349 --> 0.222523).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 46 cost time: 0.9439997673034668
Epoch: 46, Steps: 64 | Train Loss: 0.0836137 Vali Loss: 0.2212986 Test Loss: 0.3026405
Validation loss decreased (0.222523 --> 0.221299).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 47 cost time: 0.9440000057220459
Epoch: 47, Steps: 64 | Train Loss: 0.0834673 Vali Loss: 0.2256083 Test Loss: 0.3017930
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 48 cost time: 0.942626953125
Epoch: 48, Steps: 64 | Train Loss: 0.0833024 Vali Loss: 0.2251390 Test Loss: 0.3021019
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 49 cost time: 0.9384200572967529
Epoch: 49, Steps: 64 | Train Loss: 0.0839782 Vali Loss: 0.2243693 Test Loss: 0.3020044
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 50 cost time: 0.9624383449554443
Epoch: 50, Steps: 64 | Train Loss: 0.0836204 Vali Loss: 0.2257878 Test Loss: 0.3017901
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 51 cost time: 0.9640769958496094
Epoch: 51, Steps: 64 | Train Loss: 0.0837828 Vali Loss: 0.2268995 Test Loss: 0.3020276
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 52 cost time: 0.9563868045806885
Epoch: 52, Steps: 64 | Train Loss: 0.0835146 Vali Loss: 0.2230091 Test Loss: 0.3024414
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 53 cost time: 0.9493510723114014
Epoch: 53, Steps: 64 | Train Loss: 0.0834784 Vali Loss: 0.2249239 Test Loss: 0.3022383
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 54 cost time: 0.9372191429138184
Epoch: 54, Steps: 64 | Train Loss: 0.0837204 Vali Loss: 0.2260710 Test Loss: 0.3027601
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 55 cost time: 0.9528052806854248
Epoch: 55, Steps: 64 | Train Loss: 0.0835861 Vali Loss: 0.2261621 Test Loss: 0.3033214
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 56 cost time: 0.9364216327667236
Epoch: 56, Steps: 64 | Train Loss: 0.0836422 Vali Loss: 0.2232348 Test Loss: 0.3026092
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 57 cost time: 0.93399977684021
Epoch: 57, Steps: 64 | Train Loss: 0.0836063 Vali Loss: 0.2239187 Test Loss: 0.3018112
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 58 cost time: 0.9566209316253662
Epoch: 58, Steps: 64 | Train Loss: 0.0830289 Vali Loss: 0.2214634 Test Loss: 0.3019844
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 59 cost time: 0.9523742198944092
Epoch: 59, Steps: 64 | Train Loss: 0.0828461 Vali Loss: 0.2269692 Test Loss: 0.3032058
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 60 cost time: 0.96109938621521
Epoch: 60, Steps: 64 | Train Loss: 0.0834401 Vali Loss: 0.2259637 Test Loss: 0.3022948
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.30264052748680115, mae:0.3814375698566437, rse:0.252485454082489
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.049500465393066406 GB
Epoch: 1 cost time: 2.2505548000335693
Epoch: 1, Steps: 64 | Train Loss: 0.8952838 Vali Loss: 2.6197178 Test Loss: 4.6223149
Validation loss decreased (inf --> 2.619718).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 2 cost time: 0.8379964828491211
Epoch: 2, Steps: 64 | Train Loss: 0.7642189 Vali Loss: 1.9529995 Test Loss: 3.3841927
Validation loss decreased (2.619718 --> 1.952999).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 3 cost time: 0.8551721572875977
Epoch: 3, Steps: 64 | Train Loss: 0.5960892 Vali Loss: 1.5481009 Test Loss: 2.6079705
Validation loss decreased (1.952999 --> 1.548101).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 4 cost time: 0.8549995422363281
Epoch: 4, Steps: 64 | Train Loss: 0.4703780 Vali Loss: 1.2262831 Test Loss: 2.0249755
Validation loss decreased (1.548101 --> 1.226283).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 5 cost time: 0.8706235885620117
Epoch: 5, Steps: 64 | Train Loss: 0.3746618 Vali Loss: 0.9808621 Test Loss: 1.5928823
Validation loss decreased (1.226283 --> 0.980862).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 6 cost time: 0.855614185333252
Epoch: 6, Steps: 64 | Train Loss: 0.3042173 Vali Loss: 0.8033718 Test Loss: 1.2773561
Validation loss decreased (0.980862 --> 0.803372).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 7 cost time: 0.8510258197784424
Epoch: 7, Steps: 64 | Train Loss: 0.2540898 Vali Loss: 0.6782054 Test Loss: 1.0607423
Validation loss decreased (0.803372 --> 0.678205).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 8 cost time: 0.8528134822845459
Epoch: 8, Steps: 64 | Train Loss: 0.2184376 Vali Loss: 0.5754123 Test Loss: 0.8871244
Validation loss decreased (0.678205 --> 0.575412).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 9 cost time: 0.8489997386932373
Epoch: 9, Steps: 64 | Train Loss: 0.1921999 Vali Loss: 0.5156215 Test Loss: 0.7804198
Validation loss decreased (0.575412 --> 0.515621).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 10 cost time: 0.8540215492248535
Epoch: 10, Steps: 64 | Train Loss: 0.1723672 Vali Loss: 0.4673283 Test Loss: 0.6919159
Validation loss decreased (0.515621 --> 0.467328).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 11 cost time: 0.8535442352294922
Epoch: 11, Steps: 64 | Train Loss: 0.1596948 Vali Loss: 0.4256420 Test Loss: 0.6228806
Validation loss decreased (0.467328 --> 0.425642).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 12 cost time: 0.8593833446502686
Epoch: 12, Steps: 64 | Train Loss: 0.1496755 Vali Loss: 0.4043181 Test Loss: 0.5787823
Validation loss decreased (0.425642 --> 0.404318).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 13 cost time: 0.8568365573883057
Epoch: 13, Steps: 64 | Train Loss: 0.1414677 Vali Loss: 0.3719651 Test Loss: 0.5329913
Validation loss decreased (0.404318 --> 0.371965).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 14 cost time: 0.8570001125335693
Epoch: 14, Steps: 64 | Train Loss: 0.1342014 Vali Loss: 0.3596862 Test Loss: 0.5056504
Validation loss decreased (0.371965 --> 0.359686).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 15 cost time: 0.8532428741455078
Epoch: 15, Steps: 64 | Train Loss: 0.1299056 Vali Loss: 0.3413801 Test Loss: 0.4791502
Validation loss decreased (0.359686 --> 0.341380).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 16 cost time: 0.8621013164520264
Epoch: 16, Steps: 64 | Train Loss: 0.1253078 Vali Loss: 0.3292192 Test Loss: 0.4568996
Validation loss decreased (0.341380 --> 0.329219).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 17 cost time: 0.8495333194732666
Epoch: 17, Steps: 64 | Train Loss: 0.1223323 Vali Loss: 0.3226905 Test Loss: 0.4426612
Validation loss decreased (0.329219 --> 0.322691).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 18 cost time: 0.8533389568328857
Epoch: 18, Steps: 64 | Train Loss: 0.1196847 Vali Loss: 0.3120134 Test Loss: 0.4264738
Validation loss decreased (0.322691 --> 0.312013).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 19 cost time: 0.8537542819976807
Epoch: 19, Steps: 64 | Train Loss: 0.1172700 Vali Loss: 0.3047905 Test Loss: 0.4118687
Validation loss decreased (0.312013 --> 0.304791).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 20 cost time: 0.8640007972717285
Epoch: 20, Steps: 64 | Train Loss: 0.1154552 Vali Loss: 0.2992318 Test Loss: 0.4041902
Validation loss decreased (0.304791 --> 0.299232).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 21 cost time: 0.861422061920166
Epoch: 21, Steps: 64 | Train Loss: 0.1138639 Vali Loss: 0.2948178 Test Loss: 0.3970338
Validation loss decreased (0.299232 --> 0.294818).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 22 cost time: 0.8613479137420654
Epoch: 22, Steps: 64 | Train Loss: 0.1131829 Vali Loss: 0.2862932 Test Loss: 0.3872320
Validation loss decreased (0.294818 --> 0.286293).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 23 cost time: 0.8575758934020996
Epoch: 23, Steps: 64 | Train Loss: 0.1116511 Vali Loss: 0.2848703 Test Loss: 0.3854221
Validation loss decreased (0.286293 --> 0.284870).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 24 cost time: 0.8425889015197754
Epoch: 24, Steps: 64 | Train Loss: 0.1099941 Vali Loss: 0.2868916 Test Loss: 0.3807788
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 25 cost time: 0.8519999980926514
Epoch: 25, Steps: 64 | Train Loss: 0.1092123 Vali Loss: 0.2846817 Test Loss: 0.3791083
Validation loss decreased (0.284870 --> 0.284682).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 26 cost time: 0.8466365337371826
Epoch: 26, Steps: 64 | Train Loss: 0.1085183 Vali Loss: 0.2799121 Test Loss: 0.3685081
Validation loss decreased (0.284682 --> 0.279912).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 27 cost time: 0.8623535633087158
Epoch: 27, Steps: 64 | Train Loss: 0.1085409 Vali Loss: 0.2776993 Test Loss: 0.3685873
Validation loss decreased (0.279912 --> 0.277699).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 28 cost time: 0.848069429397583
Epoch: 28, Steps: 64 | Train Loss: 0.1073672 Vali Loss: 0.2741078 Test Loss: 0.3648774
Validation loss decreased (0.277699 --> 0.274108).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 29 cost time: 0.8587646484375
Epoch: 29, Steps: 64 | Train Loss: 0.1067769 Vali Loss: 0.2720020 Test Loss: 0.3609985
Validation loss decreased (0.274108 --> 0.272002).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 30 cost time: 0.854999303817749
Epoch: 30, Steps: 64 | Train Loss: 0.1063538 Vali Loss: 0.2705044 Test Loss: 0.3606568
Validation loss decreased (0.272002 --> 0.270504).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 31 cost time: 0.8567698001861572
Epoch: 31, Steps: 64 | Train Loss: 0.1066044 Vali Loss: 0.2697719 Test Loss: 0.3576990
Validation loss decreased (0.270504 --> 0.269772).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 32 cost time: 0.8603856563568115
Epoch: 32, Steps: 64 | Train Loss: 0.1048691 Vali Loss: 0.2699761 Test Loss: 0.3577445
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 33 cost time: 0.8504142761230469
Epoch: 33, Steps: 64 | Train Loss: 0.1059168 Vali Loss: 0.2657455 Test Loss: 0.3555192
Validation loss decreased (0.269772 --> 0.265746).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 34 cost time: 0.8477475643157959
Epoch: 34, Steps: 64 | Train Loss: 0.1052727 Vali Loss: 0.2685872 Test Loss: 0.3544347
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 35 cost time: 0.8589949607849121
Epoch: 35, Steps: 64 | Train Loss: 0.1048387 Vali Loss: 0.2675690 Test Loss: 0.3539909
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 36 cost time: 0.8506217002868652
Epoch: 36, Steps: 64 | Train Loss: 0.1043687 Vali Loss: 0.2665019 Test Loss: 0.3534472
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 37 cost time: 0.8552963733673096
Epoch: 37, Steps: 64 | Train Loss: 0.1035553 Vali Loss: 0.2651458 Test Loss: 0.3504487
Validation loss decreased (0.265746 --> 0.265146).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 38 cost time: 0.855438232421875
Epoch: 38, Steps: 64 | Train Loss: 0.1037118 Vali Loss: 0.2672781 Test Loss: 0.3487092
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 39 cost time: 0.86177659034729
Epoch: 39, Steps: 64 | Train Loss: 0.1045521 Vali Loss: 0.2645521 Test Loss: 0.3467089
Validation loss decreased (0.265146 --> 0.264552).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 40 cost time: 0.8540000915527344
Epoch: 40, Steps: 64 | Train Loss: 0.1032523 Vali Loss: 0.2647268 Test Loss: 0.3492441
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 41 cost time: 0.8566150665283203
Epoch: 41, Steps: 64 | Train Loss: 0.1040660 Vali Loss: 0.2636693 Test Loss: 0.3454525
Validation loss decreased (0.264552 --> 0.263669).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 42 cost time: 0.8744189739227295
Epoch: 42, Steps: 64 | Train Loss: 0.1028875 Vali Loss: 0.2626550 Test Loss: 0.3459624
Validation loss decreased (0.263669 --> 0.262655).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 43 cost time: 0.8570404052734375
Epoch: 43, Steps: 64 | Train Loss: 0.1038526 Vali Loss: 0.2639095 Test Loss: 0.3462714
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 44 cost time: 0.8603982925415039
Epoch: 44, Steps: 64 | Train Loss: 0.1038663 Vali Loss: 0.2631571 Test Loss: 0.3456573
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 45 cost time: 0.8597068786621094
Epoch: 45, Steps: 64 | Train Loss: 0.1028415 Vali Loss: 0.2639147 Test Loss: 0.3434072
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 46 cost time: 0.8629989624023438
Epoch: 46, Steps: 64 | Train Loss: 0.1026425 Vali Loss: 0.2628320 Test Loss: 0.3435709
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 47 cost time: 0.8602855205535889
Epoch: 47, Steps: 64 | Train Loss: 0.1032245 Vali Loss: 0.2631721 Test Loss: 0.3449821
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 48 cost time: 0.8635282516479492
Epoch: 48, Steps: 64 | Train Loss: 0.1032072 Vali Loss: 0.2573975 Test Loss: 0.3426164
Validation loss decreased (0.262655 --> 0.257398).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 49 cost time: 0.8633487224578857
Epoch: 49, Steps: 64 | Train Loss: 0.1034354 Vali Loss: 0.2600348 Test Loss: 0.3432836
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 50 cost time: 0.8447418212890625
Epoch: 50, Steps: 64 | Train Loss: 0.1026422 Vali Loss: 0.2621481 Test Loss: 0.3456888
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 51 cost time: 0.8580005168914795
Epoch: 51, Steps: 64 | Train Loss: 0.1030621 Vali Loss: 0.2612267 Test Loss: 0.3426859
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 52 cost time: 0.8492405414581299
Epoch: 52, Steps: 64 | Train Loss: 0.1029938 Vali Loss: 0.2606270 Test Loss: 0.3442912
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 53 cost time: 0.9155488014221191
Epoch: 53, Steps: 64 | Train Loss: 0.1027967 Vali Loss: 0.2597858 Test Loss: 0.3406070
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 54 cost time: 0.8431568145751953
Epoch: 54, Steps: 64 | Train Loss: 0.1029696 Vali Loss: 0.2605604 Test Loss: 0.3422547
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 55 cost time: 0.8502395153045654
Epoch: 55, Steps: 64 | Train Loss: 0.1030686 Vali Loss: 0.2631206 Test Loss: 0.3407629
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 56 cost time: 0.852001428604126
Epoch: 56, Steps: 64 | Train Loss: 0.1024252 Vali Loss: 0.2628463 Test Loss: 0.3414586
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 57 cost time: 0.8656265735626221
Epoch: 57, Steps: 64 | Train Loss: 0.1028824 Vali Loss: 0.2599823 Test Loss: 0.3411726
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 58 cost time: 0.858405351638794
Epoch: 58, Steps: 64 | Train Loss: 0.1030822 Vali Loss: 0.2605496 Test Loss: 0.3417079
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 59 cost time: 0.858386754989624
Epoch: 59, Steps: 64 | Train Loss: 0.1024720 Vali Loss: 0.2622913 Test Loss: 0.3409956
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 60 cost time: 0.860724687576294
Epoch: 60, Steps: 64 | Train Loss: 0.1025305 Vali Loss: 0.2629304 Test Loss: 0.3422074
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.342616468667984, mae:0.41300010681152344, rse:0.268643856048584
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 1 cost time: 2.2099387645721436
Epoch: 1, Steps: 64 | Train Loss: 0.9053044 Vali Loss: 2.7362385 Test Loss: 4.8443398
Validation loss decreased (inf --> 2.736238).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 2 cost time: 0.830073356628418
Epoch: 2, Steps: 64 | Train Loss: 0.5817753 Vali Loss: 0.9394292 Test Loss: 1.5330130
Validation loss decreased (2.736238 --> 0.939429).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 3 cost time: 0.8253870010375977
Epoch: 3, Steps: 64 | Train Loss: 0.1988227 Vali Loss: 0.3090622 Test Loss: 0.3625992
Validation loss decreased (0.939429 --> 0.309062).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 4 cost time: 0.8264989852905273
Epoch: 4, Steps: 64 | Train Loss: 0.1217386 Vali Loss: 0.2666482 Test Loss: 0.3008868
Validation loss decreased (0.309062 --> 0.266648).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 5 cost time: 0.8160507678985596
Epoch: 5, Steps: 64 | Train Loss: 0.1123236 Vali Loss: 0.2593514 Test Loss: 0.3064504
Validation loss decreased (0.266648 --> 0.259351).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 6 cost time: 0.8244216442108154
Epoch: 6, Steps: 64 | Train Loss: 0.1083921 Vali Loss: 0.2568260 Test Loss: 0.3007961
Validation loss decreased (0.259351 --> 0.256826).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 7 cost time: 0.8246133327484131
Epoch: 7, Steps: 64 | Train Loss: 0.1048177 Vali Loss: 0.2493184 Test Loss: 0.3015466
Validation loss decreased (0.256826 --> 0.249318).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 8 cost time: 0.8223562240600586
Epoch: 8, Steps: 64 | Train Loss: 0.1016080 Vali Loss: 0.2496957 Test Loss: 0.2986258
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 9 cost time: 0.8273735046386719
Epoch: 9, Steps: 64 | Train Loss: 0.0991342 Vali Loss: 0.2422559 Test Loss: 0.2994671
Validation loss decreased (0.249318 --> 0.242256).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 10 cost time: 0.8297195434570312
Epoch: 10, Steps: 64 | Train Loss: 0.0976582 Vali Loss: 0.2421734 Test Loss: 0.3003966
Validation loss decreased (0.242256 --> 0.242173).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 11 cost time: 0.8244507312774658
Epoch: 11, Steps: 64 | Train Loss: 0.0960532 Vali Loss: 0.2391118 Test Loss: 0.3013077
Validation loss decreased (0.242173 --> 0.239112).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 12 cost time: 0.8336069583892822
Epoch: 12, Steps: 64 | Train Loss: 0.0938607 Vali Loss: 0.2387564 Test Loss: 0.2995655
Validation loss decreased (0.239112 --> 0.238756).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 13 cost time: 0.8273537158966064
Epoch: 13, Steps: 64 | Train Loss: 0.0933351 Vali Loss: 0.2334321 Test Loss: 0.3011359
Validation loss decreased (0.238756 --> 0.233432).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 14 cost time: 0.8303558826446533
Epoch: 14, Steps: 64 | Train Loss: 0.0927590 Vali Loss: 0.2307601 Test Loss: 0.2997285
Validation loss decreased (0.233432 --> 0.230760).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 15 cost time: 0.8279998302459717
Epoch: 15, Steps: 64 | Train Loss: 0.0914629 Vali Loss: 0.2304417 Test Loss: 0.3016700
Validation loss decreased (0.230760 --> 0.230442).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 16 cost time: 0.8409214019775391
Epoch: 16, Steps: 64 | Train Loss: 0.0909691 Vali Loss: 0.2299632 Test Loss: 0.3017584
Validation loss decreased (0.230442 --> 0.229963).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 17 cost time: 0.825340747833252
Epoch: 17, Steps: 64 | Train Loss: 0.0901794 Vali Loss: 0.2322029 Test Loss: 0.3023666
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 18 cost time: 0.8255114555358887
Epoch: 18, Steps: 64 | Train Loss: 0.0896336 Vali Loss: 0.2307004 Test Loss: 0.3023736
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 19 cost time: 0.8257877826690674
Epoch: 19, Steps: 64 | Train Loss: 0.0893245 Vali Loss: 0.2277383 Test Loss: 0.3046290
Validation loss decreased (0.229963 --> 0.227738).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 20 cost time: 0.8349997997283936
Epoch: 20, Steps: 64 | Train Loss: 0.0884455 Vali Loss: 0.2289821 Test Loss: 0.3038531
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 21 cost time: 0.8316192626953125
Epoch: 21, Steps: 64 | Train Loss: 0.0879244 Vali Loss: 0.2297098 Test Loss: 0.3051460
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 22 cost time: 0.8193874359130859
Epoch: 22, Steps: 64 | Train Loss: 0.0874316 Vali Loss: 0.2279778 Test Loss: 0.3043267
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 23 cost time: 0.8354644775390625
Epoch: 23, Steps: 64 | Train Loss: 0.0877756 Vali Loss: 0.2262537 Test Loss: 0.3049051
Validation loss decreased (0.227738 --> 0.226254).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 24 cost time: 0.8297097682952881
Epoch: 24, Steps: 64 | Train Loss: 0.0878110 Vali Loss: 0.2303817 Test Loss: 0.3046542
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 25 cost time: 0.8233981132507324
Epoch: 25, Steps: 64 | Train Loss: 0.0875080 Vali Loss: 0.2290899 Test Loss: 0.3044071
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 26 cost time: 0.8216342926025391
Epoch: 26, Steps: 64 | Train Loss: 0.0866569 Vali Loss: 0.2266305 Test Loss: 0.3064792
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 27 cost time: 0.8293416500091553
Epoch: 27, Steps: 64 | Train Loss: 0.0863080 Vali Loss: 0.2243148 Test Loss: 0.3057676
Validation loss decreased (0.226254 --> 0.224315).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 28 cost time: 0.8233916759490967
Epoch: 28, Steps: 64 | Train Loss: 0.0861581 Vali Loss: 0.2248835 Test Loss: 0.3065979
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 29 cost time: 0.8319973945617676
Epoch: 29, Steps: 64 | Train Loss: 0.0862438 Vali Loss: 0.2280424 Test Loss: 0.3069155
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 30 cost time: 0.82700514793396
Epoch: 30, Steps: 64 | Train Loss: 0.0858448 Vali Loss: 0.2238060 Test Loss: 0.3061089
Validation loss decreased (0.224315 --> 0.223806).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 31 cost time: 0.8280692100524902
Epoch: 31, Steps: 64 | Train Loss: 0.0854961 Vali Loss: 0.2235865 Test Loss: 0.3081062
Validation loss decreased (0.223806 --> 0.223586).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 32 cost time: 0.8284487724304199
Epoch: 32, Steps: 64 | Train Loss: 0.0855314 Vali Loss: 0.2240112 Test Loss: 0.3054115
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 33 cost time: 0.8267531394958496
Epoch: 33, Steps: 64 | Train Loss: 0.0858066 Vali Loss: 0.2269725 Test Loss: 0.3056301
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 34 cost time: 0.8269996643066406
Epoch: 34, Steps: 64 | Train Loss: 0.0855254 Vali Loss: 0.2250028 Test Loss: 0.3066901
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 35 cost time: 0.8339993953704834
Epoch: 35, Steps: 64 | Train Loss: 0.0859247 Vali Loss: 0.2260624 Test Loss: 0.3075034
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 36 cost time: 0.827439546585083
Epoch: 36, Steps: 64 | Train Loss: 0.0856056 Vali Loss: 0.2232806 Test Loss: 0.3089795
Validation loss decreased (0.223586 --> 0.223281).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 37 cost time: 0.8273642063140869
Epoch: 37, Steps: 64 | Train Loss: 0.0852557 Vali Loss: 0.2281876 Test Loss: 0.3060219
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 38 cost time: 0.8247718811035156
Epoch: 38, Steps: 64 | Train Loss: 0.0854088 Vali Loss: 0.2263439 Test Loss: 0.3068294
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 39 cost time: 0.836306095123291
Epoch: 39, Steps: 64 | Train Loss: 0.0855357 Vali Loss: 0.2276021 Test Loss: 0.3067238
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 40 cost time: 0.8326253890991211
Epoch: 40, Steps: 64 | Train Loss: 0.0848354 Vali Loss: 0.2252371 Test Loss: 0.3079371
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 41 cost time: 0.8264212608337402
Epoch: 41, Steps: 64 | Train Loss: 0.0854777 Vali Loss: 0.2236209 Test Loss: 0.3076490
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 42 cost time: 0.8329997062683105
Epoch: 42, Steps: 64 | Train Loss: 0.0849775 Vali Loss: 0.2278409 Test Loss: 0.3074988
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 43 cost time: 0.8342390060424805
Epoch: 43, Steps: 64 | Train Loss: 0.0852001 Vali Loss: 0.2218198 Test Loss: 0.3084050
Validation loss decreased (0.223281 --> 0.221820).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 44 cost time: 0.8274264335632324
Epoch: 44, Steps: 64 | Train Loss: 0.0849389 Vali Loss: 0.2248054 Test Loss: 0.3067825
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 45 cost time: 0.8234381675720215
Epoch: 45, Steps: 64 | Train Loss: 0.0845976 Vali Loss: 0.2225795 Test Loss: 0.3071538
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 46 cost time: 0.8350856304168701
Epoch: 46, Steps: 64 | Train Loss: 0.0852101 Vali Loss: 0.2224513 Test Loss: 0.3072678
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 47 cost time: 0.8217251300811768
Epoch: 47, Steps: 64 | Train Loss: 0.0849992 Vali Loss: 0.2236335 Test Loss: 0.3070816
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 48 cost time: 0.8259999752044678
Epoch: 48, Steps: 64 | Train Loss: 0.0850932 Vali Loss: 0.2246759 Test Loss: 0.3088042
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 49 cost time: 0.8276150226593018
Epoch: 49, Steps: 64 | Train Loss: 0.0843755 Vali Loss: 0.2240904 Test Loss: 0.3086808
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 50 cost time: 0.8283326625823975
Epoch: 50, Steps: 64 | Train Loss: 0.0842355 Vali Loss: 0.2229734 Test Loss: 0.3079655
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 51 cost time: 0.8293676376342773
Epoch: 51, Steps: 64 | Train Loss: 0.0849943 Vali Loss: 0.2260237 Test Loss: 0.3079797
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 52 cost time: 0.8287537097930908
Epoch: 52, Steps: 64 | Train Loss: 0.0855081 Vali Loss: 0.2211807 Test Loss: 0.3098280
Validation loss decreased (0.221820 --> 0.221181).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 53 cost time: 0.8200016021728516
Epoch: 53, Steps: 64 | Train Loss: 0.0847124 Vali Loss: 0.2233283 Test Loss: 0.3092159
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 54 cost time: 0.8172225952148438
Epoch: 54, Steps: 64 | Train Loss: 0.0855980 Vali Loss: 0.2269320 Test Loss: 0.3073606
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 55 cost time: 0.8242137432098389
Epoch: 55, Steps: 64 | Train Loss: 0.0849816 Vali Loss: 0.2273593 Test Loss: 0.3084203
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 56 cost time: 0.8227448463439941
Epoch: 56, Steps: 64 | Train Loss: 0.0850387 Vali Loss: 0.2238372 Test Loss: 0.3084637
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 57 cost time: 0.8270018100738525
Epoch: 57, Steps: 64 | Train Loss: 0.0849141 Vali Loss: 0.2259127 Test Loss: 0.3076572
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 58 cost time: 0.8213179111480713
Epoch: 58, Steps: 64 | Train Loss: 0.0844307 Vali Loss: 0.2239854 Test Loss: 0.3086955
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 59 cost time: 0.8443658351898193
Epoch: 59, Steps: 64 | Train Loss: 0.0849623 Vali Loss: 0.2248692 Test Loss: 0.3081941
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 60 cost time: 0.8483083248138428
Epoch: 60, Steps: 64 | Train Loss: 0.0848330 Vali Loss: 0.2250863 Test Loss: 0.3084512
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.30982792377471924, mae:0.3876759111881256, rse:0.2554659843444824
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05678749084472656 GB
Epoch: 1 cost time: 2.2312231063842773
Epoch: 1, Steps: 64 | Train Loss: 0.8045607 Vali Loss: 2.4832618 Test Loss: 4.3500714
Validation loss decreased (inf --> 2.483262).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 2 cost time: 0.8185107707977295
Epoch: 2, Steps: 64 | Train Loss: 0.4172478 Vali Loss: 0.3163224 Test Loss: 0.3480834
Validation loss decreased (2.483262 --> 0.316322).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 3 cost time: 0.8476104736328125
Epoch: 3, Steps: 64 | Train Loss: 0.1303749 Vali Loss: 0.2843081 Test Loss: 0.3382883
Validation loss decreased (0.316322 --> 0.284308).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 4 cost time: 0.841362476348877
Epoch: 4, Steps: 64 | Train Loss: 0.1134428 Vali Loss: 0.2584811 Test Loss: 0.2965264
Validation loss decreased (0.284308 --> 0.258481).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 5 cost time: 0.8434348106384277
Epoch: 5, Steps: 64 | Train Loss: 0.1060100 Vali Loss: 0.2555964 Test Loss: 0.3008589
Validation loss decreased (0.258481 --> 0.255596).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 6 cost time: 0.8397138118743896
Epoch: 6, Steps: 64 | Train Loss: 0.1023617 Vali Loss: 0.2487251 Test Loss: 0.2986932
Validation loss decreased (0.255596 --> 0.248725).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 7 cost time: 0.8450005054473877
Epoch: 7, Steps: 64 | Train Loss: 0.0992414 Vali Loss: 0.2420752 Test Loss: 0.3000034
Validation loss decreased (0.248725 --> 0.242075).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 8 cost time: 0.8434767723083496
Epoch: 8, Steps: 64 | Train Loss: 0.0966322 Vali Loss: 0.2384428 Test Loss: 0.2971202
Validation loss decreased (0.242075 --> 0.238443).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 9 cost time: 0.8306643962860107
Epoch: 9, Steps: 64 | Train Loss: 0.0955015 Vali Loss: 0.2376926 Test Loss: 0.3000588
Validation loss decreased (0.238443 --> 0.237693).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 10 cost time: 0.8383781909942627
Epoch: 10, Steps: 64 | Train Loss: 0.0938430 Vali Loss: 0.2385416 Test Loss: 0.2977783
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 11 cost time: 0.8407173156738281
Epoch: 11, Steps: 64 | Train Loss: 0.0911919 Vali Loss: 0.2325366 Test Loss: 0.2992517
Validation loss decreased (0.237693 --> 0.232537).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 12 cost time: 0.8510000705718994
Epoch: 12, Steps: 64 | Train Loss: 0.0910533 Vali Loss: 0.2316191 Test Loss: 0.3013419
Validation loss decreased (0.232537 --> 0.231619).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 13 cost time: 0.8401203155517578
Epoch: 13, Steps: 64 | Train Loss: 0.0897300 Vali Loss: 0.2308571 Test Loss: 0.3020464
Validation loss decreased (0.231619 --> 0.230857).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 14 cost time: 0.845374584197998
Epoch: 14, Steps: 64 | Train Loss: 0.0892271 Vali Loss: 0.2319565 Test Loss: 0.3013695
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 15 cost time: 0.8564803600311279
Epoch: 15, Steps: 64 | Train Loss: 0.0880427 Vali Loss: 0.2289404 Test Loss: 0.3031877
Validation loss decreased (0.230857 --> 0.228940).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 16 cost time: 0.8612239360809326
Epoch: 16, Steps: 64 | Train Loss: 0.0870131 Vali Loss: 0.2273810 Test Loss: 0.3016728
Validation loss decreased (0.228940 --> 0.227381).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 17 cost time: 0.9217848777770996
Epoch: 17, Steps: 64 | Train Loss: 0.0875446 Vali Loss: 0.2269432 Test Loss: 0.3037837
Validation loss decreased (0.227381 --> 0.226943).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 18 cost time: 0.8670015335083008
Epoch: 18, Steps: 64 | Train Loss: 0.0863525 Vali Loss: 0.2225779 Test Loss: 0.3054568
Validation loss decreased (0.226943 --> 0.222578).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 19 cost time: 0.8405015468597412
Epoch: 19, Steps: 64 | Train Loss: 0.0860546 Vali Loss: 0.2243286 Test Loss: 0.3052103
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 20 cost time: 0.8513975143432617
Epoch: 20, Steps: 64 | Train Loss: 0.0857657 Vali Loss: 0.2232587 Test Loss: 0.3045571
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 21 cost time: 0.8454232215881348
Epoch: 21, Steps: 64 | Train Loss: 0.0850141 Vali Loss: 0.2240901 Test Loss: 0.3050996
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 22 cost time: 0.842754602432251
Epoch: 22, Steps: 64 | Train Loss: 0.0851174 Vali Loss: 0.2215538 Test Loss: 0.3068286
Validation loss decreased (0.222578 --> 0.221554).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 23 cost time: 0.8393945693969727
Epoch: 23, Steps: 64 | Train Loss: 0.0843072 Vali Loss: 0.2263687 Test Loss: 0.3056596
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 24 cost time: 0.8606250286102295
Epoch: 24, Steps: 64 | Train Loss: 0.0847457 Vali Loss: 0.2207234 Test Loss: 0.3071610
Validation loss decreased (0.221554 --> 0.220723).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 25 cost time: 0.8413455486297607
Epoch: 25, Steps: 64 | Train Loss: 0.0841728 Vali Loss: 0.2251161 Test Loss: 0.3068015
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 26 cost time: 0.8393542766571045
Epoch: 26, Steps: 64 | Train Loss: 0.0845491 Vali Loss: 0.2259329 Test Loss: 0.3070675
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 27 cost time: 0.8508608341217041
Epoch: 27, Steps: 64 | Train Loss: 0.0843163 Vali Loss: 0.2219079 Test Loss: 0.3076968
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 28 cost time: 0.8279998302459717
Epoch: 28, Steps: 64 | Train Loss: 0.0840447 Vali Loss: 0.2240992 Test Loss: 0.3075544
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 29 cost time: 0.8466296195983887
Epoch: 29, Steps: 64 | Train Loss: 0.0835749 Vali Loss: 0.2240099 Test Loss: 0.3075861
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 30 cost time: 0.8353509902954102
Epoch: 30, Steps: 64 | Train Loss: 0.0838002 Vali Loss: 0.2230050 Test Loss: 0.3069235
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 31 cost time: 0.8483781814575195
Epoch: 31, Steps: 64 | Train Loss: 0.0841672 Vali Loss: 0.2229969 Test Loss: 0.3087581
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 32 cost time: 0.8413755893707275
Epoch: 32, Steps: 64 | Train Loss: 0.0830792 Vali Loss: 0.2238425 Test Loss: 0.3087236
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 33 cost time: 0.8449997901916504
Epoch: 33, Steps: 64 | Train Loss: 0.0828996 Vali Loss: 0.2221730 Test Loss: 0.3087395
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 34 cost time: 0.8446216583251953
Epoch: 34, Steps: 64 | Train Loss: 0.0827557 Vali Loss: 0.2230321 Test Loss: 0.3088135
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 35 cost time: 0.8338167667388916
Epoch: 35, Steps: 64 | Train Loss: 0.0830045 Vali Loss: 0.2247427 Test Loss: 0.3083911
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 36 cost time: 0.8384137153625488
Epoch: 36, Steps: 64 | Train Loss: 0.0826323 Vali Loss: 0.2221987 Test Loss: 0.3103082
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 37 cost time: 0.8412301540374756
Epoch: 37, Steps: 64 | Train Loss: 0.0823790 Vali Loss: 0.2222817 Test Loss: 0.3088285
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 38 cost time: 0.8424496650695801
Epoch: 38, Steps: 64 | Train Loss: 0.0829983 Vali Loss: 0.2204610 Test Loss: 0.3098209
Validation loss decreased (0.220723 --> 0.220461).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 39 cost time: 0.8556313514709473
Epoch: 39, Steps: 64 | Train Loss: 0.0819923 Vali Loss: 0.2204876 Test Loss: 0.3097428
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 40 cost time: 0.8433804512023926
Epoch: 40, Steps: 64 | Train Loss: 0.0821635 Vali Loss: 0.2237037 Test Loss: 0.3097307
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 41 cost time: 0.8434834480285645
Epoch: 41, Steps: 64 | Train Loss: 0.0825136 Vali Loss: 0.2216131 Test Loss: 0.3092794
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 42 cost time: 0.8348443508148193
Epoch: 42, Steps: 64 | Train Loss: 0.0830026 Vali Loss: 0.2226008 Test Loss: 0.3103294
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 43 cost time: 0.8450000286102295
Epoch: 43, Steps: 64 | Train Loss: 0.0829138 Vali Loss: 0.2202988 Test Loss: 0.3098269
Validation loss decreased (0.220461 --> 0.220299).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 44 cost time: 0.843616247177124
Epoch: 44, Steps: 64 | Train Loss: 0.0825652 Vali Loss: 0.2251998 Test Loss: 0.3100283
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 45 cost time: 0.8404097557067871
Epoch: 45, Steps: 64 | Train Loss: 0.0819864 Vali Loss: 0.2242044 Test Loss: 0.3098559
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 46 cost time: 0.8553988933563232
Epoch: 46, Steps: 64 | Train Loss: 0.0826618 Vali Loss: 0.2227057 Test Loss: 0.3092380
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 47 cost time: 0.8408358097076416
Epoch: 47, Steps: 64 | Train Loss: 0.0827533 Vali Loss: 0.2228377 Test Loss: 0.3108658
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 48 cost time: 0.8359994888305664
Epoch: 48, Steps: 64 | Train Loss: 0.0828003 Vali Loss: 0.2227288 Test Loss: 0.3100712
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 49 cost time: 0.8426253795623779
Epoch: 49, Steps: 64 | Train Loss: 0.0826182 Vali Loss: 0.2205977 Test Loss: 0.3104700
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 50 cost time: 0.8364284038543701
Epoch: 50, Steps: 64 | Train Loss: 0.0829530 Vali Loss: 0.2230736 Test Loss: 0.3097918
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 51 cost time: 0.823261022567749
Epoch: 51, Steps: 64 | Train Loss: 0.0827352 Vali Loss: 0.2232689 Test Loss: 0.3099814
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 52 cost time: 0.840843915939331
Epoch: 52, Steps: 64 | Train Loss: 0.0824809 Vali Loss: 0.2224214 Test Loss: 0.3097510
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 53 cost time: 0.8409998416900635
Epoch: 53, Steps: 64 | Train Loss: 0.0817595 Vali Loss: 0.2202521 Test Loss: 0.3107724
Validation loss decreased (0.220299 --> 0.220252).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 54 cost time: 0.8456161022186279
Epoch: 54, Steps: 64 | Train Loss: 0.0823899 Vali Loss: 0.2228221 Test Loss: 0.3102604
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 55 cost time: 0.8420069217681885
Epoch: 55, Steps: 64 | Train Loss: 0.0826750 Vali Loss: 0.2256533 Test Loss: 0.3106364
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 56 cost time: 0.8414111137390137
Epoch: 56, Steps: 64 | Train Loss: 0.0821120 Vali Loss: 0.2213778 Test Loss: 0.3110589
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 57 cost time: 0.8462035655975342
Epoch: 57, Steps: 64 | Train Loss: 0.0822314 Vali Loss: 0.2214216 Test Loss: 0.3096379
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 58 cost time: 0.798367977142334
Epoch: 58, Steps: 64 | Train Loss: 0.0825879 Vali Loss: 0.2196689 Test Loss: 0.3113286
Validation loss decreased (0.220252 --> 0.219669).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 59 cost time: 0.8384261131286621
Epoch: 59, Steps: 64 | Train Loss: 0.0825363 Vali Loss: 0.2196222 Test Loss: 0.3103667
Validation loss decreased (0.219669 --> 0.219622).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 60 cost time: 0.8465061187744141
Epoch: 60, Steps: 64 | Train Loss: 0.0821380 Vali Loss: 0.2207257 Test Loss: 0.3086274
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.3103666603565216, mae:0.38945505023002625, rse:0.25568798184394836
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04966163635253906 GB
Epoch: 1 cost time: 2.2277798652648926
Epoch: 1, Steps: 64 | Train Loss: 0.9300145 Vali Loss: 2.7769787 Test Loss: 4.8515410
Validation loss decreased (inf --> 2.776979).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 2 cost time: 0.8637638092041016
Epoch: 2, Steps: 64 | Train Loss: 0.8062327 Vali Loss: 2.1085773 Test Loss: 3.6093495
Validation loss decreased (2.776979 --> 2.108577).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 3 cost time: 0.8670001029968262
Epoch: 3, Steps: 64 | Train Loss: 0.6166464 Vali Loss: 1.6120394 Test Loss: 2.7034717
Validation loss decreased (2.108577 --> 1.612039).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 4 cost time: 0.8626132011413574
Epoch: 4, Steps: 64 | Train Loss: 0.4739756 Vali Loss: 1.2314682 Test Loss: 2.0111663
Validation loss decreased (1.612039 --> 1.231468).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 5 cost time: 0.8616349697113037
Epoch: 5, Steps: 64 | Train Loss: 0.3692417 Vali Loss: 0.9816728 Test Loss: 1.5728953
Validation loss decreased (1.231468 --> 0.981673).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 6 cost time: 0.8583343029022217
Epoch: 6, Steps: 64 | Train Loss: 0.2976257 Vali Loss: 0.8026981 Test Loss: 1.2513999
Validation loss decreased (0.981673 --> 0.802698).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 7 cost time: 0.857924222946167
Epoch: 7, Steps: 64 | Train Loss: 0.2471892 Vali Loss: 0.6751598 Test Loss: 1.0428985
Validation loss decreased (0.802698 --> 0.675160).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 8 cost time: 0.8559987545013428
Epoch: 8, Steps: 64 | Train Loss: 0.2119203 Vali Loss: 0.5776593 Test Loss: 0.8687815
Validation loss decreased (0.675160 --> 0.577659).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 9 cost time: 0.8446168899536133
Epoch: 9, Steps: 64 | Train Loss: 0.1865853 Vali Loss: 0.5058292 Test Loss: 0.7516990
Validation loss decreased (0.577659 --> 0.505829).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 10 cost time: 0.853370189666748
Epoch: 10, Steps: 64 | Train Loss: 0.1685755 Vali Loss: 0.4546086 Test Loss: 0.6620017
Validation loss decreased (0.505829 --> 0.454609).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 11 cost time: 0.8604836463928223
Epoch: 11, Steps: 64 | Train Loss: 0.1545315 Vali Loss: 0.4110819 Test Loss: 0.5953139
Validation loss decreased (0.454609 --> 0.411082).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 12 cost time: 0.8745830059051514
Epoch: 12, Steps: 64 | Train Loss: 0.1448736 Vali Loss: 0.3832522 Test Loss: 0.5454273
Validation loss decreased (0.411082 --> 0.383252).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 13 cost time: 0.8637332916259766
Epoch: 13, Steps: 64 | Train Loss: 0.1378335 Vali Loss: 0.3622650 Test Loss: 0.5064057
Validation loss decreased (0.383252 --> 0.362265).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 14 cost time: 0.8584043979644775
Epoch: 14, Steps: 64 | Train Loss: 0.1315727 Vali Loss: 0.3408825 Test Loss: 0.4749343
Validation loss decreased (0.362265 --> 0.340882).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 15 cost time: 0.8566246032714844
Epoch: 15, Steps: 64 | Train Loss: 0.1267180 Vali Loss: 0.3293000 Test Loss: 0.4461654
Validation loss decreased (0.340882 --> 0.329300).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 16 cost time: 0.8623828887939453
Epoch: 16, Steps: 64 | Train Loss: 0.1229947 Vali Loss: 0.3161744 Test Loss: 0.4299330
Validation loss decreased (0.329300 --> 0.316174).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 17 cost time: 0.8624179363250732
Epoch: 17, Steps: 64 | Train Loss: 0.1200420 Vali Loss: 0.3088272 Test Loss: 0.4145992
Validation loss decreased (0.316174 --> 0.308827).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 18 cost time: 0.8598036766052246
Epoch: 18, Steps: 64 | Train Loss: 0.1173944 Vali Loss: 0.3046018 Test Loss: 0.4007735
Validation loss decreased (0.308827 --> 0.304602).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 19 cost time: 0.8603866100311279
Epoch: 19, Steps: 64 | Train Loss: 0.1152955 Vali Loss: 0.2964682 Test Loss: 0.3907939
Validation loss decreased (0.304602 --> 0.296468).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 20 cost time: 0.8676271438598633
Epoch: 20, Steps: 64 | Train Loss: 0.1135857 Vali Loss: 0.2862313 Test Loss: 0.3814902
Validation loss decreased (0.296468 --> 0.286231).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 21 cost time: 0.8644134998321533
Epoch: 21, Steps: 64 | Train Loss: 0.1120296 Vali Loss: 0.2864708 Test Loss: 0.3754905
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 22 cost time: 0.8622078895568848
Epoch: 22, Steps: 64 | Train Loss: 0.1105943 Vali Loss: 0.2757933 Test Loss: 0.3672126
Validation loss decreased (0.286231 --> 0.275793).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 23 cost time: 0.8748631477355957
Epoch: 23, Steps: 64 | Train Loss: 0.1110000 Vali Loss: 0.2786941 Test Loss: 0.3599494
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 24 cost time: 0.8320000171661377
Epoch: 24, Steps: 64 | Train Loss: 0.1098259 Vali Loss: 0.2767819 Test Loss: 0.3566477
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 25 cost time: 0.8713443279266357
Epoch: 25, Steps: 64 | Train Loss: 0.1083883 Vali Loss: 0.2739820 Test Loss: 0.3558798
Validation loss decreased (0.275793 --> 0.273982).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 26 cost time: 0.830244779586792
Epoch: 26, Steps: 64 | Train Loss: 0.1071745 Vali Loss: 0.2731038 Test Loss: 0.3494788
Validation loss decreased (0.273982 --> 0.273104).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 27 cost time: 0.849473237991333
Epoch: 27, Steps: 64 | Train Loss: 0.1065467 Vali Loss: 0.2679194 Test Loss: 0.3448563
Validation loss decreased (0.273104 --> 0.267919).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 28 cost time: 0.8267436027526855
Epoch: 28, Steps: 64 | Train Loss: 0.1066574 Vali Loss: 0.2665886 Test Loss: 0.3455339
Validation loss decreased (0.267919 --> 0.266589).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 29 cost time: 0.9297587871551514
Epoch: 29, Steps: 64 | Train Loss: 0.1062868 Vali Loss: 0.2659211 Test Loss: 0.3401618
Validation loss decreased (0.266589 --> 0.265921).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 30 cost time: 0.9320025444030762
Epoch: 30, Steps: 64 | Train Loss: 0.1059159 Vali Loss: 0.2618009 Test Loss: 0.3402956
Validation loss decreased (0.265921 --> 0.261801).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 31 cost time: 0.8656220436096191
Epoch: 31, Steps: 64 | Train Loss: 0.1056922 Vali Loss: 0.2650301 Test Loss: 0.3388767
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 32 cost time: 0.8622317314147949
Epoch: 32, Steps: 64 | Train Loss: 0.1054221 Vali Loss: 0.2596969 Test Loss: 0.3366548
Validation loss decreased (0.261801 --> 0.259697).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 33 cost time: 0.8553564548492432
Epoch: 33, Steps: 64 | Train Loss: 0.1051740 Vali Loss: 0.2608918 Test Loss: 0.3337242
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 34 cost time: 0.8635132312774658
Epoch: 34, Steps: 64 | Train Loss: 0.1050439 Vali Loss: 0.2622043 Test Loss: 0.3340848
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 35 cost time: 0.9278101921081543
Epoch: 35, Steps: 64 | Train Loss: 0.1042820 Vali Loss: 0.2578003 Test Loss: 0.3307619
Validation loss decreased (0.259697 --> 0.257800).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 36 cost time: 0.9230005741119385
Epoch: 36, Steps: 64 | Train Loss: 0.1042789 Vali Loss: 0.2572668 Test Loss: 0.3314988
Validation loss decreased (0.257800 --> 0.257267).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 37 cost time: 0.9282345771789551
Epoch: 37, Steps: 64 | Train Loss: 0.1042282 Vali Loss: 0.2602854 Test Loss: 0.3308490
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 38 cost time: 0.8696327209472656
Epoch: 38, Steps: 64 | Train Loss: 0.1038977 Vali Loss: 0.2582440 Test Loss: 0.3277342
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 39 cost time: 0.8644342422485352
Epoch: 39, Steps: 64 | Train Loss: 0.1041664 Vali Loss: 0.2593617 Test Loss: 0.3270210
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 40 cost time: 0.8583886623382568
Epoch: 40, Steps: 64 | Train Loss: 0.1040289 Vali Loss: 0.2578809 Test Loss: 0.3294456
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 41 cost time: 0.8763828277587891
Epoch: 41, Steps: 64 | Train Loss: 0.1037826 Vali Loss: 0.2568745 Test Loss: 0.3267854
Validation loss decreased (0.257267 --> 0.256875).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 42 cost time: 0.931999921798706
Epoch: 42, Steps: 64 | Train Loss: 0.1037213 Vali Loss: 0.2563838 Test Loss: 0.3273452
Validation loss decreased (0.256875 --> 0.256384).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 43 cost time: 0.9299979209899902
Epoch: 43, Steps: 64 | Train Loss: 0.1038168 Vali Loss: 0.2548236 Test Loss: 0.3243327
Validation loss decreased (0.256384 --> 0.254824).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 44 cost time: 0.9320344924926758
Epoch: 44, Steps: 64 | Train Loss: 0.1031501 Vali Loss: 0.2545302 Test Loss: 0.3242511
Validation loss decreased (0.254824 --> 0.254530).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 45 cost time: 0.8712003231048584
Epoch: 45, Steps: 64 | Train Loss: 0.1037256 Vali Loss: 0.2563266 Test Loss: 0.3260722
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 46 cost time: 0.8574442863464355
Epoch: 46, Steps: 64 | Train Loss: 0.1031164 Vali Loss: 0.2551627 Test Loss: 0.3257133
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 47 cost time: 0.8519725799560547
Epoch: 47, Steps: 64 | Train Loss: 0.1026526 Vali Loss: 0.2559356 Test Loss: 0.3246728
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 48 cost time: 0.8748149871826172
Epoch: 48, Steps: 64 | Train Loss: 0.1034617 Vali Loss: 0.2541357 Test Loss: 0.3235267
Validation loss decreased (0.254530 --> 0.254136).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 49 cost time: 0.8629999160766602
Epoch: 49, Steps: 64 | Train Loss: 0.1032711 Vali Loss: 0.2535747 Test Loss: 0.3237954
Validation loss decreased (0.254136 --> 0.253575).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 50 cost time: 0.8662512302398682
Epoch: 50, Steps: 64 | Train Loss: 0.1028639 Vali Loss: 0.2544031 Test Loss: 0.3235971
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 51 cost time: 0.8523766994476318
Epoch: 51, Steps: 64 | Train Loss: 0.1029893 Vali Loss: 0.2525359 Test Loss: 0.3220008
Validation loss decreased (0.253575 --> 0.252536).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 52 cost time: 0.8673746585845947
Epoch: 52, Steps: 64 | Train Loss: 0.1030780 Vali Loss: 0.2565667 Test Loss: 0.3253151
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 53 cost time: 0.859234094619751
Epoch: 53, Steps: 64 | Train Loss: 0.1028175 Vali Loss: 0.2539582 Test Loss: 0.3215855
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 54 cost time: 0.8537983894348145
Epoch: 54, Steps: 64 | Train Loss: 0.1029844 Vali Loss: 0.2535988 Test Loss: 0.3225417
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 55 cost time: 0.8566124439239502
Epoch: 55, Steps: 64 | Train Loss: 0.1034006 Vali Loss: 0.2525190 Test Loss: 0.3241171
Validation loss decreased (0.252536 --> 0.252519).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 56 cost time: 0.858342170715332
Epoch: 56, Steps: 64 | Train Loss: 0.1030251 Vali Loss: 0.2546925 Test Loss: 0.3246745
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 57 cost time: 0.8603692054748535
Epoch: 57, Steps: 64 | Train Loss: 0.1031442 Vali Loss: 0.2543615 Test Loss: 0.3192679
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 58 cost time: 0.8627455234527588
Epoch: 58, Steps: 64 | Train Loss: 0.1026126 Vali Loss: 0.2519601 Test Loss: 0.3211835
Validation loss decreased (0.252519 --> 0.251960).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 59 cost time: 0.871537446975708
Epoch: 59, Steps: 64 | Train Loss: 0.1022106 Vali Loss: 0.2519917 Test Loss: 0.3195964
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 60 cost time: 0.8566293716430664
Epoch: 60, Steps: 64 | Train Loss: 0.1030530 Vali Loss: 0.2535292 Test Loss: 0.3219243
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.3211835026741028, mae:0.3900490701198578, rse:0.2601054310798645
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 1 cost time: 2.1859982013702393
Epoch: 1, Steps: 64 | Train Loss: 0.8469447 Vali Loss: 2.5867369 Test Loss: 4.5589380
Validation loss decreased (inf --> 2.586737).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 2 cost time: 0.8329765796661377
Epoch: 2, Steps: 64 | Train Loss: 0.5333431 Vali Loss: 0.6791639 Test Loss: 1.0092818
Validation loss decreased (2.586737 --> 0.679164).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 3 cost time: 0.8367834091186523
Epoch: 3, Steps: 64 | Train Loss: 0.1534055 Vali Loss: 0.2702110 Test Loss: 0.2838692
Validation loss decreased (0.679164 --> 0.270211).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 4 cost time: 0.8328433036804199
Epoch: 4, Steps: 64 | Train Loss: 0.1133059 Vali Loss: 0.2677738 Test Loss: 0.3013823
Validation loss decreased (0.270211 --> 0.267774).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 5 cost time: 0.8346371650695801
Epoch: 5, Steps: 64 | Train Loss: 0.1065801 Vali Loss: 0.2596202 Test Loss: 0.2974919
Validation loss decreased (0.267774 --> 0.259620).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 6 cost time: 0.8314592838287354
Epoch: 6, Steps: 64 | Train Loss: 0.1029568 Vali Loss: 0.2563136 Test Loss: 0.2994836
Validation loss decreased (0.259620 --> 0.256314).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 7 cost time: 0.8393383026123047
Epoch: 7, Steps: 64 | Train Loss: 0.1001656 Vali Loss: 0.2456750 Test Loss: 0.3005093
Validation loss decreased (0.256314 --> 0.245675).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 8 cost time: 0.8247463703155518
Epoch: 8, Steps: 64 | Train Loss: 0.0982358 Vali Loss: 0.2436285 Test Loss: 0.2990359
Validation loss decreased (0.245675 --> 0.243628).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 9 cost time: 0.8314008712768555
Epoch: 9, Steps: 64 | Train Loss: 0.0966383 Vali Loss: 0.2442822 Test Loss: 0.2989775
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 10 cost time: 0.8386125564575195
Epoch: 10, Steps: 64 | Train Loss: 0.0952631 Vali Loss: 0.2416954 Test Loss: 0.2988864
Validation loss decreased (0.243628 --> 0.241695).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 11 cost time: 0.8251957893371582
Epoch: 11, Steps: 64 | Train Loss: 0.0943417 Vali Loss: 0.2407649 Test Loss: 0.3007111
Validation loss decreased (0.241695 --> 0.240765).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 12 cost time: 0.8433272838592529
Epoch: 12, Steps: 64 | Train Loss: 0.0923062 Vali Loss: 0.2368597 Test Loss: 0.3021786
Validation loss decreased (0.240765 --> 0.236860).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 13 cost time: 0.8871791362762451
Epoch: 13, Steps: 64 | Train Loss: 0.0916976 Vali Loss: 0.2378141 Test Loss: 0.2975903
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 14 cost time: 0.8701541423797607
Epoch: 14, Steps: 64 | Train Loss: 0.0912020 Vali Loss: 0.2360636 Test Loss: 0.3013200
Validation loss decreased (0.236860 --> 0.236064).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 15 cost time: 0.8320000171661377
Epoch: 15, Steps: 64 | Train Loss: 0.0902866 Vali Loss: 0.2322337 Test Loss: 0.2996291
Validation loss decreased (0.236064 --> 0.232234).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 16 cost time: 0.8330833911895752
Epoch: 16, Steps: 64 | Train Loss: 0.0903323 Vali Loss: 0.2345510 Test Loss: 0.2986375
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 17 cost time: 0.8357899188995361
Epoch: 17, Steps: 64 | Train Loss: 0.0894115 Vali Loss: 0.2361098 Test Loss: 0.2999252
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 18 cost time: 0.8424160480499268
Epoch: 18, Steps: 64 | Train Loss: 0.0882373 Vali Loss: 0.2319638 Test Loss: 0.3027133
Validation loss decreased (0.232234 --> 0.231964).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 19 cost time: 0.8299999237060547
Epoch: 19, Steps: 64 | Train Loss: 0.0875346 Vali Loss: 0.2315752 Test Loss: 0.3001876
Validation loss decreased (0.231964 --> 0.231575).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 20 cost time: 0.8340001106262207
Epoch: 20, Steps: 64 | Train Loss: 0.0875500 Vali Loss: 0.2309269 Test Loss: 0.3005240
Validation loss decreased (0.231575 --> 0.230927).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 21 cost time: 0.8329999446868896
Epoch: 21, Steps: 64 | Train Loss: 0.0875905 Vali Loss: 0.2303060 Test Loss: 0.3014350
Validation loss decreased (0.230927 --> 0.230306).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 22 cost time: 0.8540027141571045
Epoch: 22, Steps: 64 | Train Loss: 0.0868906 Vali Loss: 0.2288399 Test Loss: 0.3016416
Validation loss decreased (0.230306 --> 0.228840).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 23 cost time: 0.834630012512207
Epoch: 23, Steps: 64 | Train Loss: 0.0867777 Vali Loss: 0.2265166 Test Loss: 0.3011384
Validation loss decreased (0.228840 --> 0.226517).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 24 cost time: 0.8380017280578613
Epoch: 24, Steps: 64 | Train Loss: 0.0862564 Vali Loss: 0.2265750 Test Loss: 0.3035767
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 25 cost time: 0.8426375389099121
Epoch: 25, Steps: 64 | Train Loss: 0.0864256 Vali Loss: 0.2273590 Test Loss: 0.3033093
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 26 cost time: 0.8239998817443848
Epoch: 26, Steps: 64 | Train Loss: 0.0859101 Vali Loss: 0.2294112 Test Loss: 0.3026971
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 27 cost time: 0.8374691009521484
Epoch: 27, Steps: 64 | Train Loss: 0.0854425 Vali Loss: 0.2247306 Test Loss: 0.3022429
Validation loss decreased (0.226517 --> 0.224731).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 28 cost time: 0.8320002555847168
Epoch: 28, Steps: 64 | Train Loss: 0.0853328 Vali Loss: 0.2250915 Test Loss: 0.3020239
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 29 cost time: 0.8446125984191895
Epoch: 29, Steps: 64 | Train Loss: 0.0852305 Vali Loss: 0.2266898 Test Loss: 0.3025889
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 30 cost time: 0.8356413841247559
Epoch: 30, Steps: 64 | Train Loss: 0.0847061 Vali Loss: 0.2269574 Test Loss: 0.3023310
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 31 cost time: 0.8446741104125977
Epoch: 31, Steps: 64 | Train Loss: 0.0850871 Vali Loss: 0.2257287 Test Loss: 0.3028174
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 32 cost time: 0.8426170349121094
Epoch: 32, Steps: 64 | Train Loss: 0.0844483 Vali Loss: 0.2249437 Test Loss: 0.3033520
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 33 cost time: 0.8273718357086182
Epoch: 33, Steps: 64 | Train Loss: 0.0843940 Vali Loss: 0.2254037 Test Loss: 0.3043709
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 34 cost time: 0.8320000171661377
Epoch: 34, Steps: 64 | Train Loss: 0.0845211 Vali Loss: 0.2238111 Test Loss: 0.3018208
Validation loss decreased (0.224731 --> 0.223811).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 35 cost time: 0.8316285610198975
Epoch: 35, Steps: 64 | Train Loss: 0.0844778 Vali Loss: 0.2249085 Test Loss: 0.3031840
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 36 cost time: 0.8303806781768799
Epoch: 36, Steps: 64 | Train Loss: 0.0843576 Vali Loss: 0.2240169 Test Loss: 0.3027530
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 37 cost time: 0.8333523273468018
Epoch: 37, Steps: 64 | Train Loss: 0.0842343 Vali Loss: 0.2240438 Test Loss: 0.3022875
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 38 cost time: 0.8348433971405029
Epoch: 38, Steps: 64 | Train Loss: 0.0847764 Vali Loss: 0.2255791 Test Loss: 0.3022701
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 39 cost time: 0.8400001525878906
Epoch: 39, Steps: 64 | Train Loss: 0.0842974 Vali Loss: 0.2245997 Test Loss: 0.3030894
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 40 cost time: 0.8366217613220215
Epoch: 40, Steps: 64 | Train Loss: 0.0838552 Vali Loss: 0.2240304 Test Loss: 0.3038822
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 41 cost time: 0.8364517688751221
Epoch: 41, Steps: 64 | Train Loss: 0.0835170 Vali Loss: 0.2233380 Test Loss: 0.3018006
Validation loss decreased (0.223811 --> 0.223338).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 42 cost time: 0.8315219879150391
Epoch: 42, Steps: 64 | Train Loss: 0.0840195 Vali Loss: 0.2251719 Test Loss: 0.3021511
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 43 cost time: 0.8298726081848145
Epoch: 43, Steps: 64 | Train Loss: 0.0837799 Vali Loss: 0.2207644 Test Loss: 0.3033409
Validation loss decreased (0.223338 --> 0.220764).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 44 cost time: 0.8419997692108154
Epoch: 44, Steps: 64 | Train Loss: 0.0838211 Vali Loss: 0.2217308 Test Loss: 0.3032668
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 45 cost time: 0.8406369686126709
Epoch: 45, Steps: 64 | Train Loss: 0.0842194 Vali Loss: 0.2228290 Test Loss: 0.3031531
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 46 cost time: 0.8304104804992676
Epoch: 46, Steps: 64 | Train Loss: 0.0842207 Vali Loss: 0.2229763 Test Loss: 0.3029257
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 47 cost time: 0.8333215713500977
Epoch: 47, Steps: 64 | Train Loss: 0.0839799 Vali Loss: 0.2213839 Test Loss: 0.3017526
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 48 cost time: 0.8440005779266357
Epoch: 48, Steps: 64 | Train Loss: 0.0838050 Vali Loss: 0.2204976 Test Loss: 0.3033640
Validation loss decreased (0.220764 --> 0.220498).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 49 cost time: 0.8550002574920654
Epoch: 49, Steps: 64 | Train Loss: 0.0839864 Vali Loss: 0.2247003 Test Loss: 0.3023191
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 50 cost time: 0.8323647975921631
Epoch: 50, Steps: 64 | Train Loss: 0.0836587 Vali Loss: 0.2253300 Test Loss: 0.3030837
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 51 cost time: 0.8363454341888428
Epoch: 51, Steps: 64 | Train Loss: 0.0838744 Vali Loss: 0.2244635 Test Loss: 0.3038840
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 52 cost time: 0.8217334747314453
Epoch: 52, Steps: 64 | Train Loss: 0.0839466 Vali Loss: 0.2232921 Test Loss: 0.3037159
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 53 cost time: 0.8137810230255127
Epoch: 53, Steps: 64 | Train Loss: 0.0835335 Vali Loss: 0.2213810 Test Loss: 0.3041998
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 54 cost time: 0.830634593963623
Epoch: 54, Steps: 64 | Train Loss: 0.0837551 Vali Loss: 0.2255242 Test Loss: 0.3033192
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 55 cost time: 0.84051513671875
Epoch: 55, Steps: 64 | Train Loss: 0.0840349 Vali Loss: 0.2249792 Test Loss: 0.3032322
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 56 cost time: 0.8343667984008789
Epoch: 56, Steps: 64 | Train Loss: 0.0843961 Vali Loss: 0.2234742 Test Loss: 0.3048136
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 57 cost time: 0.8428134918212891
Epoch: 57, Steps: 64 | Train Loss: 0.0841689 Vali Loss: 0.2252298 Test Loss: 0.3033791
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 58 cost time: 0.8353137969970703
Epoch: 58, Steps: 64 | Train Loss: 0.0840999 Vali Loss: 0.2224336 Test Loss: 0.3027930
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 59 cost time: 0.8376343250274658
Epoch: 59, Steps: 64 | Train Loss: 0.0841308 Vali Loss: 0.2226145 Test Loss: 0.3022000
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 60 cost time: 0.8203754425048828
Epoch: 60, Steps: 64 | Train Loss: 0.0840467 Vali Loss: 0.2216003 Test Loss: 0.3032369
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.30336400866508484, mae:0.38219699263572693, rse:0.2527870535850525
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05694866180419922 GB
Epoch: 1 cost time: 2.2749080657958984
Epoch: 1, Steps: 64 | Train Loss: 0.8217410 Vali Loss: 2.5362134 Test Loss: 4.4789958
Validation loss decreased (inf --> 2.536213).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 2 cost time: 0.8547718524932861
Epoch: 2, Steps: 64 | Train Loss: 0.4314344 Vali Loss: 0.3043701 Test Loss: 0.2973970
Validation loss decreased (2.536213 --> 0.304370).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 3 cost time: 0.8504445552825928
Epoch: 3, Steps: 64 | Train Loss: 0.1261833 Vali Loss: 0.2837258 Test Loss: 0.3337600
Validation loss decreased (0.304370 --> 0.283726).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 4 cost time: 0.8480000495910645
Epoch: 4, Steps: 64 | Train Loss: 0.1105312 Vali Loss: 0.2552745 Test Loss: 0.2907745
Validation loss decreased (0.283726 --> 0.255274).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 5 cost time: 0.8552999496459961
Epoch: 5, Steps: 64 | Train Loss: 0.1045308 Vali Loss: 0.2545432 Test Loss: 0.2899318
Validation loss decreased (0.255274 --> 0.254543).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 6 cost time: 0.8443443775177002
Epoch: 6, Steps: 64 | Train Loss: 0.1008907 Vali Loss: 0.2502251 Test Loss: 0.2954953
Validation loss decreased (0.254543 --> 0.250225).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 7 cost time: 0.8404839038848877
Epoch: 7, Steps: 64 | Train Loss: 0.0980691 Vali Loss: 0.2494597 Test Loss: 0.2954844
Validation loss decreased (0.250225 --> 0.249460).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 8 cost time: 0.8473489284515381
Epoch: 8, Steps: 64 | Train Loss: 0.0956364 Vali Loss: 0.2392471 Test Loss: 0.2945001
Validation loss decreased (0.249460 --> 0.239247).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 9 cost time: 0.8450002670288086
Epoch: 9, Steps: 64 | Train Loss: 0.0938089 Vali Loss: 0.2356734 Test Loss: 0.2947622
Validation loss decreased (0.239247 --> 0.235673).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 10 cost time: 0.8466155529022217
Epoch: 10, Steps: 64 | Train Loss: 0.0924430 Vali Loss: 0.2381147 Test Loss: 0.2985627
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 11 cost time: 0.8480887413024902
Epoch: 11, Steps: 64 | Train Loss: 0.0922217 Vali Loss: 0.2324262 Test Loss: 0.2951888
Validation loss decreased (0.235673 --> 0.232426).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 12 cost time: 0.8494002819061279
Epoch: 12, Steps: 64 | Train Loss: 0.0898269 Vali Loss: 0.2327247 Test Loss: 0.2960476
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 13 cost time: 0.8487327098846436
Epoch: 13, Steps: 64 | Train Loss: 0.0898392 Vali Loss: 0.2295372 Test Loss: 0.2995568
Validation loss decreased (0.232426 --> 0.229537).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 14 cost time: 0.863999605178833
Epoch: 14, Steps: 64 | Train Loss: 0.0888842 Vali Loss: 0.2301598 Test Loss: 0.2968957
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 15 cost time: 0.8470442295074463
Epoch: 15, Steps: 64 | Train Loss: 0.0884124 Vali Loss: 0.2299149 Test Loss: 0.2964532
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 16 cost time: 0.8551321029663086
Epoch: 16, Steps: 64 | Train Loss: 0.0873595 Vali Loss: 0.2307532 Test Loss: 0.3002601
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 17 cost time: 0.8453335762023926
Epoch: 17, Steps: 64 | Train Loss: 0.0863642 Vali Loss: 0.2228372 Test Loss: 0.2987189
Validation loss decreased (0.229537 --> 0.222837).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 18 cost time: 0.8613300323486328
Epoch: 18, Steps: 64 | Train Loss: 0.0863290 Vali Loss: 0.2262160 Test Loss: 0.3006093
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 19 cost time: 0.8499999046325684
Epoch: 19, Steps: 64 | Train Loss: 0.0855917 Vali Loss: 0.2267147 Test Loss: 0.3003120
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 20 cost time: 0.8566305637359619
Epoch: 20, Steps: 64 | Train Loss: 0.0854905 Vali Loss: 0.2244718 Test Loss: 0.3021641
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 21 cost time: 0.8504204750061035
Epoch: 21, Steps: 64 | Train Loss: 0.0848790 Vali Loss: 0.2275349 Test Loss: 0.2996678
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 22 cost time: 0.8513391017913818
Epoch: 22, Steps: 64 | Train Loss: 0.0847672 Vali Loss: 0.2248210 Test Loss: 0.3019149
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 23 cost time: 0.851513147354126
Epoch: 23, Steps: 64 | Train Loss: 0.0839058 Vali Loss: 0.2236622 Test Loss: 0.3022499
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 24 cost time: 0.8453896045684814
Epoch: 24, Steps: 64 | Train Loss: 0.0838142 Vali Loss: 0.2256296 Test Loss: 0.3006893
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 25 cost time: 0.8510005474090576
Epoch: 25, Steps: 64 | Train Loss: 0.0838707 Vali Loss: 0.2226985 Test Loss: 0.3015409
Validation loss decreased (0.222837 --> 0.222698).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 26 cost time: 0.8464291095733643
Epoch: 26, Steps: 64 | Train Loss: 0.0832315 Vali Loss: 0.2221047 Test Loss: 0.3028751
Validation loss decreased (0.222698 --> 0.222105).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 27 cost time: 0.8454105854034424
Epoch: 27, Steps: 64 | Train Loss: 0.0835498 Vali Loss: 0.2202021 Test Loss: 0.3029772
Validation loss decreased (0.222105 --> 0.220202).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 28 cost time: 0.8513445854187012
Epoch: 28, Steps: 64 | Train Loss: 0.0831052 Vali Loss: 0.2233562 Test Loss: 0.3030803
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 29 cost time: 0.8582231998443604
Epoch: 29, Steps: 64 | Train Loss: 0.0829323 Vali Loss: 0.2236628 Test Loss: 0.3019404
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 30 cost time: 0.8499999046325684
Epoch: 30, Steps: 64 | Train Loss: 0.0825419 Vali Loss: 0.2198805 Test Loss: 0.3026618
Validation loss decreased (0.220202 --> 0.219881).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 31 cost time: 0.8486297130584717
Epoch: 31, Steps: 64 | Train Loss: 0.0826308 Vali Loss: 0.2212724 Test Loss: 0.3018694
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 32 cost time: 0.847360372543335
Epoch: 32, Steps: 64 | Train Loss: 0.0827377 Vali Loss: 0.2214216 Test Loss: 0.3026960
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 33 cost time: 0.8393886089324951
Epoch: 33, Steps: 64 | Train Loss: 0.0828734 Vali Loss: 0.2204169 Test Loss: 0.3039382
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 34 cost time: 0.8497910499572754
Epoch: 34, Steps: 64 | Train Loss: 0.0829419 Vali Loss: 0.2189128 Test Loss: 0.3033412
Validation loss decreased (0.219881 --> 0.218913).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 35 cost time: 0.8489997386932373
Epoch: 35, Steps: 64 | Train Loss: 0.0825542 Vali Loss: 0.2195195 Test Loss: 0.3029986
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 36 cost time: 0.8566322326660156
Epoch: 36, Steps: 64 | Train Loss: 0.0817794 Vali Loss: 0.2199530 Test Loss: 0.3032290
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 37 cost time: 0.8493468761444092
Epoch: 37, Steps: 64 | Train Loss: 0.0824030 Vali Loss: 0.2198224 Test Loss: 0.3026237
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 38 cost time: 0.8510332107543945
Epoch: 38, Steps: 64 | Train Loss: 0.0822227 Vali Loss: 0.2193016 Test Loss: 0.3018511
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 39 cost time: 0.8457193374633789
Epoch: 39, Steps: 64 | Train Loss: 0.0823524 Vali Loss: 0.2181568 Test Loss: 0.3036298
Validation loss decreased (0.218913 --> 0.218157).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 40 cost time: 0.8680000305175781
Epoch: 40, Steps: 64 | Train Loss: 0.0822739 Vali Loss: 0.2180120 Test Loss: 0.3032901
Validation loss decreased (0.218157 --> 0.218012).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 41 cost time: 0.8450000286102295
Epoch: 41, Steps: 64 | Train Loss: 0.0822849 Vali Loss: 0.2190846 Test Loss: 0.3019740
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 42 cost time: 0.8511686325073242
Epoch: 42, Steps: 64 | Train Loss: 0.0822513 Vali Loss: 0.2221509 Test Loss: 0.3025458
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 43 cost time: 0.8433754444122314
Epoch: 43, Steps: 64 | Train Loss: 0.0817181 Vali Loss: 0.2211188 Test Loss: 0.3018731
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 44 cost time: 0.8653287887573242
Epoch: 44, Steps: 64 | Train Loss: 0.0813301 Vali Loss: 0.2178705 Test Loss: 0.3038952
Validation loss decreased (0.218012 --> 0.217870).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 45 cost time: 0.9318909645080566
Epoch: 45, Steps: 64 | Train Loss: 0.0822549 Vali Loss: 0.2223259 Test Loss: 0.3037400
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 46 cost time: 0.931999921798706
Epoch: 46, Steps: 64 | Train Loss: 0.0816207 Vali Loss: 0.2175534 Test Loss: 0.3022438
Validation loss decreased (0.217870 --> 0.217553).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 47 cost time: 0.9106254577636719
Epoch: 47, Steps: 64 | Train Loss: 0.0819443 Vali Loss: 0.2202994 Test Loss: 0.3028964
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 48 cost time: 0.929610013961792
Epoch: 48, Steps: 64 | Train Loss: 0.0816120 Vali Loss: 0.2195066 Test Loss: 0.3034186
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 49 cost time: 0.9324240684509277
Epoch: 49, Steps: 64 | Train Loss: 0.0818157 Vali Loss: 0.2197730 Test Loss: 0.3018568
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 50 cost time: 0.9324703216552734
Epoch: 50, Steps: 64 | Train Loss: 0.0816751 Vali Loss: 0.2207204 Test Loss: 0.3021995
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 51 cost time: 0.8080267906188965
Epoch: 51, Steps: 64 | Train Loss: 0.0818049 Vali Loss: 0.2180928 Test Loss: 0.3024063
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 52 cost time: 0.8497326374053955
Epoch: 52, Steps: 64 | Train Loss: 0.0818991 Vali Loss: 0.2186533 Test Loss: 0.3030820
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 53 cost time: 0.8510000705718994
Epoch: 53, Steps: 64 | Train Loss: 0.0821854 Vali Loss: 0.2190419 Test Loss: 0.3021561
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 54 cost time: 0.8626194000244141
Epoch: 54, Steps: 64 | Train Loss: 0.0818009 Vali Loss: 0.2175329 Test Loss: 0.3032270
Validation loss decreased (0.217553 --> 0.217533).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 55 cost time: 0.8491513729095459
Epoch: 55, Steps: 64 | Train Loss: 0.0822056 Vali Loss: 0.2158757 Test Loss: 0.3036902
Validation loss decreased (0.217533 --> 0.215876).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 56 cost time: 0.8499917984008789
Epoch: 56, Steps: 64 | Train Loss: 0.0820841 Vali Loss: 0.2197464 Test Loss: 0.3020836
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 57 cost time: 0.8523387908935547
Epoch: 57, Steps: 64 | Train Loss: 0.0815321 Vali Loss: 0.2174054 Test Loss: 0.3025110
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 58 cost time: 0.8489997386932373
Epoch: 58, Steps: 64 | Train Loss: 0.0820638 Vali Loss: 0.2188107 Test Loss: 0.3033136
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 59 cost time: 0.8499996662139893
Epoch: 59, Steps: 64 | Train Loss: 0.0821333 Vali Loss: 0.2187739 Test Loss: 0.3020053
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 60 cost time: 0.8519845008850098
Epoch: 60, Steps: 64 | Train Loss: 0.0820941 Vali Loss: 0.2172592 Test Loss: 0.3039640
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.30369022488594055, mae:0.38365060091018677, rse:0.252922922372818
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.04982280731201172 GB
Epoch: 1 cost time: 2.2910094261169434
Epoch: 1, Steps: 64 | Train Loss: 0.9296150 Vali Loss: 2.7563326 Test Loss: 4.9216461
Validation loss decreased (inf --> 2.756333).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 2 cost time: 0.8893225193023682
Epoch: 2, Steps: 64 | Train Loss: 0.7731761 Vali Loss: 1.9467943 Test Loss: 3.3618557
Validation loss decreased (2.756333 --> 1.946794).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 3 cost time: 0.876779317855835
Epoch: 3, Steps: 64 | Train Loss: 0.5773964 Vali Loss: 1.4822598 Test Loss: 2.4872539
Validation loss decreased (1.946794 --> 1.482260).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 4 cost time: 0.880000114440918
Epoch: 4, Steps: 64 | Train Loss: 0.4434289 Vali Loss: 1.1642573 Test Loss: 1.9094974
Validation loss decreased (1.482260 --> 1.164257).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 5 cost time: 0.89200758934021
Epoch: 5, Steps: 64 | Train Loss: 0.3454075 Vali Loss: 0.9212891 Test Loss: 1.4950528
Validation loss decreased (1.164257 --> 0.921289).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 6 cost time: 0.8713443279266357
Epoch: 6, Steps: 64 | Train Loss: 0.2789310 Vali Loss: 0.7463975 Test Loss: 1.1931860
Validation loss decreased (0.921289 --> 0.746397).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 7 cost time: 0.8733382225036621
Epoch: 7, Steps: 64 | Train Loss: 0.2312988 Vali Loss: 0.6311925 Test Loss: 0.9903488
Validation loss decreased (0.746397 --> 0.631193).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 8 cost time: 0.8693451881408691
Epoch: 8, Steps: 64 | Train Loss: 0.1989276 Vali Loss: 0.5369176 Test Loss: 0.8242878
Validation loss decreased (0.631193 --> 0.536918).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 9 cost time: 0.8622117042541504
Epoch: 9, Steps: 64 | Train Loss: 0.1754067 Vali Loss: 0.4742148 Test Loss: 0.7180025
Validation loss decreased (0.536918 --> 0.474215).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 10 cost time: 0.8736498355865479
Epoch: 10, Steps: 64 | Train Loss: 0.1592492 Vali Loss: 0.4212278 Test Loss: 0.6264387
Validation loss decreased (0.474215 --> 0.421228).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 11 cost time: 0.8786180019378662
Epoch: 11, Steps: 64 | Train Loss: 0.1465082 Vali Loss: 0.3885682 Test Loss: 0.5662374
Validation loss decreased (0.421228 --> 0.388568).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 12 cost time: 0.8833472728729248
Epoch: 12, Steps: 64 | Train Loss: 0.1370259 Vali Loss: 0.3654744 Test Loss: 0.5221307
Validation loss decreased (0.388568 --> 0.365474).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 13 cost time: 0.8774363994598389
Epoch: 13, Steps: 64 | Train Loss: 0.1293471 Vali Loss: 0.3423482 Test Loss: 0.4797249
Validation loss decreased (0.365474 --> 0.342348).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 14 cost time: 0.8774466514587402
Epoch: 14, Steps: 64 | Train Loss: 0.1246457 Vali Loss: 0.3311295 Test Loss: 0.4515089
Validation loss decreased (0.342348 --> 0.331129).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 15 cost time: 0.8648028373718262
Epoch: 15, Steps: 64 | Train Loss: 0.1203010 Vali Loss: 0.3142117 Test Loss: 0.4307750
Validation loss decreased (0.331129 --> 0.314212).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 16 cost time: 0.880434513092041
Epoch: 16, Steps: 64 | Train Loss: 0.1172166 Vali Loss: 0.3045962 Test Loss: 0.4143277
Validation loss decreased (0.314212 --> 0.304596).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 17 cost time: 0.9176228046417236
Epoch: 17, Steps: 64 | Train Loss: 0.1150159 Vali Loss: 0.2955847 Test Loss: 0.3968788
Validation loss decreased (0.304596 --> 0.295585).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 18 cost time: 0.8671970367431641
Epoch: 18, Steps: 64 | Train Loss: 0.1124116 Vali Loss: 0.2911171 Test Loss: 0.3878130
Validation loss decreased (0.295585 --> 0.291117).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 19 cost time: 0.8713183403015137
Epoch: 19, Steps: 64 | Train Loss: 0.1100751 Vali Loss: 0.2817574 Test Loss: 0.3778446
Validation loss decreased (0.291117 --> 0.281757).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 20 cost time: 0.879422664642334
Epoch: 20, Steps: 64 | Train Loss: 0.1088384 Vali Loss: 0.2804530 Test Loss: 0.3713450
Validation loss decreased (0.281757 --> 0.280453).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 21 cost time: 0.8797891139984131
Epoch: 21, Steps: 64 | Train Loss: 0.1075556 Vali Loss: 0.2738703 Test Loss: 0.3624029
Validation loss decreased (0.280453 --> 0.273870).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 22 cost time: 0.8769998550415039
Epoch: 22, Steps: 64 | Train Loss: 0.1068264 Vali Loss: 0.2692222 Test Loss: 0.3545292
Validation loss decreased (0.273870 --> 0.269222).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 23 cost time: 0.8804354667663574
Epoch: 23, Steps: 64 | Train Loss: 0.1057465 Vali Loss: 0.2699889 Test Loss: 0.3517233
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 24 cost time: 0.8694076538085938
Epoch: 24, Steps: 64 | Train Loss: 0.1046450 Vali Loss: 0.2653335 Test Loss: 0.3477307
Validation loss decreased (0.269222 --> 0.265334).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 25 cost time: 0.8693208694458008
Epoch: 25, Steps: 64 | Train Loss: 0.1043656 Vali Loss: 0.2626578 Test Loss: 0.3454544
Validation loss decreased (0.265334 --> 0.262658).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 26 cost time: 0.8734610080718994
Epoch: 26, Steps: 64 | Train Loss: 0.1031215 Vali Loss: 0.2617750 Test Loss: 0.3405258
Validation loss decreased (0.262658 --> 0.261775).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 27 cost time: 0.8738319873809814
Epoch: 27, Steps: 64 | Train Loss: 0.1026050 Vali Loss: 0.2595544 Test Loss: 0.3402213
Validation loss decreased (0.261775 --> 0.259554).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 28 cost time: 0.874000072479248
Epoch: 28, Steps: 64 | Train Loss: 0.1027679 Vali Loss: 0.2617893 Test Loss: 0.3377216
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 29 cost time: 0.8766233921051025
Epoch: 29, Steps: 64 | Train Loss: 0.1029816 Vali Loss: 0.2596555 Test Loss: 0.3354493
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 30 cost time: 0.883345365524292
Epoch: 30, Steps: 64 | Train Loss: 0.1024383 Vali Loss: 0.2575195 Test Loss: 0.3311698
Validation loss decreased (0.259554 --> 0.257520).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 31 cost time: 0.8773760795593262
Epoch: 31, Steps: 64 | Train Loss: 0.1018395 Vali Loss: 0.2550143 Test Loss: 0.3301828
Validation loss decreased (0.257520 --> 0.255014).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 32 cost time: 0.8713607788085938
Epoch: 32, Steps: 64 | Train Loss: 0.1013681 Vali Loss: 0.2566839 Test Loss: 0.3324606
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 33 cost time: 0.8763427734375
Epoch: 33, Steps: 64 | Train Loss: 0.1011347 Vali Loss: 0.2574839 Test Loss: 0.3305188
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 34 cost time: 0.8729996681213379
Epoch: 34, Steps: 64 | Train Loss: 0.1010184 Vali Loss: 0.2555922 Test Loss: 0.3266665
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 35 cost time: 0.8746235370635986
Epoch: 35, Steps: 64 | Train Loss: 0.1009079 Vali Loss: 0.2556355 Test Loss: 0.3267175
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 36 cost time: 0.8700642585754395
Epoch: 36, Steps: 64 | Train Loss: 0.1002890 Vali Loss: 0.2548022 Test Loss: 0.3255973
Validation loss decreased (0.255014 --> 0.254802).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 37 cost time: 0.8739752769470215
Epoch: 37, Steps: 64 | Train Loss: 0.1000289 Vali Loss: 0.2535312 Test Loss: 0.3241624
Validation loss decreased (0.254802 --> 0.253531).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 38 cost time: 0.8773863315582275
Epoch: 38, Steps: 64 | Train Loss: 0.1004609 Vali Loss: 0.2519445 Test Loss: 0.3246508
Validation loss decreased (0.253531 --> 0.251944).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 39 cost time: 0.8737900257110596
Epoch: 39, Steps: 64 | Train Loss: 0.1002626 Vali Loss: 0.2532184 Test Loss: 0.3255678
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 40 cost time: 0.874000072479248
Epoch: 40, Steps: 64 | Train Loss: 0.1000734 Vali Loss: 0.2510499 Test Loss: 0.3237017
Validation loss decreased (0.251944 --> 0.251050).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 41 cost time: 0.8846328258514404
Epoch: 41, Steps: 64 | Train Loss: 0.1003380 Vali Loss: 0.2526426 Test Loss: 0.3228929
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 42 cost time: 0.871384859085083
Epoch: 42, Steps: 64 | Train Loss: 0.1001286 Vali Loss: 0.2531538 Test Loss: 0.3222451
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 43 cost time: 0.8694777488708496
Epoch: 43, Steps: 64 | Train Loss: 0.0994893 Vali Loss: 0.2502789 Test Loss: 0.3222310
Validation loss decreased (0.251050 --> 0.250279).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 44 cost time: 0.8724300861358643
Epoch: 44, Steps: 64 | Train Loss: 0.0997192 Vali Loss: 0.2519678 Test Loss: 0.3220493
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 45 cost time: 0.8850116729736328
Epoch: 45, Steps: 64 | Train Loss: 0.1000225 Vali Loss: 0.2473629 Test Loss: 0.3192515
Validation loss decreased (0.250279 --> 0.247363).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 46 cost time: 0.8706369400024414
Epoch: 46, Steps: 64 | Train Loss: 0.0996257 Vali Loss: 0.2499490 Test Loss: 0.3201047
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 47 cost time: 0.8746061325073242
Epoch: 47, Steps: 64 | Train Loss: 0.0993842 Vali Loss: 0.2480225 Test Loss: 0.3207605
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 48 cost time: 0.8784503936767578
Epoch: 48, Steps: 64 | Train Loss: 0.0999320 Vali Loss: 0.2493995 Test Loss: 0.3197154
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 49 cost time: 0.8593730926513672
Epoch: 49, Steps: 64 | Train Loss: 0.0990877 Vali Loss: 0.2482454 Test Loss: 0.3162474
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 50 cost time: 0.8674511909484863
Epoch: 50, Steps: 64 | Train Loss: 0.0992819 Vali Loss: 0.2511857 Test Loss: 0.3197680
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 51 cost time: 0.8689999580383301
Epoch: 51, Steps: 64 | Train Loss: 0.0996430 Vali Loss: 0.2496919 Test Loss: 0.3178938
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 52 cost time: 0.8619997501373291
Epoch: 52, Steps: 64 | Train Loss: 0.0989125 Vali Loss: 0.2479780 Test Loss: 0.3201168
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 53 cost time: 0.8363211154937744
Epoch: 53, Steps: 64 | Train Loss: 0.0993800 Vali Loss: 0.2490009 Test Loss: 0.3199876
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 54 cost time: 0.8619873523712158
Epoch: 54, Steps: 64 | Train Loss: 0.0989775 Vali Loss: 0.2476447 Test Loss: 0.3175536
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 55 cost time: 0.8759777545928955
Epoch: 55, Steps: 64 | Train Loss: 0.0981819 Vali Loss: 0.2509198 Test Loss: 0.3185290
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 56 cost time: 0.8657493591308594
Epoch: 56, Steps: 64 | Train Loss: 0.0989919 Vali Loss: 0.2477076 Test Loss: 0.3188305
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 57 cost time: 0.8750014305114746
Epoch: 57, Steps: 64 | Train Loss: 0.0995406 Vali Loss: 0.2496231 Test Loss: 0.3163366
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 58 cost time: 0.8716189861297607
Epoch: 58, Steps: 64 | Train Loss: 0.0991286 Vali Loss: 0.2476796 Test Loss: 0.3176808
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 59 cost time: 0.878441333770752
Epoch: 59, Steps: 64 | Train Loss: 0.0994231 Vali Loss: 0.2492000 Test Loss: 0.3172506
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 60 cost time: 0.8804960250854492
Epoch: 60, Steps: 64 | Train Loss: 0.0992250 Vali Loss: 0.2509720 Test Loss: 0.3197244
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.31925150752067566, mae:0.3905930817127228, rse:0.259321928024292
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 1 cost time: 2.31591534614563
Epoch: 1, Steps: 64 | Train Loss: 0.8674780 Vali Loss: 2.6481926 Test Loss: 4.6871915
Validation loss decreased (inf --> 2.648193).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 2 cost time: 0.9228568077087402
Epoch: 2, Steps: 64 | Train Loss: 0.5391354 Vali Loss: 0.6359496 Test Loss: 0.8643728
Validation loss decreased (2.648193 --> 0.635950).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 3 cost time: 0.9064829349517822
Epoch: 3, Steps: 64 | Train Loss: 0.1498378 Vali Loss: 0.2860157 Test Loss: 0.2766342
Validation loss decreased (0.635950 --> 0.286016).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 4 cost time: 0.9129998683929443
Epoch: 4, Steps: 64 | Train Loss: 0.1147819 Vali Loss: 0.2735080 Test Loss: 0.3006925
Validation loss decreased (0.286016 --> 0.273508).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 5 cost time: 0.9090914726257324
Epoch: 5, Steps: 64 | Train Loss: 0.1073781 Vali Loss: 0.2577935 Test Loss: 0.2872152
Validation loss decreased (0.273508 --> 0.257793).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 6 cost time: 0.9043583869934082
Epoch: 6, Steps: 64 | Train Loss: 0.1038389 Vali Loss: 0.2532328 Test Loss: 0.2844761
Validation loss decreased (0.257793 --> 0.253233).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 7 cost time: 0.9044079780578613
Epoch: 7, Steps: 64 | Train Loss: 0.1009237 Vali Loss: 0.2464672 Test Loss: 0.2852373
Validation loss decreased (0.253233 --> 0.246467).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 8 cost time: 0.9023966789245605
Epoch: 8, Steps: 64 | Train Loss: 0.0991851 Vali Loss: 0.2423013 Test Loss: 0.2842859
Validation loss decreased (0.246467 --> 0.242301).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 9 cost time: 0.8987472057342529
Epoch: 9, Steps: 64 | Train Loss: 0.0970167 Vali Loss: 0.2377197 Test Loss: 0.2864131
Validation loss decreased (0.242301 --> 0.237720).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 10 cost time: 0.9147350788116455
Epoch: 10, Steps: 64 | Train Loss: 0.0959504 Vali Loss: 0.2360115 Test Loss: 0.2844902
Validation loss decreased (0.237720 --> 0.236012).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 11 cost time: 0.9070000648498535
Epoch: 11, Steps: 64 | Train Loss: 0.0949528 Vali Loss: 0.2385645 Test Loss: 0.2898135
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 12 cost time: 0.9126112461090088
Epoch: 12, Steps: 64 | Train Loss: 0.0933457 Vali Loss: 0.2379719 Test Loss: 0.2857009
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 13 cost time: 0.9193856716156006
Epoch: 13, Steps: 64 | Train Loss: 0.0931599 Vali Loss: 0.2313911 Test Loss: 0.2846550
Validation loss decreased (0.236012 --> 0.231391).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 14 cost time: 0.9072492122650146
Epoch: 14, Steps: 64 | Train Loss: 0.0924078 Vali Loss: 0.2312855 Test Loss: 0.2857992
Validation loss decreased (0.231391 --> 0.231285).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 15 cost time: 0.901324987411499
Epoch: 15, Steps: 64 | Train Loss: 0.0913974 Vali Loss: 0.2301962 Test Loss: 0.2850688
Validation loss decreased (0.231285 --> 0.230196).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 16 cost time: 0.9074132442474365
Epoch: 16, Steps: 64 | Train Loss: 0.0909293 Vali Loss: 0.2280264 Test Loss: 0.2863734
Validation loss decreased (0.230196 --> 0.228026).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 17 cost time: 0.9037566184997559
Epoch: 17, Steps: 64 | Train Loss: 0.0904489 Vali Loss: 0.2273099 Test Loss: 0.2840888
Validation loss decreased (0.228026 --> 0.227310).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 18 cost time: 0.9104022979736328
Epoch: 18, Steps: 64 | Train Loss: 0.0897368 Vali Loss: 0.2277195 Test Loss: 0.2853220
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 19 cost time: 0.9069998264312744
Epoch: 19, Steps: 64 | Train Loss: 0.0894056 Vali Loss: 0.2281654 Test Loss: 0.2859082
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 20 cost time: 0.919625997543335
Epoch: 20, Steps: 64 | Train Loss: 0.0890843 Vali Loss: 0.2282615 Test Loss: 0.2870085
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 21 cost time: 0.903364896774292
Epoch: 21, Steps: 64 | Train Loss: 0.0884205 Vali Loss: 0.2262097 Test Loss: 0.2880405
Validation loss decreased (0.227310 --> 0.226210).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 22 cost time: 0.9120903015136719
Epoch: 22, Steps: 64 | Train Loss: 0.0882732 Vali Loss: 0.2254308 Test Loss: 0.2861379
Validation loss decreased (0.226210 --> 0.225431).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 23 cost time: 0.9033539295196533
Epoch: 23, Steps: 64 | Train Loss: 0.0884296 Vali Loss: 0.2267053 Test Loss: 0.2874876
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 24 cost time: 0.9017612934112549
Epoch: 24, Steps: 64 | Train Loss: 0.0876923 Vali Loss: 0.2266051 Test Loss: 0.2868326
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 25 cost time: 0.8989992141723633
Epoch: 25, Steps: 64 | Train Loss: 0.0878570 Vali Loss: 0.2259974 Test Loss: 0.2872848
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 26 cost time: 0.9030001163482666
Epoch: 26, Steps: 64 | Train Loss: 0.0871814 Vali Loss: 0.2273942 Test Loss: 0.2868373
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 27 cost time: 0.9156053066253662
Epoch: 27, Steps: 64 | Train Loss: 0.0873517 Vali Loss: 0.2249381 Test Loss: 0.2877957
Validation loss decreased (0.225431 --> 0.224938).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 28 cost time: 0.9084057807922363
Epoch: 28, Steps: 64 | Train Loss: 0.0867463 Vali Loss: 0.2224693 Test Loss: 0.2884237
Validation loss decreased (0.224938 --> 0.222469).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 29 cost time: 0.9064350128173828
Epoch: 29, Steps: 64 | Train Loss: 0.0866981 Vali Loss: 0.2260342 Test Loss: 0.2873081
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 30 cost time: 0.9043948650360107
Epoch: 30, Steps: 64 | Train Loss: 0.0871135 Vali Loss: 0.2227788 Test Loss: 0.2873681
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 31 cost time: 0.9032297134399414
Epoch: 31, Steps: 64 | Train Loss: 0.0867977 Vali Loss: 0.2238208 Test Loss: 0.2879971
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 32 cost time: 0.8999998569488525
Epoch: 32, Steps: 64 | Train Loss: 0.0865610 Vali Loss: 0.2256809 Test Loss: 0.2889798
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 33 cost time: 0.9000000953674316
Epoch: 33, Steps: 64 | Train Loss: 0.0865944 Vali Loss: 0.2242844 Test Loss: 0.2879685
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 34 cost time: 0.9116241931915283
Epoch: 34, Steps: 64 | Train Loss: 0.0865971 Vali Loss: 0.2264410 Test Loss: 0.2883013
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 35 cost time: 0.9030261039733887
Epoch: 35, Steps: 64 | Train Loss: 0.0860033 Vali Loss: 0.2243873 Test Loss: 0.2883439
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 36 cost time: 0.9074018001556396
Epoch: 36, Steps: 64 | Train Loss: 0.0865191 Vali Loss: 0.2231350 Test Loss: 0.2890642
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 37 cost time: 0.9084000587463379
Epoch: 37, Steps: 64 | Train Loss: 0.0866455 Vali Loss: 0.2226869 Test Loss: 0.2877047
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 38 cost time: 0.914785623550415
Epoch: 38, Steps: 64 | Train Loss: 0.0863799 Vali Loss: 0.2241520 Test Loss: 0.2884047
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 39 cost time: 0.908848762512207
Epoch: 39, Steps: 64 | Train Loss: 0.0863775 Vali Loss: 0.2229457 Test Loss: 0.2878045
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 40 cost time: 0.8990001678466797
Epoch: 40, Steps: 64 | Train Loss: 0.0859370 Vali Loss: 0.2223238 Test Loss: 0.2874920
Validation loss decreased (0.222469 --> 0.222324).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 41 cost time: 0.9148540496826172
Epoch: 41, Steps: 64 | Train Loss: 0.0865439 Vali Loss: 0.2230379 Test Loss: 0.2887145
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 42 cost time: 0.8983795642852783
Epoch: 42, Steps: 64 | Train Loss: 0.0858849 Vali Loss: 0.2254921 Test Loss: 0.2882221
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 43 cost time: 0.8994600772857666
Epoch: 43, Steps: 64 | Train Loss: 0.0855940 Vali Loss: 0.2228022 Test Loss: 0.2880293
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 44 cost time: 0.9060165882110596
Epoch: 44, Steps: 64 | Train Loss: 0.0860771 Vali Loss: 0.2239796 Test Loss: 0.2886617
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 45 cost time: 0.9068005084991455
Epoch: 45, Steps: 64 | Train Loss: 0.0864429 Vali Loss: 0.2229440 Test Loss: 0.2877185
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 46 cost time: 0.9090001583099365
Epoch: 46, Steps: 64 | Train Loss: 0.0857396 Vali Loss: 0.2209283 Test Loss: 0.2892052
Validation loss decreased (0.222324 --> 0.220928).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 47 cost time: 0.9039998054504395
Epoch: 47, Steps: 64 | Train Loss: 0.0856595 Vali Loss: 0.2197256 Test Loss: 0.2896102
Validation loss decreased (0.220928 --> 0.219726).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 48 cost time: 0.8982930183410645
Epoch: 48, Steps: 64 | Train Loss: 0.0859543 Vali Loss: 0.2212126 Test Loss: 0.2882393
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 49 cost time: 0.9044437408447266
Epoch: 49, Steps: 64 | Train Loss: 0.0857190 Vali Loss: 0.2241035 Test Loss: 0.2881160
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 50 cost time: 0.9044208526611328
Epoch: 50, Steps: 64 | Train Loss: 0.0856185 Vali Loss: 0.2226096 Test Loss: 0.2890058
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 51 cost time: 0.9063737392425537
Epoch: 51, Steps: 64 | Train Loss: 0.0856614 Vali Loss: 0.2246117 Test Loss: 0.2888273
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 52 cost time: 0.8938553333282471
Epoch: 52, Steps: 64 | Train Loss: 0.0857484 Vali Loss: 0.2240214 Test Loss: 0.2886681
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 53 cost time: 0.9104115962982178
Epoch: 53, Steps: 64 | Train Loss: 0.0853075 Vali Loss: 0.2222459 Test Loss: 0.2893935
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 54 cost time: 0.9090025424957275
Epoch: 54, Steps: 64 | Train Loss: 0.0856594 Vali Loss: 0.2223655 Test Loss: 0.2883811
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 55 cost time: 0.914614200592041
Epoch: 55, Steps: 64 | Train Loss: 0.0860604 Vali Loss: 0.2210208 Test Loss: 0.2892023
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 56 cost time: 0.9093630313873291
Epoch: 56, Steps: 64 | Train Loss: 0.0858717 Vali Loss: 0.2253477 Test Loss: 0.2894424
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 57 cost time: 0.9013421535491943
Epoch: 57, Steps: 64 | Train Loss: 0.0856280 Vali Loss: 0.2182918 Test Loss: 0.2889809
Validation loss decreased (0.219726 --> 0.218292).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 58 cost time: 0.9013724327087402
Epoch: 58, Steps: 64 | Train Loss: 0.0856788 Vali Loss: 0.2230150 Test Loss: 0.2891291
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 59 cost time: 0.9017789363861084
Epoch: 59, Steps: 64 | Train Loss: 0.0857607 Vali Loss: 0.2228306 Test Loss: 0.2883573
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 60 cost time: 0.8970000743865967
Epoch: 60, Steps: 64 | Train Loss: 0.0860672 Vali Loss: 0.2249596 Test Loss: 0.2887760
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2889808416366577, mae:0.3554709255695343, rse:0.24672168493270874
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.057109832763671875 GB
Epoch: 1 cost time: 2.3322014808654785
Epoch: 1, Steps: 64 | Train Loss: 0.8444462 Vali Loss: 2.6258328 Test Loss: 4.6153569
Validation loss decreased (inf --> 2.625833).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 2 cost time: 0.9290337562561035
Epoch: 2, Steps: 64 | Train Loss: 0.4628990 Vali Loss: 0.3887157 Test Loss: 0.3277711
Validation loss decreased (2.625833 --> 0.388716).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 3 cost time: 0.9336190223693848
Epoch: 3, Steps: 64 | Train Loss: 0.1315926 Vali Loss: 0.2953780 Test Loss: 0.3268282
Validation loss decreased (0.388716 --> 0.295378).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 4 cost time: 0.9343862533569336
Epoch: 4, Steps: 64 | Train Loss: 0.1125241 Vali Loss: 0.2597523 Test Loss: 0.2883076
Validation loss decreased (0.295378 --> 0.259752).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 5 cost time: 0.940354585647583
Epoch: 5, Steps: 64 | Train Loss: 0.1067870 Vali Loss: 0.2582637 Test Loss: 0.2847846
Validation loss decreased (0.259752 --> 0.258264).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 6 cost time: 0.9300498962402344
Epoch: 6, Steps: 64 | Train Loss: 0.1029531 Vali Loss: 0.2484280 Test Loss: 0.2855287
Validation loss decreased (0.258264 --> 0.248428).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 7 cost time: 0.9284615516662598
Epoch: 7, Steps: 64 | Train Loss: 0.0995306 Vali Loss: 0.2422844 Test Loss: 0.2840157
Validation loss decreased (0.248428 --> 0.242284).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 8 cost time: 0.9287257194519043
Epoch: 8, Steps: 64 | Train Loss: 0.0977685 Vali Loss: 0.2413790 Test Loss: 0.2830887
Validation loss decreased (0.242284 --> 0.241379).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 9 cost time: 0.9270000457763672
Epoch: 9, Steps: 64 | Train Loss: 0.0960810 Vali Loss: 0.2368973 Test Loss: 0.2843781
Validation loss decreased (0.241379 --> 0.236897).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 10 cost time: 0.932396650314331
Epoch: 10, Steps: 64 | Train Loss: 0.0945277 Vali Loss: 0.2332698 Test Loss: 0.2826266
Validation loss decreased (0.236897 --> 0.233270).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 11 cost time: 0.9356081485748291
Epoch: 11, Steps: 64 | Train Loss: 0.0931274 Vali Loss: 0.2322901 Test Loss: 0.2848270
Validation loss decreased (0.233270 --> 0.232290).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 12 cost time: 0.9464066028594971
Epoch: 12, Steps: 64 | Train Loss: 0.0920967 Vali Loss: 0.2308689 Test Loss: 0.2857998
Validation loss decreased (0.232290 --> 0.230869).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 13 cost time: 0.9333508014678955
Epoch: 13, Steps: 64 | Train Loss: 0.0914842 Vali Loss: 0.2312069 Test Loss: 0.2835518
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 14 cost time: 0.9314520359039307
Epoch: 14, Steps: 64 | Train Loss: 0.0910095 Vali Loss: 0.2262244 Test Loss: 0.2841040
Validation loss decreased (0.230869 --> 0.226224).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 15 cost time: 0.9403748512268066
Epoch: 15, Steps: 64 | Train Loss: 0.0902841 Vali Loss: 0.2286731 Test Loss: 0.2834460
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 16 cost time: 0.929506778717041
Epoch: 16, Steps: 64 | Train Loss: 0.0890200 Vali Loss: 0.2244180 Test Loss: 0.2862813
Validation loss decreased (0.226224 --> 0.224418).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 17 cost time: 0.9310019016265869
Epoch: 17, Steps: 64 | Train Loss: 0.0890786 Vali Loss: 0.2265256 Test Loss: 0.2850225
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 18 cost time: 0.9370126724243164
Epoch: 18, Steps: 64 | Train Loss: 0.0881030 Vali Loss: 0.2226740 Test Loss: 0.2865727
Validation loss decreased (0.224418 --> 0.222674).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 19 cost time: 0.9549999237060547
Epoch: 19, Steps: 64 | Train Loss: 0.0878990 Vali Loss: 0.2225072 Test Loss: 0.2862468
Validation loss decreased (0.222674 --> 0.222507).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 20 cost time: 0.9356215000152588
Epoch: 20, Steps: 64 | Train Loss: 0.0878904 Vali Loss: 0.2223118 Test Loss: 0.2864784
Validation loss decreased (0.222507 --> 0.222312).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 21 cost time: 0.937629222869873
Epoch: 21, Steps: 64 | Train Loss: 0.0872386 Vali Loss: 0.2194187 Test Loss: 0.2876106
Validation loss decreased (0.222312 --> 0.219419).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 22 cost time: 0.9395632743835449
Epoch: 22, Steps: 64 | Train Loss: 0.0865268 Vali Loss: 0.2215399 Test Loss: 0.2876756
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 23 cost time: 0.9343421459197998
Epoch: 23, Steps: 64 | Train Loss: 0.0868090 Vali Loss: 0.2222960 Test Loss: 0.2885399
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 24 cost time: 0.9353930950164795
Epoch: 24, Steps: 64 | Train Loss: 0.0859662 Vali Loss: 0.2226007 Test Loss: 0.2884733
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 25 cost time: 0.932401180267334
Epoch: 25, Steps: 64 | Train Loss: 0.0859200 Vali Loss: 0.2181952 Test Loss: 0.2890560
Validation loss decreased (0.219419 --> 0.218195).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 26 cost time: 0.9257392883300781
Epoch: 26, Steps: 64 | Train Loss: 0.0857073 Vali Loss: 0.2212041 Test Loss: 0.2894101
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 27 cost time: 0.9360001087188721
Epoch: 27, Steps: 64 | Train Loss: 0.0856066 Vali Loss: 0.2178715 Test Loss: 0.2883660
Validation loss decreased (0.218195 --> 0.217872).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 28 cost time: 0.9344797134399414
Epoch: 28, Steps: 64 | Train Loss: 0.0859613 Vali Loss: 0.2178589 Test Loss: 0.2889712
Validation loss decreased (0.217872 --> 0.217859).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 29 cost time: 0.9426488876342773
Epoch: 29, Steps: 64 | Train Loss: 0.0851649 Vali Loss: 0.2198374 Test Loss: 0.2892215
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 30 cost time: 0.9353501796722412
Epoch: 30, Steps: 64 | Train Loss: 0.0852966 Vali Loss: 0.2177307 Test Loss: 0.2895250
Validation loss decreased (0.217859 --> 0.217731).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 31 cost time: 0.9343929290771484
Epoch: 31, Steps: 64 | Train Loss: 0.0853545 Vali Loss: 0.2171847 Test Loss: 0.2891273
Validation loss decreased (0.217731 --> 0.217185).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 32 cost time: 0.937000036239624
Epoch: 32, Steps: 64 | Train Loss: 0.0847041 Vali Loss: 0.2184199 Test Loss: 0.2899886
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 33 cost time: 0.9336264133453369
Epoch: 33, Steps: 64 | Train Loss: 0.0849255 Vali Loss: 0.2172285 Test Loss: 0.2900801
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 34 cost time: 0.9363796710968018
Epoch: 34, Steps: 64 | Train Loss: 0.0846572 Vali Loss: 0.2162304 Test Loss: 0.2894824
Validation loss decreased (0.217185 --> 0.216230).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 35 cost time: 0.9353995323181152
Epoch: 35, Steps: 64 | Train Loss: 0.0846628 Vali Loss: 0.2178099 Test Loss: 0.2897811
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 36 cost time: 0.9408450126647949
Epoch: 36, Steps: 64 | Train Loss: 0.0845549 Vali Loss: 0.2165128 Test Loss: 0.2894235
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 37 cost time: 0.9380002021789551
Epoch: 37, Steps: 64 | Train Loss: 0.0848047 Vali Loss: 0.2162547 Test Loss: 0.2899987
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 38 cost time: 0.9356310367584229
Epoch: 38, Steps: 64 | Train Loss: 0.0850194 Vali Loss: 0.2167215 Test Loss: 0.2893377
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 39 cost time: 0.9377129077911377
Epoch: 39, Steps: 64 | Train Loss: 0.0839256 Vali Loss: 0.2156784 Test Loss: 0.2897995
Validation loss decreased (0.216230 --> 0.215678).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 40 cost time: 0.930424690246582
Epoch: 40, Steps: 64 | Train Loss: 0.0844502 Vali Loss: 0.2158535 Test Loss: 0.2903624
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 41 cost time: 0.9353909492492676
Epoch: 41, Steps: 64 | Train Loss: 0.0845566 Vali Loss: 0.2153056 Test Loss: 0.2894271
Validation loss decreased (0.215678 --> 0.215306).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 42 cost time: 0.9463746547698975
Epoch: 42, Steps: 64 | Train Loss: 0.0839941 Vali Loss: 0.2162513 Test Loss: 0.2893451
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 43 cost time: 0.9418799877166748
Epoch: 43, Steps: 64 | Train Loss: 0.0845013 Vali Loss: 0.2166564 Test Loss: 0.2894832
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 44 cost time: 0.9392750263214111
Epoch: 44, Steps: 64 | Train Loss: 0.0845505 Vali Loss: 0.2171224 Test Loss: 0.2904002
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 45 cost time: 0.9350001811981201
Epoch: 45, Steps: 64 | Train Loss: 0.0847161 Vali Loss: 0.2160958 Test Loss: 0.2901617
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 46 cost time: 0.9480001926422119
Epoch: 46, Steps: 64 | Train Loss: 0.0834621 Vali Loss: 0.2172887 Test Loss: 0.2904765
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 47 cost time: 0.9340133666992188
Epoch: 47, Steps: 64 | Train Loss: 0.0844875 Vali Loss: 0.2189570 Test Loss: 0.2899139
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 48 cost time: 0.9353797435760498
Epoch: 48, Steps: 64 | Train Loss: 0.0843632 Vali Loss: 0.2158494 Test Loss: 0.2895000
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 49 cost time: 0.9400324821472168
Epoch: 49, Steps: 64 | Train Loss: 0.0840521 Vali Loss: 0.2167818 Test Loss: 0.2900486
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 50 cost time: 0.9338536262512207
Epoch: 50, Steps: 64 | Train Loss: 0.0841216 Vali Loss: 0.2156987 Test Loss: 0.2900506
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 51 cost time: 0.9374001026153564
Epoch: 51, Steps: 64 | Train Loss: 0.0844547 Vali Loss: 0.2162993 Test Loss: 0.2905053
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 52 cost time: 0.9343874454498291
Epoch: 52, Steps: 64 | Train Loss: 0.0841835 Vali Loss: 0.2166906 Test Loss: 0.2904117
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 53 cost time: 0.9367814064025879
Epoch: 53, Steps: 64 | Train Loss: 0.0839565 Vali Loss: 0.2166507 Test Loss: 0.2903766
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 54 cost time: 0.9399998188018799
Epoch: 54, Steps: 64 | Train Loss: 0.0839655 Vali Loss: 0.2175211 Test Loss: 0.2910202
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 55 cost time: 0.9339995384216309
Epoch: 55, Steps: 64 | Train Loss: 0.0843253 Vali Loss: 0.2165743 Test Loss: 0.2907380
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 56 cost time: 0.9426229000091553
Epoch: 56, Steps: 64 | Train Loss: 0.0836720 Vali Loss: 0.2169099 Test Loss: 0.2908118
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 57 cost time: 0.931389570236206
Epoch: 57, Steps: 64 | Train Loss: 0.0842785 Vali Loss: 0.2176302 Test Loss: 0.2914273
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 58 cost time: 0.9296481609344482
Epoch: 58, Steps: 64 | Train Loss: 0.0842123 Vali Loss: 0.2142202 Test Loss: 0.2898612
Validation loss decreased (0.215306 --> 0.214220).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 59 cost time: 0.9451882839202881
Epoch: 59, Steps: 64 | Train Loss: 0.0840866 Vali Loss: 0.2166704 Test Loss: 0.2895514
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 60 cost time: 0.9353876113891602
Epoch: 60, Steps: 64 | Train Loss: 0.0838151 Vali Loss: 0.2173871 Test Loss: 0.2909898
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2898612320423126, mae:0.36242029070854187, rse:0.2470972239971161
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.04998350143432617 GB
Epoch: 1 cost time: 2.2462806701660156
Epoch: 1, Steps: 64 | Train Loss: 1.0029667 Vali Loss: 2.9937944 Test Loss: 5.2831669
Validation loss decreased (inf --> 2.993794).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 2 cost time: 0.8849999904632568
Epoch: 2, Steps: 64 | Train Loss: 0.7913394 Vali Loss: 1.8072954 Test Loss: 3.0369954
Validation loss decreased (2.993794 --> 1.807295).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 3 cost time: 0.8645648956298828
Epoch: 3, Steps: 64 | Train Loss: 0.5224837 Vali Loss: 1.3291385 Test Loss: 2.1522930
Validation loss decreased (1.807295 --> 1.329139).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 4 cost time: 0.8906261920928955
Epoch: 4, Steps: 64 | Train Loss: 0.3939062 Vali Loss: 1.0458207 Test Loss: 1.6308031
Validation loss decreased (1.329139 --> 1.045821).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 5 cost time: 0.8763904571533203
Epoch: 5, Steps: 64 | Train Loss: 0.3086780 Vali Loss: 0.8462673 Test Loss: 1.2809404
Validation loss decreased (1.045821 --> 0.846267).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 6 cost time: 0.872098445892334
Epoch: 6, Steps: 64 | Train Loss: 0.2509420 Vali Loss: 0.6798844 Test Loss: 1.0210412
Validation loss decreased (0.846267 --> 0.679884).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 7 cost time: 0.870434045791626
Epoch: 7, Steps: 64 | Train Loss: 0.2107025 Vali Loss: 0.5705035 Test Loss: 0.8326066
Validation loss decreased (0.679884 --> 0.570503).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 8 cost time: 0.8693296909332275
Epoch: 8, Steps: 64 | Train Loss: 0.1826755 Vali Loss: 0.4885418 Test Loss: 0.6992298
Validation loss decreased (0.570503 --> 0.488542).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 9 cost time: 0.8640000820159912
Epoch: 9, Steps: 64 | Train Loss: 0.1629705 Vali Loss: 0.4380388 Test Loss: 0.6186528
Validation loss decreased (0.488542 --> 0.438039).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 10 cost time: 0.885636568069458
Epoch: 10, Steps: 64 | Train Loss: 0.1481468 Vali Loss: 0.3904683 Test Loss: 0.5450135
Validation loss decreased (0.438039 --> 0.390468).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 11 cost time: 0.8752756118774414
Epoch: 11, Steps: 64 | Train Loss: 0.1382349 Vali Loss: 0.3546865 Test Loss: 0.4886047
Validation loss decreased (0.390468 --> 0.354686).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 12 cost time: 0.8734557628631592
Epoch: 12, Steps: 64 | Train Loss: 0.1292729 Vali Loss: 0.3415279 Test Loss: 0.4646987
Validation loss decreased (0.354686 --> 0.341528).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 13 cost time: 0.8843820095062256
Epoch: 13, Steps: 64 | Train Loss: 0.1248958 Vali Loss: 0.3187529 Test Loss: 0.4289400
Validation loss decreased (0.341528 --> 0.318753).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 14 cost time: 0.9468722343444824
Epoch: 14, Steps: 64 | Train Loss: 0.1198117 Vali Loss: 0.3055361 Test Loss: 0.4050705
Validation loss decreased (0.318753 --> 0.305536).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 15 cost time: 0.9483880996704102
Epoch: 15, Steps: 64 | Train Loss: 0.1164796 Vali Loss: 0.2950605 Test Loss: 0.3891699
Validation loss decreased (0.305536 --> 0.295060).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 16 cost time: 0.8699994087219238
Epoch: 16, Steps: 64 | Train Loss: 0.1142414 Vali Loss: 0.2833050 Test Loss: 0.3744478
Validation loss decreased (0.295060 --> 0.283305).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 17 cost time: 0.874629020690918
Epoch: 17, Steps: 64 | Train Loss: 0.1115104 Vali Loss: 0.2814189 Test Loss: 0.3692774
Validation loss decreased (0.283305 --> 0.281419).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 18 cost time: 0.8683409690856934
Epoch: 18, Steps: 64 | Train Loss: 0.1098683 Vali Loss: 0.2765068 Test Loss: 0.3594853
Validation loss decreased (0.281419 --> 0.276507).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 19 cost time: 0.8700048923492432
Epoch: 19, Steps: 64 | Train Loss: 0.1091054 Vali Loss: 0.2699827 Test Loss: 0.3488204
Validation loss decreased (0.276507 --> 0.269983).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 20 cost time: 0.8884437084197998
Epoch: 20, Steps: 64 | Train Loss: 0.1071372 Vali Loss: 0.2655226 Test Loss: 0.3439237
Validation loss decreased (0.269983 --> 0.265523).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 21 cost time: 0.8739995956420898
Epoch: 21, Steps: 64 | Train Loss: 0.1064890 Vali Loss: 0.2637361 Test Loss: 0.3398605
Validation loss decreased (0.265523 --> 0.263736).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 22 cost time: 0.880000114440918
Epoch: 22, Steps: 64 | Train Loss: 0.1057294 Vali Loss: 0.2604742 Test Loss: 0.3367158
Validation loss decreased (0.263736 --> 0.260474).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 23 cost time: 0.8696112632751465
Epoch: 23, Steps: 64 | Train Loss: 0.1044759 Vali Loss: 0.2588789 Test Loss: 0.3324859
Validation loss decreased (0.260474 --> 0.258879).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 24 cost time: 0.8692605495452881
Epoch: 24, Steps: 64 | Train Loss: 0.1047980 Vali Loss: 0.2589445 Test Loss: 0.3291987
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 25 cost time: 0.8693523406982422
Epoch: 25, Steps: 64 | Train Loss: 0.1041336 Vali Loss: 0.2571083 Test Loss: 0.3264411
Validation loss decreased (0.258879 --> 0.257108).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 26 cost time: 0.8703672885894775
Epoch: 26, Steps: 64 | Train Loss: 0.1028386 Vali Loss: 0.2519218 Test Loss: 0.3213970
Validation loss decreased (0.257108 --> 0.251922).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 27 cost time: 0.8699986934661865
Epoch: 27, Steps: 64 | Train Loss: 0.1026673 Vali Loss: 0.2527164 Test Loss: 0.3199742
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 28 cost time: 0.8633863925933838
Epoch: 28, Steps: 64 | Train Loss: 0.1023380 Vali Loss: 0.2521439 Test Loss: 0.3211387
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 29 cost time: 0.8766207695007324
Epoch: 29, Steps: 64 | Train Loss: 0.1020159 Vali Loss: 0.2518543 Test Loss: 0.3198520
Validation loss decreased (0.251922 --> 0.251854).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 30 cost time: 0.8783257007598877
Epoch: 30, Steps: 64 | Train Loss: 0.1014376 Vali Loss: 0.2456683 Test Loss: 0.3171224
Validation loss decreased (0.251854 --> 0.245668).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 31 cost time: 0.8861515522003174
Epoch: 31, Steps: 64 | Train Loss: 0.1019061 Vali Loss: 0.2489368 Test Loss: 0.3172448
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 32 cost time: 0.8743596076965332
Epoch: 32, Steps: 64 | Train Loss: 0.1021689 Vali Loss: 0.2481478 Test Loss: 0.3152743
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 33 cost time: 0.8710002899169922
Epoch: 33, Steps: 64 | Train Loss: 0.1006378 Vali Loss: 0.2473701 Test Loss: 0.3147765
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 34 cost time: 0.8669998645782471
Epoch: 34, Steps: 64 | Train Loss: 0.1007681 Vali Loss: 0.2481865 Test Loss: 0.3139713
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 35 cost time: 0.8824572563171387
Epoch: 35, Steps: 64 | Train Loss: 0.1004407 Vali Loss: 0.2482282 Test Loss: 0.3159903
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 36 cost time: 0.8673641681671143
Epoch: 36, Steps: 64 | Train Loss: 0.1008063 Vali Loss: 0.2492725 Test Loss: 0.3135992
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 37 cost time: 0.8803958892822266
Epoch: 37, Steps: 64 | Train Loss: 0.1004310 Vali Loss: 0.2447757 Test Loss: 0.3111975
Validation loss decreased (0.245668 --> 0.244776).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 38 cost time: 0.8860719203948975
Epoch: 38, Steps: 64 | Train Loss: 0.1006074 Vali Loss: 0.2436942 Test Loss: 0.3095268
Validation loss decreased (0.244776 --> 0.243694).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 39 cost time: 0.8769998550415039
Epoch: 39, Steps: 64 | Train Loss: 0.1001388 Vali Loss: 0.2433397 Test Loss: 0.3101423
Validation loss decreased (0.243694 --> 0.243340).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 40 cost time: 0.8770005702972412
Epoch: 40, Steps: 64 | Train Loss: 0.1005042 Vali Loss: 0.2436393 Test Loss: 0.3101312
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 41 cost time: 0.8681662082672119
Epoch: 41, Steps: 64 | Train Loss: 0.1000957 Vali Loss: 0.2416097 Test Loss: 0.3114723
Validation loss decreased (0.243340 --> 0.241610).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 42 cost time: 0.8733608722686768
Epoch: 42, Steps: 64 | Train Loss: 0.1000647 Vali Loss: 0.2444502 Test Loss: 0.3096505
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 43 cost time: 0.8723595142364502
Epoch: 43, Steps: 64 | Train Loss: 0.1002337 Vali Loss: 0.2420945 Test Loss: 0.3100326
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 44 cost time: 0.8707637786865234
Epoch: 44, Steps: 64 | Train Loss: 0.0996907 Vali Loss: 0.2443258 Test Loss: 0.3109697
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 45 cost time: 0.8670001029968262
Epoch: 45, Steps: 64 | Train Loss: 0.0997004 Vali Loss: 0.2437162 Test Loss: 0.3101371
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 46 cost time: 0.8782522678375244
Epoch: 46, Steps: 64 | Train Loss: 0.1000109 Vali Loss: 0.2446473 Test Loss: 0.3085169
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 47 cost time: 0.8783540725708008
Epoch: 47, Steps: 64 | Train Loss: 0.0994958 Vali Loss: 0.2408932 Test Loss: 0.3079896
Validation loss decreased (0.241610 --> 0.240893).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 48 cost time: 0.8713562488555908
Epoch: 48, Steps: 64 | Train Loss: 0.0994706 Vali Loss: 0.2427807 Test Loss: 0.3097656
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 49 cost time: 0.8823578357696533
Epoch: 49, Steps: 64 | Train Loss: 0.0999659 Vali Loss: 0.2429110 Test Loss: 0.3077394
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 50 cost time: 0.8637824058532715
Epoch: 50, Steps: 64 | Train Loss: 0.0995343 Vali Loss: 0.2432254 Test Loss: 0.3091833
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 51 cost time: 0.8720002174377441
Epoch: 51, Steps: 64 | Train Loss: 0.0990336 Vali Loss: 0.2440015 Test Loss: 0.3077447
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 52 cost time: 0.8666064739227295
Epoch: 52, Steps: 64 | Train Loss: 0.0993796 Vali Loss: 0.2422756 Test Loss: 0.3097418
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 53 cost time: 0.8663482666015625
Epoch: 53, Steps: 64 | Train Loss: 0.0991209 Vali Loss: 0.2413534 Test Loss: 0.3067978
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 54 cost time: 0.8714075088500977
Epoch: 54, Steps: 64 | Train Loss: 0.0998247 Vali Loss: 0.2444687 Test Loss: 0.3084015
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 55 cost time: 0.8796939849853516
Epoch: 55, Steps: 64 | Train Loss: 0.0992165 Vali Loss: 0.2405527 Test Loss: 0.3075081
Validation loss decreased (0.240893 --> 0.240553).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 56 cost time: 0.8799254894256592
Epoch: 56, Steps: 64 | Train Loss: 0.0992365 Vali Loss: 0.2443274 Test Loss: 0.3090458
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 57 cost time: 0.8760006427764893
Epoch: 57, Steps: 64 | Train Loss: 0.0992710 Vali Loss: 0.2418752 Test Loss: 0.3077270
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 58 cost time: 0.8736112117767334
Epoch: 58, Steps: 64 | Train Loss: 0.1002954 Vali Loss: 0.2437932 Test Loss: 0.3047673
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 59 cost time: 0.8698384761810303
Epoch: 59, Steps: 64 | Train Loss: 0.0993901 Vali Loss: 0.2394516 Test Loss: 0.3063834
Validation loss decreased (0.240553 --> 0.239452).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 60 cost time: 0.8783895969390869
Epoch: 60, Steps: 64 | Train Loss: 0.0990902 Vali Loss: 0.2422916 Test Loss: 0.3076956
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.3063833713531494, mae:0.3714214861392975, rse:0.2540419399738312
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 1 cost time: 2.294163227081299
Epoch: 1, Steps: 64 | Train Loss: 0.8789249 Vali Loss: 2.6934388 Test Loss: 4.7361736
Validation loss decreased (inf --> 2.693439).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 2 cost time: 0.9117567539215088
Epoch: 2, Steps: 64 | Train Loss: 0.5850577 Vali Loss: 0.8636321 Test Loss: 1.3160861
Validation loss decreased (2.693439 --> 0.863632).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 3 cost time: 0.9129998683929443
Epoch: 3, Steps: 64 | Train Loss: 0.1796510 Vali Loss: 0.3002598 Test Loss: 0.3067113
Validation loss decreased (0.863632 --> 0.300260).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 4 cost time: 0.9152419567108154
Epoch: 4, Steps: 64 | Train Loss: 0.1184707 Vali Loss: 0.2756605 Test Loss: 0.3012130
Validation loss decreased (0.300260 --> 0.275660).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 5 cost time: 0.9066176414489746
Epoch: 5, Steps: 64 | Train Loss: 0.1102123 Vali Loss: 0.2619987 Test Loss: 0.2961711
Validation loss decreased (0.275660 --> 0.261999).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 6 cost time: 0.9044196605682373
Epoch: 6, Steps: 64 | Train Loss: 0.1054302 Vali Loss: 0.2545819 Test Loss: 0.2932442
Validation loss decreased (0.261999 --> 0.254582).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 7 cost time: 0.8983321189880371
Epoch: 7, Steps: 64 | Train Loss: 0.1029605 Vali Loss: 0.2517019 Test Loss: 0.2896620
Validation loss decreased (0.254582 --> 0.251702).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 8 cost time: 0.9013843536376953
Epoch: 8, Steps: 64 | Train Loss: 0.0999528 Vali Loss: 0.2449346 Test Loss: 0.2908505
Validation loss decreased (0.251702 --> 0.244935).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 9 cost time: 0.9010148048400879
Epoch: 9, Steps: 64 | Train Loss: 0.0986708 Vali Loss: 0.2434652 Test Loss: 0.2884973
Validation loss decreased (0.244935 --> 0.243465).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 10 cost time: 0.9179670810699463
Epoch: 10, Steps: 64 | Train Loss: 0.0970405 Vali Loss: 0.2390516 Test Loss: 0.2892464
Validation loss decreased (0.243465 --> 0.239052).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 11 cost time: 0.9139988422393799
Epoch: 11, Steps: 64 | Train Loss: 0.0957118 Vali Loss: 0.2400201 Test Loss: 0.2884089
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 12 cost time: 0.9076137542724609
Epoch: 12, Steps: 64 | Train Loss: 0.0942468 Vali Loss: 0.2363457 Test Loss: 0.2915894
Validation loss decreased (0.239052 --> 0.236346).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 13 cost time: 0.9082887172698975
Epoch: 13, Steps: 64 | Train Loss: 0.0931220 Vali Loss: 0.2408452 Test Loss: 0.2882666
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 14 cost time: 0.9103741645812988
Epoch: 14, Steps: 64 | Train Loss: 0.0923730 Vali Loss: 0.2381240 Test Loss: 0.2897194
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 15 cost time: 0.9023652076721191
Epoch: 15, Steps: 64 | Train Loss: 0.0919408 Vali Loss: 0.2360050 Test Loss: 0.2895809
Validation loss decreased (0.236346 --> 0.236005).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 16 cost time: 0.9014453887939453
Epoch: 16, Steps: 64 | Train Loss: 0.0908344 Vali Loss: 0.2338495 Test Loss: 0.2911674
Validation loss decreased (0.236005 --> 0.233850).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 17 cost time: 0.9052629470825195
Epoch: 17, Steps: 64 | Train Loss: 0.0900971 Vali Loss: 0.2335357 Test Loss: 0.2895758
Validation loss decreased (0.233850 --> 0.233536).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 18 cost time: 0.9897911548614502
Epoch: 18, Steps: 64 | Train Loss: 0.0897757 Vali Loss: 0.2290248 Test Loss: 0.2908095
Validation loss decreased (0.233536 --> 0.229025).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 19 cost time: 0.9814462661743164
Epoch: 19, Steps: 64 | Train Loss: 0.0901050 Vali Loss: 0.2284713 Test Loss: 0.2919785
Validation loss decreased (0.229025 --> 0.228471).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 20 cost time: 0.9129993915557861
Epoch: 20, Steps: 64 | Train Loss: 0.0894040 Vali Loss: 0.2290196 Test Loss: 0.2920066
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 21 cost time: 0.913992166519165
Epoch: 21, Steps: 64 | Train Loss: 0.0885605 Vali Loss: 0.2335789 Test Loss: 0.2927286
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 22 cost time: 0.9273812770843506
Epoch: 22, Steps: 64 | Train Loss: 0.0887596 Vali Loss: 0.2271909 Test Loss: 0.2920343
Validation loss decreased (0.228471 --> 0.227191).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 23 cost time: 0.8963625431060791
Epoch: 23, Steps: 64 | Train Loss: 0.0883531 Vali Loss: 0.2307501 Test Loss: 0.2924929
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 24 cost time: 0.9023842811584473
Epoch: 24, Steps: 64 | Train Loss: 0.0875336 Vali Loss: 0.2278743 Test Loss: 0.2930794
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 25 cost time: 0.8947358131408691
Epoch: 25, Steps: 64 | Train Loss: 0.0868168 Vali Loss: 0.2280647 Test Loss: 0.2931147
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 26 cost time: 0.9083595275878906
Epoch: 26, Steps: 64 | Train Loss: 0.0867027 Vali Loss: 0.2285982 Test Loss: 0.2934420
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 27 cost time: 0.9100000858306885
Epoch: 27, Steps: 64 | Train Loss: 0.0873914 Vali Loss: 0.2272218 Test Loss: 0.2935924
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 28 cost time: 0.8746218681335449
Epoch: 28, Steps: 64 | Train Loss: 0.0868258 Vali Loss: 0.2261941 Test Loss: 0.2936933
Validation loss decreased (0.227191 --> 0.226194).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 29 cost time: 0.9139604568481445
Epoch: 29, Steps: 64 | Train Loss: 0.0860167 Vali Loss: 0.2294262 Test Loss: 0.2945971
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 30 cost time: 0.9052460193634033
Epoch: 30, Steps: 64 | Train Loss: 0.0864501 Vali Loss: 0.2297790 Test Loss: 0.2936936
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 31 cost time: 0.9045116901397705
Epoch: 31, Steps: 64 | Train Loss: 0.0861085 Vali Loss: 0.2269505 Test Loss: 0.2929657
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 32 cost time: 0.9007186889648438
Epoch: 32, Steps: 64 | Train Loss: 0.0859289 Vali Loss: 0.2263100 Test Loss: 0.2945050
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 33 cost time: 0.8978118896484375
Epoch: 33, Steps: 64 | Train Loss: 0.0856059 Vali Loss: 0.2251249 Test Loss: 0.2947269
Validation loss decreased (0.226194 --> 0.225125).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 34 cost time: 0.8983638286590576
Epoch: 34, Steps: 64 | Train Loss: 0.0861308 Vali Loss: 0.2249713 Test Loss: 0.2941475
Validation loss decreased (0.225125 --> 0.224971).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 35 cost time: 0.9086201190948486
Epoch: 35, Steps: 64 | Train Loss: 0.0858856 Vali Loss: 0.2261306 Test Loss: 0.2945952
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 36 cost time: 0.9123721122741699
Epoch: 36, Steps: 64 | Train Loss: 0.0856346 Vali Loss: 0.2245059 Test Loss: 0.2944060
Validation loss decreased (0.224971 --> 0.224506).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 37 cost time: 0.9073488712310791
Epoch: 37, Steps: 64 | Train Loss: 0.0854930 Vali Loss: 0.2249191 Test Loss: 0.2936978
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 38 cost time: 0.9224236011505127
Epoch: 38, Steps: 64 | Train Loss: 0.0853278 Vali Loss: 0.2263082 Test Loss: 0.2927599
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 39 cost time: 0.9103517532348633
Epoch: 39, Steps: 64 | Train Loss: 0.0849676 Vali Loss: 0.2273146 Test Loss: 0.2944981
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 40 cost time: 0.8964903354644775
Epoch: 40, Steps: 64 | Train Loss: 0.0856629 Vali Loss: 0.2266328 Test Loss: 0.2946440
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 41 cost time: 0.9009981155395508
Epoch: 41, Steps: 64 | Train Loss: 0.0847257 Vali Loss: 0.2257988 Test Loss: 0.2948672
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 42 cost time: 0.9050655364990234
Epoch: 42, Steps: 64 | Train Loss: 0.0852853 Vali Loss: 0.2248631 Test Loss: 0.2947316
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 43 cost time: 0.8992519378662109
Epoch: 43, Steps: 64 | Train Loss: 0.0855252 Vali Loss: 0.2271509 Test Loss: 0.2946354
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 44 cost time: 0.9054110050201416
Epoch: 44, Steps: 64 | Train Loss: 0.0848793 Vali Loss: 0.2250926 Test Loss: 0.2952192
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 45 cost time: 0.904935359954834
Epoch: 45, Steps: 64 | Train Loss: 0.0849287 Vali Loss: 0.2246344 Test Loss: 0.2958379
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 46 cost time: 0.9093408584594727
Epoch: 46, Steps: 64 | Train Loss: 0.0850046 Vali Loss: 0.2245380 Test Loss: 0.2949019
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 47 cost time: 0.9107143878936768
Epoch: 47, Steps: 64 | Train Loss: 0.0855536 Vali Loss: 0.2255452 Test Loss: 0.2948902
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 48 cost time: 0.9046266078948975
Epoch: 48, Steps: 64 | Train Loss: 0.0846275 Vali Loss: 0.2227647 Test Loss: 0.2945897
Validation loss decreased (0.224506 --> 0.222765).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 49 cost time: 0.8732519149780273
Epoch: 49, Steps: 64 | Train Loss: 0.0850526 Vali Loss: 0.2235292 Test Loss: 0.2947328
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 50 cost time: 0.904536247253418
Epoch: 50, Steps: 64 | Train Loss: 0.0846782 Vali Loss: 0.2270705 Test Loss: 0.2952278
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 51 cost time: 0.9024384021759033
Epoch: 51, Steps: 64 | Train Loss: 0.0845228 Vali Loss: 0.2260512 Test Loss: 0.2961503
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 52 cost time: 0.9101259708404541
Epoch: 52, Steps: 64 | Train Loss: 0.0847787 Vali Loss: 0.2236906 Test Loss: 0.2961785
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 53 cost time: 0.9107589721679688
Epoch: 53, Steps: 64 | Train Loss: 0.0845596 Vali Loss: 0.2226621 Test Loss: 0.2949655
Validation loss decreased (0.222765 --> 0.222662).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 54 cost time: 0.9147262573242188
Epoch: 54, Steps: 64 | Train Loss: 0.0849410 Vali Loss: 0.2242019 Test Loss: 0.2948070
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 55 cost time: 0.9110002517700195
Epoch: 55, Steps: 64 | Train Loss: 0.0849606 Vali Loss: 0.2232244 Test Loss: 0.2946735
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 56 cost time: 0.91306471824646
Epoch: 56, Steps: 64 | Train Loss: 0.0844680 Vali Loss: 0.2253092 Test Loss: 0.2954921
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 57 cost time: 0.9025101661682129
Epoch: 57, Steps: 64 | Train Loss: 0.0846972 Vali Loss: 0.2249955 Test Loss: 0.2949455
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 58 cost time: 0.9085416793823242
Epoch: 58, Steps: 64 | Train Loss: 0.0843826 Vali Loss: 0.2249845 Test Loss: 0.2935960
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 59 cost time: 0.9183990955352783
Epoch: 59, Steps: 64 | Train Loss: 0.0851181 Vali Loss: 0.2256151 Test Loss: 0.2939924
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 60 cost time: 0.9043691158294678
Epoch: 60, Steps: 64 | Train Loss: 0.0846822 Vali Loss: 0.2222149 Test Loss: 0.2952401
Validation loss decreased (0.222662 --> 0.222215).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2952401041984558, mae:0.37337642908096313, rse:0.24937935173511505
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05727052688598633 GB
Epoch: 1 cost time: 2.399531364440918
Epoch: 1, Steps: 64 | Train Loss: 0.8435403 Vali Loss: 2.6177647 Test Loss: 4.6223712
Validation loss decreased (inf --> 2.617765).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 2 cost time: 0.9737756252288818
Epoch: 2, Steps: 64 | Train Loss: 0.4969870 Vali Loss: 0.3934514 Test Loss: 0.4004266
Validation loss decreased (2.617765 --> 0.393451).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 3 cost time: 0.9509987831115723
Epoch: 3, Steps: 64 | Train Loss: 0.1304690 Vali Loss: 0.3020114 Test Loss: 0.3460355
Validation loss decreased (0.393451 --> 0.302011).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 4 cost time: 0.9489998817443848
Epoch: 4, Steps: 64 | Train Loss: 0.1103422 Vali Loss: 0.2619901 Test Loss: 0.2920106
Validation loss decreased (0.302011 --> 0.261990).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 5 cost time: 0.9520187377929688
Epoch: 5, Steps: 64 | Train Loss: 0.1039151 Vali Loss: 0.2562338 Test Loss: 0.2914475
Validation loss decreased (0.261990 --> 0.256234).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 6 cost time: 0.9456038475036621
Epoch: 6, Steps: 64 | Train Loss: 0.1006346 Vali Loss: 0.2581195 Test Loss: 0.2870966
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 7 cost time: 0.9300322532653809
Epoch: 7, Steps: 64 | Train Loss: 0.0977944 Vali Loss: 0.2430191 Test Loss: 0.2907935
Validation loss decreased (0.256234 --> 0.243019).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 8 cost time: 0.934403657913208
Epoch: 8, Steps: 64 | Train Loss: 0.0949318 Vali Loss: 0.2461579 Test Loss: 0.2901222
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 9 cost time: 0.936335563659668
Epoch: 9, Steps: 64 | Train Loss: 0.0935579 Vali Loss: 0.2404314 Test Loss: 0.2903538
Validation loss decreased (0.243019 --> 0.240431).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 10 cost time: 0.9424111843109131
Epoch: 10, Steps: 64 | Train Loss: 0.0925596 Vali Loss: 0.2373590 Test Loss: 0.2922861
Validation loss decreased (0.240431 --> 0.237359).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 11 cost time: 0.9433236122131348
Epoch: 11, Steps: 64 | Train Loss: 0.0911931 Vali Loss: 0.2376643 Test Loss: 0.2947128
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 12 cost time: 0.9567849636077881
Epoch: 12, Steps: 64 | Train Loss: 0.0909149 Vali Loss: 0.2361328 Test Loss: 0.2919632
Validation loss decreased (0.237359 --> 0.236133).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 13 cost time: 0.941777229309082
Epoch: 13, Steps: 64 | Train Loss: 0.0890251 Vali Loss: 0.2309676 Test Loss: 0.2942898
Validation loss decreased (0.236133 --> 0.230968).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 14 cost time: 0.9330000877380371
Epoch: 14, Steps: 64 | Train Loss: 0.0884073 Vali Loss: 0.2330608 Test Loss: 0.2961161
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 15 cost time: 0.9316165447235107
Epoch: 15, Steps: 64 | Train Loss: 0.0874520 Vali Loss: 0.2334744 Test Loss: 0.2967592
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 16 cost time: 0.9405064582824707
Epoch: 16, Steps: 64 | Train Loss: 0.0870776 Vali Loss: 0.2295967 Test Loss: 0.2975096
Validation loss decreased (0.230968 --> 0.229597).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 17 cost time: 0.9392015933990479
Epoch: 17, Steps: 64 | Train Loss: 0.0863428 Vali Loss: 0.2270815 Test Loss: 0.2973634
Validation loss decreased (0.229597 --> 0.227082).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 18 cost time: 0.94840407371521
Epoch: 18, Steps: 64 | Train Loss: 0.0855119 Vali Loss: 0.2272381 Test Loss: 0.2986725
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 19 cost time: 0.9583330154418945
Epoch: 19, Steps: 64 | Train Loss: 0.0847043 Vali Loss: 0.2243156 Test Loss: 0.2980676
Validation loss decreased (0.227082 --> 0.224316).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 20 cost time: 0.9444634914398193
Epoch: 20, Steps: 64 | Train Loss: 0.0844333 Vali Loss: 0.2273709 Test Loss: 0.3009248
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 21 cost time: 0.9447920322418213
Epoch: 21, Steps: 64 | Train Loss: 0.0843544 Vali Loss: 0.2292681 Test Loss: 0.3006990
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 22 cost time: 0.9403495788574219
Epoch: 22, Steps: 64 | Train Loss: 0.0841800 Vali Loss: 0.2269988 Test Loss: 0.3015772
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 23 cost time: 0.9100003242492676
Epoch: 23, Steps: 64 | Train Loss: 0.0835398 Vali Loss: 0.2258045 Test Loss: 0.3002033
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 24 cost time: 0.9376201629638672
Epoch: 24, Steps: 64 | Train Loss: 0.0836371 Vali Loss: 0.2247066 Test Loss: 0.3029867
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 25 cost time: 0.9364006519317627
Epoch: 25, Steps: 64 | Train Loss: 0.0831549 Vali Loss: 0.2258715 Test Loss: 0.3031341
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 26 cost time: 0.9443902969360352
Epoch: 26, Steps: 64 | Train Loss: 0.0829023 Vali Loss: 0.2249917 Test Loss: 0.3019429
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 27 cost time: 0.9453623294830322
Epoch: 27, Steps: 64 | Train Loss: 0.0826769 Vali Loss: 0.2264676 Test Loss: 0.3032317
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 28 cost time: 0.9455690383911133
Epoch: 28, Steps: 64 | Train Loss: 0.0825490 Vali Loss: 0.2224219 Test Loss: 0.3032228
Validation loss decreased (0.224316 --> 0.222422).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 29 cost time: 0.953373908996582
Epoch: 29, Steps: 64 | Train Loss: 0.0830217 Vali Loss: 0.2240376 Test Loss: 0.3029835
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 30 cost time: 0.9398274421691895
Epoch: 30, Steps: 64 | Train Loss: 0.0828260 Vali Loss: 0.2226279 Test Loss: 0.3032758
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 31 cost time: 0.9367423057556152
Epoch: 31, Steps: 64 | Train Loss: 0.0822266 Vali Loss: 0.2230360 Test Loss: 0.3037248
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 32 cost time: 0.9442896842956543
Epoch: 32, Steps: 64 | Train Loss: 0.0821407 Vali Loss: 0.2215415 Test Loss: 0.3046979
Validation loss decreased (0.222422 --> 0.221542).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 33 cost time: 0.935633659362793
Epoch: 33, Steps: 64 | Train Loss: 0.0825950 Vali Loss: 0.2220996 Test Loss: 0.3053259
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 34 cost time: 0.9342620372772217
Epoch: 34, Steps: 64 | Train Loss: 0.0820390 Vali Loss: 0.2235180 Test Loss: 0.3033606
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 35 cost time: 0.9413940906524658
Epoch: 35, Steps: 64 | Train Loss: 0.0818587 Vali Loss: 0.2224364 Test Loss: 0.3042207
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 36 cost time: 0.9593842029571533
Epoch: 36, Steps: 64 | Train Loss: 0.0818243 Vali Loss: 0.2230055 Test Loss: 0.3046388
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 37 cost time: 0.940349817276001
Epoch: 37, Steps: 64 | Train Loss: 0.0820463 Vali Loss: 0.2231601 Test Loss: 0.3038293
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 38 cost time: 0.9414558410644531
Epoch: 38, Steps: 64 | Train Loss: 0.0819583 Vali Loss: 0.2225586 Test Loss: 0.3039353
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 39 cost time: 0.9872796535491943
Epoch: 39, Steps: 64 | Train Loss: 0.0816631 Vali Loss: 0.2212501 Test Loss: 0.3045264
Validation loss decreased (0.221542 --> 0.221250).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 40 cost time: 0.9750070571899414
Epoch: 40, Steps: 64 | Train Loss: 0.0820532 Vali Loss: 0.2218502 Test Loss: 0.3051686
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 41 cost time: 0.9384562969207764
Epoch: 41, Steps: 64 | Train Loss: 0.0813576 Vali Loss: 0.2249111 Test Loss: 0.3040391
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 42 cost time: 0.9474623203277588
Epoch: 42, Steps: 64 | Train Loss: 0.0818374 Vali Loss: 0.2273098 Test Loss: 0.3053281
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 43 cost time: 0.9416208267211914
Epoch: 43, Steps: 64 | Train Loss: 0.0817905 Vali Loss: 0.2207854 Test Loss: 0.3045749
Validation loss decreased (0.221250 --> 0.220785).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 44 cost time: 0.9466164112091064
Epoch: 44, Steps: 64 | Train Loss: 0.0822202 Vali Loss: 0.2218991 Test Loss: 0.3047605
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 45 cost time: 0.9409995079040527
Epoch: 45, Steps: 64 | Train Loss: 0.0825311 Vali Loss: 0.2235916 Test Loss: 0.3058122
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 46 cost time: 0.9186849594116211
Epoch: 46, Steps: 64 | Train Loss: 0.0818666 Vali Loss: 0.2245541 Test Loss: 0.3050952
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 47 cost time: 0.9080872535705566
Epoch: 47, Steps: 64 | Train Loss: 0.0815135 Vali Loss: 0.2253356 Test Loss: 0.3051175
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 48 cost time: 0.9117307662963867
Epoch: 48, Steps: 64 | Train Loss: 0.0816103 Vali Loss: 0.2263050 Test Loss: 0.3047560
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 49 cost time: 0.932464599609375
Epoch: 49, Steps: 64 | Train Loss: 0.0822981 Vali Loss: 0.2224056 Test Loss: 0.3048673
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 50 cost time: 0.9330000877380371
Epoch: 50, Steps: 64 | Train Loss: 0.0815846 Vali Loss: 0.2223219 Test Loss: 0.3051696
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 51 cost time: 0.9479997158050537
Epoch: 51, Steps: 64 | Train Loss: 0.0816375 Vali Loss: 0.2247794 Test Loss: 0.3050542
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 52 cost time: 0.94461989402771
Epoch: 52, Steps: 64 | Train Loss: 0.0820789 Vali Loss: 0.2257939 Test Loss: 0.3054876
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 53 cost time: 1.0233428478240967
Epoch: 53, Steps: 64 | Train Loss: 0.0812721 Vali Loss: 0.2240273 Test Loss: 0.3045291
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 54 cost time: 1.0255117416381836
Epoch: 54, Steps: 64 | Train Loss: 0.0814502 Vali Loss: 0.2249986 Test Loss: 0.3051994
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 55 cost time: 1.0194437503814697
Epoch: 55, Steps: 64 | Train Loss: 0.0814959 Vali Loss: 0.2197027 Test Loss: 0.3063409
Validation loss decreased (0.220785 --> 0.219703).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 56 cost time: 0.936882495880127
Epoch: 56, Steps: 64 | Train Loss: 0.0818223 Vali Loss: 0.2200022 Test Loss: 0.3051305
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 57 cost time: 0.9363844394683838
Epoch: 57, Steps: 64 | Train Loss: 0.0813903 Vali Loss: 0.2221492 Test Loss: 0.3053069
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 58 cost time: 0.9352633953094482
Epoch: 58, Steps: 64 | Train Loss: 0.0817443 Vali Loss: 0.2233097 Test Loss: 0.3046694
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 59 cost time: 0.9551055431365967
Epoch: 59, Steps: 64 | Train Loss: 0.0815521 Vali Loss: 0.2191407 Test Loss: 0.3046919
Validation loss decreased (0.219703 --> 0.219141).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 60 cost time: 0.9428198337554932
Epoch: 60, Steps: 64 | Train Loss: 0.0817391 Vali Loss: 0.2266529 Test Loss: 0.3064069
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.30469194054603577, mae:0.3862290382385254, rse:0.2533397078514099
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.05014467239379883 GB
Epoch: 1 cost time: 2.251265048980713
Epoch: 1, Steps: 64 | Train Loss: 0.8927024 Vali Loss: 2.6542106 Test Loss: 4.6559477
Validation loss decreased (inf --> 2.654211).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 2 cost time: 0.8926146030426025
Epoch: 2, Steps: 64 | Train Loss: 0.7425876 Vali Loss: 1.8002322 Test Loss: 3.0745122
Validation loss decreased (2.654211 --> 1.800232).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 3 cost time: 0.890610933303833
Epoch: 3, Steps: 64 | Train Loss: 0.5240989 Vali Loss: 1.3079461 Test Loss: 2.1559343
Validation loss decreased (1.800232 --> 1.307946).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 4 cost time: 0.885366678237915
Epoch: 4, Steps: 64 | Train Loss: 0.3949542 Vali Loss: 1.0280248 Test Loss: 1.6569173
Validation loss decreased (1.307946 --> 1.028025).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 5 cost time: 0.8912839889526367
Epoch: 5, Steps: 64 | Train Loss: 0.3095161 Vali Loss: 0.8166273 Test Loss: 1.3011827
Validation loss decreased (1.028025 --> 0.816627).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 6 cost time: 0.8770134449005127
Epoch: 6, Steps: 64 | Train Loss: 0.2524675 Vali Loss: 0.6651530 Test Loss: 1.0445281
Validation loss decreased (0.816627 --> 0.665153).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 7 cost time: 0.8837816715240479
Epoch: 7, Steps: 64 | Train Loss: 0.2130230 Vali Loss: 0.5624942 Test Loss: 0.8657658
Validation loss decreased (0.665153 --> 0.562494).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 8 cost time: 0.8828697204589844
Epoch: 8, Steps: 64 | Train Loss: 0.1853238 Vali Loss: 0.4913567 Test Loss: 0.7367755
Validation loss decreased (0.562494 --> 0.491357).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 9 cost time: 0.9027297496795654
Epoch: 9, Steps: 64 | Train Loss: 0.1650401 Vali Loss: 0.4385242 Test Loss: 0.6450332
Validation loss decreased (0.491357 --> 0.438524).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 10 cost time: 0.8888452053070068
Epoch: 10, Steps: 64 | Train Loss: 0.1497907 Vali Loss: 0.4014962 Test Loss: 0.5784919
Validation loss decreased (0.438524 --> 0.401496).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 11 cost time: 0.8989658355712891
Epoch: 11, Steps: 64 | Train Loss: 0.1388436 Vali Loss: 0.3706833 Test Loss: 0.5266282
Validation loss decreased (0.401496 --> 0.370683).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 12 cost time: 0.8903226852416992
Epoch: 12, Steps: 64 | Train Loss: 0.1309248 Vali Loss: 0.3495849 Test Loss: 0.4876617
Validation loss decreased (0.370683 --> 0.349585).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 13 cost time: 0.9087469577789307
Epoch: 13, Steps: 64 | Train Loss: 0.1251312 Vali Loss: 0.3327341 Test Loss: 0.4583676
Validation loss decreased (0.349585 --> 0.332734).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 14 cost time: 0.8888065814971924
Epoch: 14, Steps: 64 | Train Loss: 0.1208836 Vali Loss: 0.3185767 Test Loss: 0.4320545
Validation loss decreased (0.332734 --> 0.318577).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 15 cost time: 0.8800003528594971
Epoch: 15, Steps: 64 | Train Loss: 0.1163171 Vali Loss: 0.3045132 Test Loss: 0.4080067
Validation loss decreased (0.318577 --> 0.304513).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 16 cost time: 0.8906123638153076
Epoch: 16, Steps: 64 | Train Loss: 0.1129360 Vali Loss: 0.2926490 Test Loss: 0.3943759
Validation loss decreased (0.304513 --> 0.292649).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 17 cost time: 0.8821091651916504
Epoch: 17, Steps: 64 | Train Loss: 0.1104008 Vali Loss: 0.2886364 Test Loss: 0.3826505
Validation loss decreased (0.292649 --> 0.288636).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 18 cost time: 0.884432315826416
Epoch: 18, Steps: 64 | Train Loss: 0.1088068 Vali Loss: 0.2853239 Test Loss: 0.3739334
Validation loss decreased (0.288636 --> 0.285324).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 19 cost time: 0.8943612575531006
Epoch: 19, Steps: 64 | Train Loss: 0.1062580 Vali Loss: 0.2794300 Test Loss: 0.3660391
Validation loss decreased (0.285324 --> 0.279430).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 20 cost time: 0.9053733348846436
Epoch: 20, Steps: 64 | Train Loss: 0.1053695 Vali Loss: 0.2715485 Test Loss: 0.3567202
Validation loss decreased (0.279430 --> 0.271549).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 21 cost time: 0.8958735466003418
Epoch: 21, Steps: 64 | Train Loss: 0.1040245 Vali Loss: 0.2717434 Test Loss: 0.3525436
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 22 cost time: 0.88899827003479
Epoch: 22, Steps: 64 | Train Loss: 0.1033853 Vali Loss: 0.2624209 Test Loss: 0.3482327
Validation loss decreased (0.271549 --> 0.262421).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 23 cost time: 0.8876159191131592
Epoch: 23, Steps: 64 | Train Loss: 0.1024509 Vali Loss: 0.2654375 Test Loss: 0.3428382
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 24 cost time: 0.8755340576171875
Epoch: 24, Steps: 64 | Train Loss: 0.1012484 Vali Loss: 0.2622049 Test Loss: 0.3401941
Validation loss decreased (0.262421 --> 0.262205).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 25 cost time: 0.8797500133514404
Epoch: 25, Steps: 64 | Train Loss: 0.1010657 Vali Loss: 0.2608394 Test Loss: 0.3379675
Validation loss decreased (0.262205 --> 0.260839).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 26 cost time: 0.8779864311218262
Epoch: 26, Steps: 64 | Train Loss: 0.1001827 Vali Loss: 0.2597930 Test Loss: 0.3345878
Validation loss decreased (0.260839 --> 0.259793).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 27 cost time: 0.8757297992706299
Epoch: 27, Steps: 64 | Train Loss: 0.0994823 Vali Loss: 0.2533345 Test Loss: 0.3307128
Validation loss decreased (0.259793 --> 0.253335).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 28 cost time: 0.8860001564025879
Epoch: 28, Steps: 64 | Train Loss: 0.0994567 Vali Loss: 0.2542043 Test Loss: 0.3283539
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 29 cost time: 0.885612964630127
Epoch: 29, Steps: 64 | Train Loss: 0.0988200 Vali Loss: 0.2566944 Test Loss: 0.3276333
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 30 cost time: 0.8880419731140137
Epoch: 30, Steps: 64 | Train Loss: 0.0981219 Vali Loss: 0.2496356 Test Loss: 0.3231801
Validation loss decreased (0.253335 --> 0.249636).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 31 cost time: 0.8706545829772949
Epoch: 31, Steps: 64 | Train Loss: 0.0981766 Vali Loss: 0.2528532 Test Loss: 0.3234406
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 32 cost time: 0.8794474601745605
Epoch: 32, Steps: 64 | Train Loss: 0.0979683 Vali Loss: 0.2476751 Test Loss: 0.3236353
Validation loss decreased (0.249636 --> 0.247675).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 33 cost time: 0.8817484378814697
Epoch: 33, Steps: 64 | Train Loss: 0.0974496 Vali Loss: 0.2511308 Test Loss: 0.3223234
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 34 cost time: 0.885838508605957
Epoch: 34, Steps: 64 | Train Loss: 0.0976234 Vali Loss: 0.2506985 Test Loss: 0.3220581
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 35 cost time: 0.8799002170562744
Epoch: 35, Steps: 64 | Train Loss: 0.0973389 Vali Loss: 0.2485271 Test Loss: 0.3214773
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 36 cost time: 0.8944301605224609
Epoch: 36, Steps: 64 | Train Loss: 0.0966769 Vali Loss: 0.2497217 Test Loss: 0.3201358
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 37 cost time: 0.8873639106750488
Epoch: 37, Steps: 64 | Train Loss: 0.0972155 Vali Loss: 0.2501233 Test Loss: 0.3185716
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 38 cost time: 0.9058008193969727
Epoch: 38, Steps: 64 | Train Loss: 0.0974965 Vali Loss: 0.2458317 Test Loss: 0.3154491
Validation loss decreased (0.247675 --> 0.245832).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 39 cost time: 0.8877875804901123
Epoch: 39, Steps: 64 | Train Loss: 0.0963257 Vali Loss: 0.2466659 Test Loss: 0.3173361
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 40 cost time: 0.8925430774688721
Epoch: 40, Steps: 64 | Train Loss: 0.0973534 Vali Loss: 0.2453802 Test Loss: 0.3178042
Validation loss decreased (0.245832 --> 0.245380).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 41 cost time: 0.8940000534057617
Epoch: 41, Steps: 64 | Train Loss: 0.0974200 Vali Loss: 0.2436065 Test Loss: 0.3161388
Validation loss decreased (0.245380 --> 0.243607).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 42 cost time: 0.8816430568695068
Epoch: 42, Steps: 64 | Train Loss: 0.0961067 Vali Loss: 0.2464437 Test Loss: 0.3154694
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 43 cost time: 0.8829669952392578
Epoch: 43, Steps: 64 | Train Loss: 0.0960941 Vali Loss: 0.2454661 Test Loss: 0.3128017
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 44 cost time: 0.8800029754638672
Epoch: 44, Steps: 64 | Train Loss: 0.0965716 Vali Loss: 0.2462707 Test Loss: 0.3153300
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 45 cost time: 0.9043760299682617
Epoch: 45, Steps: 64 | Train Loss: 0.0966380 Vali Loss: 0.2442797 Test Loss: 0.3152910
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 46 cost time: 0.8855726718902588
Epoch: 46, Steps: 64 | Train Loss: 0.0959868 Vali Loss: 0.2477369 Test Loss: 0.3145466
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 47 cost time: 0.887629508972168
Epoch: 47, Steps: 64 | Train Loss: 0.0958838 Vali Loss: 0.2425186 Test Loss: 0.3163496
Validation loss decreased (0.243607 --> 0.242519).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 48 cost time: 0.8908720016479492
Epoch: 48, Steps: 64 | Train Loss: 0.0961968 Vali Loss: 0.2438914 Test Loss: 0.3127896
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 49 cost time: 0.9686999320983887
Epoch: 49, Steps: 64 | Train Loss: 0.0958706 Vali Loss: 0.2427194 Test Loss: 0.3140729
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 50 cost time: 0.9643559455871582
Epoch: 50, Steps: 64 | Train Loss: 0.0961499 Vali Loss: 0.2461024 Test Loss: 0.3121018
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 51 cost time: 0.8821418285369873
Epoch: 51, Steps: 64 | Train Loss: 0.0960931 Vali Loss: 0.2444048 Test Loss: 0.3134406
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 52 cost time: 0.8752093315124512
Epoch: 52, Steps: 64 | Train Loss: 0.0953168 Vali Loss: 0.2457952 Test Loss: 0.3134759
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 53 cost time: 0.8785738945007324
Epoch: 53, Steps: 64 | Train Loss: 0.0957833 Vali Loss: 0.2416995 Test Loss: 0.3111855
Validation loss decreased (0.242519 --> 0.241699).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 54 cost time: 0.8949992656707764
Epoch: 54, Steps: 64 | Train Loss: 0.0950745 Vali Loss: 0.2441782 Test Loss: 0.3139101
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 55 cost time: 0.8965997695922852
Epoch: 55, Steps: 64 | Train Loss: 0.0959256 Vali Loss: 0.2443524 Test Loss: 0.3137337
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 56 cost time: 0.8944568634033203
Epoch: 56, Steps: 64 | Train Loss: 0.0957989 Vali Loss: 0.2432756 Test Loss: 0.3122463
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 57 cost time: 0.8933310508728027
Epoch: 57, Steps: 64 | Train Loss: 0.0964300 Vali Loss: 0.2428309 Test Loss: 0.3118593
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 58 cost time: 0.8903264999389648
Epoch: 58, Steps: 64 | Train Loss: 0.0956289 Vali Loss: 0.2444744 Test Loss: 0.3129259
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 59 cost time: 0.8943290710449219
Epoch: 59, Steps: 64 | Train Loss: 0.0960128 Vali Loss: 0.2430042 Test Loss: 0.3112350
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 60 cost time: 0.88899827003479
Epoch: 60, Steps: 64 | Train Loss: 0.0956701 Vali Loss: 0.2424636 Test Loss: 0.3124036
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.3111855089664459, mae:0.38308754563331604, rse:0.2560250759124756
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 1 cost time: 2.337325096130371
Epoch: 1, Steps: 64 | Train Loss: 0.8298803 Vali Loss: 2.5571089 Test Loss: 4.5062647
Validation loss decreased (inf --> 2.557109).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 2 cost time: 0.9326186180114746
Epoch: 2, Steps: 64 | Train Loss: 0.5018660 Vali Loss: 0.5110717 Test Loss: 0.7364309
Validation loss decreased (2.557109 --> 0.511072).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 3 cost time: 0.9266281127929688
Epoch: 3, Steps: 64 | Train Loss: 0.1373307 Vali Loss: 0.2627231 Test Loss: 0.2825388
Validation loss decreased (0.511072 --> 0.262723).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 4 cost time: 0.9313008785247803
Epoch: 4, Steps: 64 | Train Loss: 0.1104560 Vali Loss: 0.2553147 Test Loss: 0.2998696
Validation loss decreased (0.262723 --> 0.255315).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 5 cost time: 0.9212737083435059
Epoch: 5, Steps: 64 | Train Loss: 0.1048231 Vali Loss: 0.2505230 Test Loss: 0.2939460
Validation loss decreased (0.255315 --> 0.250523).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 6 cost time: 0.8989355564117432
Epoch: 6, Steps: 64 | Train Loss: 0.1017228 Vali Loss: 0.2415611 Test Loss: 0.2919788
Validation loss decreased (0.250523 --> 0.241561).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 7 cost time: 0.9144861698150635
Epoch: 7, Steps: 64 | Train Loss: 0.0985210 Vali Loss: 0.2423345 Test Loss: 0.2936424
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 8 cost time: 0.9117414951324463
Epoch: 8, Steps: 64 | Train Loss: 0.0974584 Vali Loss: 0.2421877 Test Loss: 0.2874958
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 9 cost time: 0.9180004596710205
Epoch: 9, Steps: 64 | Train Loss: 0.0957155 Vali Loss: 0.2372848 Test Loss: 0.2900684
Validation loss decreased (0.241561 --> 0.237285).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 10 cost time: 0.923410177230835
Epoch: 10, Steps: 64 | Train Loss: 0.0937893 Vali Loss: 0.2376180 Test Loss: 0.2880420
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 11 cost time: 0.9216272830963135
Epoch: 11, Steps: 64 | Train Loss: 0.0935107 Vali Loss: 0.2358358 Test Loss: 0.2885218
Validation loss decreased (0.237285 --> 0.235836).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 12 cost time: 0.933382511138916
Epoch: 12, Steps: 64 | Train Loss: 0.0916304 Vali Loss: 0.2345627 Test Loss: 0.2907184
Validation loss decreased (0.235836 --> 0.234563).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 13 cost time: 0.9223251342773438
Epoch: 13, Steps: 64 | Train Loss: 0.0910916 Vali Loss: 0.2320875 Test Loss: 0.2910847
Validation loss decreased (0.234563 --> 0.232087).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 14 cost time: 0.9160745143890381
Epoch: 14, Steps: 64 | Train Loss: 0.0900156 Vali Loss: 0.2314978 Test Loss: 0.2923207
Validation loss decreased (0.232087 --> 0.231498).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 15 cost time: 0.9133405685424805
Epoch: 15, Steps: 64 | Train Loss: 0.0895270 Vali Loss: 0.2315073 Test Loss: 0.2915796
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 16 cost time: 0.9278221130371094
Epoch: 16, Steps: 64 | Train Loss: 0.0888019 Vali Loss: 0.2312573 Test Loss: 0.2928527
Validation loss decreased (0.231498 --> 0.231257).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 17 cost time: 0.9179999828338623
Epoch: 17, Steps: 64 | Train Loss: 0.0879911 Vali Loss: 0.2306039 Test Loss: 0.2933730
Validation loss decreased (0.231257 --> 0.230604).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 18 cost time: 0.9237911701202393
Epoch: 18, Steps: 64 | Train Loss: 0.0877725 Vali Loss: 0.2303238 Test Loss: 0.2936485
Validation loss decreased (0.230604 --> 0.230324).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 19 cost time: 0.9376163482666016
Epoch: 19, Steps: 64 | Train Loss: 0.0866577 Vali Loss: 0.2266551 Test Loss: 0.2936234
Validation loss decreased (0.230324 --> 0.226655).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 20 cost time: 0.9285595417022705
Epoch: 20, Steps: 64 | Train Loss: 0.0866215 Vali Loss: 0.2301880 Test Loss: 0.2948507
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 21 cost time: 0.9274144172668457
Epoch: 21, Steps: 64 | Train Loss: 0.0858191 Vali Loss: 0.2254002 Test Loss: 0.2943762
Validation loss decreased (0.226655 --> 0.225400).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 22 cost time: 0.9181368350982666
Epoch: 22, Steps: 64 | Train Loss: 0.0860803 Vali Loss: 0.2270556 Test Loss: 0.2944411
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 23 cost time: 0.899273157119751
Epoch: 23, Steps: 64 | Train Loss: 0.0857571 Vali Loss: 0.2265063 Test Loss: 0.2946167
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 24 cost time: 0.8913726806640625
Epoch: 24, Steps: 64 | Train Loss: 0.0854776 Vali Loss: 0.2247562 Test Loss: 0.2944311
Validation loss decreased (0.225400 --> 0.224756).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 25 cost time: 0.9197933673858643
Epoch: 25, Steps: 64 | Train Loss: 0.0849362 Vali Loss: 0.2222758 Test Loss: 0.2955599
Validation loss decreased (0.224756 --> 0.222276).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 26 cost time: 0.9286742210388184
Epoch: 26, Steps: 64 | Train Loss: 0.0845909 Vali Loss: 0.2229860 Test Loss: 0.2957879
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 27 cost time: 0.9272387027740479
Epoch: 27, Steps: 64 | Train Loss: 0.0841659 Vali Loss: 0.2249894 Test Loss: 0.2964324
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 28 cost time: 0.9233584403991699
Epoch: 28, Steps: 64 | Train Loss: 0.0844610 Vali Loss: 0.2244387 Test Loss: 0.2968787
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 29 cost time: 0.931488037109375
Epoch: 29, Steps: 64 | Train Loss: 0.0837674 Vali Loss: 0.2215401 Test Loss: 0.2972340
Validation loss decreased (0.222276 --> 0.221540).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 30 cost time: 0.9214141368865967
Epoch: 30, Steps: 64 | Train Loss: 0.0838280 Vali Loss: 0.2234567 Test Loss: 0.2975313
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 31 cost time: 0.9129397869110107
Epoch: 31, Steps: 64 | Train Loss: 0.0837263 Vali Loss: 0.2247578 Test Loss: 0.2952180
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 32 cost time: 0.915351390838623
Epoch: 32, Steps: 64 | Train Loss: 0.0835121 Vali Loss: 0.2239610 Test Loss: 0.2966557
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 33 cost time: 0.9159507751464844
Epoch: 33, Steps: 64 | Train Loss: 0.0836113 Vali Loss: 0.2214227 Test Loss: 0.2963749
Validation loss decreased (0.221540 --> 0.221423).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 34 cost time: 0.9129998683929443
Epoch: 34, Steps: 64 | Train Loss: 0.0831385 Vali Loss: 0.2224945 Test Loss: 0.2970693
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 35 cost time: 0.9213676452636719
Epoch: 35, Steps: 64 | Train Loss: 0.0835409 Vali Loss: 0.2206909 Test Loss: 0.2974197
Validation loss decreased (0.221423 --> 0.220691).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 36 cost time: 0.9393587112426758
Epoch: 36, Steps: 64 | Train Loss: 0.0829967 Vali Loss: 0.2219540 Test Loss: 0.2967277
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 37 cost time: 0.9253430366516113
Epoch: 37, Steps: 64 | Train Loss: 0.0832774 Vali Loss: 0.2252378 Test Loss: 0.2972581
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 38 cost time: 0.9304056167602539
Epoch: 38, Steps: 64 | Train Loss: 0.0830790 Vali Loss: 0.2231936 Test Loss: 0.2966542
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 39 cost time: 0.9133751392364502
Epoch: 39, Steps: 64 | Train Loss: 0.0833982 Vali Loss: 0.2230793 Test Loss: 0.2974350
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 40 cost time: 0.9249703884124756
Epoch: 40, Steps: 64 | Train Loss: 0.0832341 Vali Loss: 0.2217015 Test Loss: 0.2971831
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 41 cost time: 0.9107491970062256
Epoch: 41, Steps: 64 | Train Loss: 0.0828459 Vali Loss: 0.2247682 Test Loss: 0.2971526
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 42 cost time: 0.9140002727508545
Epoch: 42, Steps: 64 | Train Loss: 0.0836401 Vali Loss: 0.2195986 Test Loss: 0.2979601
Validation loss decreased (0.220691 --> 0.219599).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 43 cost time: 0.9326193332672119
Epoch: 43, Steps: 64 | Train Loss: 0.0831113 Vali Loss: 0.2207660 Test Loss: 0.2976567
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 44 cost time: 0.9244654178619385
Epoch: 44, Steps: 64 | Train Loss: 0.0829300 Vali Loss: 0.2224317 Test Loss: 0.2996784
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 45 cost time: 0.9233779907226562
Epoch: 45, Steps: 64 | Train Loss: 0.0822399 Vali Loss: 0.2256005 Test Loss: 0.2984436
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 46 cost time: 0.9240078926086426
Epoch: 46, Steps: 64 | Train Loss: 0.0831508 Vali Loss: 0.2207720 Test Loss: 0.2975746
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 47 cost time: 0.921492338180542
Epoch: 47, Steps: 64 | Train Loss: 0.0834180 Vali Loss: 0.2225231 Test Loss: 0.3001436
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 48 cost time: 0.9119894504547119
Epoch: 48, Steps: 64 | Train Loss: 0.0828311 Vali Loss: 0.2207752 Test Loss: 0.2975575
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 49 cost time: 0.9187865257263184
Epoch: 49, Steps: 64 | Train Loss: 0.0827967 Vali Loss: 0.2228516 Test Loss: 0.2978712
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 50 cost time: 0.9129998683929443
Epoch: 50, Steps: 64 | Train Loss: 0.0826969 Vali Loss: 0.2218227 Test Loss: 0.2985857
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 51 cost time: 0.894606351852417
Epoch: 51, Steps: 64 | Train Loss: 0.0820384 Vali Loss: 0.2221955 Test Loss: 0.2982755
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 52 cost time: 0.9287149906158447
Epoch: 52, Steps: 64 | Train Loss: 0.0832286 Vali Loss: 0.2220367 Test Loss: 0.2981262
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 53 cost time: 0.9325275421142578
Epoch: 53, Steps: 64 | Train Loss: 0.0829010 Vali Loss: 0.2222020 Test Loss: 0.2985975
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 54 cost time: 0.9233453273773193
Epoch: 54, Steps: 64 | Train Loss: 0.0827925 Vali Loss: 0.2226134 Test Loss: 0.2975634
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 55 cost time: 0.9244797229766846
Epoch: 55, Steps: 64 | Train Loss: 0.0827771 Vali Loss: 0.2214648 Test Loss: 0.2981431
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 56 cost time: 0.9157447814941406
Epoch: 56, Steps: 64 | Train Loss: 0.0832837 Vali Loss: 0.2216823 Test Loss: 0.2985845
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 57 cost time: 0.9347808361053467
Epoch: 57, Steps: 64 | Train Loss: 0.0825529 Vali Loss: 0.2227262 Test Loss: 0.2982743
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 58 cost time: 0.9230005741119385
Epoch: 58, Steps: 64 | Train Loss: 0.0828644 Vali Loss: 0.2234582 Test Loss: 0.2975913
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 59 cost time: 0.9196333885192871
Epoch: 59, Steps: 64 | Train Loss: 0.0830495 Vali Loss: 0.2208047 Test Loss: 0.2978703
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 60 cost time: 0.9425022602081299
Epoch: 60, Steps: 64 | Train Loss: 0.0825961 Vali Loss: 0.2214582 Test Loss: 0.2987190
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2979600727558136, mae:0.3749716579914093, rse:0.25052544474601746
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.057431697845458984 GB
Epoch: 1 cost time: 2.3450751304626465
Epoch: 1, Steps: 64 | Train Loss: 0.8177582 Vali Loss: 2.5164013 Test Loss: 4.4983420
Validation loss decreased (inf --> 2.516401).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 2 cost time: 0.8863894939422607
Epoch: 2, Steps: 64 | Train Loss: 0.4166916 Vali Loss: 0.2769376 Test Loss: 0.3023858
Validation loss decreased (2.516401 --> 0.276938).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 3 cost time: 0.8941223621368408
Epoch: 3, Steps: 64 | Train Loss: 0.1216272 Vali Loss: 0.2798212 Test Loss: 0.3407570
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 4 cost time: 0.8883943557739258
Epoch: 4, Steps: 64 | Train Loss: 0.1077269 Vali Loss: 0.2555878 Test Loss: 0.2917183
Validation loss decreased (0.276938 --> 0.255588).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 5 cost time: 0.8920001983642578
Epoch: 5, Steps: 64 | Train Loss: 0.1033563 Vali Loss: 0.2442347 Test Loss: 0.2910069
Validation loss decreased (0.255588 --> 0.244235).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 6 cost time: 0.8904938697814941
Epoch: 6, Steps: 64 | Train Loss: 0.1004760 Vali Loss: 0.2478046 Test Loss: 0.2912820
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 7 cost time: 0.8726274967193604
Epoch: 7, Steps: 64 | Train Loss: 0.0976566 Vali Loss: 0.2429163 Test Loss: 0.2876427
Validation loss decreased (0.244235 --> 0.242916).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 8 cost time: 0.8853747844696045
Epoch: 8, Steps: 64 | Train Loss: 0.0962507 Vali Loss: 0.2447196 Test Loss: 0.2883257
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 9 cost time: 0.8833565711975098
Epoch: 9, Steps: 64 | Train Loss: 0.0938713 Vali Loss: 0.2399122 Test Loss: 0.2902432
Validation loss decreased (0.242916 --> 0.239912).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 10 cost time: 0.8853960037231445
Epoch: 10, Steps: 64 | Train Loss: 0.0932493 Vali Loss: 0.2343714 Test Loss: 0.2894328
Validation loss decreased (0.239912 --> 0.234371).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 11 cost time: 0.8923492431640625
Epoch: 11, Steps: 64 | Train Loss: 0.0922244 Vali Loss: 0.2340187 Test Loss: 0.2894981
Validation loss decreased (0.234371 --> 0.234019).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 12 cost time: 0.878000020980835
Epoch: 12, Steps: 64 | Train Loss: 0.0902515 Vali Loss: 0.2318579 Test Loss: 0.2899254
Validation loss decreased (0.234019 --> 0.231858).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 13 cost time: 0.8786168098449707
Epoch: 13, Steps: 64 | Train Loss: 0.0896140 Vali Loss: 0.2263662 Test Loss: 0.2884932
Validation loss decreased (0.231858 --> 0.226366).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 14 cost time: 0.8946161270141602
Epoch: 14, Steps: 64 | Train Loss: 0.0890152 Vali Loss: 0.2276143 Test Loss: 0.2891187
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 15 cost time: 0.8824069499969482
Epoch: 15, Steps: 64 | Train Loss: 0.0878921 Vali Loss: 0.2267210 Test Loss: 0.2928146
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 16 cost time: 0.8750081062316895
Epoch: 16, Steps: 64 | Train Loss: 0.0873542 Vali Loss: 0.2247698 Test Loss: 0.2926271
Validation loss decreased (0.226366 --> 0.224770).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 17 cost time: 0.8829655647277832
Epoch: 17, Steps: 64 | Train Loss: 0.0868150 Vali Loss: 0.2248946 Test Loss: 0.2939357
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 18 cost time: 0.9077448844909668
Epoch: 18, Steps: 64 | Train Loss: 0.0863413 Vali Loss: 0.2246190 Test Loss: 0.2933339
Validation loss decreased (0.224770 --> 0.224619).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 19 cost time: 0.8830001354217529
Epoch: 19, Steps: 64 | Train Loss: 0.0854587 Vali Loss: 0.2240635 Test Loss: 0.2945660
Validation loss decreased (0.224619 --> 0.224063).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 20 cost time: 0.8796193599700928
Epoch: 20, Steps: 64 | Train Loss: 0.0847616 Vali Loss: 0.2260935 Test Loss: 0.2955055
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 21 cost time: 0.8964600563049316
Epoch: 21, Steps: 64 | Train Loss: 0.0844351 Vali Loss: 0.2213825 Test Loss: 0.2944933
Validation loss decreased (0.224063 --> 0.221382).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 22 cost time: 0.8763711452484131
Epoch: 22, Steps: 64 | Train Loss: 0.0838487 Vali Loss: 0.2229229 Test Loss: 0.2962073
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 23 cost time: 0.8803441524505615
Epoch: 23, Steps: 64 | Train Loss: 0.0837102 Vali Loss: 0.2207988 Test Loss: 0.2969732
Validation loss decreased (0.221382 --> 0.220799).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 24 cost time: 0.8783340454101562
Epoch: 24, Steps: 64 | Train Loss: 0.0838120 Vali Loss: 0.2241949 Test Loss: 0.2960382
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 25 cost time: 0.8454368114471436
Epoch: 25, Steps: 64 | Train Loss: 0.0830966 Vali Loss: 0.2230451 Test Loss: 0.2979092
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 26 cost time: 0.871999979019165
Epoch: 26, Steps: 64 | Train Loss: 0.0828927 Vali Loss: 0.2230151 Test Loss: 0.2981242
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 27 cost time: 0.8783543109893799
Epoch: 27, Steps: 64 | Train Loss: 0.0830997 Vali Loss: 0.2172320 Test Loss: 0.2976262
Validation loss decreased (0.220799 --> 0.217232).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 28 cost time: 0.8863646984100342
Epoch: 28, Steps: 64 | Train Loss: 0.0825882 Vali Loss: 0.2208741 Test Loss: 0.2991735
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 29 cost time: 0.8763337135314941
Epoch: 29, Steps: 64 | Train Loss: 0.0828459 Vali Loss: 0.2197713 Test Loss: 0.2982906
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 30 cost time: 0.8790261745452881
Epoch: 30, Steps: 64 | Train Loss: 0.0822945 Vali Loss: 0.2211491 Test Loss: 0.2983710
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 31 cost time: 0.8747177124023438
Epoch: 31, Steps: 64 | Train Loss: 0.0823722 Vali Loss: 0.2196835 Test Loss: 0.2994158
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 32 cost time: 0.876000165939331
Epoch: 32, Steps: 64 | Train Loss: 0.0825862 Vali Loss: 0.2205870 Test Loss: 0.2983653
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 33 cost time: 0.8696165084838867
Epoch: 33, Steps: 64 | Train Loss: 0.0820720 Vali Loss: 0.2223558 Test Loss: 0.2988141
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 34 cost time: 0.8733644485473633
Epoch: 34, Steps: 64 | Train Loss: 0.0817056 Vali Loss: 0.2187683 Test Loss: 0.2996351
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 35 cost time: 0.8942649364471436
Epoch: 35, Steps: 64 | Train Loss: 0.0819958 Vali Loss: 0.2180353 Test Loss: 0.2999627
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 36 cost time: 0.9034428596496582
Epoch: 36, Steps: 64 | Train Loss: 0.0813175 Vali Loss: 0.2207816 Test Loss: 0.3002457
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 37 cost time: 0.8902294635772705
Epoch: 37, Steps: 64 | Train Loss: 0.0819920 Vali Loss: 0.2184373 Test Loss: 0.2993651
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 38 cost time: 0.8767836093902588
Epoch: 38, Steps: 64 | Train Loss: 0.0814633 Vali Loss: 0.2184741 Test Loss: 0.2985379
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 39 cost time: 0.8816354274749756
Epoch: 39, Steps: 64 | Train Loss: 0.0818150 Vali Loss: 0.2193146 Test Loss: 0.2990224
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 40 cost time: 0.8724393844604492
Epoch: 40, Steps: 64 | Train Loss: 0.0813664 Vali Loss: 0.2236772 Test Loss: 0.2984580
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 41 cost time: 0.8811800479888916
Epoch: 41, Steps: 64 | Train Loss: 0.0812668 Vali Loss: 0.2193102 Test Loss: 0.2983140
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 42 cost time: 0.8810665607452393
Epoch: 42, Steps: 64 | Train Loss: 0.0816404 Vali Loss: 0.2236577 Test Loss: 0.2997591
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 43 cost time: 0.8802354335784912
Epoch: 43, Steps: 64 | Train Loss: 0.0821006 Vali Loss: 0.2206467 Test Loss: 0.2984672
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 44 cost time: 0.8822920322418213
Epoch: 44, Steps: 64 | Train Loss: 0.0812702 Vali Loss: 0.2198161 Test Loss: 0.2997939
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 45 cost time: 0.876643180847168
Epoch: 45, Steps: 64 | Train Loss: 0.0812740 Vali Loss: 0.2220048 Test Loss: 0.3000869
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 46 cost time: 0.8953404426574707
Epoch: 46, Steps: 64 | Train Loss: 0.0816630 Vali Loss: 0.2203807 Test Loss: 0.3003005
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 47 cost time: 0.890228271484375
Epoch: 47, Steps: 64 | Train Loss: 0.0816814 Vali Loss: 0.2226895 Test Loss: 0.3001228
EarlyStopping counter: 20 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 48 cost time: 0.8723599910736084
Epoch: 48, Steps: 64 | Train Loss: 0.0811933 Vali Loss: 0.2217517 Test Loss: 0.2981664
EarlyStopping counter: 21 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 49 cost time: 0.8733532428741455
Epoch: 49, Steps: 64 | Train Loss: 0.0810531 Vali Loss: 0.2197537 Test Loss: 0.2994590
EarlyStopping counter: 22 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 50 cost time: 0.8573262691497803
Epoch: 50, Steps: 64 | Train Loss: 0.0813112 Vali Loss: 0.2185586 Test Loss: 0.2995856
EarlyStopping counter: 23 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 51 cost time: 0.8828816413879395
Epoch: 51, Steps: 64 | Train Loss: 0.0815683 Vali Loss: 0.2220504 Test Loss: 0.3013430
EarlyStopping counter: 24 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 52 cost time: 0.8796069622039795
Epoch: 52, Steps: 64 | Train Loss: 0.0811234 Vali Loss: 0.2185659 Test Loss: 0.3006413
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 53 cost time: 0.8843851089477539
Epoch: 53, Steps: 64 | Train Loss: 0.0811393 Vali Loss: 0.2204025 Test Loss: 0.3008511
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 54 cost time: 0.8754093647003174
Epoch: 54, Steps: 64 | Train Loss: 0.0817442 Vali Loss: 0.2201548 Test Loss: 0.2990692
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 55 cost time: 0.8783514499664307
Epoch: 55, Steps: 64 | Train Loss: 0.0816080 Vali Loss: 0.2181813 Test Loss: 0.2987368
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 56 cost time: 0.8831520080566406
Epoch: 56, Steps: 64 | Train Loss: 0.0817668 Vali Loss: 0.2207400 Test Loss: 0.3008047
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 57 cost time: 0.8570003509521484
Epoch: 57, Steps: 64 | Train Loss: 0.0817689 Vali Loss: 0.2215222 Test Loss: 0.2992138
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 58 cost time: 0.8756165504455566
Epoch: 58, Steps: 64 | Train Loss: 0.0810359 Vali Loss: 0.2195359 Test Loss: 0.3002952
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 59 cost time: 0.8754243850708008
Epoch: 59, Steps: 64 | Train Loss: 0.0813200 Vali Loss: 0.2217872 Test Loss: 0.2998849
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 60 cost time: 0.8849802017211914
Epoch: 60, Steps: 64 | Train Loss: 0.0810886 Vali Loss: 0.2197714 Test Loss: 0.3014281
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.29762616753578186, mae:0.3764631450176239, rse:0.25038501620292664
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.057007789611816406 GB
Epoch: 1 cost time: 2.1964218616485596
Epoch: 1, Steps: 64 | Train Loss: 0.9317478 Vali Loss: 2.7330480 Test Loss: 4.7952948
Validation loss decreased (inf --> 2.733048).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 2 cost time: 0.7726073265075684
Epoch: 2, Steps: 64 | Train Loss: 0.7618429 Vali Loss: 1.8658322 Test Loss: 3.2040689
Validation loss decreased (2.733048 --> 1.865832).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 3 cost time: 0.7976124286651611
Epoch: 3, Steps: 64 | Train Loss: 0.5644203 Vali Loss: 1.4467974 Test Loss: 2.4336281
Validation loss decreased (1.865832 --> 1.446797).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 4 cost time: 0.8034050464630127
Epoch: 4, Steps: 64 | Train Loss: 0.4392895 Vali Loss: 1.1551386 Test Loss: 1.8829644
Validation loss decreased (1.446797 --> 1.155139).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 5 cost time: 0.8010008335113525
Epoch: 5, Steps: 64 | Train Loss: 0.3445405 Vali Loss: 0.9113200 Test Loss: 1.4622973
Validation loss decreased (1.155139 --> 0.911320).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 6 cost time: 0.7984027862548828
Epoch: 6, Steps: 64 | Train Loss: 0.2759524 Vali Loss: 0.7458996 Test Loss: 1.1702389
Validation loss decreased (0.911320 --> 0.745900).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 7 cost time: 0.7996401786804199
Epoch: 7, Steps: 64 | Train Loss: 0.2297011 Vali Loss: 0.6232673 Test Loss: 0.9533145
Validation loss decreased (0.745900 --> 0.623267).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 8 cost time: 0.8066329956054688
Epoch: 8, Steps: 64 | Train Loss: 0.1978662 Vali Loss: 0.5344987 Test Loss: 0.8076113
Validation loss decreased (0.623267 --> 0.534499).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 9 cost time: 0.8004729747772217
Epoch: 9, Steps: 64 | Train Loss: 0.1755936 Vali Loss: 0.4735163 Test Loss: 0.6993403
Validation loss decreased (0.534499 --> 0.473516).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 10 cost time: 0.7967534065246582
Epoch: 10, Steps: 64 | Train Loss: 0.1584895 Vali Loss: 0.4280212 Test Loss: 0.6244677
Validation loss decreased (0.473516 --> 0.428021).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 11 cost time: 0.8020651340484619
Epoch: 11, Steps: 64 | Train Loss: 0.1468384 Vali Loss: 0.3898556 Test Loss: 0.5553505
Validation loss decreased (0.428021 --> 0.389856).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 12 cost time: 0.807380199432373
Epoch: 12, Steps: 64 | Train Loss: 0.1371162 Vali Loss: 0.3640308 Test Loss: 0.5114973
Validation loss decreased (0.389856 --> 0.364031).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 13 cost time: 0.8683807849884033
Epoch: 13, Steps: 64 | Train Loss: 0.1315711 Vali Loss: 0.3463771 Test Loss: 0.4819815
Validation loss decreased (0.364031 --> 0.346377).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 14 cost time: 0.8664600849151611
Epoch: 14, Steps: 64 | Train Loss: 0.1259321 Vali Loss: 0.3323747 Test Loss: 0.4544668
Validation loss decreased (0.346377 --> 0.332375).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 15 cost time: 0.8627848625183105
Epoch: 15, Steps: 64 | Train Loss: 0.1212128 Vali Loss: 0.3168351 Test Loss: 0.4364360
Validation loss decreased (0.332375 --> 0.316835).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 16 cost time: 0.8179993629455566
Epoch: 16, Steps: 64 | Train Loss: 0.1185629 Vali Loss: 0.3101209 Test Loss: 0.4183023
Validation loss decreased (0.316835 --> 0.310121).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 17 cost time: 0.796454668045044
Epoch: 17, Steps: 64 | Train Loss: 0.1157629 Vali Loss: 0.3008822 Test Loss: 0.4040325
Validation loss decreased (0.310121 --> 0.300882).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 18 cost time: 0.7983801364898682
Epoch: 18, Steps: 64 | Train Loss: 0.1132440 Vali Loss: 0.2968648 Test Loss: 0.3959535
Validation loss decreased (0.300882 --> 0.296865).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 19 cost time: 0.796802282333374
Epoch: 19, Steps: 64 | Train Loss: 0.1108114 Vali Loss: 0.2927423 Test Loss: 0.3851871
Validation loss decreased (0.296865 --> 0.292742).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 20 cost time: 0.8151683807373047
Epoch: 20, Steps: 64 | Train Loss: 0.1099660 Vali Loss: 0.2864953 Test Loss: 0.3818305
Validation loss decreased (0.292742 --> 0.286495).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 21 cost time: 0.8003613948822021
Epoch: 21, Steps: 64 | Train Loss: 0.1082713 Vali Loss: 0.2821174 Test Loss: 0.3729655
Validation loss decreased (0.286495 --> 0.282117).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 22 cost time: 0.8003535270690918
Epoch: 22, Steps: 64 | Train Loss: 0.1077754 Vali Loss: 0.2762671 Test Loss: 0.3708438
Validation loss decreased (0.282117 --> 0.276267).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 23 cost time: 0.8027925491333008
Epoch: 23, Steps: 64 | Train Loss: 0.1068899 Vali Loss: 0.2790321 Test Loss: 0.3684302
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 24 cost time: 0.8080005645751953
Epoch: 24, Steps: 64 | Train Loss: 0.1060694 Vali Loss: 0.2748765 Test Loss: 0.3612295
Validation loss decreased (0.276267 --> 0.274877).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 25 cost time: 0.865239143371582
Epoch: 25, Steps: 64 | Train Loss: 0.1056362 Vali Loss: 0.2714536 Test Loss: 0.3584169
Validation loss decreased (0.274877 --> 0.271454).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 26 cost time: 0.8473451137542725
Epoch: 26, Steps: 64 | Train Loss: 0.1044543 Vali Loss: 0.2743615 Test Loss: 0.3586430
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 27 cost time: 0.8034980297088623
Epoch: 27, Steps: 64 | Train Loss: 0.1041355 Vali Loss: 0.2686408 Test Loss: 0.3522084
Validation loss decreased (0.271454 --> 0.268641).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 28 cost time: 0.7730002403259277
Epoch: 28, Steps: 64 | Train Loss: 0.1037365 Vali Loss: 0.2705304 Test Loss: 0.3508030
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 29 cost time: 0.7836499214172363
Epoch: 29, Steps: 64 | Train Loss: 0.1028066 Vali Loss: 0.2696173 Test Loss: 0.3527611
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 30 cost time: 0.7984895706176758
Epoch: 30, Steps: 64 | Train Loss: 0.1029268 Vali Loss: 0.2659287 Test Loss: 0.3489622
Validation loss decreased (0.268641 --> 0.265929).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 31 cost time: 0.8093440532684326
Epoch: 31, Steps: 64 | Train Loss: 0.1028336 Vali Loss: 0.2670521 Test Loss: 0.3492645
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 32 cost time: 0.7729992866516113
Epoch: 32, Steps: 64 | Train Loss: 0.1022002 Vali Loss: 0.2644593 Test Loss: 0.3476891
Validation loss decreased (0.265929 --> 0.264459).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 33 cost time: 0.7986178398132324
Epoch: 33, Steps: 64 | Train Loss: 0.1026568 Vali Loss: 0.2628155 Test Loss: 0.3479816
Validation loss decreased (0.264459 --> 0.262816).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 34 cost time: 0.8054001331329346
Epoch: 34, Steps: 64 | Train Loss: 0.1023794 Vali Loss: 0.2666965 Test Loss: 0.3460456
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 35 cost time: 0.8079807758331299
Epoch: 35, Steps: 64 | Train Loss: 0.1017469 Vali Loss: 0.2624919 Test Loss: 0.3469463
Validation loss decreased (0.262816 --> 0.262492).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 36 cost time: 0.7886290550231934
Epoch: 36, Steps: 64 | Train Loss: 0.1018806 Vali Loss: 0.2637665 Test Loss: 0.3428457
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 37 cost time: 0.7974221706390381
Epoch: 37, Steps: 64 | Train Loss: 0.1013399 Vali Loss: 0.2636096 Test Loss: 0.3445595
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 38 cost time: 0.8014504909515381
Epoch: 38, Steps: 64 | Train Loss: 0.1003980 Vali Loss: 0.2625621 Test Loss: 0.3443780
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 39 cost time: 0.8123934268951416
Epoch: 39, Steps: 64 | Train Loss: 0.1014313 Vali Loss: 0.2605747 Test Loss: 0.3419831
Validation loss decreased (0.262492 --> 0.260575).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 40 cost time: 0.86100172996521
Epoch: 40, Steps: 64 | Train Loss: 0.1007959 Vali Loss: 0.2610009 Test Loss: 0.3431720
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 41 cost time: 0.8029992580413818
Epoch: 41, Steps: 64 | Train Loss: 0.1003457 Vali Loss: 0.2607587 Test Loss: 0.3407812
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 42 cost time: 0.8036384582519531
Epoch: 42, Steps: 64 | Train Loss: 0.1011086 Vali Loss: 0.2618750 Test Loss: 0.3423039
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 43 cost time: 0.8113610744476318
Epoch: 43, Steps: 64 | Train Loss: 0.1007907 Vali Loss: 0.2618009 Test Loss: 0.3401458
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 44 cost time: 0.8067281246185303
Epoch: 44, Steps: 64 | Train Loss: 0.1011939 Vali Loss: 0.2624729 Test Loss: 0.3416111
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 45 cost time: 0.7990005016326904
Epoch: 45, Steps: 64 | Train Loss: 0.1006180 Vali Loss: 0.2617063 Test Loss: 0.3392327
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 46 cost time: 0.7986233234405518
Epoch: 46, Steps: 64 | Train Loss: 0.1007828 Vali Loss: 0.2612754 Test Loss: 0.3422012
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 47 cost time: 0.812366247177124
Epoch: 47, Steps: 64 | Train Loss: 0.0998031 Vali Loss: 0.2586669 Test Loss: 0.3382007
Validation loss decreased (0.260575 --> 0.258667).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 48 cost time: 0.8027656078338623
Epoch: 48, Steps: 64 | Train Loss: 0.1000627 Vali Loss: 0.2552288 Test Loss: 0.3376669
Validation loss decreased (0.258667 --> 0.255229).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 49 cost time: 0.79848313331604
Epoch: 49, Steps: 64 | Train Loss: 0.1003759 Vali Loss: 0.2605401 Test Loss: 0.3392126
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 50 cost time: 0.8016159534454346
Epoch: 50, Steps: 64 | Train Loss: 0.1003337 Vali Loss: 0.2597846 Test Loss: 0.3385813
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 51 cost time: 0.8083493709564209
Epoch: 51, Steps: 64 | Train Loss: 0.0993606 Vali Loss: 0.2597329 Test Loss: 0.3396630
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 52 cost time: 0.8028430938720703
Epoch: 52, Steps: 64 | Train Loss: 0.1001124 Vali Loss: 0.2611753 Test Loss: 0.3366898
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 53 cost time: 0.8010003566741943
Epoch: 53, Steps: 64 | Train Loss: 0.1008560 Vali Loss: 0.2593535 Test Loss: 0.3399024
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 54 cost time: 0.802027702331543
Epoch: 54, Steps: 64 | Train Loss: 0.1003466 Vali Loss: 0.2583028 Test Loss: 0.3391159
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 55 cost time: 0.8024070262908936
Epoch: 55, Steps: 64 | Train Loss: 0.1003909 Vali Loss: 0.2596545 Test Loss: 0.3410639
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 56 cost time: 0.7997138500213623
Epoch: 56, Steps: 64 | Train Loss: 0.1004140 Vali Loss: 0.2606511 Test Loss: 0.3376420
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 57 cost time: 0.800999641418457
Epoch: 57, Steps: 64 | Train Loss: 0.1005315 Vali Loss: 0.2619168 Test Loss: 0.3397723
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 58 cost time: 0.7946188449859619
Epoch: 58, Steps: 64 | Train Loss: 0.1000402 Vali Loss: 0.2565996 Test Loss: 0.3374377
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 59 cost time: 0.8069920539855957
Epoch: 59, Steps: 64 | Train Loss: 0.1000802 Vali Loss: 0.2571764 Test Loss: 0.3377483
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 60 cost time: 0.8068256378173828
Epoch: 60, Steps: 64 | Train Loss: 0.0995001 Vali Loss: 0.2606977 Test Loss: 0.3374201
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.33766695857048035, mae:0.4106748700141907, rse:0.26669633388519287
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.060153961181640625 GB
Epoch: 1 cost time: 2.2349348068237305
Epoch: 1, Steps: 64 | Train Loss: 0.8070725 Vali Loss: 2.4508398 Test Loss: 4.3428564
Validation loss decreased (inf --> 2.450840).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 2 cost time: 0.8936135768890381
Epoch: 2, Steps: 64 | Train Loss: 0.4995970 Vali Loss: 0.6456599 Test Loss: 1.0187141
Validation loss decreased (2.450840 --> 0.645660).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 3 cost time: 0.8853707313537598
Epoch: 3, Steps: 64 | Train Loss: 0.1547305 Vali Loss: 0.2702954 Test Loss: 0.2976826
Validation loss decreased (0.645660 --> 0.270295).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 4 cost time: 0.8888335227966309
Epoch: 4, Steps: 64 | Train Loss: 0.1152265 Vali Loss: 0.2657849 Test Loss: 0.3072914
Validation loss decreased (0.270295 --> 0.265785).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 5 cost time: 0.8910386562347412
Epoch: 5, Steps: 64 | Train Loss: 0.1089040 Vali Loss: 0.2560580 Test Loss: 0.3086040
Validation loss decreased (0.265785 --> 0.256058).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 6 cost time: 0.8887078762054443
Epoch: 6, Steps: 64 | Train Loss: 0.1050298 Vali Loss: 0.2535785 Test Loss: 0.3060948
Validation loss decreased (0.256058 --> 0.253579).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 7 cost time: 0.88287353515625
Epoch: 7, Steps: 64 | Train Loss: 0.1010807 Vali Loss: 0.2559226 Test Loss: 0.3070901
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 8 cost time: 0.8879983425140381
Epoch: 8, Steps: 64 | Train Loss: 0.0981907 Vali Loss: 0.2457373 Test Loss: 0.3059172
Validation loss decreased (0.253579 --> 0.245737).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 9 cost time: 0.8866147994995117
Epoch: 9, Steps: 64 | Train Loss: 0.0960806 Vali Loss: 0.2445273 Test Loss: 0.3099769
Validation loss decreased (0.245737 --> 0.244527).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 10 cost time: 0.8954484462738037
Epoch: 10, Steps: 64 | Train Loss: 0.0937614 Vali Loss: 0.2464322 Test Loss: 0.3111249
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 11 cost time: 0.8913896083831787
Epoch: 11, Steps: 64 | Train Loss: 0.0922056 Vali Loss: 0.2449769 Test Loss: 0.3136372
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 12 cost time: 0.8903446197509766
Epoch: 12, Steps: 64 | Train Loss: 0.0908015 Vali Loss: 0.2429754 Test Loss: 0.3130238
Validation loss decreased (0.244527 --> 0.242975).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 13 cost time: 0.8912253379821777
Epoch: 13, Steps: 64 | Train Loss: 0.0906685 Vali Loss: 0.2470338 Test Loss: 0.3187449
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 14 cost time: 0.8900001049041748
Epoch: 14, Steps: 64 | Train Loss: 0.0890995 Vali Loss: 0.2412457 Test Loss: 0.3187730
Validation loss decreased (0.242975 --> 0.241246).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 15 cost time: 0.886620283126831
Epoch: 15, Steps: 64 | Train Loss: 0.0882272 Vali Loss: 0.2441133 Test Loss: 0.3164808
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 16 cost time: 0.8863601684570312
Epoch: 16, Steps: 64 | Train Loss: 0.0875783 Vali Loss: 0.2411133 Test Loss: 0.3187991
Validation loss decreased (0.241246 --> 0.241113).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 17 cost time: 0.9063413143157959
Epoch: 17, Steps: 64 | Train Loss: 0.0869446 Vali Loss: 0.2436890 Test Loss: 0.3195099
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 18 cost time: 0.9023585319519043
Epoch: 18, Steps: 64 | Train Loss: 0.0869546 Vali Loss: 0.2406358 Test Loss: 0.3226236
Validation loss decreased (0.241113 --> 0.240636).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 19 cost time: 0.9057455062866211
Epoch: 19, Steps: 64 | Train Loss: 0.0860638 Vali Loss: 0.2402672 Test Loss: 0.3211522
Validation loss decreased (0.240636 --> 0.240267).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 20 cost time: 0.9160428047180176
Epoch: 20, Steps: 64 | Train Loss: 0.0850288 Vali Loss: 0.2410534 Test Loss: 0.3223164
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 21 cost time: 0.9030003547668457
Epoch: 21, Steps: 64 | Train Loss: 0.0845416 Vali Loss: 0.2403581 Test Loss: 0.3210249
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 22 cost time: 0.911595344543457
Epoch: 22, Steps: 64 | Train Loss: 0.0846700 Vali Loss: 0.2413831 Test Loss: 0.3238691
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 23 cost time: 0.9064137935638428
Epoch: 23, Steps: 64 | Train Loss: 0.0844423 Vali Loss: 0.2409630 Test Loss: 0.3235233
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 24 cost time: 0.9059352874755859
Epoch: 24, Steps: 64 | Train Loss: 0.0836411 Vali Loss: 0.2394927 Test Loss: 0.3252175
Validation loss decreased (0.240267 --> 0.239493).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 25 cost time: 0.8655023574829102
Epoch: 25, Steps: 64 | Train Loss: 0.0839126 Vali Loss: 0.2386741 Test Loss: 0.3258448
Validation loss decreased (0.239493 --> 0.238674).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 26 cost time: 0.9592094421386719
Epoch: 26, Steps: 64 | Train Loss: 0.0830449 Vali Loss: 0.2404212 Test Loss: 0.3250825
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 27 cost time: 0.8849999904632568
Epoch: 27, Steps: 64 | Train Loss: 0.0839477 Vali Loss: 0.2403030 Test Loss: 0.3267181
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 28 cost time: 0.8798348903656006
Epoch: 28, Steps: 64 | Train Loss: 0.0831522 Vali Loss: 0.2404042 Test Loss: 0.3271455
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 29 cost time: 0.8913912773132324
Epoch: 29, Steps: 64 | Train Loss: 0.0824868 Vali Loss: 0.2402824 Test Loss: 0.3262739
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 30 cost time: 0.8912210464477539
Epoch: 30, Steps: 64 | Train Loss: 0.0822786 Vali Loss: 0.2408486 Test Loss: 0.3285776
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 31 cost time: 0.8984410762786865
Epoch: 31, Steps: 64 | Train Loss: 0.0826157 Vali Loss: 0.2408882 Test Loss: 0.3286501
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 32 cost time: 0.8913931846618652
Epoch: 32, Steps: 64 | Train Loss: 0.0822982 Vali Loss: 0.2428902 Test Loss: 0.3272701
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 33 cost time: 0.8894774913787842
Epoch: 33, Steps: 64 | Train Loss: 0.0824961 Vali Loss: 0.2391691 Test Loss: 0.3282596
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 34 cost time: 0.8933978080749512
Epoch: 34, Steps: 64 | Train Loss: 0.0823414 Vali Loss: 0.2371616 Test Loss: 0.3297111
Validation loss decreased (0.238674 --> 0.237162).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 35 cost time: 0.9047598838806152
Epoch: 35, Steps: 64 | Train Loss: 0.0821180 Vali Loss: 0.2396003 Test Loss: 0.3301947
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 36 cost time: 0.8933897018432617
Epoch: 36, Steps: 64 | Train Loss: 0.0821627 Vali Loss: 0.2393560 Test Loss: 0.3304536
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 37 cost time: 0.8963887691497803
Epoch: 37, Steps: 64 | Train Loss: 0.0817580 Vali Loss: 0.2366085 Test Loss: 0.3279243
Validation loss decreased (0.237162 --> 0.236608).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 38 cost time: 0.9044084548950195
Epoch: 38, Steps: 64 | Train Loss: 0.0819967 Vali Loss: 0.2412905 Test Loss: 0.3295615
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 39 cost time: 0.9062612056732178
Epoch: 39, Steps: 64 | Train Loss: 0.0816199 Vali Loss: 0.2376740 Test Loss: 0.3292499
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 40 cost time: 0.9079999923706055
Epoch: 40, Steps: 64 | Train Loss: 0.0816336 Vali Loss: 0.2391221 Test Loss: 0.3298782
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 41 cost time: 0.906599760055542
Epoch: 41, Steps: 64 | Train Loss: 0.0817748 Vali Loss: 0.2393220 Test Loss: 0.3300290
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 42 cost time: 0.9143552780151367
Epoch: 42, Steps: 64 | Train Loss: 0.0814535 Vali Loss: 0.2390935 Test Loss: 0.3303227
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 43 cost time: 0.9033255577087402
Epoch: 43, Steps: 64 | Train Loss: 0.0818855 Vali Loss: 0.2328624 Test Loss: 0.3306191
Validation loss decreased (0.236608 --> 0.232862).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 44 cost time: 0.9033834934234619
Epoch: 44, Steps: 64 | Train Loss: 0.0821020 Vali Loss: 0.2365332 Test Loss: 0.3283502
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 45 cost time: 0.9174199104309082
Epoch: 45, Steps: 64 | Train Loss: 0.0814733 Vali Loss: 0.2409358 Test Loss: 0.3294257
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 46 cost time: 0.9087579250335693
Epoch: 46, Steps: 64 | Train Loss: 0.0814094 Vali Loss: 0.2393120 Test Loss: 0.3297768
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 47 cost time: 0.9100000858306885
Epoch: 47, Steps: 64 | Train Loss: 0.0811587 Vali Loss: 0.2391885 Test Loss: 0.3307111
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 48 cost time: 0.9086027145385742
Epoch: 48, Steps: 64 | Train Loss: 0.0815336 Vali Loss: 0.2377580 Test Loss: 0.3296399
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 49 cost time: 0.8951990604400635
Epoch: 49, Steps: 64 | Train Loss: 0.0815639 Vali Loss: 0.2362492 Test Loss: 0.3305352
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 50 cost time: 0.9083948135375977
Epoch: 50, Steps: 64 | Train Loss: 0.0811741 Vali Loss: 0.2418035 Test Loss: 0.3309708
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 51 cost time: 0.9023168087005615
Epoch: 51, Steps: 64 | Train Loss: 0.0810174 Vali Loss: 0.2384895 Test Loss: 0.3301407
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 52 cost time: 0.9067261219024658
Epoch: 52, Steps: 64 | Train Loss: 0.0816648 Vali Loss: 0.2400721 Test Loss: 0.3287569
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 53 cost time: 0.8914163112640381
Epoch: 53, Steps: 64 | Train Loss: 0.0817495 Vali Loss: 0.2408607 Test Loss: 0.3313763
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 54 cost time: 0.9070003032684326
Epoch: 54, Steps: 64 | Train Loss: 0.0812083 Vali Loss: 0.2401119 Test Loss: 0.3302907
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 55 cost time: 0.9066007137298584
Epoch: 55, Steps: 64 | Train Loss: 0.0811013 Vali Loss: 0.2384748 Test Loss: 0.3308005
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 56 cost time: 0.9178531169891357
Epoch: 56, Steps: 64 | Train Loss: 0.0815955 Vali Loss: 0.2385336 Test Loss: 0.3309701
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 57 cost time: 0.9054591655731201
Epoch: 57, Steps: 64 | Train Loss: 0.0815064 Vali Loss: 0.2404905 Test Loss: 0.3315509
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 58 cost time: 0.9064152240753174
Epoch: 58, Steps: 64 | Train Loss: 0.0812986 Vali Loss: 0.2405737 Test Loss: 0.3309558
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 59 cost time: 0.9120008945465088
Epoch: 59, Steps: 64 | Train Loss: 0.0808364 Vali Loss: 0.2421398 Test Loss: 0.3317564
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 60 cost time: 0.9000003337860107
Epoch: 60, Steps: 64 | Train Loss: 0.0810614 Vali Loss: 0.2383936 Test Loss: 0.3314454
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.3306191861629486, mae:0.41016384959220886, rse:0.26389843225479126
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06334877014160156 GB
Epoch: 1 cost time: 2.2241244316101074
Epoch: 1, Steps: 64 | Train Loss: 0.8162953 Vali Loss: 2.5225632 Test Loss: 4.4511614
Validation loss decreased (inf --> 2.522563).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 2 cost time: 0.858999490737915
Epoch: 2, Steps: 64 | Train Loss: 0.4291865 Vali Loss: 0.2832983 Test Loss: 0.3185417
Validation loss decreased (2.522563 --> 0.283298).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 3 cost time: 0.8524050712585449
Epoch: 3, Steps: 64 | Train Loss: 0.1279667 Vali Loss: 0.2847418 Test Loss: 0.3383416
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 4 cost time: 0.8563885688781738
Epoch: 4, Steps: 64 | Train Loss: 0.1109928 Vali Loss: 0.2618455 Test Loss: 0.2986900
Validation loss decreased (0.283298 --> 0.261845).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 5 cost time: 0.8627448081970215
Epoch: 5, Steps: 64 | Train Loss: 0.1051178 Vali Loss: 0.2511801 Test Loss: 0.3031726
Validation loss decreased (0.261845 --> 0.251180).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 6 cost time: 0.8693549633026123
Epoch: 6, Steps: 64 | Train Loss: 0.1003733 Vali Loss: 0.2479516 Test Loss: 0.3038906
Validation loss decreased (0.251180 --> 0.247952).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 7 cost time: 0.845604658126831
Epoch: 7, Steps: 64 | Train Loss: 0.0975734 Vali Loss: 0.2474913 Test Loss: 0.3086577
Validation loss decreased (0.247952 --> 0.247491).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 8 cost time: 0.8583343029022217
Epoch: 8, Steps: 64 | Train Loss: 0.0948273 Vali Loss: 0.2489682 Test Loss: 0.3082035
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 9 cost time: 0.8446803092956543
Epoch: 9, Steps: 64 | Train Loss: 0.0924840 Vali Loss: 0.2434970 Test Loss: 0.3111691
Validation loss decreased (0.247491 --> 0.243497).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 10 cost time: 0.8697352409362793
Epoch: 10, Steps: 64 | Train Loss: 0.0910164 Vali Loss: 0.2407307 Test Loss: 0.3139394
Validation loss decreased (0.243497 --> 0.240731).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 11 cost time: 0.860999584197998
Epoch: 11, Steps: 64 | Train Loss: 0.0896452 Vali Loss: 0.2434305 Test Loss: 0.3139666
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 12 cost time: 0.8600001335144043
Epoch: 12, Steps: 64 | Train Loss: 0.0885136 Vali Loss: 0.2380276 Test Loss: 0.3184371
Validation loss decreased (0.240731 --> 0.238028).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 13 cost time: 0.8624367713928223
Epoch: 13, Steps: 64 | Train Loss: 0.0872257 Vali Loss: 0.2403942 Test Loss: 0.3194112
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 14 cost time: 0.8773767948150635
Epoch: 14, Steps: 64 | Train Loss: 0.0864767 Vali Loss: 0.2375761 Test Loss: 0.3209952
Validation loss decreased (0.238028 --> 0.237576).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 15 cost time: 0.8590338230133057
Epoch: 15, Steps: 64 | Train Loss: 0.0852686 Vali Loss: 0.2407576 Test Loss: 0.3209687
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 16 cost time: 0.8638629913330078
Epoch: 16, Steps: 64 | Train Loss: 0.0850157 Vali Loss: 0.2385178 Test Loss: 0.3227693
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 17 cost time: 0.8650000095367432
Epoch: 17, Steps: 64 | Train Loss: 0.0839836 Vali Loss: 0.2405316 Test Loss: 0.3245652
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 18 cost time: 0.8626039028167725
Epoch: 18, Steps: 64 | Train Loss: 0.0840693 Vali Loss: 0.2400507 Test Loss: 0.3289748
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 19 cost time: 0.8600544929504395
Epoch: 19, Steps: 64 | Train Loss: 0.0834904 Vali Loss: 0.2404963 Test Loss: 0.3272401
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 20 cost time: 0.8613259792327881
Epoch: 20, Steps: 64 | Train Loss: 0.0828416 Vali Loss: 0.2374447 Test Loss: 0.3272378
Validation loss decreased (0.237576 --> 0.237445).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 21 cost time: 0.8703649044036865
Epoch: 21, Steps: 64 | Train Loss: 0.0825960 Vali Loss: 0.2362487 Test Loss: 0.3277342
Validation loss decreased (0.237445 --> 0.236249).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 22 cost time: 0.8630001544952393
Epoch: 22, Steps: 64 | Train Loss: 0.0824006 Vali Loss: 0.2359767 Test Loss: 0.3287404
Validation loss decreased (0.236249 --> 0.235977).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 23 cost time: 0.8689999580383301
Epoch: 23, Steps: 64 | Train Loss: 0.0822882 Vali Loss: 0.2382458 Test Loss: 0.3300785
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 24 cost time: 0.8662009239196777
Epoch: 24, Steps: 64 | Train Loss: 0.0818481 Vali Loss: 0.2395534 Test Loss: 0.3317718
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 25 cost time: 0.8364250659942627
Epoch: 25, Steps: 64 | Train Loss: 0.0817642 Vali Loss: 0.2377565 Test Loss: 0.3302339
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 26 cost time: 0.8581664562225342
Epoch: 26, Steps: 64 | Train Loss: 0.0812992 Vali Loss: 0.2377554 Test Loss: 0.3304364
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 27 cost time: 0.8606979846954346
Epoch: 27, Steps: 64 | Train Loss: 0.0811306 Vali Loss: 0.2377840 Test Loss: 0.3313068
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 28 cost time: 0.8653125762939453
Epoch: 28, Steps: 64 | Train Loss: 0.0816006 Vali Loss: 0.2364890 Test Loss: 0.3316442
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 29 cost time: 0.8094477653503418
Epoch: 29, Steps: 64 | Train Loss: 0.0810613 Vali Loss: 0.2371685 Test Loss: 0.3322712
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 30 cost time: 0.8423521518707275
Epoch: 30, Steps: 64 | Train Loss: 0.0807518 Vali Loss: 0.2392239 Test Loss: 0.3353949
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 31 cost time: 0.8443562984466553
Epoch: 31, Steps: 64 | Train Loss: 0.0804556 Vali Loss: 0.2388386 Test Loss: 0.3331563
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 32 cost time: 0.8509180545806885
Epoch: 32, Steps: 64 | Train Loss: 0.0801020 Vali Loss: 0.2393043 Test Loss: 0.3335584
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 33 cost time: 0.8464260101318359
Epoch: 33, Steps: 64 | Train Loss: 0.0807830 Vali Loss: 0.2394626 Test Loss: 0.3341535
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 34 cost time: 0.8458528518676758
Epoch: 34, Steps: 64 | Train Loss: 0.0801508 Vali Loss: 0.2405843 Test Loss: 0.3352102
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 35 cost time: 0.845416784286499
Epoch: 35, Steps: 64 | Train Loss: 0.0802172 Vali Loss: 0.2369103 Test Loss: 0.3359465
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 36 cost time: 0.8550925254821777
Epoch: 36, Steps: 64 | Train Loss: 0.0800646 Vali Loss: 0.2412636 Test Loss: 0.3340583
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 37 cost time: 0.8427700996398926
Epoch: 37, Steps: 64 | Train Loss: 0.0797180 Vali Loss: 0.2382658 Test Loss: 0.3357534
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 38 cost time: 0.8446223735809326
Epoch: 38, Steps: 64 | Train Loss: 0.0799795 Vali Loss: 0.2380008 Test Loss: 0.3353274
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 39 cost time: 0.8506200313568115
Epoch: 39, Steps: 64 | Train Loss: 0.0802185 Vali Loss: 0.2363442 Test Loss: 0.3354252
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 40 cost time: 0.8585045337677002
Epoch: 40, Steps: 64 | Train Loss: 0.0800170 Vali Loss: 0.2386582 Test Loss: 0.3359230
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 41 cost time: 0.8474066257476807
Epoch: 41, Steps: 64 | Train Loss: 0.0796597 Vali Loss: 0.2403268 Test Loss: 0.3366380
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 42 cost time: 0.8418118953704834
Epoch: 42, Steps: 64 | Train Loss: 0.0800392 Vali Loss: 0.2393781 Test Loss: 0.3349141
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 43 cost time: 0.8469994068145752
Epoch: 43, Steps: 64 | Train Loss: 0.0794838 Vali Loss: 0.2412872 Test Loss: 0.3354027
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 44 cost time: 0.8486123085021973
Epoch: 44, Steps: 64 | Train Loss: 0.0798016 Vali Loss: 0.2381066 Test Loss: 0.3346943
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 45 cost time: 0.8453404903411865
Epoch: 45, Steps: 64 | Train Loss: 0.0798621 Vali Loss: 0.2378992 Test Loss: 0.3353370
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 46 cost time: 0.844383716583252
Epoch: 46, Steps: 64 | Train Loss: 0.0799940 Vali Loss: 0.2394606 Test Loss: 0.3361670
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 47 cost time: 0.8571712970733643
Epoch: 47, Steps: 64 | Train Loss: 0.0801559 Vali Loss: 0.2367336 Test Loss: 0.3343345
EarlyStopping counter: 25 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 48 cost time: 0.8490002155303955
Epoch: 48, Steps: 64 | Train Loss: 0.0796632 Vali Loss: 0.2390346 Test Loss: 0.3363380
EarlyStopping counter: 26 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 49 cost time: 0.848618745803833
Epoch: 49, Steps: 64 | Train Loss: 0.0797093 Vali Loss: 0.2397775 Test Loss: 0.3356630
EarlyStopping counter: 27 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 50 cost time: 0.8494658470153809
Epoch: 50, Steps: 64 | Train Loss: 0.0797249 Vali Loss: 0.2363764 Test Loss: 0.3355184
EarlyStopping counter: 28 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 51 cost time: 0.8503201007843018
Epoch: 51, Steps: 64 | Train Loss: 0.0797553 Vali Loss: 0.2391522 Test Loss: 0.3372840
EarlyStopping counter: 29 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 52 cost time: 0.8147115707397461
Epoch: 52, Steps: 64 | Train Loss: 0.0795986 Vali Loss: 0.2393640 Test Loss: 0.3365485
EarlyStopping counter: 30 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 53 cost time: 0.8450000286102295
Epoch: 53, Steps: 64 | Train Loss: 0.0797003 Vali Loss: 0.2395142 Test Loss: 0.3367010
EarlyStopping counter: 31 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 54 cost time: 0.8466157913208008
Epoch: 54, Steps: 64 | Train Loss: 0.0795833 Vali Loss: 0.2373067 Test Loss: 0.3370090
EarlyStopping counter: 32 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 55 cost time: 0.8463590145111084
Epoch: 55, Steps: 64 | Train Loss: 0.0792578 Vali Loss: 0.2386148 Test Loss: 0.3358846
EarlyStopping counter: 33 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 56 cost time: 0.8492498397827148
Epoch: 56, Steps: 64 | Train Loss: 0.0790561 Vali Loss: 0.2376327 Test Loss: 0.3360361
EarlyStopping counter: 34 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 57 cost time: 0.8487374782562256
Epoch: 57, Steps: 64 | Train Loss: 0.0795995 Vali Loss: 0.2387023 Test Loss: 0.3358821
EarlyStopping counter: 35 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 58 cost time: 0.8470029830932617
Epoch: 58, Steps: 64 | Train Loss: 0.0793996 Vali Loss: 0.2371540 Test Loss: 0.3362708
EarlyStopping counter: 36 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 59 cost time: 0.8476464748382568
Epoch: 59, Steps: 64 | Train Loss: 0.0793090 Vali Loss: 0.2390266 Test Loss: 0.3370544
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 60 cost time: 0.8433668613433838
Epoch: 60, Steps: 64 | Train Loss: 0.0797500 Vali Loss: 0.2405805 Test Loss: 0.3351381
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.3287404775619507, mae:0.4080788791179657, rse:0.26314759254455566
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05716896057128906 GB
Epoch: 1 cost time: 2.2954177856445312
Epoch: 1, Steps: 64 | Train Loss: 1.0456708 Vali Loss: 3.1039517 Test Loss: 5.4870963
Validation loss decreased (inf --> 3.103952).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 2 cost time: 0.8757643699645996
Epoch: 2, Steps: 64 | Train Loss: 0.9024726 Vali Loss: 2.3680975 Test Loss: 4.1471624
Validation loss decreased (3.103952 --> 2.368098).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 3 cost time: 0.8549997806549072
Epoch: 3, Steps: 64 | Train Loss: 0.7038826 Vali Loss: 1.8315108 Test Loss: 3.1542442
Validation loss decreased (2.368098 --> 1.831511).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 4 cost time: 0.8735997676849365
Epoch: 4, Steps: 64 | Train Loss: 0.5458823 Vali Loss: 1.4312122 Test Loss: 2.4063725
Validation loss decreased (1.831511 --> 1.431212).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 5 cost time: 0.8752963542938232
Epoch: 5, Steps: 64 | Train Loss: 0.4306444 Vali Loss: 1.1506796 Test Loss: 1.9166915
Validation loss decreased (1.431212 --> 1.150680).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 6 cost time: 0.8715722560882568
Epoch: 6, Steps: 64 | Train Loss: 0.3505847 Vali Loss: 0.9483034 Test Loss: 1.5530177
Validation loss decreased (1.150680 --> 0.948303).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 7 cost time: 0.8657901287078857
Epoch: 7, Steps: 64 | Train Loss: 0.2939011 Vali Loss: 0.7938527 Test Loss: 1.2823782
Validation loss decreased (0.948303 --> 0.793853).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 8 cost time: 0.8677763938903809
Epoch: 8, Steps: 64 | Train Loss: 0.2516504 Vali Loss: 0.6787508 Test Loss: 1.0852396
Validation loss decreased (0.793853 --> 0.678751).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 9 cost time: 0.8809998035430908
Epoch: 9, Steps: 64 | Train Loss: 0.2195617 Vali Loss: 0.5979111 Test Loss: 0.9382653
Validation loss decreased (0.678751 --> 0.597911).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 10 cost time: 0.8740992546081543
Epoch: 10, Steps: 64 | Train Loss: 0.1968042 Vali Loss: 0.5328835 Test Loss: 0.8247228
Validation loss decreased (0.597911 --> 0.532883).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 11 cost time: 0.8754162788391113
Epoch: 11, Steps: 64 | Train Loss: 0.1783495 Vali Loss: 0.4783741 Test Loss: 0.7320409
Validation loss decreased (0.532883 --> 0.478374).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 12 cost time: 0.865405797958374
Epoch: 12, Steps: 64 | Train Loss: 0.1646154 Vali Loss: 0.4417967 Test Loss: 0.6644665
Validation loss decreased (0.478374 --> 0.441797).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 13 cost time: 0.8835992813110352
Epoch: 13, Steps: 64 | Train Loss: 0.1547623 Vali Loss: 0.4130930 Test Loss: 0.6094946
Validation loss decreased (0.441797 --> 0.413093).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 14 cost time: 0.8732655048370361
Epoch: 14, Steps: 64 | Train Loss: 0.1464078 Vali Loss: 0.3909858 Test Loss: 0.5675384
Validation loss decreased (0.413093 --> 0.390986).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 15 cost time: 0.8576231002807617
Epoch: 15, Steps: 64 | Train Loss: 0.1392362 Vali Loss: 0.3706938 Test Loss: 0.5351362
Validation loss decreased (0.390986 --> 0.370694).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 16 cost time: 0.8606178760528564
Epoch: 16, Steps: 64 | Train Loss: 0.1341395 Vali Loss: 0.3552620 Test Loss: 0.5104947
Validation loss decreased (0.370694 --> 0.355262).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 17 cost time: 0.8653964996337891
Epoch: 17, Steps: 64 | Train Loss: 0.1287282 Vali Loss: 0.3413354 Test Loss: 0.4807621
Validation loss decreased (0.355262 --> 0.341335).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 18 cost time: 0.8583886623382568
Epoch: 18, Steps: 64 | Train Loss: 0.1253899 Vali Loss: 0.3298924 Test Loss: 0.4662558
Validation loss decreased (0.341335 --> 0.329892).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 19 cost time: 0.8664300441741943
Epoch: 19, Steps: 64 | Train Loss: 0.1223807 Vali Loss: 0.3222593 Test Loss: 0.4478775
Validation loss decreased (0.329892 --> 0.322259).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 20 cost time: 0.8747682571411133
Epoch: 20, Steps: 64 | Train Loss: 0.1199733 Vali Loss: 0.3142652 Test Loss: 0.4353476
Validation loss decreased (0.322259 --> 0.314265).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 21 cost time: 0.8679995536804199
Epoch: 21, Steps: 64 | Train Loss: 0.1176560 Vali Loss: 0.3044302 Test Loss: 0.4182096
Validation loss decreased (0.314265 --> 0.304430).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 22 cost time: 0.8706874847412109
Epoch: 22, Steps: 64 | Train Loss: 0.1154084 Vali Loss: 0.3039083 Test Loss: 0.4122479
Validation loss decreased (0.304430 --> 0.303908).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 23 cost time: 0.8674435615539551
Epoch: 23, Steps: 64 | Train Loss: 0.1138263 Vali Loss: 0.2977935 Test Loss: 0.4010998
Validation loss decreased (0.303908 --> 0.297794).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 24 cost time: 0.8629429340362549
Epoch: 24, Steps: 64 | Train Loss: 0.1120599 Vali Loss: 0.2920180 Test Loss: 0.3930254
Validation loss decreased (0.297794 --> 0.292018).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 25 cost time: 0.8607559204101562
Epoch: 25, Steps: 64 | Train Loss: 0.1114654 Vali Loss: 0.2910541 Test Loss: 0.3895579
Validation loss decreased (0.292018 --> 0.291054).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 26 cost time: 0.8610002994537354
Epoch: 26, Steps: 64 | Train Loss: 0.1104811 Vali Loss: 0.2854707 Test Loss: 0.3823563
Validation loss decreased (0.291054 --> 0.285471).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 27 cost time: 0.8586080074310303
Epoch: 27, Steps: 64 | Train Loss: 0.1091976 Vali Loss: 0.2845368 Test Loss: 0.3769107
Validation loss decreased (0.285471 --> 0.284537).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 28 cost time: 0.8638088703155518
Epoch: 28, Steps: 64 | Train Loss: 0.1086239 Vali Loss: 0.2804998 Test Loss: 0.3753066
Validation loss decreased (0.284537 --> 0.280500).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 29 cost time: 0.8544940948486328
Epoch: 29, Steps: 64 | Train Loss: 0.1076705 Vali Loss: 0.2774579 Test Loss: 0.3688807
Validation loss decreased (0.280500 --> 0.277458).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 30 cost time: 0.8562345504760742
Epoch: 30, Steps: 64 | Train Loss: 0.1070411 Vali Loss: 0.2767603 Test Loss: 0.3693484
Validation loss decreased (0.277458 --> 0.276760).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 31 cost time: 0.8867883682250977
Epoch: 31, Steps: 64 | Train Loss: 0.1060530 Vali Loss: 0.2730981 Test Loss: 0.3623135
Validation loss decreased (0.276760 --> 0.273098).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 32 cost time: 0.875
Epoch: 32, Steps: 64 | Train Loss: 0.1053318 Vali Loss: 0.2742051 Test Loss: 0.3599910
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 33 cost time: 0.8666136264801025
Epoch: 33, Steps: 64 | Train Loss: 0.1053329 Vali Loss: 0.2709880 Test Loss: 0.3584600
Validation loss decreased (0.273098 --> 0.270988).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 34 cost time: 0.8732547760009766
Epoch: 34, Steps: 64 | Train Loss: 0.1049764 Vali Loss: 0.2713030 Test Loss: 0.3573026
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 35 cost time: 0.8825211524963379
Epoch: 35, Steps: 64 | Train Loss: 0.1044248 Vali Loss: 0.2700792 Test Loss: 0.3563114
Validation loss decreased (0.270988 --> 0.270079).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 36 cost time: 0.8693249225616455
Epoch: 36, Steps: 64 | Train Loss: 0.1043293 Vali Loss: 0.2702454 Test Loss: 0.3557003
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 37 cost time: 0.873464822769165
Epoch: 37, Steps: 64 | Train Loss: 0.1036594 Vali Loss: 0.2679272 Test Loss: 0.3498705
Validation loss decreased (0.270079 --> 0.267927).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 38 cost time: 0.8810000419616699
Epoch: 38, Steps: 64 | Train Loss: 0.1038431 Vali Loss: 0.2680153 Test Loss: 0.3516451
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 39 cost time: 0.878716230392456
Epoch: 39, Steps: 64 | Train Loss: 0.1026985 Vali Loss: 0.2667278 Test Loss: 0.3478796
Validation loss decreased (0.267927 --> 0.266728).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 40 cost time: 0.8740434646606445
Epoch: 40, Steps: 64 | Train Loss: 0.1032909 Vali Loss: 0.2653064 Test Loss: 0.3460013
Validation loss decreased (0.266728 --> 0.265306).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 41 cost time: 0.8794445991516113
Epoch: 41, Steps: 64 | Train Loss: 0.1026192 Vali Loss: 0.2684219 Test Loss: 0.3474537
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 42 cost time: 0.8872718811035156
Epoch: 42, Steps: 64 | Train Loss: 0.1026985 Vali Loss: 0.2644415 Test Loss: 0.3466410
Validation loss decreased (0.265306 --> 0.264441).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 43 cost time: 0.8670001029968262
Epoch: 43, Steps: 64 | Train Loss: 0.1027541 Vali Loss: 0.2666961 Test Loss: 0.3463818
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 44 cost time: 0.8666200637817383
Epoch: 44, Steps: 64 | Train Loss: 0.1027223 Vali Loss: 0.2661189 Test Loss: 0.3447424
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 45 cost time: 0.8694252967834473
Epoch: 45, Steps: 64 | Train Loss: 0.1025787 Vali Loss: 0.2628263 Test Loss: 0.3462418
Validation loss decreased (0.264441 --> 0.262826).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 46 cost time: 0.8683726787567139
Epoch: 46, Steps: 64 | Train Loss: 0.1016816 Vali Loss: 0.2642396 Test Loss: 0.3447134
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 47 cost time: 0.8772969245910645
Epoch: 47, Steps: 64 | Train Loss: 0.1017628 Vali Loss: 0.2644249 Test Loss: 0.3423193
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 48 cost time: 0.8748154640197754
Epoch: 48, Steps: 64 | Train Loss: 0.1022382 Vali Loss: 0.2648796 Test Loss: 0.3404378
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 49 cost time: 0.8819999694824219
Epoch: 49, Steps: 64 | Train Loss: 0.1015956 Vali Loss: 0.2621496 Test Loss: 0.3403084
Validation loss decreased (0.262826 --> 0.262150).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 50 cost time: 0.8610439300537109
Epoch: 50, Steps: 64 | Train Loss: 0.1018515 Vali Loss: 0.2621418 Test Loss: 0.3416854
Validation loss decreased (0.262150 --> 0.262142).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 51 cost time: 0.8843812942504883
Epoch: 51, Steps: 64 | Train Loss: 0.1015938 Vali Loss: 0.2611884 Test Loss: 0.3389175
Validation loss decreased (0.262142 --> 0.261188).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 52 cost time: 0.8864586353302002
Epoch: 52, Steps: 64 | Train Loss: 0.1010855 Vali Loss: 0.2619695 Test Loss: 0.3414780
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 53 cost time: 0.8808548450469971
Epoch: 53, Steps: 64 | Train Loss: 0.1022782 Vali Loss: 0.2621223 Test Loss: 0.3393959
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 54 cost time: 0.8577117919921875
Epoch: 54, Steps: 64 | Train Loss: 0.1020684 Vali Loss: 0.2644851 Test Loss: 0.3403170
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 55 cost time: 0.8428480625152588
Epoch: 55, Steps: 64 | Train Loss: 0.1009972 Vali Loss: 0.2620111 Test Loss: 0.3389419
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 56 cost time: 0.95162034034729
Epoch: 56, Steps: 64 | Train Loss: 0.1014544 Vali Loss: 0.2591917 Test Loss: 0.3410373
Validation loss decreased (0.261188 --> 0.259192).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 57 cost time: 0.8763828277587891
Epoch: 57, Steps: 64 | Train Loss: 0.1013271 Vali Loss: 0.2614727 Test Loss: 0.3389061
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 58 cost time: 0.8782775402069092
Epoch: 58, Steps: 64 | Train Loss: 0.1015847 Vali Loss: 0.2624844 Test Loss: 0.3396329
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 59 cost time: 0.8754088878631592
Epoch: 59, Steps: 64 | Train Loss: 0.1013717 Vali Loss: 0.2603117 Test Loss: 0.3384769
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 60 cost time: 0.8822908401489258
Epoch: 60, Steps: 64 | Train Loss: 0.1011574 Vali Loss: 0.2605401 Test Loss: 0.3386942
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.3410373628139496, mae:0.40866604447364807, rse:0.2680240571498871
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06031513214111328 GB
Epoch: 1 cost time: 2.212890625
Epoch: 1, Steps: 64 | Train Loss: 0.8881035 Vali Loss: 2.7149992 Test Loss: 4.7767224
Validation loss decreased (inf --> 2.714999).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 2 cost time: 0.8476262092590332
Epoch: 2, Steps: 64 | Train Loss: 0.5787304 Vali Loss: 0.7790589 Test Loss: 1.2379167
Validation loss decreased (2.714999 --> 0.779059).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 3 cost time: 0.8403561115264893
Epoch: 3, Steps: 64 | Train Loss: 0.1720487 Vali Loss: 0.2673911 Test Loss: 0.2976579
Validation loss decreased (0.779059 --> 0.267391).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 4 cost time: 0.8344054222106934
Epoch: 4, Steps: 64 | Train Loss: 0.1115183 Vali Loss: 0.2534816 Test Loss: 0.2900235
Validation loss decreased (0.267391 --> 0.253482).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 5 cost time: 0.8464310169219971
Epoch: 5, Steps: 64 | Train Loss: 0.1051600 Vali Loss: 0.2426831 Test Loss: 0.2942752
Validation loss decreased (0.253482 --> 0.242683).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 6 cost time: 0.8389997482299805
Epoch: 6, Steps: 64 | Train Loss: 0.1012343 Vali Loss: 0.2445572 Test Loss: 0.2933456
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 7 cost time: 0.8406283855438232
Epoch: 7, Steps: 64 | Train Loss: 0.0974309 Vali Loss: 0.2372686 Test Loss: 0.2913231
Validation loss decreased (0.242683 --> 0.237269).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 8 cost time: 0.8427672386169434
Epoch: 8, Steps: 64 | Train Loss: 0.0959589 Vali Loss: 0.2345844 Test Loss: 0.2917579
Validation loss decreased (0.237269 --> 0.234584).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 9 cost time: 0.8394300937652588
Epoch: 9, Steps: 64 | Train Loss: 0.0935034 Vali Loss: 0.2332422 Test Loss: 0.2909942
Validation loss decreased (0.234584 --> 0.233242).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 10 cost time: 0.845104455947876
Epoch: 10, Steps: 64 | Train Loss: 0.0925435 Vali Loss: 0.2260742 Test Loss: 0.2914212
Validation loss decreased (0.233242 --> 0.226074).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 11 cost time: 0.8530004024505615
Epoch: 11, Steps: 64 | Train Loss: 0.0901552 Vali Loss: 0.2234997 Test Loss: 0.2923293
Validation loss decreased (0.226074 --> 0.223500).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 12 cost time: 0.8416213989257812
Epoch: 12, Steps: 64 | Train Loss: 0.0895000 Vali Loss: 0.2253017 Test Loss: 0.2926798
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 13 cost time: 0.8383502960205078
Epoch: 13, Steps: 64 | Train Loss: 0.0883640 Vali Loss: 0.2210763 Test Loss: 0.2913961
Validation loss decreased (0.223500 --> 0.221076).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 14 cost time: 0.8433737754821777
Epoch: 14, Steps: 64 | Train Loss: 0.0869676 Vali Loss: 0.2157791 Test Loss: 0.2924940
Validation loss decreased (0.221076 --> 0.215779).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 15 cost time: 0.8567898273468018
Epoch: 15, Steps: 64 | Train Loss: 0.0859569 Vali Loss: 0.2182543 Test Loss: 0.2949816
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 16 cost time: 0.8419997692108154
Epoch: 16, Steps: 64 | Train Loss: 0.0851625 Vali Loss: 0.2107788 Test Loss: 0.2958885
Validation loss decreased (0.215779 --> 0.210779).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 17 cost time: 0.8465242385864258
Epoch: 17, Steps: 64 | Train Loss: 0.0851488 Vali Loss: 0.2160595 Test Loss: 0.2959185
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 18 cost time: 0.8457431793212891
Epoch: 18, Steps: 64 | Train Loss: 0.0847277 Vali Loss: 0.2183345 Test Loss: 0.2957927
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 19 cost time: 0.8550832271575928
Epoch: 19, Steps: 64 | Train Loss: 0.0840726 Vali Loss: 0.2146629 Test Loss: 0.2950079
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 20 cost time: 0.8407533168792725
Epoch: 20, Steps: 64 | Train Loss: 0.0842145 Vali Loss: 0.2139125 Test Loss: 0.2968938
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 21 cost time: 0.8370003700256348
Epoch: 21, Steps: 64 | Train Loss: 0.0826023 Vali Loss: 0.2097691 Test Loss: 0.2958567
Validation loss decreased (0.210779 --> 0.209769).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 22 cost time: 0.8416187763214111
Epoch: 22, Steps: 64 | Train Loss: 0.0822496 Vali Loss: 0.2118871 Test Loss: 0.2960376
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 23 cost time: 0.844191312789917
Epoch: 23, Steps: 64 | Train Loss: 0.0831313 Vali Loss: 0.2133862 Test Loss: 0.2976129
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 24 cost time: 0.837500810623169
Epoch: 24, Steps: 64 | Train Loss: 0.0824020 Vali Loss: 0.2108072 Test Loss: 0.2958959
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 25 cost time: 0.8457953929901123
Epoch: 25, Steps: 64 | Train Loss: 0.0821791 Vali Loss: 0.2126171 Test Loss: 0.2958144
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 26 cost time: 0.8403191566467285
Epoch: 26, Steps: 64 | Train Loss: 0.0820757 Vali Loss: 0.2102028 Test Loss: 0.2966564
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 27 cost time: 0.82962965965271
Epoch: 27, Steps: 64 | Train Loss: 0.0816899 Vali Loss: 0.2095708 Test Loss: 0.2967335
Validation loss decreased (0.209769 --> 0.209571).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 28 cost time: 0.8400771617889404
Epoch: 28, Steps: 64 | Train Loss: 0.0810033 Vali Loss: 0.2077230 Test Loss: 0.2977339
Validation loss decreased (0.209571 --> 0.207723).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 29 cost time: 0.8433859348297119
Epoch: 29, Steps: 64 | Train Loss: 0.0816045 Vali Loss: 0.2102491 Test Loss: 0.2971703
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 30 cost time: 0.8447604179382324
Epoch: 30, Steps: 64 | Train Loss: 0.0818263 Vali Loss: 0.2085987 Test Loss: 0.2965188
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 31 cost time: 0.8389995098114014
Epoch: 31, Steps: 64 | Train Loss: 0.0817432 Vali Loss: 0.2108842 Test Loss: 0.2952475
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 32 cost time: 0.8426125049591064
Epoch: 32, Steps: 64 | Train Loss: 0.0815361 Vali Loss: 0.2108276 Test Loss: 0.2963287
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 33 cost time: 0.8479878902435303
Epoch: 33, Steps: 64 | Train Loss: 0.0806636 Vali Loss: 0.2098915 Test Loss: 0.2963185
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 34 cost time: 0.8413867950439453
Epoch: 34, Steps: 64 | Train Loss: 0.0812765 Vali Loss: 0.2085145 Test Loss: 0.2970713
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 35 cost time: 0.8397879600524902
Epoch: 35, Steps: 64 | Train Loss: 0.0808621 Vali Loss: 0.2097366 Test Loss: 0.2976087
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 36 cost time: 0.8605995178222656
Epoch: 36, Steps: 64 | Train Loss: 0.0807199 Vali Loss: 0.2094699 Test Loss: 0.2966435
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 37 cost time: 0.8585891723632812
Epoch: 37, Steps: 64 | Train Loss: 0.0804784 Vali Loss: 0.2094960 Test Loss: 0.2966827
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 38 cost time: 0.8673431873321533
Epoch: 38, Steps: 64 | Train Loss: 0.0803832 Vali Loss: 0.2074236 Test Loss: 0.2969823
Validation loss decreased (0.207723 --> 0.207424).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 39 cost time: 0.8640003204345703
Epoch: 39, Steps: 64 | Train Loss: 0.0806358 Vali Loss: 0.2095871 Test Loss: 0.2972503
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 40 cost time: 0.8692092895507812
Epoch: 40, Steps: 64 | Train Loss: 0.0806628 Vali Loss: 0.2110966 Test Loss: 0.2977049
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 41 cost time: 0.8689999580383301
Epoch: 41, Steps: 64 | Train Loss: 0.0806329 Vali Loss: 0.2062918 Test Loss: 0.2968673
Validation loss decreased (0.207424 --> 0.206292).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 42 cost time: 0.8607990741729736
Epoch: 42, Steps: 64 | Train Loss: 0.0804255 Vali Loss: 0.2079288 Test Loss: 0.2970168
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 43 cost time: 0.8569998741149902
Epoch: 43, Steps: 64 | Train Loss: 0.0803300 Vali Loss: 0.2115276 Test Loss: 0.2971655
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 44 cost time: 0.8635134696960449
Epoch: 44, Steps: 64 | Train Loss: 0.0802823 Vali Loss: 0.2110048 Test Loss: 0.2969031
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 45 cost time: 0.8723258972167969
Epoch: 45, Steps: 64 | Train Loss: 0.0800399 Vali Loss: 0.2080742 Test Loss: 0.2967265
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 46 cost time: 0.8627727031707764
Epoch: 46, Steps: 64 | Train Loss: 0.0801626 Vali Loss: 0.2063633 Test Loss: 0.2968765
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 47 cost time: 0.8720788955688477
Epoch: 47, Steps: 64 | Train Loss: 0.0801341 Vali Loss: 0.2091275 Test Loss: 0.2975581
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 48 cost time: 0.873610258102417
Epoch: 48, Steps: 64 | Train Loss: 0.0798355 Vali Loss: 0.2095706 Test Loss: 0.2971942
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 49 cost time: 0.8663146495819092
Epoch: 49, Steps: 64 | Train Loss: 0.0799961 Vali Loss: 0.2104785 Test Loss: 0.2970389
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 50 cost time: 0.8643419742584229
Epoch: 50, Steps: 64 | Train Loss: 0.0797564 Vali Loss: 0.2083429 Test Loss: 0.2966976
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 51 cost time: 0.8577861785888672
Epoch: 51, Steps: 64 | Train Loss: 0.0799757 Vali Loss: 0.2071917 Test Loss: 0.2977736
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 52 cost time: 0.8570013046264648
Epoch: 52, Steps: 64 | Train Loss: 0.0807630 Vali Loss: 0.2072598 Test Loss: 0.2967240
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 53 cost time: 0.8169388771057129
Epoch: 53, Steps: 64 | Train Loss: 0.0804195 Vali Loss: 0.2094524 Test Loss: 0.2970127
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 54 cost time: 0.8501753807067871
Epoch: 54, Steps: 64 | Train Loss: 0.0801824 Vali Loss: 0.2099220 Test Loss: 0.2965463
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 55 cost time: 0.8484828472137451
Epoch: 55, Steps: 64 | Train Loss: 0.0803586 Vali Loss: 0.2068559 Test Loss: 0.2974679
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 56 cost time: 0.8444359302520752
Epoch: 56, Steps: 64 | Train Loss: 0.0801720 Vali Loss: 0.2081274 Test Loss: 0.2971748
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 57 cost time: 0.8456201553344727
Epoch: 57, Steps: 64 | Train Loss: 0.0799560 Vali Loss: 0.2084863 Test Loss: 0.2971818
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 58 cost time: 0.8546285629272461
Epoch: 58, Steps: 64 | Train Loss: 0.0799109 Vali Loss: 0.2070265 Test Loss: 0.2964267
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 59 cost time: 0.8475041389465332
Epoch: 59, Steps: 64 | Train Loss: 0.0795652 Vali Loss: 0.2088944 Test Loss: 0.2971552
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 60 cost time: 0.831139087677002
Epoch: 60, Steps: 64 | Train Loss: 0.0802213 Vali Loss: 0.2070923 Test Loss: 0.2971489
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.29686734080314636, mae:0.37494248151779175, rse:0.2500656247138977
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06350994110107422 GB
Epoch: 1 cost time: 2.3082354068756104
Epoch: 1, Steps: 64 | Train Loss: 0.8234061 Vali Loss: 2.5312164 Test Loss: 4.4751959
Validation loss decreased (inf --> 2.531216).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 2 cost time: 0.936542272567749
Epoch: 2, Steps: 64 | Train Loss: 0.4360408 Vali Loss: 0.2887802 Test Loss: 0.3125931
Validation loss decreased (2.531216 --> 0.288780).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 3 cost time: 0.9294688701629639
Epoch: 3, Steps: 64 | Train Loss: 0.1250606 Vali Loss: 0.2775007 Test Loss: 0.3313616
Validation loss decreased (0.288780 --> 0.277501).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 4 cost time: 0.935999870300293
Epoch: 4, Steps: 64 | Train Loss: 0.1100601 Vali Loss: 0.2458521 Test Loss: 0.2930725
Validation loss decreased (0.277501 --> 0.245852).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 5 cost time: 0.9396147727966309
Epoch: 5, Steps: 64 | Train Loss: 0.1035220 Vali Loss: 0.2419662 Test Loss: 0.2928947
Validation loss decreased (0.245852 --> 0.241966).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 6 cost time: 0.9552180767059326
Epoch: 6, Steps: 64 | Train Loss: 0.0999094 Vali Loss: 0.2367988 Test Loss: 0.2948017
Validation loss decreased (0.241966 --> 0.236799).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 7 cost time: 0.9402871131896973
Epoch: 7, Steps: 64 | Train Loss: 0.0968928 Vali Loss: 0.2351293 Test Loss: 0.2938537
Validation loss decreased (0.236799 --> 0.235129).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 8 cost time: 0.9424445629119873
Epoch: 8, Steps: 64 | Train Loss: 0.0950517 Vali Loss: 0.2325453 Test Loss: 0.2943333
Validation loss decreased (0.235129 --> 0.232545).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 9 cost time: 0.9393024444580078
Epoch: 9, Steps: 64 | Train Loss: 0.0933613 Vali Loss: 0.2275596 Test Loss: 0.2905191
Validation loss decreased (0.232545 --> 0.227560).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 10 cost time: 0.950369119644165
Epoch: 10, Steps: 64 | Train Loss: 0.0923103 Vali Loss: 0.2238329 Test Loss: 0.2911689
Validation loss decreased (0.227560 --> 0.223833).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 11 cost time: 0.9561946392059326
Epoch: 11, Steps: 64 | Train Loss: 0.0907976 Vali Loss: 0.2196941 Test Loss: 0.2929202
Validation loss decreased (0.223833 --> 0.219694).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 12 cost time: 0.985663890838623
Epoch: 12, Steps: 64 | Train Loss: 0.0885484 Vali Loss: 0.2196567 Test Loss: 0.2927450
Validation loss decreased (0.219694 --> 0.219657).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 13 cost time: 0.9740841388702393
Epoch: 13, Steps: 64 | Train Loss: 0.0878287 Vali Loss: 0.2198019 Test Loss: 0.2905843
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 14 cost time: 0.9526634216308594
Epoch: 14, Steps: 64 | Train Loss: 0.0871617 Vali Loss: 0.2185770 Test Loss: 0.2921565
Validation loss decreased (0.219657 --> 0.218577).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 15 cost time: 0.954603910446167
Epoch: 15, Steps: 64 | Train Loss: 0.0862212 Vali Loss: 0.2175134 Test Loss: 0.2933077
Validation loss decreased (0.218577 --> 0.217513).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 16 cost time: 0.9555959701538086
Epoch: 16, Steps: 64 | Train Loss: 0.0854292 Vali Loss: 0.2119491 Test Loss: 0.2934784
Validation loss decreased (0.217513 --> 0.211949).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 17 cost time: 0.9524021148681641
Epoch: 17, Steps: 64 | Train Loss: 0.0852499 Vali Loss: 0.2144658 Test Loss: 0.2956875
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 18 cost time: 0.9543521404266357
Epoch: 18, Steps: 64 | Train Loss: 0.0840343 Vali Loss: 0.2138983 Test Loss: 0.2965293
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 19 cost time: 0.9569516181945801
Epoch: 19, Steps: 64 | Train Loss: 0.0836155 Vali Loss: 0.2126628 Test Loss: 0.2971628
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 20 cost time: 0.9544875621795654
Epoch: 20, Steps: 64 | Train Loss: 0.0834377 Vali Loss: 0.2124915 Test Loss: 0.2970759
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 21 cost time: 0.9523341655731201
Epoch: 21, Steps: 64 | Train Loss: 0.0828099 Vali Loss: 0.2120761 Test Loss: 0.2969583
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 22 cost time: 0.953801155090332
Epoch: 22, Steps: 64 | Train Loss: 0.0823985 Vali Loss: 0.2131596 Test Loss: 0.2988963
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 23 cost time: 0.9363877773284912
Epoch: 23, Steps: 64 | Train Loss: 0.0816626 Vali Loss: 0.2103194 Test Loss: 0.2978714
Validation loss decreased (0.211949 --> 0.210319).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 24 cost time: 0.9109997749328613
Epoch: 24, Steps: 64 | Train Loss: 0.0821188 Vali Loss: 0.2112741 Test Loss: 0.2976019
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 25 cost time: 0.9346282482147217
Epoch: 25, Steps: 64 | Train Loss: 0.0812098 Vali Loss: 0.2109848 Test Loss: 0.2978147
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 26 cost time: 0.9564862251281738
Epoch: 26, Steps: 64 | Train Loss: 0.0813075 Vali Loss: 0.2108057 Test Loss: 0.2991852
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 27 cost time: 0.9254429340362549
Epoch: 27, Steps: 64 | Train Loss: 0.0812785 Vali Loss: 0.2109063 Test Loss: 0.2989204
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 28 cost time: 0.9364309310913086
Epoch: 28, Steps: 64 | Train Loss: 0.0810370 Vali Loss: 0.2120584 Test Loss: 0.2976617
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 29 cost time: 0.9434363842010498
Epoch: 29, Steps: 64 | Train Loss: 0.0805828 Vali Loss: 0.2091061 Test Loss: 0.2987209
Validation loss decreased (0.210319 --> 0.209106).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 30 cost time: 0.9344286918640137
Epoch: 30, Steps: 64 | Train Loss: 0.0811283 Vali Loss: 0.2080678 Test Loss: 0.2987081
Validation loss decreased (0.209106 --> 0.208068).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 31 cost time: 0.9399735927581787
Epoch: 31, Steps: 64 | Train Loss: 0.0810677 Vali Loss: 0.2079815 Test Loss: 0.2979960
Validation loss decreased (0.208068 --> 0.207981).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 32 cost time: 0.9429998397827148
Epoch: 32, Steps: 64 | Train Loss: 0.0799359 Vali Loss: 0.2093073 Test Loss: 0.2986614
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 33 cost time: 0.9449999332427979
Epoch: 33, Steps: 64 | Train Loss: 0.0805665 Vali Loss: 0.2081716 Test Loss: 0.2991724
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 34 cost time: 0.9346227645874023
Epoch: 34, Steps: 64 | Train Loss: 0.0803926 Vali Loss: 0.2088458 Test Loss: 0.2983654
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 35 cost time: 0.9373772144317627
Epoch: 35, Steps: 64 | Train Loss: 0.0800544 Vali Loss: 0.2098729 Test Loss: 0.2994645
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 36 cost time: 0.9432501792907715
Epoch: 36, Steps: 64 | Train Loss: 0.0796766 Vali Loss: 0.2112377 Test Loss: 0.3006926
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 37 cost time: 0.9391505718231201
Epoch: 37, Steps: 64 | Train Loss: 0.0802771 Vali Loss: 0.2079357 Test Loss: 0.2999469
Validation loss decreased (0.207981 --> 0.207936).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 38 cost time: 0.9400143623352051
Epoch: 38, Steps: 64 | Train Loss: 0.0796900 Vali Loss: 0.2068250 Test Loss: 0.3003355
Validation loss decreased (0.207936 --> 0.206825).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 39 cost time: 0.9383788108825684
Epoch: 39, Steps: 64 | Train Loss: 0.0800933 Vali Loss: 0.2099495 Test Loss: 0.3000800
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 40 cost time: 0.9481291770935059
Epoch: 40, Steps: 64 | Train Loss: 0.0797353 Vali Loss: 0.2084366 Test Loss: 0.2992865
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 41 cost time: 0.9400017261505127
Epoch: 41, Steps: 64 | Train Loss: 0.0798845 Vali Loss: 0.2096879 Test Loss: 0.3001547
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 42 cost time: 0.9356217384338379
Epoch: 42, Steps: 64 | Train Loss: 0.0796980 Vali Loss: 0.2111097 Test Loss: 0.2999574
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 43 cost time: 0.9436323642730713
Epoch: 43, Steps: 64 | Train Loss: 0.0795711 Vali Loss: 0.2094947 Test Loss: 0.3004864
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 44 cost time: 0.9444501399993896
Epoch: 44, Steps: 64 | Train Loss: 0.0799375 Vali Loss: 0.2101198 Test Loss: 0.2995125
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 45 cost time: 0.9425115585327148
Epoch: 45, Steps: 64 | Train Loss: 0.0795151 Vali Loss: 0.2095225 Test Loss: 0.3008174
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 46 cost time: 0.9424326419830322
Epoch: 46, Steps: 64 | Train Loss: 0.0793842 Vali Loss: 0.2114889 Test Loss: 0.2996478
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 47 cost time: 0.9279308319091797
Epoch: 47, Steps: 64 | Train Loss: 0.0798769 Vali Loss: 0.2089378 Test Loss: 0.2996762
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 48 cost time: 0.9454782009124756
Epoch: 48, Steps: 64 | Train Loss: 0.0793696 Vali Loss: 0.2090032 Test Loss: 0.3003668
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 49 cost time: 0.9420020580291748
Epoch: 49, Steps: 64 | Train Loss: 0.0794691 Vali Loss: 0.2105583 Test Loss: 0.3006474
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 50 cost time: 0.9239997863769531
Epoch: 50, Steps: 64 | Train Loss: 0.0792133 Vali Loss: 0.2094858 Test Loss: 0.3009900
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 51 cost time: 0.9304192066192627
Epoch: 51, Steps: 64 | Train Loss: 0.0793969 Vali Loss: 0.2102120 Test Loss: 0.3019720
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 52 cost time: 0.936354398727417
Epoch: 52, Steps: 64 | Train Loss: 0.0794062 Vali Loss: 0.2092414 Test Loss: 0.2998228
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 53 cost time: 0.9484560489654541
Epoch: 53, Steps: 64 | Train Loss: 0.0793392 Vali Loss: 0.2108682 Test Loss: 0.3007801
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 54 cost time: 0.9364149570465088
Epoch: 54, Steps: 64 | Train Loss: 0.0794697 Vali Loss: 0.2084896 Test Loss: 0.3000340
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 55 cost time: 0.9363665580749512
Epoch: 55, Steps: 64 | Train Loss: 0.0794250 Vali Loss: 0.2082210 Test Loss: 0.3006156
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 56 cost time: 0.9324183464050293
Epoch: 56, Steps: 64 | Train Loss: 0.0793711 Vali Loss: 0.2080325 Test Loss: 0.3000654
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 57 cost time: 0.9574308395385742
Epoch: 57, Steps: 64 | Train Loss: 0.0789974 Vali Loss: 0.2095807 Test Loss: 0.3008718
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 58 cost time: 0.931492805480957
Epoch: 58, Steps: 64 | Train Loss: 0.0790101 Vali Loss: 0.2093333 Test Loss: 0.3001428
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 59 cost time: 0.9356248378753662
Epoch: 59, Steps: 64 | Train Loss: 0.0794081 Vali Loss: 0.2106804 Test Loss: 0.3017196
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 60 cost time: 0.9516279697418213
Epoch: 60, Steps: 64 | Train Loss: 0.0795258 Vali Loss: 0.2086227 Test Loss: 0.3006696
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.3003354072570801, mae:0.38047298789024353, rse:0.251522034406662
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05733013153076172 GB
Epoch: 1 cost time: 2.233055830001831
Epoch: 1, Steps: 64 | Train Loss: 1.0046043 Vali Loss: 2.9857388 Test Loss: 5.2889671
Validation loss decreased (inf --> 2.985739).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 2 cost time: 0.8724236488342285
Epoch: 2, Steps: 64 | Train Loss: 0.8061643 Vali Loss: 1.9009757 Test Loss: 3.2531273
Validation loss decreased (2.985739 --> 1.900976).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 3 cost time: 0.8694822788238525
Epoch: 3, Steps: 64 | Train Loss: 0.5504435 Vali Loss: 1.3540262 Test Loss: 2.2362301
Validation loss decreased (1.900976 --> 1.354026).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 4 cost time: 0.8693516254425049
Epoch: 4, Steps: 64 | Train Loss: 0.4076538 Vali Loss: 1.0294440 Test Loss: 1.6674479
Validation loss decreased (1.354026 --> 1.029444).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 5 cost time: 0.8766117095947266
Epoch: 5, Steps: 64 | Train Loss: 0.3161723 Vali Loss: 0.8217429 Test Loss: 1.3006375
Validation loss decreased (1.029444 --> 0.821743).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 6 cost time: 0.8694198131561279
Epoch: 6, Steps: 64 | Train Loss: 0.2552984 Vali Loss: 0.6812560 Test Loss: 1.0473816
Validation loss decreased (0.821743 --> 0.681256).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 7 cost time: 0.8833456039428711
Epoch: 7, Steps: 64 | Train Loss: 0.2146168 Vali Loss: 0.5673498 Test Loss: 0.8645883
Validation loss decreased (0.681256 --> 0.567350).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 8 cost time: 0.8673784732818604
Epoch: 8, Steps: 64 | Train Loss: 0.1854624 Vali Loss: 0.4903688 Test Loss: 0.7346916
Validation loss decreased (0.567350 --> 0.490369).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 9 cost time: 0.8713903427124023
Epoch: 9, Steps: 64 | Train Loss: 0.1646644 Vali Loss: 0.4350941 Test Loss: 0.6353946
Validation loss decreased (0.490369 --> 0.435094).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 10 cost time: 0.8717005252838135
Epoch: 10, Steps: 64 | Train Loss: 0.1505895 Vali Loss: 0.3963632 Test Loss: 0.5657738
Validation loss decreased (0.435094 --> 0.396363).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 11 cost time: 0.8817801475524902
Epoch: 11, Steps: 64 | Train Loss: 0.1391481 Vali Loss: 0.3726196 Test Loss: 0.5190389
Validation loss decreased (0.396363 --> 0.372620).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 12 cost time: 0.8726131916046143
Epoch: 12, Steps: 64 | Train Loss: 0.1309649 Vali Loss: 0.3434168 Test Loss: 0.4725065
Validation loss decreased (0.372620 --> 0.343417).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 13 cost time: 0.8713397979736328
Epoch: 13, Steps: 64 | Train Loss: 0.1243961 Vali Loss: 0.3238630 Test Loss: 0.4433494
Validation loss decreased (0.343417 --> 0.323863).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 14 cost time: 0.8754212856292725
Epoch: 14, Steps: 64 | Train Loss: 0.1200078 Vali Loss: 0.3140408 Test Loss: 0.4211213
Validation loss decreased (0.323863 --> 0.314041).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 15 cost time: 0.8714244365692139
Epoch: 15, Steps: 64 | Train Loss: 0.1162225 Vali Loss: 0.3007077 Test Loss: 0.3981797
Validation loss decreased (0.314041 --> 0.300708).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 16 cost time: 0.8674304485321045
Epoch: 16, Steps: 64 | Train Loss: 0.1133568 Vali Loss: 0.2927186 Test Loss: 0.3879389
Validation loss decreased (0.300708 --> 0.292719).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 17 cost time: 0.8659994602203369
Epoch: 17, Steps: 64 | Train Loss: 0.1111532 Vali Loss: 0.2871791 Test Loss: 0.3717597
Validation loss decreased (0.292719 --> 0.287179).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 18 cost time: 0.8825011253356934
Epoch: 18, Steps: 64 | Train Loss: 0.1080315 Vali Loss: 0.2822579 Test Loss: 0.3666280
Validation loss decreased (0.287179 --> 0.282258).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 19 cost time: 0.8726305961608887
Epoch: 19, Steps: 64 | Train Loss: 0.1067746 Vali Loss: 0.2772300 Test Loss: 0.3599791
Validation loss decreased (0.282258 --> 0.277230).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 20 cost time: 0.8727538585662842
Epoch: 20, Steps: 64 | Train Loss: 0.1053029 Vali Loss: 0.2709224 Test Loss: 0.3517949
Validation loss decreased (0.277230 --> 0.270922).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 21 cost time: 0.8707644939422607
Epoch: 21, Steps: 64 | Train Loss: 0.1035403 Vali Loss: 0.2645338 Test Loss: 0.3424811
Validation loss decreased (0.270922 --> 0.264534).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 22 cost time: 0.8825769424438477
Epoch: 22, Steps: 64 | Train Loss: 0.1026963 Vali Loss: 0.2670154 Test Loss: 0.3391550
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 23 cost time: 0.8676180839538574
Epoch: 23, Steps: 64 | Train Loss: 0.1025791 Vali Loss: 0.2598426 Test Loss: 0.3357075
Validation loss decreased (0.264534 --> 0.259843).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 24 cost time: 0.866419792175293
Epoch: 24, Steps: 64 | Train Loss: 0.1013913 Vali Loss: 0.2600625 Test Loss: 0.3327013
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 25 cost time: 0.8669981956481934
Epoch: 25, Steps: 64 | Train Loss: 0.1008394 Vali Loss: 0.2575327 Test Loss: 0.3296977
Validation loss decreased (0.259843 --> 0.257533).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 26 cost time: 0.865389347076416
Epoch: 26, Steps: 64 | Train Loss: 0.0997699 Vali Loss: 0.2555940 Test Loss: 0.3277932
Validation loss decreased (0.257533 --> 0.255594).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 27 cost time: 0.867734432220459
Epoch: 27, Steps: 64 | Train Loss: 0.0995418 Vali Loss: 0.2562468 Test Loss: 0.3257369
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 28 cost time: 0.8730001449584961
Epoch: 28, Steps: 64 | Train Loss: 0.0992295 Vali Loss: 0.2543133 Test Loss: 0.3244623
Validation loss decreased (0.255594 --> 0.254313).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 29 cost time: 0.8800942897796631
Epoch: 29, Steps: 64 | Train Loss: 0.0984651 Vali Loss: 0.2542992 Test Loss: 0.3210530
Validation loss decreased (0.254313 --> 0.254299).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 30 cost time: 0.8673627376556396
Epoch: 30, Steps: 64 | Train Loss: 0.0989445 Vali Loss: 0.2520661 Test Loss: 0.3196746
Validation loss decreased (0.254299 --> 0.252066).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 31 cost time: 0.8694026470184326
Epoch: 31, Steps: 64 | Train Loss: 0.0986249 Vali Loss: 0.2530067 Test Loss: 0.3215722
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 32 cost time: 0.8693833351135254
Epoch: 32, Steps: 64 | Train Loss: 0.0979448 Vali Loss: 0.2505689 Test Loss: 0.3193692
Validation loss decreased (0.252066 --> 0.250569).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 33 cost time: 0.8587386608123779
Epoch: 33, Steps: 64 | Train Loss: 0.0979428 Vali Loss: 0.2472275 Test Loss: 0.3159733
Validation loss decreased (0.250569 --> 0.247228).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 34 cost time: 0.8676290512084961
Epoch: 34, Steps: 64 | Train Loss: 0.0973802 Vali Loss: 0.2511397 Test Loss: 0.3189019
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 35 cost time: 0.8708150386810303
Epoch: 35, Steps: 64 | Train Loss: 0.0979829 Vali Loss: 0.2482226 Test Loss: 0.3169023
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 36 cost time: 0.8771398067474365
Epoch: 36, Steps: 64 | Train Loss: 0.0967362 Vali Loss: 0.2507899 Test Loss: 0.3159764
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 37 cost time: 0.8723843097686768
Epoch: 37, Steps: 64 | Train Loss: 0.0973137 Vali Loss: 0.2490908 Test Loss: 0.3147689
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 38 cost time: 0.8694157600402832
Epoch: 38, Steps: 64 | Train Loss: 0.0962054 Vali Loss: 0.2516022 Test Loss: 0.3158331
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 39 cost time: 0.867999792098999
Epoch: 39, Steps: 64 | Train Loss: 0.0963229 Vali Loss: 0.2471152 Test Loss: 0.3133321
Validation loss decreased (0.247228 --> 0.247115).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 40 cost time: 0.891613245010376
Epoch: 40, Steps: 64 | Train Loss: 0.0963818 Vali Loss: 0.2462516 Test Loss: 0.3137724
Validation loss decreased (0.247115 --> 0.246252).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 41 cost time: 0.8734285831451416
Epoch: 41, Steps: 64 | Train Loss: 0.0957234 Vali Loss: 0.2462007 Test Loss: 0.3138399
Validation loss decreased (0.246252 --> 0.246201).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 42 cost time: 0.8613553047180176
Epoch: 42, Steps: 64 | Train Loss: 0.0966771 Vali Loss: 0.2495244 Test Loss: 0.3114687
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 43 cost time: 0.868999719619751
Epoch: 43, Steps: 64 | Train Loss: 0.0962219 Vali Loss: 0.2470912 Test Loss: 0.3128237
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 44 cost time: 0.8780002593994141
Epoch: 44, Steps: 64 | Train Loss: 0.0959101 Vali Loss: 0.2452704 Test Loss: 0.3129425
Validation loss decreased (0.246201 --> 0.245270).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 45 cost time: 0.8619999885559082
Epoch: 45, Steps: 64 | Train Loss: 0.0958623 Vali Loss: 0.2461843 Test Loss: 0.3112452
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 46 cost time: 0.8756165504455566
Epoch: 46, Steps: 64 | Train Loss: 0.0961485 Vali Loss: 0.2466018 Test Loss: 0.3109994
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 47 cost time: 0.8790056705474854
Epoch: 47, Steps: 64 | Train Loss: 0.0960872 Vali Loss: 0.2463249 Test Loss: 0.3128292
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 48 cost time: 0.8634302616119385
Epoch: 48, Steps: 64 | Train Loss: 0.0957634 Vali Loss: 0.2419692 Test Loss: 0.3103757
Validation loss decreased (0.245270 --> 0.241969).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 49 cost time: 0.8683760166168213
Epoch: 49, Steps: 64 | Train Loss: 0.0954649 Vali Loss: 0.2453514 Test Loss: 0.3092007
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 50 cost time: 0.870999813079834
Epoch: 50, Steps: 64 | Train Loss: 0.0954194 Vali Loss: 0.2465887 Test Loss: 0.3126207
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 51 cost time: 0.8660004138946533
Epoch: 51, Steps: 64 | Train Loss: 0.0964498 Vali Loss: 0.2436570 Test Loss: 0.3097969
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 52 cost time: 0.8646214008331299
Epoch: 52, Steps: 64 | Train Loss: 0.0955934 Vali Loss: 0.2441901 Test Loss: 0.3105977
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 53 cost time: 0.8744184970855713
Epoch: 53, Steps: 64 | Train Loss: 0.0954395 Vali Loss: 0.2423671 Test Loss: 0.3103862
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 54 cost time: 0.8663630485534668
Epoch: 54, Steps: 64 | Train Loss: 0.0955068 Vali Loss: 0.2454941 Test Loss: 0.3093218
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 55 cost time: 0.8617756366729736
Epoch: 55, Steps: 64 | Train Loss: 0.0962828 Vali Loss: 0.2449031 Test Loss: 0.3106424
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 56 cost time: 0.8485000133514404
Epoch: 56, Steps: 64 | Train Loss: 0.0957352 Vali Loss: 0.2436841 Test Loss: 0.3106002
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 57 cost time: 0.8746283054351807
Epoch: 57, Steps: 64 | Train Loss: 0.0958774 Vali Loss: 0.2436677 Test Loss: 0.3081548
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 58 cost time: 0.8803622722625732
Epoch: 58, Steps: 64 | Train Loss: 0.0951138 Vali Loss: 0.2435606 Test Loss: 0.3092038
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 59 cost time: 0.8713951110839844
Epoch: 59, Steps: 64 | Train Loss: 0.0953884 Vali Loss: 0.2446218 Test Loss: 0.3101448
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 60 cost time: 0.8648016452789307
Epoch: 60, Steps: 64 | Train Loss: 0.0959646 Vali Loss: 0.2430228 Test Loss: 0.3096818
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.31037575006484985, mae:0.38140809535980225, rse:0.2556917369365692
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06047630310058594 GB
Epoch: 1 cost time: 2.2694499492645264
Epoch: 1, Steps: 64 | Train Loss: 0.8801009 Vali Loss: 2.6831408 Test Loss: 4.7127466
Validation loss decreased (inf --> 2.683141).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 2 cost time: 0.8289999961853027
Epoch: 2, Steps: 64 | Train Loss: 0.5599761 Vali Loss: 0.7321987 Test Loss: 1.1095673
Validation loss decreased (2.683141 --> 0.732199).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 3 cost time: 0.8503694534301758
Epoch: 3, Steps: 64 | Train Loss: 0.1692712 Vali Loss: 0.2835272 Test Loss: 0.2833176
Validation loss decreased (0.732199 --> 0.283527).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 4 cost time: 0.8510000705718994
Epoch: 4, Steps: 64 | Train Loss: 0.1182227 Vali Loss: 0.2655388 Test Loss: 0.2912405
Validation loss decreased (0.283527 --> 0.265539).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 5 cost time: 0.8453476428985596
Epoch: 5, Steps: 64 | Train Loss: 0.1109913 Vali Loss: 0.2523042 Test Loss: 0.2853144
Validation loss decreased (0.265539 --> 0.252304).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 6 cost time: 0.8352904319763184
Epoch: 6, Steps: 64 | Train Loss: 0.1060058 Vali Loss: 0.2443368 Test Loss: 0.2867049
Validation loss decreased (0.252304 --> 0.244337).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 7 cost time: 0.8430004119873047
Epoch: 7, Steps: 64 | Train Loss: 0.1021292 Vali Loss: 0.2428955 Test Loss: 0.2834623
Validation loss decreased (0.244337 --> 0.242895).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 8 cost time: 0.8476176261901855
Epoch: 8, Steps: 64 | Train Loss: 0.0996950 Vali Loss: 0.2336367 Test Loss: 0.2886202
Validation loss decreased (0.242895 --> 0.233637).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 9 cost time: 0.8434174060821533
Epoch: 9, Steps: 64 | Train Loss: 0.0970957 Vali Loss: 0.2339234 Test Loss: 0.2864540
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 10 cost time: 0.8445699214935303
Epoch: 10, Steps: 64 | Train Loss: 0.0952065 Vali Loss: 0.2311655 Test Loss: 0.2860275
Validation loss decreased (0.233637 --> 0.231166).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 11 cost time: 0.8505804538726807
Epoch: 11, Steps: 64 | Train Loss: 0.0930995 Vali Loss: 0.2301371 Test Loss: 0.2855103
Validation loss decreased (0.231166 --> 0.230137).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 12 cost time: 0.847771406173706
Epoch: 12, Steps: 64 | Train Loss: 0.0917927 Vali Loss: 0.2275930 Test Loss: 0.2884657
Validation loss decreased (0.230137 --> 0.227593).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 13 cost time: 0.8526227474212646
Epoch: 13, Steps: 64 | Train Loss: 0.0908140 Vali Loss: 0.2266627 Test Loss: 0.2877972
Validation loss decreased (0.227593 --> 0.226663).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 14 cost time: 0.853358268737793
Epoch: 14, Steps: 64 | Train Loss: 0.0894402 Vali Loss: 0.2289906 Test Loss: 0.2872305
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 15 cost time: 0.8474862575531006
Epoch: 15, Steps: 64 | Train Loss: 0.0888614 Vali Loss: 0.2217660 Test Loss: 0.2898913
Validation loss decreased (0.226663 --> 0.221766).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 16 cost time: 0.8474667072296143
Epoch: 16, Steps: 64 | Train Loss: 0.0881860 Vali Loss: 0.2223988 Test Loss: 0.2916788
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 17 cost time: 0.8529994487762451
Epoch: 17, Steps: 64 | Train Loss: 0.0869980 Vali Loss: 0.2180374 Test Loss: 0.2911064
Validation loss decreased (0.221766 --> 0.218037).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 18 cost time: 0.8500003814697266
Epoch: 18, Steps: 64 | Train Loss: 0.0866784 Vali Loss: 0.2215631 Test Loss: 0.2919638
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 19 cost time: 0.8493931293487549
Epoch: 19, Steps: 64 | Train Loss: 0.0863761 Vali Loss: 0.2217565 Test Loss: 0.2915484
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 20 cost time: 0.8559842109680176
Epoch: 20, Steps: 64 | Train Loss: 0.0852962 Vali Loss: 0.2214326 Test Loss: 0.2944457
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 21 cost time: 0.8454327583312988
Epoch: 21, Steps: 64 | Train Loss: 0.0853419 Vali Loss: 0.2137649 Test Loss: 0.2920029
Validation loss decreased (0.218037 --> 0.213765).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 22 cost time: 0.8454601764678955
Epoch: 22, Steps: 64 | Train Loss: 0.0848677 Vali Loss: 0.2185370 Test Loss: 0.2939320
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 23 cost time: 0.8459999561309814
Epoch: 23, Steps: 64 | Train Loss: 0.0845796 Vali Loss: 0.2168435 Test Loss: 0.2943586
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 24 cost time: 0.8612034320831299
Epoch: 24, Steps: 64 | Train Loss: 0.0839814 Vali Loss: 0.2161515 Test Loss: 0.2922133
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 25 cost time: 0.8495514392852783
Epoch: 25, Steps: 64 | Train Loss: 0.0841369 Vali Loss: 0.2169225 Test Loss: 0.2939299
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 26 cost time: 0.8463706970214844
Epoch: 26, Steps: 64 | Train Loss: 0.0836692 Vali Loss: 0.2115987 Test Loss: 0.2926508
Validation loss decreased (0.213765 --> 0.211599).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 27 cost time: 0.851738452911377
Epoch: 27, Steps: 64 | Train Loss: 0.0833851 Vali Loss: 0.2150253 Test Loss: 0.2928661
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 28 cost time: 0.8554668426513672
Epoch: 28, Steps: 64 | Train Loss: 0.0833402 Vali Loss: 0.2140717 Test Loss: 0.2934777
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 29 cost time: 0.845639705657959
Epoch: 29, Steps: 64 | Train Loss: 0.0828067 Vali Loss: 0.2152604 Test Loss: 0.2941285
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 30 cost time: 0.9180407524108887
Epoch: 30, Steps: 64 | Train Loss: 0.0832353 Vali Loss: 0.2113195 Test Loss: 0.2939245
Validation loss decreased (0.211599 --> 0.211319).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 31 cost time: 0.9244909286499023
Epoch: 31, Steps: 64 | Train Loss: 0.0828161 Vali Loss: 0.2135534 Test Loss: 0.2936138
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 32 cost time: 0.8519997596740723
Epoch: 32, Steps: 64 | Train Loss: 0.0826811 Vali Loss: 0.2147951 Test Loss: 0.2948519
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 33 cost time: 0.8406157493591309
Epoch: 33, Steps: 64 | Train Loss: 0.0828950 Vali Loss: 0.2135162 Test Loss: 0.2940350
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 34 cost time: 0.8420000076293945
Epoch: 34, Steps: 64 | Train Loss: 0.0816161 Vali Loss: 0.2128714 Test Loss: 0.2944640
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 35 cost time: 0.8456902503967285
Epoch: 35, Steps: 64 | Train Loss: 0.0814130 Vali Loss: 0.2109919 Test Loss: 0.2948854
Validation loss decreased (0.211319 --> 0.210992).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 36 cost time: 0.8403921127319336
Epoch: 36, Steps: 64 | Train Loss: 0.0820267 Vali Loss: 0.2117131 Test Loss: 0.2947634
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 37 cost time: 0.8464024066925049
Epoch: 37, Steps: 64 | Train Loss: 0.0819597 Vali Loss: 0.2141989 Test Loss: 0.2946658
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 38 cost time: 0.8432345390319824
Epoch: 38, Steps: 64 | Train Loss: 0.0825483 Vali Loss: 0.2146598 Test Loss: 0.2954134
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 39 cost time: 0.8614895343780518
Epoch: 39, Steps: 64 | Train Loss: 0.0816284 Vali Loss: 0.2121352 Test Loss: 0.2949268
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 40 cost time: 0.8506138324737549
Epoch: 40, Steps: 64 | Train Loss: 0.0820442 Vali Loss: 0.2148275 Test Loss: 0.2945932
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 41 cost time: 0.8473758697509766
Epoch: 41, Steps: 64 | Train Loss: 0.0818114 Vali Loss: 0.2133386 Test Loss: 0.2945054
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 42 cost time: 0.8513665199279785
Epoch: 42, Steps: 64 | Train Loss: 0.0824003 Vali Loss: 0.2139054 Test Loss: 0.2957350
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 43 cost time: 0.8457884788513184
Epoch: 43, Steps: 64 | Train Loss: 0.0816305 Vali Loss: 0.2132678 Test Loss: 0.2942139
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 44 cost time: 0.8428041934967041
Epoch: 44, Steps: 64 | Train Loss: 0.0812448 Vali Loss: 0.2121805 Test Loss: 0.2948865
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 45 cost time: 0.8446128368377686
Epoch: 45, Steps: 64 | Train Loss: 0.0822937 Vali Loss: 0.2131908 Test Loss: 0.2938992
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 46 cost time: 0.8554632663726807
Epoch: 46, Steps: 64 | Train Loss: 0.0817293 Vali Loss: 0.2135031 Test Loss: 0.2950019
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 47 cost time: 0.8628466129302979
Epoch: 47, Steps: 64 | Train Loss: 0.0815242 Vali Loss: 0.2122211 Test Loss: 0.2945083
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 48 cost time: 0.8604083061218262
Epoch: 48, Steps: 64 | Train Loss: 0.0820600 Vali Loss: 0.2143220 Test Loss: 0.2949196
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 49 cost time: 0.8470063209533691
Epoch: 49, Steps: 64 | Train Loss: 0.0820502 Vali Loss: 0.2127768 Test Loss: 0.2950678
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 50 cost time: 0.8326172828674316
Epoch: 50, Steps: 64 | Train Loss: 0.0815031 Vali Loss: 0.2124847 Test Loss: 0.2942968
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 51 cost time: 0.813500165939331
Epoch: 51, Steps: 64 | Train Loss: 0.0815298 Vali Loss: 0.2139363 Test Loss: 0.2952361
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 52 cost time: 0.8324582576751709
Epoch: 52, Steps: 64 | Train Loss: 0.0819585 Vali Loss: 0.2101810 Test Loss: 0.2947640
Validation loss decreased (0.210992 --> 0.210181).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 53 cost time: 0.8407332897186279
Epoch: 53, Steps: 64 | Train Loss: 0.0816256 Vali Loss: 0.2155955 Test Loss: 0.2949522
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 54 cost time: 0.8266205787658691
Epoch: 54, Steps: 64 | Train Loss: 0.0815939 Vali Loss: 0.2124861 Test Loss: 0.2945454
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 55 cost time: 0.8466157913208008
Epoch: 55, Steps: 64 | Train Loss: 0.0816180 Vali Loss: 0.2133679 Test Loss: 0.2951076
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 56 cost time: 0.8496484756469727
Epoch: 56, Steps: 64 | Train Loss: 0.0816323 Vali Loss: 0.2123233 Test Loss: 0.2951887
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 57 cost time: 0.8583574295043945
Epoch: 57, Steps: 64 | Train Loss: 0.0817437 Vali Loss: 0.2147859 Test Loss: 0.2945946
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 58 cost time: 0.8027842044830322
Epoch: 58, Steps: 64 | Train Loss: 0.0813283 Vali Loss: 0.2114080 Test Loss: 0.2941792
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 59 cost time: 0.8440008163452148
Epoch: 59, Steps: 64 | Train Loss: 0.0820414 Vali Loss: 0.2130838 Test Loss: 0.2958196
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 60 cost time: 0.84161376953125
Epoch: 60, Steps: 64 | Train Loss: 0.0819171 Vali Loss: 0.2110540 Test Loss: 0.2942997
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2947639524936676, mae:0.3717312216758728, rse:0.24917815625667572
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06367111206054688 GB
Epoch: 1 cost time: 2.3004403114318848
Epoch: 1, Steps: 64 | Train Loss: 0.8366939 Vali Loss: 2.5974216 Test Loss: 4.5396304
Validation loss decreased (inf --> 2.597422).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 2 cost time: 0.9334232807159424
Epoch: 2, Steps: 64 | Train Loss: 0.4559175 Vali Loss: 0.2900142 Test Loss: 0.3069233
Validation loss decreased (2.597422 --> 0.290014).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 3 cost time: 0.9609959125518799
Epoch: 3, Steps: 64 | Train Loss: 0.1290586 Vali Loss: 0.2750741 Test Loss: 0.3197623
Validation loss decreased (0.290014 --> 0.275074).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 4 cost time: 0.9370183944702148
Epoch: 4, Steps: 64 | Train Loss: 0.1105583 Vali Loss: 0.2504373 Test Loss: 0.2881989
Validation loss decreased (0.275074 --> 0.250437).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 5 cost time: 0.9341955184936523
Epoch: 5, Steps: 64 | Train Loss: 0.1043129 Vali Loss: 0.2447815 Test Loss: 0.2878517
Validation loss decreased (0.250437 --> 0.244782).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 6 cost time: 0.93359375
Epoch: 6, Steps: 64 | Train Loss: 0.0996656 Vali Loss: 0.2363576 Test Loss: 0.2887801
Validation loss decreased (0.244782 --> 0.236358).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 7 cost time: 0.9340000152587891
Epoch: 7, Steps: 64 | Train Loss: 0.0968074 Vali Loss: 0.2394349 Test Loss: 0.2897467
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 8 cost time: 0.9313797950744629
Epoch: 8, Steps: 64 | Train Loss: 0.0942398 Vali Loss: 0.2356065 Test Loss: 0.2903522
Validation loss decreased (0.236358 --> 0.235607).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 9 cost time: 0.9346127510070801
Epoch: 9, Steps: 64 | Train Loss: 0.0921809 Vali Loss: 0.2306076 Test Loss: 0.2946259
Validation loss decreased (0.235607 --> 0.230608).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 10 cost time: 0.9323444366455078
Epoch: 10, Steps: 64 | Train Loss: 0.0900765 Vali Loss: 0.2307720 Test Loss: 0.2937578
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 11 cost time: 0.94736647605896
Epoch: 11, Steps: 64 | Train Loss: 0.0883745 Vali Loss: 0.2272941 Test Loss: 0.2966002
Validation loss decreased (0.230608 --> 0.227294).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 12 cost time: 0.9353940486907959
Epoch: 12, Steps: 64 | Train Loss: 0.0874956 Vali Loss: 0.2246684 Test Loss: 0.2974099
Validation loss decreased (0.227294 --> 0.224668).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 13 cost time: 0.937985897064209
Epoch: 13, Steps: 64 | Train Loss: 0.0867011 Vali Loss: 0.2261519 Test Loss: 0.3005223
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 14 cost time: 0.9294312000274658
Epoch: 14, Steps: 64 | Train Loss: 0.0850390 Vali Loss: 0.2267382 Test Loss: 0.2992319
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 15 cost time: 0.9307363033294678
Epoch: 15, Steps: 64 | Train Loss: 0.0842704 Vali Loss: 0.2215597 Test Loss: 0.2994875
Validation loss decreased (0.224668 --> 0.221560).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 16 cost time: 0.9320001602172852
Epoch: 16, Steps: 64 | Train Loss: 0.0835120 Vali Loss: 0.2245031 Test Loss: 0.3019095
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 17 cost time: 0.9336237907409668
Epoch: 17, Steps: 64 | Train Loss: 0.0832203 Vali Loss: 0.2205089 Test Loss: 0.3008979
Validation loss decreased (0.221560 --> 0.220509).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 18 cost time: 0.9466304779052734
Epoch: 18, Steps: 64 | Train Loss: 0.0824479 Vali Loss: 0.2206191 Test Loss: 0.3034775
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 19 cost time: 0.9323904514312744
Epoch: 19, Steps: 64 | Train Loss: 0.0814882 Vali Loss: 0.2204274 Test Loss: 0.3032829
Validation loss decreased (0.220509 --> 0.220427).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 20 cost time: 0.9335243701934814
Epoch: 20, Steps: 64 | Train Loss: 0.0815839 Vali Loss: 0.2204746 Test Loss: 0.3036921
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 21 cost time: 0.9542279243469238
Epoch: 21, Steps: 64 | Train Loss: 0.0808472 Vali Loss: 0.2174990 Test Loss: 0.3032735
Validation loss decreased (0.220427 --> 0.217499).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 22 cost time: 0.9274768829345703
Epoch: 22, Steps: 64 | Train Loss: 0.0807959 Vali Loss: 0.2212912 Test Loss: 0.3056342
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 23 cost time: 0.9315142631530762
Epoch: 23, Steps: 64 | Train Loss: 0.0798845 Vali Loss: 0.2201385 Test Loss: 0.3043345
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 24 cost time: 0.9327020645141602
Epoch: 24, Steps: 64 | Train Loss: 0.0799984 Vali Loss: 0.2172839 Test Loss: 0.3062460
Validation loss decreased (0.217499 --> 0.217284).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 25 cost time: 0.9153971672058105
Epoch: 25, Steps: 64 | Train Loss: 0.0802430 Vali Loss: 0.2153790 Test Loss: 0.3056305
Validation loss decreased (0.217284 --> 0.215379).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 26 cost time: 0.9042863845825195
Epoch: 26, Steps: 64 | Train Loss: 0.0797426 Vali Loss: 0.2199629 Test Loss: 0.3068608
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 27 cost time: 0.9600346088409424
Epoch: 27, Steps: 64 | Train Loss: 0.0794492 Vali Loss: 0.2195547 Test Loss: 0.3064190
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 28 cost time: 0.9334676265716553
Epoch: 28, Steps: 64 | Train Loss: 0.0791637 Vali Loss: 0.2170227 Test Loss: 0.3071108
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 29 cost time: 1.0063426494598389
Epoch: 29, Steps: 64 | Train Loss: 0.0794413 Vali Loss: 0.2160678 Test Loss: 0.3065924
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 30 cost time: 0.9554319381713867
Epoch: 30, Steps: 64 | Train Loss: 0.0795162 Vali Loss: 0.2195028 Test Loss: 0.3072759
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 31 cost time: 0.9310705661773682
Epoch: 31, Steps: 64 | Train Loss: 0.0792340 Vali Loss: 0.2174208 Test Loss: 0.3071303
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 32 cost time: 0.9353454113006592
Epoch: 32, Steps: 64 | Train Loss: 0.0788824 Vali Loss: 0.2174000 Test Loss: 0.3075435
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 33 cost time: 0.9391682147979736
Epoch: 33, Steps: 64 | Train Loss: 0.0791105 Vali Loss: 0.2190470 Test Loss: 0.3079128
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 34 cost time: 0.9350001811981201
Epoch: 34, Steps: 64 | Train Loss: 0.0787052 Vali Loss: 0.2186214 Test Loss: 0.3084104
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 35 cost time: 0.9452338218688965
Epoch: 35, Steps: 64 | Train Loss: 0.0794202 Vali Loss: 0.2188395 Test Loss: 0.3079978
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 36 cost time: 0.9426231384277344
Epoch: 36, Steps: 64 | Train Loss: 0.0789766 Vali Loss: 0.2163898 Test Loss: 0.3080467
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 37 cost time: 0.9354813098907471
Epoch: 37, Steps: 64 | Train Loss: 0.0781510 Vali Loss: 0.2149137 Test Loss: 0.3091108
Validation loss decreased (0.215379 --> 0.214914).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 38 cost time: 0.96624755859375
Epoch: 38, Steps: 64 | Train Loss: 0.0782189 Vali Loss: 0.2191456 Test Loss: 0.3089893
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 39 cost time: 0.9430074691772461
Epoch: 39, Steps: 64 | Train Loss: 0.0776903 Vali Loss: 0.2147656 Test Loss: 0.3090724
Validation loss decreased (0.214914 --> 0.214766).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 40 cost time: 0.94014573097229
Epoch: 40, Steps: 64 | Train Loss: 0.0783128 Vali Loss: 0.2173820 Test Loss: 0.3088249
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 41 cost time: 0.9484014511108398
Epoch: 41, Steps: 64 | Train Loss: 0.0783034 Vali Loss: 0.2144764 Test Loss: 0.3087877
Validation loss decreased (0.214766 --> 0.214476).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 42 cost time: 0.9448983669281006
Epoch: 42, Steps: 64 | Train Loss: 0.0782432 Vali Loss: 0.2162871 Test Loss: 0.3088395
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 43 cost time: 0.9489994049072266
Epoch: 43, Steps: 64 | Train Loss: 0.0783186 Vali Loss: 0.2176507 Test Loss: 0.3087260
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 44 cost time: 0.948606014251709
Epoch: 44, Steps: 64 | Train Loss: 0.0781305 Vali Loss: 0.2153675 Test Loss: 0.3084429
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 45 cost time: 0.9480912685394287
Epoch: 45, Steps: 64 | Train Loss: 0.0778424 Vali Loss: 0.2165616 Test Loss: 0.3090537
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 46 cost time: 0.9415340423583984
Epoch: 46, Steps: 64 | Train Loss: 0.0783449 Vali Loss: 0.2162734 Test Loss: 0.3091960
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 47 cost time: 0.9371330738067627
Epoch: 47, Steps: 64 | Train Loss: 0.0786393 Vali Loss: 0.2170853 Test Loss: 0.3087061
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 48 cost time: 0.9311618804931641
Epoch: 48, Steps: 64 | Train Loss: 0.0780728 Vali Loss: 0.2185861 Test Loss: 0.3076865
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 49 cost time: 0.9264638423919678
Epoch: 49, Steps: 64 | Train Loss: 0.0775073 Vali Loss: 0.2155571 Test Loss: 0.3081934
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 50 cost time: 0.9302597045898438
Epoch: 50, Steps: 64 | Train Loss: 0.0784194 Vali Loss: 0.2188233 Test Loss: 0.3092949
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 51 cost time: 0.9247691631317139
Epoch: 51, Steps: 64 | Train Loss: 0.0776486 Vali Loss: 0.2168252 Test Loss: 0.3093298
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 52 cost time: 0.9389019012451172
Epoch: 52, Steps: 64 | Train Loss: 0.0785154 Vali Loss: 0.2152538 Test Loss: 0.3088755
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 53 cost time: 0.9326128959655762
Epoch: 53, Steps: 64 | Train Loss: 0.0783614 Vali Loss: 0.2164000 Test Loss: 0.3081621
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 54 cost time: 0.9326229095458984
Epoch: 54, Steps: 64 | Train Loss: 0.0781019 Vali Loss: 0.2149359 Test Loss: 0.3089114
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 55 cost time: 0.9463818073272705
Epoch: 55, Steps: 64 | Train Loss: 0.0777805 Vali Loss: 0.2189271 Test Loss: 0.3091269
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 56 cost time: 0.933774471282959
Epoch: 56, Steps: 64 | Train Loss: 0.0777193 Vali Loss: 0.2166610 Test Loss: 0.3094285
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 57 cost time: 0.9323348999023438
Epoch: 57, Steps: 64 | Train Loss: 0.0784330 Vali Loss: 0.2164726 Test Loss: 0.3092279
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 58 cost time: 0.9404189586639404
Epoch: 58, Steps: 64 | Train Loss: 0.0780842 Vali Loss: 0.2180520 Test Loss: 0.3084316
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 59 cost time: 0.9298620223999023
Epoch: 59, Steps: 64 | Train Loss: 0.0779155 Vali Loss: 0.2174487 Test Loss: 0.3096143
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 60 cost time: 0.9347896575927734
Epoch: 60, Steps: 64 | Train Loss: 0.0779961 Vali Loss: 0.2169477 Test Loss: 0.3089043
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.30878767371177673, mae:0.3893889784812927, rse:0.25503674149513245
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05749082565307617 GB
Epoch: 1 cost time: 2.324807643890381
Epoch: 1, Steps: 64 | Train Loss: 0.9647439 Vali Loss: 2.8678317 Test Loss: 5.0809202
Validation loss decreased (inf --> 2.867832).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 2 cost time: 0.8986256122589111
Epoch: 2, Steps: 64 | Train Loss: 0.7686577 Vali Loss: 1.7975581 Test Loss: 3.0817239
Validation loss decreased (2.867832 --> 1.797558).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 3 cost time: 0.8700001239776611
Epoch: 3, Steps: 64 | Train Loss: 0.5252140 Vali Loss: 1.3323009 Test Loss: 2.2093413
Validation loss decreased (1.797558 --> 1.332301).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 4 cost time: 0.8842551708221436
Epoch: 4, Steps: 64 | Train Loss: 0.3935521 Vali Loss: 1.0389105 Test Loss: 1.6868037
Validation loss decreased (1.332301 --> 1.038911).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 5 cost time: 0.884706974029541
Epoch: 5, Steps: 64 | Train Loss: 0.3064330 Vali Loss: 0.8133027 Test Loss: 1.3015296
Validation loss decreased (1.038911 --> 0.813303).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 6 cost time: 0.9374089241027832
Epoch: 6, Steps: 64 | Train Loss: 0.2482785 Vali Loss: 0.6638805 Test Loss: 1.0404695
Validation loss decreased (0.813303 --> 0.663880).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 7 cost time: 0.8754093647003174
Epoch: 7, Steps: 64 | Train Loss: 0.2084630 Vali Loss: 0.5656358 Test Loss: 0.8675466
Validation loss decreased (0.663880 --> 0.565636).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 8 cost time: 0.8709993362426758
Epoch: 8, Steps: 64 | Train Loss: 0.1803027 Vali Loss: 0.4835595 Test Loss: 0.7279942
Validation loss decreased (0.565636 --> 0.483560).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 9 cost time: 0.861635684967041
Epoch: 9, Steps: 64 | Train Loss: 0.1608010 Vali Loss: 0.4317229 Test Loss: 0.6330527
Validation loss decreased (0.483560 --> 0.431723).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 10 cost time: 0.8884572982788086
Epoch: 10, Steps: 64 | Train Loss: 0.1462312 Vali Loss: 0.3937824 Test Loss: 0.5653450
Validation loss decreased (0.431723 --> 0.393782).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 11 cost time: 0.8843371868133545
Epoch: 11, Steps: 64 | Train Loss: 0.1357967 Vali Loss: 0.3673943 Test Loss: 0.5193589
Validation loss decreased (0.393782 --> 0.367394).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 12 cost time: 0.8953273296356201
Epoch: 12, Steps: 64 | Train Loss: 0.1281416 Vali Loss: 0.3458830 Test Loss: 0.4844204
Validation loss decreased (0.367394 --> 0.345883).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 13 cost time: 0.8868436813354492
Epoch: 13, Steps: 64 | Train Loss: 0.1223605 Vali Loss: 0.3234292 Test Loss: 0.4475718
Validation loss decreased (0.345883 --> 0.323429).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 14 cost time: 0.8877067565917969
Epoch: 14, Steps: 64 | Train Loss: 0.1188056 Vali Loss: 0.3117959 Test Loss: 0.4229712
Validation loss decreased (0.323429 --> 0.311796).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 15 cost time: 0.8776707649230957
Epoch: 15, Steps: 64 | Train Loss: 0.1149544 Vali Loss: 0.3005136 Test Loss: 0.4069686
Validation loss decreased (0.311796 --> 0.300514).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 16 cost time: 0.8885939121246338
Epoch: 16, Steps: 64 | Train Loss: 0.1110062 Vali Loss: 0.2934411 Test Loss: 0.3924513
Validation loss decreased (0.300514 --> 0.293441).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 17 cost time: 0.8794515132904053
Epoch: 17, Steps: 64 | Train Loss: 0.1095438 Vali Loss: 0.2857466 Test Loss: 0.3819072
Validation loss decreased (0.293441 --> 0.285747).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 18 cost time: 0.8774905204772949
Epoch: 18, Steps: 64 | Train Loss: 0.1073777 Vali Loss: 0.2793310 Test Loss: 0.3720029
Validation loss decreased (0.285747 --> 0.279331).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 19 cost time: 0.8990256786346436
Epoch: 19, Steps: 64 | Train Loss: 0.1061068 Vali Loss: 0.2755495 Test Loss: 0.3661450
Validation loss decreased (0.279331 --> 0.275549).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 20 cost time: 0.9629991054534912
Epoch: 20, Steps: 64 | Train Loss: 0.1046841 Vali Loss: 0.2754999 Test Loss: 0.3582550
Validation loss decreased (0.275549 --> 0.275500).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 21 cost time: 0.8920001983642578
Epoch: 21, Steps: 64 | Train Loss: 0.1044135 Vali Loss: 0.2716959 Test Loss: 0.3534419
Validation loss decreased (0.275500 --> 0.271696).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 22 cost time: 0.8876192569732666
Epoch: 22, Steps: 64 | Train Loss: 0.1027739 Vali Loss: 0.2672964 Test Loss: 0.3493327
Validation loss decreased (0.271696 --> 0.267296).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 23 cost time: 0.8701050281524658
Epoch: 23, Steps: 64 | Train Loss: 0.1023958 Vali Loss: 0.2651142 Test Loss: 0.3421868
Validation loss decreased (0.267296 --> 0.265114).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 24 cost time: 0.8644018173217773
Epoch: 24, Steps: 64 | Train Loss: 0.1013663 Vali Loss: 0.2629972 Test Loss: 0.3427992
Validation loss decreased (0.265114 --> 0.262997).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 25 cost time: 0.8764727115631104
Epoch: 25, Steps: 64 | Train Loss: 0.1010942 Vali Loss: 0.2615966 Test Loss: 0.3381976
Validation loss decreased (0.262997 --> 0.261597).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 26 cost time: 0.8763201236724854
Epoch: 26, Steps: 64 | Train Loss: 0.1001281 Vali Loss: 0.2574752 Test Loss: 0.3364286
Validation loss decreased (0.261597 --> 0.257475).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 27 cost time: 0.876086950302124
Epoch: 27, Steps: 64 | Train Loss: 0.0993809 Vali Loss: 0.2567259 Test Loss: 0.3335185
Validation loss decreased (0.257475 --> 0.256726).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 28 cost time: 0.8627371788024902
Epoch: 28, Steps: 64 | Train Loss: 0.0994976 Vali Loss: 0.2582279 Test Loss: 0.3336129
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 29 cost time: 0.8896782398223877
Epoch: 29, Steps: 64 | Train Loss: 0.0992464 Vali Loss: 0.2569945 Test Loss: 0.3324580
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 30 cost time: 0.8838415145874023
Epoch: 30, Steps: 64 | Train Loss: 0.0986440 Vali Loss: 0.2571682 Test Loss: 0.3304192
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 31 cost time: 0.8612375259399414
Epoch: 31, Steps: 64 | Train Loss: 0.0982929 Vali Loss: 0.2533256 Test Loss: 0.3287710
Validation loss decreased (0.256726 --> 0.253326).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 32 cost time: 0.8685445785522461
Epoch: 32, Steps: 64 | Train Loss: 0.0984086 Vali Loss: 0.2542729 Test Loss: 0.3292779
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 33 cost time: 0.8709900379180908
Epoch: 33, Steps: 64 | Train Loss: 0.0978025 Vali Loss: 0.2512880 Test Loss: 0.3264457
Validation loss decreased (0.253326 --> 0.251288).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 34 cost time: 0.8868885040283203
Epoch: 34, Steps: 64 | Train Loss: 0.0978046 Vali Loss: 0.2540903 Test Loss: 0.3266235
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 35 cost time: 0.8929660320281982
Epoch: 35, Steps: 64 | Train Loss: 0.0974871 Vali Loss: 0.2537651 Test Loss: 0.3263909
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 36 cost time: 0.9004285335540771
Epoch: 36, Steps: 64 | Train Loss: 0.0977303 Vali Loss: 0.2505245 Test Loss: 0.3236975
Validation loss decreased (0.251288 --> 0.250524).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 37 cost time: 0.9133951663970947
Epoch: 37, Steps: 64 | Train Loss: 0.0972997 Vali Loss: 0.2529798 Test Loss: 0.3227307
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 38 cost time: 0.9094464778900146
Epoch: 38, Steps: 64 | Train Loss: 0.0972649 Vali Loss: 0.2523065 Test Loss: 0.3237851
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 39 cost time: 0.9079997539520264
Epoch: 39, Steps: 64 | Train Loss: 0.0963247 Vali Loss: 0.2487691 Test Loss: 0.3239707
Validation loss decreased (0.250524 --> 0.248769).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 40 cost time: 0.902606725692749
Epoch: 40, Steps: 64 | Train Loss: 0.0967731 Vali Loss: 0.2469170 Test Loss: 0.3230390
Validation loss decreased (0.248769 --> 0.246917).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 41 cost time: 0.8868353366851807
Epoch: 41, Steps: 64 | Train Loss: 0.0961811 Vali Loss: 0.2503797 Test Loss: 0.3238909
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 42 cost time: 0.8706321716308594
Epoch: 42, Steps: 64 | Train Loss: 0.0964670 Vali Loss: 0.2486131 Test Loss: 0.3220810
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 43 cost time: 0.8684625625610352
Epoch: 43, Steps: 64 | Train Loss: 0.0965772 Vali Loss: 0.2485431 Test Loss: 0.3215933
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 44 cost time: 0.8777685165405273
Epoch: 44, Steps: 64 | Train Loss: 0.0965717 Vali Loss: 0.2487357 Test Loss: 0.3211671
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 45 cost time: 0.9250004291534424
Epoch: 45, Steps: 64 | Train Loss: 0.0965251 Vali Loss: 0.2477569 Test Loss: 0.3212017
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 46 cost time: 0.8896851539611816
Epoch: 46, Steps: 64 | Train Loss: 0.0967086 Vali Loss: 0.2466771 Test Loss: 0.3198179
Validation loss decreased (0.246917 --> 0.246677).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 47 cost time: 0.8820388317108154
Epoch: 47, Steps: 64 | Train Loss: 0.0961608 Vali Loss: 0.2491258 Test Loss: 0.3208152
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 48 cost time: 0.8866531848907471
Epoch: 48, Steps: 64 | Train Loss: 0.0964169 Vali Loss: 0.2473544 Test Loss: 0.3191445
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 49 cost time: 0.8842101097106934
Epoch: 49, Steps: 64 | Train Loss: 0.0959182 Vali Loss: 0.2494748 Test Loss: 0.3202813
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 50 cost time: 0.8827614784240723
Epoch: 50, Steps: 64 | Train Loss: 0.0963135 Vali Loss: 0.2481172 Test Loss: 0.3202066
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 51 cost time: 0.9004685878753662
Epoch: 51, Steps: 64 | Train Loss: 0.0957741 Vali Loss: 0.2472794 Test Loss: 0.3196063
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 52 cost time: 0.8520021438598633
Epoch: 52, Steps: 64 | Train Loss: 0.0961252 Vali Loss: 0.2478358 Test Loss: 0.3178402
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 53 cost time: 0.8764286041259766
Epoch: 53, Steps: 64 | Train Loss: 0.0958884 Vali Loss: 0.2484971 Test Loss: 0.3208916
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 54 cost time: 0.8793413639068604
Epoch: 54, Steps: 64 | Train Loss: 0.0960467 Vali Loss: 0.2485577 Test Loss: 0.3189052
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 55 cost time: 0.8913581371307373
Epoch: 55, Steps: 64 | Train Loss: 0.0960328 Vali Loss: 0.2484749 Test Loss: 0.3174778
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 56 cost time: 0.8889999389648438
Epoch: 56, Steps: 64 | Train Loss: 0.0958169 Vali Loss: 0.2469748 Test Loss: 0.3190185
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 57 cost time: 0.8846445083618164
Epoch: 57, Steps: 64 | Train Loss: 0.0961490 Vali Loss: 0.2470411 Test Loss: 0.3165392
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 58 cost time: 0.882000207901001
Epoch: 58, Steps: 64 | Train Loss: 0.0957650 Vali Loss: 0.2489885 Test Loss: 0.3198235
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 59 cost time: 0.8754181861877441
Epoch: 59, Steps: 64 | Train Loss: 0.0960149 Vali Loss: 0.2481959 Test Loss: 0.3182853
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 60 cost time: 0.8846149444580078
Epoch: 60, Steps: 64 | Train Loss: 0.0958477 Vali Loss: 0.2466032 Test Loss: 0.3182623
Validation loss decreased (0.246677 --> 0.246603).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.3182622492313385, mae:0.3918815851211548, rse:0.2589198648929596
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06063699722290039 GB
Epoch: 1 cost time: 2.265913963317871
Epoch: 1, Steps: 64 | Train Loss: 0.8703033 Vali Loss: 2.6535196 Test Loss: 4.7048244
Validation loss decreased (inf --> 2.653520).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 2 cost time: 0.9237627983093262
Epoch: 2, Steps: 64 | Train Loss: 0.5664409 Vali Loss: 0.6990013 Test Loss: 1.0917711
Validation loss decreased (2.653520 --> 0.699001).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 3 cost time: 0.9053943157196045
Epoch: 3, Steps: 64 | Train Loss: 0.1645866 Vali Loss: 0.2723356 Test Loss: 0.2793731
Validation loss decreased (0.699001 --> 0.272336).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 4 cost time: 0.9179995059967041
Epoch: 4, Steps: 64 | Train Loss: 0.1129109 Vali Loss: 0.2602523 Test Loss: 0.2999147
Validation loss decreased (0.272336 --> 0.260252).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 5 cost time: 0.9196102619171143
Epoch: 5, Steps: 64 | Train Loss: 0.1061702 Vali Loss: 0.2498091 Test Loss: 0.2930315
Validation loss decreased (0.260252 --> 0.249809).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 6 cost time: 0.911614179611206
Epoch: 6, Steps: 64 | Train Loss: 0.1012211 Vali Loss: 0.2422729 Test Loss: 0.2896454
Validation loss decreased (0.249809 --> 0.242273).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 7 cost time: 0.9133405685424805
Epoch: 7, Steps: 64 | Train Loss: 0.0980817 Vali Loss: 0.2423738 Test Loss: 0.2912841
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 8 cost time: 0.9163506031036377
Epoch: 8, Steps: 64 | Train Loss: 0.0953006 Vali Loss: 0.2365188 Test Loss: 0.2932932
Validation loss decreased (0.242273 --> 0.236519).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 9 cost time: 0.9268536567687988
Epoch: 9, Steps: 64 | Train Loss: 0.0928376 Vali Loss: 0.2329096 Test Loss: 0.2937573
Validation loss decreased (0.236519 --> 0.232910).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 10 cost time: 0.9298758506774902
Epoch: 10, Steps: 64 | Train Loss: 0.0917407 Vali Loss: 0.2347499 Test Loss: 0.2937782
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 11 cost time: 0.9293735027313232
Epoch: 11, Steps: 64 | Train Loss: 0.0898198 Vali Loss: 0.2354568 Test Loss: 0.2990903
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 12 cost time: 0.9402883052825928
Epoch: 12, Steps: 64 | Train Loss: 0.0879058 Vali Loss: 0.2297660 Test Loss: 0.2962798
Validation loss decreased (0.232910 --> 0.229766).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 13 cost time: 0.9315454959869385
Epoch: 13, Steps: 64 | Train Loss: 0.0867396 Vali Loss: 0.2278920 Test Loss: 0.2976773
Validation loss decreased (0.229766 --> 0.227892).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 14 cost time: 0.9246251583099365
Epoch: 14, Steps: 64 | Train Loss: 0.0862616 Vali Loss: 0.2262793 Test Loss: 0.3017198
Validation loss decreased (0.227892 --> 0.226279).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 15 cost time: 0.9204056262969971
Epoch: 15, Steps: 64 | Train Loss: 0.0852992 Vali Loss: 0.2277912 Test Loss: 0.2994317
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 16 cost time: 0.9375019073486328
Epoch: 16, Steps: 64 | Train Loss: 0.0841185 Vali Loss: 0.2260288 Test Loss: 0.3093131
Validation loss decreased (0.226279 --> 0.226029).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 17 cost time: 0.9223663806915283
Epoch: 17, Steps: 64 | Train Loss: 0.0844770 Vali Loss: 0.2257884 Test Loss: 0.3051039
Validation loss decreased (0.226029 --> 0.225788).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 18 cost time: 0.9243931770324707
Epoch: 18, Steps: 64 | Train Loss: 0.0827756 Vali Loss: 0.2221105 Test Loss: 0.3068938
Validation loss decreased (0.225788 --> 0.222110).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 19 cost time: 0.9343733787536621
Epoch: 19, Steps: 64 | Train Loss: 0.0825371 Vali Loss: 0.2239795 Test Loss: 0.3093458
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 20 cost time: 0.9217624664306641
Epoch: 20, Steps: 64 | Train Loss: 0.0823952 Vali Loss: 0.2240535 Test Loss: 0.3079684
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 21 cost time: 0.9258332252502441
Epoch: 21, Steps: 64 | Train Loss: 0.0820695 Vali Loss: 0.2215647 Test Loss: 0.3108734
Validation loss decreased (0.222110 --> 0.221565).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 22 cost time: 0.9126625061035156
Epoch: 22, Steps: 64 | Train Loss: 0.0809794 Vali Loss: 0.2232655 Test Loss: 0.3083533
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 23 cost time: 0.9083504676818848
Epoch: 23, Steps: 64 | Train Loss: 0.0819559 Vali Loss: 0.2226498 Test Loss: 0.3097112
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 24 cost time: 0.9183948040008545
Epoch: 24, Steps: 64 | Train Loss: 0.0809363 Vali Loss: 0.2225413 Test Loss: 0.3106278
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 25 cost time: 0.9156169891357422
Epoch: 25, Steps: 64 | Train Loss: 0.0803573 Vali Loss: 0.2222684 Test Loss: 0.3107209
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 26 cost time: 0.9176170825958252
Epoch: 26, Steps: 64 | Train Loss: 0.0803723 Vali Loss: 0.2219238 Test Loss: 0.3111708
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 27 cost time: 0.9176228046417236
Epoch: 27, Steps: 64 | Train Loss: 0.0805700 Vali Loss: 0.2212352 Test Loss: 0.3114101
Validation loss decreased (0.221565 --> 0.221235).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 28 cost time: 0.9192790985107422
Epoch: 28, Steps: 64 | Train Loss: 0.0801205 Vali Loss: 0.2219513 Test Loss: 0.3136675
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 29 cost time: 0.9290003776550293
Epoch: 29, Steps: 64 | Train Loss: 0.0803383 Vali Loss: 0.2233582 Test Loss: 0.3122572
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 30 cost time: 0.914625883102417
Epoch: 30, Steps: 64 | Train Loss: 0.0800284 Vali Loss: 0.2215336 Test Loss: 0.3114206
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 31 cost time: 0.909447431564331
Epoch: 31, Steps: 64 | Train Loss: 0.0801680 Vali Loss: 0.2202455 Test Loss: 0.3141330
Validation loss decreased (0.221235 --> 0.220246).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 32 cost time: 0.9104795455932617
Epoch: 32, Steps: 64 | Train Loss: 0.0801507 Vali Loss: 0.2192885 Test Loss: 0.3115895
Validation loss decreased (0.220246 --> 0.219288).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 33 cost time: 0.9183504581451416
Epoch: 33, Steps: 64 | Train Loss: 0.0792607 Vali Loss: 0.2222960 Test Loss: 0.3122792
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 34 cost time: 0.9143574237823486
Epoch: 34, Steps: 64 | Train Loss: 0.0794006 Vali Loss: 0.2196042 Test Loss: 0.3132059
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 35 cost time: 0.916752815246582
Epoch: 35, Steps: 64 | Train Loss: 0.0789917 Vali Loss: 0.2226923 Test Loss: 0.3144172
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 36 cost time: 0.9330003261566162
Epoch: 36, Steps: 64 | Train Loss: 0.0792780 Vali Loss: 0.2185986 Test Loss: 0.3125282
Validation loss decreased (0.219288 --> 0.218599).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 37 cost time: 0.9179997444152832
Epoch: 37, Steps: 64 | Train Loss: 0.0791600 Vali Loss: 0.2202689 Test Loss: 0.3123863
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 38 cost time: 0.9176139831542969
Epoch: 38, Steps: 64 | Train Loss: 0.0787459 Vali Loss: 0.2201642 Test Loss: 0.3146029
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 39 cost time: 0.9154305458068848
Epoch: 39, Steps: 64 | Train Loss: 0.0786983 Vali Loss: 0.2209882 Test Loss: 0.3150451
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 40 cost time: 0.9273772239685059
Epoch: 40, Steps: 64 | Train Loss: 0.0786235 Vali Loss: 0.2215577 Test Loss: 0.3150590
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 41 cost time: 0.9163522720336914
Epoch: 41, Steps: 64 | Train Loss: 0.0785285 Vali Loss: 0.2182029 Test Loss: 0.3147527
Validation loss decreased (0.218599 --> 0.218203).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 42 cost time: 0.9173564910888672
Epoch: 42, Steps: 64 | Train Loss: 0.0785387 Vali Loss: 0.2213514 Test Loss: 0.3141266
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 43 cost time: 0.9274122714996338
Epoch: 43, Steps: 64 | Train Loss: 0.0790250 Vali Loss: 0.2236733 Test Loss: 0.3152328
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 44 cost time: 0.9210000038146973
Epoch: 44, Steps: 64 | Train Loss: 0.0785223 Vali Loss: 0.2210185 Test Loss: 0.3150915
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 45 cost time: 0.9176051616668701
Epoch: 45, Steps: 64 | Train Loss: 0.0788019 Vali Loss: 0.2204001 Test Loss: 0.3139302
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 46 cost time: 0.9196293354034424
Epoch: 46, Steps: 64 | Train Loss: 0.0783173 Vali Loss: 0.2188278 Test Loss: 0.3145775
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 47 cost time: 0.8953187465667725
Epoch: 47, Steps: 64 | Train Loss: 0.0787886 Vali Loss: 0.2206729 Test Loss: 0.3150605
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 48 cost time: 0.9093575477600098
Epoch: 48, Steps: 64 | Train Loss: 0.0790759 Vali Loss: 0.2199685 Test Loss: 0.3139916
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 49 cost time: 0.9114348888397217
Epoch: 49, Steps: 64 | Train Loss: 0.0784479 Vali Loss: 0.2182905 Test Loss: 0.3143600
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 50 cost time: 0.9117424488067627
Epoch: 50, Steps: 64 | Train Loss: 0.0787191 Vali Loss: 0.2199081 Test Loss: 0.3149965
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 51 cost time: 0.9140002727508545
Epoch: 51, Steps: 64 | Train Loss: 0.0788859 Vali Loss: 0.2175704 Test Loss: 0.3162480
Validation loss decreased (0.218203 --> 0.217570).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 52 cost time: 0.9226367473602295
Epoch: 52, Steps: 64 | Train Loss: 0.0786569 Vali Loss: 0.2167198 Test Loss: 0.3145400
Validation loss decreased (0.217570 --> 0.216720).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 53 cost time: 0.9256348609924316
Epoch: 53, Steps: 64 | Train Loss: 0.0788385 Vali Loss: 0.2179104 Test Loss: 0.3145558
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 54 cost time: 0.9293720722198486
Epoch: 54, Steps: 64 | Train Loss: 0.0789431 Vali Loss: 0.2195822 Test Loss: 0.3157643
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 55 cost time: 0.9224824905395508
Epoch: 55, Steps: 64 | Train Loss: 0.0785853 Vali Loss: 0.2203774 Test Loss: 0.3140719
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 56 cost time: 0.9230215549468994
Epoch: 56, Steps: 64 | Train Loss: 0.0786213 Vali Loss: 0.2174266 Test Loss: 0.3149479
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 57 cost time: 0.9353926181793213
Epoch: 57, Steps: 64 | Train Loss: 0.0787889 Vali Loss: 0.2204283 Test Loss: 0.3158467
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 58 cost time: 0.9197244644165039
Epoch: 58, Steps: 64 | Train Loss: 0.0783922 Vali Loss: 0.2239721 Test Loss: 0.3156380
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 59 cost time: 0.9159998893737793
Epoch: 59, Steps: 64 | Train Loss: 0.0786772 Vali Loss: 0.2199101 Test Loss: 0.3149603
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 60 cost time: 0.9333970546722412
Epoch: 60, Steps: 64 | Train Loss: 0.0790984 Vali Loss: 0.2199400 Test Loss: 0.3144985
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.3145400881767273, mae:0.3960115909576416, rse:0.25740134716033936
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06383180618286133 GB
Epoch: 1 cost time: 2.4345152378082275
Epoch: 1, Steps: 64 | Train Loss: 0.8039625 Vali Loss: 2.4974122 Test Loss: 4.3318620
Validation loss decreased (inf --> 2.497412).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 2 cost time: 0.9536168575286865
Epoch: 2, Steps: 64 | Train Loss: 0.4340919 Vali Loss: 0.3050160 Test Loss: 0.3061627
Validation loss decreased (2.497412 --> 0.305016).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 3 cost time: 0.9514844417572021
Epoch: 3, Steps: 64 | Train Loss: 0.1282795 Vali Loss: 0.2900788 Test Loss: 0.3393019
Validation loss decreased (0.305016 --> 0.290079).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 4 cost time: 0.9333968162536621
Epoch: 4, Steps: 64 | Train Loss: 0.1103224 Vali Loss: 0.2638473 Test Loss: 0.2982557
Validation loss decreased (0.290079 --> 0.263847).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 5 cost time: 0.9510862827301025
Epoch: 5, Steps: 64 | Train Loss: 0.1031869 Vali Loss: 0.2595656 Test Loss: 0.2965026
Validation loss decreased (0.263847 --> 0.259566).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 6 cost time: 0.9485132694244385
Epoch: 6, Steps: 64 | Train Loss: 0.1000636 Vali Loss: 0.2508712 Test Loss: 0.3022510
Validation loss decreased (0.259566 --> 0.250871).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 7 cost time: 0.9334564208984375
Epoch: 7, Steps: 64 | Train Loss: 0.0961262 Vali Loss: 0.2435943 Test Loss: 0.3056820
Validation loss decreased (0.250871 --> 0.243594).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 8 cost time: 0.9509997367858887
Epoch: 8, Steps: 64 | Train Loss: 0.0938107 Vali Loss: 0.2472457 Test Loss: 0.3034429
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 9 cost time: 0.9552876949310303
Epoch: 9, Steps: 64 | Train Loss: 0.0917475 Vali Loss: 0.2375124 Test Loss: 0.3087341
Validation loss decreased (0.243594 --> 0.237512).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 10 cost time: 0.9638433456420898
Epoch: 10, Steps: 64 | Train Loss: 0.0897539 Vali Loss: 0.2395391 Test Loss: 0.3087678
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 11 cost time: 0.9523131847381592
Epoch: 11, Steps: 64 | Train Loss: 0.0886657 Vali Loss: 0.2349676 Test Loss: 0.3119317
Validation loss decreased (0.237512 --> 0.234968).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 12 cost time: 0.94962477684021
Epoch: 12, Steps: 64 | Train Loss: 0.0865144 Vali Loss: 0.2357770 Test Loss: 0.3132847
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 13 cost time: 0.9522771835327148
Epoch: 13, Steps: 64 | Train Loss: 0.0855615 Vali Loss: 0.2359046 Test Loss: 0.3141660
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 14 cost time: 0.9454789161682129
Epoch: 14, Steps: 64 | Train Loss: 0.0850440 Vali Loss: 0.2356147 Test Loss: 0.3156165
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 15 cost time: 0.9536330699920654
Epoch: 15, Steps: 64 | Train Loss: 0.0842833 Vali Loss: 0.2343240 Test Loss: 0.3153817
Validation loss decreased (0.234968 --> 0.234324).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 16 cost time: 0.9540987014770508
Epoch: 16, Steps: 64 | Train Loss: 0.0838235 Vali Loss: 0.2352328 Test Loss: 0.3173651
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 17 cost time: 0.9572398662567139
Epoch: 17, Steps: 64 | Train Loss: 0.0831068 Vali Loss: 0.2335331 Test Loss: 0.3191991
Validation loss decreased (0.234324 --> 0.233533).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 18 cost time: 0.9523847103118896
Epoch: 18, Steps: 64 | Train Loss: 0.0828206 Vali Loss: 0.2380551 Test Loss: 0.3224603
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 19 cost time: 0.9508035182952881
Epoch: 19, Steps: 64 | Train Loss: 0.0816351 Vali Loss: 0.2323292 Test Loss: 0.3239627
Validation loss decreased (0.233533 --> 0.232329).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 20 cost time: 0.9687397480010986
Epoch: 20, Steps: 64 | Train Loss: 0.0819023 Vali Loss: 0.2342455 Test Loss: 0.3216660
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 21 cost time: 0.9513776302337646
Epoch: 21, Steps: 64 | Train Loss: 0.0810095 Vali Loss: 0.2337793 Test Loss: 0.3243292
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 22 cost time: 0.9476234912872314
Epoch: 22, Steps: 64 | Train Loss: 0.0813704 Vali Loss: 0.2344103 Test Loss: 0.3249472
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 23 cost time: 0.9516384601593018
Epoch: 23, Steps: 64 | Train Loss: 0.0805462 Vali Loss: 0.2321717 Test Loss: 0.3242653
Validation loss decreased (0.232329 --> 0.232172).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 24 cost time: 0.9273252487182617
Epoch: 24, Steps: 64 | Train Loss: 0.0807241 Vali Loss: 0.2356923 Test Loss: 0.3242891
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 25 cost time: 0.945082426071167
Epoch: 25, Steps: 64 | Train Loss: 0.0807015 Vali Loss: 0.2365353 Test Loss: 0.3258863
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 26 cost time: 0.9504482746124268
Epoch: 26, Steps: 64 | Train Loss: 0.0794117 Vali Loss: 0.2326901 Test Loss: 0.3274751
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 27 cost time: 0.9451665878295898
Epoch: 27, Steps: 64 | Train Loss: 0.0805836 Vali Loss: 0.2332241 Test Loss: 0.3258052
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 28 cost time: 0.9424197673797607
Epoch: 28, Steps: 64 | Train Loss: 0.0795337 Vali Loss: 0.2335114 Test Loss: 0.3270197
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 29 cost time: 0.9447884559631348
Epoch: 29, Steps: 64 | Train Loss: 0.0793663 Vali Loss: 0.2347772 Test Loss: 0.3277656
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 30 cost time: 0.942000150680542
Epoch: 30, Steps: 64 | Train Loss: 0.0797214 Vali Loss: 0.2333011 Test Loss: 0.3292210
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 31 cost time: 0.9400010108947754
Epoch: 31, Steps: 64 | Train Loss: 0.0797911 Vali Loss: 0.2344912 Test Loss: 0.3305143
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 32 cost time: 0.9411492347717285
Epoch: 32, Steps: 64 | Train Loss: 0.0792622 Vali Loss: 0.2350167 Test Loss: 0.3293373
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 33 cost time: 0.9402074813842773
Epoch: 33, Steps: 64 | Train Loss: 0.0793588 Vali Loss: 0.2354628 Test Loss: 0.3305858
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 34 cost time: 0.9493217468261719
Epoch: 34, Steps: 64 | Train Loss: 0.0791591 Vali Loss: 0.2363395 Test Loss: 0.3304752
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 35 cost time: 0.9457569122314453
Epoch: 35, Steps: 64 | Train Loss: 0.0787866 Vali Loss: 0.2356135 Test Loss: 0.3315502
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 36 cost time: 0.9553768634796143
Epoch: 36, Steps: 64 | Train Loss: 0.0791613 Vali Loss: 0.2339730 Test Loss: 0.3310345
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 37 cost time: 0.9636156558990479
Epoch: 37, Steps: 64 | Train Loss: 0.0787354 Vali Loss: 0.2322503 Test Loss: 0.3321748
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 38 cost time: 0.9387214183807373
Epoch: 38, Steps: 64 | Train Loss: 0.0788259 Vali Loss: 0.2341070 Test Loss: 0.3327006
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 39 cost time: 0.9484796524047852
Epoch: 39, Steps: 64 | Train Loss: 0.0794507 Vali Loss: 0.2345224 Test Loss: 0.3315305
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 40 cost time: 0.9470005035400391
Epoch: 40, Steps: 64 | Train Loss: 0.0783346 Vali Loss: 0.2342921 Test Loss: 0.3303076
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 41 cost time: 0.9446256160736084
Epoch: 41, Steps: 64 | Train Loss: 0.0782686 Vali Loss: 0.2318476 Test Loss: 0.3321536
Validation loss decreased (0.232172 --> 0.231848).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 42 cost time: 0.949333906173706
Epoch: 42, Steps: 64 | Train Loss: 0.0786544 Vali Loss: 0.2353832 Test Loss: 0.3311532
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 43 cost time: 0.94936203956604
Epoch: 43, Steps: 64 | Train Loss: 0.0781093 Vali Loss: 0.2360436 Test Loss: 0.3329254
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 44 cost time: 0.936366081237793
Epoch: 44, Steps: 64 | Train Loss: 0.0783397 Vali Loss: 0.2347062 Test Loss: 0.3313905
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 45 cost time: 0.9493327140808105
Epoch: 45, Steps: 64 | Train Loss: 0.0783406 Vali Loss: 0.2300722 Test Loss: 0.3316297
Validation loss decreased (0.231848 --> 0.230072).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 46 cost time: 0.9434309005737305
Epoch: 46, Steps: 64 | Train Loss: 0.0787530 Vali Loss: 0.2359763 Test Loss: 0.3323862
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 47 cost time: 0.9447739124298096
Epoch: 47, Steps: 64 | Train Loss: 0.0788332 Vali Loss: 0.2332147 Test Loss: 0.3306230
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 48 cost time: 0.9395852088928223
Epoch: 48, Steps: 64 | Train Loss: 0.0783783 Vali Loss: 0.2344757 Test Loss: 0.3319399
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 49 cost time: 0.9370007514953613
Epoch: 49, Steps: 64 | Train Loss: 0.0786949 Vali Loss: 0.2401913 Test Loss: 0.3317972
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 50 cost time: 0.9520003795623779
Epoch: 50, Steps: 64 | Train Loss: 0.0784156 Vali Loss: 0.2357054 Test Loss: 0.3322037
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 51 cost time: 1.0378220081329346
Epoch: 51, Steps: 64 | Train Loss: 0.0783220 Vali Loss: 0.2375682 Test Loss: 0.3327314
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 52 cost time: 1.0366168022155762
Epoch: 52, Steps: 64 | Train Loss: 0.0781409 Vali Loss: 0.2354014 Test Loss: 0.3318528
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 53 cost time: 1.0316178798675537
Epoch: 53, Steps: 64 | Train Loss: 0.0784892 Vali Loss: 0.2335498 Test Loss: 0.3317301
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 54 cost time: 0.9416172504425049
Epoch: 54, Steps: 64 | Train Loss: 0.0786379 Vali Loss: 0.2312675 Test Loss: 0.3319768
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 55 cost time: 0.945793628692627
Epoch: 55, Steps: 64 | Train Loss: 0.0783148 Vali Loss: 0.2351318 Test Loss: 0.3330946
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 56 cost time: 0.9373798370361328
Epoch: 56, Steps: 64 | Train Loss: 0.0785160 Vali Loss: 0.2349167 Test Loss: 0.3332243
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 57 cost time: 0.9376161098480225
Epoch: 57, Steps: 64 | Train Loss: 0.0785710 Vali Loss: 0.2328057 Test Loss: 0.3313680
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 58 cost time: 0.9424805641174316
Epoch: 58, Steps: 64 | Train Loss: 0.0781607 Vali Loss: 0.2352662 Test Loss: 0.3310773
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 59 cost time: 0.9497470855712891
Epoch: 59, Steps: 64 | Train Loss: 0.0782789 Vali Loss: 0.2347241 Test Loss: 0.3317625
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 60 cost time: 0.9567265510559082
Epoch: 60, Steps: 64 | Train Loss: 0.0786046 Vali Loss: 0.2337787 Test Loss: 0.3320994
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.3316296935081482, mae:0.41398248076438904, rse:0.26430144906044006
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.05765199661254883 GB
Epoch: 1 cost time: 2.290771484375
Epoch: 1, Steps: 64 | Train Loss: 0.9190268 Vali Loss: 2.7248089 Test Loss: 4.8666205
Validation loss decreased (inf --> 2.724809).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 2 cost time: 0.8994739055633545
Epoch: 2, Steps: 64 | Train Loss: 0.7039493 Vali Loss: 1.5408076 Test Loss: 2.6113911
Validation loss decreased (2.724809 --> 1.540808).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 3 cost time: 0.906402587890625
Epoch: 3, Steps: 64 | Train Loss: 0.4668952 Vali Loss: 1.1688490 Test Loss: 1.9370153
Validation loss decreased (1.540808 --> 1.168849).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 4 cost time: 0.8764662742614746
Epoch: 4, Steps: 64 | Train Loss: 0.3495052 Vali Loss: 0.9007211 Test Loss: 1.4599383
Validation loss decreased (1.168849 --> 0.900721).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 5 cost time: 0.8874351978302002
Epoch: 5, Steps: 64 | Train Loss: 0.2719224 Vali Loss: 0.7170440 Test Loss: 1.1426359
Validation loss decreased (0.900721 --> 0.717044).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 6 cost time: 0.8853495121002197
Epoch: 6, Steps: 64 | Train Loss: 0.2210244 Vali Loss: 0.5810762 Test Loss: 0.9148121
Validation loss decreased (0.717044 --> 0.581076).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 7 cost time: 0.8856892585754395
Epoch: 7, Steps: 64 | Train Loss: 0.1864834 Vali Loss: 0.4930253 Test Loss: 0.7590650
Validation loss decreased (0.581076 --> 0.493025).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 8 cost time: 0.8769998550415039
Epoch: 8, Steps: 64 | Train Loss: 0.1631764 Vali Loss: 0.4290763 Test Loss: 0.6453628
Validation loss decreased (0.493025 --> 0.429076).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 9 cost time: 0.8816177845001221
Epoch: 9, Steps: 64 | Train Loss: 0.1460495 Vali Loss: 0.3820801 Test Loss: 0.5632035
Validation loss decreased (0.429076 --> 0.382080).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 10 cost time: 0.893338680267334
Epoch: 10, Steps: 64 | Train Loss: 0.1334589 Vali Loss: 0.3530398 Test Loss: 0.5058230
Validation loss decreased (0.382080 --> 0.353040).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 11 cost time: 0.8983402252197266
Epoch: 11, Steps: 64 | Train Loss: 0.1244180 Vali Loss: 0.3293849 Test Loss: 0.4640167
Validation loss decreased (0.353040 --> 0.329385).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 12 cost time: 0.8854310512542725
Epoch: 12, Steps: 64 | Train Loss: 0.1190779 Vali Loss: 0.3055054 Test Loss: 0.4278877
Validation loss decreased (0.329385 --> 0.305505).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 13 cost time: 0.8934447765350342
Epoch: 13, Steps: 64 | Train Loss: 0.1138492 Vali Loss: 0.2952830 Test Loss: 0.4049544
Validation loss decreased (0.305505 --> 0.295283).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 14 cost time: 0.8909997940063477
Epoch: 14, Steps: 64 | Train Loss: 0.1095838 Vali Loss: 0.2887032 Test Loss: 0.3888400
Validation loss decreased (0.295283 --> 0.288703).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 15 cost time: 0.8860030174255371
Epoch: 15, Steps: 64 | Train Loss: 0.1068805 Vali Loss: 0.2757525 Test Loss: 0.3710257
Validation loss decreased (0.288703 --> 0.275752).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 16 cost time: 0.8826210498809814
Epoch: 16, Steps: 64 | Train Loss: 0.1044784 Vali Loss: 0.2730479 Test Loss: 0.3631456
Validation loss decreased (0.275752 --> 0.273048).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 17 cost time: 0.8834209442138672
Epoch: 17, Steps: 64 | Train Loss: 0.1024233 Vali Loss: 0.2672376 Test Loss: 0.3521606
Validation loss decreased (0.273048 --> 0.267238).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 18 cost time: 0.8838136196136475
Epoch: 18, Steps: 64 | Train Loss: 0.1010358 Vali Loss: 0.2596151 Test Loss: 0.3446590
Validation loss decreased (0.267238 --> 0.259615).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 19 cost time: 0.898737907409668
Epoch: 19, Steps: 64 | Train Loss: 0.0993233 Vali Loss: 0.2599263 Test Loss: 0.3398508
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 20 cost time: 0.8897523880004883
Epoch: 20, Steps: 64 | Train Loss: 0.0995510 Vali Loss: 0.2571718 Test Loss: 0.3365601
Validation loss decreased (0.259615 --> 0.257172).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 21 cost time: 0.9069995880126953
Epoch: 21, Steps: 64 | Train Loss: 0.0976030 Vali Loss: 0.2529033 Test Loss: 0.3305569
Validation loss decreased (0.257172 --> 0.252903).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 22 cost time: 0.8906185626983643
Epoch: 22, Steps: 64 | Train Loss: 0.0971754 Vali Loss: 0.2481775 Test Loss: 0.3271155
Validation loss decreased (0.252903 --> 0.248177).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 23 cost time: 0.8836119174957275
Epoch: 23, Steps: 64 | Train Loss: 0.0968075 Vali Loss: 0.2480694 Test Loss: 0.3265385
Validation loss decreased (0.248177 --> 0.248069).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 24 cost time: 0.8841016292572021
Epoch: 24, Steps: 64 | Train Loss: 0.0961911 Vali Loss: 0.2498102 Test Loss: 0.3214995
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 25 cost time: 0.8643524646759033
Epoch: 25, Steps: 64 | Train Loss: 0.0956098 Vali Loss: 0.2482005 Test Loss: 0.3171831
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 26 cost time: 0.880779504776001
Epoch: 26, Steps: 64 | Train Loss: 0.0949644 Vali Loss: 0.2452928 Test Loss: 0.3181608
Validation loss decreased (0.248069 --> 0.245293).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 27 cost time: 0.8819103240966797
Epoch: 27, Steps: 64 | Train Loss: 0.0942990 Vali Loss: 0.2441925 Test Loss: 0.3153538
Validation loss decreased (0.245293 --> 0.244192).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 28 cost time: 0.8959999084472656
Epoch: 28, Steps: 64 | Train Loss: 0.0947045 Vali Loss: 0.2429760 Test Loss: 0.3153878
Validation loss decreased (0.244192 --> 0.242976).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 29 cost time: 0.8896174430847168
Epoch: 29, Steps: 64 | Train Loss: 0.0945714 Vali Loss: 0.2428742 Test Loss: 0.3148047
Validation loss decreased (0.242976 --> 0.242874).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 30 cost time: 0.8863377571105957
Epoch: 30, Steps: 64 | Train Loss: 0.0941173 Vali Loss: 0.2431186 Test Loss: 0.3145289
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 31 cost time: 0.8933620452880859
Epoch: 31, Steps: 64 | Train Loss: 0.0934253 Vali Loss: 0.2432604 Test Loss: 0.3146977
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 32 cost time: 0.8678033351898193
Epoch: 32, Steps: 64 | Train Loss: 0.0929445 Vali Loss: 0.2382296 Test Loss: 0.3102845
Validation loss decreased (0.242874 --> 0.238230).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 33 cost time: 0.8778197765350342
Epoch: 33, Steps: 64 | Train Loss: 0.0935802 Vali Loss: 0.2419876 Test Loss: 0.3121858
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 34 cost time: 0.8840010166168213
Epoch: 34, Steps: 64 | Train Loss: 0.0936573 Vali Loss: 0.2428748 Test Loss: 0.3125603
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 35 cost time: 0.8856170177459717
Epoch: 35, Steps: 64 | Train Loss: 0.0930277 Vali Loss: 0.2431506 Test Loss: 0.3102898
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 36 cost time: 0.8867552280426025
Epoch: 36, Steps: 64 | Train Loss: 0.0926102 Vali Loss: 0.2434676 Test Loss: 0.3099435
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 37 cost time: 0.8914227485656738
Epoch: 37, Steps: 64 | Train Loss: 0.0928157 Vali Loss: 0.2385526 Test Loss: 0.3089781
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 38 cost time: 0.8973357677459717
Epoch: 38, Steps: 64 | Train Loss: 0.0921935 Vali Loss: 0.2410238 Test Loss: 0.3103060
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 39 cost time: 0.9018459320068359
Epoch: 39, Steps: 64 | Train Loss: 0.0925371 Vali Loss: 0.2406673 Test Loss: 0.3089666
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 40 cost time: 0.8893892765045166
Epoch: 40, Steps: 64 | Train Loss: 0.0923355 Vali Loss: 0.2400183 Test Loss: 0.3090527
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 41 cost time: 0.872624397277832
Epoch: 41, Steps: 64 | Train Loss: 0.0923025 Vali Loss: 0.2394944 Test Loss: 0.3072736
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 42 cost time: 0.8883211612701416
Epoch: 42, Steps: 64 | Train Loss: 0.0923909 Vali Loss: 0.2389648 Test Loss: 0.3057354
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 43 cost time: 0.8743879795074463
Epoch: 43, Steps: 64 | Train Loss: 0.0912608 Vali Loss: 0.2383832 Test Loss: 0.3069451
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 44 cost time: 0.875361442565918
Epoch: 44, Steps: 64 | Train Loss: 0.0917547 Vali Loss: 0.2381810 Test Loss: 0.3075596
Validation loss decreased (0.238230 --> 0.238181).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 45 cost time: 0.8877968788146973
Epoch: 45, Steps: 64 | Train Loss: 0.0921257 Vali Loss: 0.2400704 Test Loss: 0.3061117
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 46 cost time: 0.8852498531341553
Epoch: 46, Steps: 64 | Train Loss: 0.0916559 Vali Loss: 0.2412643 Test Loss: 0.3108522
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 47 cost time: 0.8836588859558105
Epoch: 47, Steps: 64 | Train Loss: 0.0916517 Vali Loss: 0.2378830 Test Loss: 0.3075681
Validation loss decreased (0.238181 --> 0.237883).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 48 cost time: 0.8859455585479736
Epoch: 48, Steps: 64 | Train Loss: 0.0915114 Vali Loss: 0.2403546 Test Loss: 0.3068000
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 49 cost time: 0.8839802742004395
Epoch: 49, Steps: 64 | Train Loss: 0.0912816 Vali Loss: 0.2399582 Test Loss: 0.3080093
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 50 cost time: 0.8686432838439941
Epoch: 50, Steps: 64 | Train Loss: 0.0908500 Vali Loss: 0.2388837 Test Loss: 0.3064884
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 51 cost time: 0.8767886161804199
Epoch: 51, Steps: 64 | Train Loss: 0.0913688 Vali Loss: 0.2403331 Test Loss: 0.3058768
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 52 cost time: 0.8816299438476562
Epoch: 52, Steps: 64 | Train Loss: 0.0911175 Vali Loss: 0.2395036 Test Loss: 0.3065138
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 53 cost time: 0.8691413402557373
Epoch: 53, Steps: 64 | Train Loss: 0.0920987 Vali Loss: 0.2398456 Test Loss: 0.3067367
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 54 cost time: 0.8817217350006104
Epoch: 54, Steps: 64 | Train Loss: 0.0916114 Vali Loss: 0.2357332 Test Loss: 0.3056686
Validation loss decreased (0.237883 --> 0.235733).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 55 cost time: 0.890352725982666
Epoch: 55, Steps: 64 | Train Loss: 0.0913628 Vali Loss: 0.2384278 Test Loss: 0.3046449
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 56 cost time: 0.8993575572967529
Epoch: 56, Steps: 64 | Train Loss: 0.0914478 Vali Loss: 0.2383236 Test Loss: 0.3062204
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 57 cost time: 0.8825101852416992
Epoch: 57, Steps: 64 | Train Loss: 0.0914738 Vali Loss: 0.2382760 Test Loss: 0.3071068
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 58 cost time: 0.8826375007629395
Epoch: 58, Steps: 64 | Train Loss: 0.0916737 Vali Loss: 0.2401033 Test Loss: 0.3063164
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 59 cost time: 0.8780002593994141
Epoch: 59, Steps: 64 | Train Loss: 0.0907491 Vali Loss: 0.2378105 Test Loss: 0.3040190
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 60 cost time: 0.8926129341125488
Epoch: 60, Steps: 64 | Train Loss: 0.0917106 Vali Loss: 0.2390538 Test Loss: 0.3063425
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.30566856265068054, mae:0.3792237937450409, rse:0.2537454068660736
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06079816818237305 GB
Epoch: 1 cost time: 2.3055131435394287
Epoch: 1, Steps: 64 | Train Loss: 0.8056458 Vali Loss: 2.4457347 Test Loss: 4.2924714
Validation loss decreased (inf --> 2.445735).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 2 cost time: 0.9269864559173584
Epoch: 2, Steps: 64 | Train Loss: 0.4501071 Vali Loss: 0.4271139 Test Loss: 0.5748444
Validation loss decreased (2.445735 --> 0.427114).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 3 cost time: 0.9210078716278076
Epoch: 3, Steps: 64 | Train Loss: 0.1317123 Vali Loss: 0.2667162 Test Loss: 0.2819795
Validation loss decreased (0.427114 --> 0.266716).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 4 cost time: 0.9253315925598145
Epoch: 4, Steps: 64 | Train Loss: 0.1120571 Vali Loss: 0.2628425 Test Loss: 0.3091168
Validation loss decreased (0.266716 --> 0.262843).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 5 cost time: 0.9237592220306396
Epoch: 5, Steps: 64 | Train Loss: 0.1057479 Vali Loss: 0.2520733 Test Loss: 0.2887368
Validation loss decreased (0.262843 --> 0.252073).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 6 cost time: 0.9179997444152832
Epoch: 6, Steps: 64 | Train Loss: 0.1018269 Vali Loss: 0.2456561 Test Loss: 0.2898126
Validation loss decreased (0.252073 --> 0.245656).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 7 cost time: 0.9196281433105469
Epoch: 7, Steps: 64 | Train Loss: 0.0993065 Vali Loss: 0.2395047 Test Loss: 0.2878739
Validation loss decreased (0.245656 --> 0.239505).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 8 cost time: 0.9126269817352295
Epoch: 8, Steps: 64 | Train Loss: 0.0968227 Vali Loss: 0.2357270 Test Loss: 0.2861634
Validation loss decreased (0.239505 --> 0.235727).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 9 cost time: 0.9194269180297852
Epoch: 9, Steps: 64 | Train Loss: 0.0953420 Vali Loss: 0.2360471 Test Loss: 0.2855848
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 10 cost time: 0.9244308471679688
Epoch: 10, Steps: 64 | Train Loss: 0.0937219 Vali Loss: 0.2281727 Test Loss: 0.2832609
Validation loss decreased (0.235727 --> 0.228173).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 11 cost time: 0.9943695068359375
Epoch: 11, Steps: 64 | Train Loss: 0.0917419 Vali Loss: 0.2249478 Test Loss: 0.2863408
Validation loss decreased (0.228173 --> 0.224948).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 12 cost time: 0.9485507011413574
Epoch: 12, Steps: 64 | Train Loss: 0.0901426 Vali Loss: 0.2257649 Test Loss: 0.2855691
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 13 cost time: 0.9203429222106934
Epoch: 13, Steps: 64 | Train Loss: 0.0883758 Vali Loss: 0.2244743 Test Loss: 0.2891320
Validation loss decreased (0.224948 --> 0.224474).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 14 cost time: 0.926109790802002
Epoch: 14, Steps: 64 | Train Loss: 0.0880509 Vali Loss: 0.2224907 Test Loss: 0.2882529
Validation loss decreased (0.224474 --> 0.222491).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 15 cost time: 0.922499418258667
Epoch: 15, Steps: 64 | Train Loss: 0.0869836 Vali Loss: 0.2232079 Test Loss: 0.2930032
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 16 cost time: 0.9120001792907715
Epoch: 16, Steps: 64 | Train Loss: 0.0862442 Vali Loss: 0.2243437 Test Loss: 0.2919864
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 17 cost time: 0.9246172904968262
Epoch: 17, Steps: 64 | Train Loss: 0.0856572 Vali Loss: 0.2183665 Test Loss: 0.2925498
Validation loss decreased (0.222491 --> 0.218367).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 18 cost time: 0.9223575592041016
Epoch: 18, Steps: 64 | Train Loss: 0.0844701 Vali Loss: 0.2191594 Test Loss: 0.2944411
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 19 cost time: 0.9236595630645752
Epoch: 19, Steps: 64 | Train Loss: 0.0844473 Vali Loss: 0.2214958 Test Loss: 0.2948122
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 20 cost time: 0.9274523258209229
Epoch: 20, Steps: 64 | Train Loss: 0.0839872 Vali Loss: 0.2164620 Test Loss: 0.2987637
Validation loss decreased (0.218367 --> 0.216462).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 21 cost time: 0.9235472679138184
Epoch: 21, Steps: 64 | Train Loss: 0.0831383 Vali Loss: 0.2201779 Test Loss: 0.2955625
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 22 cost time: 0.9127440452575684
Epoch: 22, Steps: 64 | Train Loss: 0.0832536 Vali Loss: 0.2189319 Test Loss: 0.2962660
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 23 cost time: 0.9127280712127686
Epoch: 23, Steps: 64 | Train Loss: 0.0827113 Vali Loss: 0.2200023 Test Loss: 0.2976325
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 24 cost time: 0.9200935363769531
Epoch: 24, Steps: 64 | Train Loss: 0.0828634 Vali Loss: 0.2209004 Test Loss: 0.2963411
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 25 cost time: 0.9120042324066162
Epoch: 25, Steps: 64 | Train Loss: 0.0821758 Vali Loss: 0.2168116 Test Loss: 0.2971556
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 26 cost time: 0.9104344844818115
Epoch: 26, Steps: 64 | Train Loss: 0.0823396 Vali Loss: 0.2165046 Test Loss: 0.2977983
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 27 cost time: 0.92437744140625
Epoch: 27, Steps: 64 | Train Loss: 0.0821703 Vali Loss: 0.2140852 Test Loss: 0.2987067
Validation loss decreased (0.216462 --> 0.214085).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 28 cost time: 0.9220144748687744
Epoch: 28, Steps: 64 | Train Loss: 0.0816384 Vali Loss: 0.2184792 Test Loss: 0.2995464
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 29 cost time: 0.9204421043395996
Epoch: 29, Steps: 64 | Train Loss: 0.0817332 Vali Loss: 0.2191722 Test Loss: 0.2981591
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 30 cost time: 0.9164814949035645
Epoch: 30, Steps: 64 | Train Loss: 0.0816743 Vali Loss: 0.2167440 Test Loss: 0.2981466
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 31 cost time: 0.9099998474121094
Epoch: 31, Steps: 64 | Train Loss: 0.0816392 Vali Loss: 0.2123140 Test Loss: 0.2988185
Validation loss decreased (0.214085 --> 0.212314).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 32 cost time: 0.9070529937744141
Epoch: 32, Steps: 64 | Train Loss: 0.0813253 Vali Loss: 0.2168925 Test Loss: 0.2981112
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 33 cost time: 0.9063503742218018
Epoch: 33, Steps: 64 | Train Loss: 0.0814607 Vali Loss: 0.2122381 Test Loss: 0.2981035
Validation loss decreased (0.212314 --> 0.212238).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 34 cost time: 0.9223668575286865
Epoch: 34, Steps: 64 | Train Loss: 0.0806608 Vali Loss: 0.2156462 Test Loss: 0.2994090
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 35 cost time: 0.926447868347168
Epoch: 35, Steps: 64 | Train Loss: 0.0809808 Vali Loss: 0.2157244 Test Loss: 0.3000567
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 36 cost time: 0.9193973541259766
Epoch: 36, Steps: 64 | Train Loss: 0.0808979 Vali Loss: 0.2170864 Test Loss: 0.2988264
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 37 cost time: 0.928626537322998
Epoch: 37, Steps: 64 | Train Loss: 0.0813127 Vali Loss: 0.2134080 Test Loss: 0.2997170
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 38 cost time: 0.9468755722045898
Epoch: 38, Steps: 64 | Train Loss: 0.0809218 Vali Loss: 0.2198693 Test Loss: 0.2998011
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 39 cost time: 0.9219973087310791
Epoch: 39, Steps: 64 | Train Loss: 0.0808998 Vali Loss: 0.2147058 Test Loss: 0.2989691
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 40 cost time: 0.9316296577453613
Epoch: 40, Steps: 64 | Train Loss: 0.0808938 Vali Loss: 0.2166096 Test Loss: 0.2998002
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 41 cost time: 0.9416279792785645
Epoch: 41, Steps: 64 | Train Loss: 0.0805925 Vali Loss: 0.2175458 Test Loss: 0.3004577
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 42 cost time: 0.9258530139923096
Epoch: 42, Steps: 64 | Train Loss: 0.0804039 Vali Loss: 0.2151560 Test Loss: 0.3000297
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 43 cost time: 0.932898998260498
Epoch: 43, Steps: 64 | Train Loss: 0.0806718 Vali Loss: 0.2138931 Test Loss: 0.3011259
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 44 cost time: 0.9345180988311768
Epoch: 44, Steps: 64 | Train Loss: 0.0807384 Vali Loss: 0.2128384 Test Loss: 0.3005982
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 45 cost time: 0.9310929775238037
Epoch: 45, Steps: 64 | Train Loss: 0.0807488 Vali Loss: 0.2184418 Test Loss: 0.3003157
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 46 cost time: 0.9288153648376465
Epoch: 46, Steps: 64 | Train Loss: 0.0804547 Vali Loss: 0.2165783 Test Loss: 0.2995937
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 47 cost time: 0.9160006046295166
Epoch: 47, Steps: 64 | Train Loss: 0.0806558 Vali Loss: 0.2200131 Test Loss: 0.3000450
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 48 cost time: 0.9120044708251953
Epoch: 48, Steps: 64 | Train Loss: 0.0810566 Vali Loss: 0.2140823 Test Loss: 0.3004971
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 49 cost time: 0.9150242805480957
Epoch: 49, Steps: 64 | Train Loss: 0.0805239 Vali Loss: 0.2158877 Test Loss: 0.3011424
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 50 cost time: 0.913360595703125
Epoch: 50, Steps: 64 | Train Loss: 0.0804765 Vali Loss: 0.2153503 Test Loss: 0.3004971
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 51 cost time: 0.9210143089294434
Epoch: 51, Steps: 64 | Train Loss: 0.0804824 Vali Loss: 0.2151294 Test Loss: 0.3005966
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 52 cost time: 0.998441219329834
Epoch: 52, Steps: 64 | Train Loss: 0.0808099 Vali Loss: 0.2163225 Test Loss: 0.3000933
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 53 cost time: 0.9227330684661865
Epoch: 53, Steps: 64 | Train Loss: 0.0804744 Vali Loss: 0.2192903 Test Loss: 0.2998126
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 54 cost time: 0.9193480014801025
Epoch: 54, Steps: 64 | Train Loss: 0.0806128 Vali Loss: 0.2176114 Test Loss: 0.3005146
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 55 cost time: 0.9393396377563477
Epoch: 55, Steps: 64 | Train Loss: 0.0800006 Vali Loss: 0.2168289 Test Loss: 0.3007829
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 56 cost time: 0.932999849319458
Epoch: 56, Steps: 64 | Train Loss: 0.0805250 Vali Loss: 0.2163333 Test Loss: 0.3001039
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 57 cost time: 0.9316132068634033
Epoch: 57, Steps: 64 | Train Loss: 0.0808168 Vali Loss: 0.2171884 Test Loss: 0.3000236
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 58 cost time: 0.9425995349884033
Epoch: 58, Steps: 64 | Train Loss: 0.0802469 Vali Loss: 0.2173286 Test Loss: 0.3000452
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 59 cost time: 0.9314086437225342
Epoch: 59, Steps: 64 | Train Loss: 0.0808329 Vali Loss: 0.2197746 Test Loss: 0.3007187
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 60 cost time: 0.9353771209716797
Epoch: 60, Steps: 64 | Train Loss: 0.0804597 Vali Loss: 0.2187915 Test Loss: 0.3010035
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2981034815311432, mae:0.3777451813220978, rse:0.2505857050418854
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06399297714233398 GB
Epoch: 1 cost time: 2.246798038482666
Epoch: 1, Steps: 64 | Train Loss: 0.8197810 Vali Loss: 2.5482898 Test Loss: 4.4678597
Validation loss decreased (inf --> 2.548290).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 2 cost time: 0.8568680286407471
Epoch: 2, Steps: 64 | Train Loss: 0.4199366 Vali Loss: 0.3295417 Test Loss: 0.3659772
Validation loss decreased (2.548290 --> 0.329542).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 3 cost time: 0.8878152370452881
Epoch: 3, Steps: 64 | Train Loss: 0.1218474 Vali Loss: 0.2773486 Test Loss: 0.3345155
Validation loss decreased (0.329542 --> 0.277349).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 4 cost time: 0.8855645656585693
Epoch: 4, Steps: 64 | Train Loss: 0.1058962 Vali Loss: 0.2502441 Test Loss: 0.2914318
Validation loss decreased (0.277349 --> 0.250244).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 5 cost time: 0.8794956207275391
Epoch: 5, Steps: 64 | Train Loss: 0.1008135 Vali Loss: 0.2466058 Test Loss: 0.2874396
Validation loss decreased (0.250244 --> 0.246606).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 6 cost time: 0.8763508796691895
Epoch: 6, Steps: 64 | Train Loss: 0.0974006 Vali Loss: 0.2406462 Test Loss: 0.2877290
Validation loss decreased (0.246606 --> 0.240646).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 7 cost time: 0.8821122646331787
Epoch: 7, Steps: 64 | Train Loss: 0.0951674 Vali Loss: 0.2346831 Test Loss: 0.2886616
Validation loss decreased (0.240646 --> 0.234683).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 8 cost time: 0.8803591728210449
Epoch: 8, Steps: 64 | Train Loss: 0.0915577 Vali Loss: 0.2389017 Test Loss: 0.2920089
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 9 cost time: 0.865736722946167
Epoch: 9, Steps: 64 | Train Loss: 0.0900929 Vali Loss: 0.2358277 Test Loss: 0.2939830
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 10 cost time: 0.8960003852844238
Epoch: 10, Steps: 64 | Train Loss: 0.0882357 Vali Loss: 0.2301185 Test Loss: 0.2982656
Validation loss decreased (0.234683 --> 0.230118).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 11 cost time: 0.8814351558685303
Epoch: 11, Steps: 64 | Train Loss: 0.0869524 Vali Loss: 0.2254231 Test Loss: 0.2980054
Validation loss decreased (0.230118 --> 0.225423).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 12 cost time: 0.8886215686798096
Epoch: 12, Steps: 64 | Train Loss: 0.0849217 Vali Loss: 0.2269853 Test Loss: 0.3017583
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 13 cost time: 0.8873834609985352
Epoch: 13, Steps: 64 | Train Loss: 0.0842590 Vali Loss: 0.2274163 Test Loss: 0.3043844
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 14 cost time: 0.8880832195281982
Epoch: 14, Steps: 64 | Train Loss: 0.0836987 Vali Loss: 0.2273759 Test Loss: 0.3091297
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 15 cost time: 0.8945951461791992
Epoch: 15, Steps: 64 | Train Loss: 0.0827446 Vali Loss: 0.2277206 Test Loss: 0.3084537
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 16 cost time: 0.8876368999481201
Epoch: 16, Steps: 64 | Train Loss: 0.0819754 Vali Loss: 0.2276424 Test Loss: 0.3148489
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 17 cost time: 0.8840000629425049
Epoch: 17, Steps: 64 | Train Loss: 0.0818908 Vali Loss: 0.2272528 Test Loss: 0.3118994
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 18 cost time: 0.8836257457733154
Epoch: 18, Steps: 64 | Train Loss: 0.0818703 Vali Loss: 0.2284788 Test Loss: 0.3131155
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 19 cost time: 0.9044466018676758
Epoch: 19, Steps: 64 | Train Loss: 0.0802704 Vali Loss: 0.2260039 Test Loss: 0.3127838
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 20 cost time: 0.8855578899383545
Epoch: 20, Steps: 64 | Train Loss: 0.0808391 Vali Loss: 0.2276400 Test Loss: 0.3152684
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 21 cost time: 0.8924627304077148
Epoch: 21, Steps: 64 | Train Loss: 0.0804606 Vali Loss: 0.2266111 Test Loss: 0.3143122
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 22 cost time: 0.8873782157897949
Epoch: 22, Steps: 64 | Train Loss: 0.0802558 Vali Loss: 0.2286500 Test Loss: 0.3170844
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 23 cost time: 0.8937749862670898
Epoch: 23, Steps: 64 | Train Loss: 0.0798356 Vali Loss: 0.2301027 Test Loss: 0.3178291
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 24 cost time: 0.8989999294281006
Epoch: 24, Steps: 64 | Train Loss: 0.0795229 Vali Loss: 0.2265498 Test Loss: 0.3191202
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 25 cost time: 0.8965904712677002
Epoch: 25, Steps: 64 | Train Loss: 0.0792696 Vali Loss: 0.2244613 Test Loss: 0.3194044
Validation loss decreased (0.225423 --> 0.224461).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 26 cost time: 0.8835268020629883
Epoch: 26, Steps: 64 | Train Loss: 0.0791996 Vali Loss: 0.2278960 Test Loss: 0.3205881
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 27 cost time: 0.8884310722351074
Epoch: 27, Steps: 64 | Train Loss: 0.0787430 Vali Loss: 0.2272055 Test Loss: 0.3191159
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 28 cost time: 0.882434606552124
Epoch: 28, Steps: 64 | Train Loss: 0.0792510 Vali Loss: 0.2259562 Test Loss: 0.3217476
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 29 cost time: 0.8873951435089111
Epoch: 29, Steps: 64 | Train Loss: 0.0793091 Vali Loss: 0.2302876 Test Loss: 0.3224545
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 30 cost time: 0.8552591800689697
Epoch: 30, Steps: 64 | Train Loss: 0.0789911 Vali Loss: 0.2252528 Test Loss: 0.3224885
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 31 cost time: 0.8769996166229248
Epoch: 31, Steps: 64 | Train Loss: 0.0786901 Vali Loss: 0.2290242 Test Loss: 0.3216089
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 32 cost time: 0.8786139488220215
Epoch: 32, Steps: 64 | Train Loss: 0.0793028 Vali Loss: 0.2291904 Test Loss: 0.3233036
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 33 cost time: 0.8703577518463135
Epoch: 33, Steps: 64 | Train Loss: 0.0786714 Vali Loss: 0.2282036 Test Loss: 0.3233083
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 34 cost time: 0.8794076442718506
Epoch: 34, Steps: 64 | Train Loss: 0.0788838 Vali Loss: 0.2301473 Test Loss: 0.3248964
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 35 cost time: 0.8863358497619629
Epoch: 35, Steps: 64 | Train Loss: 0.0778364 Vali Loss: 0.2284164 Test Loss: 0.3233336
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 36 cost time: 0.8867418766021729
Epoch: 36, Steps: 64 | Train Loss: 0.0783938 Vali Loss: 0.2293684 Test Loss: 0.3241681
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 37 cost time: 0.8819999694824219
Epoch: 37, Steps: 64 | Train Loss: 0.0784824 Vali Loss: 0.2293386 Test Loss: 0.3236391
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 38 cost time: 0.8886260986328125
Epoch: 38, Steps: 64 | Train Loss: 0.0782249 Vali Loss: 0.2273932 Test Loss: 0.3257197
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 39 cost time: 0.8844223022460938
Epoch: 39, Steps: 64 | Train Loss: 0.0784856 Vali Loss: 0.2275013 Test Loss: 0.3244234
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 40 cost time: 0.8853514194488525
Epoch: 40, Steps: 64 | Train Loss: 0.0782246 Vali Loss: 0.2268329 Test Loss: 0.3264005
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 41 cost time: 0.8919212818145752
Epoch: 41, Steps: 64 | Train Loss: 0.0781206 Vali Loss: 0.2312747 Test Loss: 0.3259271
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 42 cost time: 0.8807799816131592
Epoch: 42, Steps: 64 | Train Loss: 0.0777805 Vali Loss: 0.2279903 Test Loss: 0.3265438
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 43 cost time: 0.8824496269226074
Epoch: 43, Steps: 64 | Train Loss: 0.0779532 Vali Loss: 0.2278244 Test Loss: 0.3252456
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 44 cost time: 0.8916151523590088
Epoch: 44, Steps: 64 | Train Loss: 0.0781135 Vali Loss: 0.2287887 Test Loss: 0.3255524
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 45 cost time: 0.8924338817596436
Epoch: 45, Steps: 64 | Train Loss: 0.0779989 Vali Loss: 0.2278721 Test Loss: 0.3253388
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 46 cost time: 0.888352632522583
Epoch: 46, Steps: 64 | Train Loss: 0.0781855 Vali Loss: 0.2254185 Test Loss: 0.3265603
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 47 cost time: 0.8974277973175049
Epoch: 47, Steps: 64 | Train Loss: 0.0776356 Vali Loss: 0.2272206 Test Loss: 0.3255962
EarlyStopping counter: 22 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 48 cost time: 0.8783884048461914
Epoch: 48, Steps: 64 | Train Loss: 0.0780358 Vali Loss: 0.2267483 Test Loss: 0.3258475
EarlyStopping counter: 23 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 49 cost time: 0.8778228759765625
Epoch: 49, Steps: 64 | Train Loss: 0.0784956 Vali Loss: 0.2273896 Test Loss: 0.3264451
EarlyStopping counter: 24 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 50 cost time: 0.8819999694824219
Epoch: 50, Steps: 64 | Train Loss: 0.0773543 Vali Loss: 0.2289998 Test Loss: 0.3268138
EarlyStopping counter: 25 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 51 cost time: 0.8776156902313232
Epoch: 51, Steps: 64 | Train Loss: 0.0773975 Vali Loss: 0.2291015 Test Loss: 0.3283011
EarlyStopping counter: 26 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 52 cost time: 0.882429838180542
Epoch: 52, Steps: 64 | Train Loss: 0.0778251 Vali Loss: 0.2309879 Test Loss: 0.3256663
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 53 cost time: 0.8863661289215088
Epoch: 53, Steps: 64 | Train Loss: 0.0781095 Vali Loss: 0.2251949 Test Loss: 0.3256993
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 54 cost time: 0.875408411026001
Epoch: 54, Steps: 64 | Train Loss: 0.0775882 Vali Loss: 0.2284912 Test Loss: 0.3267510
EarlyStopping counter: 29 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 55 cost time: 0.8797948360443115
Epoch: 55, Steps: 64 | Train Loss: 0.0780743 Vali Loss: 0.2315640 Test Loss: 0.3259309
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 56 cost time: 0.8844850063323975
Epoch: 56, Steps: 64 | Train Loss: 0.0782128 Vali Loss: 0.2290123 Test Loss: 0.3263211
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 57 cost time: 0.88260817527771
Epoch: 57, Steps: 64 | Train Loss: 0.0787609 Vali Loss: 0.2298128 Test Loss: 0.3267411
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 58 cost time: 0.8553895950317383
Epoch: 58, Steps: 64 | Train Loss: 0.0780029 Vali Loss: 0.2243994 Test Loss: 0.3274210
Validation loss decreased (0.224461 --> 0.224399).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 59 cost time: 0.8893911838531494
Epoch: 59, Steps: 64 | Train Loss: 0.0775287 Vali Loss: 0.2291888 Test Loss: 0.3257443
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 60 cost time: 0.8893477916717529
Epoch: 60, Steps: 64 | Train Loss: 0.0778704 Vali Loss: 0.2274635 Test Loss: 0.3268844
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.3274211287498474, mae:0.4102645516395569, rse:0.2626189887523651
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.053999900817871094 GB
Epoch: 1 cost time: 2.2305970191955566
Epoch: 1, Steps: 64 | Train Loss: 1.0391611 Vali Loss: 3.0478222 Test Loss: 5.4529595
Validation loss decreased (inf --> 3.047822).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 2 cost time: 0.8629999160766602
Epoch: 2, Steps: 64 | Train Loss: 0.7886322 Vali Loss: 1.6973544 Test Loss: 2.8960216
Validation loss decreased (3.047822 --> 1.697354).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 3 cost time: 0.8616137504577637
Epoch: 3, Steps: 64 | Train Loss: 0.4631991 Vali Loss: 0.9901155 Test Loss: 1.5423268
Validation loss decreased (1.697354 --> 0.990115).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 4 cost time: 0.8624167442321777
Epoch: 4, Steps: 64 | Train Loss: 0.2811050 Vali Loss: 0.6343797 Test Loss: 0.9058349
Validation loss decreased (0.990115 --> 0.634380).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 5 cost time: 0.8743221759796143
Epoch: 5, Steps: 64 | Train Loss: 0.1940191 Vali Loss: 0.4754678 Test Loss: 0.6360053
Validation loss decreased (0.634380 --> 0.475468).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 6 cost time: 0.8617725372314453
Epoch: 6, Steps: 64 | Train Loss: 0.1532615 Vali Loss: 0.3806555 Test Loss: 0.4961460
Validation loss decreased (0.475468 --> 0.380656).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 7 cost time: 0.8617362976074219
Epoch: 7, Steps: 64 | Train Loss: 0.1336309 Vali Loss: 0.3295767 Test Loss: 0.4159827
Validation loss decreased (0.380656 --> 0.329577).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 8 cost time: 0.8589999675750732
Epoch: 8, Steps: 64 | Train Loss: 0.1224167 Vali Loss: 0.2977519 Test Loss: 0.3718806
Validation loss decreased (0.329577 --> 0.297752).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 9 cost time: 0.8626210689544678
Epoch: 9, Steps: 64 | Train Loss: 0.1156256 Vali Loss: 0.2795992 Test Loss: 0.3455640
Validation loss decreased (0.297752 --> 0.279599).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 10 cost time: 0.8641793727874756
Epoch: 10, Steps: 64 | Train Loss: 0.1104250 Vali Loss: 0.2677831 Test Loss: 0.3299401
Validation loss decreased (0.279599 --> 0.267783).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 11 cost time: 0.8654477596282959
Epoch: 11, Steps: 64 | Train Loss: 0.1080926 Vali Loss: 0.2588443 Test Loss: 0.3215274
Validation loss decreased (0.267783 --> 0.258844).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 12 cost time: 0.8637256622314453
Epoch: 12, Steps: 64 | Train Loss: 0.1048342 Vali Loss: 0.2540464 Test Loss: 0.3139178
Validation loss decreased (0.258844 --> 0.254046).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 13 cost time: 0.8640000820159912
Epoch: 13, Steps: 64 | Train Loss: 0.1033916 Vali Loss: 0.2466961 Test Loss: 0.3078137
Validation loss decreased (0.254046 --> 0.246696).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 14 cost time: 0.8649992942810059
Epoch: 14, Steps: 64 | Train Loss: 0.1011934 Vali Loss: 0.2398921 Test Loss: 0.3059531
Validation loss decreased (0.246696 --> 0.239892).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 15 cost time: 0.8624634742736816
Epoch: 15, Steps: 64 | Train Loss: 0.1004363 Vali Loss: 0.2411453 Test Loss: 0.3026272
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 16 cost time: 0.8753671646118164
Epoch: 16, Steps: 64 | Train Loss: 0.0995265 Vali Loss: 0.2375987 Test Loss: 0.3004172
Validation loss decreased (0.239892 --> 0.237599).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 17 cost time: 0.866412878036499
Epoch: 17, Steps: 64 | Train Loss: 0.0977518 Vali Loss: 0.2349088 Test Loss: 0.2989365
Validation loss decreased (0.237599 --> 0.234909).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 18 cost time: 0.8638167381286621
Epoch: 18, Steps: 64 | Train Loss: 0.0978417 Vali Loss: 0.2347784 Test Loss: 0.3004480
Validation loss decreased (0.234909 --> 0.234778).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 19 cost time: 0.8627917766571045
Epoch: 19, Steps: 64 | Train Loss: 0.0966202 Vali Loss: 0.2314686 Test Loss: 0.2981302
Validation loss decreased (0.234778 --> 0.231469).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 20 cost time: 0.8816022872924805
Epoch: 20, Steps: 64 | Train Loss: 0.0955805 Vali Loss: 0.2289123 Test Loss: 0.2960880
Validation loss decreased (0.231469 --> 0.228912).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 21 cost time: 0.8644697666168213
Epoch: 21, Steps: 64 | Train Loss: 0.0954686 Vali Loss: 0.2275368 Test Loss: 0.2966190
Validation loss decreased (0.228912 --> 0.227537).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 22 cost time: 0.8643825054168701
Epoch: 22, Steps: 64 | Train Loss: 0.0945859 Vali Loss: 0.2237162 Test Loss: 0.2960419
Validation loss decreased (0.227537 --> 0.223716).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 23 cost time: 0.863347053527832
Epoch: 23, Steps: 64 | Train Loss: 0.0943169 Vali Loss: 0.2280198 Test Loss: 0.2948074
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 24 cost time: 0.8623976707458496
Epoch: 24, Steps: 64 | Train Loss: 0.0940951 Vali Loss: 0.2249559 Test Loss: 0.2959674
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 25 cost time: 0.8619978427886963
Epoch: 25, Steps: 64 | Train Loss: 0.0939716 Vali Loss: 0.2231621 Test Loss: 0.2930489
Validation loss decreased (0.223716 --> 0.223162).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 26 cost time: 0.8604080677032471
Epoch: 26, Steps: 64 | Train Loss: 0.0929485 Vali Loss: 0.2239608 Test Loss: 0.2942447
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 27 cost time: 0.8673703670501709
Epoch: 27, Steps: 64 | Train Loss: 0.0921708 Vali Loss: 0.2198392 Test Loss: 0.2932295
Validation loss decreased (0.223162 --> 0.219839).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 28 cost time: 0.8577225208282471
Epoch: 28, Steps: 64 | Train Loss: 0.0927160 Vali Loss: 0.2197262 Test Loss: 0.2932873
Validation loss decreased (0.219839 --> 0.219726).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 29 cost time: 0.8647916316986084
Epoch: 29, Steps: 64 | Train Loss: 0.0925506 Vali Loss: 0.2191431 Test Loss: 0.2935753
Validation loss decreased (0.219726 --> 0.219143).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 30 cost time: 0.8619985580444336
Epoch: 30, Steps: 64 | Train Loss: 0.0922225 Vali Loss: 0.2177315 Test Loss: 0.2938106
Validation loss decreased (0.219143 --> 0.217732).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 31 cost time: 0.8676095008850098
Epoch: 31, Steps: 64 | Train Loss: 0.0916324 Vali Loss: 0.2206257 Test Loss: 0.2928045
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 32 cost time: 0.8653197288513184
Epoch: 32, Steps: 64 | Train Loss: 0.0910191 Vali Loss: 0.2197209 Test Loss: 0.2936251
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 33 cost time: 0.8629837036132812
Epoch: 33, Steps: 64 | Train Loss: 0.0917210 Vali Loss: 0.2163064 Test Loss: 0.2925318
Validation loss decreased (0.217732 --> 0.216306).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 34 cost time: 0.8627548217773438
Epoch: 34, Steps: 64 | Train Loss: 0.0909786 Vali Loss: 0.2191179 Test Loss: 0.2925512
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 35 cost time: 0.8630032539367676
Epoch: 35, Steps: 64 | Train Loss: 0.0910999 Vali Loss: 0.2179816 Test Loss: 0.2918855
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 36 cost time: 0.8606135845184326
Epoch: 36, Steps: 64 | Train Loss: 0.0916906 Vali Loss: 0.2159556 Test Loss: 0.2909236
Validation loss decreased (0.216306 --> 0.215956).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 37 cost time: 0.8600983619689941
Epoch: 37, Steps: 64 | Train Loss: 0.0907914 Vali Loss: 0.2190335 Test Loss: 0.2920406
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 38 cost time: 0.8744213581085205
Epoch: 38, Steps: 64 | Train Loss: 0.0913790 Vali Loss: 0.2187821 Test Loss: 0.2916099
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 39 cost time: 0.8643531799316406
Epoch: 39, Steps: 64 | Train Loss: 0.0916379 Vali Loss: 0.2174743 Test Loss: 0.2923824
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 40 cost time: 0.8657853603363037
Epoch: 40, Steps: 64 | Train Loss: 0.0906965 Vali Loss: 0.2178991 Test Loss: 0.2914754
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 41 cost time: 0.8669979572296143
Epoch: 41, Steps: 64 | Train Loss: 0.0900747 Vali Loss: 0.2154538 Test Loss: 0.2925329
Validation loss decreased (0.215956 --> 0.215454).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 42 cost time: 0.8736593723297119
Epoch: 42, Steps: 64 | Train Loss: 0.0899435 Vali Loss: 0.2176475 Test Loss: 0.2915431
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 43 cost time: 0.8523635864257812
Epoch: 43, Steps: 64 | Train Loss: 0.0907225 Vali Loss: 0.2175727 Test Loss: 0.2922523
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 44 cost time: 0.8594284057617188
Epoch: 44, Steps: 64 | Train Loss: 0.0906460 Vali Loss: 0.2184713 Test Loss: 0.2910669
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 45 cost time: 0.8499658107757568
Epoch: 45, Steps: 64 | Train Loss: 0.0900562 Vali Loss: 0.2155277 Test Loss: 0.2914155
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 46 cost time: 0.8467516899108887
Epoch: 46, Steps: 64 | Train Loss: 0.0906270 Vali Loss: 0.2174699 Test Loss: 0.2909512
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 47 cost time: 0.8586091995239258
Epoch: 47, Steps: 64 | Train Loss: 0.0899248 Vali Loss: 0.2174954 Test Loss: 0.2913960
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 48 cost time: 0.852348804473877
Epoch: 48, Steps: 64 | Train Loss: 0.0905540 Vali Loss: 0.2139935 Test Loss: 0.2910866
Validation loss decreased (0.215454 --> 0.213994).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 49 cost time: 0.8693766593933105
Epoch: 49, Steps: 64 | Train Loss: 0.0904168 Vali Loss: 0.2166095 Test Loss: 0.2914566
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 50 cost time: 0.8557147979736328
Epoch: 50, Steps: 64 | Train Loss: 0.0903297 Vali Loss: 0.2154893 Test Loss: 0.2912244
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 51 cost time: 0.8563885688781738
Epoch: 51, Steps: 64 | Train Loss: 0.0899639 Vali Loss: 0.2158409 Test Loss: 0.2921546
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 52 cost time: 0.8516130447387695
Epoch: 52, Steps: 64 | Train Loss: 0.0902450 Vali Loss: 0.2190458 Test Loss: 0.2915524
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 53 cost time: 0.852487325668335
Epoch: 53, Steps: 64 | Train Loss: 0.0901423 Vali Loss: 0.2155799 Test Loss: 0.2919578
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 54 cost time: 0.8524119853973389
Epoch: 54, Steps: 64 | Train Loss: 0.0901294 Vali Loss: 0.2171605 Test Loss: 0.2921527
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 55 cost time: 0.8507378101348877
Epoch: 55, Steps: 64 | Train Loss: 0.0901562 Vali Loss: 0.2140856 Test Loss: 0.2911699
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 56 cost time: 0.8600819110870361
Epoch: 56, Steps: 64 | Train Loss: 0.0899884 Vali Loss: 0.2174439 Test Loss: 0.2929751
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 57 cost time: 0.862621545791626
Epoch: 57, Steps: 64 | Train Loss: 0.0900243 Vali Loss: 0.2135679 Test Loss: 0.2909476
Validation loss decreased (0.213994 --> 0.213568).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 58 cost time: 0.8573675155639648
Epoch: 58, Steps: 64 | Train Loss: 0.0901662 Vali Loss: 0.2149957 Test Loss: 0.2903802
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 59 cost time: 0.854494571685791
Epoch: 59, Steps: 64 | Train Loss: 0.0898183 Vali Loss: 0.2147712 Test Loss: 0.2910456
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 60 cost time: 0.8694660663604736
Epoch: 60, Steps: 64 | Train Loss: 0.0903146 Vali Loss: 0.2167373 Test Loss: 0.2906959
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2909475266933441, mae:0.35281243920326233, rse:0.2475598007440567
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.058394432067871094 GB
Epoch: 1 cost time: 2.2381751537323
Epoch: 1, Steps: 64 | Train Loss: 0.7480850 Vali Loss: 2.2462509 Test Loss: 3.9060411
Validation loss decreased (inf --> 2.246251).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 2 cost time: 0.8376197814941406
Epoch: 2, Steps: 64 | Train Loss: 0.3336040 Vali Loss: 0.3018187 Test Loss: 0.3347619
Validation loss decreased (2.246251 --> 0.301819).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 3 cost time: 0.8383471965789795
Epoch: 3, Steps: 64 | Train Loss: 0.1118997 Vali Loss: 0.2593363 Test Loss: 0.3012272
Validation loss decreased (0.301819 --> 0.259336).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 4 cost time: 0.8362536430358887
Epoch: 4, Steps: 64 | Train Loss: 0.0996806 Vali Loss: 0.2494224 Test Loss: 0.2933683
Validation loss decreased (0.259336 --> 0.249422).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 5 cost time: 0.8417818546295166
Epoch: 5, Steps: 64 | Train Loss: 0.0939624 Vali Loss: 0.2416459 Test Loss: 0.2907210
Validation loss decreased (0.249422 --> 0.241646).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 6 cost time: 0.838630199432373
Epoch: 6, Steps: 64 | Train Loss: 0.0906063 Vali Loss: 0.2307945 Test Loss: 0.2912144
Validation loss decreased (0.241646 --> 0.230795).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 7 cost time: 0.8346221446990967
Epoch: 7, Steps: 64 | Train Loss: 0.0883724 Vali Loss: 0.2324856 Test Loss: 0.2890669
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 8 cost time: 0.8369522094726562
Epoch: 8, Steps: 64 | Train Loss: 0.0860660 Vali Loss: 0.2266473 Test Loss: 0.2863109
Validation loss decreased (0.230795 --> 0.226647).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 9 cost time: 0.8364577293395996
Epoch: 9, Steps: 64 | Train Loss: 0.0847167 Vali Loss: 0.2259895 Test Loss: 0.2870765
Validation loss decreased (0.226647 --> 0.225989).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 10 cost time: 0.8418326377868652
Epoch: 10, Steps: 64 | Train Loss: 0.0833090 Vali Loss: 0.2187876 Test Loss: 0.2868869
Validation loss decreased (0.225989 --> 0.218788).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 11 cost time: 0.8350000381469727
Epoch: 11, Steps: 64 | Train Loss: 0.0820334 Vali Loss: 0.2175603 Test Loss: 0.2873553
Validation loss decreased (0.218788 --> 0.217560).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 12 cost time: 0.8366208076477051
Epoch: 12, Steps: 64 | Train Loss: 0.0807147 Vali Loss: 0.2154047 Test Loss: 0.2873750
Validation loss decreased (0.217560 --> 0.215405).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 13 cost time: 0.841400146484375
Epoch: 13, Steps: 64 | Train Loss: 0.0802572 Vali Loss: 0.2127014 Test Loss: 0.2880534
Validation loss decreased (0.215405 --> 0.212701).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 14 cost time: 0.8413732051849365
Epoch: 14, Steps: 64 | Train Loss: 0.0791984 Vali Loss: 0.2058991 Test Loss: 0.2880320
Validation loss decreased (0.212701 --> 0.205899).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 15 cost time: 0.8504331111907959
Epoch: 15, Steps: 64 | Train Loss: 0.0789354 Vali Loss: 0.2056541 Test Loss: 0.2869253
Validation loss decreased (0.205899 --> 0.205654).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 16 cost time: 0.8389997482299805
Epoch: 16, Steps: 64 | Train Loss: 0.0784441 Vali Loss: 0.2063992 Test Loss: 0.2872213
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 17 cost time: 0.8406283855438232
Epoch: 17, Steps: 64 | Train Loss: 0.0778093 Vali Loss: 0.2047697 Test Loss: 0.2857429
Validation loss decreased (0.205654 --> 0.204770).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 18 cost time: 0.8393843173980713
Epoch: 18, Steps: 64 | Train Loss: 0.0769864 Vali Loss: 0.2058015 Test Loss: 0.2862609
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 19 cost time: 0.8573837280273438
Epoch: 19, Steps: 64 | Train Loss: 0.0765253 Vali Loss: 0.2051472 Test Loss: 0.2864721
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 20 cost time: 0.8387470245361328
Epoch: 20, Steps: 64 | Train Loss: 0.0763384 Vali Loss: 0.2017055 Test Loss: 0.2851589
Validation loss decreased (0.204770 --> 0.201706).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 21 cost time: 0.8410000801086426
Epoch: 21, Steps: 64 | Train Loss: 0.0757438 Vali Loss: 0.2002391 Test Loss: 0.2869324
Validation loss decreased (0.201706 --> 0.200239).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 22 cost time: 0.8342893123626709
Epoch: 22, Steps: 64 | Train Loss: 0.0753544 Vali Loss: 0.2016779 Test Loss: 0.2859287
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 23 cost time: 0.849390983581543
Epoch: 23, Steps: 64 | Train Loss: 0.0758919 Vali Loss: 0.2021151 Test Loss: 0.2858669
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 24 cost time: 0.834428071975708
Epoch: 24, Steps: 64 | Train Loss: 0.0751733 Vali Loss: 0.1987856 Test Loss: 0.2850030
Validation loss decreased (0.200239 --> 0.198786).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 25 cost time: 0.8367259502410889
Epoch: 25, Steps: 64 | Train Loss: 0.0750765 Vali Loss: 0.1999878 Test Loss: 0.2847511
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 26 cost time: 0.8370003700256348
Epoch: 26, Steps: 64 | Train Loss: 0.0751220 Vali Loss: 0.1989115 Test Loss: 0.2847529
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 27 cost time: 0.8346207141876221
Epoch: 27, Steps: 64 | Train Loss: 0.0751408 Vali Loss: 0.1970233 Test Loss: 0.2839092
Validation loss decreased (0.198786 --> 0.197023).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 28 cost time: 0.8354053497314453
Epoch: 28, Steps: 64 | Train Loss: 0.0748837 Vali Loss: 0.1982919 Test Loss: 0.2835597
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 29 cost time: 0.838057279586792
Epoch: 29, Steps: 64 | Train Loss: 0.0742800 Vali Loss: 0.1992067 Test Loss: 0.2844029
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 30 cost time: 0.8397331237792969
Epoch: 30, Steps: 64 | Train Loss: 0.0740180 Vali Loss: 0.1965338 Test Loss: 0.2837836
Validation loss decreased (0.197023 --> 0.196534).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 31 cost time: 0.8410017490386963
Epoch: 31, Steps: 64 | Train Loss: 0.0743696 Vali Loss: 0.1955504 Test Loss: 0.2839578
Validation loss decreased (0.196534 --> 0.195550).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 32 cost time: 0.8436269760131836
Epoch: 32, Steps: 64 | Train Loss: 0.0740156 Vali Loss: 0.1958801 Test Loss: 0.2835786
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 33 cost time: 0.8408281803131104
Epoch: 33, Steps: 64 | Train Loss: 0.0742137 Vali Loss: 0.1967027 Test Loss: 0.2838520
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 34 cost time: 0.8390669822692871
Epoch: 34, Steps: 64 | Train Loss: 0.0739006 Vali Loss: 0.1935731 Test Loss: 0.2840358
Validation loss decreased (0.195550 --> 0.193573).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 35 cost time: 0.8387272357940674
Epoch: 35, Steps: 64 | Train Loss: 0.0737111 Vali Loss: 0.1977289 Test Loss: 0.2838197
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 36 cost time: 0.8379998207092285
Epoch: 36, Steps: 64 | Train Loss: 0.0740261 Vali Loss: 0.1949953 Test Loss: 0.2842712
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 37 cost time: 0.8416104316711426
Epoch: 37, Steps: 64 | Train Loss: 0.0734373 Vali Loss: 0.1936651 Test Loss: 0.2834323
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 38 cost time: 0.8459985256195068
Epoch: 38, Steps: 64 | Train Loss: 0.0732700 Vali Loss: 0.1961217 Test Loss: 0.2835191
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 39 cost time: 0.8405108451843262
Epoch: 39, Steps: 64 | Train Loss: 0.0737409 Vali Loss: 0.1938336 Test Loss: 0.2833918
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 40 cost time: 0.8380289077758789
Epoch: 40, Steps: 64 | Train Loss: 0.0737817 Vali Loss: 0.1944607 Test Loss: 0.2830869
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 41 cost time: 0.8390004634857178
Epoch: 41, Steps: 64 | Train Loss: 0.0735794 Vali Loss: 0.1957365 Test Loss: 0.2839148
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 42 cost time: 0.842458963394165
Epoch: 42, Steps: 64 | Train Loss: 0.0735625 Vali Loss: 0.1959454 Test Loss: 0.2835187
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 43 cost time: 0.8333377838134766
Epoch: 43, Steps: 64 | Train Loss: 0.0733752 Vali Loss: 0.1930980 Test Loss: 0.2830366
Validation loss decreased (0.193573 --> 0.193098).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 44 cost time: 0.8383593559265137
Epoch: 44, Steps: 64 | Train Loss: 0.0734274 Vali Loss: 0.1940794 Test Loss: 0.2831365
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 45 cost time: 0.8488314151763916
Epoch: 45, Steps: 64 | Train Loss: 0.0735782 Vali Loss: 0.1938520 Test Loss: 0.2835992
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 46 cost time: 0.8490006923675537
Epoch: 46, Steps: 64 | Train Loss: 0.0736013 Vali Loss: 0.1953499 Test Loss: 0.2838641
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 47 cost time: 0.8380625247955322
Epoch: 47, Steps: 64 | Train Loss: 0.0737463 Vali Loss: 0.1942560 Test Loss: 0.2831984
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 48 cost time: 0.8393640518188477
Epoch: 48, Steps: 64 | Train Loss: 0.0736543 Vali Loss: 0.1936931 Test Loss: 0.2843739
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 49 cost time: 0.8523135185241699
Epoch: 49, Steps: 64 | Train Loss: 0.0729678 Vali Loss: 0.1947421 Test Loss: 0.2832817
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 50 cost time: 0.8417398929595947
Epoch: 50, Steps: 64 | Train Loss: 0.0733238 Vali Loss: 0.1950199 Test Loss: 0.2836948
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 51 cost time: 0.8450000286102295
Epoch: 51, Steps: 64 | Train Loss: 0.0735471 Vali Loss: 0.1944164 Test Loss: 0.2837778
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 52 cost time: 0.8366131782531738
Epoch: 52, Steps: 64 | Train Loss: 0.0735083 Vali Loss: 0.1951275 Test Loss: 0.2840271
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 53 cost time: 0.8234603404998779
Epoch: 53, Steps: 64 | Train Loss: 0.0733818 Vali Loss: 0.1950055 Test Loss: 0.2836244
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 54 cost time: 0.8296563625335693
Epoch: 54, Steps: 64 | Train Loss: 0.0733742 Vali Loss: 0.1955453 Test Loss: 0.2836757
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 55 cost time: 0.838998556137085
Epoch: 55, Steps: 64 | Train Loss: 0.0734591 Vali Loss: 0.1927578 Test Loss: 0.2827025
Validation loss decreased (0.193098 --> 0.192758).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 56 cost time: 0.8438210487365723
Epoch: 56, Steps: 64 | Train Loss: 0.0735677 Vali Loss: 0.1951994 Test Loss: 0.2832313
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 57 cost time: 0.8186075687408447
Epoch: 57, Steps: 64 | Train Loss: 0.0735850 Vali Loss: 0.1939745 Test Loss: 0.2832687
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 58 cost time: 0.8433723449707031
Epoch: 58, Steps: 64 | Train Loss: 0.0732567 Vali Loss: 0.1943891 Test Loss: 0.2831399
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 59 cost time: 0.8409223556518555
Epoch: 59, Steps: 64 | Train Loss: 0.0735636 Vali Loss: 0.1951048 Test Loss: 0.2832776
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 60 cost time: 0.8440001010894775
Epoch: 60, Steps: 64 | Train Loss: 0.0732967 Vali Loss: 0.1942889 Test Loss: 0.2836130
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2827025055885315, mae:0.35294151306152344, rse:0.24402685463428497
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06169319152832031 GB
Epoch: 1 cost time: 2.22119140625
Epoch: 1, Steps: 64 | Train Loss: 0.8368981 Vali Loss: 2.5488398 Test Loss: 4.4861703
Validation loss decreased (inf --> 2.548840).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 2 cost time: 0.85910964012146
Epoch: 2, Steps: 64 | Train Loss: 0.3252367 Vali Loss: 0.3390834 Test Loss: 0.3830866
Validation loss decreased (2.548840 --> 0.339083).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 3 cost time: 0.8584139347076416
Epoch: 3, Steps: 64 | Train Loss: 0.1091376 Vali Loss: 0.2584701 Test Loss: 0.2963333
Validation loss decreased (0.339083 --> 0.258470).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 4 cost time: 0.8582863807678223
Epoch: 4, Steps: 64 | Train Loss: 0.0952791 Vali Loss: 0.2494714 Test Loss: 0.2888321
Validation loss decreased (0.258470 --> 0.249471).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 5 cost time: 0.8768393993377686
Epoch: 5, Steps: 64 | Train Loss: 0.0913612 Vali Loss: 0.2450386 Test Loss: 0.2824645
Validation loss decreased (0.249471 --> 0.245039).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 6 cost time: 0.8550002574920654
Epoch: 6, Steps: 64 | Train Loss: 0.0875580 Vali Loss: 0.2329532 Test Loss: 0.2893775
Validation loss decreased (0.245039 --> 0.232953).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 7 cost time: 0.8606204986572266
Epoch: 7, Steps: 64 | Train Loss: 0.0858271 Vali Loss: 0.2279458 Test Loss: 0.2827721
Validation loss decreased (0.232953 --> 0.227946).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 8 cost time: 0.8487677574157715
Epoch: 8, Steps: 64 | Train Loss: 0.0838648 Vali Loss: 0.2245483 Test Loss: 0.2811152
Validation loss decreased (0.227946 --> 0.224548).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 9 cost time: 0.8603453636169434
Epoch: 9, Steps: 64 | Train Loss: 0.0824698 Vali Loss: 0.2208160 Test Loss: 0.2859095
Validation loss decreased (0.224548 --> 0.220816).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 10 cost time: 0.859093427658081
Epoch: 10, Steps: 64 | Train Loss: 0.0807614 Vali Loss: 0.2163676 Test Loss: 0.2864912
Validation loss decreased (0.220816 --> 0.216368).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 11 cost time: 0.8684601783752441
Epoch: 11, Steps: 64 | Train Loss: 0.0797542 Vali Loss: 0.2135580 Test Loss: 0.2826265
Validation loss decreased (0.216368 --> 0.213558).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 12 cost time: 0.8540000915527344
Epoch: 12, Steps: 64 | Train Loss: 0.0788944 Vali Loss: 0.2092921 Test Loss: 0.2821928
Validation loss decreased (0.213558 --> 0.209292).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 13 cost time: 0.8575167655944824
Epoch: 13, Steps: 64 | Train Loss: 0.0782847 Vali Loss: 0.2075152 Test Loss: 0.2834429
Validation loss decreased (0.209292 --> 0.207515).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 14 cost time: 0.8554587364196777
Epoch: 14, Steps: 64 | Train Loss: 0.0773512 Vali Loss: 0.2071320 Test Loss: 0.2801951
Validation loss decreased (0.207515 --> 0.207132).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 15 cost time: 0.8732032775878906
Epoch: 15, Steps: 64 | Train Loss: 0.0767715 Vali Loss: 0.2038519 Test Loss: 0.2829074
Validation loss decreased (0.207132 --> 0.203852).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 16 cost time: 0.855400800704956
Epoch: 16, Steps: 64 | Train Loss: 0.0764732 Vali Loss: 0.2042759 Test Loss: 0.2812363
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 17 cost time: 0.8560001850128174
Epoch: 17, Steps: 64 | Train Loss: 0.0756665 Vali Loss: 0.2032237 Test Loss: 0.2838187
Validation loss decreased (0.203852 --> 0.203224).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 18 cost time: 0.855616569519043
Epoch: 18, Steps: 64 | Train Loss: 0.0749332 Vali Loss: 0.2000941 Test Loss: 0.2790314
Validation loss decreased (0.203224 --> 0.200094).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 19 cost time: 0.8674306869506836
Epoch: 19, Steps: 64 | Train Loss: 0.0750380 Vali Loss: 0.1971580 Test Loss: 0.2805226
Validation loss decreased (0.200094 --> 0.197158).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 20 cost time: 0.8604633808135986
Epoch: 20, Steps: 64 | Train Loss: 0.0745511 Vali Loss: 0.1978470 Test Loss: 0.2798232
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 21 cost time: 0.8533487319946289
Epoch: 21, Steps: 64 | Train Loss: 0.0745063 Vali Loss: 0.1974457 Test Loss: 0.2795817
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 22 cost time: 0.8589999675750732
Epoch: 22, Steps: 64 | Train Loss: 0.0738135 Vali Loss: 0.1964155 Test Loss: 0.2796425
Validation loss decreased (0.197158 --> 0.196415).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 23 cost time: 0.8569998741149902
Epoch: 23, Steps: 64 | Train Loss: 0.0734684 Vali Loss: 0.1949041 Test Loss: 0.2786424
Validation loss decreased (0.196415 --> 0.194904).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 24 cost time: 0.857616662979126
Epoch: 24, Steps: 64 | Train Loss: 0.0733290 Vali Loss: 0.1961810 Test Loss: 0.2789952
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 25 cost time: 0.8590457439422607
Epoch: 25, Steps: 64 | Train Loss: 0.0733666 Vali Loss: 0.1962539 Test Loss: 0.2776493
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 26 cost time: 0.8527154922485352
Epoch: 26, Steps: 64 | Train Loss: 0.0730194 Vali Loss: 0.1939729 Test Loss: 0.2789574
Validation loss decreased (0.194904 --> 0.193973).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 27 cost time: 0.8587908744812012
Epoch: 27, Steps: 64 | Train Loss: 0.0730006 Vali Loss: 0.1917053 Test Loss: 0.2786635
Validation loss decreased (0.193973 --> 0.191705).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 28 cost time: 0.8559994697570801
Epoch: 28, Steps: 64 | Train Loss: 0.0727240 Vali Loss: 0.1925664 Test Loss: 0.2781804
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 29 cost time: 0.8536264896392822
Epoch: 29, Steps: 64 | Train Loss: 0.0723263 Vali Loss: 0.1951991 Test Loss: 0.2787762
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 30 cost time: 0.8233695030212402
Epoch: 30, Steps: 64 | Train Loss: 0.0725582 Vali Loss: 0.1917456 Test Loss: 0.2773103
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 31 cost time: 0.8513646125793457
Epoch: 31, Steps: 64 | Train Loss: 0.0725641 Vali Loss: 0.1915874 Test Loss: 0.2772483
Validation loss decreased (0.191705 --> 0.191587).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 32 cost time: 0.8562822341918945
Epoch: 32, Steps: 64 | Train Loss: 0.0724988 Vali Loss: 0.1913981 Test Loss: 0.2775367
Validation loss decreased (0.191587 --> 0.191398).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 33 cost time: 0.8630001544952393
Epoch: 33, Steps: 64 | Train Loss: 0.0724383 Vali Loss: 0.1930195 Test Loss: 0.2776031
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 34 cost time: 0.8564014434814453
Epoch: 34, Steps: 64 | Train Loss: 0.0724617 Vali Loss: 0.1890102 Test Loss: 0.2774864
Validation loss decreased (0.191398 --> 0.189010).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 35 cost time: 0.8546359539031982
Epoch: 35, Steps: 64 | Train Loss: 0.0724410 Vali Loss: 0.1905572 Test Loss: 0.2774199
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 36 cost time: 0.852485179901123
Epoch: 36, Steps: 64 | Train Loss: 0.0720112 Vali Loss: 0.1931396 Test Loss: 0.2779143
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 37 cost time: 0.8657894134521484
Epoch: 37, Steps: 64 | Train Loss: 0.0720098 Vali Loss: 0.1918543 Test Loss: 0.2778942
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 38 cost time: 0.8499999046325684
Epoch: 38, Steps: 64 | Train Loss: 0.0719212 Vali Loss: 0.1926322 Test Loss: 0.2778883
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 39 cost time: 0.8550002574920654
Epoch: 39, Steps: 64 | Train Loss: 0.0718994 Vali Loss: 0.1942690 Test Loss: 0.2785615
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 40 cost time: 0.8584370613098145
Epoch: 40, Steps: 64 | Train Loss: 0.0723289 Vali Loss: 0.1922706 Test Loss: 0.2780467
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 41 cost time: 0.8683719635009766
Epoch: 41, Steps: 64 | Train Loss: 0.0720878 Vali Loss: 0.1925023 Test Loss: 0.2779514
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 42 cost time: 0.8564109802246094
Epoch: 42, Steps: 64 | Train Loss: 0.0717770 Vali Loss: 0.1892404 Test Loss: 0.2779961
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 43 cost time: 0.8537471294403076
Epoch: 43, Steps: 64 | Train Loss: 0.0718610 Vali Loss: 0.1935077 Test Loss: 0.2776951
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 44 cost time: 0.858609676361084
Epoch: 44, Steps: 64 | Train Loss: 0.0721950 Vali Loss: 0.1932821 Test Loss: 0.2774712
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 45 cost time: 0.8638713359832764
Epoch: 45, Steps: 64 | Train Loss: 0.0718331 Vali Loss: 0.1919171 Test Loss: 0.2765825
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 46 cost time: 0.8594179153442383
Epoch: 46, Steps: 64 | Train Loss: 0.0722400 Vali Loss: 0.1939728 Test Loss: 0.2777967
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 47 cost time: 0.8633558750152588
Epoch: 47, Steps: 64 | Train Loss: 0.0715928 Vali Loss: 0.1931193 Test Loss: 0.2781424
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 48 cost time: 0.8677480220794678
Epoch: 48, Steps: 64 | Train Loss: 0.0719768 Vali Loss: 0.1914093 Test Loss: 0.2772346
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 49 cost time: 0.8597824573516846
Epoch: 49, Steps: 64 | Train Loss: 0.0720411 Vali Loss: 0.1906426 Test Loss: 0.2774529
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 50 cost time: 0.859201192855835
Epoch: 50, Steps: 64 | Train Loss: 0.0719571 Vali Loss: 0.1925697 Test Loss: 0.2780582
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 51 cost time: 0.8574545383453369
Epoch: 51, Steps: 64 | Train Loss: 0.0720792 Vali Loss: 0.1903109 Test Loss: 0.2778909
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 52 cost time: 0.8603434562683105
Epoch: 52, Steps: 64 | Train Loss: 0.0717241 Vali Loss: 0.1910522 Test Loss: 0.2780411
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 53 cost time: 0.8593635559082031
Epoch: 53, Steps: 64 | Train Loss: 0.0718873 Vali Loss: 0.1918736 Test Loss: 0.2779622
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 54 cost time: 0.864168643951416
Epoch: 54, Steps: 64 | Train Loss: 0.0722345 Vali Loss: 0.1905047 Test Loss: 0.2769019
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 55 cost time: 0.8680000305175781
Epoch: 55, Steps: 64 | Train Loss: 0.0718920 Vali Loss: 0.1896518 Test Loss: 0.2776269
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 56 cost time: 0.8662300109863281
Epoch: 56, Steps: 64 | Train Loss: 0.0718909 Vali Loss: 0.1899607 Test Loss: 0.2775681
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 57 cost time: 0.8594000339508057
Epoch: 57, Steps: 64 | Train Loss: 0.0715252 Vali Loss: 0.1911287 Test Loss: 0.2777247
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 58 cost time: 0.856203556060791
Epoch: 58, Steps: 64 | Train Loss: 0.0719952 Vali Loss: 0.1890872 Test Loss: 0.2778651
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 59 cost time: 0.8617870807647705
Epoch: 59, Steps: 64 | Train Loss: 0.0718876 Vali Loss: 0.1889385 Test Loss: 0.2771282
Validation loss decreased (0.189010 --> 0.188938).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 60 cost time: 0.8599998950958252
Epoch: 60, Steps: 64 | Train Loss: 0.0715420 Vali Loss: 0.1907304 Test Loss: 0.2773467
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2771281898021698, mae:0.3490292727947235, rse:0.24160900712013245
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05416154861450195 GB
Epoch: 1 cost time: 2.2316198348999023
Epoch: 1, Steps: 64 | Train Loss: 1.0274914 Vali Loss: 3.0186806 Test Loss: 5.3853569
Validation loss decreased (inf --> 3.018681).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 2 cost time: 0.8616130352020264
Epoch: 2, Steps: 64 | Train Loss: 0.7547001 Vali Loss: 1.5317817 Test Loss: 2.5544798
Validation loss decreased (3.018681 --> 1.531782).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 3 cost time: 0.8604390621185303
Epoch: 3, Steps: 64 | Train Loss: 0.4306243 Vali Loss: 0.9406934 Test Loss: 1.4531492
Validation loss decreased (1.531782 --> 0.940693).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 4 cost time: 0.8507785797119141
Epoch: 4, Steps: 64 | Train Loss: 0.2695858 Vali Loss: 0.6365729 Test Loss: 0.8953778
Validation loss decreased (0.940693 --> 0.636573).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 5 cost time: 0.8649997711181641
Epoch: 5, Steps: 64 | Train Loss: 0.1880575 Vali Loss: 0.4528283 Test Loss: 0.5858798
Validation loss decreased (0.636573 --> 0.452828).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 6 cost time: 0.8639993667602539
Epoch: 6, Steps: 64 | Train Loss: 0.1471398 Vali Loss: 0.3656577 Test Loss: 0.4455885
Validation loss decreased (0.452828 --> 0.365658).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 7 cost time: 0.8516123294830322
Epoch: 7, Steps: 64 | Train Loss: 0.1275469 Vali Loss: 0.3072670 Test Loss: 0.3781610
Validation loss decreased (0.365658 --> 0.307267).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 8 cost time: 0.8541851043701172
Epoch: 8, Steps: 64 | Train Loss: 0.1166671 Vali Loss: 0.2793033 Test Loss: 0.3390284
Validation loss decreased (0.307267 --> 0.279303).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 9 cost time: 0.8563706874847412
Epoch: 9, Steps: 64 | Train Loss: 0.1097707 Vali Loss: 0.2627699 Test Loss: 0.3216180
Validation loss decreased (0.279303 --> 0.262770).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 10 cost time: 0.8697302341461182
Epoch: 10, Steps: 64 | Train Loss: 0.1060431 Vali Loss: 0.2504715 Test Loss: 0.3131579
Validation loss decreased (0.262770 --> 0.250472).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 11 cost time: 0.8589997291564941
Epoch: 11, Steps: 64 | Train Loss: 0.1030383 Vali Loss: 0.2469978 Test Loss: 0.3049459
Validation loss decreased (0.250472 --> 0.246998).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 12 cost time: 0.8576169013977051
Epoch: 12, Steps: 64 | Train Loss: 0.1010403 Vali Loss: 0.2408847 Test Loss: 0.3013797
Validation loss decreased (0.246998 --> 0.240885).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 13 cost time: 0.8593940734863281
Epoch: 13, Steps: 64 | Train Loss: 0.0999821 Vali Loss: 0.2372246 Test Loss: 0.2989030
Validation loss decreased (0.240885 --> 0.237225).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 14 cost time: 0.8763208389282227
Epoch: 14, Steps: 64 | Train Loss: 0.0976583 Vali Loss: 0.2335822 Test Loss: 0.2961299
Validation loss decreased (0.237225 --> 0.233582).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 15 cost time: 0.8594136238098145
Epoch: 15, Steps: 64 | Train Loss: 0.0966669 Vali Loss: 0.2321683 Test Loss: 0.2928790
Validation loss decreased (0.233582 --> 0.232168).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 16 cost time: 0.8559999465942383
Epoch: 16, Steps: 64 | Train Loss: 0.0957436 Vali Loss: 0.2248793 Test Loss: 0.2923859
Validation loss decreased (0.232168 --> 0.224879).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 17 cost time: 0.8747940063476562
Epoch: 17, Steps: 64 | Train Loss: 0.0953440 Vali Loss: 0.2265409 Test Loss: 0.2884516
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 18 cost time: 0.8573653697967529
Epoch: 18, Steps: 64 | Train Loss: 0.0941722 Vali Loss: 0.2266415 Test Loss: 0.2918393
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 19 cost time: 0.8550186157226562
Epoch: 19, Steps: 64 | Train Loss: 0.0940828 Vali Loss: 0.2249940 Test Loss: 0.2898923
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 20 cost time: 0.8603782653808594
Epoch: 20, Steps: 64 | Train Loss: 0.0931415 Vali Loss: 0.2253298 Test Loss: 0.2892686
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 21 cost time: 0.8717145919799805
Epoch: 21, Steps: 64 | Train Loss: 0.0927285 Vali Loss: 0.2235231 Test Loss: 0.2890127
Validation loss decreased (0.224879 --> 0.223523).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 22 cost time: 0.8634417057037354
Epoch: 22, Steps: 64 | Train Loss: 0.0918041 Vali Loss: 0.2221134 Test Loss: 0.2870533
Validation loss decreased (0.223523 --> 0.222113).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 23 cost time: 0.8626260757446289
Epoch: 23, Steps: 64 | Train Loss: 0.0919685 Vali Loss: 0.2243268 Test Loss: 0.2910907
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 24 cost time: 0.8494181632995605
Epoch: 24, Steps: 64 | Train Loss: 0.0917146 Vali Loss: 0.2239022 Test Loss: 0.2892925
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 25 cost time: 0.8564143180847168
Epoch: 25, Steps: 64 | Train Loss: 0.0912288 Vali Loss: 0.2213382 Test Loss: 0.2879077
Validation loss decreased (0.222113 --> 0.221338).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 26 cost time: 0.8527956008911133
Epoch: 26, Steps: 64 | Train Loss: 0.0913894 Vali Loss: 0.2184436 Test Loss: 0.2874666
Validation loss decreased (0.221338 --> 0.218444).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 27 cost time: 0.8550000190734863
Epoch: 27, Steps: 64 | Train Loss: 0.0907105 Vali Loss: 0.2199628 Test Loss: 0.2855485
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 28 cost time: 0.8586108684539795
Epoch: 28, Steps: 64 | Train Loss: 0.0897536 Vali Loss: 0.2209102 Test Loss: 0.2848606
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 29 cost time: 0.8936057090759277
Epoch: 29, Steps: 64 | Train Loss: 0.0895650 Vali Loss: 0.2179718 Test Loss: 0.2847099
Validation loss decreased (0.218444 --> 0.217972).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 30 cost time: 0.861924409866333
Epoch: 30, Steps: 64 | Train Loss: 0.0902883 Vali Loss: 0.2197682 Test Loss: 0.2851073
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 31 cost time: 0.8643932342529297
Epoch: 31, Steps: 64 | Train Loss: 0.0899056 Vali Loss: 0.2194958 Test Loss: 0.2841724
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 32 cost time: 0.873464822769165
Epoch: 32, Steps: 64 | Train Loss: 0.0901621 Vali Loss: 0.2184684 Test Loss: 0.2849269
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 33 cost time: 0.9414622783660889
Epoch: 33, Steps: 64 | Train Loss: 0.0894181 Vali Loss: 0.2184990 Test Loss: 0.2850203
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 34 cost time: 0.9482550621032715
Epoch: 34, Steps: 64 | Train Loss: 0.0899549 Vali Loss: 0.2192094 Test Loss: 0.2858693
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 35 cost time: 0.8597874641418457
Epoch: 35, Steps: 64 | Train Loss: 0.0894813 Vali Loss: 0.2182486 Test Loss: 0.2837458
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 36 cost time: 0.8704979419708252
Epoch: 36, Steps: 64 | Train Loss: 0.0886800 Vali Loss: 0.2178222 Test Loss: 0.2857769
Validation loss decreased (0.217972 --> 0.217822).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 37 cost time: 0.8631391525268555
Epoch: 37, Steps: 64 | Train Loss: 0.0890411 Vali Loss: 0.2170989 Test Loss: 0.2857331
Validation loss decreased (0.217822 --> 0.217099).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 38 cost time: 0.8658645153045654
Epoch: 38, Steps: 64 | Train Loss: 0.0892777 Vali Loss: 0.2177211 Test Loss: 0.2849273
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 39 cost time: 0.875999927520752
Epoch: 39, Steps: 64 | Train Loss: 0.0885115 Vali Loss: 0.2188004 Test Loss: 0.2837222
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 40 cost time: 0.8596327304840088
Epoch: 40, Steps: 64 | Train Loss: 0.0887797 Vali Loss: 0.2177170 Test Loss: 0.2852883
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 41 cost time: 0.8664889335632324
Epoch: 41, Steps: 64 | Train Loss: 0.0886277 Vali Loss: 0.2175455 Test Loss: 0.2850611
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 42 cost time: 0.8584575653076172
Epoch: 42, Steps: 64 | Train Loss: 0.0888427 Vali Loss: 0.2200003 Test Loss: 0.2842557
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 43 cost time: 0.8704943656921387
Epoch: 43, Steps: 64 | Train Loss: 0.0884875 Vali Loss: 0.2184135 Test Loss: 0.2856640
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 44 cost time: 0.862999677658081
Epoch: 44, Steps: 64 | Train Loss: 0.0881346 Vali Loss: 0.2176430 Test Loss: 0.2839137
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 45 cost time: 0.8566217422485352
Epoch: 45, Steps: 64 | Train Loss: 0.0882604 Vali Loss: 0.2177257 Test Loss: 0.2852515
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 46 cost time: 0.8544216156005859
Epoch: 46, Steps: 64 | Train Loss: 0.0883967 Vali Loss: 0.2152009 Test Loss: 0.2847573
Validation loss decreased (0.217099 --> 0.215201).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 47 cost time: 0.881359338760376
Epoch: 47, Steps: 64 | Train Loss: 0.0890239 Vali Loss: 0.2175348 Test Loss: 0.2826895
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 48 cost time: 0.8628509044647217
Epoch: 48, Steps: 64 | Train Loss: 0.0891280 Vali Loss: 0.2136475 Test Loss: 0.2835578
Validation loss decreased (0.215201 --> 0.213648).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 49 cost time: 0.8609998226165771
Epoch: 49, Steps: 64 | Train Loss: 0.0886364 Vali Loss: 0.2162845 Test Loss: 0.2853676
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 50 cost time: 0.8706235885620117
Epoch: 50, Steps: 64 | Train Loss: 0.0887360 Vali Loss: 0.2164469 Test Loss: 0.2835243
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 51 cost time: 0.8590502738952637
Epoch: 51, Steps: 64 | Train Loss: 0.0882676 Vali Loss: 0.2156862 Test Loss: 0.2830195
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 52 cost time: 0.8537139892578125
Epoch: 52, Steps: 64 | Train Loss: 0.0877198 Vali Loss: 0.2152152 Test Loss: 0.2836677
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 53 cost time: 0.8587236404418945
Epoch: 53, Steps: 64 | Train Loss: 0.0884735 Vali Loss: 0.2181225 Test Loss: 0.2835787
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 54 cost time: 0.8522257804870605
Epoch: 54, Steps: 64 | Train Loss: 0.0883218 Vali Loss: 0.2188948 Test Loss: 0.2841807
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 55 cost time: 0.8439998626708984
Epoch: 55, Steps: 64 | Train Loss: 0.0882485 Vali Loss: 0.2150252 Test Loss: 0.2846893
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 56 cost time: 0.8682458400726318
Epoch: 56, Steps: 64 | Train Loss: 0.0886966 Vali Loss: 0.2180078 Test Loss: 0.2845618
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 57 cost time: 0.8574438095092773
Epoch: 57, Steps: 64 | Train Loss: 0.0881882 Vali Loss: 0.2168491 Test Loss: 0.2834586
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 58 cost time: 0.872443675994873
Epoch: 58, Steps: 64 | Train Loss: 0.0876985 Vali Loss: 0.2163398 Test Loss: 0.2854913
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 59 cost time: 0.858757495880127
Epoch: 59, Steps: 64 | Train Loss: 0.0881463 Vali Loss: 0.2152721 Test Loss: 0.2830563
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 60 cost time: 0.8554847240447998
Epoch: 60, Steps: 64 | Train Loss: 0.0881230 Vali Loss: 0.2174553 Test Loss: 0.2833683
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2835579216480255, mae:0.34253525733947754, rse:0.24439576268196106
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05855607986450195 GB
Epoch: 1 cost time: 2.364792585372925
Epoch: 1, Steps: 64 | Train Loss: 0.8792729 Vali Loss: 2.6429970 Test Loss: 4.6400080
Validation loss decreased (inf --> 2.642997).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 2 cost time: 0.932450532913208
Epoch: 2, Steps: 64 | Train Loss: 0.4130725 Vali Loss: 0.3607831 Test Loss: 0.3867483
Validation loss decreased (2.642997 --> 0.360783).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 3 cost time: 0.9075644016265869
Epoch: 3, Steps: 64 | Train Loss: 0.1096763 Vali Loss: 0.2530407 Test Loss: 0.2811843
Validation loss decreased (0.360783 --> 0.253041).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 4 cost time: 0.9074046611785889
Epoch: 4, Steps: 64 | Train Loss: 0.0961993 Vali Loss: 0.2391078 Test Loss: 0.2785942
Validation loss decreased (0.253041 --> 0.239108).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 5 cost time: 0.8953993320465088
Epoch: 5, Steps: 64 | Train Loss: 0.0916780 Vali Loss: 0.2294773 Test Loss: 0.2765481
Validation loss decreased (0.239108 --> 0.229477).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 6 cost time: 0.8977553844451904
Epoch: 6, Steps: 64 | Train Loss: 0.0890749 Vali Loss: 0.2277750 Test Loss: 0.2738874
Validation loss decreased (0.229477 --> 0.227775).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 7 cost time: 0.9040000438690186
Epoch: 7, Steps: 64 | Train Loss: 0.0872786 Vali Loss: 0.2183136 Test Loss: 0.2758118
Validation loss decreased (0.227775 --> 0.218314).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 8 cost time: 0.896613597869873
Epoch: 8, Steps: 64 | Train Loss: 0.0842262 Vali Loss: 0.2164809 Test Loss: 0.2725060
Validation loss decreased (0.218314 --> 0.216481).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 9 cost time: 0.8971569538116455
Epoch: 9, Steps: 64 | Train Loss: 0.0827326 Vali Loss: 0.2130060 Test Loss: 0.2693062
Validation loss decreased (0.216481 --> 0.213006).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 10 cost time: 0.8984565734863281
Epoch: 10, Steps: 64 | Train Loss: 0.0821393 Vali Loss: 0.2074372 Test Loss: 0.2693916
Validation loss decreased (0.213006 --> 0.207437).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 11 cost time: 0.8953666687011719
Epoch: 11, Steps: 64 | Train Loss: 0.0808541 Vali Loss: 0.2068050 Test Loss: 0.2699679
Validation loss decreased (0.207437 --> 0.206805).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 12 cost time: 0.9113614559173584
Epoch: 12, Steps: 64 | Train Loss: 0.0793598 Vali Loss: 0.2057898 Test Loss: 0.2693484
Validation loss decreased (0.206805 --> 0.205790).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 13 cost time: 0.8997328281402588
Epoch: 13, Steps: 64 | Train Loss: 0.0786639 Vali Loss: 0.2033852 Test Loss: 0.2686462
Validation loss decreased (0.205790 --> 0.203385).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 14 cost time: 0.9006049633026123
Epoch: 14, Steps: 64 | Train Loss: 0.0777770 Vali Loss: 0.2009639 Test Loss: 0.2678530
Validation loss decreased (0.203385 --> 0.200964).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 15 cost time: 0.9056158065795898
Epoch: 15, Steps: 64 | Train Loss: 0.0772010 Vali Loss: 0.1972194 Test Loss: 0.2663089
Validation loss decreased (0.200964 --> 0.197219).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 16 cost time: 0.9004240036010742
Epoch: 16, Steps: 64 | Train Loss: 0.0762241 Vali Loss: 0.1957791 Test Loss: 0.2664645
Validation loss decreased (0.197219 --> 0.195779).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 17 cost time: 0.8933601379394531
Epoch: 17, Steps: 64 | Train Loss: 0.0756525 Vali Loss: 0.1959230 Test Loss: 0.2654193
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 18 cost time: 0.8964290618896484
Epoch: 18, Steps: 64 | Train Loss: 0.0752270 Vali Loss: 0.1945184 Test Loss: 0.2659935
Validation loss decreased (0.195779 --> 0.194518).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 19 cost time: 0.9153468608856201
Epoch: 19, Steps: 64 | Train Loss: 0.0752799 Vali Loss: 0.1898049 Test Loss: 0.2638850
Validation loss decreased (0.194518 --> 0.189805).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 20 cost time: 0.8997645378112793
Epoch: 20, Steps: 64 | Train Loss: 0.0743344 Vali Loss: 0.1943294 Test Loss: 0.2635230
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 21 cost time: 0.9010014533996582
Epoch: 21, Steps: 64 | Train Loss: 0.0743642 Vali Loss: 0.1906923 Test Loss: 0.2642896
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 22 cost time: 0.9100387096405029
Epoch: 22, Steps: 64 | Train Loss: 0.0737277 Vali Loss: 0.1888015 Test Loss: 0.2642626
Validation loss decreased (0.189805 --> 0.188801).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 23 cost time: 0.8703792095184326
Epoch: 23, Steps: 64 | Train Loss: 0.0729846 Vali Loss: 0.1891961 Test Loss: 0.2645181
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 24 cost time: 0.8913531303405762
Epoch: 24, Steps: 64 | Train Loss: 0.0735073 Vali Loss: 0.1912081 Test Loss: 0.2651708
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 25 cost time: 0.8963582515716553
Epoch: 25, Steps: 64 | Train Loss: 0.0732099 Vali Loss: 0.1883191 Test Loss: 0.2620936
Validation loss decreased (0.188801 --> 0.188319).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 26 cost time: 0.8917419910430908
Epoch: 26, Steps: 64 | Train Loss: 0.0728852 Vali Loss: 0.1875310 Test Loss: 0.2647781
Validation loss decreased (0.188319 --> 0.187531).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 27 cost time: 0.896630048751831
Epoch: 27, Steps: 64 | Train Loss: 0.0727205 Vali Loss: 0.1877692 Test Loss: 0.2643824
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 28 cost time: 0.8990004062652588
Epoch: 28, Steps: 64 | Train Loss: 0.0727964 Vali Loss: 0.1879246 Test Loss: 0.2628670
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 29 cost time: 0.9066183567047119
Epoch: 29, Steps: 64 | Train Loss: 0.0721613 Vali Loss: 0.1874372 Test Loss: 0.2644909
Validation loss decreased (0.187531 --> 0.187437).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 30 cost time: 0.9613571166992188
Epoch: 30, Steps: 64 | Train Loss: 0.0724193 Vali Loss: 0.1890159 Test Loss: 0.2645097
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 31 cost time: 0.9664268493652344
Epoch: 31, Steps: 64 | Train Loss: 0.0723814 Vali Loss: 0.1869408 Test Loss: 0.2633350
Validation loss decreased (0.187437 --> 0.186941).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 32 cost time: 0.8883812427520752
Epoch: 32, Steps: 64 | Train Loss: 0.0722416 Vali Loss: 0.1869719 Test Loss: 0.2619912
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 33 cost time: 0.9028182029724121
Epoch: 33, Steps: 64 | Train Loss: 0.0720322 Vali Loss: 0.1852901 Test Loss: 0.2630993
Validation loss decreased (0.186941 --> 0.185290).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 34 cost time: 0.8937978744506836
Epoch: 34, Steps: 64 | Train Loss: 0.0715571 Vali Loss: 0.1896704 Test Loss: 0.2641287
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 35 cost time: 0.8983786106109619
Epoch: 35, Steps: 64 | Train Loss: 0.0721229 Vali Loss: 0.1867368 Test Loss: 0.2634998
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 36 cost time: 0.9096171855926514
Epoch: 36, Steps: 64 | Train Loss: 0.0721113 Vali Loss: 0.1882412 Test Loss: 0.2627671
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 37 cost time: 0.8994612693786621
Epoch: 37, Steps: 64 | Train Loss: 0.0717802 Vali Loss: 0.1891410 Test Loss: 0.2650247
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 38 cost time: 0.9003872871398926
Epoch: 38, Steps: 64 | Train Loss: 0.0716326 Vali Loss: 0.1861271 Test Loss: 0.2622355
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 39 cost time: 0.8963484764099121
Epoch: 39, Steps: 64 | Train Loss: 0.0718692 Vali Loss: 0.1875631 Test Loss: 0.2636580
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 40 cost time: 0.9113340377807617
Epoch: 40, Steps: 64 | Train Loss: 0.0717093 Vali Loss: 0.1860336 Test Loss: 0.2607861
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 41 cost time: 0.8969998359680176
Epoch: 41, Steps: 64 | Train Loss: 0.0719580 Vali Loss: 0.1882792 Test Loss: 0.2634460
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 42 cost time: 0.8929996490478516
Epoch: 42, Steps: 64 | Train Loss: 0.0719056 Vali Loss: 0.1862901 Test Loss: 0.2636885
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 43 cost time: 0.9066164493560791
Epoch: 43, Steps: 64 | Train Loss: 0.0714404 Vali Loss: 0.1861782 Test Loss: 0.2629343
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 44 cost time: 0.8984057903289795
Epoch: 44, Steps: 64 | Train Loss: 0.0715637 Vali Loss: 0.1870684 Test Loss: 0.2620787
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 45 cost time: 0.8893826007843018
Epoch: 45, Steps: 64 | Train Loss: 0.0716907 Vali Loss: 0.1842116 Test Loss: 0.2618684
Validation loss decreased (0.185290 --> 0.184212).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 46 cost time: 0.9094195365905762
Epoch: 46, Steps: 64 | Train Loss: 0.0715057 Vali Loss: 0.1850352 Test Loss: 0.2617678
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 47 cost time: 0.9017298221588135
Epoch: 47, Steps: 64 | Train Loss: 0.0716403 Vali Loss: 0.1873855 Test Loss: 0.2626493
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 48 cost time: 0.9690959453582764
Epoch: 48, Steps: 64 | Train Loss: 0.0714452 Vali Loss: 0.1866346 Test Loss: 0.2624858
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 49 cost time: 0.9489998817443848
Epoch: 49, Steps: 64 | Train Loss: 0.0716535 Vali Loss: 0.1873239 Test Loss: 0.2641877
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 50 cost time: 0.8986063003540039
Epoch: 50, Steps: 64 | Train Loss: 0.0712225 Vali Loss: 0.1863414 Test Loss: 0.2635118
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 51 cost time: 0.8993830680847168
Epoch: 51, Steps: 64 | Train Loss: 0.0714420 Vali Loss: 0.1866491 Test Loss: 0.2622792
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 52 cost time: 0.8981306552886963
Epoch: 52, Steps: 64 | Train Loss: 0.0719317 Vali Loss: 0.1862679 Test Loss: 0.2627011
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 53 cost time: 0.8983547687530518
Epoch: 53, Steps: 64 | Train Loss: 0.0715792 Vali Loss: 0.1860733 Test Loss: 0.2633344
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 54 cost time: 0.9130020141601562
Epoch: 54, Steps: 64 | Train Loss: 0.0717673 Vali Loss: 0.1851133 Test Loss: 0.2628037
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 55 cost time: 0.8980002403259277
Epoch: 55, Steps: 64 | Train Loss: 0.0717598 Vali Loss: 0.1893441 Test Loss: 0.2622299
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 56 cost time: 0.9009993076324463
Epoch: 56, Steps: 64 | Train Loss: 0.0713487 Vali Loss: 0.1838371 Test Loss: 0.2621238
Validation loss decreased (0.184212 --> 0.183837).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 57 cost time: 0.9106154441833496
Epoch: 57, Steps: 64 | Train Loss: 0.0716913 Vali Loss: 0.1889312 Test Loss: 0.2637026
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 58 cost time: 0.9005539417266846
Epoch: 58, Steps: 64 | Train Loss: 0.0715464 Vali Loss: 0.1863537 Test Loss: 0.2623761
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 59 cost time: 0.9013609886169434
Epoch: 59, Steps: 64 | Train Loss: 0.0716181 Vali Loss: 0.1871916 Test Loss: 0.2625385
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 60 cost time: 0.8971676826477051
Epoch: 60, Steps: 64 | Train Loss: 0.0714619 Vali Loss: 0.1869189 Test Loss: 0.2633911
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2621237337589264, mae:0.3277234733104706, rse:0.2349773347377777
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06185483932495117 GB
Epoch: 1 cost time: 2.2924306392669678
Epoch: 1, Steps: 64 | Train Loss: 0.8222309 Vali Loss: 2.5106895 Test Loss: 4.4380927
Validation loss decreased (inf --> 2.510689).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 2 cost time: 0.9274544715881348
Epoch: 2, Steps: 64 | Train Loss: 0.3258983 Vali Loss: 0.3431420 Test Loss: 0.3771555
Validation loss decreased (2.510689 --> 0.343142).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 3 cost time: 0.9290010929107666
Epoch: 3, Steps: 64 | Train Loss: 0.1050649 Vali Loss: 0.2474381 Test Loss: 0.2876448
Validation loss decreased (0.343142 --> 0.247438).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 4 cost time: 0.9286882877349854
Epoch: 4, Steps: 64 | Train Loss: 0.0921910 Vali Loss: 0.2390676 Test Loss: 0.2812171
Validation loss decreased (0.247438 --> 0.239068).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 5 cost time: 0.930457592010498
Epoch: 5, Steps: 64 | Train Loss: 0.0886087 Vali Loss: 0.2348462 Test Loss: 0.2754830
Validation loss decreased (0.239068 --> 0.234846).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 6 cost time: 0.9241273403167725
Epoch: 6, Steps: 64 | Train Loss: 0.0860952 Vali Loss: 0.2256830 Test Loss: 0.2743175
Validation loss decreased (0.234846 --> 0.225683).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 7 cost time: 0.924344539642334
Epoch: 7, Steps: 64 | Train Loss: 0.0845871 Vali Loss: 0.2262481 Test Loss: 0.2738967
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 8 cost time: 0.9222288131713867
Epoch: 8, Steps: 64 | Train Loss: 0.0825801 Vali Loss: 0.2247410 Test Loss: 0.2728965
Validation loss decreased (0.225683 --> 0.224741).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 9 cost time: 0.925391435623169
Epoch: 9, Steps: 64 | Train Loss: 0.0816236 Vali Loss: 0.2182652 Test Loss: 0.2709579
Validation loss decreased (0.224741 --> 0.218265).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 10 cost time: 0.9252867698669434
Epoch: 10, Steps: 64 | Train Loss: 0.0805060 Vali Loss: 0.2165213 Test Loss: 0.2711396
Validation loss decreased (0.218265 --> 0.216521).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 11 cost time: 0.9356169700622559
Epoch: 11, Steps: 64 | Train Loss: 0.0795226 Vali Loss: 0.2141178 Test Loss: 0.2717854
Validation loss decreased (0.216521 --> 0.214118).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 12 cost time: 0.9316344261169434
Epoch: 12, Steps: 64 | Train Loss: 0.0788251 Vali Loss: 0.2123667 Test Loss: 0.2719666
Validation loss decreased (0.214118 --> 0.212367).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 13 cost time: 0.9276103973388672
Epoch: 13, Steps: 64 | Train Loss: 0.0783866 Vali Loss: 0.2077583 Test Loss: 0.2698281
Validation loss decreased (0.212367 --> 0.207758).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 14 cost time: 0.931330680847168
Epoch: 14, Steps: 64 | Train Loss: 0.0773265 Vali Loss: 0.2084751 Test Loss: 0.2700139
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 15 cost time: 0.9337501525878906
Epoch: 15, Steps: 64 | Train Loss: 0.0770300 Vali Loss: 0.2069332 Test Loss: 0.2678676
Validation loss decreased (0.207758 --> 0.206933).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 16 cost time: 0.9275932312011719
Epoch: 16, Steps: 64 | Train Loss: 0.0766228 Vali Loss: 0.2047800 Test Loss: 0.2702219
Validation loss decreased (0.206933 --> 0.204780).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 17 cost time: 0.9244437217712402
Epoch: 17, Steps: 64 | Train Loss: 0.0761016 Vali Loss: 0.2044080 Test Loss: 0.2685297
Validation loss decreased (0.204780 --> 0.204408).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 18 cost time: 0.9427773952484131
Epoch: 18, Steps: 64 | Train Loss: 0.0754374 Vali Loss: 0.1995409 Test Loss: 0.2673882
Validation loss decreased (0.204408 --> 0.199541).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 19 cost time: 0.925163984298706
Epoch: 19, Steps: 64 | Train Loss: 0.0759287 Vali Loss: 0.2032461 Test Loss: 0.2678015
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 20 cost time: 0.9289991855621338
Epoch: 20, Steps: 64 | Train Loss: 0.0749087 Vali Loss: 0.1978750 Test Loss: 0.2673383
Validation loss decreased (0.199541 --> 0.197875).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 21 cost time: 0.9406156539916992
Epoch: 21, Steps: 64 | Train Loss: 0.0748016 Vali Loss: 0.1980279 Test Loss: 0.2660779
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 22 cost time: 0.9243931770324707
Epoch: 22, Steps: 64 | Train Loss: 0.0743628 Vali Loss: 0.1962151 Test Loss: 0.2674381
Validation loss decreased (0.197875 --> 0.196215).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 23 cost time: 0.9246211051940918
Epoch: 23, Steps: 64 | Train Loss: 0.0739772 Vali Loss: 0.1973695 Test Loss: 0.2670833
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 24 cost time: 0.9244363307952881
Epoch: 24, Steps: 64 | Train Loss: 0.0742394 Vali Loss: 0.1980722 Test Loss: 0.2672415
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 25 cost time: 0.9098658561706543
Epoch: 25, Steps: 64 | Train Loss: 0.0740447 Vali Loss: 0.1950063 Test Loss: 0.2659846
Validation loss decreased (0.196215 --> 0.195006).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 26 cost time: 0.9217302799224854
Epoch: 26, Steps: 64 | Train Loss: 0.0737814 Vali Loss: 0.1980254 Test Loss: 0.2658738
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 27 cost time: 0.9208776950836182
Epoch: 27, Steps: 64 | Train Loss: 0.0736370 Vali Loss: 0.1966581 Test Loss: 0.2655117
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 28 cost time: 0.9285805225372314
Epoch: 28, Steps: 64 | Train Loss: 0.0731958 Vali Loss: 0.1959161 Test Loss: 0.2656286
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 29 cost time: 0.8966562747955322
Epoch: 29, Steps: 64 | Train Loss: 0.0728573 Vali Loss: 0.1952985 Test Loss: 0.2652930
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 30 cost time: 0.903465747833252
Epoch: 30, Steps: 64 | Train Loss: 0.0732710 Vali Loss: 0.1951078 Test Loss: 0.2654008
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 31 cost time: 0.9263873100280762
Epoch: 31, Steps: 64 | Train Loss: 0.0729475 Vali Loss: 0.1924219 Test Loss: 0.2657850
Validation loss decreased (0.195006 --> 0.192422).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 32 cost time: 0.9225955009460449
Epoch: 32, Steps: 64 | Train Loss: 0.0727877 Vali Loss: 0.1908494 Test Loss: 0.2656976
Validation loss decreased (0.192422 --> 0.190849).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 33 cost time: 0.9233360290527344
Epoch: 33, Steps: 64 | Train Loss: 0.0727521 Vali Loss: 0.1928799 Test Loss: 0.2647377
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 34 cost time: 0.9208505153656006
Epoch: 34, Steps: 64 | Train Loss: 0.0727102 Vali Loss: 0.1935656 Test Loss: 0.2652569
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 35 cost time: 0.9389996528625488
Epoch: 35, Steps: 64 | Train Loss: 0.0728428 Vali Loss: 0.1929794 Test Loss: 0.2646682
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 36 cost time: 0.9244980812072754
Epoch: 36, Steps: 64 | Train Loss: 0.0724414 Vali Loss: 0.1909560 Test Loss: 0.2640123
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 37 cost time: 0.9246187210083008
Epoch: 37, Steps: 64 | Train Loss: 0.0727670 Vali Loss: 0.1930691 Test Loss: 0.2643316
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 38 cost time: 0.9434235095977783
Epoch: 38, Steps: 64 | Train Loss: 0.0725174 Vali Loss: 0.1949749 Test Loss: 0.2657681
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 39 cost time: 0.9213860034942627
Epoch: 39, Steps: 64 | Train Loss: 0.0726945 Vali Loss: 0.1931857 Test Loss: 0.2653095
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 40 cost time: 0.9233067035675049
Epoch: 40, Steps: 64 | Train Loss: 0.0725582 Vali Loss: 0.1918843 Test Loss: 0.2649313
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 41 cost time: 0.9266886711120605
Epoch: 41, Steps: 64 | Train Loss: 0.0728952 Vali Loss: 0.1901956 Test Loss: 0.2635197
Validation loss decreased (0.190849 --> 0.190196).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 42 cost time: 0.9365942478179932
Epoch: 42, Steps: 64 | Train Loss: 0.0724180 Vali Loss: 0.1900112 Test Loss: 0.2649413
Validation loss decreased (0.190196 --> 0.190011).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 43 cost time: 0.9219999313354492
Epoch: 43, Steps: 64 | Train Loss: 0.0724396 Vali Loss: 0.1914501 Test Loss: 0.2645246
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 44 cost time: 0.9220011234283447
Epoch: 44, Steps: 64 | Train Loss: 0.0723324 Vali Loss: 0.1916840 Test Loss: 0.2639721
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 45 cost time: 0.9181728363037109
Epoch: 45, Steps: 64 | Train Loss: 0.0721743 Vali Loss: 0.1907358 Test Loss: 0.2634299
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 46 cost time: 0.951300859451294
Epoch: 46, Steps: 64 | Train Loss: 0.0721348 Vali Loss: 0.1900319 Test Loss: 0.2637520
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 47 cost time: 0.9494123458862305
Epoch: 47, Steps: 64 | Train Loss: 0.0724214 Vali Loss: 0.1929816 Test Loss: 0.2644698
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 48 cost time: 0.9444441795349121
Epoch: 48, Steps: 64 | Train Loss: 0.0721533 Vali Loss: 0.1917469 Test Loss: 0.2644177
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 49 cost time: 0.9387149810791016
Epoch: 49, Steps: 64 | Train Loss: 0.0718773 Vali Loss: 0.1914694 Test Loss: 0.2649373
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 50 cost time: 0.9443187713623047
Epoch: 50, Steps: 64 | Train Loss: 0.0722426 Vali Loss: 0.1917176 Test Loss: 0.2648104
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 51 cost time: 0.9427318572998047
Epoch: 51, Steps: 64 | Train Loss: 0.0722857 Vali Loss: 0.1922799 Test Loss: 0.2638400
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 52 cost time: 0.932422399520874
Epoch: 52, Steps: 64 | Train Loss: 0.0724958 Vali Loss: 0.1896454 Test Loss: 0.2643876
Validation loss decreased (0.190011 --> 0.189645).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 53 cost time: 0.9280643463134766
Epoch: 53, Steps: 64 | Train Loss: 0.0722576 Vali Loss: 0.1912126 Test Loss: 0.2638726
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 54 cost time: 0.9266188144683838
Epoch: 54, Steps: 64 | Train Loss: 0.0723597 Vali Loss: 0.1921572 Test Loss: 0.2650524
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 55 cost time: 0.9354360103607178
Epoch: 55, Steps: 64 | Train Loss: 0.0723836 Vali Loss: 0.1932260 Test Loss: 0.2646310
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 56 cost time: 0.9264881610870361
Epoch: 56, Steps: 64 | Train Loss: 0.0722531 Vali Loss: 0.1926013 Test Loss: 0.2637551
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 57 cost time: 0.9194648265838623
Epoch: 57, Steps: 64 | Train Loss: 0.0721129 Vali Loss: 0.1918281 Test Loss: 0.2642393
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 58 cost time: 0.924414873123169
Epoch: 58, Steps: 64 | Train Loss: 0.0721787 Vali Loss: 0.1907631 Test Loss: 0.2638461
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 59 cost time: 0.932889461517334
Epoch: 59, Steps: 64 | Train Loss: 0.0720141 Vali Loss: 0.1908938 Test Loss: 0.2642751
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 60 cost time: 0.9260003566741943
Epoch: 60, Steps: 64 | Train Loss: 0.0722635 Vali Loss: 0.1921689 Test Loss: 0.2645616
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2643876075744629, mae:0.3283211290836334, rse:0.23598986864089966
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.054323673248291016 GB
Epoch: 1 cost time: 2.186875104904175
Epoch: 1, Steps: 64 | Train Loss: 0.8878653 Vali Loss: 2.5829434 Test Loss: 4.5656180
Validation loss decreased (inf --> 2.582943).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 2 cost time: 0.8272278308868408
Epoch: 2, Steps: 64 | Train Loss: 0.6473607 Vali Loss: 1.3067725 Test Loss: 2.1865070
Validation loss decreased (2.582943 --> 1.306772).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 3 cost time: 0.823828935623169
Epoch: 3, Steps: 64 | Train Loss: 0.3592306 Vali Loss: 0.7080771 Test Loss: 1.0829531
Validation loss decreased (1.306772 --> 0.708077).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 4 cost time: 0.8207259178161621
Epoch: 4, Steps: 64 | Train Loss: 0.2182180 Vali Loss: 0.4717173 Test Loss: 0.6874496
Validation loss decreased (0.708077 --> 0.471717).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 5 cost time: 0.818000316619873
Epoch: 5, Steps: 64 | Train Loss: 0.1534478 Vali Loss: 0.3489960 Test Loss: 0.4757031
Validation loss decreased (0.471717 --> 0.348996).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 6 cost time: 0.8146026134490967
Epoch: 6, Steps: 64 | Train Loss: 0.1258009 Vali Loss: 0.2928224 Test Loss: 0.3834036
Validation loss decreased (0.348996 --> 0.292822).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 7 cost time: 0.8163692951202393
Epoch: 7, Steps: 64 | Train Loss: 0.1133095 Vali Loss: 0.2621947 Test Loss: 0.3360411
Validation loss decreased (0.292822 --> 0.262195).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 8 cost time: 0.8183598518371582
Epoch: 8, Steps: 64 | Train Loss: 0.1068706 Vali Loss: 0.2481922 Test Loss: 0.3161826
Validation loss decreased (0.262195 --> 0.248192).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 9 cost time: 0.8167486190795898
Epoch: 9, Steps: 64 | Train Loss: 0.1026510 Vali Loss: 0.2376350 Test Loss: 0.3023701
Validation loss decreased (0.248192 --> 0.237635).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 10 cost time: 0.7931616306304932
Epoch: 10, Steps: 64 | Train Loss: 0.1004335 Vali Loss: 0.2391447 Test Loss: 0.2995342
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 11 cost time: 0.812934398651123
Epoch: 11, Steps: 64 | Train Loss: 0.0985194 Vali Loss: 0.2317682 Test Loss: 0.2970964
Validation loss decreased (0.237635 --> 0.231768).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 12 cost time: 0.8139946460723877
Epoch: 12, Steps: 64 | Train Loss: 0.0970922 Vali Loss: 0.2288749 Test Loss: 0.2906451
Validation loss decreased (0.231768 --> 0.228875).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 13 cost time: 0.8127851486206055
Epoch: 13, Steps: 64 | Train Loss: 0.0953873 Vali Loss: 0.2267251 Test Loss: 0.2900038
Validation loss decreased (0.228875 --> 0.226725).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 14 cost time: 0.826998233795166
Epoch: 14, Steps: 64 | Train Loss: 0.0947661 Vali Loss: 0.2256481 Test Loss: 0.2887145
Validation loss decreased (0.226725 --> 0.225648).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 15 cost time: 0.8096439838409424
Epoch: 15, Steps: 64 | Train Loss: 0.0939973 Vali Loss: 0.2258606 Test Loss: 0.2893411
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 16 cost time: 0.8001723289489746
Epoch: 16, Steps: 64 | Train Loss: 0.0926820 Vali Loss: 0.2269924 Test Loss: 0.2870495
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 17 cost time: 0.8053209781646729
Epoch: 17, Steps: 64 | Train Loss: 0.0925991 Vali Loss: 0.2226837 Test Loss: 0.2879703
Validation loss decreased (0.225648 --> 0.222684).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 18 cost time: 0.8101732730865479
Epoch: 18, Steps: 64 | Train Loss: 0.0923013 Vali Loss: 0.2229705 Test Loss: 0.2869097
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 19 cost time: 0.8026249408721924
Epoch: 19, Steps: 64 | Train Loss: 0.0914762 Vali Loss: 0.2228779 Test Loss: 0.2866096
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 20 cost time: 0.8356847763061523
Epoch: 20, Steps: 64 | Train Loss: 0.0911018 Vali Loss: 0.2221434 Test Loss: 0.2857047
Validation loss decreased (0.222684 --> 0.222143).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 21 cost time: 0.811192512512207
Epoch: 21, Steps: 64 | Train Loss: 0.0903218 Vali Loss: 0.2202302 Test Loss: 0.2855723
Validation loss decreased (0.222143 --> 0.220230).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 22 cost time: 0.8118970394134521
Epoch: 22, Steps: 64 | Train Loss: 0.0903671 Vali Loss: 0.2185883 Test Loss: 0.2846661
Validation loss decreased (0.220230 --> 0.218588).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 23 cost time: 0.8109993934631348
Epoch: 23, Steps: 64 | Train Loss: 0.0895515 Vali Loss: 0.2210219 Test Loss: 0.2849554
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 24 cost time: 0.8122079372406006
Epoch: 24, Steps: 64 | Train Loss: 0.0894963 Vali Loss: 0.2180471 Test Loss: 0.2852164
Validation loss decreased (0.218588 --> 0.218047).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 25 cost time: 0.8093690872192383
Epoch: 25, Steps: 64 | Train Loss: 0.0890524 Vali Loss: 0.2211881 Test Loss: 0.2846468
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 26 cost time: 0.7844030857086182
Epoch: 26, Steps: 64 | Train Loss: 0.0896002 Vali Loss: 0.2160558 Test Loss: 0.2849174
Validation loss decreased (0.218047 --> 0.216056).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 27 cost time: 0.804999589920044
Epoch: 27, Steps: 64 | Train Loss: 0.0884104 Vali Loss: 0.2170644 Test Loss: 0.2832556
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 28 cost time: 0.8046114444732666
Epoch: 28, Steps: 64 | Train Loss: 0.0885736 Vali Loss: 0.2167492 Test Loss: 0.2827761
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 29 cost time: 0.8093998432159424
Epoch: 29, Steps: 64 | Train Loss: 0.0882487 Vali Loss: 0.2187186 Test Loss: 0.2831486
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 30 cost time: 0.8103678226470947
Epoch: 30, Steps: 64 | Train Loss: 0.0883255 Vali Loss: 0.2186968 Test Loss: 0.2861269
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 31 cost time: 0.8094484806060791
Epoch: 31, Steps: 64 | Train Loss: 0.0879844 Vali Loss: 0.2161624 Test Loss: 0.2830679
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 32 cost time: 0.8110074996948242
Epoch: 32, Steps: 64 | Train Loss: 0.0883463 Vali Loss: 0.2153713 Test Loss: 0.2829430
Validation loss decreased (0.216056 --> 0.215371).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 33 cost time: 0.8144199848175049
Epoch: 33, Steps: 64 | Train Loss: 0.0881970 Vali Loss: 0.2162223 Test Loss: 0.2820847
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 34 cost time: 0.883831262588501
Epoch: 34, Steps: 64 | Train Loss: 0.0876237 Vali Loss: 0.2165695 Test Loss: 0.2836402
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 35 cost time: 0.8758502006530762
Epoch: 35, Steps: 64 | Train Loss: 0.0877478 Vali Loss: 0.2158339 Test Loss: 0.2832472
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 36 cost time: 0.8808701038360596
Epoch: 36, Steps: 64 | Train Loss: 0.0874743 Vali Loss: 0.2154939 Test Loss: 0.2830581
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 37 cost time: 0.833364725112915
Epoch: 37, Steps: 64 | Train Loss: 0.0873245 Vali Loss: 0.2130131 Test Loss: 0.2819215
Validation loss decreased (0.215371 --> 0.213013).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 38 cost time: 0.8215959072113037
Epoch: 38, Steps: 64 | Train Loss: 0.0870101 Vali Loss: 0.2172099 Test Loss: 0.2820878
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 39 cost time: 0.8243238925933838
Epoch: 39, Steps: 64 | Train Loss: 0.0874263 Vali Loss: 0.2139879 Test Loss: 0.2839237
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 40 cost time: 0.8338994979858398
Epoch: 40, Steps: 64 | Train Loss: 0.0873650 Vali Loss: 0.2172958 Test Loss: 0.2828147
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 41 cost time: 0.8259997367858887
Epoch: 41, Steps: 64 | Train Loss: 0.0877415 Vali Loss: 0.2145416 Test Loss: 0.2820730
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 42 cost time: 0.8245968818664551
Epoch: 42, Steps: 64 | Train Loss: 0.0873309 Vali Loss: 0.2179491 Test Loss: 0.2823358
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 43 cost time: 0.8245108127593994
Epoch: 43, Steps: 64 | Train Loss: 0.0870174 Vali Loss: 0.2124808 Test Loss: 0.2830495
Validation loss decreased (0.213013 --> 0.212481).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 44 cost time: 0.8243274688720703
Epoch: 44, Steps: 64 | Train Loss: 0.0872025 Vali Loss: 0.2136660 Test Loss: 0.2817858
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 45 cost time: 0.821345329284668
Epoch: 45, Steps: 64 | Train Loss: 0.0870487 Vali Loss: 0.2162415 Test Loss: 0.2828239
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 46 cost time: 0.820000171661377
Epoch: 46, Steps: 64 | Train Loss: 0.0870788 Vali Loss: 0.2135966 Test Loss: 0.2823135
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 47 cost time: 0.8216090202331543
Epoch: 47, Steps: 64 | Train Loss: 0.0866199 Vali Loss: 0.2162357 Test Loss: 0.2822870
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 48 cost time: 0.833310604095459
Epoch: 48, Steps: 64 | Train Loss: 0.0863646 Vali Loss: 0.2162699 Test Loss: 0.2810186
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 49 cost time: 0.8288171291351318
Epoch: 49, Steps: 64 | Train Loss: 0.0865033 Vali Loss: 0.2137166 Test Loss: 0.2841710
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 50 cost time: 0.8299996852874756
Epoch: 50, Steps: 64 | Train Loss: 0.0866412 Vali Loss: 0.2139186 Test Loss: 0.2816714
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 51 cost time: 0.8299994468688965
Epoch: 51, Steps: 64 | Train Loss: 0.0866641 Vali Loss: 0.2166376 Test Loss: 0.2834603
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 52 cost time: 0.8184025287628174
Epoch: 52, Steps: 64 | Train Loss: 0.0865622 Vali Loss: 0.2139723 Test Loss: 0.2825588
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 53 cost time: 0.8263752460479736
Epoch: 53, Steps: 64 | Train Loss: 0.0865503 Vali Loss: 0.2190208 Test Loss: 0.2825066
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 54 cost time: 0.823359489440918
Epoch: 54, Steps: 64 | Train Loss: 0.0870829 Vali Loss: 0.2158761 Test Loss: 0.2822937
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 55 cost time: 0.8179998397827148
Epoch: 55, Steps: 64 | Train Loss: 0.0868051 Vali Loss: 0.2164938 Test Loss: 0.2824488
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 56 cost time: 0.8026032447814941
Epoch: 56, Steps: 64 | Train Loss: 0.0866563 Vali Loss: 0.2159200 Test Loss: 0.2828383
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 57 cost time: 0.8183059692382812
Epoch: 57, Steps: 64 | Train Loss: 0.0871311 Vali Loss: 0.2173803 Test Loss: 0.2819310
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 58 cost time: 0.826319694519043
Epoch: 58, Steps: 64 | Train Loss: 0.0869304 Vali Loss: 0.2160621 Test Loss: 0.2835116
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 59 cost time: 0.8319320678710938
Epoch: 59, Steps: 64 | Train Loss: 0.0864568 Vali Loss: 0.2154711 Test Loss: 0.2831247
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 60 cost time: 0.8128907680511475
Epoch: 60, Steps: 64 | Train Loss: 0.0867018 Vali Loss: 0.2176712 Test Loss: 0.2826363
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.28304946422576904, mae:0.3420429825782776, rse:0.24417656660079956
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.058718204498291016 GB
Epoch: 1 cost time: 2.3398947715759277
Epoch: 1, Steps: 64 | Train Loss: 0.7903943 Vali Loss: 2.3884525 Test Loss: 4.1711478
Validation loss decreased (inf --> 2.388453).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 2 cost time: 0.9313724040985107
Epoch: 2, Steps: 64 | Train Loss: 0.3485512 Vali Loss: 0.2955320 Test Loss: 0.3052426
Validation loss decreased (2.388453 --> 0.295532).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 3 cost time: 0.9330000877380371
Epoch: 3, Steps: 64 | Train Loss: 0.1050542 Vali Loss: 0.2429774 Test Loss: 0.2964172
Validation loss decreased (0.295532 --> 0.242977).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 4 cost time: 0.9328052997589111
Epoch: 4, Steps: 64 | Train Loss: 0.0937904 Vali Loss: 0.2336250 Test Loss: 0.2836466
Validation loss decreased (0.242977 --> 0.233625).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 5 cost time: 0.9370348453521729
Epoch: 5, Steps: 64 | Train Loss: 0.0894788 Vali Loss: 0.2276644 Test Loss: 0.2791676
Validation loss decreased (0.233625 --> 0.227664).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 6 cost time: 0.9288539886474609
Epoch: 6, Steps: 64 | Train Loss: 0.0867885 Vali Loss: 0.2259361 Test Loss: 0.2770866
Validation loss decreased (0.227664 --> 0.225936).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 7 cost time: 0.9267950057983398
Epoch: 7, Steps: 64 | Train Loss: 0.0850065 Vali Loss: 0.2188872 Test Loss: 0.2813525
Validation loss decreased (0.225936 --> 0.218887).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 8 cost time: 0.931999921798706
Epoch: 8, Steps: 64 | Train Loss: 0.0832784 Vali Loss: 0.2146052 Test Loss: 0.2796491
Validation loss decreased (0.218887 --> 0.214605).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 9 cost time: 0.9373555183410645
Epoch: 9, Steps: 64 | Train Loss: 0.0817553 Vali Loss: 0.2082378 Test Loss: 0.2818483
Validation loss decreased (0.214605 --> 0.208238).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 10 cost time: 0.9393362998962402
Epoch: 10, Steps: 64 | Train Loss: 0.0811464 Vali Loss: 0.2090140 Test Loss: 0.2784987
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 11 cost time: 0.9333651065826416
Epoch: 11, Steps: 64 | Train Loss: 0.0794147 Vali Loss: 0.2063641 Test Loss: 0.2834832
Validation loss decreased (0.208238 --> 0.206364).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 12 cost time: 0.9333343505859375
Epoch: 12, Steps: 64 | Train Loss: 0.0791725 Vali Loss: 0.2033593 Test Loss: 0.2809564
Validation loss decreased (0.206364 --> 0.203359).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 13 cost time: 0.9395492076873779
Epoch: 13, Steps: 64 | Train Loss: 0.0781022 Vali Loss: 0.2020052 Test Loss: 0.2807587
Validation loss decreased (0.203359 --> 0.202005).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 14 cost time: 0.9324042797088623
Epoch: 14, Steps: 64 | Train Loss: 0.0770510 Vali Loss: 0.2028981 Test Loss: 0.2818244
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 15 cost time: 0.9277112483978271
Epoch: 15, Steps: 64 | Train Loss: 0.0764594 Vali Loss: 0.1982440 Test Loss: 0.2831521
Validation loss decreased (0.202005 --> 0.198244).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 16 cost time: 0.9290001392364502
Epoch: 16, Steps: 64 | Train Loss: 0.0763756 Vali Loss: 0.1966947 Test Loss: 0.2819759
Validation loss decreased (0.198244 --> 0.196695).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 17 cost time: 0.9309999942779541
Epoch: 17, Steps: 64 | Train Loss: 0.0757602 Vali Loss: 0.1961509 Test Loss: 0.2821087
Validation loss decreased (0.196695 --> 0.196151).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 18 cost time: 0.9305002689361572
Epoch: 18, Steps: 64 | Train Loss: 0.0752475 Vali Loss: 0.1958990 Test Loss: 0.2821137
Validation loss decreased (0.196151 --> 0.195899).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 19 cost time: 0.932337760925293
Epoch: 19, Steps: 64 | Train Loss: 0.0746507 Vali Loss: 0.1924128 Test Loss: 0.2816004
Validation loss decreased (0.195899 --> 0.192413).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 20 cost time: 0.9383435249328613
Epoch: 20, Steps: 64 | Train Loss: 0.0743507 Vali Loss: 0.1936633 Test Loss: 0.2826505
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 21 cost time: 0.9326560497283936
Epoch: 21, Steps: 64 | Train Loss: 0.0737814 Vali Loss: 0.1949989 Test Loss: 0.2827947
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 22 cost time: 0.9259636402130127
Epoch: 22, Steps: 64 | Train Loss: 0.0739426 Vali Loss: 0.1950058 Test Loss: 0.2817523
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 23 cost time: 0.93631911277771
Epoch: 23, Steps: 64 | Train Loss: 0.0734082 Vali Loss: 0.1943838 Test Loss: 0.2823738
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 24 cost time: 0.9288351535797119
Epoch: 24, Steps: 64 | Train Loss: 0.0735856 Vali Loss: 0.1917100 Test Loss: 0.2808892
Validation loss decreased (0.192413 --> 0.191710).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 25 cost time: 0.929999828338623
Epoch: 25, Steps: 64 | Train Loss: 0.0732119 Vali Loss: 0.1924601 Test Loss: 0.2817200
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 26 cost time: 0.9295957088470459
Epoch: 26, Steps: 64 | Train Loss: 0.0731638 Vali Loss: 0.1901012 Test Loss: 0.2820261
Validation loss decreased (0.191710 --> 0.190101).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 27 cost time: 0.9150915145874023
Epoch: 27, Steps: 64 | Train Loss: 0.0734018 Vali Loss: 0.1935904 Test Loss: 0.2819006
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 28 cost time: 0.9275238513946533
Epoch: 28, Steps: 64 | Train Loss: 0.0728483 Vali Loss: 0.1898799 Test Loss: 0.2807480
Validation loss decreased (0.190101 --> 0.189880).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 29 cost time: 0.9143598079681396
Epoch: 29, Steps: 64 | Train Loss: 0.0725112 Vali Loss: 0.1873420 Test Loss: 0.2814431
Validation loss decreased (0.189880 --> 0.187342).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 30 cost time: 0.9183588027954102
Epoch: 30, Steps: 64 | Train Loss: 0.0726376 Vali Loss: 0.1899054 Test Loss: 0.2812900
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 31 cost time: 0.9058220386505127
Epoch: 31, Steps: 64 | Train Loss: 0.0728550 Vali Loss: 0.1906978 Test Loss: 0.2812592
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 32 cost time: 0.9130005836486816
Epoch: 32, Steps: 64 | Train Loss: 0.0725153 Vali Loss: 0.1885494 Test Loss: 0.2811405
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 33 cost time: 0.9090006351470947
Epoch: 33, Steps: 64 | Train Loss: 0.0728331 Vali Loss: 0.1880862 Test Loss: 0.2810360
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 34 cost time: 0.9276177883148193
Epoch: 34, Steps: 64 | Train Loss: 0.0722509 Vali Loss: 0.1885186 Test Loss: 0.2811673
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 35 cost time: 0.9136664867401123
Epoch: 35, Steps: 64 | Train Loss: 0.0721876 Vali Loss: 0.1881351 Test Loss: 0.2810147
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 36 cost time: 0.9163587093353271
Epoch: 36, Steps: 64 | Train Loss: 0.0724266 Vali Loss: 0.1901097 Test Loss: 0.2816328
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 37 cost time: 0.9214282035827637
Epoch: 37, Steps: 64 | Train Loss: 0.0723924 Vali Loss: 0.1896928 Test Loss: 0.2816857
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 38 cost time: 0.9173519611358643
Epoch: 38, Steps: 64 | Train Loss: 0.0722934 Vali Loss: 0.1880037 Test Loss: 0.2812596
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 39 cost time: 0.9118161201477051
Epoch: 39, Steps: 64 | Train Loss: 0.0722373 Vali Loss: 0.1918628 Test Loss: 0.2815643
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 40 cost time: 0.9090001583099365
Epoch: 40, Steps: 64 | Train Loss: 0.0720565 Vali Loss: 0.1900875 Test Loss: 0.2810937
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 41 cost time: 0.9120001792907715
Epoch: 41, Steps: 64 | Train Loss: 0.0720944 Vali Loss: 0.1888399 Test Loss: 0.2810553
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 42 cost time: 0.911625862121582
Epoch: 42, Steps: 64 | Train Loss: 0.0719105 Vali Loss: 0.1881876 Test Loss: 0.2811154
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 43 cost time: 0.9163625240325928
Epoch: 43, Steps: 64 | Train Loss: 0.0719974 Vali Loss: 0.1892697 Test Loss: 0.2808996
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 44 cost time: 0.9193451404571533
Epoch: 44, Steps: 64 | Train Loss: 0.0720402 Vali Loss: 0.1870815 Test Loss: 0.2804339
Validation loss decreased (0.187342 --> 0.187082).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 45 cost time: 0.9164266586303711
Epoch: 45, Steps: 64 | Train Loss: 0.0717399 Vali Loss: 0.1895940 Test Loss: 0.2809933
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 46 cost time: 0.9097208976745605
Epoch: 46, Steps: 64 | Train Loss: 0.0719647 Vali Loss: 0.1883382 Test Loss: 0.2808917
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 47 cost time: 0.9147677421569824
Epoch: 47, Steps: 64 | Train Loss: 0.0719307 Vali Loss: 0.1882699 Test Loss: 0.2812623
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 48 cost time: 0.9047682285308838
Epoch: 48, Steps: 64 | Train Loss: 0.0718973 Vali Loss: 0.1883894 Test Loss: 0.2811979
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 49 cost time: 0.9106149673461914
Epoch: 49, Steps: 64 | Train Loss: 0.0718578 Vali Loss: 0.1863776 Test Loss: 0.2806076
Validation loss decreased (0.187082 --> 0.186378).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 50 cost time: 0.9146034717559814
Epoch: 50, Steps: 64 | Train Loss: 0.0720342 Vali Loss: 0.1878080 Test Loss: 0.2812381
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 51 cost time: 0.911353588104248
Epoch: 51, Steps: 64 | Train Loss: 0.0719666 Vali Loss: 0.1883506 Test Loss: 0.2809639
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 52 cost time: 0.9144730567932129
Epoch: 52, Steps: 64 | Train Loss: 0.0717973 Vali Loss: 0.1872708 Test Loss: 0.2806808
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 53 cost time: 0.9169642925262451
Epoch: 53, Steps: 64 | Train Loss: 0.0720605 Vali Loss: 0.1880993 Test Loss: 0.2807977
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 54 cost time: 0.9207799434661865
Epoch: 54, Steps: 64 | Train Loss: 0.0721618 Vali Loss: 0.1875912 Test Loss: 0.2809201
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 55 cost time: 0.9129998683929443
Epoch: 55, Steps: 64 | Train Loss: 0.0716853 Vali Loss: 0.1892614 Test Loss: 0.2806312
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 56 cost time: 0.9126231670379639
Epoch: 56, Steps: 64 | Train Loss: 0.0715901 Vali Loss: 0.1883131 Test Loss: 0.2804607
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 57 cost time: 0.9130129814147949
Epoch: 57, Steps: 64 | Train Loss: 0.0719960 Vali Loss: 0.1893842 Test Loss: 0.2808769
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 58 cost time: 0.9197096824645996
Epoch: 58, Steps: 64 | Train Loss: 0.0718066 Vali Loss: 0.1877801 Test Loss: 0.2812254
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 59 cost time: 0.9143378734588623
Epoch: 59, Steps: 64 | Train Loss: 0.0718189 Vali Loss: 0.1867677 Test Loss: 0.2801268
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 60 cost time: 0.9084234237670898
Epoch: 60, Steps: 64 | Train Loss: 0.0721225 Vali Loss: 0.1894122 Test Loss: 0.2811839
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2806076109409332, mae:0.33973774313926697, rse:0.24312102794647217
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.062016963958740234 GB
Epoch: 1 cost time: 2.3957014083862305
Epoch: 1, Steps: 64 | Train Loss: 0.7665609 Vali Loss: 2.3492641 Test Loss: 4.1128559
Validation loss decreased (inf --> 2.349264).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 2 cost time: 0.9491138458251953
Epoch: 2, Steps: 64 | Train Loss: 0.3040443 Vali Loss: 0.3419456 Test Loss: 0.4014333
Validation loss decreased (2.349264 --> 0.341946).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 3 cost time: 0.9463224411010742
Epoch: 3, Steps: 64 | Train Loss: 0.1042670 Vali Loss: 0.2458330 Test Loss: 0.2789872
Validation loss decreased (0.341946 --> 0.245833).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 4 cost time: 0.9440000057220459
Epoch: 4, Steps: 64 | Train Loss: 0.0917002 Vali Loss: 0.2279443 Test Loss: 0.2853589
Validation loss decreased (0.245833 --> 0.227944).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 5 cost time: 0.9384427070617676
Epoch: 5, Steps: 64 | Train Loss: 0.0874969 Vali Loss: 0.2238680 Test Loss: 0.2798539
Validation loss decreased (0.227944 --> 0.223868).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 6 cost time: 0.9412455558776855
Epoch: 6, Steps: 64 | Train Loss: 0.0852233 Vali Loss: 0.2145319 Test Loss: 0.2765634
Validation loss decreased (0.223868 --> 0.214532).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 7 cost time: 0.942373514175415
Epoch: 7, Steps: 64 | Train Loss: 0.0832996 Vali Loss: 0.2155974 Test Loss: 0.2785980
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 8 cost time: 0.9287679195404053
Epoch: 8, Steps: 64 | Train Loss: 0.0814185 Vali Loss: 0.2064845 Test Loss: 0.2793709
Validation loss decreased (0.214532 --> 0.206484).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 9 cost time: 0.9413955211639404
Epoch: 9, Steps: 64 | Train Loss: 0.0805008 Vali Loss: 0.2080872 Test Loss: 0.2808625
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 10 cost time: 0.9454009532928467
Epoch: 10, Steps: 64 | Train Loss: 0.0788417 Vali Loss: 0.2059705 Test Loss: 0.2781755
Validation loss decreased (0.206484 --> 0.205970).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 11 cost time: 0.9575028419494629
Epoch: 11, Steps: 64 | Train Loss: 0.0782282 Vali Loss: 0.1988030 Test Loss: 0.2786973
Validation loss decreased (0.205970 --> 0.198803).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 12 cost time: 0.94482421875
Epoch: 12, Steps: 64 | Train Loss: 0.0768562 Vali Loss: 0.1982903 Test Loss: 0.2798518
Validation loss decreased (0.198803 --> 0.198290).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 13 cost time: 0.9467480182647705
Epoch: 13, Steps: 64 | Train Loss: 0.0761899 Vali Loss: 0.1954765 Test Loss: 0.2794232
Validation loss decreased (0.198290 --> 0.195477).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 14 cost time: 0.9370310306549072
Epoch: 14, Steps: 64 | Train Loss: 0.0755988 Vali Loss: 0.1947411 Test Loss: 0.2809787
Validation loss decreased (0.195477 --> 0.194741).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 15 cost time: 0.9356231689453125
Epoch: 15, Steps: 64 | Train Loss: 0.0751200 Vali Loss: 0.1951793 Test Loss: 0.2777670
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 16 cost time: 0.936345100402832
Epoch: 16, Steps: 64 | Train Loss: 0.0742006 Vali Loss: 0.1914137 Test Loss: 0.2770538
Validation loss decreased (0.194741 --> 0.191414).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 17 cost time: 0.9393408298492432
Epoch: 17, Steps: 64 | Train Loss: 0.0741640 Vali Loss: 0.1916121 Test Loss: 0.2768159
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 18 cost time: 0.9490830898284912
Epoch: 18, Steps: 64 | Train Loss: 0.0742348 Vali Loss: 0.1912898 Test Loss: 0.2768764
Validation loss decreased (0.191414 --> 0.191290).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 19 cost time: 0.9714369773864746
Epoch: 19, Steps: 64 | Train Loss: 0.0738823 Vali Loss: 0.1912306 Test Loss: 0.2753356
Validation loss decreased (0.191290 --> 0.191231).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 20 cost time: 0.9483740329742432
Epoch: 20, Steps: 64 | Train Loss: 0.0731435 Vali Loss: 0.1915022 Test Loss: 0.2765164
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 21 cost time: 0.9534752368927002
Epoch: 21, Steps: 64 | Train Loss: 0.0731341 Vali Loss: 0.1860595 Test Loss: 0.2773572
Validation loss decreased (0.191231 --> 0.186060).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 22 cost time: 0.923865795135498
Epoch: 22, Steps: 64 | Train Loss: 0.0727531 Vali Loss: 0.1885562 Test Loss: 0.2752834
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 23 cost time: 0.9299981594085693
Epoch: 23, Steps: 64 | Train Loss: 0.0721439 Vali Loss: 0.1872602 Test Loss: 0.2761093
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 24 cost time: 0.9370002746582031
Epoch: 24, Steps: 64 | Train Loss: 0.0722416 Vali Loss: 0.1893144 Test Loss: 0.2759182
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 25 cost time: 0.9056258201599121
Epoch: 25, Steps: 64 | Train Loss: 0.0719621 Vali Loss: 0.1887383 Test Loss: 0.2746589
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 26 cost time: 0.942171573638916
Epoch: 26, Steps: 64 | Train Loss: 0.0718952 Vali Loss: 0.1880413 Test Loss: 0.2755061
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 27 cost time: 0.9403512477874756
Epoch: 27, Steps: 64 | Train Loss: 0.0719942 Vali Loss: 0.1865091 Test Loss: 0.2751613
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 28 cost time: 0.9395363330841064
Epoch: 28, Steps: 64 | Train Loss: 0.0721575 Vali Loss: 0.1877181 Test Loss: 0.2748791
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 29 cost time: 0.9023685455322266
Epoch: 29, Steps: 64 | Train Loss: 0.0718530 Vali Loss: 0.1876641 Test Loss: 0.2747630
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 30 cost time: 0.9347150325775146
Epoch: 30, Steps: 64 | Train Loss: 0.0718967 Vali Loss: 0.1890219 Test Loss: 0.2752846
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 31 cost time: 0.9465587139129639
Epoch: 31, Steps: 64 | Train Loss: 0.0716296 Vali Loss: 0.1874661 Test Loss: 0.2748287
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 32 cost time: 0.9390013217926025
Epoch: 32, Steps: 64 | Train Loss: 0.0714717 Vali Loss: 0.1831153 Test Loss: 0.2733443
Validation loss decreased (0.186060 --> 0.183115).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 33 cost time: 0.934624433517456
Epoch: 33, Steps: 64 | Train Loss: 0.0719815 Vali Loss: 0.1843767 Test Loss: 0.2740999
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 34 cost time: 0.9386320114135742
Epoch: 34, Steps: 64 | Train Loss: 0.0711797 Vali Loss: 0.1852373 Test Loss: 0.2736553
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 35 cost time: 0.9614276885986328
Epoch: 35, Steps: 64 | Train Loss: 0.0709038 Vali Loss: 0.1845652 Test Loss: 0.2733780
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 36 cost time: 0.9473671913146973
Epoch: 36, Steps: 64 | Train Loss: 0.0713243 Vali Loss: 0.1859943 Test Loss: 0.2733341
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 37 cost time: 0.9423794746398926
Epoch: 37, Steps: 64 | Train Loss: 0.0714082 Vali Loss: 0.1867376 Test Loss: 0.2737285
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 38 cost time: 0.9563319683074951
Epoch: 38, Steps: 64 | Train Loss: 0.0710529 Vali Loss: 0.1862180 Test Loss: 0.2736400
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 39 cost time: 0.9429006576538086
Epoch: 39, Steps: 64 | Train Loss: 0.0711003 Vali Loss: 0.1855961 Test Loss: 0.2729269
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 40 cost time: 0.9367730617523193
Epoch: 40, Steps: 64 | Train Loss: 0.0710526 Vali Loss: 0.1874709 Test Loss: 0.2739549
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 41 cost time: 0.9380013942718506
Epoch: 41, Steps: 64 | Train Loss: 0.0712586 Vali Loss: 0.1860480 Test Loss: 0.2733690
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 42 cost time: 0.9456214904785156
Epoch: 42, Steps: 64 | Train Loss: 0.0711550 Vali Loss: 0.1873216 Test Loss: 0.2731765
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 43 cost time: 0.9410643577575684
Epoch: 43, Steps: 64 | Train Loss: 0.0710682 Vali Loss: 0.1870003 Test Loss: 0.2731802
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 44 cost time: 0.9403796195983887
Epoch: 44, Steps: 64 | Train Loss: 0.0711815 Vali Loss: 0.1868653 Test Loss: 0.2733005
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 45 cost time: 0.9303784370422363
Epoch: 45, Steps: 64 | Train Loss: 0.0710569 Vali Loss: 0.1852302 Test Loss: 0.2731061
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 46 cost time: 0.9393644332885742
Epoch: 46, Steps: 64 | Train Loss: 0.0711335 Vali Loss: 0.1862507 Test Loss: 0.2728719
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 47 cost time: 0.9363462924957275
Epoch: 47, Steps: 64 | Train Loss: 0.0712348 Vali Loss: 0.1862126 Test Loss: 0.2729101
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 48 cost time: 0.9423677921295166
Epoch: 48, Steps: 64 | Train Loss: 0.0708399 Vali Loss: 0.1858844 Test Loss: 0.2725697
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 49 cost time: 0.938378095626831
Epoch: 49, Steps: 64 | Train Loss: 0.0711443 Vali Loss: 0.1844564 Test Loss: 0.2725829
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 50 cost time: 0.9380002021789551
Epoch: 50, Steps: 64 | Train Loss: 0.0708713 Vali Loss: 0.1875314 Test Loss: 0.2729339
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 51 cost time: 0.9440791606903076
Epoch: 51, Steps: 64 | Train Loss: 0.0710258 Vali Loss: 0.1850237 Test Loss: 0.2729722
EarlyStopping counter: 19 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 52 cost time: 0.9416131973266602
Epoch: 52, Steps: 64 | Train Loss: 0.0708842 Vali Loss: 0.1850263 Test Loss: 0.2730088
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 53 cost time: 0.9444010257720947
Epoch: 53, Steps: 64 | Train Loss: 0.0709745 Vali Loss: 0.1868049 Test Loss: 0.2731990
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 54 cost time: 0.9443836212158203
Epoch: 54, Steps: 64 | Train Loss: 0.0704657 Vali Loss: 0.1843239 Test Loss: 0.2729792
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 55 cost time: 0.947150468826294
Epoch: 55, Steps: 64 | Train Loss: 0.0708123 Vali Loss: 0.1849130 Test Loss: 0.2728778
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 56 cost time: 0.9344112873077393
Epoch: 56, Steps: 64 | Train Loss: 0.0709734 Vali Loss: 0.1869435 Test Loss: 0.2732749
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 57 cost time: 0.935391902923584
Epoch: 57, Steps: 64 | Train Loss: 0.0706516 Vali Loss: 0.1862359 Test Loss: 0.2729973
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 58 cost time: 0.949847936630249
Epoch: 58, Steps: 64 | Train Loss: 0.0710847 Vali Loss: 0.1855956 Test Loss: 0.2726735
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 59 cost time: 0.9466171264648438
Epoch: 59, Steps: 64 | Train Loss: 0.0709400 Vali Loss: 0.1861615 Test Loss: 0.2733436
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 60 cost time: 0.942620038986206
Epoch: 60, Steps: 64 | Train Loss: 0.0709060 Vali Loss: 0.1862538 Test Loss: 0.2732573
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.27334433794021606, mae:0.33441537618637085, rse:0.2399539053440094
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054485321044921875 GB
Epoch: 1 cost time: 2.2456862926483154
Epoch: 1, Steps: 64 | Train Loss: 0.9631271 Vali Loss: 2.8585849 Test Loss: 5.0272765
Validation loss decreased (inf --> 2.858585).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 2 cost time: 0.8591196537017822
Epoch: 2, Steps: 64 | Train Loss: 0.6277108 Vali Loss: 1.1251645 Test Loss: 1.8037928
Validation loss decreased (2.858585 --> 1.125165).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 3 cost time: 0.8784143924713135
Epoch: 3, Steps: 64 | Train Loss: 0.3288761 Vali Loss: 0.7312060 Test Loss: 1.1094290
Validation loss decreased (1.125165 --> 0.731206).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 4 cost time: 0.8797299861907959
Epoch: 4, Steps: 64 | Train Loss: 0.2129779 Vali Loss: 0.4897789 Test Loss: 0.6908084
Validation loss decreased (0.731206 --> 0.489779).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 5 cost time: 0.8863670825958252
Epoch: 5, Steps: 64 | Train Loss: 0.1553227 Vali Loss: 0.3747014 Test Loss: 0.4999234
Validation loss decreased (0.489779 --> 0.374701).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 6 cost time: 0.8589999675750732
Epoch: 6, Steps: 64 | Train Loss: 0.1263998 Vali Loss: 0.3139137 Test Loss: 0.4041634
Validation loss decreased (0.374701 --> 0.313914).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 7 cost time: 0.8656094074249268
Epoch: 7, Steps: 64 | Train Loss: 0.1140515 Vali Loss: 0.2841797 Test Loss: 0.3671066
Validation loss decreased (0.313914 --> 0.284180).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 8 cost time: 0.8693604469299316
Epoch: 8, Steps: 64 | Train Loss: 0.1057531 Vali Loss: 0.2561412 Test Loss: 0.3313587
Validation loss decreased (0.284180 --> 0.256141).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 9 cost time: 0.8593335151672363
Epoch: 9, Steps: 64 | Train Loss: 0.1018607 Vali Loss: 0.2490805 Test Loss: 0.3185353
Validation loss decreased (0.256141 --> 0.249081).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 10 cost time: 0.8787312507629395
Epoch: 10, Steps: 64 | Train Loss: 0.0994708 Vali Loss: 0.2439691 Test Loss: 0.3080196
Validation loss decreased (0.249081 --> 0.243969).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 11 cost time: 0.876000165939331
Epoch: 11, Steps: 64 | Train Loss: 0.0979900 Vali Loss: 0.2380472 Test Loss: 0.3044468
Validation loss decreased (0.243969 --> 0.238047).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 12 cost time: 0.8769984245300293
Epoch: 12, Steps: 64 | Train Loss: 0.0966524 Vali Loss: 0.2359254 Test Loss: 0.2991613
Validation loss decreased (0.238047 --> 0.235925).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 13 cost time: 0.8766074180603027
Epoch: 13, Steps: 64 | Train Loss: 0.0948049 Vali Loss: 0.2321239 Test Loss: 0.2967348
Validation loss decreased (0.235925 --> 0.232124).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 14 cost time: 0.8810579776763916
Epoch: 14, Steps: 64 | Train Loss: 0.0940573 Vali Loss: 0.2296881 Test Loss: 0.2954956
Validation loss decreased (0.232124 --> 0.229688).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 15 cost time: 0.8703145980834961
Epoch: 15, Steps: 64 | Train Loss: 0.0931225 Vali Loss: 0.2266881 Test Loss: 0.2942639
Validation loss decreased (0.229688 --> 0.226688).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 16 cost time: 0.8748290538787842
Epoch: 16, Steps: 64 | Train Loss: 0.0926071 Vali Loss: 0.2303011 Test Loss: 0.2933444
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 17 cost time: 0.8719997406005859
Epoch: 17, Steps: 64 | Train Loss: 0.0916191 Vali Loss: 0.2255213 Test Loss: 0.2920286
Validation loss decreased (0.226688 --> 0.225521).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 18 cost time: 0.8704268932342529
Epoch: 18, Steps: 64 | Train Loss: 0.0912762 Vali Loss: 0.2230643 Test Loss: 0.2902475
Validation loss decreased (0.225521 --> 0.223064).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 19 cost time: 0.8721103668212891
Epoch: 19, Steps: 64 | Train Loss: 0.0903233 Vali Loss: 0.2234217 Test Loss: 0.2908348
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 20 cost time: 0.8914353847503662
Epoch: 20, Steps: 64 | Train Loss: 0.0891705 Vali Loss: 0.2204759 Test Loss: 0.2903424
Validation loss decreased (0.223064 --> 0.220476).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 21 cost time: 0.877385139465332
Epoch: 21, Steps: 64 | Train Loss: 0.0897377 Vali Loss: 0.2201505 Test Loss: 0.2889605
Validation loss decreased (0.220476 --> 0.220151).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 22 cost time: 0.8807382583618164
Epoch: 22, Steps: 64 | Train Loss: 0.0896221 Vali Loss: 0.2204163 Test Loss: 0.2909912
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 23 cost time: 0.8839995861053467
Epoch: 23, Steps: 64 | Train Loss: 0.0881996 Vali Loss: 0.2201081 Test Loss: 0.2900131
Validation loss decreased (0.220151 --> 0.220108).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 24 cost time: 0.864999532699585
Epoch: 24, Steps: 64 | Train Loss: 0.0885271 Vali Loss: 0.2192030 Test Loss: 0.2905350
Validation loss decreased (0.220108 --> 0.219203).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 25 cost time: 0.8653476238250732
Epoch: 25, Steps: 64 | Train Loss: 0.0881989 Vali Loss: 0.2197963 Test Loss: 0.2893642
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 26 cost time: 0.872389554977417
Epoch: 26, Steps: 64 | Train Loss: 0.0874569 Vali Loss: 0.2184630 Test Loss: 0.2901708
Validation loss decreased (0.219203 --> 0.218463).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 27 cost time: 0.8687930107116699
Epoch: 27, Steps: 64 | Train Loss: 0.0873829 Vali Loss: 0.2172601 Test Loss: 0.2877569
Validation loss decreased (0.218463 --> 0.217260).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 28 cost time: 0.8767764568328857
Epoch: 28, Steps: 64 | Train Loss: 0.0872619 Vali Loss: 0.2168770 Test Loss: 0.2883825
Validation loss decreased (0.217260 --> 0.216877).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 29 cost time: 0.8830022811889648
Epoch: 29, Steps: 64 | Train Loss: 0.0876608 Vali Loss: 0.2180304 Test Loss: 0.2880538
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 30 cost time: 0.8772339820861816
Epoch: 30, Steps: 64 | Train Loss: 0.0877132 Vali Loss: 0.2179377 Test Loss: 0.2882153
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 31 cost time: 0.8807780742645264
Epoch: 31, Steps: 64 | Train Loss: 0.0875459 Vali Loss: 0.2174752 Test Loss: 0.2885800
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 32 cost time: 0.8771059513092041
Epoch: 32, Steps: 64 | Train Loss: 0.0864033 Vali Loss: 0.2176422 Test Loss: 0.2887727
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 33 cost time: 0.8715264797210693
Epoch: 33, Steps: 64 | Train Loss: 0.0873707 Vali Loss: 0.2170147 Test Loss: 0.2866524
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 34 cost time: 0.8717203140258789
Epoch: 34, Steps: 64 | Train Loss: 0.0866969 Vali Loss: 0.2141983 Test Loss: 0.2865399
Validation loss decreased (0.216877 --> 0.214198).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 35 cost time: 0.8670003414154053
Epoch: 35, Steps: 64 | Train Loss: 0.0866443 Vali Loss: 0.2180085 Test Loss: 0.2869942
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 36 cost time: 0.8676199913024902
Epoch: 36, Steps: 64 | Train Loss: 0.0864896 Vali Loss: 0.2161734 Test Loss: 0.2868827
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 37 cost time: 0.8784294128417969
Epoch: 37, Steps: 64 | Train Loss: 0.0864159 Vali Loss: 0.2174553 Test Loss: 0.2870070
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 38 cost time: 0.8894050121307373
Epoch: 38, Steps: 64 | Train Loss: 0.0869543 Vali Loss: 0.2162769 Test Loss: 0.2863263
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 39 cost time: 0.8813705444335938
Epoch: 39, Steps: 64 | Train Loss: 0.0861174 Vali Loss: 0.2146909 Test Loss: 0.2856953
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 40 cost time: 0.87518310546875
Epoch: 40, Steps: 64 | Train Loss: 0.0856433 Vali Loss: 0.2157312 Test Loss: 0.2873870
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 41 cost time: 0.8819999694824219
Epoch: 41, Steps: 64 | Train Loss: 0.0858839 Vali Loss: 0.2152109 Test Loss: 0.2883644
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 42 cost time: 0.9516105651855469
Epoch: 42, Steps: 64 | Train Loss: 0.0864088 Vali Loss: 0.2176258 Test Loss: 0.2876079
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 43 cost time: 0.9534964561462402
Epoch: 43, Steps: 64 | Train Loss: 0.0858878 Vali Loss: 0.2173406 Test Loss: 0.2878963
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 44 cost time: 0.9523806571960449
Epoch: 44, Steps: 64 | Train Loss: 0.0861259 Vali Loss: 0.2119648 Test Loss: 0.2864633
Validation loss decreased (0.214198 --> 0.211965).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 45 cost time: 0.8933525085449219
Epoch: 45, Steps: 64 | Train Loss: 0.0861986 Vali Loss: 0.2156085 Test Loss: 0.2865979
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 46 cost time: 0.8766670227050781
Epoch: 46, Steps: 64 | Train Loss: 0.0857174 Vali Loss: 0.2142292 Test Loss: 0.2871040
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 47 cost time: 0.8787240982055664
Epoch: 47, Steps: 64 | Train Loss: 0.0858988 Vali Loss: 0.2146240 Test Loss: 0.2865000
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 48 cost time: 0.8860001564025879
Epoch: 48, Steps: 64 | Train Loss: 0.0857667 Vali Loss: 0.2164942 Test Loss: 0.2857633
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 49 cost time: 0.9526259899139404
Epoch: 49, Steps: 64 | Train Loss: 0.0859035 Vali Loss: 0.2132549 Test Loss: 0.2864297
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 50 cost time: 0.956610918045044
Epoch: 50, Steps: 64 | Train Loss: 0.0860613 Vali Loss: 0.2132827 Test Loss: 0.2871114
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 51 cost time: 0.9544377326965332
Epoch: 51, Steps: 64 | Train Loss: 0.0858126 Vali Loss: 0.2142519 Test Loss: 0.2855979
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 52 cost time: 0.8554809093475342
Epoch: 52, Steps: 64 | Train Loss: 0.0861723 Vali Loss: 0.2146655 Test Loss: 0.2869102
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 53 cost time: 0.8710856437683105
Epoch: 53, Steps: 64 | Train Loss: 0.0852106 Vali Loss: 0.2144047 Test Loss: 0.2871122
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 54 cost time: 0.8747782707214355
Epoch: 54, Steps: 64 | Train Loss: 0.0854164 Vali Loss: 0.2128312 Test Loss: 0.2870657
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 55 cost time: 0.8849999904632568
Epoch: 55, Steps: 64 | Train Loss: 0.0857485 Vali Loss: 0.2117875 Test Loss: 0.2869064
Validation loss decreased (0.211965 --> 0.211787).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 56 cost time: 0.877619743347168
Epoch: 56, Steps: 64 | Train Loss: 0.0856383 Vali Loss: 0.2131138 Test Loss: 0.2851987
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 57 cost time: 0.8827497959136963
Epoch: 57, Steps: 64 | Train Loss: 0.0857467 Vali Loss: 0.2123286 Test Loss: 0.2858920
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 58 cost time: 0.8783576488494873
Epoch: 58, Steps: 64 | Train Loss: 0.0852935 Vali Loss: 0.2146940 Test Loss: 0.2848440
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 59 cost time: 0.8874168395996094
Epoch: 59, Steps: 64 | Train Loss: 0.0856230 Vali Loss: 0.2139159 Test Loss: 0.2852027
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 60 cost time: 0.8807380199432373
Epoch: 60, Steps: 64 | Train Loss: 0.0861504 Vali Loss: 0.2166699 Test Loss: 0.2873935
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2869064211845398, mae:0.34567195177078247, rse:0.24583454430103302
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.058879852294921875 GB
Epoch: 1 cost time: 2.336954355239868
Epoch: 1, Steps: 64 | Train Loss: 0.9022401 Vali Loss: 2.6704776 Test Loss: 4.7917104
Validation loss decreased (inf --> 2.670478).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 2 cost time: 0.9254500865936279
Epoch: 2, Steps: 64 | Train Loss: 0.3892406 Vali Loss: 0.2813583 Test Loss: 0.3003114
Validation loss decreased (2.670478 --> 0.281358).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 3 cost time: 0.9180471897125244
Epoch: 3, Steps: 64 | Train Loss: 0.1062890 Vali Loss: 0.2535195 Test Loss: 0.2933051
Validation loss decreased (0.281358 --> 0.253519).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 4 cost time: 0.9193954467773438
Epoch: 4, Steps: 64 | Train Loss: 0.0944080 Vali Loss: 0.2373558 Test Loss: 0.2782930
Validation loss decreased (0.253519 --> 0.237356).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 5 cost time: 0.9164259433746338
Epoch: 5, Steps: 64 | Train Loss: 0.0897690 Vali Loss: 0.2288283 Test Loss: 0.2788134
Validation loss decreased (0.237356 --> 0.228828).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 6 cost time: 0.9084382057189941
Epoch: 6, Steps: 64 | Train Loss: 0.0869857 Vali Loss: 0.2237983 Test Loss: 0.2812554
Validation loss decreased (0.228828 --> 0.223798).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 7 cost time: 0.9090962409973145
Epoch: 7, Steps: 64 | Train Loss: 0.0851402 Vali Loss: 0.2210383 Test Loss: 0.2806320
Validation loss decreased (0.223798 --> 0.221038).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 8 cost time: 0.9054181575775146
Epoch: 8, Steps: 64 | Train Loss: 0.0832558 Vali Loss: 0.2212797 Test Loss: 0.2767874
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 9 cost time: 0.9095304012298584
Epoch: 9, Steps: 64 | Train Loss: 0.0815408 Vali Loss: 0.2152733 Test Loss: 0.2738095
Validation loss decreased (0.221038 --> 0.215273).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 10 cost time: 0.9179985523223877
Epoch: 10, Steps: 64 | Train Loss: 0.0810737 Vali Loss: 0.2097102 Test Loss: 0.2766572
Validation loss decreased (0.215273 --> 0.209710).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 11 cost time: 0.9212419986724854
Epoch: 11, Steps: 64 | Train Loss: 0.0798880 Vali Loss: 0.2130195 Test Loss: 0.2767524
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 12 cost time: 0.9233276844024658
Epoch: 12, Steps: 64 | Train Loss: 0.0789656 Vali Loss: 0.2098154 Test Loss: 0.2757228
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 13 cost time: 0.9993748664855957
Epoch: 13, Steps: 64 | Train Loss: 0.0782730 Vali Loss: 0.2078050 Test Loss: 0.2751988
Validation loss decreased (0.209710 --> 0.207805).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 14 cost time: 0.9553570747375488
Epoch: 14, Steps: 64 | Train Loss: 0.0769811 Vali Loss: 0.2067406 Test Loss: 0.2749576
Validation loss decreased (0.207805 --> 0.206741).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 15 cost time: 0.9120466709136963
Epoch: 15, Steps: 64 | Train Loss: 0.0768974 Vali Loss: 0.2043507 Test Loss: 0.2711653
Validation loss decreased (0.206741 --> 0.204351).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 16 cost time: 0.9272522926330566
Epoch: 16, Steps: 64 | Train Loss: 0.0761457 Vali Loss: 0.1995496 Test Loss: 0.2724369
Validation loss decreased (0.204351 --> 0.199550).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 17 cost time: 0.9097194671630859
Epoch: 17, Steps: 64 | Train Loss: 0.0756158 Vali Loss: 0.2006521 Test Loss: 0.2700202
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 18 cost time: 0.9227323532104492
Epoch: 18, Steps: 64 | Train Loss: 0.0748478 Vali Loss: 0.1993449 Test Loss: 0.2711439
Validation loss decreased (0.199550 --> 0.199345).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 19 cost time: 0.9273831844329834
Epoch: 19, Steps: 64 | Train Loss: 0.0748202 Vali Loss: 0.1954397 Test Loss: 0.2701737
Validation loss decreased (0.199345 --> 0.195440).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 20 cost time: 0.9234044551849365
Epoch: 20, Steps: 64 | Train Loss: 0.0737589 Vali Loss: 0.1962431 Test Loss: 0.2686641
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 21 cost time: 0.9193401336669922
Epoch: 21, Steps: 64 | Train Loss: 0.0739133 Vali Loss: 0.1956116 Test Loss: 0.2684906
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 22 cost time: 0.9113295078277588
Epoch: 22, Steps: 64 | Train Loss: 0.0733150 Vali Loss: 0.1946987 Test Loss: 0.2673897
Validation loss decreased (0.195440 --> 0.194699).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 23 cost time: 0.8990304470062256
Epoch: 23, Steps: 64 | Train Loss: 0.0727039 Vali Loss: 0.1947888 Test Loss: 0.2689088
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 24 cost time: 0.9176292419433594
Epoch: 24, Steps: 64 | Train Loss: 0.0725938 Vali Loss: 0.1923109 Test Loss: 0.2671368
Validation loss decreased (0.194699 --> 0.192311).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 25 cost time: 0.9123895168304443
Epoch: 25, Steps: 64 | Train Loss: 0.0722168 Vali Loss: 0.1890440 Test Loss: 0.2666280
Validation loss decreased (0.192311 --> 0.189044).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 26 cost time: 0.9220001697540283
Epoch: 26, Steps: 64 | Train Loss: 0.0720604 Vali Loss: 0.1918023 Test Loss: 0.2667519
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 27 cost time: 0.9197378158569336
Epoch: 27, Steps: 64 | Train Loss: 0.0720041 Vali Loss: 0.1916664 Test Loss: 0.2660292
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 28 cost time: 0.9186122417449951
Epoch: 28, Steps: 64 | Train Loss: 0.0725380 Vali Loss: 0.1895693 Test Loss: 0.2657208
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 29 cost time: 0.9192283153533936
Epoch: 29, Steps: 64 | Train Loss: 0.0717997 Vali Loss: 0.1924572 Test Loss: 0.2657596
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 30 cost time: 0.8913309574127197
Epoch: 30, Steps: 64 | Train Loss: 0.0717412 Vali Loss: 0.1903084 Test Loss: 0.2652709
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 31 cost time: 0.9093978404998779
Epoch: 31, Steps: 64 | Train Loss: 0.0716065 Vali Loss: 0.1905922 Test Loss: 0.2654678
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 32 cost time: 0.9107654094696045
Epoch: 32, Steps: 64 | Train Loss: 0.0714249 Vali Loss: 0.1896369 Test Loss: 0.2661797
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 33 cost time: 0.9082448482513428
Epoch: 33, Steps: 64 | Train Loss: 0.0713237 Vali Loss: 0.1906884 Test Loss: 0.2639386
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 34 cost time: 0.9120001792907715
Epoch: 34, Steps: 64 | Train Loss: 0.0712870 Vali Loss: 0.1884011 Test Loss: 0.2644072
Validation loss decreased (0.189044 --> 0.188401).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 35 cost time: 0.9156255722045898
Epoch: 35, Steps: 64 | Train Loss: 0.0711298 Vali Loss: 0.1902522 Test Loss: 0.2648478
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 36 cost time: 0.9219987392425537
Epoch: 36, Steps: 64 | Train Loss: 0.0711909 Vali Loss: 0.1887963 Test Loss: 0.2654918
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 37 cost time: 0.9164109230041504
Epoch: 37, Steps: 64 | Train Loss: 0.0712919 Vali Loss: 0.1872300 Test Loss: 0.2645947
Validation loss decreased (0.188401 --> 0.187230).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 38 cost time: 0.9143657684326172
Epoch: 38, Steps: 64 | Train Loss: 0.0709242 Vali Loss: 0.1900056 Test Loss: 0.2648411
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 39 cost time: 0.9137799739837646
Epoch: 39, Steps: 64 | Train Loss: 0.0711626 Vali Loss: 0.1861758 Test Loss: 0.2634786
Validation loss decreased (0.187230 --> 0.186176).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 40 cost time: 0.921025276184082
Epoch: 40, Steps: 64 | Train Loss: 0.0707622 Vali Loss: 0.1889859 Test Loss: 0.2641534
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 41 cost time: 0.9098062515258789
Epoch: 41, Steps: 64 | Train Loss: 0.0713353 Vali Loss: 0.1872097 Test Loss: 0.2649775
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 42 cost time: 0.9130003452301025
Epoch: 42, Steps: 64 | Train Loss: 0.0713089 Vali Loss: 0.1891731 Test Loss: 0.2648460
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 43 cost time: 0.9260001182556152
Epoch: 43, Steps: 64 | Train Loss: 0.0706240 Vali Loss: 0.1894877 Test Loss: 0.2646300
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 44 cost time: 0.9181215763092041
Epoch: 44, Steps: 64 | Train Loss: 0.0706938 Vali Loss: 0.1893299 Test Loss: 0.2644545
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 45 cost time: 0.9186015129089355
Epoch: 45, Steps: 64 | Train Loss: 0.0706389 Vali Loss: 0.1873292 Test Loss: 0.2640183
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 46 cost time: 0.9213552474975586
Epoch: 46, Steps: 64 | Train Loss: 0.0707989 Vali Loss: 0.1876252 Test Loss: 0.2640929
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 47 cost time: 0.911207914352417
Epoch: 47, Steps: 64 | Train Loss: 0.0710928 Vali Loss: 0.1880389 Test Loss: 0.2630379
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 48 cost time: 0.9148356914520264
Epoch: 48, Steps: 64 | Train Loss: 0.0709851 Vali Loss: 0.1853074 Test Loss: 0.2632472
Validation loss decreased (0.186176 --> 0.185307).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 49 cost time: 0.9174165725708008
Epoch: 49, Steps: 64 | Train Loss: 0.0707555 Vali Loss: 0.1885315 Test Loss: 0.2633593
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 50 cost time: 0.9119999408721924
Epoch: 50, Steps: 64 | Train Loss: 0.0712554 Vali Loss: 0.1874522 Test Loss: 0.2635939
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 51 cost time: 0.9136233329772949
Epoch: 51, Steps: 64 | Train Loss: 0.0706226 Vali Loss: 0.1877401 Test Loss: 0.2632974
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 52 cost time: 0.9217989444732666
Epoch: 52, Steps: 64 | Train Loss: 0.0708968 Vali Loss: 0.1875419 Test Loss: 0.2642968
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 53 cost time: 0.922339916229248
Epoch: 53, Steps: 64 | Train Loss: 0.0705423 Vali Loss: 0.1868979 Test Loss: 0.2637799
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 54 cost time: 0.8964521884918213
Epoch: 54, Steps: 64 | Train Loss: 0.0705137 Vali Loss: 0.1853304 Test Loss: 0.2635576
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 55 cost time: 0.9223465919494629
Epoch: 55, Steps: 64 | Train Loss: 0.0704526 Vali Loss: 0.1867915 Test Loss: 0.2637288
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 56 cost time: 0.9147062301635742
Epoch: 56, Steps: 64 | Train Loss: 0.0707875 Vali Loss: 0.1885423 Test Loss: 0.2636872
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 57 cost time: 0.933361291885376
Epoch: 57, Steps: 64 | Train Loss: 0.0706117 Vali Loss: 0.1879607 Test Loss: 0.2641347
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 58 cost time: 0.9180011749267578
Epoch: 58, Steps: 64 | Train Loss: 0.0703498 Vali Loss: 0.1884678 Test Loss: 0.2641556
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 59 cost time: 0.9156033992767334
Epoch: 59, Steps: 64 | Train Loss: 0.0705474 Vali Loss: 0.1884329 Test Loss: 0.2634512
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 60 cost time: 0.924354076385498
Epoch: 60, Steps: 64 | Train Loss: 0.0702627 Vali Loss: 0.1898629 Test Loss: 0.2639410
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.26324713230133057, mae:0.3297593295574188, rse:0.23548032343387604
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.062178611755371094 GB
Epoch: 1 cost time: 2.3487532138824463
Epoch: 1, Steps: 64 | Train Loss: 0.8020362 Vali Loss: 2.4578204 Test Loss: 4.3370724
Validation loss decreased (inf --> 2.457820).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 2 cost time: 1.0303807258605957
Epoch: 2, Steps: 64 | Train Loss: 0.3179249 Vali Loss: 0.3220163 Test Loss: 0.3825541
Validation loss decreased (2.457820 --> 0.322016).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 3 cost time: 1.0273470878601074
Epoch: 3, Steps: 64 | Train Loss: 0.1017715 Vali Loss: 0.2414142 Test Loss: 0.2863662
Validation loss decreased (0.322016 --> 0.241414).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 4 cost time: 0.9214999675750732
Epoch: 4, Steps: 64 | Train Loss: 0.0899887 Vali Loss: 0.2414487 Test Loss: 0.2836990
EarlyStopping counter: 1 out of 100
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 5 cost time: 0.9433891773223877
Epoch: 5, Steps: 64 | Train Loss: 0.0863379 Vali Loss: 0.2311468 Test Loss: 0.2791403
Validation loss decreased (0.241414 --> 0.231147).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 6 cost time: 0.9388196468353271
Epoch: 6, Steps: 64 | Train Loss: 0.0842456 Vali Loss: 0.2256193 Test Loss: 0.2795991
Validation loss decreased (0.231147 --> 0.225619).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 7 cost time: 0.9368913173675537
Epoch: 7, Steps: 64 | Train Loss: 0.0823536 Vali Loss: 0.2203848 Test Loss: 0.2759858
Validation loss decreased (0.225619 --> 0.220385).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 8 cost time: 0.9357655048370361
Epoch: 8, Steps: 64 | Train Loss: 0.0813082 Vali Loss: 0.2164332 Test Loss: 0.2761571
Validation loss decreased (0.220385 --> 0.216433).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 9 cost time: 0.9479994773864746
Epoch: 9, Steps: 64 | Train Loss: 0.0800626 Vali Loss: 0.2159722 Test Loss: 0.2774166
Validation loss decreased (0.216433 --> 0.215972).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 10 cost time: 1.0109925270080566
Epoch: 10, Steps: 64 | Train Loss: 0.0786152 Vali Loss: 0.2091223 Test Loss: 0.2812080
Validation loss decreased (0.215972 --> 0.209122).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 11 cost time: 0.9476063251495361
Epoch: 11, Steps: 64 | Train Loss: 0.0773968 Vali Loss: 0.2065011 Test Loss: 0.2767793
Validation loss decreased (0.209122 --> 0.206501).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 12 cost time: 0.9463913440704346
Epoch: 12, Steps: 64 | Train Loss: 0.0768734 Vali Loss: 0.2032045 Test Loss: 0.2839526
Validation loss decreased (0.206501 --> 0.203204).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 13 cost time: 0.942368745803833
Epoch: 13, Steps: 64 | Train Loss: 0.0765690 Vali Loss: 0.2038724 Test Loss: 0.2772005
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 14 cost time: 0.9364502429962158
Epoch: 14, Steps: 64 | Train Loss: 0.0759965 Vali Loss: 0.2001193 Test Loss: 0.2790285
Validation loss decreased (0.203204 --> 0.200119).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 15 cost time: 0.9403879642486572
Epoch: 15, Steps: 64 | Train Loss: 0.0749899 Vali Loss: 0.2003126 Test Loss: 0.2773662
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 16 cost time: 0.941364049911499
Epoch: 16, Steps: 64 | Train Loss: 0.0746619 Vali Loss: 0.1965758 Test Loss: 0.2787696
Validation loss decreased (0.200119 --> 0.196576).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 17 cost time: 0.9540417194366455
Epoch: 17, Steps: 64 | Train Loss: 0.0741089 Vali Loss: 0.1943669 Test Loss: 0.2754658
Validation loss decreased (0.196576 --> 0.194367).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 18 cost time: 0.9501669406890869
Epoch: 18, Steps: 64 | Train Loss: 0.0739519 Vali Loss: 0.1958461 Test Loss: 0.2769441
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 19 cost time: 0.9469997882843018
Epoch: 19, Steps: 64 | Train Loss: 0.0732010 Vali Loss: 0.1950607 Test Loss: 0.2740805
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 20 cost time: 0.9589998722076416
Epoch: 20, Steps: 64 | Train Loss: 0.0732268 Vali Loss: 0.1932909 Test Loss: 0.2759287
Validation loss decreased (0.194367 --> 0.193291).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 21 cost time: 0.9436123371124268
Epoch: 21, Steps: 64 | Train Loss: 0.0727606 Vali Loss: 0.1904144 Test Loss: 0.2755346
Validation loss decreased (0.193291 --> 0.190414).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 22 cost time: 0.9420344829559326
Epoch: 22, Steps: 64 | Train Loss: 0.0726140 Vali Loss: 0.1904948 Test Loss: 0.2756138
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 23 cost time: 0.9543993473052979
Epoch: 23, Steps: 64 | Train Loss: 0.0727289 Vali Loss: 0.1930736 Test Loss: 0.2757135
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 24 cost time: 0.9403207302093506
Epoch: 24, Steps: 64 | Train Loss: 0.0722155 Vali Loss: 0.1928545 Test Loss: 0.2738911
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 25 cost time: 0.9453399181365967
Epoch: 25, Steps: 64 | Train Loss: 0.0718700 Vali Loss: 0.1888684 Test Loss: 0.2739615
Validation loss decreased (0.190414 --> 0.188868).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 26 cost time: 0.9504444599151611
Epoch: 26, Steps: 64 | Train Loss: 0.0717591 Vali Loss: 0.1930415 Test Loss: 0.2740515
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 27 cost time: 0.9603641033172607
Epoch: 27, Steps: 64 | Train Loss: 0.0724194 Vali Loss: 0.1899297 Test Loss: 0.2734321
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 28 cost time: 0.9508304595947266
Epoch: 28, Steps: 64 | Train Loss: 0.0722013 Vali Loss: 0.1909952 Test Loss: 0.2729053
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 29 cost time: 0.9460000991821289
Epoch: 29, Steps: 64 | Train Loss: 0.0720763 Vali Loss: 0.1906755 Test Loss: 0.2735617
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 30 cost time: 0.951378345489502
Epoch: 30, Steps: 64 | Train Loss: 0.0715942 Vali Loss: 0.1923209 Test Loss: 0.2731834
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 31 cost time: 0.9456155300140381
Epoch: 31, Steps: 64 | Train Loss: 0.0716605 Vali Loss: 0.1900432 Test Loss: 0.2728690
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 32 cost time: 0.9478316307067871
Epoch: 32, Steps: 64 | Train Loss: 0.0714221 Vali Loss: 0.1895975 Test Loss: 0.2724247
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 33 cost time: 0.9503929615020752
Epoch: 33, Steps: 64 | Train Loss: 0.0714169 Vali Loss: 0.1911370 Test Loss: 0.2732446
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 34 cost time: 1.0267643928527832
Epoch: 34, Steps: 64 | Train Loss: 0.0709943 Vali Loss: 0.1888935 Test Loss: 0.2722585
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 35 cost time: 0.9504101276397705
Epoch: 35, Steps: 64 | Train Loss: 0.0712571 Vali Loss: 0.1885348 Test Loss: 0.2721157
Validation loss decreased (0.188868 --> 0.188535).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 36 cost time: 0.94338059425354
Epoch: 36, Steps: 64 | Train Loss: 0.0711031 Vali Loss: 0.1885257 Test Loss: 0.2725084
Validation loss decreased (0.188535 --> 0.188526).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 37 cost time: 0.9553940296173096
Epoch: 37, Steps: 64 | Train Loss: 0.0713460 Vali Loss: 0.1872242 Test Loss: 0.2715988
Validation loss decreased (0.188526 --> 0.187224).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 38 cost time: 0.9413843154907227
Epoch: 38, Steps: 64 | Train Loss: 0.0708543 Vali Loss: 0.1906093 Test Loss: 0.2716135
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 39 cost time: 0.9427826404571533
Epoch: 39, Steps: 64 | Train Loss: 0.0716102 Vali Loss: 0.1875195 Test Loss: 0.2712723
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 40 cost time: 0.9519999027252197
Epoch: 40, Steps: 64 | Train Loss: 0.0710046 Vali Loss: 0.1875737 Test Loss: 0.2716991
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 41 cost time: 0.9450016021728516
Epoch: 41, Steps: 64 | Train Loss: 0.0711126 Vali Loss: 0.1887676 Test Loss: 0.2715306
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 42 cost time: 0.9476273059844971
Epoch: 42, Steps: 64 | Train Loss: 0.0715014 Vali Loss: 0.1910648 Test Loss: 0.2716807
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 43 cost time: 0.9522421360015869
Epoch: 43, Steps: 64 | Train Loss: 0.0708728 Vali Loss: 0.1879620 Test Loss: 0.2716294
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 44 cost time: 0.9512417316436768
Epoch: 44, Steps: 64 | Train Loss: 0.0712273 Vali Loss: 0.1899670 Test Loss: 0.2719220
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 45 cost time: 0.9483706951141357
Epoch: 45, Steps: 64 | Train Loss: 0.0706485 Vali Loss: 0.1901603 Test Loss: 0.2715240
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 46 cost time: 0.9414238929748535
Epoch: 46, Steps: 64 | Train Loss: 0.0710411 Vali Loss: 0.1877189 Test Loss: 0.2721638
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 47 cost time: 0.9368009567260742
Epoch: 47, Steps: 64 | Train Loss: 0.0710091 Vali Loss: 0.1897552 Test Loss: 0.2717699
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 48 cost time: 0.9417455196380615
Epoch: 48, Steps: 64 | Train Loss: 0.0710520 Vali Loss: 0.1892896 Test Loss: 0.2717462
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 49 cost time: 0.939812183380127
Epoch: 49, Steps: 64 | Train Loss: 0.0707925 Vali Loss: 0.1906965 Test Loss: 0.2712851
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 50 cost time: 0.9413726329803467
Epoch: 50, Steps: 64 | Train Loss: 0.0708736 Vali Loss: 0.1898319 Test Loss: 0.2712922
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 51 cost time: 0.9444093704223633
Epoch: 51, Steps: 64 | Train Loss: 0.0708687 Vali Loss: 0.1877582 Test Loss: 0.2713840
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 52 cost time: 0.9446115493774414
Epoch: 52, Steps: 64 | Train Loss: 0.0706539 Vali Loss: 0.1886953 Test Loss: 0.2713422
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 53 cost time: 0.9604382514953613
Epoch: 53, Steps: 64 | Train Loss: 0.0713782 Vali Loss: 0.1872339 Test Loss: 0.2715721
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 54 cost time: 0.9363930225372314
Epoch: 54, Steps: 64 | Train Loss: 0.0710066 Vali Loss: 0.1911717 Test Loss: 0.2709167
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 55 cost time: 0.9374814033508301
Epoch: 55, Steps: 64 | Train Loss: 0.0704894 Vali Loss: 0.1892370 Test Loss: 0.2714865
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 56 cost time: 0.9413747787475586
Epoch: 56, Steps: 64 | Train Loss: 0.0708404 Vali Loss: 0.1893461 Test Loss: 0.2716242
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 57 cost time: 0.953040599822998
Epoch: 57, Steps: 64 | Train Loss: 0.0708885 Vali Loss: 0.1890271 Test Loss: 0.2715848
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 58 cost time: 0.9497466087341309
Epoch: 58, Steps: 64 | Train Loss: 0.0712374 Vali Loss: 0.1901143 Test Loss: 0.2710001
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 59 cost time: 0.9467215538024902
Epoch: 59, Steps: 64 | Train Loss: 0.0704020 Vali Loss: 0.1877296 Test Loss: 0.2706131
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 60 cost time: 0.9586231708526611
Epoch: 60, Steps: 64 | Train Loss: 0.0711518 Vali Loss: 0.1898103 Test Loss: 0.2712641
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.27159881591796875, mae:0.3376178741455078, rse:0.23918654024600983
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.05464744567871094 GB
Epoch: 1 cost time: 2.2436611652374268
Epoch: 1, Steps: 64 | Train Loss: 0.9515878 Vali Loss: 2.7486293 Test Loss: 4.9328957
Validation loss decreased (inf --> 2.748629).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 2 cost time: 0.8804290294647217
Epoch: 2, Steps: 64 | Train Loss: 0.6443287 Vali Loss: 1.1752348 Test Loss: 1.9624429
Validation loss decreased (2.748629 --> 1.175235).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 3 cost time: 0.9283719062805176
Epoch: 3, Steps: 64 | Train Loss: 0.3569805 Vali Loss: 0.7711568 Test Loss: 1.1887739
Validation loss decreased (1.175235 --> 0.771157).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 4 cost time: 0.8864572048187256
Epoch: 4, Steps: 64 | Train Loss: 0.2300702 Vali Loss: 0.5236930 Test Loss: 0.7502615
Validation loss decreased (0.771157 --> 0.523693).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 5 cost time: 0.8833379745483398
Epoch: 5, Steps: 64 | Train Loss: 0.1629569 Vali Loss: 0.3881348 Test Loss: 0.5310823
Validation loss decreased (0.523693 --> 0.388135).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 6 cost time: 0.8788447380065918
Epoch: 6, Steps: 64 | Train Loss: 0.1321459 Vali Loss: 0.3206085 Test Loss: 0.4183014
Validation loss decreased (0.388135 --> 0.320608).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 7 cost time: 0.8761627674102783
Epoch: 7, Steps: 64 | Train Loss: 0.1156006 Vali Loss: 0.2816477 Test Loss: 0.3630604
Validation loss decreased (0.320608 --> 0.281648).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 8 cost time: 0.8726158142089844
Epoch: 8, Steps: 64 | Train Loss: 0.1062360 Vali Loss: 0.2591803 Test Loss: 0.3351910
Validation loss decreased (0.281648 --> 0.259180).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 9 cost time: 0.8730137348175049
Epoch: 9, Steps: 64 | Train Loss: 0.1019030 Vali Loss: 0.2446155 Test Loss: 0.3156474
Validation loss decreased (0.259180 --> 0.244615).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 10 cost time: 0.8823390007019043
Epoch: 10, Steps: 64 | Train Loss: 0.0994001 Vali Loss: 0.2357089 Test Loss: 0.3052743
Validation loss decreased (0.244615 --> 0.235709).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 11 cost time: 0.8624477386474609
Epoch: 11, Steps: 64 | Train Loss: 0.0974429 Vali Loss: 0.2323897 Test Loss: 0.3006048
Validation loss decreased (0.235709 --> 0.232390).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 12 cost time: 0.8857645988464355
Epoch: 12, Steps: 64 | Train Loss: 0.0948852 Vali Loss: 0.2297167 Test Loss: 0.2943093
Validation loss decreased (0.232390 --> 0.229717).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 13 cost time: 0.8867204189300537
Epoch: 13, Steps: 64 | Train Loss: 0.0941756 Vali Loss: 0.2275302 Test Loss: 0.2924586
Validation loss decreased (0.229717 --> 0.227530).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 14 cost time: 0.8886127471923828
Epoch: 14, Steps: 64 | Train Loss: 0.0925829 Vali Loss: 0.2284498 Test Loss: 0.2913652
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 15 cost time: 0.8763689994812012
Epoch: 15, Steps: 64 | Train Loss: 0.0916766 Vali Loss: 0.2225986 Test Loss: 0.2902619
Validation loss decreased (0.227530 --> 0.222599).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 16 cost time: 0.8733859062194824
Epoch: 16, Steps: 64 | Train Loss: 0.0919284 Vali Loss: 0.2210316 Test Loss: 0.2904491
Validation loss decreased (0.222599 --> 0.221032).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 17 cost time: 0.8803653717041016
Epoch: 17, Steps: 64 | Train Loss: 0.0900432 Vali Loss: 0.2213720 Test Loss: 0.2870407
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 18 cost time: 0.8841006755828857
Epoch: 18, Steps: 64 | Train Loss: 0.0898440 Vali Loss: 0.2160451 Test Loss: 0.2857004
Validation loss decreased (0.221032 --> 0.216045).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 19 cost time: 0.8839998245239258
Epoch: 19, Steps: 64 | Train Loss: 0.0894447 Vali Loss: 0.2188114 Test Loss: 0.2875826
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 20 cost time: 0.883615255355835
Epoch: 20, Steps: 64 | Train Loss: 0.0894199 Vali Loss: 0.2140028 Test Loss: 0.2833218
Validation loss decreased (0.216045 --> 0.214003).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 21 cost time: 0.8954167366027832
Epoch: 21, Steps: 64 | Train Loss: 0.0884065 Vali Loss: 0.2179978 Test Loss: 0.2845306
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 22 cost time: 0.9140129089355469
Epoch: 22, Steps: 64 | Train Loss: 0.0886793 Vali Loss: 0.2197203 Test Loss: 0.2836534
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 23 cost time: 0.8770625591278076
Epoch: 23, Steps: 64 | Train Loss: 0.0881900 Vali Loss: 0.2179648 Test Loss: 0.2855116
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 24 cost time: 0.8766233921051025
Epoch: 24, Steps: 64 | Train Loss: 0.0879733 Vali Loss: 0.2172534 Test Loss: 0.2846046
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 25 cost time: 0.8830001354217529
Epoch: 25, Steps: 64 | Train Loss: 0.0879364 Vali Loss: 0.2153825 Test Loss: 0.2838170
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 26 cost time: 0.869999885559082
Epoch: 26, Steps: 64 | Train Loss: 0.0874366 Vali Loss: 0.2132053 Test Loss: 0.2831798
Validation loss decreased (0.214003 --> 0.213205).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 27 cost time: 0.8772604465484619
Epoch: 27, Steps: 64 | Train Loss: 0.0870254 Vali Loss: 0.2144091 Test Loss: 0.2839803
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 28 cost time: 0.8923726081848145
Epoch: 28, Steps: 64 | Train Loss: 0.0875721 Vali Loss: 0.2163177 Test Loss: 0.2813643
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 29 cost time: 0.8823935985565186
Epoch: 29, Steps: 64 | Train Loss: 0.0864431 Vali Loss: 0.2157317 Test Loss: 0.2802676
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 30 cost time: 0.8813769817352295
Epoch: 30, Steps: 64 | Train Loss: 0.0868698 Vali Loss: 0.2161969 Test Loss: 0.2822428
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 31 cost time: 0.8861720561981201
Epoch: 31, Steps: 64 | Train Loss: 0.0868539 Vali Loss: 0.2146983 Test Loss: 0.2803296
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 32 cost time: 0.8720648288726807
Epoch: 32, Steps: 64 | Train Loss: 0.0863284 Vali Loss: 0.2152614 Test Loss: 0.2800976
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 33 cost time: 0.8726186752319336
Epoch: 33, Steps: 64 | Train Loss: 0.0865906 Vali Loss: 0.2161204 Test Loss: 0.2811205
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 34 cost time: 0.8773248195648193
Epoch: 34, Steps: 64 | Train Loss: 0.0860464 Vali Loss: 0.2130697 Test Loss: 0.2817893
Validation loss decreased (0.213205 --> 0.213070).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 35 cost time: 0.8765404224395752
Epoch: 35, Steps: 64 | Train Loss: 0.0855704 Vali Loss: 0.2148937 Test Loss: 0.2814081
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 36 cost time: 0.8821725845336914
Epoch: 36, Steps: 64 | Train Loss: 0.0861507 Vali Loss: 0.2151792 Test Loss: 0.2804662
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 37 cost time: 0.8828685283660889
Epoch: 37, Steps: 64 | Train Loss: 0.0857816 Vali Loss: 0.2146670 Test Loss: 0.2809232
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 38 cost time: 0.8869998455047607
Epoch: 38, Steps: 64 | Train Loss: 0.0859585 Vali Loss: 0.2141286 Test Loss: 0.2818561
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 39 cost time: 0.8906245231628418
Epoch: 39, Steps: 64 | Train Loss: 0.0857714 Vali Loss: 0.2117796 Test Loss: 0.2821942
Validation loss decreased (0.213070 --> 0.211780).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 40 cost time: 0.8844423294067383
Epoch: 40, Steps: 64 | Train Loss: 0.0861317 Vali Loss: 0.2144835 Test Loss: 0.2816644
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 41 cost time: 0.8753643035888672
Epoch: 41, Steps: 64 | Train Loss: 0.0857766 Vali Loss: 0.2107393 Test Loss: 0.2803411
Validation loss decreased (0.211780 --> 0.210739).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 42 cost time: 0.8714029788970947
Epoch: 42, Steps: 64 | Train Loss: 0.0860195 Vali Loss: 0.2130765 Test Loss: 0.2821867
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 43 cost time: 0.886737585067749
Epoch: 43, Steps: 64 | Train Loss: 0.0859351 Vali Loss: 0.2132400 Test Loss: 0.2826528
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 44 cost time: 0.8694219589233398
Epoch: 44, Steps: 64 | Train Loss: 0.0854282 Vali Loss: 0.2142053 Test Loss: 0.2806433
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 45 cost time: 0.8796167373657227
Epoch: 45, Steps: 64 | Train Loss: 0.0853770 Vali Loss: 0.2115609 Test Loss: 0.2793164
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 46 cost time: 0.8903501033782959
Epoch: 46, Steps: 64 | Train Loss: 0.0854876 Vali Loss: 0.2114260 Test Loss: 0.2800207
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 47 cost time: 0.8813838958740234
Epoch: 47, Steps: 64 | Train Loss: 0.0852692 Vali Loss: 0.2123539 Test Loss: 0.2808036
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 48 cost time: 0.880380392074585
Epoch: 48, Steps: 64 | Train Loss: 0.0852798 Vali Loss: 0.2124621 Test Loss: 0.2813895
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 49 cost time: 0.8813672065734863
Epoch: 49, Steps: 64 | Train Loss: 0.0858134 Vali Loss: 0.2120419 Test Loss: 0.2786842
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 50 cost time: 0.8819997310638428
Epoch: 50, Steps: 64 | Train Loss: 0.0855823 Vali Loss: 0.2125354 Test Loss: 0.2809834
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 51 cost time: 0.8746182918548584
Epoch: 51, Steps: 64 | Train Loss: 0.0854354 Vali Loss: 0.2110709 Test Loss: 0.2817461
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 52 cost time: 0.8773505687713623
Epoch: 52, Steps: 64 | Train Loss: 0.0858191 Vali Loss: 0.2130445 Test Loss: 0.2819521
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 53 cost time: 0.872413158416748
Epoch: 53, Steps: 64 | Train Loss: 0.0855263 Vali Loss: 0.2111299 Test Loss: 0.2806458
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 54 cost time: 0.8718838691711426
Epoch: 54, Steps: 64 | Train Loss: 0.0851590 Vali Loss: 0.2120135 Test Loss: 0.2808409
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 55 cost time: 0.8784019947052002
Epoch: 55, Steps: 64 | Train Loss: 0.0850942 Vali Loss: 0.2136907 Test Loss: 0.2800117
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 56 cost time: 0.8799998760223389
Epoch: 56, Steps: 64 | Train Loss: 0.0852363 Vali Loss: 0.2125513 Test Loss: 0.2808868
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 57 cost time: 0.8893611431121826
Epoch: 57, Steps: 64 | Train Loss: 0.0852572 Vali Loss: 0.2099561 Test Loss: 0.2799839
Validation loss decreased (0.210739 --> 0.209956).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 58 cost time: 0.8794112205505371
Epoch: 58, Steps: 64 | Train Loss: 0.0853883 Vali Loss: 0.2132817 Test Loss: 0.2804545
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 59 cost time: 0.8764128684997559
Epoch: 59, Steps: 64 | Train Loss: 0.0848425 Vali Loss: 0.2106138 Test Loss: 0.2788566
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 60 cost time: 0.8793430328369141
Epoch: 60, Steps: 64 | Train Loss: 0.0852992 Vali Loss: 0.2131471 Test Loss: 0.2796520
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2799838185310364, mae:0.3388325572013855, rse:0.2428506463766098
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.05904197692871094 GB
Epoch: 1 cost time: 2.288672924041748
Epoch: 1, Steps: 64 | Train Loss: 0.7354991 Vali Loss: 2.2037702 Test Loss: 3.8395619
Validation loss decreased (inf --> 2.203770).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 2 cost time: 0.9230000972747803
Epoch: 2, Steps: 64 | Train Loss: 0.2970022 Vali Loss: 0.3049952 Test Loss: 0.3033873
Validation loss decreased (2.203770 --> 0.304995).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 3 cost time: 0.9286401271820068
Epoch: 3, Steps: 64 | Train Loss: 0.1042238 Vali Loss: 0.2575023 Test Loss: 0.3051698
Validation loss decreased (0.304995 --> 0.257502).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 4 cost time: 0.9284510612487793
Epoch: 4, Steps: 64 | Train Loss: 0.0934238 Vali Loss: 0.2401497 Test Loss: 0.2838180
Validation loss decreased (0.257502 --> 0.240150).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 5 cost time: 0.9223716259002686
Epoch: 5, Steps: 64 | Train Loss: 0.0897820 Vali Loss: 0.2336345 Test Loss: 0.2826294
Validation loss decreased (0.240150 --> 0.233635).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 6 cost time: 0.9204432964324951
Epoch: 6, Steps: 64 | Train Loss: 0.0864343 Vali Loss: 0.2260873 Test Loss: 0.2831342
Validation loss decreased (0.233635 --> 0.226087).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 7 cost time: 0.932020902633667
Epoch: 7, Steps: 64 | Train Loss: 0.0848009 Vali Loss: 0.2254803 Test Loss: 0.2794903
Validation loss decreased (0.226087 --> 0.225480).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 8 cost time: 0.9223392009735107
Epoch: 8, Steps: 64 | Train Loss: 0.0830421 Vali Loss: 0.2206797 Test Loss: 0.2763678
Validation loss decreased (0.225480 --> 0.220680).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 9 cost time: 0.9243288040161133
Epoch: 9, Steps: 64 | Train Loss: 0.0815629 Vali Loss: 0.2128829 Test Loss: 0.2780564
Validation loss decreased (0.220680 --> 0.212883).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 10 cost time: 0.9247970581054688
Epoch: 10, Steps: 64 | Train Loss: 0.0803089 Vali Loss: 0.2108910 Test Loss: 0.2765575
Validation loss decreased (0.212883 --> 0.210891).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 11 cost time: 0.9344027042388916
Epoch: 11, Steps: 64 | Train Loss: 0.0788306 Vali Loss: 0.2083937 Test Loss: 0.2727546
Validation loss decreased (0.210891 --> 0.208394).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 12 cost time: 0.9246125221252441
Epoch: 12, Steps: 64 | Train Loss: 0.0785715 Vali Loss: 0.2026916 Test Loss: 0.2722568
Validation loss decreased (0.208394 --> 0.202692).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 13 cost time: 0.9296166896820068
Epoch: 13, Steps: 64 | Train Loss: 0.0772367 Vali Loss: 0.2014260 Test Loss: 0.2706007
Validation loss decreased (0.202692 --> 0.201426).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 14 cost time: 0.9250984191894531
Epoch: 14, Steps: 64 | Train Loss: 0.0763152 Vali Loss: 0.1975340 Test Loss: 0.2684951
Validation loss decreased (0.201426 --> 0.197534).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 15 cost time: 0.9223484992980957
Epoch: 15, Steps: 64 | Train Loss: 0.0754978 Vali Loss: 0.1970621 Test Loss: 0.2673592
Validation loss decreased (0.197534 --> 0.197062).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 16 cost time: 0.9233236312866211
Epoch: 16, Steps: 64 | Train Loss: 0.0750535 Vali Loss: 0.1948989 Test Loss: 0.2683772
Validation loss decreased (0.197062 --> 0.194899).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 17 cost time: 0.9223997592926025
Epoch: 17, Steps: 64 | Train Loss: 0.0745940 Vali Loss: 0.1918597 Test Loss: 0.2655518
Validation loss decreased (0.194899 --> 0.191860).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 18 cost time: 0.9315838813781738
Epoch: 18, Steps: 64 | Train Loss: 0.0739870 Vali Loss: 0.1890665 Test Loss: 0.2661769
Validation loss decreased (0.191860 --> 0.189067).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 19 cost time: 0.9211866855621338
Epoch: 19, Steps: 64 | Train Loss: 0.0742944 Vali Loss: 0.1910020 Test Loss: 0.2642851
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 20 cost time: 0.9210000038146973
Epoch: 20, Steps: 64 | Train Loss: 0.0734239 Vali Loss: 0.1912725 Test Loss: 0.2636625
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 21 cost time: 0.9346308708190918
Epoch: 21, Steps: 64 | Train Loss: 0.0731810 Vali Loss: 0.1903108 Test Loss: 0.2647732
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 22 cost time: 0.9076113700866699
Epoch: 22, Steps: 64 | Train Loss: 0.0726927 Vali Loss: 0.1919993 Test Loss: 0.2631462
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 23 cost time: 0.910773754119873
Epoch: 23, Steps: 64 | Train Loss: 0.0726782 Vali Loss: 0.1903379 Test Loss: 0.2642637
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 24 cost time: 0.9113843441009521
Epoch: 24, Steps: 64 | Train Loss: 0.0722814 Vali Loss: 0.1867138 Test Loss: 0.2630621
Validation loss decreased (0.189067 --> 0.186714).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 25 cost time: 0.916318416595459
Epoch: 25, Steps: 64 | Train Loss: 0.0720837 Vali Loss: 0.1903425 Test Loss: 0.2608412
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 26 cost time: 0.9186456203460693
Epoch: 26, Steps: 64 | Train Loss: 0.0719793 Vali Loss: 0.1907902 Test Loss: 0.2622032
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 27 cost time: 0.8937911987304688
Epoch: 27, Steps: 64 | Train Loss: 0.0724316 Vali Loss: 0.1878800 Test Loss: 0.2609240
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 28 cost time: 0.9259984493255615
Epoch: 28, Steps: 64 | Train Loss: 0.0720028 Vali Loss: 0.1873153 Test Loss: 0.2607680
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 29 cost time: 0.925616979598999
Epoch: 29, Steps: 64 | Train Loss: 0.0714384 Vali Loss: 0.1880787 Test Loss: 0.2623121
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 30 cost time: 0.9193832874298096
Epoch: 30, Steps: 64 | Train Loss: 0.0718291 Vali Loss: 0.1881175 Test Loss: 0.2615240
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 31 cost time: 0.9143803119659424
Epoch: 31, Steps: 64 | Train Loss: 0.0716762 Vali Loss: 0.1876312 Test Loss: 0.2613706
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 32 cost time: 0.9215250015258789
Epoch: 32, Steps: 64 | Train Loss: 0.0715503 Vali Loss: 0.1891659 Test Loss: 0.2609768
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 33 cost time: 0.92041015625
Epoch: 33, Steps: 64 | Train Loss: 0.0716577 Vali Loss: 0.1877973 Test Loss: 0.2611857
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 34 cost time: 0.9277517795562744
Epoch: 34, Steps: 64 | Train Loss: 0.0715626 Vali Loss: 0.1878417 Test Loss: 0.2613580
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 35 cost time: 0.9357314109802246
Epoch: 35, Steps: 64 | Train Loss: 0.0712540 Vali Loss: 0.1892668 Test Loss: 0.2619346
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 36 cost time: 0.9233791828155518
Epoch: 36, Steps: 64 | Train Loss: 0.0714909 Vali Loss: 0.1870192 Test Loss: 0.2601770
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 37 cost time: 0.9226157665252686
Epoch: 37, Steps: 64 | Train Loss: 0.0713019 Vali Loss: 0.1875425 Test Loss: 0.2595855
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 38 cost time: 0.9413566589355469
Epoch: 38, Steps: 64 | Train Loss: 0.0710380 Vali Loss: 0.1866990 Test Loss: 0.2600163
Validation loss decreased (0.186714 --> 0.186699).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 39 cost time: 0.9154458045959473
Epoch: 39, Steps: 64 | Train Loss: 0.0710769 Vali Loss: 0.1851669 Test Loss: 0.2597081
Validation loss decreased (0.186699 --> 0.185167).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 40 cost time: 0.9213314056396484
Epoch: 40, Steps: 64 | Train Loss: 0.0711066 Vali Loss: 0.1868716 Test Loss: 0.2610417
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 41 cost time: 0.9283661842346191
Epoch: 41, Steps: 64 | Train Loss: 0.0711932 Vali Loss: 0.1855755 Test Loss: 0.2596633
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 42 cost time: 1.002467155456543
Epoch: 42, Steps: 64 | Train Loss: 0.0709918 Vali Loss: 0.1858524 Test Loss: 0.2603927
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 43 cost time: 0.9954025745391846
Epoch: 43, Steps: 64 | Train Loss: 0.0711600 Vali Loss: 0.1889632 Test Loss: 0.2612217
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 44 cost time: 0.9441478252410889
Epoch: 44, Steps: 64 | Train Loss: 0.0711363 Vali Loss: 0.1872715 Test Loss: 0.2604074
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 45 cost time: 0.9289999008178711
Epoch: 45, Steps: 64 | Train Loss: 0.0705893 Vali Loss: 0.1882128 Test Loss: 0.2612318
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 46 cost time: 0.9270005226135254
Epoch: 46, Steps: 64 | Train Loss: 0.0712057 Vali Loss: 0.1882346 Test Loss: 0.2600708
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 47 cost time: 0.917621374130249
Epoch: 47, Steps: 64 | Train Loss: 0.0705935 Vali Loss: 0.1869496 Test Loss: 0.2597477
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 48 cost time: 0.9106934070587158
Epoch: 48, Steps: 64 | Train Loss: 0.0709860 Vali Loss: 0.1870566 Test Loss: 0.2596924
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 49 cost time: 0.9263520240783691
Epoch: 49, Steps: 64 | Train Loss: 0.0707094 Vali Loss: 0.1893942 Test Loss: 0.2614253
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 50 cost time: 0.9244208335876465
Epoch: 50, Steps: 64 | Train Loss: 0.0710773 Vali Loss: 0.1896398 Test Loss: 0.2607758
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 51 cost time: 0.9493796825408936
Epoch: 51, Steps: 64 | Train Loss: 0.0713434 Vali Loss: 0.1870921 Test Loss: 0.2595790
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 52 cost time: 0.933159351348877
Epoch: 52, Steps: 64 | Train Loss: 0.0709173 Vali Loss: 0.1865409 Test Loss: 0.2604445
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 53 cost time: 0.9267590045928955
Epoch: 53, Steps: 64 | Train Loss: 0.0707847 Vali Loss: 0.1874067 Test Loss: 0.2608831
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 54 cost time: 0.9330000877380371
Epoch: 54, Steps: 64 | Train Loss: 0.0709685 Vali Loss: 0.1866088 Test Loss: 0.2602470
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 55 cost time: 0.9286079406738281
Epoch: 55, Steps: 64 | Train Loss: 0.0705894 Vali Loss: 0.1854837 Test Loss: 0.2595238
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 56 cost time: 0.9242911338806152
Epoch: 56, Steps: 64 | Train Loss: 0.0708928 Vali Loss: 0.1865985 Test Loss: 0.2607476
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 57 cost time: 0.9239962100982666
Epoch: 57, Steps: 64 | Train Loss: 0.0710219 Vali Loss: 0.1854229 Test Loss: 0.2586791
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 58 cost time: 0.936509370803833
Epoch: 58, Steps: 64 | Train Loss: 0.0708081 Vali Loss: 0.1874924 Test Loss: 0.2607284
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 59 cost time: 0.9293248653411865
Epoch: 59, Steps: 64 | Train Loss: 0.0704532 Vali Loss: 0.1832199 Test Loss: 0.2584999
Validation loss decreased (0.185167 --> 0.183220).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 60 cost time: 0.9334044456481934
Epoch: 60, Steps: 64 | Train Loss: 0.0708936 Vali Loss: 0.1869126 Test Loss: 0.2602797
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2584998905658722, mae:0.3193761706352234, rse:0.23334741592407227
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.062340736389160156 GB
Epoch: 1 cost time: 2.351386785507202
Epoch: 1, Steps: 64 | Train Loss: 0.8397960 Vali Loss: 2.5521591 Test Loss: 4.4800529
Validation loss decreased (inf --> 2.552159).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 2 cost time: 0.964390754699707
Epoch: 2, Steps: 64 | Train Loss: 0.3124277 Vali Loss: 0.3586773 Test Loss: 0.4334121
Validation loss decreased (2.552159 --> 0.358677).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 3 cost time: 0.9697504043579102
Epoch: 3, Steps: 64 | Train Loss: 0.1027631 Vali Loss: 0.2410262 Test Loss: 0.2846742
Validation loss decreased (0.358677 --> 0.241026).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 4 cost time: 0.9650001525878906
Epoch: 4, Steps: 64 | Train Loss: 0.0913612 Vali Loss: 0.2366548 Test Loss: 0.2859264
Validation loss decreased (0.241026 --> 0.236655).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 5 cost time: 0.9487099647521973
Epoch: 5, Steps: 64 | Train Loss: 0.0877936 Vali Loss: 0.2258883 Test Loss: 0.2800996
Validation loss decreased (0.236655 --> 0.225888).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 6 cost time: 0.9476141929626465
Epoch: 6, Steps: 64 | Train Loss: 0.0849418 Vali Loss: 0.2266498 Test Loss: 0.2829946
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 7 cost time: 0.9546072483062744
Epoch: 7, Steps: 64 | Train Loss: 0.0823806 Vali Loss: 0.2192668 Test Loss: 0.2805036
Validation loss decreased (0.225888 --> 0.219267).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 8 cost time: 0.9563748836517334
Epoch: 8, Steps: 64 | Train Loss: 0.0814316 Vali Loss: 0.2158067 Test Loss: 0.2745650
Validation loss decreased (0.219267 --> 0.215807).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 9 cost time: 0.9521498680114746
Epoch: 9, Steps: 64 | Train Loss: 0.0801204 Vali Loss: 0.2070215 Test Loss: 0.2799004
Validation loss decreased (0.215807 --> 0.207021).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 10 cost time: 0.9534103870391846
Epoch: 10, Steps: 64 | Train Loss: 0.0784850 Vali Loss: 0.2080708 Test Loss: 0.2747498
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 11 cost time: 0.9623923301696777
Epoch: 11, Steps: 64 | Train Loss: 0.0772212 Vali Loss: 0.2057630 Test Loss: 0.2748058
Validation loss decreased (0.207021 --> 0.205763).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 12 cost time: 1.0094435214996338
Epoch: 12, Steps: 64 | Train Loss: 0.0766387 Vali Loss: 0.2001571 Test Loss: 0.2722430
Validation loss decreased (0.205763 --> 0.200157).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 13 cost time: 0.9467456340789795
Epoch: 13, Steps: 64 | Train Loss: 0.0758462 Vali Loss: 0.1979096 Test Loss: 0.2720627
Validation loss decreased (0.200157 --> 0.197910).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 14 cost time: 0.9726719856262207
Epoch: 14, Steps: 64 | Train Loss: 0.0748267 Vali Loss: 0.1969949 Test Loss: 0.2705602
Validation loss decreased (0.197910 --> 0.196995).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 15 cost time: 0.9448871612548828
Epoch: 15, Steps: 64 | Train Loss: 0.0746498 Vali Loss: 0.1926345 Test Loss: 0.2687944
Validation loss decreased (0.196995 --> 0.192634).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 16 cost time: 0.9449973106384277
Epoch: 16, Steps: 64 | Train Loss: 0.0734958 Vali Loss: 0.1927490 Test Loss: 0.2695612
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 17 cost time: 0.9550435543060303
Epoch: 17, Steps: 64 | Train Loss: 0.0734297 Vali Loss: 0.1925679 Test Loss: 0.2688059
Validation loss decreased (0.192634 --> 0.192568).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 18 cost time: 0.9718661308288574
Epoch: 18, Steps: 64 | Train Loss: 0.0733039 Vali Loss: 0.1922226 Test Loss: 0.2688305
Validation loss decreased (0.192568 --> 0.192223).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 19 cost time: 0.9608039855957031
Epoch: 19, Steps: 64 | Train Loss: 0.0728400 Vali Loss: 0.1894076 Test Loss: 0.2682290
Validation loss decreased (0.192223 --> 0.189408).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 20 cost time: 0.9596421718597412
Epoch: 20, Steps: 64 | Train Loss: 0.0726475 Vali Loss: 0.1929632 Test Loss: 0.2679207
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 21 cost time: 0.9639995098114014
Epoch: 21, Steps: 64 | Train Loss: 0.0721677 Vali Loss: 0.1860655 Test Loss: 0.2676986
Validation loss decreased (0.189408 --> 0.186065).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 22 cost time: 0.9535465240478516
Epoch: 22, Steps: 64 | Train Loss: 0.0717836 Vali Loss: 0.1875903 Test Loss: 0.2675349
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 23 cost time: 0.9540436267852783
Epoch: 23, Steps: 64 | Train Loss: 0.0718427 Vali Loss: 0.1901550 Test Loss: 0.2686565
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 24 cost time: 0.9545369148254395
Epoch: 24, Steps: 64 | Train Loss: 0.0711620 Vali Loss: 0.1865703 Test Loss: 0.2663409
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 25 cost time: 0.9619748592376709
Epoch: 25, Steps: 64 | Train Loss: 0.0712163 Vali Loss: 0.1859028 Test Loss: 0.2656757
Validation loss decreased (0.186065 --> 0.185903).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 26 cost time: 0.958000898361206
Epoch: 26, Steps: 64 | Train Loss: 0.0713897 Vali Loss: 0.1869608 Test Loss: 0.2667951
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 27 cost time: 0.9550642967224121
Epoch: 27, Steps: 64 | Train Loss: 0.0710852 Vali Loss: 0.1865198 Test Loss: 0.2659902
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 28 cost time: 1.0420913696289062
Epoch: 28, Steps: 64 | Train Loss: 0.0709801 Vali Loss: 0.1875369 Test Loss: 0.2663115
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 29 cost time: 1.0256731510162354
Epoch: 29, Steps: 64 | Train Loss: 0.0707327 Vali Loss: 0.1859298 Test Loss: 0.2655610
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 30 cost time: 0.9521744251251221
Epoch: 30, Steps: 64 | Train Loss: 0.0710733 Vali Loss: 0.1867095 Test Loss: 0.2656785
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 31 cost time: 0.9301562309265137
Epoch: 31, Steps: 64 | Train Loss: 0.0709202 Vali Loss: 0.1863365 Test Loss: 0.2662713
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 32 cost time: 0.9526395797729492
Epoch: 32, Steps: 64 | Train Loss: 0.0705222 Vali Loss: 0.1862966 Test Loss: 0.2650518
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 33 cost time: 0.9570159912109375
Epoch: 33, Steps: 64 | Train Loss: 0.0707004 Vali Loss: 0.1846408 Test Loss: 0.2660610
Validation loss decreased (0.185903 --> 0.184641).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 34 cost time: 0.9815640449523926
Epoch: 34, Steps: 64 | Train Loss: 0.0705819 Vali Loss: 0.1873711 Test Loss: 0.2672980
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 35 cost time: 0.9558281898498535
Epoch: 35, Steps: 64 | Train Loss: 0.0706797 Vali Loss: 0.1880073 Test Loss: 0.2654316
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 36 cost time: 0.9646341800689697
Epoch: 36, Steps: 64 | Train Loss: 0.0700587 Vali Loss: 0.1850688 Test Loss: 0.2648380
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 37 cost time: 0.9618449211120605
Epoch: 37, Steps: 64 | Train Loss: 0.0702073 Vali Loss: 0.1845415 Test Loss: 0.2653206
Validation loss decreased (0.184641 --> 0.184541).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 38 cost time: 0.9538886547088623
Epoch: 38, Steps: 64 | Train Loss: 0.0699486 Vali Loss: 0.1852620 Test Loss: 0.2653148
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 39 cost time: 1.0471627712249756
Epoch: 39, Steps: 64 | Train Loss: 0.0697974 Vali Loss: 0.1842268 Test Loss: 0.2657659
Validation loss decreased (0.184541 --> 0.184227).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 40 cost time: 1.0388786792755127
Epoch: 40, Steps: 64 | Train Loss: 0.0701887 Vali Loss: 0.1832278 Test Loss: 0.2657201
Validation loss decreased (0.184227 --> 0.183228).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 41 cost time: 0.9535036087036133
Epoch: 41, Steps: 64 | Train Loss: 0.0701407 Vali Loss: 0.1833282 Test Loss: 0.2655974
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 42 cost time: 0.9579029083251953
Epoch: 42, Steps: 64 | Train Loss: 0.0704447 Vali Loss: 0.1859163 Test Loss: 0.2649073
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 43 cost time: 0.9549999237060547
Epoch: 43, Steps: 64 | Train Loss: 0.0701438 Vali Loss: 0.1839029 Test Loss: 0.2664154
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 44 cost time: 0.9351272583007812
Epoch: 44, Steps: 64 | Train Loss: 0.0699366 Vali Loss: 0.1849037 Test Loss: 0.2667439
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 45 cost time: 0.9521403312683105
Epoch: 45, Steps: 64 | Train Loss: 0.0698146 Vali Loss: 0.1854735 Test Loss: 0.2640301
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 46 cost time: 0.9524209499359131
Epoch: 46, Steps: 64 | Train Loss: 0.0703795 Vali Loss: 0.1849433 Test Loss: 0.2661712
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 47 cost time: 0.9462931156158447
Epoch: 47, Steps: 64 | Train Loss: 0.0704064 Vali Loss: 0.1861131 Test Loss: 0.2653771
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 48 cost time: 0.9444305896759033
Epoch: 48, Steps: 64 | Train Loss: 0.0703812 Vali Loss: 0.1831571 Test Loss: 0.2656763
Validation loss decreased (0.183228 --> 0.183157).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 49 cost time: 0.9589722156524658
Epoch: 49, Steps: 64 | Train Loss: 0.0700919 Vali Loss: 0.1848944 Test Loss: 0.2643243
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 50 cost time: 0.9527318477630615
Epoch: 50, Steps: 64 | Train Loss: 0.0702462 Vali Loss: 0.1846134 Test Loss: 0.2649582
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 51 cost time: 0.9923691749572754
Epoch: 51, Steps: 64 | Train Loss: 0.0701714 Vali Loss: 0.1845538 Test Loss: 0.2653576
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 52 cost time: 0.9567439556121826
Epoch: 52, Steps: 64 | Train Loss: 0.0701470 Vali Loss: 0.1853586 Test Loss: 0.2655779
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 53 cost time: 0.9438655376434326
Epoch: 53, Steps: 64 | Train Loss: 0.0700677 Vali Loss: 0.1851552 Test Loss: 0.2648149
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 54 cost time: 0.9449999332427979
Epoch: 54, Steps: 64 | Train Loss: 0.0699232 Vali Loss: 0.1860161 Test Loss: 0.2668938
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 55 cost time: 0.9436187744140625
Epoch: 55, Steps: 64 | Train Loss: 0.0702060 Vali Loss: 0.1849415 Test Loss: 0.2652069
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 56 cost time: 0.9436204433441162
Epoch: 56, Steps: 64 | Train Loss: 0.0701680 Vali Loss: 0.1847828 Test Loss: 0.2660978
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 57 cost time: 0.9631397724151611
Epoch: 57, Steps: 64 | Train Loss: 0.0702381 Vali Loss: 0.1823415 Test Loss: 0.2647241
Validation loss decreased (0.183157 --> 0.182342).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 58 cost time: 0.9553303718566895
Epoch: 58, Steps: 64 | Train Loss: 0.0703062 Vali Loss: 0.1828577 Test Loss: 0.2654140
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 59 cost time: 0.9593362808227539
Epoch: 59, Steps: 64 | Train Loss: 0.0693730 Vali Loss: 0.1840867 Test Loss: 0.2653548
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 60 cost time: 0.9724094867706299
Epoch: 60, Steps: 64 | Train Loss: 0.0696468 Vali Loss: 0.1860471 Test Loss: 0.2659535
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.26472410559654236, mae:0.3263722360134125, rse:0.23613999783992767
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.057959556579589844 GB
Epoch: 1 cost time: 2.265129804611206
Epoch: 1, Steps: 64 | Train Loss: 0.8877468 Vali Loss: 2.6077244 Test Loss: 4.6728263
Validation loss decreased (inf --> 2.607724).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 2 cost time: 0.8667855262756348
Epoch: 2, Steps: 64 | Train Loss: 0.6901526 Vali Loss: 1.4985168 Test Loss: 2.5378096
Validation loss decreased (2.607724 --> 1.498517).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 3 cost time: 0.8700006008148193
Epoch: 3, Steps: 64 | Train Loss: 0.4145589 Vali Loss: 0.9120620 Test Loss: 1.4165345
Validation loss decreased (1.498517 --> 0.912062).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 4 cost time: 0.8292684555053711
Epoch: 4, Steps: 64 | Train Loss: 0.2632385 Vali Loss: 0.6085895 Test Loss: 0.9032594
Validation loss decreased (0.912062 --> 0.608589).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 5 cost time: 0.8544933795928955
Epoch: 5, Steps: 64 | Train Loss: 0.1817559 Vali Loss: 0.4349354 Test Loss: 0.6093686
Validation loss decreased (0.608589 --> 0.434935).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 6 cost time: 0.8543493747711182
Epoch: 6, Steps: 64 | Train Loss: 0.1426647 Vali Loss: 0.3452007 Test Loss: 0.4692996
Validation loss decreased (0.434935 --> 0.345201).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 7 cost time: 0.8619935512542725
Epoch: 7, Steps: 64 | Train Loss: 0.1234895 Vali Loss: 0.2982270 Test Loss: 0.3951870
Validation loss decreased (0.345201 --> 0.298227).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 8 cost time: 0.8480000495910645
Epoch: 8, Steps: 64 | Train Loss: 0.1138556 Vali Loss: 0.2745182 Test Loss: 0.3543491
Validation loss decreased (0.298227 --> 0.274518).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 9 cost time: 0.8576192855834961
Epoch: 9, Steps: 64 | Train Loss: 0.1075222 Vali Loss: 0.2577630 Test Loss: 0.3355952
Validation loss decreased (0.274518 --> 0.257763).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 10 cost time: 0.8523886203765869
Epoch: 10, Steps: 64 | Train Loss: 0.1038212 Vali Loss: 0.2487838 Test Loss: 0.3226215
Validation loss decreased (0.257763 --> 0.248784).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 11 cost time: 0.8792111873626709
Epoch: 11, Steps: 64 | Train Loss: 0.1011639 Vali Loss: 0.2406904 Test Loss: 0.3151451
Validation loss decreased (0.248784 --> 0.240690).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 12 cost time: 0.8569769859313965
Epoch: 12, Steps: 64 | Train Loss: 0.0993533 Vali Loss: 0.2371370 Test Loss: 0.3088607
Validation loss decreased (0.240690 --> 0.237137).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 13 cost time: 0.8570001125335693
Epoch: 13, Steps: 64 | Train Loss: 0.0978328 Vali Loss: 0.2273324 Test Loss: 0.3041693
Validation loss decreased (0.237137 --> 0.227332).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 14 cost time: 0.8570001125335693
Epoch: 14, Steps: 64 | Train Loss: 0.0966249 Vali Loss: 0.2274294 Test Loss: 0.3017235
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 15 cost time: 0.8593907356262207
Epoch: 15, Steps: 64 | Train Loss: 0.0956469 Vali Loss: 0.2256245 Test Loss: 0.3027228
Validation loss decreased (0.227332 --> 0.225624).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 16 cost time: 0.8553540706634521
Epoch: 16, Steps: 64 | Train Loss: 0.0944173 Vali Loss: 0.2267059 Test Loss: 0.3005259
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 17 cost time: 0.8533759117126465
Epoch: 17, Steps: 64 | Train Loss: 0.0938896 Vali Loss: 0.2210826 Test Loss: 0.2989233
Validation loss decreased (0.225624 --> 0.221083).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 18 cost time: 0.8647758960723877
Epoch: 18, Steps: 64 | Train Loss: 0.0936871 Vali Loss: 0.2202403 Test Loss: 0.2989561
Validation loss decreased (0.221083 --> 0.220240).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 19 cost time: 0.8509986400604248
Epoch: 19, Steps: 64 | Train Loss: 0.0920944 Vali Loss: 0.2176344 Test Loss: 0.2979256
Validation loss decreased (0.220240 --> 0.217634).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 20 cost time: 0.8611390590667725
Epoch: 20, Steps: 64 | Train Loss: 0.0920483 Vali Loss: 0.2167899 Test Loss: 0.2973973
Validation loss decreased (0.217634 --> 0.216790).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 21 cost time: 0.8613660335540771
Epoch: 21, Steps: 64 | Train Loss: 0.0919097 Vali Loss: 0.2155216 Test Loss: 0.2967586
Validation loss decreased (0.216790 --> 0.215522).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 22 cost time: 0.869330644607544
Epoch: 22, Steps: 64 | Train Loss: 0.0913353 Vali Loss: 0.2184662 Test Loss: 0.2957624
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 23 cost time: 0.8657867908477783
Epoch: 23, Steps: 64 | Train Loss: 0.0902510 Vali Loss: 0.2165145 Test Loss: 0.2965223
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 24 cost time: 0.8629999160766602
Epoch: 24, Steps: 64 | Train Loss: 0.0910174 Vali Loss: 0.2159402 Test Loss: 0.2968770
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 25 cost time: 0.856010913848877
Epoch: 25, Steps: 64 | Train Loss: 0.0904793 Vali Loss: 0.2127911 Test Loss: 0.2944189
Validation loss decreased (0.215522 --> 0.212791).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 26 cost time: 0.8646314144134521
Epoch: 26, Steps: 64 | Train Loss: 0.0900805 Vali Loss: 0.2127532 Test Loss: 0.2944675
Validation loss decreased (0.212791 --> 0.212753).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 27 cost time: 0.8584179878234863
Epoch: 27, Steps: 64 | Train Loss: 0.0898465 Vali Loss: 0.2120027 Test Loss: 0.2965223
Validation loss decreased (0.212753 --> 0.212003).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 28 cost time: 0.8557312488555908
Epoch: 28, Steps: 64 | Train Loss: 0.0897089 Vali Loss: 0.2124875 Test Loss: 0.2958722
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 29 cost time: 0.8650000095367432
Epoch: 29, Steps: 64 | Train Loss: 0.0897098 Vali Loss: 0.2158548 Test Loss: 0.2957061
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 30 cost time: 0.8526239395141602
Epoch: 30, Steps: 64 | Train Loss: 0.0902642 Vali Loss: 0.2089880 Test Loss: 0.2942237
Validation loss decreased (0.212003 --> 0.208988).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 31 cost time: 0.8604450225830078
Epoch: 31, Steps: 64 | Train Loss: 0.0893280 Vali Loss: 0.2124750 Test Loss: 0.2946741
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 32 cost time: 0.8644871711730957
Epoch: 32, Steps: 64 | Train Loss: 0.0888218 Vali Loss: 0.2095796 Test Loss: 0.2942387
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 33 cost time: 0.8623261451721191
Epoch: 33, Steps: 64 | Train Loss: 0.0889960 Vali Loss: 0.2122864 Test Loss: 0.2937335
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 34 cost time: 0.8554368019104004
Epoch: 34, Steps: 64 | Train Loss: 0.0889266 Vali Loss: 0.2140632 Test Loss: 0.2948213
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 35 cost time: 0.86061692237854
Epoch: 35, Steps: 64 | Train Loss: 0.0890695 Vali Loss: 0.2093884 Test Loss: 0.2945351
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 36 cost time: 0.8593766689300537
Epoch: 36, Steps: 64 | Train Loss: 0.0886510 Vali Loss: 0.2104824 Test Loss: 0.2936935
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 37 cost time: 0.8782360553741455
Epoch: 37, Steps: 64 | Train Loss: 0.0883648 Vali Loss: 0.2111599 Test Loss: 0.2937309
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 38 cost time: 0.8793430328369141
Epoch: 38, Steps: 64 | Train Loss: 0.0885325 Vali Loss: 0.2103297 Test Loss: 0.2939264
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 39 cost time: 0.8803985118865967
Epoch: 39, Steps: 64 | Train Loss: 0.0882844 Vali Loss: 0.2096500 Test Loss: 0.2936190
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 40 cost time: 0.8830001354217529
Epoch: 40, Steps: 64 | Train Loss: 0.0881888 Vali Loss: 0.2099690 Test Loss: 0.2936703
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 41 cost time: 0.8826215267181396
Epoch: 41, Steps: 64 | Train Loss: 0.0884102 Vali Loss: 0.2107659 Test Loss: 0.2941819
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 42 cost time: 0.8833420276641846
Epoch: 42, Steps: 64 | Train Loss: 0.0883258 Vali Loss: 0.2079115 Test Loss: 0.2940366
Validation loss decreased (0.208988 --> 0.207912).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 43 cost time: 0.87434983253479
Epoch: 43, Steps: 64 | Train Loss: 0.0882082 Vali Loss: 0.2079713 Test Loss: 0.2941786
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 44 cost time: 0.8829572200775146
Epoch: 44, Steps: 64 | Train Loss: 0.0879771 Vali Loss: 0.2103694 Test Loss: 0.2949820
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 45 cost time: 0.8729977607727051
Epoch: 45, Steps: 64 | Train Loss: 0.0883934 Vali Loss: 0.2093591 Test Loss: 0.2947312
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 46 cost time: 0.8766112327575684
Epoch: 46, Steps: 64 | Train Loss: 0.0882022 Vali Loss: 0.2110627 Test Loss: 0.2945139
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 47 cost time: 0.8783755302429199
Epoch: 47, Steps: 64 | Train Loss: 0.0877892 Vali Loss: 0.2112206 Test Loss: 0.2928956
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 48 cost time: 0.8690140247344971
Epoch: 48, Steps: 64 | Train Loss: 0.0877269 Vali Loss: 0.2077636 Test Loss: 0.2925490
Validation loss decreased (0.207912 --> 0.207764).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 49 cost time: 0.8613636493682861
Epoch: 49, Steps: 64 | Train Loss: 0.0878648 Vali Loss: 0.2113016 Test Loss: 0.2953200
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 50 cost time: 0.8627364635467529
Epoch: 50, Steps: 64 | Train Loss: 0.0880124 Vali Loss: 0.2111561 Test Loss: 0.2939470
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 51 cost time: 0.8553698062896729
Epoch: 51, Steps: 64 | Train Loss: 0.0879417 Vali Loss: 0.2094886 Test Loss: 0.2944621
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 52 cost time: 0.8715991973876953
Epoch: 52, Steps: 64 | Train Loss: 0.0876305 Vali Loss: 0.2107515 Test Loss: 0.2946393
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 53 cost time: 0.8709630966186523
Epoch: 53, Steps: 64 | Train Loss: 0.0878770 Vali Loss: 0.2080087 Test Loss: 0.2940817
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 54 cost time: 0.881385087966919
Epoch: 54, Steps: 64 | Train Loss: 0.0878554 Vali Loss: 0.2097709 Test Loss: 0.2935252
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 55 cost time: 0.8687503337860107
Epoch: 55, Steps: 64 | Train Loss: 0.0878876 Vali Loss: 0.2092747 Test Loss: 0.2943092
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 56 cost time: 0.8789999485015869
Epoch: 56, Steps: 64 | Train Loss: 0.0879049 Vali Loss: 0.2089386 Test Loss: 0.2929909
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 57 cost time: 0.8846008777618408
Epoch: 57, Steps: 64 | Train Loss: 0.0876151 Vali Loss: 0.2124234 Test Loss: 0.2946455
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 58 cost time: 0.881594181060791
Epoch: 58, Steps: 64 | Train Loss: 0.0877103 Vali Loss: 0.2108470 Test Loss: 0.2936551
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 59 cost time: 0.8873026371002197
Epoch: 59, Steps: 64 | Train Loss: 0.0875090 Vali Loss: 0.2103960 Test Loss: 0.2941346
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 60 cost time: 0.8815512657165527
Epoch: 60, Steps: 64 | Train Loss: 0.0875507 Vali Loss: 0.2099783 Test Loss: 0.2954078
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.29254892468452454, mae:0.35522112250328064, rse:0.2482401728630066
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.062354087829589844 GB
Epoch: 1 cost time: 2.3057785034179688
Epoch: 1, Steps: 64 | Train Loss: 0.8002852 Vali Loss: 2.4374373 Test Loss: 4.2380428
Validation loss decreased (inf --> 2.437437).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 2 cost time: 0.9190001487731934
Epoch: 2, Steps: 64 | Train Loss: 0.3764190 Vali Loss: 0.3674944 Test Loss: 0.3455674
Validation loss decreased (2.437437 --> 0.367494).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 3 cost time: 0.9176015853881836
Epoch: 3, Steps: 64 | Train Loss: 0.1104782 Vali Loss: 0.2553025 Test Loss: 0.2962779
Validation loss decreased (0.367494 --> 0.255303).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 4 cost time: 0.9196062088012695
Epoch: 4, Steps: 64 | Train Loss: 0.0973302 Vali Loss: 0.2377652 Test Loss: 0.2920770
Validation loss decreased (0.255303 --> 0.237765).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 5 cost time: 0.9183499813079834
Epoch: 5, Steps: 64 | Train Loss: 0.0918749 Vali Loss: 0.2353576 Test Loss: 0.2877718
Validation loss decreased (0.237765 --> 0.235358).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 6 cost time: 0.9056375026702881
Epoch: 6, Steps: 64 | Train Loss: 0.0884144 Vali Loss: 0.2277758 Test Loss: 0.2866002
Validation loss decreased (0.235358 --> 0.227776).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 7 cost time: 0.911963701248169
Epoch: 7, Steps: 64 | Train Loss: 0.0862468 Vali Loss: 0.2235306 Test Loss: 0.2883152
Validation loss decreased (0.227776 --> 0.223531).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 8 cost time: 0.9143304824829102
Epoch: 8, Steps: 64 | Train Loss: 0.0835092 Vali Loss: 0.2162664 Test Loss: 0.2864133
Validation loss decreased (0.223531 --> 0.216266).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 9 cost time: 0.9067115783691406
Epoch: 9, Steps: 64 | Train Loss: 0.0822936 Vali Loss: 0.2147853 Test Loss: 0.2877427
Validation loss decreased (0.216266 --> 0.214785).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 10 cost time: 0.9500000476837158
Epoch: 10, Steps: 64 | Train Loss: 0.0803538 Vali Loss: 0.2140059 Test Loss: 0.2863621
Validation loss decreased (0.214785 --> 0.214006).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 11 cost time: 0.9384901523590088
Epoch: 11, Steps: 64 | Train Loss: 0.0798719 Vali Loss: 0.2080384 Test Loss: 0.2860024
Validation loss decreased (0.214006 --> 0.208038).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 12 cost time: 0.9189448356628418
Epoch: 12, Steps: 64 | Train Loss: 0.0787114 Vali Loss: 0.2094361 Test Loss: 0.2857307
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 13 cost time: 0.9179999828338623
Epoch: 13, Steps: 64 | Train Loss: 0.0779294 Vali Loss: 0.2069961 Test Loss: 0.2870429
Validation loss decreased (0.208038 --> 0.206996).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 14 cost time: 0.9236040115356445
Epoch: 14, Steps: 64 | Train Loss: 0.0769925 Vali Loss: 0.2065360 Test Loss: 0.2851606
Validation loss decreased (0.206996 --> 0.206536).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 15 cost time: 0.9136285781860352
Epoch: 15, Steps: 64 | Train Loss: 0.0762898 Vali Loss: 0.2014481 Test Loss: 0.2862227
Validation loss decreased (0.206536 --> 0.201448).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 16 cost time: 0.9179999828338623
Epoch: 16, Steps: 64 | Train Loss: 0.0763792 Vali Loss: 0.2011845 Test Loss: 0.2853856
Validation loss decreased (0.201448 --> 0.201185).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 17 cost time: 0.9186062812805176
Epoch: 17, Steps: 64 | Train Loss: 0.0759395 Vali Loss: 0.2024547 Test Loss: 0.2851745
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 18 cost time: 0.9179997444152832
Epoch: 18, Steps: 64 | Train Loss: 0.0752055 Vali Loss: 0.2010611 Test Loss: 0.2862724
Validation loss decreased (0.201185 --> 0.201061).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 19 cost time: 0.9296042919158936
Epoch: 19, Steps: 64 | Train Loss: 0.0748688 Vali Loss: 0.1987235 Test Loss: 0.2846131
Validation loss decreased (0.201061 --> 0.198724).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 20 cost time: 0.9215984344482422
Epoch: 20, Steps: 64 | Train Loss: 0.0746778 Vali Loss: 0.2020889 Test Loss: 0.2850723
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 21 cost time: 0.9153409004211426
Epoch: 21, Steps: 64 | Train Loss: 0.0737326 Vali Loss: 0.2009266 Test Loss: 0.2844805
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 22 cost time: 0.9133813381195068
Epoch: 22, Steps: 64 | Train Loss: 0.0739459 Vali Loss: 0.1973745 Test Loss: 0.2838462
Validation loss decreased (0.198724 --> 0.197375).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 23 cost time: 0.9053804874420166
Epoch: 23, Steps: 64 | Train Loss: 0.0734204 Vali Loss: 0.1993722 Test Loss: 0.2848164
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 24 cost time: 0.9001932144165039
Epoch: 24, Steps: 64 | Train Loss: 0.0733120 Vali Loss: 0.1965968 Test Loss: 0.2847154
Validation loss decreased (0.197375 --> 0.196597).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 25 cost time: 0.8939998149871826
Epoch: 25, Steps: 64 | Train Loss: 0.0734163 Vali Loss: 0.1950189 Test Loss: 0.2837651
Validation loss decreased (0.196597 --> 0.195019).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 26 cost time: 0.9099998474121094
Epoch: 26, Steps: 64 | Train Loss: 0.0733115 Vali Loss: 0.1980531 Test Loss: 0.2842625
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 27 cost time: 0.8776564598083496
Epoch: 27, Steps: 64 | Train Loss: 0.0724612 Vali Loss: 0.1961448 Test Loss: 0.2837236
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 28 cost time: 0.8751344680786133
Epoch: 28, Steps: 64 | Train Loss: 0.0728488 Vali Loss: 0.1974952 Test Loss: 0.2849567
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 29 cost time: 0.8953633308410645
Epoch: 29, Steps: 64 | Train Loss: 0.0726039 Vali Loss: 0.1960370 Test Loss: 0.2841311
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 30 cost time: 0.8873755931854248
Epoch: 30, Steps: 64 | Train Loss: 0.0728604 Vali Loss: 0.1951798 Test Loss: 0.2832632
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 31 cost time: 0.896747350692749
Epoch: 31, Steps: 64 | Train Loss: 0.0728206 Vali Loss: 0.1964117 Test Loss: 0.2835945
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 32 cost time: 0.8937773704528809
Epoch: 32, Steps: 64 | Train Loss: 0.0721646 Vali Loss: 0.1943187 Test Loss: 0.2832556
Validation loss decreased (0.195019 --> 0.194319).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 33 cost time: 0.8956148624420166
Epoch: 33, Steps: 64 | Train Loss: 0.0719746 Vali Loss: 0.1940304 Test Loss: 0.2834301
Validation loss decreased (0.194319 --> 0.194030).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 34 cost time: 0.8939216136932373
Epoch: 34, Steps: 64 | Train Loss: 0.0719866 Vali Loss: 0.1955495 Test Loss: 0.2835620
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 35 cost time: 0.8993697166442871
Epoch: 35, Steps: 64 | Train Loss: 0.0716674 Vali Loss: 0.1932748 Test Loss: 0.2835957
Validation loss decreased (0.194030 --> 0.193275).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 36 cost time: 0.8994359970092773
Epoch: 36, Steps: 64 | Train Loss: 0.0722289 Vali Loss: 0.1935553 Test Loss: 0.2835558
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 37 cost time: 0.9161927700042725
Epoch: 37, Steps: 64 | Train Loss: 0.0720024 Vali Loss: 0.1940337 Test Loss: 0.2838177
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 38 cost time: 0.9049997329711914
Epoch: 38, Steps: 64 | Train Loss: 0.0717350 Vali Loss: 0.1931766 Test Loss: 0.2838278
Validation loss decreased (0.193275 --> 0.193177).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 39 cost time: 0.9009995460510254
Epoch: 39, Steps: 64 | Train Loss: 0.0718422 Vali Loss: 0.1905075 Test Loss: 0.2837315
Validation loss decreased (0.193177 --> 0.190508).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 40 cost time: 0.9047532081604004
Epoch: 40, Steps: 64 | Train Loss: 0.0716789 Vali Loss: 0.1918059 Test Loss: 0.2833005
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 41 cost time: 0.898155927658081
Epoch: 41, Steps: 64 | Train Loss: 0.0723615 Vali Loss: 0.1937073 Test Loss: 0.2841700
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 42 cost time: 0.8983731269836426
Epoch: 42, Steps: 64 | Train Loss: 0.0715165 Vali Loss: 0.1941978 Test Loss: 0.2842849
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 43 cost time: 0.8964643478393555
Epoch: 43, Steps: 64 | Train Loss: 0.0717178 Vali Loss: 0.1950711 Test Loss: 0.2834921
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 44 cost time: 0.8950529098510742
Epoch: 44, Steps: 64 | Train Loss: 0.0717838 Vali Loss: 0.1945712 Test Loss: 0.2834538
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 45 cost time: 0.8997893333435059
Epoch: 45, Steps: 64 | Train Loss: 0.0714475 Vali Loss: 0.1944693 Test Loss: 0.2833003
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 46 cost time: 0.8976156711578369
Epoch: 46, Steps: 64 | Train Loss: 0.0719005 Vali Loss: 0.1937147 Test Loss: 0.2833844
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 47 cost time: 0.900395393371582
Epoch: 47, Steps: 64 | Train Loss: 0.0716645 Vali Loss: 0.1899142 Test Loss: 0.2834071
Validation loss decreased (0.190508 --> 0.189914).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 48 cost time: 0.8748996257781982
Epoch: 48, Steps: 64 | Train Loss: 0.0717151 Vali Loss: 0.1924949 Test Loss: 0.2837008
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 49 cost time: 0.8884303569793701
Epoch: 49, Steps: 64 | Train Loss: 0.0716787 Vali Loss: 0.1949601 Test Loss: 0.2841240
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 50 cost time: 0.895179271697998
Epoch: 50, Steps: 64 | Train Loss: 0.0714624 Vali Loss: 0.1923930 Test Loss: 0.2831745
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 51 cost time: 0.8929998874664307
Epoch: 51, Steps: 64 | Train Loss: 0.0715820 Vali Loss: 0.1894088 Test Loss: 0.2833938
Validation loss decreased (0.189914 --> 0.189409).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 52 cost time: 0.8929998874664307
Epoch: 52, Steps: 64 | Train Loss: 0.0716747 Vali Loss: 0.1924914 Test Loss: 0.2828336
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 53 cost time: 0.8992190361022949
Epoch: 53, Steps: 64 | Train Loss: 0.0717071 Vali Loss: 0.1923016 Test Loss: 0.2831834
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 54 cost time: 0.8967978954315186
Epoch: 54, Steps: 64 | Train Loss: 0.0717680 Vali Loss: 0.1957541 Test Loss: 0.2833948
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 55 cost time: 0.9023761749267578
Epoch: 55, Steps: 64 | Train Loss: 0.0715377 Vali Loss: 0.1932385 Test Loss: 0.2835692
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 56 cost time: 0.9004275798797607
Epoch: 56, Steps: 64 | Train Loss: 0.0711386 Vali Loss: 0.1932234 Test Loss: 0.2830531
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 57 cost time: 0.8967645168304443
Epoch: 57, Steps: 64 | Train Loss: 0.0717756 Vali Loss: 0.1948702 Test Loss: 0.2837914
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 58 cost time: 0.9007515907287598
Epoch: 58, Steps: 64 | Train Loss: 0.0716340 Vali Loss: 0.1950222 Test Loss: 0.2831479
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 59 cost time: 0.8983879089355469
Epoch: 59, Steps: 64 | Train Loss: 0.0715131 Vali Loss: 0.1940041 Test Loss: 0.2829345
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 60 cost time: 0.896355152130127
Epoch: 60, Steps: 64 | Train Loss: 0.0715658 Vali Loss: 0.1917903 Test Loss: 0.2836005
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2833937108516693, mae:0.3530164062976837, rse:0.24432499706745148
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.06565284729003906 GB
Epoch: 1 cost time: 2.2266855239868164
Epoch: 1, Steps: 64 | Train Loss: 0.8455475 Vali Loss: 2.5815930 Test Loss: 4.5775261
Validation loss decreased (inf --> 2.581593).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 2 cost time: 0.8481276035308838
Epoch: 2, Steps: 64 | Train Loss: 0.3555207 Vali Loss: 0.3472886 Test Loss: 0.3859266
Validation loss decreased (2.581593 --> 0.347289).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 3 cost time: 0.8268752098083496
Epoch: 3, Steps: 64 | Train Loss: 0.1078655 Vali Loss: 0.2575985 Test Loss: 0.3061707
Validation loss decreased (0.347289 --> 0.257599).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 4 cost time: 0.853553295135498
Epoch: 4, Steps: 64 | Train Loss: 0.0937160 Vali Loss: 0.2375209 Test Loss: 0.2899709
Validation loss decreased (0.257599 --> 0.237521).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 5 cost time: 0.8746242523193359
Epoch: 5, Steps: 64 | Train Loss: 0.0897674 Vali Loss: 0.2323631 Test Loss: 0.2874605
Validation loss decreased (0.237521 --> 0.232363).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 6 cost time: 0.8566131591796875
Epoch: 6, Steps: 64 | Train Loss: 0.0868626 Vali Loss: 0.2268350 Test Loss: 0.2841702
Validation loss decreased (0.232363 --> 0.226835).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 7 cost time: 0.8543715476989746
Epoch: 7, Steps: 64 | Train Loss: 0.0847232 Vali Loss: 0.2255014 Test Loss: 0.2828164
Validation loss decreased (0.226835 --> 0.225501).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 8 cost time: 0.851398229598999
Epoch: 8, Steps: 64 | Train Loss: 0.0825168 Vali Loss: 0.2172438 Test Loss: 0.2817643
Validation loss decreased (0.225501 --> 0.217244).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 9 cost time: 0.8606302738189697
Epoch: 9, Steps: 64 | Train Loss: 0.0808553 Vali Loss: 0.2155880 Test Loss: 0.2833112
Validation loss decreased (0.217244 --> 0.215588).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 10 cost time: 0.8539998531341553
Epoch: 10, Steps: 64 | Train Loss: 0.0795011 Vali Loss: 0.2124246 Test Loss: 0.2812307
Validation loss decreased (0.215588 --> 0.212425).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 11 cost time: 0.8553578853607178
Epoch: 11, Steps: 64 | Train Loss: 0.0785452 Vali Loss: 0.2110451 Test Loss: 0.2818192
Validation loss decreased (0.212425 --> 0.211045).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 12 cost time: 0.8603501319885254
Epoch: 12, Steps: 64 | Train Loss: 0.0775264 Vali Loss: 0.2068332 Test Loss: 0.2836541
Validation loss decreased (0.211045 --> 0.206833).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 13 cost time: 0.8643174171447754
Epoch: 13, Steps: 64 | Train Loss: 0.0764475 Vali Loss: 0.2080819 Test Loss: 0.2822126
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 14 cost time: 0.8588688373565674
Epoch: 14, Steps: 64 | Train Loss: 0.0757200 Vali Loss: 0.2033511 Test Loss: 0.2858211
Validation loss decreased (0.206833 --> 0.203351).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 15 cost time: 0.8540000915527344
Epoch: 15, Steps: 64 | Train Loss: 0.0751577 Vali Loss: 0.2026662 Test Loss: 0.2839892
Validation loss decreased (0.203351 --> 0.202666).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 16 cost time: 0.866626501083374
Epoch: 16, Steps: 64 | Train Loss: 0.0747375 Vali Loss: 0.2008789 Test Loss: 0.2815962
Validation loss decreased (0.202666 --> 0.200879).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 17 cost time: 0.8583958148956299
Epoch: 17, Steps: 64 | Train Loss: 0.0742709 Vali Loss: 0.1963393 Test Loss: 0.2832050
Validation loss decreased (0.200879 --> 0.196339).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 18 cost time: 0.8599526882171631
Epoch: 18, Steps: 64 | Train Loss: 0.0738254 Vali Loss: 0.1975678 Test Loss: 0.2828733
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 19 cost time: 0.8593621253967285
Epoch: 19, Steps: 64 | Train Loss: 0.0733085 Vali Loss: 0.1979198 Test Loss: 0.2821321
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 20 cost time: 0.8630001544952393
Epoch: 20, Steps: 64 | Train Loss: 0.0732656 Vali Loss: 0.1982399 Test Loss: 0.2819880
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 21 cost time: 0.8576188087463379
Epoch: 21, Steps: 64 | Train Loss: 0.0727190 Vali Loss: 0.1990307 Test Loss: 0.2833413
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 22 cost time: 0.8521525859832764
Epoch: 22, Steps: 64 | Train Loss: 0.0727412 Vali Loss: 0.1969711 Test Loss: 0.2819949
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 23 cost time: 0.8574039936065674
Epoch: 23, Steps: 64 | Train Loss: 0.0721655 Vali Loss: 0.1957531 Test Loss: 0.2839137
Validation loss decreased (0.196339 --> 0.195753).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 24 cost time: 0.8673038482666016
Epoch: 24, Steps: 64 | Train Loss: 0.0719984 Vali Loss: 0.1947514 Test Loss: 0.2816199
Validation loss decreased (0.195753 --> 0.194751).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 25 cost time: 0.8491897583007812
Epoch: 25, Steps: 64 | Train Loss: 0.0719513 Vali Loss: 0.1961749 Test Loss: 0.2833438
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 26 cost time: 0.8580002784729004
Epoch: 26, Steps: 64 | Train Loss: 0.0713619 Vali Loss: 0.1940819 Test Loss: 0.2825098
Validation loss decreased (0.194751 --> 0.194082).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 27 cost time: 0.8656282424926758
Epoch: 27, Steps: 64 | Train Loss: 0.0717369 Vali Loss: 0.1924181 Test Loss: 0.2823487
Validation loss decreased (0.194082 --> 0.192418).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 28 cost time: 0.854454755783081
Epoch: 28, Steps: 64 | Train Loss: 0.0719671 Vali Loss: 0.1927430 Test Loss: 0.2831402
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 29 cost time: 0.8553552627563477
Epoch: 29, Steps: 64 | Train Loss: 0.0711514 Vali Loss: 0.1909803 Test Loss: 0.2828667
Validation loss decreased (0.192418 --> 0.190980).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 30 cost time: 0.8567698001861572
Epoch: 30, Steps: 64 | Train Loss: 0.0711216 Vali Loss: 0.1935720 Test Loss: 0.2821937
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 31 cost time: 0.8477628231048584
Epoch: 31, Steps: 64 | Train Loss: 0.0713733 Vali Loss: 0.1912953 Test Loss: 0.2824642
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 32 cost time: 0.8526146411895752
Epoch: 32, Steps: 64 | Train Loss: 0.0715360 Vali Loss: 0.1929122 Test Loss: 0.2825556
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 33 cost time: 0.8603525161743164
Epoch: 33, Steps: 64 | Train Loss: 0.0710376 Vali Loss: 0.1939250 Test Loss: 0.2825961
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 34 cost time: 0.8562569618225098
Epoch: 34, Steps: 64 | Train Loss: 0.0712271 Vali Loss: 0.1951086 Test Loss: 0.2819921
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 35 cost time: 0.8603832721710205
Epoch: 35, Steps: 64 | Train Loss: 0.0709815 Vali Loss: 0.1938014 Test Loss: 0.2819071
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 36 cost time: 0.8559982776641846
Epoch: 36, Steps: 64 | Train Loss: 0.0712210 Vali Loss: 0.1944180 Test Loss: 0.2820629
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 37 cost time: 0.8576052188873291
Epoch: 37, Steps: 64 | Train Loss: 0.0710682 Vali Loss: 0.1932267 Test Loss: 0.2823154
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 38 cost time: 0.8723881244659424
Epoch: 38, Steps: 64 | Train Loss: 0.0712386 Vali Loss: 0.1937928 Test Loss: 0.2823026
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 39 cost time: 0.8553786277770996
Epoch: 39, Steps: 64 | Train Loss: 0.0714293 Vali Loss: 0.1937255 Test Loss: 0.2824077
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 40 cost time: 0.8563642501831055
Epoch: 40, Steps: 64 | Train Loss: 0.0705750 Vali Loss: 0.1922704 Test Loss: 0.2823280
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 41 cost time: 0.8618125915527344
Epoch: 41, Steps: 64 | Train Loss: 0.0708939 Vali Loss: 0.1907855 Test Loss: 0.2819372
Validation loss decreased (0.190980 --> 0.190786).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 42 cost time: 0.8736782073974609
Epoch: 42, Steps: 64 | Train Loss: 0.0710248 Vali Loss: 0.1911558 Test Loss: 0.2819541
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 43 cost time: 0.8679993152618408
Epoch: 43, Steps: 64 | Train Loss: 0.0707046 Vali Loss: 0.1917336 Test Loss: 0.2816593
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 44 cost time: 0.8676021099090576
Epoch: 44, Steps: 64 | Train Loss: 0.0710596 Vali Loss: 0.1924520 Test Loss: 0.2822731
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 45 cost time: 0.8683972358703613
Epoch: 45, Steps: 64 | Train Loss: 0.0705404 Vali Loss: 0.1922963 Test Loss: 0.2820424
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 46 cost time: 0.8814568519592285
Epoch: 46, Steps: 64 | Train Loss: 0.0705575 Vali Loss: 0.1944555 Test Loss: 0.2820909
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 47 cost time: 0.8817892074584961
Epoch: 47, Steps: 64 | Train Loss: 0.0699421 Vali Loss: 0.1914649 Test Loss: 0.2822830
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 48 cost time: 0.866999626159668
Epoch: 48, Steps: 64 | Train Loss: 0.0708680 Vali Loss: 0.1921929 Test Loss: 0.2817709
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 49 cost time: 0.8755974769592285
Epoch: 49, Steps: 64 | Train Loss: 0.0706519 Vali Loss: 0.1926926 Test Loss: 0.2824306
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 50 cost time: 0.865319013595581
Epoch: 50, Steps: 64 | Train Loss: 0.0702833 Vali Loss: 0.1906835 Test Loss: 0.2818730
Validation loss decreased (0.190786 --> 0.190683).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 51 cost time: 0.8534047603607178
Epoch: 51, Steps: 64 | Train Loss: 0.0708054 Vali Loss: 0.1916145 Test Loss: 0.2822890
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 52 cost time: 0.9414088726043701
Epoch: 52, Steps: 64 | Train Loss: 0.0703325 Vali Loss: 0.1922091 Test Loss: 0.2817923
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 53 cost time: 0.8550002574920654
Epoch: 53, Steps: 64 | Train Loss: 0.0706163 Vali Loss: 0.1927357 Test Loss: 0.2820073
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 54 cost time: 0.8125708103179932
Epoch: 54, Steps: 64 | Train Loss: 0.0706369 Vali Loss: 0.1916437 Test Loss: 0.2826917
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 55 cost time: 0.9243922233581543
Epoch: 55, Steps: 64 | Train Loss: 0.0706989 Vali Loss: 0.1933336 Test Loss: 0.2822239
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 56 cost time: 0.859424352645874
Epoch: 56, Steps: 64 | Train Loss: 0.0708031 Vali Loss: 0.1922030 Test Loss: 0.2822956
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 57 cost time: 0.8582887649536133
Epoch: 57, Steps: 64 | Train Loss: 0.0703606 Vali Loss: 0.1919905 Test Loss: 0.2819507
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 58 cost time: 0.8617379665374756
Epoch: 58, Steps: 64 | Train Loss: 0.0708794 Vali Loss: 0.1939010 Test Loss: 0.2823229
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 59 cost time: 0.8519995212554932
Epoch: 59, Steps: 64 | Train Loss: 0.0705137 Vali Loss: 0.1926384 Test Loss: 0.2817173
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 60 cost time: 0.8606326580047607
Epoch: 60, Steps: 64 | Train Loss: 0.0709080 Vali Loss: 0.1905901 Test Loss: 0.2827128
Validation loss decreased (0.190683 --> 0.190590).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2827128469944, mae:0.35287073254585266, rse:0.24403132498264313
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.0581212043762207 GB
Epoch: 1 cost time: 2.25460147857666
Epoch: 1, Steps: 64 | Train Loss: 1.0479604 Vali Loss: 3.1030600 Test Loss: 5.4870071
Validation loss decreased (inf --> 3.103060).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 2 cost time: 0.8760430812835693
Epoch: 2, Steps: 64 | Train Loss: 0.7290954 Vali Loss: 1.3382847 Test Loss: 2.2009044
Validation loss decreased (3.103060 --> 1.338285).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 3 cost time: 0.8843138217926025
Epoch: 3, Steps: 64 | Train Loss: 0.3717448 Vali Loss: 0.7658345 Test Loss: 1.1473421
Validation loss decreased (1.338285 --> 0.765834).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 4 cost time: 0.8593683242797852
Epoch: 4, Steps: 64 | Train Loss: 0.2280514 Vali Loss: 0.5158720 Test Loss: 0.7113315
Validation loss decreased (0.765834 --> 0.515872).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 5 cost time: 0.8624467849731445
Epoch: 5, Steps: 64 | Train Loss: 0.1674832 Vali Loss: 0.3956897 Test Loss: 0.5252408
Validation loss decreased (0.515872 --> 0.395690).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 6 cost time: 0.8546278476715088
Epoch: 6, Steps: 64 | Train Loss: 0.1376242 Vali Loss: 0.3255114 Test Loss: 0.4235526
Validation loss decreased (0.395690 --> 0.325511).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 7 cost time: 0.8584179878234863
Epoch: 7, Steps: 64 | Train Loss: 0.1219749 Vali Loss: 0.2888257 Test Loss: 0.3646066
Validation loss decreased (0.325511 --> 0.288826).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 8 cost time: 0.8571057319641113
Epoch: 8, Steps: 64 | Train Loss: 0.1148797 Vali Loss: 0.2689146 Test Loss: 0.3385998
Validation loss decreased (0.288826 --> 0.268915).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 9 cost time: 0.854773759841919
Epoch: 9, Steps: 64 | Train Loss: 0.1093706 Vali Loss: 0.2543903 Test Loss: 0.3239747
Validation loss decreased (0.268915 --> 0.254390).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 10 cost time: 0.8577933311462402
Epoch: 10, Steps: 64 | Train Loss: 0.1057424 Vali Loss: 0.2455435 Test Loss: 0.3070223
Validation loss decreased (0.254390 --> 0.245544).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 11 cost time: 0.860769510269165
Epoch: 11, Steps: 64 | Train Loss: 0.1033353 Vali Loss: 0.2419652 Test Loss: 0.3032809
Validation loss decreased (0.245544 --> 0.241965).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 12 cost time: 0.8663513660430908
Epoch: 12, Steps: 64 | Train Loss: 0.1020097 Vali Loss: 0.2365627 Test Loss: 0.2981759
Validation loss decreased (0.241965 --> 0.236563).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 13 cost time: 0.8633458614349365
Epoch: 13, Steps: 64 | Train Loss: 0.0999704 Vali Loss: 0.2319816 Test Loss: 0.2957013
Validation loss decreased (0.236563 --> 0.231982).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 14 cost time: 0.8633377552032471
Epoch: 14, Steps: 64 | Train Loss: 0.0986115 Vali Loss: 0.2269250 Test Loss: 0.2928137
Validation loss decreased (0.231982 --> 0.226925).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 15 cost time: 0.8758370876312256
Epoch: 15, Steps: 64 | Train Loss: 0.0974544 Vali Loss: 0.2270069 Test Loss: 0.2926766
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 16 cost time: 0.8566286563873291
Epoch: 16, Steps: 64 | Train Loss: 0.0970663 Vali Loss: 0.2261197 Test Loss: 0.2913749
Validation loss decreased (0.226925 --> 0.226120).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 17 cost time: 0.8566267490386963
Epoch: 17, Steps: 64 | Train Loss: 0.0961395 Vali Loss: 0.2270727 Test Loss: 0.2892731
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 18 cost time: 0.8574087619781494
Epoch: 18, Steps: 64 | Train Loss: 0.0956025 Vali Loss: 0.2253249 Test Loss: 0.2886899
Validation loss decreased (0.226120 --> 0.225325).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 19 cost time: 0.8604075908660889
Epoch: 19, Steps: 64 | Train Loss: 0.0943674 Vali Loss: 0.2222152 Test Loss: 0.2873172
Validation loss decreased (0.225325 --> 0.222215).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 20 cost time: 0.8691284656524658
Epoch: 20, Steps: 64 | Train Loss: 0.0941548 Vali Loss: 0.2217465 Test Loss: 0.2880745
Validation loss decreased (0.222215 --> 0.221747).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 21 cost time: 0.8599996566772461
Epoch: 21, Steps: 64 | Train Loss: 0.0937867 Vali Loss: 0.2195317 Test Loss: 0.2867245
Validation loss decreased (0.221747 --> 0.219532).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 22 cost time: 0.8766145706176758
Epoch: 22, Steps: 64 | Train Loss: 0.0931638 Vali Loss: 0.2191453 Test Loss: 0.2859206
Validation loss decreased (0.219532 --> 0.219145).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 23 cost time: 0.8634862899780273
Epoch: 23, Steps: 64 | Train Loss: 0.0930549 Vali Loss: 0.2208224 Test Loss: 0.2873228
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 24 cost time: 0.8633959293365479
Epoch: 24, Steps: 64 | Train Loss: 0.0930831 Vali Loss: 0.2177044 Test Loss: 0.2847867
Validation loss decreased (0.219145 --> 0.217704).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 25 cost time: 0.862982988357544
Epoch: 25, Steps: 64 | Train Loss: 0.0926687 Vali Loss: 0.2188686 Test Loss: 0.2860856
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 26 cost time: 0.8689982891082764
Epoch: 26, Steps: 64 | Train Loss: 0.0915368 Vali Loss: 0.2175659 Test Loss: 0.2869867
Validation loss decreased (0.217704 --> 0.217566).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 27 cost time: 0.858619213104248
Epoch: 27, Steps: 64 | Train Loss: 0.0917712 Vali Loss: 0.2184031 Test Loss: 0.2853994
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 28 cost time: 0.8602886199951172
Epoch: 28, Steps: 64 | Train Loss: 0.0914756 Vali Loss: 0.2160061 Test Loss: 0.2849861
Validation loss decreased (0.217566 --> 0.216006).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 29 cost time: 0.8634533882141113
Epoch: 29, Steps: 64 | Train Loss: 0.0915851 Vali Loss: 0.2178436 Test Loss: 0.2854110
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 30 cost time: 0.833698034286499
Epoch: 30, Steps: 64 | Train Loss: 0.0904613 Vali Loss: 0.2157577 Test Loss: 0.2844739
Validation loss decreased (0.216006 --> 0.215758).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 31 cost time: 0.8486135005950928
Epoch: 31, Steps: 64 | Train Loss: 0.0910753 Vali Loss: 0.2155353 Test Loss: 0.2848451
Validation loss decreased (0.215758 --> 0.215535).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 32 cost time: 0.8590002059936523
Epoch: 32, Steps: 64 | Train Loss: 0.0905936 Vali Loss: 0.2145575 Test Loss: 0.2832655
Validation loss decreased (0.215535 --> 0.214558).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 33 cost time: 0.8616106510162354
Epoch: 33, Steps: 64 | Train Loss: 0.0906076 Vali Loss: 0.2159295 Test Loss: 0.2849742
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 34 cost time: 0.8613548278808594
Epoch: 34, Steps: 64 | Train Loss: 0.0899629 Vali Loss: 0.2131279 Test Loss: 0.2850499
Validation loss decreased (0.214558 --> 0.213128).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 35 cost time: 0.8584194183349609
Epoch: 35, Steps: 64 | Train Loss: 0.0902313 Vali Loss: 0.2130349 Test Loss: 0.2838509
Validation loss decreased (0.213128 --> 0.213035).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 36 cost time: 0.8597314357757568
Epoch: 36, Steps: 64 | Train Loss: 0.0900284 Vali Loss: 0.2139663 Test Loss: 0.2840206
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 37 cost time: 0.8679995536804199
Epoch: 37, Steps: 64 | Train Loss: 0.0897912 Vali Loss: 0.2142546 Test Loss: 0.2833627
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 38 cost time: 0.8614146709442139
Epoch: 38, Steps: 64 | Train Loss: 0.0900993 Vali Loss: 0.2106266 Test Loss: 0.2837340
Validation loss decreased (0.213035 --> 0.210627).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 39 cost time: 0.8666131496429443
Epoch: 39, Steps: 64 | Train Loss: 0.0895838 Vali Loss: 0.2126832 Test Loss: 0.2824925
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 40 cost time: 0.8593485355377197
Epoch: 40, Steps: 64 | Train Loss: 0.0896340 Vali Loss: 0.2139305 Test Loss: 0.2847397
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 41 cost time: 0.8585801124572754
Epoch: 41, Steps: 64 | Train Loss: 0.0903485 Vali Loss: 0.2118375 Test Loss: 0.2847646
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 42 cost time: 0.8630011081695557
Epoch: 42, Steps: 64 | Train Loss: 0.0896713 Vali Loss: 0.2151764 Test Loss: 0.2839450
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 43 cost time: 0.8600223064422607
Epoch: 43, Steps: 64 | Train Loss: 0.0894568 Vali Loss: 0.2123740 Test Loss: 0.2834430
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 44 cost time: 0.8723440170288086
Epoch: 44, Steps: 64 | Train Loss: 0.0895485 Vali Loss: 0.2129004 Test Loss: 0.2839533
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 45 cost time: 0.8623907566070557
Epoch: 45, Steps: 64 | Train Loss: 0.0895522 Vali Loss: 0.2157357 Test Loss: 0.2831798
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 46 cost time: 0.8593406677246094
Epoch: 46, Steps: 64 | Train Loss: 0.0899228 Vali Loss: 0.2141627 Test Loss: 0.2838370
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 47 cost time: 0.8689045906066895
Epoch: 47, Steps: 64 | Train Loss: 0.0900003 Vali Loss: 0.2131719 Test Loss: 0.2828925
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 48 cost time: 0.8636314868927002
Epoch: 48, Steps: 64 | Train Loss: 0.0889202 Vali Loss: 0.2126537 Test Loss: 0.2840139
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 49 cost time: 0.8596310615539551
Epoch: 49, Steps: 64 | Train Loss: 0.0889758 Vali Loss: 0.2146791 Test Loss: 0.2840256
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 50 cost time: 0.8653852939605713
Epoch: 50, Steps: 64 | Train Loss: 0.0898191 Vali Loss: 0.2125605 Test Loss: 0.2823378
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 51 cost time: 0.8584773540496826
Epoch: 51, Steps: 64 | Train Loss: 0.0892962 Vali Loss: 0.2113318 Test Loss: 0.2834907
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 52 cost time: 0.8577823638916016
Epoch: 52, Steps: 64 | Train Loss: 0.0894732 Vali Loss: 0.2130517 Test Loss: 0.2824269
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 53 cost time: 0.8599896430969238
Epoch: 53, Steps: 64 | Train Loss: 0.0896764 Vali Loss: 0.2132826 Test Loss: 0.2817006
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 54 cost time: 0.8656244277954102
Epoch: 54, Steps: 64 | Train Loss: 0.0893081 Vali Loss: 0.2121042 Test Loss: 0.2822306
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 55 cost time: 0.8663520812988281
Epoch: 55, Steps: 64 | Train Loss: 0.0889683 Vali Loss: 0.2107676 Test Loss: 0.2834249
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 56 cost time: 0.8624646663665771
Epoch: 56, Steps: 64 | Train Loss: 0.0890027 Vali Loss: 0.2113711 Test Loss: 0.2835518
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 57 cost time: 0.8661215305328369
Epoch: 57, Steps: 64 | Train Loss: 0.0893125 Vali Loss: 0.2137040 Test Loss: 0.2835808
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 58 cost time: 0.8619997501373291
Epoch: 58, Steps: 64 | Train Loss: 0.0894017 Vali Loss: 0.2142977 Test Loss: 0.2834822
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 59 cost time: 0.8776321411132812
Epoch: 59, Steps: 64 | Train Loss: 0.0888390 Vali Loss: 0.2095434 Test Loss: 0.2836382
Validation loss decreased (0.210627 --> 0.209543).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 60 cost time: 0.8640892505645752
Epoch: 60, Steps: 64 | Train Loss: 0.0891514 Vali Loss: 0.2144171 Test Loss: 0.2828071
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.28363826870918274, mae:0.34555500745773315, rse:0.24443039298057556
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.0625157356262207 GB
Epoch: 1 cost time: 2.2718284130096436
Epoch: 1, Steps: 64 | Train Loss: 0.8041589 Vali Loss: 2.4098296 Test Loss: 4.2587047
Validation loss decreased (inf --> 2.409830).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 2 cost time: 0.846637487411499
Epoch: 2, Steps: 64 | Train Loss: 0.3410448 Vali Loss: 0.2844602 Test Loss: 0.3100348
Validation loss decreased (2.409830 --> 0.284460).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 3 cost time: 0.8276317119598389
Epoch: 3, Steps: 64 | Train Loss: 0.1045971 Vali Loss: 0.2515015 Test Loss: 0.2914539
Validation loss decreased (0.284460 --> 0.251502).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 4 cost time: 0.8480000495910645
Epoch: 4, Steps: 64 | Train Loss: 0.0936473 Vali Loss: 0.2393439 Test Loss: 0.2765962
Validation loss decreased (0.251502 --> 0.239344).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 5 cost time: 0.8434619903564453
Epoch: 5, Steps: 64 | Train Loss: 0.0892871 Vali Loss: 0.2297630 Test Loss: 0.2779898
Validation loss decreased (0.239344 --> 0.229763).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 6 cost time: 0.8514056205749512
Epoch: 6, Steps: 64 | Train Loss: 0.0873840 Vali Loss: 0.2296236 Test Loss: 0.2793594
Validation loss decreased (0.229763 --> 0.229624).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 7 cost time: 0.8473861217498779
Epoch: 7, Steps: 64 | Train Loss: 0.0845649 Vali Loss: 0.2228424 Test Loss: 0.2763790
Validation loss decreased (0.229624 --> 0.222842).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 8 cost time: 0.8477475643157959
Epoch: 8, Steps: 64 | Train Loss: 0.0826469 Vali Loss: 0.2172600 Test Loss: 0.2761044
Validation loss decreased (0.222842 --> 0.217260).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 9 cost time: 0.8499996662139893
Epoch: 9, Steps: 64 | Train Loss: 0.0812527 Vali Loss: 0.2141796 Test Loss: 0.2753111
Validation loss decreased (0.217260 --> 0.214180).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 10 cost time: 0.8469569683074951
Epoch: 10, Steps: 64 | Train Loss: 0.0805343 Vali Loss: 0.2093594 Test Loss: 0.2744915
Validation loss decreased (0.214180 --> 0.209359).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 11 cost time: 0.8483521938323975
Epoch: 11, Steps: 64 | Train Loss: 0.0784852 Vali Loss: 0.2056967 Test Loss: 0.2752283
Validation loss decreased (0.209359 --> 0.205697).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 12 cost time: 0.8423995971679688
Epoch: 12, Steps: 64 | Train Loss: 0.0779390 Vali Loss: 0.2066157 Test Loss: 0.2749040
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 13 cost time: 0.8448035717010498
Epoch: 13, Steps: 64 | Train Loss: 0.0771872 Vali Loss: 0.2018410 Test Loss: 0.2736186
Validation loss decreased (0.205697 --> 0.201841).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 14 cost time: 0.8599975109100342
Epoch: 14, Steps: 64 | Train Loss: 0.0766523 Vali Loss: 0.2024756 Test Loss: 0.2737431
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 15 cost time: 0.8486101627349854
Epoch: 15, Steps: 64 | Train Loss: 0.0757904 Vali Loss: 0.2008806 Test Loss: 0.2722766
Validation loss decreased (0.201841 --> 0.200881).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 16 cost time: 0.8414289951324463
Epoch: 16, Steps: 64 | Train Loss: 0.0755953 Vali Loss: 0.1976640 Test Loss: 0.2726799
Validation loss decreased (0.200881 --> 0.197664).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 17 cost time: 0.8549776077270508
Epoch: 17, Steps: 64 | Train Loss: 0.0753104 Vali Loss: 0.1967272 Test Loss: 0.2737039
Validation loss decreased (0.197664 --> 0.196727).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 18 cost time: 0.8421425819396973
Epoch: 18, Steps: 64 | Train Loss: 0.0742804 Vali Loss: 0.1989786 Test Loss: 0.2722719
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 19 cost time: 0.841998815536499
Epoch: 19, Steps: 64 | Train Loss: 0.0741307 Vali Loss: 0.1929636 Test Loss: 0.2724693
Validation loss decreased (0.196727 --> 0.192964).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 20 cost time: 0.8400003910064697
Epoch: 20, Steps: 64 | Train Loss: 0.0735980 Vali Loss: 0.1941535 Test Loss: 0.2720654
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 21 cost time: 0.8511810302734375
Epoch: 21, Steps: 64 | Train Loss: 0.0729958 Vali Loss: 0.1954437 Test Loss: 0.2717373
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 22 cost time: 0.840458869934082
Epoch: 22, Steps: 64 | Train Loss: 0.0731324 Vali Loss: 0.1913556 Test Loss: 0.2716071
Validation loss decreased (0.192964 --> 0.191356).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 23 cost time: 0.8405144214630127
Epoch: 23, Steps: 64 | Train Loss: 0.0728314 Vali Loss: 0.1915264 Test Loss: 0.2717944
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 24 cost time: 0.8399999141693115
Epoch: 24, Steps: 64 | Train Loss: 0.0721667 Vali Loss: 0.1898358 Test Loss: 0.2711803
Validation loss decreased (0.191356 --> 0.189836).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 25 cost time: 0.8299999237060547
Epoch: 25, Steps: 64 | Train Loss: 0.0724067 Vali Loss: 0.1913075 Test Loss: 0.2715019
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 26 cost time: 0.8401350975036621
Epoch: 26, Steps: 64 | Train Loss: 0.0725190 Vali Loss: 0.1902035 Test Loss: 0.2706202
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 27 cost time: 0.8594443798065186
Epoch: 27, Steps: 64 | Train Loss: 0.0716999 Vali Loss: 0.1917217 Test Loss: 0.2712353
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 28 cost time: 0.8564066886901855
Epoch: 28, Steps: 64 | Train Loss: 0.0716412 Vali Loss: 0.1907712 Test Loss: 0.2708984
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 29 cost time: 0.8093647956848145
Epoch: 29, Steps: 64 | Train Loss: 0.0716470 Vali Loss: 0.1887337 Test Loss: 0.2701415
Validation loss decreased (0.189836 --> 0.188734).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 30 cost time: 0.8426082134246826
Epoch: 30, Steps: 64 | Train Loss: 0.0713054 Vali Loss: 0.1887722 Test Loss: 0.2700973
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 31 cost time: 0.8442425727844238
Epoch: 31, Steps: 64 | Train Loss: 0.0711284 Vali Loss: 0.1895827 Test Loss: 0.2700347
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 32 cost time: 0.8543837070465088
Epoch: 32, Steps: 64 | Train Loss: 0.0713246 Vali Loss: 0.1897031 Test Loss: 0.2700544
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 33 cost time: 0.902571439743042
Epoch: 33, Steps: 64 | Train Loss: 0.0713894 Vali Loss: 0.1913496 Test Loss: 0.2697163
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 34 cost time: 0.8378243446350098
Epoch: 34, Steps: 64 | Train Loss: 0.0708866 Vali Loss: 0.1896461 Test Loss: 0.2703087
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 35 cost time: 0.8414549827575684
Epoch: 35, Steps: 64 | Train Loss: 0.0705206 Vali Loss: 0.1878316 Test Loss: 0.2690058
Validation loss decreased (0.188734 --> 0.187832).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 36 cost time: 0.8406174182891846
Epoch: 36, Steps: 64 | Train Loss: 0.0713479 Vali Loss: 0.1890701 Test Loss: 0.2695652
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 37 cost time: 0.8383204936981201
Epoch: 37, Steps: 64 | Train Loss: 0.0708790 Vali Loss: 0.1888873 Test Loss: 0.2698852
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 38 cost time: 0.845383882522583
Epoch: 38, Steps: 64 | Train Loss: 0.0709353 Vali Loss: 0.1879776 Test Loss: 0.2691514
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 39 cost time: 0.8377788066864014
Epoch: 39, Steps: 64 | Train Loss: 0.0710251 Vali Loss: 0.1895277 Test Loss: 0.2693740
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 40 cost time: 0.854621171951294
Epoch: 40, Steps: 64 | Train Loss: 0.0708024 Vali Loss: 0.1855609 Test Loss: 0.2689693
Validation loss decreased (0.187832 --> 0.185561).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 41 cost time: 0.8436050415039062
Epoch: 41, Steps: 64 | Train Loss: 0.0707988 Vali Loss: 0.1881285 Test Loss: 0.2690746
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 42 cost time: 0.8444037437438965
Epoch: 42, Steps: 64 | Train Loss: 0.0711929 Vali Loss: 0.1865453 Test Loss: 0.2687812
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 43 cost time: 0.8453736305236816
Epoch: 43, Steps: 64 | Train Loss: 0.0712344 Vali Loss: 0.1883458 Test Loss: 0.2685048
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 44 cost time: 0.8504214286804199
Epoch: 44, Steps: 64 | Train Loss: 0.0703602 Vali Loss: 0.1859069 Test Loss: 0.2682546
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 45 cost time: 0.8430287837982178
Epoch: 45, Steps: 64 | Train Loss: 0.0704825 Vali Loss: 0.1875918 Test Loss: 0.2690794
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 46 cost time: 0.8373737335205078
Epoch: 46, Steps: 64 | Train Loss: 0.0705903 Vali Loss: 0.1883606 Test Loss: 0.2695677
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 47 cost time: 0.8564579486846924
Epoch: 47, Steps: 64 | Train Loss: 0.0703619 Vali Loss: 0.1885459 Test Loss: 0.2691323
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 48 cost time: 0.8502328395843506
Epoch: 48, Steps: 64 | Train Loss: 0.0703966 Vali Loss: 0.1868512 Test Loss: 0.2688239
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 49 cost time: 0.8437824249267578
Epoch: 49, Steps: 64 | Train Loss: 0.0705537 Vali Loss: 0.1865772 Test Loss: 0.2688539
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 50 cost time: 0.8356354236602783
Epoch: 50, Steps: 64 | Train Loss: 0.0704045 Vali Loss: 0.1859662 Test Loss: 0.2684411
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 51 cost time: 0.8248541355133057
Epoch: 51, Steps: 64 | Train Loss: 0.0704712 Vali Loss: 0.1892525 Test Loss: 0.2688144
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 52 cost time: 0.8444054126739502
Epoch: 52, Steps: 64 | Train Loss: 0.0706129 Vali Loss: 0.1864608 Test Loss: 0.2687604
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 53 cost time: 0.8444626331329346
Epoch: 53, Steps: 64 | Train Loss: 0.0707738 Vali Loss: 0.1886766 Test Loss: 0.2687385
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 54 cost time: 0.8403804302215576
Epoch: 54, Steps: 64 | Train Loss: 0.0704674 Vali Loss: 0.1862224 Test Loss: 0.2689019
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 55 cost time: 0.8179452419281006
Epoch: 55, Steps: 64 | Train Loss: 0.0705780 Vali Loss: 0.1869269 Test Loss: 0.2685772
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 56 cost time: 0.8393828868865967
Epoch: 56, Steps: 64 | Train Loss: 0.0705845 Vali Loss: 0.1865999 Test Loss: 0.2680740
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 57 cost time: 0.8450393676757812
Epoch: 57, Steps: 64 | Train Loss: 0.0702442 Vali Loss: 0.1889612 Test Loss: 0.2690769
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 58 cost time: 0.8433539867401123
Epoch: 58, Steps: 64 | Train Loss: 0.0706921 Vali Loss: 0.1875498 Test Loss: 0.2682124
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 59 cost time: 0.8479995727539062
Epoch: 59, Steps: 64 | Train Loss: 0.0706824 Vali Loss: 0.1872073 Test Loss: 0.2687970
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 60 cost time: 0.8436150550842285
Epoch: 60, Steps: 64 | Train Loss: 0.0706513 Vali Loss: 0.1891167 Test Loss: 0.2688006
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2689692974090576, mae:0.33994537591934204, rse:0.23802585899829865
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06581449508666992 GB
Epoch: 1 cost time: 2.3531575202941895
Epoch: 1, Steps: 64 | Train Loss: 0.8190016 Vali Loss: 2.5130625 Test Loss: 4.3943048
Validation loss decreased (inf --> 2.513062).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 2 cost time: 0.9604110717773438
Epoch: 2, Steps: 64 | Train Loss: 0.3153738 Vali Loss: 0.3224239 Test Loss: 0.3858825
Validation loss decreased (2.513062 --> 0.322424).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 3 cost time: 0.9473981857299805
Epoch: 3, Steps: 64 | Train Loss: 0.1006618 Vali Loss: 0.2482729 Test Loss: 0.2861303
Validation loss decreased (0.322424 --> 0.248273).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 4 cost time: 0.9484474658966064
Epoch: 4, Steps: 64 | Train Loss: 0.0903136 Vali Loss: 0.2406977 Test Loss: 0.2845571
Validation loss decreased (0.248273 --> 0.240698).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 5 cost time: 0.9507606029510498
Epoch: 5, Steps: 64 | Train Loss: 0.0874658 Vali Loss: 0.2269922 Test Loss: 0.2790278
Validation loss decreased (0.240698 --> 0.226992).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 6 cost time: 0.9364266395568848
Epoch: 6, Steps: 64 | Train Loss: 0.0842574 Vali Loss: 0.2230575 Test Loss: 0.2762913
Validation loss decreased (0.226992 --> 0.223057).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 7 cost time: 0.939713716506958
Epoch: 7, Steps: 64 | Train Loss: 0.0815775 Vali Loss: 0.2164305 Test Loss: 0.2780767
Validation loss decreased (0.223057 --> 0.216431).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 8 cost time: 0.9409999847412109
Epoch: 8, Steps: 64 | Train Loss: 0.0804650 Vali Loss: 0.2150221 Test Loss: 0.2744574
Validation loss decreased (0.216431 --> 0.215022).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 9 cost time: 0.9450757503509521
Epoch: 9, Steps: 64 | Train Loss: 0.0791437 Vali Loss: 0.2092553 Test Loss: 0.2754300
Validation loss decreased (0.215022 --> 0.209255).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 10 cost time: 0.9486281871795654
Epoch: 10, Steps: 64 | Train Loss: 0.0777263 Vali Loss: 0.2081612 Test Loss: 0.2723734
Validation loss decreased (0.209255 --> 0.208161).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 11 cost time: 0.9466147422790527
Epoch: 11, Steps: 64 | Train Loss: 0.0763223 Vali Loss: 0.2000104 Test Loss: 0.2694044
Validation loss decreased (0.208161 --> 0.200010).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 12 cost time: 0.9583673477172852
Epoch: 12, Steps: 64 | Train Loss: 0.0757238 Vali Loss: 0.1970262 Test Loss: 0.2714898
Validation loss decreased (0.200010 --> 0.197026).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 13 cost time: 0.9452347755432129
Epoch: 13, Steps: 64 | Train Loss: 0.0746590 Vali Loss: 0.1988207 Test Loss: 0.2691735
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 14 cost time: 0.9383490085601807
Epoch: 14, Steps: 64 | Train Loss: 0.0741200 Vali Loss: 0.1978589 Test Loss: 0.2710323
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 15 cost time: 0.9513647556304932
Epoch: 15, Steps: 64 | Train Loss: 0.0733875 Vali Loss: 0.1921050 Test Loss: 0.2700200
Validation loss decreased (0.197026 --> 0.192105).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 16 cost time: 0.9383635520935059
Epoch: 16, Steps: 64 | Train Loss: 0.0726327 Vali Loss: 0.1914938 Test Loss: 0.2688952
Validation loss decreased (0.192105 --> 0.191494).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 17 cost time: 0.9447147846221924
Epoch: 17, Steps: 64 | Train Loss: 0.0720578 Vali Loss: 0.1886601 Test Loss: 0.2654010
Validation loss decreased (0.191494 --> 0.188660).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 18 cost time: 0.9409999847412109
Epoch: 18, Steps: 64 | Train Loss: 0.0718264 Vali Loss: 0.1881101 Test Loss: 0.2658567
Validation loss decreased (0.188660 --> 0.188110).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 19 cost time: 0.946997880935669
Epoch: 19, Steps: 64 | Train Loss: 0.0714549 Vali Loss: 0.1910256 Test Loss: 0.2676631
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 20 cost time: 0.9496111869812012
Epoch: 20, Steps: 64 | Train Loss: 0.0710263 Vali Loss: 0.1881556 Test Loss: 0.2662837
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 21 cost time: 0.945225715637207
Epoch: 21, Steps: 64 | Train Loss: 0.0706495 Vali Loss: 0.1862614 Test Loss: 0.2656481
Validation loss decreased (0.188110 --> 0.186261).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 22 cost time: 0.9254541397094727
Epoch: 22, Steps: 64 | Train Loss: 0.0709007 Vali Loss: 0.1876494 Test Loss: 0.2668011
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 23 cost time: 0.9073412418365479
Epoch: 23, Steps: 64 | Train Loss: 0.0704366 Vali Loss: 0.1846273 Test Loss: 0.2667554
Validation loss decreased (0.186261 --> 0.184627).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 24 cost time: 0.9374961853027344
Epoch: 24, Steps: 64 | Train Loss: 0.0704366 Vali Loss: 0.1839184 Test Loss: 0.2651361
Validation loss decreased (0.184627 --> 0.183918).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 25 cost time: 0.9474821090698242
Epoch: 25, Steps: 64 | Train Loss: 0.0701877 Vali Loss: 0.1848323 Test Loss: 0.2661867
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 26 cost time: 0.9485540390014648
Epoch: 26, Steps: 64 | Train Loss: 0.0701893 Vali Loss: 0.1864340 Test Loss: 0.2655981
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 27 cost time: 0.9389996528625488
Epoch: 27, Steps: 64 | Train Loss: 0.0698259 Vali Loss: 0.1840832 Test Loss: 0.2662147
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 28 cost time: 0.945000171661377
Epoch: 28, Steps: 64 | Train Loss: 0.0691601 Vali Loss: 0.1819038 Test Loss: 0.2639780
Validation loss decreased (0.183918 --> 0.181904).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 29 cost time: 0.9306411743164062
Epoch: 29, Steps: 64 | Train Loss: 0.0692010 Vali Loss: 0.1831037 Test Loss: 0.2648327
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 30 cost time: 0.9376130104064941
Epoch: 30, Steps: 64 | Train Loss: 0.0692367 Vali Loss: 0.1828779 Test Loss: 0.2645183
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 31 cost time: 0.9363546371459961
Epoch: 31, Steps: 64 | Train Loss: 0.0693744 Vali Loss: 0.1842380 Test Loss: 0.2647621
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 32 cost time: 0.9483509063720703
Epoch: 32, Steps: 64 | Train Loss: 0.0690317 Vali Loss: 0.1806110 Test Loss: 0.2642928
Validation loss decreased (0.181904 --> 0.180611).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 33 cost time: 0.9403491020202637
Epoch: 33, Steps: 64 | Train Loss: 0.0689798 Vali Loss: 0.1837798 Test Loss: 0.2643881
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 34 cost time: 0.9438064098358154
Epoch: 34, Steps: 64 | Train Loss: 0.0689776 Vali Loss: 0.1832103 Test Loss: 0.2644142
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 35 cost time: 0.9407167434692383
Epoch: 35, Steps: 64 | Train Loss: 0.0691681 Vali Loss: 0.1852787 Test Loss: 0.2650436
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 36 cost time: 0.9458653926849365
Epoch: 36, Steps: 64 | Train Loss: 0.0692561 Vali Loss: 0.1835428 Test Loss: 0.2647095
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 37 cost time: 0.9439997673034668
Epoch: 37, Steps: 64 | Train Loss: 0.0683510 Vali Loss: 0.1835340 Test Loss: 0.2640662
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 38 cost time: 0.9376325607299805
Epoch: 38, Steps: 64 | Train Loss: 0.0685121 Vali Loss: 0.1839413 Test Loss: 0.2642459
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 39 cost time: 0.9526219367980957
Epoch: 39, Steps: 64 | Train Loss: 0.0687772 Vali Loss: 0.1786877 Test Loss: 0.2635035
Validation loss decreased (0.180611 --> 0.178688).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 40 cost time: 0.9373586177825928
Epoch: 40, Steps: 64 | Train Loss: 0.0689890 Vali Loss: 0.1821941 Test Loss: 0.2645182
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 41 cost time: 0.9353232383728027
Epoch: 41, Steps: 64 | Train Loss: 0.0689199 Vali Loss: 0.1829188 Test Loss: 0.2648761
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 42 cost time: 0.9373800754547119
Epoch: 42, Steps: 64 | Train Loss: 0.0686787 Vali Loss: 0.1821491 Test Loss: 0.2644646
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 43 cost time: 0.9397549629211426
Epoch: 43, Steps: 64 | Train Loss: 0.0686935 Vali Loss: 0.1811769 Test Loss: 0.2643486
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 44 cost time: 0.939774751663208
Epoch: 44, Steps: 64 | Train Loss: 0.0683796 Vali Loss: 0.1823395 Test Loss: 0.2642176
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 45 cost time: 0.9437663555145264
Epoch: 45, Steps: 64 | Train Loss: 0.0686440 Vali Loss: 0.1822566 Test Loss: 0.2644382
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 46 cost time: 0.9030008316040039
Epoch: 46, Steps: 64 | Train Loss: 0.0683741 Vali Loss: 0.1812776 Test Loss: 0.2638393
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 47 cost time: 0.924638032913208
Epoch: 47, Steps: 64 | Train Loss: 0.0687615 Vali Loss: 0.1801039 Test Loss: 0.2641851
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 48 cost time: 0.9386045932769775
Epoch: 48, Steps: 64 | Train Loss: 0.0690168 Vali Loss: 0.1841780 Test Loss: 0.2657073
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 49 cost time: 0.9413595199584961
Epoch: 49, Steps: 64 | Train Loss: 0.0688645 Vali Loss: 0.1814188 Test Loss: 0.2638140
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 50 cost time: 0.9394128322601318
Epoch: 50, Steps: 64 | Train Loss: 0.0683881 Vali Loss: 0.1809595 Test Loss: 0.2636796
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 51 cost time: 0.9494152069091797
Epoch: 51, Steps: 64 | Train Loss: 0.0685305 Vali Loss: 0.1819601 Test Loss: 0.2640158
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 52 cost time: 0.954754114151001
Epoch: 52, Steps: 64 | Train Loss: 0.0687002 Vali Loss: 0.1818321 Test Loss: 0.2643345
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 53 cost time: 1.0177936553955078
Epoch: 53, Steps: 64 | Train Loss: 0.0686024 Vali Loss: 0.1825816 Test Loss: 0.2651082
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 54 cost time: 1.0217227935791016
Epoch: 54, Steps: 64 | Train Loss: 0.0688684 Vali Loss: 0.1816962 Test Loss: 0.2640305
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 55 cost time: 0.9487195014953613
Epoch: 55, Steps: 64 | Train Loss: 0.0686798 Vali Loss: 0.1809978 Test Loss: 0.2641131
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 56 cost time: 0.9387812614440918
Epoch: 56, Steps: 64 | Train Loss: 0.0687496 Vali Loss: 0.1840331 Test Loss: 0.2646383
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 57 cost time: 0.9396178722381592
Epoch: 57, Steps: 64 | Train Loss: 0.0682499 Vali Loss: 0.1822925 Test Loss: 0.2647129
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 58 cost time: 0.9373440742492676
Epoch: 58, Steps: 64 | Train Loss: 0.0686498 Vali Loss: 0.1801018 Test Loss: 0.2639573
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 59 cost time: 0.955376148223877
Epoch: 59, Steps: 64 | Train Loss: 0.0685108 Vali Loss: 0.1823593 Test Loss: 0.2644800
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 60 cost time: 0.9423348903656006
Epoch: 60, Steps: 64 | Train Loss: 0.0682253 Vali Loss: 0.1827688 Test Loss: 0.2643908
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2635034918785095, mae:0.33815303444862366, rse:0.2355949431657791
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.058283329010009766 GB
Epoch: 1 cost time: 2.2678637504577637
Epoch: 1, Steps: 64 | Train Loss: 0.8681674 Vali Loss: 2.5547564 Test Loss: 4.4673729
Validation loss decreased (inf --> 2.554756).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 2 cost time: 0.8207283020019531
Epoch: 2, Steps: 64 | Train Loss: 0.6479947 Vali Loss: 1.3668379 Test Loss: 2.2650735
Validation loss decreased (2.554756 --> 1.366838).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 3 cost time: 0.814000129699707
Epoch: 3, Steps: 64 | Train Loss: 0.3854591 Vali Loss: 0.8297558 Test Loss: 1.2910085
Validation loss decreased (1.366838 --> 0.829756).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 4 cost time: 0.8106138706207275
Epoch: 4, Steps: 64 | Train Loss: 0.2413732 Vali Loss: 0.5356978 Test Loss: 0.8062911
Validation loss decreased (0.829756 --> 0.535698).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 5 cost time: 0.8094191551208496
Epoch: 5, Steps: 64 | Train Loss: 0.1681513 Vali Loss: 0.3869327 Test Loss: 0.5393614
Validation loss decreased (0.535698 --> 0.386933).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 6 cost time: 0.8034083843231201
Epoch: 6, Steps: 64 | Train Loss: 0.1330076 Vali Loss: 0.3185442 Test Loss: 0.4238825
Validation loss decreased (0.386933 --> 0.318544).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 7 cost time: 0.8037598133087158
Epoch: 7, Steps: 64 | Train Loss: 0.1162921 Vali Loss: 0.2835382 Test Loss: 0.3644072
Validation loss decreased (0.318544 --> 0.283538).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 8 cost time: 0.80299973487854
Epoch: 8, Steps: 64 | Train Loss: 0.1069090 Vali Loss: 0.2675145 Test Loss: 0.3339971
Validation loss decreased (0.283538 --> 0.267514).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 9 cost time: 0.8053343296051025
Epoch: 9, Steps: 64 | Train Loss: 0.1022765 Vali Loss: 0.2496352 Test Loss: 0.3167841
Validation loss decreased (0.267514 --> 0.249635).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 10 cost time: 0.8124139308929443
Epoch: 10, Steps: 64 | Train Loss: 0.0993578 Vali Loss: 0.2432983 Test Loss: 0.3070068
Validation loss decreased (0.249635 --> 0.243298).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 11 cost time: 0.8190689086914062
Epoch: 11, Steps: 64 | Train Loss: 0.0959505 Vali Loss: 0.2363117 Test Loss: 0.3020003
Validation loss decreased (0.243298 --> 0.236312).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 12 cost time: 0.8080005645751953
Epoch: 12, Steps: 64 | Train Loss: 0.0943188 Vali Loss: 0.2324400 Test Loss: 0.2969026
Validation loss decreased (0.236312 --> 0.232440).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 13 cost time: 0.8146119117736816
Epoch: 13, Steps: 64 | Train Loss: 0.0932689 Vali Loss: 0.2285509 Test Loss: 0.2950673
Validation loss decreased (0.232440 --> 0.228551).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 14 cost time: 0.8283681869506836
Epoch: 14, Steps: 64 | Train Loss: 0.0904507 Vali Loss: 0.2224047 Test Loss: 0.2928538
Validation loss decreased (0.228551 --> 0.222405).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 15 cost time: 0.8093979358673096
Epoch: 15, Steps: 64 | Train Loss: 0.0900278 Vali Loss: 0.2187437 Test Loss: 0.2904132
Validation loss decreased (0.222405 --> 0.218744).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 16 cost time: 0.7997472286224365
Epoch: 16, Steps: 64 | Train Loss: 0.0886480 Vali Loss: 0.2187801 Test Loss: 0.2881307
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 17 cost time: 0.8010010719299316
Epoch: 17, Steps: 64 | Train Loss: 0.0879045 Vali Loss: 0.2175696 Test Loss: 0.2881460
Validation loss decreased (0.218744 --> 0.217570).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 18 cost time: 0.8163716793060303
Epoch: 18, Steps: 64 | Train Loss: 0.0872761 Vali Loss: 0.2125767 Test Loss: 0.2870582
Validation loss decreased (0.217570 --> 0.212577).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 19 cost time: 0.8014724254608154
Epoch: 19, Steps: 64 | Train Loss: 0.0865667 Vali Loss: 0.2131806 Test Loss: 0.2863964
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 20 cost time: 0.8118011951446533
Epoch: 20, Steps: 64 | Train Loss: 0.0853885 Vali Loss: 0.2126850 Test Loss: 0.2850406
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 21 cost time: 0.810999870300293
Epoch: 21, Steps: 64 | Train Loss: 0.0852347 Vali Loss: 0.2089517 Test Loss: 0.2846381
Validation loss decreased (0.212577 --> 0.208952).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 22 cost time: 0.8146152496337891
Epoch: 22, Steps: 64 | Train Loss: 0.0846093 Vali Loss: 0.2071042 Test Loss: 0.2853561
Validation loss decreased (0.208952 --> 0.207104).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 23 cost time: 0.8164758682250977
Epoch: 23, Steps: 64 | Train Loss: 0.0840962 Vali Loss: 0.2066935 Test Loss: 0.2836279
Validation loss decreased (0.207104 --> 0.206694).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 24 cost time: 0.8133649826049805
Epoch: 24, Steps: 64 | Train Loss: 0.0841879 Vali Loss: 0.2079761 Test Loss: 0.2827280
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 25 cost time: 0.803391695022583
Epoch: 25, Steps: 64 | Train Loss: 0.0834769 Vali Loss: 0.2048846 Test Loss: 0.2830245
Validation loss decreased (0.206694 --> 0.204885).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 26 cost time: 0.778627872467041
Epoch: 26, Steps: 64 | Train Loss: 0.0831195 Vali Loss: 0.2025935 Test Loss: 0.2816725
Validation loss decreased (0.204885 --> 0.202594).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 27 cost time: 0.802452564239502
Epoch: 27, Steps: 64 | Train Loss: 0.0826744 Vali Loss: 0.2042900 Test Loss: 0.2820162
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 28 cost time: 0.801110029220581
Epoch: 28, Steps: 64 | Train Loss: 0.0826436 Vali Loss: 0.2016390 Test Loss: 0.2809436
Validation loss decreased (0.202594 --> 0.201639).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 29 cost time: 0.7980022430419922
Epoch: 29, Steps: 64 | Train Loss: 0.0819506 Vali Loss: 0.2020576 Test Loss: 0.2808814
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 30 cost time: 0.7805972099304199
Epoch: 30, Steps: 64 | Train Loss: 0.0818763 Vali Loss: 0.1996295 Test Loss: 0.2817432
Validation loss decreased (0.201639 --> 0.199630).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 31 cost time: 0.8093693256378174
Epoch: 31, Steps: 64 | Train Loss: 0.0824663 Vali Loss: 0.2029448 Test Loss: 0.2809808
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 32 cost time: 0.8043510913848877
Epoch: 32, Steps: 64 | Train Loss: 0.0814148 Vali Loss: 0.2004043 Test Loss: 0.2804004
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 33 cost time: 0.8219778537750244
Epoch: 33, Steps: 64 | Train Loss: 0.0820109 Vali Loss: 0.1986912 Test Loss: 0.2803967
Validation loss decreased (0.199630 --> 0.198691).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 34 cost time: 0.810997724533081
Epoch: 34, Steps: 64 | Train Loss: 0.0820037 Vali Loss: 0.1991487 Test Loss: 0.2806070
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 35 cost time: 0.808617353439331
Epoch: 35, Steps: 64 | Train Loss: 0.0817963 Vali Loss: 0.1989741 Test Loss: 0.2799028
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 36 cost time: 0.8113715648651123
Epoch: 36, Steps: 64 | Train Loss: 0.0808847 Vali Loss: 0.2017391 Test Loss: 0.2793562
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 37 cost time: 0.815899133682251
Epoch: 37, Steps: 64 | Train Loss: 0.0805928 Vali Loss: 0.2000674 Test Loss: 0.2797994
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 38 cost time: 0.8007347583770752
Epoch: 38, Steps: 64 | Train Loss: 0.0811914 Vali Loss: 0.1980163 Test Loss: 0.2799566
Validation loss decreased (0.198691 --> 0.198016).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 39 cost time: 0.8103127479553223
Epoch: 39, Steps: 64 | Train Loss: 0.0811497 Vali Loss: 0.1989640 Test Loss: 0.2797709
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 40 cost time: 0.8134477138519287
Epoch: 40, Steps: 64 | Train Loss: 0.0812239 Vali Loss: 0.2000979 Test Loss: 0.2792091
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 41 cost time: 0.8223717212677002
Epoch: 41, Steps: 64 | Train Loss: 0.0810171 Vali Loss: 0.1997834 Test Loss: 0.2793821
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 42 cost time: 0.8090002536773682
Epoch: 42, Steps: 64 | Train Loss: 0.0807836 Vali Loss: 0.1989952 Test Loss: 0.2792674
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 43 cost time: 0.8126223087310791
Epoch: 43, Steps: 64 | Train Loss: 0.0811893 Vali Loss: 0.2004340 Test Loss: 0.2788193
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 44 cost time: 0.801720380783081
Epoch: 44, Steps: 64 | Train Loss: 0.0810097 Vali Loss: 0.2003578 Test Loss: 0.2798816
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 45 cost time: 0.8164169788360596
Epoch: 45, Steps: 64 | Train Loss: 0.0806149 Vali Loss: 0.1984619 Test Loss: 0.2798244
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 46 cost time: 0.8077747821807861
Epoch: 46, Steps: 64 | Train Loss: 0.0805442 Vali Loss: 0.1971828 Test Loss: 0.2788970
Validation loss decreased (0.198016 --> 0.197183).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 47 cost time: 0.8059999942779541
Epoch: 47, Steps: 64 | Train Loss: 0.0807437 Vali Loss: 0.2003288 Test Loss: 0.2799462
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 48 cost time: 0.8002626895904541
Epoch: 48, Steps: 64 | Train Loss: 0.0802193 Vali Loss: 0.1994406 Test Loss: 0.2793937
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 49 cost time: 0.8203704357147217
Epoch: 49, Steps: 64 | Train Loss: 0.0812343 Vali Loss: 0.1954091 Test Loss: 0.2801418
Validation loss decreased (0.197183 --> 0.195409).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 50 cost time: 0.8077318668365479
Epoch: 50, Steps: 64 | Train Loss: 0.0813340 Vali Loss: 0.1976360 Test Loss: 0.2788447
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 51 cost time: 0.8130002021789551
Epoch: 51, Steps: 64 | Train Loss: 0.0808783 Vali Loss: 0.1983351 Test Loss: 0.2787176
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 52 cost time: 0.8136191368103027
Epoch: 52, Steps: 64 | Train Loss: 0.0803447 Vali Loss: 0.1982047 Test Loss: 0.2790195
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 53 cost time: 0.807448148727417
Epoch: 53, Steps: 64 | Train Loss: 0.0803410 Vali Loss: 0.1982554 Test Loss: 0.2790724
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 54 cost time: 0.8042709827423096
Epoch: 54, Steps: 64 | Train Loss: 0.0806766 Vali Loss: 0.1987889 Test Loss: 0.2793608
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 55 cost time: 0.8029994964599609
Epoch: 55, Steps: 64 | Train Loss: 0.0806498 Vali Loss: 0.1979171 Test Loss: 0.2787245
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 56 cost time: 0.8026242256164551
Epoch: 56, Steps: 64 | Train Loss: 0.0805192 Vali Loss: 0.1979018 Test Loss: 0.2798689
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 57 cost time: 0.8013300895690918
Epoch: 57, Steps: 64 | Train Loss: 0.0806508 Vali Loss: 0.1974741 Test Loss: 0.2794449
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 58 cost time: 0.8033654689788818
Epoch: 58, Steps: 64 | Train Loss: 0.0808862 Vali Loss: 0.1982022 Test Loss: 0.2785946
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 59 cost time: 0.8046460151672363
Epoch: 59, Steps: 64 | Train Loss: 0.0804607 Vali Loss: 0.1984718 Test Loss: 0.2787609
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 60 cost time: 0.8066141605377197
Epoch: 60, Steps: 64 | Train Loss: 0.0803430 Vali Loss: 0.1965557 Test Loss: 0.2796332
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.28014177083969116, mae:0.3460802137851715, rse:0.24291913211345673
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06267786026000977 GB
Epoch: 1 cost time: 2.27152419090271
Epoch: 1, Steps: 64 | Train Loss: 0.8306274 Vali Loss: 2.4716403 Test Loss: 4.3936610
Validation loss decreased (inf --> 2.471640).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 2 cost time: 0.9090752601623535
Epoch: 2, Steps: 64 | Train Loss: 0.3463751 Vali Loss: 0.2927137 Test Loss: 0.2998818
Validation loss decreased (2.471640 --> 0.292714).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 3 cost time: 0.9153928756713867
Epoch: 3, Steps: 64 | Train Loss: 0.1054971 Vali Loss: 0.2580022 Test Loss: 0.2897116
Validation loss decreased (0.292714 --> 0.258002).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 4 cost time: 0.9113414287567139
Epoch: 4, Steps: 64 | Train Loss: 0.0943123 Vali Loss: 0.2369840 Test Loss: 0.2798045
Validation loss decreased (0.258002 --> 0.236984).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 5 cost time: 0.9099032878875732
Epoch: 5, Steps: 64 | Train Loss: 0.0900811 Vali Loss: 0.2255496 Test Loss: 0.2789622
Validation loss decreased (0.236984 --> 0.225550).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 6 cost time: 0.9020001888275146
Epoch: 6, Steps: 64 | Train Loss: 0.0867153 Vali Loss: 0.2212698 Test Loss: 0.2795976
Validation loss decreased (0.225550 --> 0.221270).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 7 cost time: 0.9106273651123047
Epoch: 7, Steps: 64 | Train Loss: 0.0844775 Vali Loss: 0.2157174 Test Loss: 0.2789003
Validation loss decreased (0.221270 --> 0.215717).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 8 cost time: 0.903221607208252
Epoch: 8, Steps: 64 | Train Loss: 0.0817175 Vali Loss: 0.2071660 Test Loss: 0.2760503
Validation loss decreased (0.215717 --> 0.207166).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 9 cost time: 0.9033248424530029
Epoch: 9, Steps: 64 | Train Loss: 0.0805622 Vali Loss: 0.2076053 Test Loss: 0.2770029
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 10 cost time: 0.9104294776916504
Epoch: 10, Steps: 64 | Train Loss: 0.0788768 Vali Loss: 0.2015139 Test Loss: 0.2747204
Validation loss decreased (0.207166 --> 0.201514).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 11 cost time: 0.9153974056243896
Epoch: 11, Steps: 64 | Train Loss: 0.0770823 Vali Loss: 0.1974098 Test Loss: 0.2761115
Validation loss decreased (0.201514 --> 0.197410).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 12 cost time: 0.9718666076660156
Epoch: 12, Steps: 64 | Train Loss: 0.0755225 Vali Loss: 0.1997605 Test Loss: 0.2766211
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 13 cost time: 0.9077608585357666
Epoch: 13, Steps: 64 | Train Loss: 0.0750660 Vali Loss: 0.1973836 Test Loss: 0.2752039
Validation loss decreased (0.197410 --> 0.197384).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 14 cost time: 0.9009995460510254
Epoch: 14, Steps: 64 | Train Loss: 0.0738112 Vali Loss: 0.1931794 Test Loss: 0.2744257
Validation loss decreased (0.197384 --> 0.193179).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 15 cost time: 0.9046087265014648
Epoch: 15, Steps: 64 | Train Loss: 0.0736486 Vali Loss: 0.1948025 Test Loss: 0.2748707
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 16 cost time: 0.905350923538208
Epoch: 16, Steps: 64 | Train Loss: 0.0725681 Vali Loss: 0.1914734 Test Loss: 0.2743521
Validation loss decreased (0.193179 --> 0.191473).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 17 cost time: 0.9023680686950684
Epoch: 17, Steps: 64 | Train Loss: 0.0723170 Vali Loss: 0.1902754 Test Loss: 0.2753800
Validation loss decreased (0.191473 --> 0.190275).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 18 cost time: 0.9253759384155273
Epoch: 18, Steps: 64 | Train Loss: 0.0717960 Vali Loss: 0.1918303 Test Loss: 0.2738807
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 19 cost time: 0.9094350337982178
Epoch: 19, Steps: 64 | Train Loss: 0.0714466 Vali Loss: 0.1880602 Test Loss: 0.2757981
Validation loss decreased (0.190275 --> 0.188060).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 20 cost time: 0.9057760238647461
Epoch: 20, Steps: 64 | Train Loss: 0.0712873 Vali Loss: 0.1897582 Test Loss: 0.2739708
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 21 cost time: 0.9229998588562012
Epoch: 21, Steps: 64 | Train Loss: 0.0710067 Vali Loss: 0.1900451 Test Loss: 0.2744552
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 22 cost time: 0.906630277633667
Epoch: 22, Steps: 64 | Train Loss: 0.0704329 Vali Loss: 0.1867387 Test Loss: 0.2736588
Validation loss decreased (0.188060 --> 0.186739).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 23 cost time: 0.9026236534118652
Epoch: 23, Steps: 64 | Train Loss: 0.0702157 Vali Loss: 0.1846213 Test Loss: 0.2723566
Validation loss decreased (0.186739 --> 0.184621).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 24 cost time: 0.9024157524108887
Epoch: 24, Steps: 64 | Train Loss: 0.0703979 Vali Loss: 0.1880082 Test Loss: 0.2728288
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 25 cost time: 0.9013738632202148
Epoch: 25, Steps: 64 | Train Loss: 0.0697307 Vali Loss: 0.1889421 Test Loss: 0.2735364
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 26 cost time: 0.9038269519805908
Epoch: 26, Steps: 64 | Train Loss: 0.0697538 Vali Loss: 0.1876120 Test Loss: 0.2729839
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 27 cost time: 0.9091281890869141
Epoch: 27, Steps: 64 | Train Loss: 0.0698699 Vali Loss: 0.1879755 Test Loss: 0.2728753
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 28 cost time: 0.9140002727508545
Epoch: 28, Steps: 64 | Train Loss: 0.0690767 Vali Loss: 0.1819566 Test Loss: 0.2727921
Validation loss decreased (0.184621 --> 0.181957).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 29 cost time: 0.8909997940063477
Epoch: 29, Steps: 64 | Train Loss: 0.0697098 Vali Loss: 0.1846204 Test Loss: 0.2733198
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 30 cost time: 0.9096109867095947
Epoch: 30, Steps: 64 | Train Loss: 0.0691975 Vali Loss: 0.1855055 Test Loss: 0.2731690
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 31 cost time: 0.9029533863067627
Epoch: 31, Steps: 64 | Train Loss: 0.0693567 Vali Loss: 0.1848844 Test Loss: 0.2728928
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 32 cost time: 0.8944005966186523
Epoch: 32, Steps: 64 | Train Loss: 0.0689244 Vali Loss: 0.1842692 Test Loss: 0.2726643
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 33 cost time: 0.9039421081542969
Epoch: 33, Steps: 64 | Train Loss: 0.0691701 Vali Loss: 0.1843225 Test Loss: 0.2723301
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 34 cost time: 0.9057450294494629
Epoch: 34, Steps: 64 | Train Loss: 0.0691929 Vali Loss: 0.1847092 Test Loss: 0.2724502
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 35 cost time: 0.9148683547973633
Epoch: 35, Steps: 64 | Train Loss: 0.0694239 Vali Loss: 0.1870991 Test Loss: 0.2724812
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 36 cost time: 0.9144406318664551
Epoch: 36, Steps: 64 | Train Loss: 0.0689636 Vali Loss: 0.1829583 Test Loss: 0.2712184
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 37 cost time: 0.9116146564483643
Epoch: 37, Steps: 64 | Train Loss: 0.0688686 Vali Loss: 0.1842876 Test Loss: 0.2719281
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 38 cost time: 0.9073145389556885
Epoch: 38, Steps: 64 | Train Loss: 0.0684318 Vali Loss: 0.1854202 Test Loss: 0.2725303
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 39 cost time: 0.9223768711090088
Epoch: 39, Steps: 64 | Train Loss: 0.0690779 Vali Loss: 0.1857083 Test Loss: 0.2720107
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 40 cost time: 0.9090092182159424
Epoch: 40, Steps: 64 | Train Loss: 0.0686724 Vali Loss: 0.1850017 Test Loss: 0.2720496
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 41 cost time: 0.9027233123779297
Epoch: 41, Steps: 64 | Train Loss: 0.0689684 Vali Loss: 0.1856554 Test Loss: 0.2720732
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 42 cost time: 0.9167337417602539
Epoch: 42, Steps: 64 | Train Loss: 0.0689755 Vali Loss: 0.1863796 Test Loss: 0.2729458
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 43 cost time: 0.9059998989105225
Epoch: 43, Steps: 64 | Train Loss: 0.0682062 Vali Loss: 0.1828216 Test Loss: 0.2715495
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 44 cost time: 0.9100227355957031
Epoch: 44, Steps: 64 | Train Loss: 0.0687621 Vali Loss: 0.1843541 Test Loss: 0.2726269
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 45 cost time: 0.913346529006958
Epoch: 45, Steps: 64 | Train Loss: 0.0687465 Vali Loss: 0.1854230 Test Loss: 0.2724957
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 46 cost time: 0.917410135269165
Epoch: 46, Steps: 64 | Train Loss: 0.0686516 Vali Loss: 0.1841515 Test Loss: 0.2718151
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 47 cost time: 0.9103436470031738
Epoch: 47, Steps: 64 | Train Loss: 0.0682572 Vali Loss: 0.1855555 Test Loss: 0.2720136
EarlyStopping counter: 19 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 48 cost time: 0.9104049205780029
Epoch: 48, Steps: 64 | Train Loss: 0.0683517 Vali Loss: 0.1832536 Test Loss: 0.2723669
EarlyStopping counter: 20 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 49 cost time: 0.9167647361755371
Epoch: 49, Steps: 64 | Train Loss: 0.0685792 Vali Loss: 0.1852980 Test Loss: 0.2715875
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 50 cost time: 0.886000394821167
Epoch: 50, Steps: 64 | Train Loss: 0.0688866 Vali Loss: 0.1826377 Test Loss: 0.2719169
EarlyStopping counter: 22 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 51 cost time: 0.9086120128631592
Epoch: 51, Steps: 64 | Train Loss: 0.0685006 Vali Loss: 0.1828318 Test Loss: 0.2721569
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 52 cost time: 0.910330057144165
Epoch: 52, Steps: 64 | Train Loss: 0.0682706 Vali Loss: 0.1843684 Test Loss: 0.2719332
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 53 cost time: 0.9002084732055664
Epoch: 53, Steps: 64 | Train Loss: 0.0686144 Vali Loss: 0.1849351 Test Loss: 0.2720194
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 54 cost time: 0.9854164123535156
Epoch: 54, Steps: 64 | Train Loss: 0.0683987 Vali Loss: 0.1842565 Test Loss: 0.2720235
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 55 cost time: 0.9984955787658691
Epoch: 55, Steps: 64 | Train Loss: 0.0686169 Vali Loss: 0.1844274 Test Loss: 0.2721771
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 56 cost time: 0.9357798099517822
Epoch: 56, Steps: 64 | Train Loss: 0.0681452 Vali Loss: 0.1830255 Test Loss: 0.2724709
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 57 cost time: 0.9140310287475586
Epoch: 57, Steps: 64 | Train Loss: 0.0684875 Vali Loss: 0.1842078 Test Loss: 0.2716587
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 58 cost time: 0.9129996299743652
Epoch: 58, Steps: 64 | Train Loss: 0.0686620 Vali Loss: 0.1841779 Test Loss: 0.2716679
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 59 cost time: 0.9156153202056885
Epoch: 59, Steps: 64 | Train Loss: 0.0683255 Vali Loss: 0.1858658 Test Loss: 0.2719750
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 60 cost time: 0.9063541889190674
Epoch: 60, Steps: 64 | Train Loss: 0.0683813 Vali Loss: 0.1837847 Test Loss: 0.2719850
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2727920413017273, mae:0.3421454429626465, rse:0.23971137404441833
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06597661972045898 GB
Epoch: 1 cost time: 2.3056089878082275
Epoch: 1, Steps: 64 | Train Loss: 0.8243312 Vali Loss: 2.5153377 Test Loss: 4.4218583
Validation loss decreased (inf --> 2.515338).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 2 cost time: 0.9459741115570068
Epoch: 2, Steps: 64 | Train Loss: 0.3352029 Vali Loss: 0.3747668 Test Loss: 0.4329452
Validation loss decreased (2.515338 --> 0.374767).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 3 cost time: 0.9213576316833496
Epoch: 3, Steps: 64 | Train Loss: 0.1063296 Vali Loss: 0.2516777 Test Loss: 0.2870208
Validation loss decreased (0.374767 --> 0.251678).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 4 cost time: 0.9505150318145752
Epoch: 4, Steps: 64 | Train Loss: 0.0921245 Vali Loss: 0.2339894 Test Loss: 0.2800432
Validation loss decreased (0.251678 --> 0.233989).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 5 cost time: 0.9423427581787109
Epoch: 5, Steps: 64 | Train Loss: 0.0877399 Vali Loss: 0.2313725 Test Loss: 0.2777268
Validation loss decreased (0.233989 --> 0.231373).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 6 cost time: 0.9353659152984619
Epoch: 6, Steps: 64 | Train Loss: 0.0847829 Vali Loss: 0.2244174 Test Loss: 0.2780582
Validation loss decreased (0.231373 --> 0.224417).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 7 cost time: 0.9389998912811279
Epoch: 7, Steps: 64 | Train Loss: 0.0823936 Vali Loss: 0.2159989 Test Loss: 0.2764490
Validation loss decreased (0.224417 --> 0.215999).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 8 cost time: 0.9396109580993652
Epoch: 8, Steps: 64 | Train Loss: 0.0795966 Vali Loss: 0.2132085 Test Loss: 0.2775286
Validation loss decreased (0.215999 --> 0.213208).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 9 cost time: 0.9536125659942627
Epoch: 9, Steps: 64 | Train Loss: 0.0778273 Vali Loss: 0.2070472 Test Loss: 0.2771753
Validation loss decreased (0.213208 --> 0.207047).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 10 cost time: 0.9506540298461914
Epoch: 10, Steps: 64 | Train Loss: 0.0768416 Vali Loss: 0.2028714 Test Loss: 0.2757568
Validation loss decreased (0.207047 --> 0.202871).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 11 cost time: 0.9493227005004883
Epoch: 11, Steps: 64 | Train Loss: 0.0753504 Vali Loss: 0.2014614 Test Loss: 0.2761925
Validation loss decreased (0.202871 --> 0.201461).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 12 cost time: 0.9484310150146484
Epoch: 12, Steps: 64 | Train Loss: 0.0747686 Vali Loss: 0.1992597 Test Loss: 0.2742721
Validation loss decreased (0.201461 --> 0.199260).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 13 cost time: 0.9584009647369385
Epoch: 13, Steps: 64 | Train Loss: 0.0733032 Vali Loss: 0.2005017 Test Loss: 0.2727570
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 14 cost time: 0.946014404296875
Epoch: 14, Steps: 64 | Train Loss: 0.0728299 Vali Loss: 0.1948159 Test Loss: 0.2702928
Validation loss decreased (0.199260 --> 0.194816).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 15 cost time: 0.9434459209442139
Epoch: 15, Steps: 64 | Train Loss: 0.0723686 Vali Loss: 0.1924099 Test Loss: 0.2703308
Validation loss decreased (0.194816 --> 0.192410).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 16 cost time: 0.9552667140960693
Epoch: 16, Steps: 64 | Train Loss: 0.0717595 Vali Loss: 0.1932354 Test Loss: 0.2702282
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 17 cost time: 0.94700026512146
Epoch: 17, Steps: 64 | Train Loss: 0.0712891 Vali Loss: 0.1928373 Test Loss: 0.2699827
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 18 cost time: 0.942345380783081
Epoch: 18, Steps: 64 | Train Loss: 0.0710655 Vali Loss: 0.1911334 Test Loss: 0.2702582
Validation loss decreased (0.192410 --> 0.191133).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 19 cost time: 0.9536130428314209
Epoch: 19, Steps: 64 | Train Loss: 0.0706228 Vali Loss: 0.1916737 Test Loss: 0.2682236
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 20 cost time: 0.9524004459381104
Epoch: 20, Steps: 64 | Train Loss: 0.0707816 Vali Loss: 0.1898257 Test Loss: 0.2702124
Validation loss decreased (0.191133 --> 0.189826).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 21 cost time: 0.9463982582092285
Epoch: 21, Steps: 64 | Train Loss: 0.0702916 Vali Loss: 0.1903287 Test Loss: 0.2708568
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 22 cost time: 0.9521293640136719
Epoch: 22, Steps: 64 | Train Loss: 0.0701370 Vali Loss: 0.1891590 Test Loss: 0.2683479
Validation loss decreased (0.189826 --> 0.189159).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 23 cost time: 0.9201767444610596
Epoch: 23, Steps: 64 | Train Loss: 0.0696733 Vali Loss: 0.1875639 Test Loss: 0.2702703
Validation loss decreased (0.189159 --> 0.187564).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 24 cost time: 0.9394948482513428
Epoch: 24, Steps: 64 | Train Loss: 0.0697763 Vali Loss: 0.1883031 Test Loss: 0.2681383
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 25 cost time: 0.9443743228912354
Epoch: 25, Steps: 64 | Train Loss: 0.0697338 Vali Loss: 0.1878643 Test Loss: 0.2690925
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 26 cost time: 0.9441182613372803
Epoch: 26, Steps: 64 | Train Loss: 0.0693882 Vali Loss: 0.1840538 Test Loss: 0.2686435
Validation loss decreased (0.187564 --> 0.184054).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 27 cost time: 0.9419996738433838
Epoch: 27, Steps: 64 | Train Loss: 0.0687611 Vali Loss: 0.1881039 Test Loss: 0.2695112
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 28 cost time: 0.9440000057220459
Epoch: 28, Steps: 64 | Train Loss: 0.0692530 Vali Loss: 0.1872474 Test Loss: 0.2685030
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 29 cost time: 0.9516189098358154
Epoch: 29, Steps: 64 | Train Loss: 0.0690030 Vali Loss: 0.1859033 Test Loss: 0.2689108
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 30 cost time: 0.9417629241943359
Epoch: 30, Steps: 64 | Train Loss: 0.0689371 Vali Loss: 0.1841088 Test Loss: 0.2686130
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 31 cost time: 0.9403667449951172
Epoch: 31, Steps: 64 | Train Loss: 0.0687858 Vali Loss: 0.1860671 Test Loss: 0.2680506
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 32 cost time: 0.9413626194000244
Epoch: 32, Steps: 64 | Train Loss: 0.0686797 Vali Loss: 0.1835035 Test Loss: 0.2686916
Validation loss decreased (0.184054 --> 0.183504).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 33 cost time: 0.9602718353271484
Epoch: 33, Steps: 64 | Train Loss: 0.0684334 Vali Loss: 0.1856283 Test Loss: 0.2678382
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 34 cost time: 0.9497053623199463
Epoch: 34, Steps: 64 | Train Loss: 0.0687358 Vali Loss: 0.1837980 Test Loss: 0.2684575
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 35 cost time: 0.94873046875
Epoch: 35, Steps: 64 | Train Loss: 0.0684211 Vali Loss: 0.1866495 Test Loss: 0.2681699
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 36 cost time: 0.9637486934661865
Epoch: 36, Steps: 64 | Train Loss: 0.0682035 Vali Loss: 0.1843774 Test Loss: 0.2688484
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 37 cost time: 0.9489998817443848
Epoch: 37, Steps: 64 | Train Loss: 0.0682593 Vali Loss: 0.1846655 Test Loss: 0.2681471
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 38 cost time: 0.9467833042144775
Epoch: 38, Steps: 64 | Train Loss: 0.0682590 Vali Loss: 0.1849789 Test Loss: 0.2682970
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 39 cost time: 0.9546327590942383
Epoch: 39, Steps: 64 | Train Loss: 0.0684849 Vali Loss: 0.1856791 Test Loss: 0.2678401
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 40 cost time: 0.9523594379425049
Epoch: 40, Steps: 64 | Train Loss: 0.0683710 Vali Loss: 0.1851362 Test Loss: 0.2680138
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 41 cost time: 0.9453389644622803
Epoch: 41, Steps: 64 | Train Loss: 0.0681601 Vali Loss: 0.1841602 Test Loss: 0.2680651
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 42 cost time: 0.9496588706970215
Epoch: 42, Steps: 64 | Train Loss: 0.0690966 Vali Loss: 0.1842029 Test Loss: 0.2690187
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 43 cost time: 0.9483432769775391
Epoch: 43, Steps: 64 | Train Loss: 0.0682253 Vali Loss: 0.1841885 Test Loss: 0.2678436
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 44 cost time: 0.9374206066131592
Epoch: 44, Steps: 64 | Train Loss: 0.0684407 Vali Loss: 0.1828641 Test Loss: 0.2678189
Validation loss decreased (0.183504 --> 0.182864).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 45 cost time: 0.9483623504638672
Epoch: 45, Steps: 64 | Train Loss: 0.0684993 Vali Loss: 0.1835970 Test Loss: 0.2681690
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 46 cost time: 0.9307601451873779
Epoch: 46, Steps: 64 | Train Loss: 0.0685517 Vali Loss: 0.1851981 Test Loss: 0.2681289
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 47 cost time: 0.9317986965179443
Epoch: 47, Steps: 64 | Train Loss: 0.0680879 Vali Loss: 0.1855138 Test Loss: 0.2681589
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 48 cost time: 0.9446232318878174
Epoch: 48, Steps: 64 | Train Loss: 0.0681157 Vali Loss: 0.1823625 Test Loss: 0.2681083
Validation loss decreased (0.182864 --> 0.182363).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 49 cost time: 0.9426259994506836
Epoch: 49, Steps: 64 | Train Loss: 0.0682097 Vali Loss: 0.1847764 Test Loss: 0.2685427
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 50 cost time: 0.9613943099975586
Epoch: 50, Steps: 64 | Train Loss: 0.0683402 Vali Loss: 0.1831430 Test Loss: 0.2680727
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 51 cost time: 0.9454419612884521
Epoch: 51, Steps: 64 | Train Loss: 0.0685452 Vali Loss: 0.1832200 Test Loss: 0.2678671
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 52 cost time: 0.9424030780792236
Epoch: 52, Steps: 64 | Train Loss: 0.0678497 Vali Loss: 0.1827733 Test Loss: 0.2678551
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 53 cost time: 0.9237058162689209
Epoch: 53, Steps: 64 | Train Loss: 0.0684752 Vali Loss: 0.1843355 Test Loss: 0.2681220
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 54 cost time: 0.943350076675415
Epoch: 54, Steps: 64 | Train Loss: 0.0680769 Vali Loss: 0.1861313 Test Loss: 0.2680951
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 55 cost time: 0.9422163963317871
Epoch: 55, Steps: 64 | Train Loss: 0.0677332 Vali Loss: 0.1858041 Test Loss: 0.2677905
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 56 cost time: 0.9564714431762695
Epoch: 56, Steps: 64 | Train Loss: 0.0681854 Vali Loss: 0.1846480 Test Loss: 0.2683282
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 57 cost time: 0.9409999847412109
Epoch: 57, Steps: 64 | Train Loss: 0.0683804 Vali Loss: 0.1811908 Test Loss: 0.2677869
Validation loss decreased (0.182363 --> 0.181191).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 58 cost time: 0.9466204643249512
Epoch: 58, Steps: 64 | Train Loss: 0.0682695 Vali Loss: 0.1847517 Test Loss: 0.2677009
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 59 cost time: 0.9623246192932129
Epoch: 59, Steps: 64 | Train Loss: 0.0680484 Vali Loss: 0.1823145 Test Loss: 0.2675427
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 60 cost time: 0.9503529071807861
Epoch: 60, Steps: 64 | Train Loss: 0.0676770 Vali Loss: 0.1860744 Test Loss: 0.2685708
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2677868902683258, mae:0.3399237394332886, rse:0.2375020980834961
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058444976806640625 GB
Epoch: 1 cost time: 2.2764410972595215
Epoch: 1, Steps: 64 | Train Loss: 0.9901466 Vali Loss: 2.9445553 Test Loss: 5.1810322
Validation loss decreased (inf --> 2.944555).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 2 cost time: 0.8854329586029053
Epoch: 2, Steps: 64 | Train Loss: 0.7330415 Vali Loss: 1.3759863 Test Loss: 2.2636676
Validation loss decreased (2.944555 --> 1.375986).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 3 cost time: 0.8827829360961914
Epoch: 3, Steps: 64 | Train Loss: 0.3901273 Vali Loss: 0.8414639 Test Loss: 1.2681456
Validation loss decreased (1.375986 --> 0.841464).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 4 cost time: 0.875420331954956
Epoch: 4, Steps: 64 | Train Loss: 0.2431082 Vali Loss: 0.5570071 Test Loss: 0.7957323
Validation loss decreased (0.841464 --> 0.557007).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 5 cost time: 0.8764376640319824
Epoch: 5, Steps: 64 | Train Loss: 0.1702857 Vali Loss: 0.4057530 Test Loss: 0.5526384
Validation loss decreased (0.557007 --> 0.405753).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 6 cost time: 0.8766193389892578
Epoch: 6, Steps: 64 | Train Loss: 0.1352566 Vali Loss: 0.3252171 Test Loss: 0.4294553
Validation loss decreased (0.405753 --> 0.325217).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 7 cost time: 0.8684368133544922
Epoch: 7, Steps: 64 | Train Loss: 0.1183490 Vali Loss: 0.2870443 Test Loss: 0.3680620
Validation loss decreased (0.325217 --> 0.287044).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 8 cost time: 0.8724961280822754
Epoch: 8, Steps: 64 | Train Loss: 0.1087587 Vali Loss: 0.2658479 Test Loss: 0.3333662
Validation loss decreased (0.287044 --> 0.265848).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 9 cost time: 0.8714540004730225
Epoch: 9, Steps: 64 | Train Loss: 0.1028323 Vali Loss: 0.2504135 Test Loss: 0.3164933
Validation loss decreased (0.265848 --> 0.250413).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 10 cost time: 0.8866803646087646
Epoch: 10, Steps: 64 | Train Loss: 0.0997888 Vali Loss: 0.2445461 Test Loss: 0.3054633
Validation loss decreased (0.250413 --> 0.244546).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 11 cost time: 0.8830001354217529
Epoch: 11, Steps: 64 | Train Loss: 0.0964090 Vali Loss: 0.2350984 Test Loss: 0.3042357
Validation loss decreased (0.244546 --> 0.235098).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 12 cost time: 0.8787965774536133
Epoch: 12, Steps: 64 | Train Loss: 0.0956766 Vali Loss: 0.2287816 Test Loss: 0.2957928
Validation loss decreased (0.235098 --> 0.228782).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 13 cost time: 0.8853676319122314
Epoch: 13, Steps: 64 | Train Loss: 0.0935702 Vali Loss: 0.2284967 Test Loss: 0.2950750
Validation loss decreased (0.228782 --> 0.228497).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 14 cost time: 0.8744473457336426
Epoch: 14, Steps: 64 | Train Loss: 0.0925530 Vali Loss: 0.2270245 Test Loss: 0.2906187
Validation loss decreased (0.228497 --> 0.227024).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 15 cost time: 0.8714156150817871
Epoch: 15, Steps: 64 | Train Loss: 0.0916445 Vali Loss: 0.2232283 Test Loss: 0.2893191
Validation loss decreased (0.227024 --> 0.223228).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 16 cost time: 0.8797628879547119
Epoch: 16, Steps: 64 | Train Loss: 0.0910019 Vali Loss: 0.2193361 Test Loss: 0.2867995
Validation loss decreased (0.223228 --> 0.219336).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 17 cost time: 0.8840591907501221
Epoch: 17, Steps: 64 | Train Loss: 0.0902155 Vali Loss: 0.2179043 Test Loss: 0.2867337
Validation loss decreased (0.219336 --> 0.217904).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 18 cost time: 0.9616031646728516
Epoch: 18, Steps: 64 | Train Loss: 0.0894863 Vali Loss: 0.2193295 Test Loss: 0.2860338
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 19 cost time: 0.958385705947876
Epoch: 19, Steps: 64 | Train Loss: 0.0888839 Vali Loss: 0.2154521 Test Loss: 0.2854637
Validation loss decreased (0.217904 --> 0.215452).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 20 cost time: 0.9754340648651123
Epoch: 20, Steps: 64 | Train Loss: 0.0881091 Vali Loss: 0.2178943 Test Loss: 0.2876727
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 21 cost time: 0.897270679473877
Epoch: 21, Steps: 64 | Train Loss: 0.0871183 Vali Loss: 0.2148543 Test Loss: 0.2848853
Validation loss decreased (0.215452 --> 0.214854).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 22 cost time: 0.8954408168792725
Epoch: 22, Steps: 64 | Train Loss: 0.0866623 Vali Loss: 0.2133749 Test Loss: 0.2827463
Validation loss decreased (0.214854 --> 0.213375).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 23 cost time: 0.8877096176147461
Epoch: 23, Steps: 64 | Train Loss: 0.0869737 Vali Loss: 0.2120578 Test Loss: 0.2835755
Validation loss decreased (0.213375 --> 0.212058).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 24 cost time: 0.8770010471343994
Epoch: 24, Steps: 64 | Train Loss: 0.0870448 Vali Loss: 0.2100951 Test Loss: 0.2817205
Validation loss decreased (0.212058 --> 0.210095).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 25 cost time: 0.8516719341278076
Epoch: 25, Steps: 64 | Train Loss: 0.0861374 Vali Loss: 0.2087988 Test Loss: 0.2834583
Validation loss decreased (0.210095 --> 0.208799).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 26 cost time: 0.859137773513794
Epoch: 26, Steps: 64 | Train Loss: 0.0862450 Vali Loss: 0.2082245 Test Loss: 0.2825132
Validation loss decreased (0.208799 --> 0.208225).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 27 cost time: 0.8763518333435059
Epoch: 27, Steps: 64 | Train Loss: 0.0853986 Vali Loss: 0.2081335 Test Loss: 0.2808324
Validation loss decreased (0.208225 --> 0.208134).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 28 cost time: 0.8689978122711182
Epoch: 28, Steps: 64 | Train Loss: 0.0852298 Vali Loss: 0.2078019 Test Loss: 0.2808405
Validation loss decreased (0.208134 --> 0.207802).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 29 cost time: 0.8809726238250732
Epoch: 29, Steps: 64 | Train Loss: 0.0850238 Vali Loss: 0.2084628 Test Loss: 0.2816879
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 30 cost time: 0.8836679458618164
Epoch: 30, Steps: 64 | Train Loss: 0.0848304 Vali Loss: 0.2100805 Test Loss: 0.2811064
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 31 cost time: 0.8856260776519775
Epoch: 31, Steps: 64 | Train Loss: 0.0849833 Vali Loss: 0.2060844 Test Loss: 0.2804385
Validation loss decreased (0.207802 --> 0.206084).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 32 cost time: 0.8763728141784668
Epoch: 32, Steps: 64 | Train Loss: 0.0847412 Vali Loss: 0.2062893 Test Loss: 0.2794738
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 33 cost time: 0.8704745769500732
Epoch: 33, Steps: 64 | Train Loss: 0.0845518 Vali Loss: 0.2107559 Test Loss: 0.2785701
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 34 cost time: 0.8674578666687012
Epoch: 34, Steps: 64 | Train Loss: 0.0842717 Vali Loss: 0.2061915 Test Loss: 0.2801623
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 35 cost time: 0.8833551406860352
Epoch: 35, Steps: 64 | Train Loss: 0.0839258 Vali Loss: 0.2082825 Test Loss: 0.2812529
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 36 cost time: 0.8746321201324463
Epoch: 36, Steps: 64 | Train Loss: 0.0840857 Vali Loss: 0.2074601 Test Loss: 0.2790528
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 37 cost time: 0.8806164264678955
Epoch: 37, Steps: 64 | Train Loss: 0.0841841 Vali Loss: 0.2048119 Test Loss: 0.2795336
Validation loss decreased (0.206084 --> 0.204812).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 38 cost time: 0.8943736553192139
Epoch: 38, Steps: 64 | Train Loss: 0.0840296 Vali Loss: 0.2059657 Test Loss: 0.2798807
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 39 cost time: 0.8763771057128906
Epoch: 39, Steps: 64 | Train Loss: 0.0837378 Vali Loss: 0.2058588 Test Loss: 0.2791136
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 40 cost time: 0.8793430328369141
Epoch: 40, Steps: 64 | Train Loss: 0.0843295 Vali Loss: 0.2044714 Test Loss: 0.2780946
Validation loss decreased (0.204812 --> 0.204471).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 41 cost time: 0.8767533302307129
Epoch: 41, Steps: 64 | Train Loss: 0.0835512 Vali Loss: 0.2064767 Test Loss: 0.2796755
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 42 cost time: 0.8860001564025879
Epoch: 42, Steps: 64 | Train Loss: 0.0834834 Vali Loss: 0.2074989 Test Loss: 0.2801374
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 43 cost time: 0.8733763694763184
Epoch: 43, Steps: 64 | Train Loss: 0.0837762 Vali Loss: 0.2073725 Test Loss: 0.2805249
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 44 cost time: 0.8743658065795898
Epoch: 44, Steps: 64 | Train Loss: 0.0834553 Vali Loss: 0.2065916 Test Loss: 0.2791176
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 45 cost time: 0.876373291015625
Epoch: 45, Steps: 64 | Train Loss: 0.0833920 Vali Loss: 0.2043751 Test Loss: 0.2795923
Validation loss decreased (0.204471 --> 0.204375).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 46 cost time: 0.8813726902008057
Epoch: 46, Steps: 64 | Train Loss: 0.0834542 Vali Loss: 0.2047319 Test Loss: 0.2789527
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 47 cost time: 0.8770625591278076
Epoch: 47, Steps: 64 | Train Loss: 0.0831210 Vali Loss: 0.2052650 Test Loss: 0.2794959
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 48 cost time: 0.8815367221832275
Epoch: 48, Steps: 64 | Train Loss: 0.0832265 Vali Loss: 0.2056224 Test Loss: 0.2790426
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 49 cost time: 0.8846182823181152
Epoch: 49, Steps: 64 | Train Loss: 0.0830154 Vali Loss: 0.2064411 Test Loss: 0.2802150
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 50 cost time: 0.8713557720184326
Epoch: 50, Steps: 64 | Train Loss: 0.0837843 Vali Loss: 0.2043784 Test Loss: 0.2782033
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 51 cost time: 0.8753721714019775
Epoch: 51, Steps: 64 | Train Loss: 0.0835580 Vali Loss: 0.2060534 Test Loss: 0.2786784
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 52 cost time: 0.8734135627746582
Epoch: 52, Steps: 64 | Train Loss: 0.0830485 Vali Loss: 0.2077456 Test Loss: 0.2814507
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 53 cost time: 0.873255729675293
Epoch: 53, Steps: 64 | Train Loss: 0.0832498 Vali Loss: 0.2056617 Test Loss: 0.2782515
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 54 cost time: 0.879000186920166
Epoch: 54, Steps: 64 | Train Loss: 0.0829866 Vali Loss: 0.2055111 Test Loss: 0.2778263
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 55 cost time: 0.8796110153198242
Epoch: 55, Steps: 64 | Train Loss: 0.0829563 Vali Loss: 0.2065384 Test Loss: 0.2790172
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 56 cost time: 0.8903472423553467
Epoch: 56, Steps: 64 | Train Loss: 0.0833727 Vali Loss: 0.2027770 Test Loss: 0.2784629
Validation loss decreased (0.204375 --> 0.202777).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 57 cost time: 0.8830294609069824
Epoch: 57, Steps: 64 | Train Loss: 0.0830123 Vali Loss: 0.2058682 Test Loss: 0.2786565
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 58 cost time: 0.8795011043548584
Epoch: 58, Steps: 64 | Train Loss: 0.0837018 Vali Loss: 0.2057320 Test Loss: 0.2775742
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 59 cost time: 0.875751256942749
Epoch: 59, Steps: 64 | Train Loss: 0.0827450 Vali Loss: 0.2053221 Test Loss: 0.2783766
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 60 cost time: 0.884000301361084
Epoch: 60, Steps: 64 | Train Loss: 0.0826350 Vali Loss: 0.2043777 Test Loss: 0.2780859
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2784629166126251, mae:0.33579573035240173, rse:0.2421901524066925
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.06283950805664062 GB
Epoch: 1 cost time: 2.234684705734253
Epoch: 1, Steps: 64 | Train Loss: 0.8343946 Vali Loss: 2.4932253 Test Loss: 4.3695946
Validation loss decreased (inf --> 2.493225).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 2 cost time: 0.8544058799743652
Epoch: 2, Steps: 64 | Train Loss: 0.3446779 Vali Loss: 0.2914102 Test Loss: 0.2859331
Validation loss decreased (2.493225 --> 0.291410).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 3 cost time: 0.8502860069274902
Epoch: 3, Steps: 64 | Train Loss: 0.1034756 Vali Loss: 0.2449766 Test Loss: 0.2885897
Validation loss decreased (0.291410 --> 0.244977).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 4 cost time: 0.8523588180541992
Epoch: 4, Steps: 64 | Train Loss: 0.0921386 Vali Loss: 0.2277620 Test Loss: 0.2731006
Validation loss decreased (0.244977 --> 0.227762).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 5 cost time: 0.8502218723297119
Epoch: 5, Steps: 64 | Train Loss: 0.0876869 Vali Loss: 0.2192540 Test Loss: 0.2709204
Validation loss decreased (0.227762 --> 0.219254).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 6 cost time: 0.847804069519043
Epoch: 6, Steps: 64 | Train Loss: 0.0855655 Vali Loss: 0.2166229 Test Loss: 0.2718714
Validation loss decreased (0.219254 --> 0.216623).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 7 cost time: 0.8436322212219238
Epoch: 7, Steps: 64 | Train Loss: 0.0826273 Vali Loss: 0.2126337 Test Loss: 0.2763781
Validation loss decreased (0.216623 --> 0.212634).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 8 cost time: 0.8484277725219727
Epoch: 8, Steps: 64 | Train Loss: 0.0813385 Vali Loss: 0.2124670 Test Loss: 0.2688245
Validation loss decreased (0.212634 --> 0.212467).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 9 cost time: 0.846494197845459
Epoch: 9, Steps: 64 | Train Loss: 0.0796528 Vali Loss: 0.2087854 Test Loss: 0.2688963
Validation loss decreased (0.212467 --> 0.208785).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 10 cost time: 0.8487517833709717
Epoch: 10, Steps: 64 | Train Loss: 0.0781328 Vali Loss: 0.2053540 Test Loss: 0.2648753
Validation loss decreased (0.208785 --> 0.205354).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 11 cost time: 0.8559999465942383
Epoch: 11, Steps: 64 | Train Loss: 0.0774207 Vali Loss: 0.1991011 Test Loss: 0.2673786
Validation loss decreased (0.205354 --> 0.199101).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 12 cost time: 0.846625804901123
Epoch: 12, Steps: 64 | Train Loss: 0.0766100 Vali Loss: 0.1967417 Test Loss: 0.2651986
Validation loss decreased (0.199101 --> 0.196742).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 13 cost time: 0.8534038066864014
Epoch: 13, Steps: 64 | Train Loss: 0.0751102 Vali Loss: 0.1959551 Test Loss: 0.2618426
Validation loss decreased (0.196742 --> 0.195955).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 14 cost time: 0.8610022068023682
Epoch: 14, Steps: 64 | Train Loss: 0.0746854 Vali Loss: 0.1875931 Test Loss: 0.2645286
Validation loss decreased (0.195955 --> 0.187593).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 15 cost time: 0.8472564220428467
Epoch: 15, Steps: 64 | Train Loss: 0.0733632 Vali Loss: 0.1915620 Test Loss: 0.2618974
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 16 cost time: 0.8504512310028076
Epoch: 16, Steps: 64 | Train Loss: 0.0732151 Vali Loss: 0.1900962 Test Loss: 0.2628406
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 17 cost time: 0.8470001220703125
Epoch: 17, Steps: 64 | Train Loss: 0.0727428 Vali Loss: 0.1876968 Test Loss: 0.2645286
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 18 cost time: 0.8610916137695312
Epoch: 18, Steps: 64 | Train Loss: 0.0724336 Vali Loss: 0.1891132 Test Loss: 0.2626087
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 19 cost time: 0.8523898124694824
Epoch: 19, Steps: 64 | Train Loss: 0.0721710 Vali Loss: 0.1893302 Test Loss: 0.2640245
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 20 cost time: 0.8507170677185059
Epoch: 20, Steps: 64 | Train Loss: 0.0720894 Vali Loss: 0.1869722 Test Loss: 0.2630484
Validation loss decreased (0.187593 --> 0.186972).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 21 cost time: 0.8467614650726318
Epoch: 21, Steps: 64 | Train Loss: 0.0715182 Vali Loss: 0.1855735 Test Loss: 0.2596326
Validation loss decreased (0.186972 --> 0.185574).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 22 cost time: 0.8575193881988525
Epoch: 22, Steps: 64 | Train Loss: 0.0711995 Vali Loss: 0.1872633 Test Loss: 0.2613812
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 23 cost time: 0.8506169319152832
Epoch: 23, Steps: 64 | Train Loss: 0.0712845 Vali Loss: 0.1858345 Test Loss: 0.2609514
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 24 cost time: 0.8494143486022949
Epoch: 24, Steps: 64 | Train Loss: 0.0712953 Vali Loss: 0.1854263 Test Loss: 0.2612293
Validation loss decreased (0.185574 --> 0.185426).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 25 cost time: 0.8464429378509521
Epoch: 25, Steps: 64 | Train Loss: 0.0708196 Vali Loss: 0.1861053 Test Loss: 0.2609009
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 26 cost time: 0.8484101295471191
Epoch: 26, Steps: 64 | Train Loss: 0.0706126 Vali Loss: 0.1861679 Test Loss: 0.2606139
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 27 cost time: 0.8464868068695068
Epoch: 27, Steps: 64 | Train Loss: 0.0704912 Vali Loss: 0.1841353 Test Loss: 0.2614264
Validation loss decreased (0.185426 --> 0.184135).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 28 cost time: 0.8466188907623291
Epoch: 28, Steps: 64 | Train Loss: 0.0706570 Vali Loss: 0.1862457 Test Loss: 0.2610112
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 29 cost time: 0.8444130420684814
Epoch: 29, Steps: 64 | Train Loss: 0.0705592 Vali Loss: 0.1855368 Test Loss: 0.2609302
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 30 cost time: 0.9374232292175293
Epoch: 30, Steps: 64 | Train Loss: 0.0703377 Vali Loss: 0.1841272 Test Loss: 0.2610441
Validation loss decreased (0.184135 --> 0.184127).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 31 cost time: 0.8449687957763672
Epoch: 31, Steps: 64 | Train Loss: 0.0703585 Vali Loss: 0.1839579 Test Loss: 0.2600256
Validation loss decreased (0.184127 --> 0.183958).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 32 cost time: 0.8428242206573486
Epoch: 32, Steps: 64 | Train Loss: 0.0701130 Vali Loss: 0.1853001 Test Loss: 0.2605047
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 33 cost time: 0.8409998416900635
Epoch: 33, Steps: 64 | Train Loss: 0.0698875 Vali Loss: 0.1847799 Test Loss: 0.2607698
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 34 cost time: 0.8406133651733398
Epoch: 34, Steps: 64 | Train Loss: 0.0700382 Vali Loss: 0.1858899 Test Loss: 0.2608116
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 35 cost time: 0.8420233726501465
Epoch: 35, Steps: 64 | Train Loss: 0.0701252 Vali Loss: 0.1848757 Test Loss: 0.2615187
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 36 cost time: 0.8503527641296387
Epoch: 36, Steps: 64 | Train Loss: 0.0697034 Vali Loss: 0.1846163 Test Loss: 0.2607987
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 37 cost time: 0.8241188526153564
Epoch: 37, Steps: 64 | Train Loss: 0.0703374 Vali Loss: 0.1840306 Test Loss: 0.2604426
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 38 cost time: 0.934999942779541
Epoch: 38, Steps: 64 | Train Loss: 0.0701692 Vali Loss: 0.1829807 Test Loss: 0.2605217
Validation loss decreased (0.183958 --> 0.182981).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 39 cost time: 0.9267966747283936
Epoch: 39, Steps: 64 | Train Loss: 0.0703682 Vali Loss: 0.1845745 Test Loss: 0.2603591
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 40 cost time: 0.8616158962249756
Epoch: 40, Steps: 64 | Train Loss: 0.0694254 Vali Loss: 0.1846144 Test Loss: 0.2606606
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 41 cost time: 0.8443465232849121
Epoch: 41, Steps: 64 | Train Loss: 0.0698787 Vali Loss: 0.1835035 Test Loss: 0.2608923
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 42 cost time: 0.8414244651794434
Epoch: 42, Steps: 64 | Train Loss: 0.0693859 Vali Loss: 0.1878113 Test Loss: 0.2612402
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 43 cost time: 0.8397417068481445
Epoch: 43, Steps: 64 | Train Loss: 0.0696927 Vali Loss: 0.1856033 Test Loss: 0.2607048
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 44 cost time: 0.8534314632415771
Epoch: 44, Steps: 64 | Train Loss: 0.0700355 Vali Loss: 0.1823221 Test Loss: 0.2602765
Validation loss decreased (0.182981 --> 0.182322).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 45 cost time: 0.8496205806732178
Epoch: 45, Steps: 64 | Train Loss: 0.0695545 Vali Loss: 0.1839857 Test Loss: 0.2603768
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 46 cost time: 0.8463726043701172
Epoch: 46, Steps: 64 | Train Loss: 0.0695176 Vali Loss: 0.1864577 Test Loss: 0.2607739
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 47 cost time: 0.8553781509399414
Epoch: 47, Steps: 64 | Train Loss: 0.0696110 Vali Loss: 0.1840798 Test Loss: 0.2602224
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 48 cost time: 0.8483572006225586
Epoch: 48, Steps: 64 | Train Loss: 0.0695691 Vali Loss: 0.1842394 Test Loss: 0.2603627
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 49 cost time: 0.8520472049713135
Epoch: 49, Steps: 64 | Train Loss: 0.0695942 Vali Loss: 0.1856703 Test Loss: 0.2602044
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 50 cost time: 0.8429999351501465
Epoch: 50, Steps: 64 | Train Loss: 0.0696921 Vali Loss: 0.1843960 Test Loss: 0.2597314
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 51 cost time: 0.8506729602813721
Epoch: 51, Steps: 64 | Train Loss: 0.0696064 Vali Loss: 0.1838315 Test Loss: 0.2602169
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 52 cost time: 0.8503396511077881
Epoch: 52, Steps: 64 | Train Loss: 0.0697791 Vali Loss: 0.1865317 Test Loss: 0.2611340
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 53 cost time: 0.8454220294952393
Epoch: 53, Steps: 64 | Train Loss: 0.0694188 Vali Loss: 0.1845513 Test Loss: 0.2606086
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 54 cost time: 0.8527700901031494
Epoch: 54, Steps: 64 | Train Loss: 0.0698504 Vali Loss: 0.1842222 Test Loss: 0.2608165
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 55 cost time: 0.8429996967315674
Epoch: 55, Steps: 64 | Train Loss: 0.0691278 Vali Loss: 0.1842505 Test Loss: 0.2607181
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 56 cost time: 0.8472423553466797
Epoch: 56, Steps: 64 | Train Loss: 0.0699310 Vali Loss: 0.1851083 Test Loss: 0.2604350
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 57 cost time: 0.8474218845367432
Epoch: 57, Steps: 64 | Train Loss: 0.0693012 Vali Loss: 0.1831929 Test Loss: 0.2603509
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 58 cost time: 0.8500027656555176
Epoch: 58, Steps: 64 | Train Loss: 0.0696245 Vali Loss: 0.1809759 Test Loss: 0.2602070
Validation loss decreased (0.182322 --> 0.180976).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 59 cost time: 0.8467237949371338
Epoch: 59, Steps: 64 | Train Loss: 0.0693242 Vali Loss: 0.1839166 Test Loss: 0.2608864
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 60 cost time: 0.8450000286102295
Epoch: 60, Steps: 64 | Train Loss: 0.0694869 Vali Loss: 0.1834750 Test Loss: 0.2608770
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.26020699739456177, mae:0.3285888433456421, rse:0.23411662876605988
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06613826751708984 GB
Epoch: 1 cost time: 2.3140575885772705
Epoch: 1, Steps: 64 | Train Loss: 0.8058670 Vali Loss: 2.4384656 Test Loss: 4.2897229
Validation loss decreased (inf --> 2.438466).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 2 cost time: 0.9516174793243408
Epoch: 2, Steps: 64 | Train Loss: 0.2946816 Vali Loss: 0.3300658 Test Loss: 0.3890001
Validation loss decreased (2.438466 --> 0.330066).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 3 cost time: 0.9494843482971191
Epoch: 3, Steps: 64 | Train Loss: 0.0993297 Vali Loss: 0.2395677 Test Loss: 0.2777959
Validation loss decreased (0.330066 --> 0.239568).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 4 cost time: 0.9574079513549805
Epoch: 4, Steps: 64 | Train Loss: 0.0885737 Vali Loss: 0.2262720 Test Loss: 0.2781456
Validation loss decreased (0.239568 --> 0.226272).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 5 cost time: 0.9453942775726318
Epoch: 5, Steps: 64 | Train Loss: 0.0847869 Vali Loss: 0.2245828 Test Loss: 0.2758761
Validation loss decreased (0.226272 --> 0.224583).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 6 cost time: 0.9683942794799805
Epoch: 6, Steps: 64 | Train Loss: 0.0824388 Vali Loss: 0.2158933 Test Loss: 0.2776152
Validation loss decreased (0.224583 --> 0.215893).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 7 cost time: 0.9458787441253662
Epoch: 7, Steps: 64 | Train Loss: 0.0799807 Vali Loss: 0.2146120 Test Loss: 0.2755114
Validation loss decreased (0.215893 --> 0.214612).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 8 cost time: 0.9460000991821289
Epoch: 8, Steps: 64 | Train Loss: 0.0785651 Vali Loss: 0.2106546 Test Loss: 0.2731743
Validation loss decreased (0.214612 --> 0.210655).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 9 cost time: 0.9486026763916016
Epoch: 9, Steps: 64 | Train Loss: 0.0770999 Vali Loss: 0.2056602 Test Loss: 0.2762816
Validation loss decreased (0.210655 --> 0.205660).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 10 cost time: 0.9559996128082275
Epoch: 10, Steps: 64 | Train Loss: 0.0763094 Vali Loss: 0.2005409 Test Loss: 0.2736688
Validation loss decreased (0.205660 --> 0.200541).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 11 cost time: 0.9575290679931641
Epoch: 11, Steps: 64 | Train Loss: 0.0746961 Vali Loss: 0.2003110 Test Loss: 0.2746608
Validation loss decreased (0.200541 --> 0.200311).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 12 cost time: 0.9636404514312744
Epoch: 12, Steps: 64 | Train Loss: 0.0738961 Vali Loss: 0.1961931 Test Loss: 0.2715595
Validation loss decreased (0.200311 --> 0.196193).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 13 cost time: 0.9496259689331055
Epoch: 13, Steps: 64 | Train Loss: 0.0730934 Vali Loss: 0.1947727 Test Loss: 0.2695943
Validation loss decreased (0.196193 --> 0.194773).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 14 cost time: 0.9573826789855957
Epoch: 14, Steps: 64 | Train Loss: 0.0721103 Vali Loss: 0.1949895 Test Loss: 0.2719962
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 15 cost time: 0.9573893547058105
Epoch: 15, Steps: 64 | Train Loss: 0.0721166 Vali Loss: 0.1913104 Test Loss: 0.2696007
Validation loss decreased (0.194773 --> 0.191310).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 16 cost time: 0.9693953990936279
Epoch: 16, Steps: 64 | Train Loss: 0.0712785 Vali Loss: 0.1879175 Test Loss: 0.2680308
Validation loss decreased (0.191310 --> 0.187918).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 17 cost time: 0.9753944873809814
Epoch: 17, Steps: 64 | Train Loss: 0.0706897 Vali Loss: 0.1859481 Test Loss: 0.2670575
Validation loss decreased (0.187918 --> 0.185948).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 18 cost time: 0.9802846908569336
Epoch: 18, Steps: 64 | Train Loss: 0.0705487 Vali Loss: 0.1867057 Test Loss: 0.2666075
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 19 cost time: 0.9707155227661133
Epoch: 19, Steps: 64 | Train Loss: 0.0698823 Vali Loss: 0.1853298 Test Loss: 0.2674645
Validation loss decreased (0.185948 --> 0.185330).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 20 cost time: 0.9767239093780518
Epoch: 20, Steps: 64 | Train Loss: 0.0694709 Vali Loss: 0.1889448 Test Loss: 0.2663819
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 21 cost time: 0.9666931629180908
Epoch: 21, Steps: 64 | Train Loss: 0.0694780 Vali Loss: 0.1823426 Test Loss: 0.2669955
Validation loss decreased (0.185330 --> 0.182343).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 22 cost time: 0.9508829116821289
Epoch: 22, Steps: 64 | Train Loss: 0.0692860 Vali Loss: 0.1827185 Test Loss: 0.2657256
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 23 cost time: 0.9513983726501465
Epoch: 23, Steps: 64 | Train Loss: 0.0687966 Vali Loss: 0.1888154 Test Loss: 0.2671683
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 24 cost time: 0.9466211795806885
Epoch: 24, Steps: 64 | Train Loss: 0.0688364 Vali Loss: 0.1883056 Test Loss: 0.2671042
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 25 cost time: 0.9526119232177734
Epoch: 25, Steps: 64 | Train Loss: 0.0688159 Vali Loss: 0.1838031 Test Loss: 0.2653147
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 26 cost time: 0.9594120979309082
Epoch: 26, Steps: 64 | Train Loss: 0.0688729 Vali Loss: 0.1829698 Test Loss: 0.2646824
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 27 cost time: 0.9564063549041748
Epoch: 27, Steps: 64 | Train Loss: 0.0683390 Vali Loss: 0.1844193 Test Loss: 0.2649795
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 28 cost time: 0.9543757438659668
Epoch: 28, Steps: 64 | Train Loss: 0.0685605 Vali Loss: 0.1852384 Test Loss: 0.2648454
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 29 cost time: 1.0053951740264893
Epoch: 29, Steps: 64 | Train Loss: 0.0682815 Vali Loss: 0.1826517 Test Loss: 0.2636906
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 30 cost time: 0.9483437538146973
Epoch: 30, Steps: 64 | Train Loss: 0.0678985 Vali Loss: 0.1822560 Test Loss: 0.2640291
Validation loss decreased (0.182343 --> 0.182256).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 31 cost time: 0.9638385772705078
Epoch: 31, Steps: 64 | Train Loss: 0.0679960 Vali Loss: 0.1836452 Test Loss: 0.2644112
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 32 cost time: 0.949716329574585
Epoch: 32, Steps: 64 | Train Loss: 0.0682349 Vali Loss: 0.1820549 Test Loss: 0.2647825
Validation loss decreased (0.182256 --> 0.182055).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 33 cost time: 0.9537255764007568
Epoch: 33, Steps: 64 | Train Loss: 0.0681660 Vali Loss: 0.1842451 Test Loss: 0.2639800
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 34 cost time: 0.9559996128082275
Epoch: 34, Steps: 64 | Train Loss: 0.0679882 Vali Loss: 0.1822749 Test Loss: 0.2638271
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 35 cost time: 0.967979907989502
Epoch: 35, Steps: 64 | Train Loss: 0.0679636 Vali Loss: 0.1852752 Test Loss: 0.2646053
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 36 cost time: 0.9576141834259033
Epoch: 36, Steps: 64 | Train Loss: 0.0680833 Vali Loss: 0.1823883 Test Loss: 0.2637007
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 37 cost time: 0.9564087390899658
Epoch: 37, Steps: 64 | Train Loss: 0.0677548 Vali Loss: 0.1820275 Test Loss: 0.2654382
Validation loss decreased (0.182055 --> 0.182028).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 38 cost time: 0.9633753299713135
Epoch: 38, Steps: 64 | Train Loss: 0.0681927 Vali Loss: 0.1817870 Test Loss: 0.2637517
Validation loss decreased (0.182028 --> 0.181787).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 39 cost time: 0.9463179111480713
Epoch: 39, Steps: 64 | Train Loss: 0.0676483 Vali Loss: 0.1838660 Test Loss: 0.2643858
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 40 cost time: 0.9524173736572266
Epoch: 40, Steps: 64 | Train Loss: 0.0676515 Vali Loss: 0.1813615 Test Loss: 0.2633357
Validation loss decreased (0.181787 --> 0.181362).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 41 cost time: 0.9589331150054932
Epoch: 41, Steps: 64 | Train Loss: 0.0678005 Vali Loss: 0.1839122 Test Loss: 0.2640283
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 42 cost time: 0.9564146995544434
Epoch: 42, Steps: 64 | Train Loss: 0.0679714 Vali Loss: 0.1839778 Test Loss: 0.2634852
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 43 cost time: 0.9562423229217529
Epoch: 43, Steps: 64 | Train Loss: 0.0677643 Vali Loss: 0.1844417 Test Loss: 0.2644182
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 44 cost time: 0.9559998512268066
Epoch: 44, Steps: 64 | Train Loss: 0.0673682 Vali Loss: 0.1824261 Test Loss: 0.2634752
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 45 cost time: 0.927403450012207
Epoch: 45, Steps: 64 | Train Loss: 0.0673948 Vali Loss: 0.1844551 Test Loss: 0.2645489
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 46 cost time: 0.9466221332550049
Epoch: 46, Steps: 64 | Train Loss: 0.0672893 Vali Loss: 0.1831724 Test Loss: 0.2639249
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 47 cost time: 0.9508724212646484
Epoch: 47, Steps: 64 | Train Loss: 0.0671693 Vali Loss: 0.1822661 Test Loss: 0.2635385
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 48 cost time: 0.9454238414764404
Epoch: 48, Steps: 64 | Train Loss: 0.0676061 Vali Loss: 0.1822473 Test Loss: 0.2637368
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 49 cost time: 0.9553592205047607
Epoch: 49, Steps: 64 | Train Loss: 0.0672912 Vali Loss: 0.1827342 Test Loss: 0.2636336
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 50 cost time: 0.9550747871398926
Epoch: 50, Steps: 64 | Train Loss: 0.0674507 Vali Loss: 0.1825132 Test Loss: 0.2634715
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 51 cost time: 0.9521801471710205
Epoch: 51, Steps: 64 | Train Loss: 0.0676881 Vali Loss: 0.1844139 Test Loss: 0.2639434
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 52 cost time: 0.9503202438354492
Epoch: 52, Steps: 64 | Train Loss: 0.0675687 Vali Loss: 0.1830803 Test Loss: 0.2626961
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 53 cost time: 0.9569168090820312
Epoch: 53, Steps: 64 | Train Loss: 0.0673423 Vali Loss: 0.1809572 Test Loss: 0.2638739
Validation loss decreased (0.181362 --> 0.180957).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 54 cost time: 0.9459998607635498
Epoch: 54, Steps: 64 | Train Loss: 0.0679613 Vali Loss: 0.1838739 Test Loss: 0.2637636
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 55 cost time: 0.9453840255737305
Epoch: 55, Steps: 64 | Train Loss: 0.0674833 Vali Loss: 0.1807836 Test Loss: 0.2629093
Validation loss decreased (0.180957 --> 0.180784).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 56 cost time: 0.9486134052276611
Epoch: 56, Steps: 64 | Train Loss: 0.0675397 Vali Loss: 0.1823863 Test Loss: 0.2633539
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 57 cost time: 0.9436397552490234
Epoch: 57, Steps: 64 | Train Loss: 0.0679291 Vali Loss: 0.1856617 Test Loss: 0.2641237
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 58 cost time: 0.9654054641723633
Epoch: 58, Steps: 64 | Train Loss: 0.0675339 Vali Loss: 0.1827338 Test Loss: 0.2634630
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 59 cost time: 0.9562442302703857
Epoch: 59, Steps: 64 | Train Loss: 0.0674022 Vali Loss: 0.1842026 Test Loss: 0.2640186
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 60 cost time: 0.9523975849151611
Epoch: 60, Steps: 64 | Train Loss: 0.0673490 Vali Loss: 0.1828075 Test Loss: 0.2642867
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2629092037677765, mae:0.33032119274139404, rse:0.23532912135124207
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.05860710144042969 GB
Epoch: 1 cost time: 2.2750298976898193
Epoch: 1, Steps: 64 | Train Loss: 0.9444518 Vali Loss: 2.7805002 Test Loss: 4.8526101
Validation loss decreased (inf --> 2.780500).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 2 cost time: 0.8358402252197266
Epoch: 2, Steps: 64 | Train Loss: 0.6405291 Vali Loss: 1.1764221 Test Loss: 1.8888311
Validation loss decreased (2.780500 --> 1.176422).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 3 cost time: 0.8420004844665527
Epoch: 3, Steps: 64 | Train Loss: 0.3321332 Vali Loss: 0.6889823 Test Loss: 1.0157679
Validation loss decreased (1.176422 --> 0.688982).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 4 cost time: 0.8436081409454346
Epoch: 4, Steps: 64 | Train Loss: 0.2091290 Vali Loss: 0.4624106 Test Loss: 0.6239924
Validation loss decreased (0.688982 --> 0.462411).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 5 cost time: 0.8344013690948486
Epoch: 5, Steps: 64 | Train Loss: 0.1514237 Vali Loss: 0.3523110 Test Loss: 0.4443031
Validation loss decreased (0.462411 --> 0.352311).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 6 cost time: 0.835350513458252
Epoch: 6, Steps: 64 | Train Loss: 0.1258458 Vali Loss: 0.3007800 Test Loss: 0.3621563
Validation loss decreased (0.352311 --> 0.300780).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 7 cost time: 0.8333148956298828
Epoch: 7, Steps: 64 | Train Loss: 0.1136544 Vali Loss: 0.2775385 Test Loss: 0.3263963
Validation loss decreased (0.300780 --> 0.277539).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 8 cost time: 0.8310003280639648
Epoch: 8, Steps: 64 | Train Loss: 0.1073194 Vali Loss: 0.2604688 Test Loss: 0.3061398
Validation loss decreased (0.277539 --> 0.260469).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 9 cost time: 0.8209428787231445
Epoch: 9, Steps: 64 | Train Loss: 0.1021319 Vali Loss: 0.2500181 Test Loss: 0.2975893
Validation loss decreased (0.260469 --> 0.250018).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 10 cost time: 0.8353581428527832
Epoch: 10, Steps: 64 | Train Loss: 0.1000790 Vali Loss: 0.2425748 Test Loss: 0.2921938
Validation loss decreased (0.250018 --> 0.242575).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 11 cost time: 0.8397393226623535
Epoch: 11, Steps: 64 | Train Loss: 0.0972139 Vali Loss: 0.2388101 Test Loss: 0.2874430
Validation loss decreased (0.242575 --> 0.238810).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 12 cost time: 0.840195894241333
Epoch: 12, Steps: 64 | Train Loss: 0.0957519 Vali Loss: 0.2375351 Test Loss: 0.2869349
Validation loss decreased (0.238810 --> 0.237535).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 13 cost time: 0.8460006713867188
Epoch: 13, Steps: 64 | Train Loss: 0.0953212 Vali Loss: 0.2317163 Test Loss: 0.2835776
Validation loss decreased (0.237535 --> 0.231716).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 14 cost time: 0.8406212329864502
Epoch: 14, Steps: 64 | Train Loss: 0.0937293 Vali Loss: 0.2302414 Test Loss: 0.2828405
Validation loss decreased (0.231716 --> 0.230241).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 15 cost time: 0.8304028511047363
Epoch: 15, Steps: 64 | Train Loss: 0.0933478 Vali Loss: 0.2306062 Test Loss: 0.2834050
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 16 cost time: 0.8403754234313965
Epoch: 16, Steps: 64 | Train Loss: 0.0928027 Vali Loss: 0.2307187 Test Loss: 0.2816418
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 17 cost time: 0.8313446044921875
Epoch: 17, Steps: 64 | Train Loss: 0.0914951 Vali Loss: 0.2269860 Test Loss: 0.2803315
Validation loss decreased (0.230241 --> 0.226986).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 18 cost time: 0.8312928676605225
Epoch: 18, Steps: 64 | Train Loss: 0.0909928 Vali Loss: 0.2262737 Test Loss: 0.2794556
Validation loss decreased (0.226986 --> 0.226274).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 19 cost time: 0.8316006660461426
Epoch: 19, Steps: 64 | Train Loss: 0.0896698 Vali Loss: 0.2246625 Test Loss: 0.2797748
Validation loss decreased (0.226274 --> 0.224662).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 20 cost time: 0.8523156642913818
Epoch: 20, Steps: 64 | Train Loss: 0.0900049 Vali Loss: 0.2227451 Test Loss: 0.2809015
Validation loss decreased (0.224662 --> 0.222745).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 21 cost time: 0.916454553604126
Epoch: 21, Steps: 64 | Train Loss: 0.0895514 Vali Loss: 0.2231525 Test Loss: 0.2792995
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 22 cost time: 0.9124240875244141
Epoch: 22, Steps: 64 | Train Loss: 0.0888059 Vali Loss: 0.2221970 Test Loss: 0.2788612
Validation loss decreased (0.222745 --> 0.222197).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 23 cost time: 0.8650038242340088
Epoch: 23, Steps: 64 | Train Loss: 0.0884762 Vali Loss: 0.2214254 Test Loss: 0.2787021
Validation loss decreased (0.222197 --> 0.221425).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 24 cost time: 0.829087495803833
Epoch: 24, Steps: 64 | Train Loss: 0.0883720 Vali Loss: 0.2210088 Test Loss: 0.2794883
Validation loss decreased (0.221425 --> 0.221009).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 25 cost time: 0.8256208896636963
Epoch: 25, Steps: 64 | Train Loss: 0.0877992 Vali Loss: 0.2197288 Test Loss: 0.2790818
Validation loss decreased (0.221009 --> 0.219729).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 26 cost time: 0.8244154453277588
Epoch: 26, Steps: 64 | Train Loss: 0.0882002 Vali Loss: 0.2211257 Test Loss: 0.2781710
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 27 cost time: 0.8284568786621094
Epoch: 27, Steps: 64 | Train Loss: 0.0877469 Vali Loss: 0.2206159 Test Loss: 0.2784991
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 28 cost time: 0.8158261775970459
Epoch: 28, Steps: 64 | Train Loss: 0.0874940 Vali Loss: 0.2174567 Test Loss: 0.2776062
Validation loss decreased (0.219729 --> 0.217457).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 29 cost time: 0.8309998512268066
Epoch: 29, Steps: 64 | Train Loss: 0.0867371 Vali Loss: 0.2175831 Test Loss: 0.2788979
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 30 cost time: 0.8326191902160645
Epoch: 30, Steps: 64 | Train Loss: 0.0869801 Vali Loss: 0.2181871 Test Loss: 0.2789067
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 31 cost time: 0.8284540176391602
Epoch: 31, Steps: 64 | Train Loss: 0.0873349 Vali Loss: 0.2193381 Test Loss: 0.2772289
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 32 cost time: 0.8299875259399414
Epoch: 32, Steps: 64 | Train Loss: 0.0864527 Vali Loss: 0.2176141 Test Loss: 0.2784857
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 33 cost time: 0.8247432708740234
Epoch: 33, Steps: 64 | Train Loss: 0.0869095 Vali Loss: 0.2177079 Test Loss: 0.2780096
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 34 cost time: 0.8220000267028809
Epoch: 34, Steps: 64 | Train Loss: 0.0864243 Vali Loss: 0.2175533 Test Loss: 0.2788307
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 35 cost time: 0.807612419128418
Epoch: 35, Steps: 64 | Train Loss: 0.0865955 Vali Loss: 0.2164496 Test Loss: 0.2770813
Validation loss decreased (0.217457 --> 0.216450).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 36 cost time: 0.8183810710906982
Epoch: 36, Steps: 64 | Train Loss: 0.0862980 Vali Loss: 0.2163426 Test Loss: 0.2792649
Validation loss decreased (0.216450 --> 0.216343).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 37 cost time: 0.8210148811340332
Epoch: 37, Steps: 64 | Train Loss: 0.0862741 Vali Loss: 0.2172160 Test Loss: 0.2777393
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 38 cost time: 0.8339998722076416
Epoch: 38, Steps: 64 | Train Loss: 0.0867533 Vali Loss: 0.2170647 Test Loss: 0.2778051
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 39 cost time: 0.9100019931793213
Epoch: 39, Steps: 64 | Train Loss: 0.0859467 Vali Loss: 0.2179926 Test Loss: 0.2786265
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 40 cost time: 0.9096267223358154
Epoch: 40, Steps: 64 | Train Loss: 0.0861619 Vali Loss: 0.2168638 Test Loss: 0.2783985
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 41 cost time: 0.8344242572784424
Epoch: 41, Steps: 64 | Train Loss: 0.0862466 Vali Loss: 0.2163977 Test Loss: 0.2787176
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 42 cost time: 0.8387107849121094
Epoch: 42, Steps: 64 | Train Loss: 0.0858786 Vali Loss: 0.2184528 Test Loss: 0.2780906
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 43 cost time: 0.8233692646026611
Epoch: 43, Steps: 64 | Train Loss: 0.0865834 Vali Loss: 0.2163745 Test Loss: 0.2776804
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 44 cost time: 0.8159999847412109
Epoch: 44, Steps: 64 | Train Loss: 0.0858073 Vali Loss: 0.2171902 Test Loss: 0.2772942
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 45 cost time: 0.8186225891113281
Epoch: 45, Steps: 64 | Train Loss: 0.0861847 Vali Loss: 0.2131047 Test Loss: 0.2778243
Validation loss decreased (0.216343 --> 0.213105).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 46 cost time: 0.8336212635040283
Epoch: 46, Steps: 64 | Train Loss: 0.0865039 Vali Loss: 0.2192013 Test Loss: 0.2790729
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 47 cost time: 0.8293552398681641
Epoch: 47, Steps: 64 | Train Loss: 0.0853199 Vali Loss: 0.2151242 Test Loss: 0.2786297
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 48 cost time: 0.8347394466400146
Epoch: 48, Steps: 64 | Train Loss: 0.0859518 Vali Loss: 0.2161222 Test Loss: 0.2776712
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 49 cost time: 0.8350000381469727
Epoch: 49, Steps: 64 | Train Loss: 0.0859892 Vali Loss: 0.2160202 Test Loss: 0.2776304
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 50 cost time: 0.839622974395752
Epoch: 50, Steps: 64 | Train Loss: 0.0855144 Vali Loss: 0.2171669 Test Loss: 0.2776028
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 51 cost time: 0.827376127243042
Epoch: 51, Steps: 64 | Train Loss: 0.0863660 Vali Loss: 0.2171923 Test Loss: 0.2778623
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 52 cost time: 0.8194863796234131
Epoch: 52, Steps: 64 | Train Loss: 0.0859026 Vali Loss: 0.2174840 Test Loss: 0.2785970
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 53 cost time: 0.8320002555847168
Epoch: 53, Steps: 64 | Train Loss: 0.0858361 Vali Loss: 0.2144939 Test Loss: 0.2775788
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 54 cost time: 0.8169999122619629
Epoch: 54, Steps: 64 | Train Loss: 0.0855666 Vali Loss: 0.2184101 Test Loss: 0.2773187
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 55 cost time: 0.8274579048156738
Epoch: 55, Steps: 64 | Train Loss: 0.0854986 Vali Loss: 0.2151950 Test Loss: 0.2768916
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 56 cost time: 0.8281149864196777
Epoch: 56, Steps: 64 | Train Loss: 0.0857931 Vali Loss: 0.2158785 Test Loss: 0.2781578
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 57 cost time: 0.8335132598876953
Epoch: 57, Steps: 64 | Train Loss: 0.0852304 Vali Loss: 0.2170132 Test Loss: 0.2776365
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 58 cost time: 0.9040005207061768
Epoch: 58, Steps: 64 | Train Loss: 0.0855116 Vali Loss: 0.2157587 Test Loss: 0.2782752
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 59 cost time: 0.8339996337890625
Epoch: 59, Steps: 64 | Train Loss: 0.0850444 Vali Loss: 0.2155769 Test Loss: 0.2783301
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 60 cost time: 0.8302226066589355
Epoch: 60, Steps: 64 | Train Loss: 0.0857636 Vali Loss: 0.2181783 Test Loss: 0.2775688
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2778242528438568, mae:0.33242732286453247, rse:0.24191224575042725
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.06300163269042969 GB
Epoch: 1 cost time: 2.3059446811676025
Epoch: 1, Steps: 64 | Train Loss: 0.9157211 Vali Loss: 2.7478788 Test Loss: 4.8870459
Validation loss decreased (inf --> 2.747879).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 2 cost time: 0.9126121997833252
Epoch: 2, Steps: 64 | Train Loss: 0.4501402 Vali Loss: 0.3195625 Test Loss: 0.3321117
Validation loss decreased (2.747879 --> 0.319563).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 3 cost time: 0.9283959865570068
Epoch: 3, Steps: 64 | Train Loss: 0.1085148 Vali Loss: 0.2579753 Test Loss: 0.2842803
Validation loss decreased (0.319563 --> 0.257975).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 4 cost time: 0.9377107620239258
Epoch: 4, Steps: 64 | Train Loss: 0.0942816 Vali Loss: 0.2374828 Test Loss: 0.2764378
Validation loss decreased (0.257975 --> 0.237483).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 5 cost time: 0.9174990653991699
Epoch: 5, Steps: 64 | Train Loss: 0.0890539 Vali Loss: 0.2302057 Test Loss: 0.2789342
Validation loss decreased (0.237483 --> 0.230206).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 6 cost time: 0.9136292934417725
Epoch: 6, Steps: 64 | Train Loss: 0.0850935 Vali Loss: 0.2236241 Test Loss: 0.2762727
Validation loss decreased (0.230206 --> 0.223624).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 7 cost time: 0.9126286506652832
Epoch: 7, Steps: 64 | Train Loss: 0.0835194 Vali Loss: 0.2233728 Test Loss: 0.2753682
Validation loss decreased (0.223624 --> 0.223373).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 8 cost time: 0.9128739833831787
Epoch: 8, Steps: 64 | Train Loss: 0.0816282 Vali Loss: 0.2161977 Test Loss: 0.2725640
Validation loss decreased (0.223373 --> 0.216198).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 9 cost time: 0.9194045066833496
Epoch: 9, Steps: 64 | Train Loss: 0.0804312 Vali Loss: 0.2144504 Test Loss: 0.2761164
Validation loss decreased (0.216198 --> 0.214450).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 10 cost time: 0.9339802265167236
Epoch: 10, Steps: 64 | Train Loss: 0.0792897 Vali Loss: 0.2122986 Test Loss: 0.2748951
Validation loss decreased (0.214450 --> 0.212299).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 11 cost time: 0.93937087059021
Epoch: 11, Steps: 64 | Train Loss: 0.0778079 Vali Loss: 0.2110925 Test Loss: 0.2714988
Validation loss decreased (0.212299 --> 0.211093).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 12 cost time: 0.9273791313171387
Epoch: 12, Steps: 64 | Train Loss: 0.0769705 Vali Loss: 0.2064279 Test Loss: 0.2730036
Validation loss decreased (0.211093 --> 0.206428).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 13 cost time: 0.9267933368682861
Epoch: 13, Steps: 64 | Train Loss: 0.0756428 Vali Loss: 0.2025217 Test Loss: 0.2715788
Validation loss decreased (0.206428 --> 0.202522).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 14 cost time: 0.9164347648620605
Epoch: 14, Steps: 64 | Train Loss: 0.0752681 Vali Loss: 0.2028410 Test Loss: 0.2729163
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 15 cost time: 0.918001651763916
Epoch: 15, Steps: 64 | Train Loss: 0.0745327 Vali Loss: 0.2009837 Test Loss: 0.2714099
Validation loss decreased (0.202522 --> 0.200984).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 16 cost time: 0.9166202545166016
Epoch: 16, Steps: 64 | Train Loss: 0.0739049 Vali Loss: 0.2000065 Test Loss: 0.2700938
Validation loss decreased (0.200984 --> 0.200006).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 17 cost time: 0.918391227722168
Epoch: 17, Steps: 64 | Train Loss: 0.0735693 Vali Loss: 0.1976926 Test Loss: 0.2710428
Validation loss decreased (0.200006 --> 0.197693).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 18 cost time: 0.9433224201202393
Epoch: 18, Steps: 64 | Train Loss: 0.0729285 Vali Loss: 0.1943526 Test Loss: 0.2706132
Validation loss decreased (0.197693 --> 0.194353).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 19 cost time: 0.932002067565918
Epoch: 19, Steps: 64 | Train Loss: 0.0724349 Vali Loss: 0.1935424 Test Loss: 0.2689542
Validation loss decreased (0.194353 --> 0.193542).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 20 cost time: 0.9273688793182373
Epoch: 20, Steps: 64 | Train Loss: 0.0719430 Vali Loss: 0.1918487 Test Loss: 0.2698856
Validation loss decreased (0.193542 --> 0.191849).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 21 cost time: 0.9463648796081543
Epoch: 21, Steps: 64 | Train Loss: 0.0719135 Vali Loss: 0.1924033 Test Loss: 0.2684610
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 22 cost time: 0.9163649082183838
Epoch: 22, Steps: 64 | Train Loss: 0.0712974 Vali Loss: 0.1919177 Test Loss: 0.2695196
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 23 cost time: 0.9190025329589844
Epoch: 23, Steps: 64 | Train Loss: 0.0708107 Vali Loss: 0.1911062 Test Loss: 0.2687217
Validation loss decreased (0.191849 --> 0.191106).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 24 cost time: 0.9166140556335449
Epoch: 24, Steps: 64 | Train Loss: 0.0707268 Vali Loss: 0.1893458 Test Loss: 0.2691807
Validation loss decreased (0.191106 --> 0.189346).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 25 cost time: 0.8981966972351074
Epoch: 25, Steps: 64 | Train Loss: 0.0707000 Vali Loss: 0.1901976 Test Loss: 0.2691904
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 26 cost time: 0.9231629371643066
Epoch: 26, Steps: 64 | Train Loss: 0.0703512 Vali Loss: 0.1896596 Test Loss: 0.2697452
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 27 cost time: 0.9224212169647217
Epoch: 27, Steps: 64 | Train Loss: 0.0701531 Vali Loss: 0.1905378 Test Loss: 0.2679427
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 28 cost time: 0.9163680076599121
Epoch: 28, Steps: 64 | Train Loss: 0.0701373 Vali Loss: 0.1891092 Test Loss: 0.2682084
Validation loss decreased (0.189346 --> 0.189109).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 29 cost time: 0.9303624629974365
Epoch: 29, Steps: 64 | Train Loss: 0.0702376 Vali Loss: 0.1854771 Test Loss: 0.2673234
Validation loss decreased (0.189109 --> 0.185477).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 30 cost time: 0.91977858543396
Epoch: 30, Steps: 64 | Train Loss: 0.0697701 Vali Loss: 0.1863038 Test Loss: 0.2679342
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 31 cost time: 0.9186179637908936
Epoch: 31, Steps: 64 | Train Loss: 0.0696409 Vali Loss: 0.1869984 Test Loss: 0.2674846
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 32 cost time: 0.9110071659088135
Epoch: 32, Steps: 64 | Train Loss: 0.0700122 Vali Loss: 0.1856497 Test Loss: 0.2676042
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 33 cost time: 0.917616605758667
Epoch: 33, Steps: 64 | Train Loss: 0.0700653 Vali Loss: 0.1871313 Test Loss: 0.2677276
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 34 cost time: 0.9213402271270752
Epoch: 34, Steps: 64 | Train Loss: 0.0699672 Vali Loss: 0.1874297 Test Loss: 0.2682303
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 35 cost time: 0.9393689632415771
Epoch: 35, Steps: 64 | Train Loss: 0.0693625 Vali Loss: 0.1874758 Test Loss: 0.2666907
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 36 cost time: 0.9283373355865479
Epoch: 36, Steps: 64 | Train Loss: 0.0695897 Vali Loss: 0.1840075 Test Loss: 0.2669332
Validation loss decreased (0.185477 --> 0.184007).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 37 cost time: 0.9243857860565186
Epoch: 37, Steps: 64 | Train Loss: 0.0694735 Vali Loss: 0.1861730 Test Loss: 0.2674797
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 38 cost time: 0.9328219890594482
Epoch: 38, Steps: 64 | Train Loss: 0.0696040 Vali Loss: 0.1885991 Test Loss: 0.2669684
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 39 cost time: 0.9173755645751953
Epoch: 39, Steps: 64 | Train Loss: 0.0698438 Vali Loss: 0.1864375 Test Loss: 0.2670515
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 40 cost time: 0.9239997863769531
Epoch: 40, Steps: 64 | Train Loss: 0.0694529 Vali Loss: 0.1882214 Test Loss: 0.2669906
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 41 cost time: 0.9196102619171143
Epoch: 41, Steps: 64 | Train Loss: 0.0694359 Vali Loss: 0.1864773 Test Loss: 0.2672958
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 42 cost time: 0.9187965393066406
Epoch: 42, Steps: 64 | Train Loss: 0.0693651 Vali Loss: 0.1849247 Test Loss: 0.2670093
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 43 cost time: 0.930952787399292
Epoch: 43, Steps: 64 | Train Loss: 0.0689948 Vali Loss: 0.1847265 Test Loss: 0.2668320
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 44 cost time: 0.9293355941772461
Epoch: 44, Steps: 64 | Train Loss: 0.0691882 Vali Loss: 0.1863834 Test Loss: 0.2675556
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 45 cost time: 0.9235351085662842
Epoch: 45, Steps: 64 | Train Loss: 0.0690421 Vali Loss: 0.1842495 Test Loss: 0.2672419
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 46 cost time: 0.9228062629699707
Epoch: 46, Steps: 64 | Train Loss: 0.0691257 Vali Loss: 0.1835962 Test Loss: 0.2677028
Validation loss decreased (0.184007 --> 0.183596).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 47 cost time: 0.9180457592010498
Epoch: 47, Steps: 64 | Train Loss: 0.0693002 Vali Loss: 0.1870508 Test Loss: 0.2669345
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 48 cost time: 0.9266214370727539
Epoch: 48, Steps: 64 | Train Loss: 0.0692427 Vali Loss: 0.1848540 Test Loss: 0.2674043
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 49 cost time: 0.9116096496582031
Epoch: 49, Steps: 64 | Train Loss: 0.0690830 Vali Loss: 0.1846021 Test Loss: 0.2677024
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 50 cost time: 0.9193885326385498
Epoch: 50, Steps: 64 | Train Loss: 0.0692148 Vali Loss: 0.1850523 Test Loss: 0.2673710
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 51 cost time: 0.9255146980285645
Epoch: 51, Steps: 64 | Train Loss: 0.0692746 Vali Loss: 0.1844845 Test Loss: 0.2675462
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 52 cost time: 0.9127533435821533
Epoch: 52, Steps: 64 | Train Loss: 0.0689056 Vali Loss: 0.1866287 Test Loss: 0.2666976
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 53 cost time: 0.9324615001678467
Epoch: 53, Steps: 64 | Train Loss: 0.0694526 Vali Loss: 0.1857325 Test Loss: 0.2671288
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 54 cost time: 0.9267544746398926
Epoch: 54, Steps: 64 | Train Loss: 0.0692291 Vali Loss: 0.1857736 Test Loss: 0.2669968
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 55 cost time: 0.9306714534759521
Epoch: 55, Steps: 64 | Train Loss: 0.0690307 Vali Loss: 0.1850873 Test Loss: 0.2670101
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 56 cost time: 0.9256420135498047
Epoch: 56, Steps: 64 | Train Loss: 0.0688308 Vali Loss: 0.1833367 Test Loss: 0.2665487
Validation loss decreased (0.183596 --> 0.183337).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 57 cost time: 0.9156193733215332
Epoch: 57, Steps: 64 | Train Loss: 0.0690548 Vali Loss: 0.1865293 Test Loss: 0.2674270
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 58 cost time: 0.9133632183074951
Epoch: 58, Steps: 64 | Train Loss: 0.0690858 Vali Loss: 0.1822457 Test Loss: 0.2675170
Validation loss decreased (0.183337 --> 0.182246).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 59 cost time: 0.9233651161193848
Epoch: 59, Steps: 64 | Train Loss: 0.0694069 Vali Loss: 0.1850173 Test Loss: 0.2671261
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 60 cost time: 0.9293403625488281
Epoch: 60, Steps: 64 | Train Loss: 0.0694283 Vali Loss: 0.1859184 Test Loss: 0.2667094
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.26751694083213806, mae:0.3352656960487366, rse:0.23738235235214233
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.0663003921508789 GB
Epoch: 1 cost time: 2.2985427379608154
Epoch: 1, Steps: 64 | Train Loss: 0.8403365 Vali Loss: 2.5474172 Test Loss: 4.5183687
Validation loss decreased (inf --> 2.547417).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 2 cost time: 0.8893136978149414
Epoch: 2, Steps: 64 | Train Loss: 0.3288296 Vali Loss: 0.3919758 Test Loss: 0.5037608
Validation loss decreased (2.547417 --> 0.391976).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 3 cost time: 0.9147210121154785
Epoch: 3, Steps: 64 | Train Loss: 0.1023521 Vali Loss: 0.2372606 Test Loss: 0.2756569
Validation loss decreased (0.391976 --> 0.237261).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 4 cost time: 0.9065022468566895
Epoch: 4, Steps: 64 | Train Loss: 0.0896170 Vali Loss: 0.2299210 Test Loss: 0.2810696
Validation loss decreased (0.237261 --> 0.229921).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 5 cost time: 0.9183576107025146
Epoch: 5, Steps: 64 | Train Loss: 0.0855774 Vali Loss: 0.2287845 Test Loss: 0.2769061
Validation loss decreased (0.229921 --> 0.228785).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 6 cost time: 0.8786027431488037
Epoch: 6, Steps: 64 | Train Loss: 0.0830409 Vali Loss: 0.2169718 Test Loss: 0.2756540
Validation loss decreased (0.228785 --> 0.216972).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 7 cost time: 0.9013712406158447
Epoch: 7, Steps: 64 | Train Loss: 0.0810690 Vali Loss: 0.2130116 Test Loss: 0.2791671
Validation loss decreased (0.216972 --> 0.213012).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 8 cost time: 0.8954222202301025
Epoch: 8, Steps: 64 | Train Loss: 0.0787028 Vali Loss: 0.2127296 Test Loss: 0.2754429
Validation loss decreased (0.213012 --> 0.212730).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 9 cost time: 0.8974041938781738
Epoch: 9, Steps: 64 | Train Loss: 0.0776959 Vali Loss: 0.2109746 Test Loss: 0.2752863
Validation loss decreased (0.212730 --> 0.210975).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 10 cost time: 0.9068138599395752
Epoch: 10, Steps: 64 | Train Loss: 0.0765671 Vali Loss: 0.2046943 Test Loss: 0.2753227
Validation loss decreased (0.210975 --> 0.204694).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 11 cost time: 0.9017729759216309
Epoch: 11, Steps: 64 | Train Loss: 0.0757639 Vali Loss: 0.2018794 Test Loss: 0.2755325
Validation loss decreased (0.204694 --> 0.201879).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 12 cost time: 0.9129996299743652
Epoch: 12, Steps: 64 | Train Loss: 0.0747446 Vali Loss: 0.2005835 Test Loss: 0.2740545
Validation loss decreased (0.201879 --> 0.200584).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 13 cost time: 0.9044079780578613
Epoch: 13, Steps: 64 | Train Loss: 0.0736292 Vali Loss: 0.1987238 Test Loss: 0.2734491
Validation loss decreased (0.200584 --> 0.198724).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 14 cost time: 0.9023401737213135
Epoch: 14, Steps: 64 | Train Loss: 0.0728429 Vali Loss: 0.1938364 Test Loss: 0.2727371
Validation loss decreased (0.198724 --> 0.193836).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 15 cost time: 0.9034688472747803
Epoch: 15, Steps: 64 | Train Loss: 0.0725688 Vali Loss: 0.1934639 Test Loss: 0.2716134
Validation loss decreased (0.193836 --> 0.193464).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 16 cost time: 0.9104509353637695
Epoch: 16, Steps: 64 | Train Loss: 0.0719226 Vali Loss: 0.1898766 Test Loss: 0.2729515
Validation loss decreased (0.193464 --> 0.189877).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 17 cost time: 0.8973169326782227
Epoch: 17, Steps: 64 | Train Loss: 0.0710535 Vali Loss: 0.1900348 Test Loss: 0.2715999
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 18 cost time: 0.9103686809539795
Epoch: 18, Steps: 64 | Train Loss: 0.0707904 Vali Loss: 0.1880339 Test Loss: 0.2705864
Validation loss decreased (0.189877 --> 0.188034).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 19 cost time: 0.9260010719299316
Epoch: 19, Steps: 64 | Train Loss: 0.0707200 Vali Loss: 0.1873565 Test Loss: 0.2704820
Validation loss decreased (0.188034 --> 0.187357).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 20 cost time: 0.9057974815368652
Epoch: 20, Steps: 64 | Train Loss: 0.0698390 Vali Loss: 0.1829841 Test Loss: 0.2713125
Validation loss decreased (0.187357 --> 0.182984).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 21 cost time: 0.9056010246276855
Epoch: 21, Steps: 64 | Train Loss: 0.0695139 Vali Loss: 0.1849860 Test Loss: 0.2703400
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 22 cost time: 0.8993897438049316
Epoch: 22, Steps: 64 | Train Loss: 0.0691994 Vali Loss: 0.1828481 Test Loss: 0.2685198
Validation loss decreased (0.182984 --> 0.182848).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 23 cost time: 0.9053070545196533
Epoch: 23, Steps: 64 | Train Loss: 0.0692463 Vali Loss: 0.1823466 Test Loss: 0.2692471
Validation loss decreased (0.182848 --> 0.182347).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 24 cost time: 0.899317741394043
Epoch: 24, Steps: 64 | Train Loss: 0.0689388 Vali Loss: 0.1825926 Test Loss: 0.2695352
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 25 cost time: 0.906531572341919
Epoch: 25, Steps: 64 | Train Loss: 0.0686657 Vali Loss: 0.1819313 Test Loss: 0.2683059
Validation loss decreased (0.182347 --> 0.181931).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 26 cost time: 0.9171669483184814
Epoch: 26, Steps: 64 | Train Loss: 0.0687623 Vali Loss: 0.1811186 Test Loss: 0.2681755
Validation loss decreased (0.181931 --> 0.181119).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 27 cost time: 0.9060003757476807
Epoch: 27, Steps: 64 | Train Loss: 0.0688032 Vali Loss: 0.1842049 Test Loss: 0.2674652
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 28 cost time: 0.9058060646057129
Epoch: 28, Steps: 64 | Train Loss: 0.0686233 Vali Loss: 0.1809442 Test Loss: 0.2671183
Validation loss decreased (0.181119 --> 0.180944).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 29 cost time: 0.9006097316741943
Epoch: 29, Steps: 64 | Train Loss: 0.0679400 Vali Loss: 0.1813159 Test Loss: 0.2670407
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 30 cost time: 0.88779616355896
Epoch: 30, Steps: 64 | Train Loss: 0.0684286 Vali Loss: 0.1808352 Test Loss: 0.2680479
Validation loss decreased (0.180944 --> 0.180835).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 31 cost time: 0.8993568420410156
Epoch: 31, Steps: 64 | Train Loss: 0.0678364 Vali Loss: 0.1776904 Test Loss: 0.2672641
Validation loss decreased (0.180835 --> 0.177690).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 32 cost time: 0.904381275177002
Epoch: 32, Steps: 64 | Train Loss: 0.0678002 Vali Loss: 0.1794583 Test Loss: 0.2668996
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 33 cost time: 0.8998098373413086
Epoch: 33, Steps: 64 | Train Loss: 0.0675830 Vali Loss: 0.1802823 Test Loss: 0.2669889
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 34 cost time: 0.9009993076324463
Epoch: 34, Steps: 64 | Train Loss: 0.0676445 Vali Loss: 0.1806966 Test Loss: 0.2674448
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 35 cost time: 0.9090011119842529
Epoch: 35, Steps: 64 | Train Loss: 0.0677269 Vali Loss: 0.1805463 Test Loss: 0.2669746
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 36 cost time: 0.9146084785461426
Epoch: 36, Steps: 64 | Train Loss: 0.0676301 Vali Loss: 0.1776504 Test Loss: 0.2664135
Validation loss decreased (0.177690 --> 0.177650).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 37 cost time: 0.9124438762664795
Epoch: 37, Steps: 64 | Train Loss: 0.0679173 Vali Loss: 0.1807730 Test Loss: 0.2671461
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 38 cost time: 0.9073286056518555
Epoch: 38, Steps: 64 | Train Loss: 0.0673099 Vali Loss: 0.1771888 Test Loss: 0.2662420
Validation loss decreased (0.177650 --> 0.177189).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 39 cost time: 0.9047327041625977
Epoch: 39, Steps: 64 | Train Loss: 0.0678411 Vali Loss: 0.1779887 Test Loss: 0.2668735
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 40 cost time: 0.907332181930542
Epoch: 40, Steps: 64 | Train Loss: 0.0673811 Vali Loss: 0.1784168 Test Loss: 0.2667430
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 41 cost time: 0.9008784294128418
Epoch: 41, Steps: 64 | Train Loss: 0.0679585 Vali Loss: 0.1803182 Test Loss: 0.2666343
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 42 cost time: 0.9000012874603271
Epoch: 42, Steps: 64 | Train Loss: 0.0676264 Vali Loss: 0.1781006 Test Loss: 0.2662669
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 43 cost time: 0.9185965061187744
Epoch: 43, Steps: 64 | Train Loss: 0.0672034 Vali Loss: 0.1756733 Test Loss: 0.2661732
Validation loss decreased (0.177189 --> 0.175673).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 44 cost time: 0.9065952301025391
Epoch: 44, Steps: 64 | Train Loss: 0.0674006 Vali Loss: 0.1800284 Test Loss: 0.2660294
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 45 cost time: 0.9033870697021484
Epoch: 45, Steps: 64 | Train Loss: 0.0676135 Vali Loss: 0.1777842 Test Loss: 0.2662166
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 46 cost time: 0.905322790145874
Epoch: 46, Steps: 64 | Train Loss: 0.0671790 Vali Loss: 0.1776161 Test Loss: 0.2662855
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 47 cost time: 0.9143650531768799
Epoch: 47, Steps: 64 | Train Loss: 0.0678675 Vali Loss: 0.1782601 Test Loss: 0.2660067
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 48 cost time: 0.8949332237243652
Epoch: 48, Steps: 64 | Train Loss: 0.0676634 Vali Loss: 0.1760970 Test Loss: 0.2665568
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 49 cost time: 0.9050004482269287
Epoch: 49, Steps: 64 | Train Loss: 0.0673976 Vali Loss: 0.1784338 Test Loss: 0.2665107
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 50 cost time: 0.903001070022583
Epoch: 50, Steps: 64 | Train Loss: 0.0674033 Vali Loss: 0.1789209 Test Loss: 0.2656128
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 51 cost time: 0.9011256694793701
Epoch: 51, Steps: 64 | Train Loss: 0.0673858 Vali Loss: 0.1784972 Test Loss: 0.2663546
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 52 cost time: 0.9666333198547363
Epoch: 52, Steps: 64 | Train Loss: 0.0672187 Vali Loss: 0.1760248 Test Loss: 0.2671080
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 53 cost time: 0.9150140285491943
Epoch: 53, Steps: 64 | Train Loss: 0.0673185 Vali Loss: 0.1767883 Test Loss: 0.2666307
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 54 cost time: 0.9555463790893555
Epoch: 54, Steps: 64 | Train Loss: 0.0672900 Vali Loss: 0.1772064 Test Loss: 0.2667731
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 55 cost time: 0.9283969402313232
Epoch: 55, Steps: 64 | Train Loss: 0.0673224 Vali Loss: 0.1781999 Test Loss: 0.2665935
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 56 cost time: 0.9110009670257568
Epoch: 56, Steps: 64 | Train Loss: 0.0675830 Vali Loss: 0.1767578 Test Loss: 0.2670287
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 57 cost time: 0.8983345031738281
Epoch: 57, Steps: 64 | Train Loss: 0.0673336 Vali Loss: 0.1797259 Test Loss: 0.2664670
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 58 cost time: 0.8946304321289062
Epoch: 58, Steps: 64 | Train Loss: 0.0669298 Vali Loss: 0.1789135 Test Loss: 0.2658671
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 59 cost time: 0.8986155986785889
Epoch: 59, Steps: 64 | Train Loss: 0.0673660 Vali Loss: 0.1759321 Test Loss: 0.2662407
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 60 cost time: 0.9020001888275146
Epoch: 60, Steps: 64 | Train Loss: 0.0672595 Vali Loss: 0.1773776 Test Loss: 0.2661581
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.26617318391799927, mae:0.33131179213523865, rse:0.2367854118347168
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06551265716552734 GB
Epoch: 1 cost time: 2.2275259494781494
Epoch: 1, Steps: 64 | Train Loss: 0.8865614 Vali Loss: 2.5900893 Test Loss: 4.5782809
Validation loss decreased (inf --> 2.590089).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 2 cost time: 0.8910679817199707
Epoch: 2, Steps: 64 | Train Loss: 0.6546648 Vali Loss: 1.2952675 Test Loss: 2.1423945
Validation loss decreased (2.590089 --> 1.295267).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 3 cost time: 0.8605153560638428
Epoch: 3, Steps: 64 | Train Loss: 0.3554513 Vali Loss: 0.6897394 Test Loss: 1.0267584
Validation loss decreased (1.295267 --> 0.689739).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 4 cost time: 0.8579998016357422
Epoch: 4, Steps: 64 | Train Loss: 0.2104857 Vali Loss: 0.4388930 Test Loss: 0.6064695
Validation loss decreased (0.689739 --> 0.438893).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 5 cost time: 0.8626017570495605
Epoch: 5, Steps: 64 | Train Loss: 0.1493260 Vali Loss: 0.3356585 Test Loss: 0.4405651
Validation loss decreased (0.438893 --> 0.335659).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 6 cost time: 0.8469998836517334
Epoch: 6, Steps: 64 | Train Loss: 0.1235242 Vali Loss: 0.2844279 Test Loss: 0.3624329
Validation loss decreased (0.335659 --> 0.284428).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 7 cost time: 0.8540904521942139
Epoch: 7, Steps: 64 | Train Loss: 0.1119815 Vali Loss: 0.2568198 Test Loss: 0.3238672
Validation loss decreased (0.284428 --> 0.256820).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 8 cost time: 0.8469998836517334
Epoch: 8, Steps: 64 | Train Loss: 0.1055367 Vali Loss: 0.2484450 Test Loss: 0.3089363
Validation loss decreased (0.256820 --> 0.248445).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 9 cost time: 0.8516113758087158
Epoch: 9, Steps: 64 | Train Loss: 0.1021159 Vali Loss: 0.2407670 Test Loss: 0.2997219
Validation loss decreased (0.248445 --> 0.240767).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 10 cost time: 0.8500003814697266
Epoch: 10, Steps: 64 | Train Loss: 0.0987893 Vali Loss: 0.2339496 Test Loss: 0.2960316
Validation loss decreased (0.240767 --> 0.233950).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 11 cost time: 0.8566462993621826
Epoch: 11, Steps: 64 | Train Loss: 0.0962705 Vali Loss: 0.2302396 Test Loss: 0.2910997
Validation loss decreased (0.233950 --> 0.230240).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 12 cost time: 0.8558628559112549
Epoch: 12, Steps: 64 | Train Loss: 0.0933957 Vali Loss: 0.2283910 Test Loss: 0.2874336
Validation loss decreased (0.230240 --> 0.228391).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 13 cost time: 0.8584330081939697
Epoch: 13, Steps: 64 | Train Loss: 0.0926568 Vali Loss: 0.2221611 Test Loss: 0.2869411
Validation loss decreased (0.228391 --> 0.222161).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 14 cost time: 0.8581967353820801
Epoch: 14, Steps: 64 | Train Loss: 0.0916875 Vali Loss: 0.2198515 Test Loss: 0.2866623
Validation loss decreased (0.222161 --> 0.219852).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 15 cost time: 0.8636176586151123
Epoch: 15, Steps: 64 | Train Loss: 0.0903784 Vali Loss: 0.2142768 Test Loss: 0.2858384
Validation loss decreased (0.219852 --> 0.214277).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 16 cost time: 0.8523604869842529
Epoch: 16, Steps: 64 | Train Loss: 0.0894114 Vali Loss: 0.2140568 Test Loss: 0.2823745
Validation loss decreased (0.214277 --> 0.214057).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 17 cost time: 0.8581795692443848
Epoch: 17, Steps: 64 | Train Loss: 0.0890104 Vali Loss: 0.2119066 Test Loss: 0.2831664
Validation loss decreased (0.214057 --> 0.211907).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 18 cost time: 0.8524272441864014
Epoch: 18, Steps: 64 | Train Loss: 0.0883105 Vali Loss: 0.2081227 Test Loss: 0.2826916
Validation loss decreased (0.211907 --> 0.208123).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 19 cost time: 0.8696012496948242
Epoch: 19, Steps: 64 | Train Loss: 0.0872598 Vali Loss: 0.2101663 Test Loss: 0.2824038
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 20 cost time: 0.8590004444122314
Epoch: 20, Steps: 64 | Train Loss: 0.0867106 Vali Loss: 0.2065848 Test Loss: 0.2821330
Validation loss decreased (0.208123 --> 0.206585).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 21 cost time: 0.865605354309082
Epoch: 21, Steps: 64 | Train Loss: 0.0865243 Vali Loss: 0.2077577 Test Loss: 0.2813428
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 22 cost time: 0.862250804901123
Epoch: 22, Steps: 64 | Train Loss: 0.0857608 Vali Loss: 0.2066861 Test Loss: 0.2823827
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 23 cost time: 0.865401029586792
Epoch: 23, Steps: 64 | Train Loss: 0.0854410 Vali Loss: 0.2014089 Test Loss: 0.2817605
Validation loss decreased (0.206585 --> 0.201409).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 24 cost time: 0.8617801666259766
Epoch: 24, Steps: 64 | Train Loss: 0.0845061 Vali Loss: 0.2039093 Test Loss: 0.2824549
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 25 cost time: 0.860999584197998
Epoch: 25, Steps: 64 | Train Loss: 0.0844998 Vali Loss: 0.2024951 Test Loss: 0.2818553
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 26 cost time: 0.8649897575378418
Epoch: 26, Steps: 64 | Train Loss: 0.0843506 Vali Loss: 0.2018327 Test Loss: 0.2808310
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 27 cost time: 0.8573572635650635
Epoch: 27, Steps: 64 | Train Loss: 0.0839556 Vali Loss: 0.2014258 Test Loss: 0.2806603
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 28 cost time: 0.8568322658538818
Epoch: 28, Steps: 64 | Train Loss: 0.0841205 Vali Loss: 0.2024827 Test Loss: 0.2805526
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 29 cost time: 0.863685131072998
Epoch: 29, Steps: 64 | Train Loss: 0.0838398 Vali Loss: 0.2007075 Test Loss: 0.2798446
Validation loss decreased (0.201409 --> 0.200707).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 30 cost time: 0.8590004444122314
Epoch: 30, Steps: 64 | Train Loss: 0.0833675 Vali Loss: 0.1982856 Test Loss: 0.2802770
Validation loss decreased (0.200707 --> 0.198286).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 31 cost time: 0.8632242679595947
Epoch: 31, Steps: 64 | Train Loss: 0.0835754 Vali Loss: 0.1985507 Test Loss: 0.2802038
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 32 cost time: 0.8624527454376221
Epoch: 32, Steps: 64 | Train Loss: 0.0830541 Vali Loss: 0.1971360 Test Loss: 0.2809783
Validation loss decreased (0.198286 --> 0.197136).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 33 cost time: 0.8613905906677246
Epoch: 33, Steps: 64 | Train Loss: 0.0830701 Vali Loss: 0.1958866 Test Loss: 0.2800939
Validation loss decreased (0.197136 --> 0.195887).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 34 cost time: 0.859304666519165
Epoch: 34, Steps: 64 | Train Loss: 0.0827367 Vali Loss: 0.1974622 Test Loss: 0.2791967
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 35 cost time: 0.8538191318511963
Epoch: 35, Steps: 64 | Train Loss: 0.0829230 Vali Loss: 0.1949461 Test Loss: 0.2799433
Validation loss decreased (0.195887 --> 0.194946).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 36 cost time: 0.8590004444122314
Epoch: 36, Steps: 64 | Train Loss: 0.0823846 Vali Loss: 0.1982204 Test Loss: 0.2792810
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 37 cost time: 0.865354061126709
Epoch: 37, Steps: 64 | Train Loss: 0.0830520 Vali Loss: 0.1972837 Test Loss: 0.2794457
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 38 cost time: 0.9325034618377686
Epoch: 38, Steps: 64 | Train Loss: 0.0823143 Vali Loss: 0.1982826 Test Loss: 0.2801944
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 39 cost time: 0.9394979476928711
Epoch: 39, Steps: 64 | Train Loss: 0.0827952 Vali Loss: 0.1986701 Test Loss: 0.2797109
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 40 cost time: 0.9298768043518066
Epoch: 40, Steps: 64 | Train Loss: 0.0825006 Vali Loss: 0.1967390 Test Loss: 0.2800533
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 41 cost time: 0.8767504692077637
Epoch: 41, Steps: 64 | Train Loss: 0.0823612 Vali Loss: 0.1943216 Test Loss: 0.2804658
Validation loss decreased (0.194946 --> 0.194322).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 42 cost time: 0.8666107654571533
Epoch: 42, Steps: 64 | Train Loss: 0.0824919 Vali Loss: 0.1968248 Test Loss: 0.2795590
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 43 cost time: 0.8755970001220703
Epoch: 43, Steps: 64 | Train Loss: 0.0822034 Vali Loss: 0.1971020 Test Loss: 0.2792059
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 44 cost time: 0.8690526485443115
Epoch: 44, Steps: 64 | Train Loss: 0.0818066 Vali Loss: 0.1956230 Test Loss: 0.2794824
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 45 cost time: 0.8497617244720459
Epoch: 45, Steps: 64 | Train Loss: 0.0815720 Vali Loss: 0.1956746 Test Loss: 0.2797388
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 46 cost time: 0.850341796875
Epoch: 46, Steps: 64 | Train Loss: 0.0820544 Vali Loss: 0.1937613 Test Loss: 0.2793591
Validation loss decreased (0.194322 --> 0.193761).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 47 cost time: 0.8540000915527344
Epoch: 47, Steps: 64 | Train Loss: 0.0822070 Vali Loss: 0.1947998 Test Loss: 0.2796320
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 48 cost time: 0.8636035919189453
Epoch: 48, Steps: 64 | Train Loss: 0.0822204 Vali Loss: 0.1979745 Test Loss: 0.2794581
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 49 cost time: 0.872394323348999
Epoch: 49, Steps: 64 | Train Loss: 0.0814755 Vali Loss: 0.1951626 Test Loss: 0.2789305
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 50 cost time: 0.8553411960601807
Epoch: 50, Steps: 64 | Train Loss: 0.0819585 Vali Loss: 0.1949762 Test Loss: 0.2792785
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 51 cost time: 0.8563840389251709
Epoch: 51, Steps: 64 | Train Loss: 0.0820503 Vali Loss: 0.1959338 Test Loss: 0.2794876
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 52 cost time: 0.8480000495910645
Epoch: 52, Steps: 64 | Train Loss: 0.0817166 Vali Loss: 0.1946722 Test Loss: 0.2790456
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 53 cost time: 0.9276204109191895
Epoch: 53, Steps: 64 | Train Loss: 0.0821464 Vali Loss: 0.1966754 Test Loss: 0.2792256
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 54 cost time: 0.9283790588378906
Epoch: 54, Steps: 64 | Train Loss: 0.0819756 Vali Loss: 0.1942391 Test Loss: 0.2789078
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 55 cost time: 0.8966042995452881
Epoch: 55, Steps: 64 | Train Loss: 0.0819731 Vali Loss: 0.1961683 Test Loss: 0.2791051
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 56 cost time: 0.8494060039520264
Epoch: 56, Steps: 64 | Train Loss: 0.0818640 Vali Loss: 0.1957202 Test Loss: 0.2793053
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 57 cost time: 0.860802412033081
Epoch: 57, Steps: 64 | Train Loss: 0.0820487 Vali Loss: 0.1937906 Test Loss: 0.2792688
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 58 cost time: 0.8628332614898682
Epoch: 58, Steps: 64 | Train Loss: 0.0823094 Vali Loss: 0.1962458 Test Loss: 0.2795998
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 59 cost time: 0.8676347732543945
Epoch: 59, Steps: 64 | Train Loss: 0.0818836 Vali Loss: 0.1943525 Test Loss: 0.2789945
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 60 cost time: 0.8584275245666504
Epoch: 60, Steps: 64 | Train Loss: 0.0813313 Vali Loss: 0.1970711 Test Loss: 0.2790860
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2793591022491455, mae:0.33795997500419617, rse:0.24257954955101013
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.06978511810302734 GB
Epoch: 1 cost time: 2.263699769973755
Epoch: 1, Steps: 64 | Train Loss: 0.7969718 Vali Loss: 2.4283299 Test Loss: 4.1666126
Validation loss decreased (inf --> 2.428330).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 2 cost time: 0.8973619937896729
Epoch: 2, Steps: 64 | Train Loss: 0.3435245 Vali Loss: 0.3222169 Test Loss: 0.3120727
Validation loss decreased (2.428330 --> 0.322217).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 3 cost time: 0.8940596580505371
Epoch: 3, Steps: 64 | Train Loss: 0.1089388 Vali Loss: 0.2590661 Test Loss: 0.3068046
Validation loss decreased (0.322217 --> 0.259066).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 4 cost time: 0.8882555961608887
Epoch: 4, Steps: 64 | Train Loss: 0.0962541 Vali Loss: 0.2429100 Test Loss: 0.2854741
Validation loss decreased (0.259066 --> 0.242910).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 5 cost time: 0.8946185111999512
Epoch: 5, Steps: 64 | Train Loss: 0.0914694 Vali Loss: 0.2350764 Test Loss: 0.2848940
Validation loss decreased (0.242910 --> 0.235076).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 6 cost time: 0.9053730964660645
Epoch: 6, Steps: 64 | Train Loss: 0.0885114 Vali Loss: 0.2284459 Test Loss: 0.2829044
Validation loss decreased (0.235076 --> 0.228446).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 7 cost time: 0.8703336715698242
Epoch: 7, Steps: 64 | Train Loss: 0.0854242 Vali Loss: 0.2228749 Test Loss: 0.2798012
Validation loss decreased (0.228446 --> 0.222875).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 8 cost time: 0.8923871517181396
Epoch: 8, Steps: 64 | Train Loss: 0.0835893 Vali Loss: 0.2180717 Test Loss: 0.2789205
Validation loss decreased (0.222875 --> 0.218072).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 9 cost time: 0.8947522640228271
Epoch: 9, Steps: 64 | Train Loss: 0.0817864 Vali Loss: 0.2099350 Test Loss: 0.2798240
Validation loss decreased (0.218072 --> 0.209935).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 10 cost time: 0.8969986438751221
Epoch: 10, Steps: 64 | Train Loss: 0.0800496 Vali Loss: 0.2108597 Test Loss: 0.2785574
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 11 cost time: 0.8996272087097168
Epoch: 11, Steps: 64 | Train Loss: 0.0796374 Vali Loss: 0.2075732 Test Loss: 0.2793756
Validation loss decreased (0.209935 --> 0.207573).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 12 cost time: 0.8991186618804932
Epoch: 12, Steps: 64 | Train Loss: 0.0781136 Vali Loss: 0.2034095 Test Loss: 0.2779844
Validation loss decreased (0.207573 --> 0.203410).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 13 cost time: 0.909325361251831
Epoch: 13, Steps: 64 | Train Loss: 0.0775002 Vali Loss: 0.1992385 Test Loss: 0.2781686
Validation loss decreased (0.203410 --> 0.199239).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 14 cost time: 0.8953754901885986
Epoch: 14, Steps: 64 | Train Loss: 0.0767572 Vali Loss: 0.2012367 Test Loss: 0.2778682
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 15 cost time: 0.9127304553985596
Epoch: 15, Steps: 64 | Train Loss: 0.0760613 Vali Loss: 0.1987087 Test Loss: 0.2767486
Validation loss decreased (0.199239 --> 0.198709).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 16 cost time: 0.9148375988006592
Epoch: 16, Steps: 64 | Train Loss: 0.0752931 Vali Loss: 0.1976845 Test Loss: 0.2760804
Validation loss decreased (0.198709 --> 0.197685).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 17 cost time: 0.9031641483306885
Epoch: 17, Steps: 64 | Train Loss: 0.0745557 Vali Loss: 0.1940751 Test Loss: 0.2754374
Validation loss decreased (0.197685 --> 0.194075).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 18 cost time: 0.8956582546234131
Epoch: 18, Steps: 64 | Train Loss: 0.0748353 Vali Loss: 0.1950284 Test Loss: 0.2751306
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 19 cost time: 0.9013755321502686
Epoch: 19, Steps: 64 | Train Loss: 0.0736581 Vali Loss: 0.1927325 Test Loss: 0.2750373
Validation loss decreased (0.194075 --> 0.192732).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 20 cost time: 0.9013781547546387
Epoch: 20, Steps: 64 | Train Loss: 0.0735785 Vali Loss: 0.1944247 Test Loss: 0.2759835
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 21 cost time: 0.9142196178436279
Epoch: 21, Steps: 64 | Train Loss: 0.0733517 Vali Loss: 0.1933006 Test Loss: 0.2752162
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 22 cost time: 0.9013791084289551
Epoch: 22, Steps: 64 | Train Loss: 0.0729798 Vali Loss: 0.1916804 Test Loss: 0.2741766
Validation loss decreased (0.192732 --> 0.191680).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 23 cost time: 0.8957657814025879
Epoch: 23, Steps: 64 | Train Loss: 0.0727399 Vali Loss: 0.1914199 Test Loss: 0.2746236
Validation loss decreased (0.191680 --> 0.191420).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 24 cost time: 0.8995819091796875
Epoch: 24, Steps: 64 | Train Loss: 0.0725425 Vali Loss: 0.1905277 Test Loss: 0.2740752
Validation loss decreased (0.191420 --> 0.190528).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 25 cost time: 0.8936395645141602
Epoch: 25, Steps: 64 | Train Loss: 0.0722856 Vali Loss: 0.1903465 Test Loss: 0.2737752
Validation loss decreased (0.190528 --> 0.190346).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 26 cost time: 0.89111328125
Epoch: 26, Steps: 64 | Train Loss: 0.0723690 Vali Loss: 0.1882775 Test Loss: 0.2733502
Validation loss decreased (0.190346 --> 0.188277).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 27 cost time: 0.8980007171630859
Epoch: 27, Steps: 64 | Train Loss: 0.0721328 Vali Loss: 0.1921392 Test Loss: 0.2738359
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 28 cost time: 0.8963418006896973
Epoch: 28, Steps: 64 | Train Loss: 0.0719797 Vali Loss: 0.1881791 Test Loss: 0.2742718
Validation loss decreased (0.188277 --> 0.188179).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 29 cost time: 0.8943667411804199
Epoch: 29, Steps: 64 | Train Loss: 0.0714972 Vali Loss: 0.1916607 Test Loss: 0.2729537
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 30 cost time: 0.8825275897979736
Epoch: 30, Steps: 64 | Train Loss: 0.0715407 Vali Loss: 0.1876747 Test Loss: 0.2740069
Validation loss decreased (0.188179 --> 0.187675).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 31 cost time: 0.9046189785003662
Epoch: 31, Steps: 64 | Train Loss: 0.0715300 Vali Loss: 0.1894164 Test Loss: 0.2737029
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 32 cost time: 0.9626479148864746
Epoch: 32, Steps: 64 | Train Loss: 0.0710061 Vali Loss: 0.1869559 Test Loss: 0.2740711
Validation loss decreased (0.187675 --> 0.186956).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 33 cost time: 0.9614148139953613
Epoch: 33, Steps: 64 | Train Loss: 0.0710563 Vali Loss: 0.1872170 Test Loss: 0.2745076
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 34 cost time: 0.9023683071136475
Epoch: 34, Steps: 64 | Train Loss: 0.0710604 Vali Loss: 0.1882752 Test Loss: 0.2734480
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 35 cost time: 0.8934175968170166
Epoch: 35, Steps: 64 | Train Loss: 0.0710798 Vali Loss: 0.1881980 Test Loss: 0.2732878
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 36 cost time: 0.899376630783081
Epoch: 36, Steps: 64 | Train Loss: 0.0709835 Vali Loss: 0.1865541 Test Loss: 0.2732405
Validation loss decreased (0.186956 --> 0.186554).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 37 cost time: 0.9007251262664795
Epoch: 37, Steps: 64 | Train Loss: 0.0710671 Vali Loss: 0.1873340 Test Loss: 0.2737266
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 38 cost time: 0.9120001792907715
Epoch: 38, Steps: 64 | Train Loss: 0.0712448 Vali Loss: 0.1878828 Test Loss: 0.2734686
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 39 cost time: 0.8926141262054443
Epoch: 39, Steps: 64 | Train Loss: 0.0710856 Vali Loss: 0.1876127 Test Loss: 0.2739562
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 40 cost time: 0.8994104862213135
Epoch: 40, Steps: 64 | Train Loss: 0.0711520 Vali Loss: 0.1853780 Test Loss: 0.2735854
Validation loss decreased (0.186554 --> 0.185378).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 41 cost time: 0.9043891429901123
Epoch: 41, Steps: 64 | Train Loss: 0.0711045 Vali Loss: 0.1868736 Test Loss: 0.2736897
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 42 cost time: 0.8960022926330566
Epoch: 42, Steps: 64 | Train Loss: 0.0706125 Vali Loss: 0.1832555 Test Loss: 0.2734546
Validation loss decreased (0.185378 --> 0.183256).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 43 cost time: 0.8927552700042725
Epoch: 43, Steps: 64 | Train Loss: 0.0708186 Vali Loss: 0.1854281 Test Loss: 0.2734709
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 44 cost time: 0.89438796043396
Epoch: 44, Steps: 64 | Train Loss: 0.0706689 Vali Loss: 0.1872060 Test Loss: 0.2733808
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 45 cost time: 0.8940932750701904
Epoch: 45, Steps: 64 | Train Loss: 0.0711051 Vali Loss: 0.1838693 Test Loss: 0.2731475
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 46 cost time: 0.8986170291900635
Epoch: 46, Steps: 64 | Train Loss: 0.0705802 Vali Loss: 0.1861941 Test Loss: 0.2734940
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 47 cost time: 0.8998358249664307
Epoch: 47, Steps: 64 | Train Loss: 0.0708403 Vali Loss: 0.1864392 Test Loss: 0.2736103
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 48 cost time: 0.8954300880432129
Epoch: 48, Steps: 64 | Train Loss: 0.0706458 Vali Loss: 0.1862555 Test Loss: 0.2735934
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 49 cost time: 0.8959975242614746
Epoch: 49, Steps: 64 | Train Loss: 0.0701697 Vali Loss: 0.1880684 Test Loss: 0.2731209
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 50 cost time: 0.8877511024475098
Epoch: 50, Steps: 64 | Train Loss: 0.0706675 Vali Loss: 0.1860099 Test Loss: 0.2728521
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 51 cost time: 0.8930001258850098
Epoch: 51, Steps: 64 | Train Loss: 0.0705711 Vali Loss: 0.1869435 Test Loss: 0.2732965
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 52 cost time: 0.8933939933776855
Epoch: 52, Steps: 64 | Train Loss: 0.0706704 Vali Loss: 0.1868330 Test Loss: 0.2737776
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 53 cost time: 0.9624710083007812
Epoch: 53, Steps: 64 | Train Loss: 0.0706415 Vali Loss: 0.1873866 Test Loss: 0.2736571
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 54 cost time: 0.966785192489624
Epoch: 54, Steps: 64 | Train Loss: 0.0705888 Vali Loss: 0.1864026 Test Loss: 0.2736278
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 55 cost time: 0.9023706912994385
Epoch: 55, Steps: 64 | Train Loss: 0.0702959 Vali Loss: 0.1865597 Test Loss: 0.2735818
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 56 cost time: 0.9013938903808594
Epoch: 56, Steps: 64 | Train Loss: 0.0701776 Vali Loss: 0.1893167 Test Loss: 0.2736793
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 57 cost time: 0.8974053859710693
Epoch: 57, Steps: 64 | Train Loss: 0.0705778 Vali Loss: 0.1865397 Test Loss: 0.2733371
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 58 cost time: 0.8889999389648438
Epoch: 58, Steps: 64 | Train Loss: 0.0706639 Vali Loss: 0.1864044 Test Loss: 0.2737417
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 59 cost time: 0.9029693603515625
Epoch: 59, Steps: 64 | Train Loss: 0.0706007 Vali Loss: 0.1852352 Test Loss: 0.2733380
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 60 cost time: 0.8923847675323486
Epoch: 60, Steps: 64 | Train Loss: 0.0704426 Vali Loss: 0.1861395 Test Loss: 0.2730728
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2734546363353729, mae:0.3408145606517792, rse:0.2400023192167282
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.07290077209472656 GB
Epoch: 1 cost time: 2.3153235912323
Epoch: 1, Steps: 64 | Train Loss: 0.8123094 Vali Loss: 2.4890475 Test Loss: 4.3486848
Validation loss decreased (inf --> 2.489048).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 2 cost time: 0.9283657073974609
Epoch: 2, Steps: 64 | Train Loss: 0.3200718 Vali Loss: 0.3547465 Test Loss: 0.4204763
Validation loss decreased (2.489048 --> 0.354746).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 3 cost time: 0.9294586181640625
Epoch: 3, Steps: 64 | Train Loss: 0.1048745 Vali Loss: 0.2449456 Test Loss: 0.2863013
Validation loss decreased (0.354746 --> 0.244946).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 4 cost time: 0.9257922172546387
Epoch: 4, Steps: 64 | Train Loss: 0.0924082 Vali Loss: 0.2326109 Test Loss: 0.2927865
Validation loss decreased (0.244946 --> 0.232611).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 5 cost time: 0.9231252670288086
Epoch: 5, Steps: 64 | Train Loss: 0.0878904 Vali Loss: 0.2268594 Test Loss: 0.2838241
Validation loss decreased (0.232611 --> 0.226859).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 6 cost time: 0.920814037322998
Epoch: 6, Steps: 64 | Train Loss: 0.0851565 Vali Loss: 0.2198026 Test Loss: 0.2837408
Validation loss decreased (0.226859 --> 0.219803).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 7 cost time: 0.9230518341064453
Epoch: 7, Steps: 64 | Train Loss: 0.0822077 Vali Loss: 0.2170241 Test Loss: 0.2782679
Validation loss decreased (0.219803 --> 0.217024).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 8 cost time: 0.9268035888671875
Epoch: 8, Steps: 64 | Train Loss: 0.0804286 Vali Loss: 0.2051872 Test Loss: 0.2787006
Validation loss decreased (0.217024 --> 0.205187).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 9 cost time: 0.9343507289886475
Epoch: 9, Steps: 64 | Train Loss: 0.0789054 Vali Loss: 0.2048102 Test Loss: 0.2762688
Validation loss decreased (0.205187 --> 0.204810).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 10 cost time: 0.9324064254760742
Epoch: 10, Steps: 64 | Train Loss: 0.0777237 Vali Loss: 0.2029346 Test Loss: 0.2762117
Validation loss decreased (0.204810 --> 0.202935).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 11 cost time: 0.9321384429931641
Epoch: 11, Steps: 64 | Train Loss: 0.0762329 Vali Loss: 0.2002833 Test Loss: 0.2751792
Validation loss decreased (0.202935 --> 0.200283).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 12 cost time: 0.9273891448974609
Epoch: 12, Steps: 64 | Train Loss: 0.0752765 Vali Loss: 0.1972445 Test Loss: 0.2738773
Validation loss decreased (0.200283 --> 0.197244).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 13 cost time: 0.9337308406829834
Epoch: 13, Steps: 64 | Train Loss: 0.0745017 Vali Loss: 0.1948156 Test Loss: 0.2751237
Validation loss decreased (0.197244 --> 0.194816).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 14 cost time: 0.9230005741119385
Epoch: 14, Steps: 64 | Train Loss: 0.0735124 Vali Loss: 0.1910446 Test Loss: 0.2708710
Validation loss decreased (0.194816 --> 0.191045).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 15 cost time: 0.9228780269622803
Epoch: 15, Steps: 64 | Train Loss: 0.0734980 Vali Loss: 0.1900410 Test Loss: 0.2713259
Validation loss decreased (0.191045 --> 0.190041).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 16 cost time: 0.9386205673217773
Epoch: 16, Steps: 64 | Train Loss: 0.0723065 Vali Loss: 0.1896829 Test Loss: 0.2709564
Validation loss decreased (0.190041 --> 0.189683).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 17 cost time: 0.9264326095581055
Epoch: 17, Steps: 64 | Train Loss: 0.0718739 Vali Loss: 0.1874577 Test Loss: 0.2709542
Validation loss decreased (0.189683 --> 0.187458).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 18 cost time: 0.9307503700256348
Epoch: 18, Steps: 64 | Train Loss: 0.0715638 Vali Loss: 0.1893970 Test Loss: 0.2701320
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 19 cost time: 0.9343414306640625
Epoch: 19, Steps: 64 | Train Loss: 0.0711323 Vali Loss: 0.1850405 Test Loss: 0.2708459
Validation loss decreased (0.187458 --> 0.185040).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 20 cost time: 0.9304938316345215
Epoch: 20, Steps: 64 | Train Loss: 0.0712470 Vali Loss: 0.1854353 Test Loss: 0.2712194
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 21 cost time: 0.9247500896453857
Epoch: 21, Steps: 64 | Train Loss: 0.0708649 Vali Loss: 0.1858294 Test Loss: 0.2713469
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 22 cost time: 0.9243795871734619
Epoch: 22, Steps: 64 | Train Loss: 0.0704596 Vali Loss: 0.1863123 Test Loss: 0.2703454
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 23 cost time: 0.9074132442474365
Epoch: 23, Steps: 64 | Train Loss: 0.0699824 Vali Loss: 0.1864635 Test Loss: 0.2704920
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 24 cost time: 0.9290492534637451
Epoch: 24, Steps: 64 | Train Loss: 0.0698936 Vali Loss: 0.1831429 Test Loss: 0.2702172
Validation loss decreased (0.185040 --> 0.183143).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 25 cost time: 0.9234204292297363
Epoch: 25, Steps: 64 | Train Loss: 0.0699084 Vali Loss: 0.1828751 Test Loss: 0.2705519
Validation loss decreased (0.183143 --> 0.182875).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 26 cost time: 0.9313333034515381
Epoch: 26, Steps: 64 | Train Loss: 0.0699332 Vali Loss: 0.1795063 Test Loss: 0.2696441
Validation loss decreased (0.182875 --> 0.179506).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 27 cost time: 0.925173282623291
Epoch: 27, Steps: 64 | Train Loss: 0.0700127 Vali Loss: 0.1863151 Test Loss: 0.2698264
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 28 cost time: 0.9283616542816162
Epoch: 28, Steps: 64 | Train Loss: 0.0693517 Vali Loss: 0.1830440 Test Loss: 0.2705208
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 29 cost time: 0.9278099536895752
Epoch: 29, Steps: 64 | Train Loss: 0.0691806 Vali Loss: 0.1844738 Test Loss: 0.2699735
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 30 cost time: 0.9197697639465332
Epoch: 30, Steps: 64 | Train Loss: 0.0692278 Vali Loss: 0.1807861 Test Loss: 0.2699623
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 31 cost time: 0.9200000762939453
Epoch: 31, Steps: 64 | Train Loss: 0.0690136 Vali Loss: 0.1826419 Test Loss: 0.2695951
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 32 cost time: 0.9246351718902588
Epoch: 32, Steps: 64 | Train Loss: 0.0684871 Vali Loss: 0.1824214 Test Loss: 0.2701370
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 33 cost time: 0.9374563694000244
Epoch: 33, Steps: 64 | Train Loss: 0.0686356 Vali Loss: 0.1829943 Test Loss: 0.2703418
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 34 cost time: 0.9223389625549316
Epoch: 34, Steps: 64 | Train Loss: 0.0690813 Vali Loss: 0.1794259 Test Loss: 0.2698977
Validation loss decreased (0.179506 --> 0.179426).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 35 cost time: 0.928351640701294
Epoch: 35, Steps: 64 | Train Loss: 0.0687293 Vali Loss: 0.1825891 Test Loss: 0.2702684
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 36 cost time: 0.9277641773223877
Epoch: 36, Steps: 64 | Train Loss: 0.0688741 Vali Loss: 0.1800036 Test Loss: 0.2694847
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 37 cost time: 0.994542121887207
Epoch: 37, Steps: 64 | Train Loss: 0.0686418 Vali Loss: 0.1812395 Test Loss: 0.2701243
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 38 cost time: 0.9238109588623047
Epoch: 38, Steps: 64 | Train Loss: 0.0684940 Vali Loss: 0.1829432 Test Loss: 0.2696515
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 39 cost time: 0.9209997653961182
Epoch: 39, Steps: 64 | Train Loss: 0.0685407 Vali Loss: 0.1838827 Test Loss: 0.2704137
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 40 cost time: 0.9404816627502441
Epoch: 40, Steps: 64 | Train Loss: 0.0683907 Vali Loss: 0.1804330 Test Loss: 0.2698442
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 41 cost time: 0.9413132667541504
Epoch: 41, Steps: 64 | Train Loss: 0.0684516 Vali Loss: 0.1792639 Test Loss: 0.2693624
Validation loss decreased (0.179426 --> 0.179264).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 42 cost time: 0.9453473091125488
Epoch: 42, Steps: 64 | Train Loss: 0.0688343 Vali Loss: 0.1791179 Test Loss: 0.2699350
Validation loss decreased (0.179264 --> 0.179118).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 43 cost time: 0.9473690986633301
Epoch: 43, Steps: 64 | Train Loss: 0.0686445 Vali Loss: 0.1819578 Test Loss: 0.2698025
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 44 cost time: 0.9313724040985107
Epoch: 44, Steps: 64 | Train Loss: 0.0686009 Vali Loss: 0.1814728 Test Loss: 0.2697965
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 45 cost time: 0.9233894348144531
Epoch: 45, Steps: 64 | Train Loss: 0.0684786 Vali Loss: 0.1823417 Test Loss: 0.2701101
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 46 cost time: 0.9277327060699463
Epoch: 46, Steps: 64 | Train Loss: 0.0683098 Vali Loss: 0.1818068 Test Loss: 0.2704531
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 47 cost time: 0.9083638191223145
Epoch: 47, Steps: 64 | Train Loss: 0.0680987 Vali Loss: 0.1814883 Test Loss: 0.2701164
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 48 cost time: 0.923370361328125
Epoch: 48, Steps: 64 | Train Loss: 0.0683971 Vali Loss: 0.1824798 Test Loss: 0.2693646
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 49 cost time: 0.9266242980957031
Epoch: 49, Steps: 64 | Train Loss: 0.0685801 Vali Loss: 0.1801270 Test Loss: 0.2701961
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 50 cost time: 0.923353910446167
Epoch: 50, Steps: 64 | Train Loss: 0.0680140 Vali Loss: 0.1819294 Test Loss: 0.2695296
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 51 cost time: 0.9243831634521484
Epoch: 51, Steps: 64 | Train Loss: 0.0683935 Vali Loss: 0.1805983 Test Loss: 0.2697481
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 52 cost time: 0.9314377307891846
Epoch: 52, Steps: 64 | Train Loss: 0.0682617 Vali Loss: 0.1818320 Test Loss: 0.2699603
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 53 cost time: 0.9264116287231445
Epoch: 53, Steps: 64 | Train Loss: 0.0684262 Vali Loss: 0.1791575 Test Loss: 0.2699074
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 54 cost time: 0.927804708480835
Epoch: 54, Steps: 64 | Train Loss: 0.0686920 Vali Loss: 0.1790010 Test Loss: 0.2700717
Validation loss decreased (0.179118 --> 0.179001).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 55 cost time: 0.9259998798370361
Epoch: 55, Steps: 64 | Train Loss: 0.0681094 Vali Loss: 0.1813044 Test Loss: 0.2696194
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 56 cost time: 0.9239342212677002
Epoch: 56, Steps: 64 | Train Loss: 0.0683070 Vali Loss: 0.1817113 Test Loss: 0.2702157
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 57 cost time: 0.9377961158752441
Epoch: 57, Steps: 64 | Train Loss: 0.0682032 Vali Loss: 0.1804600 Test Loss: 0.2695824
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 58 cost time: 0.9473097324371338
Epoch: 58, Steps: 64 | Train Loss: 0.0683264 Vali Loss: 0.1809851 Test Loss: 0.2703549
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 59 cost time: 0.9444334506988525
Epoch: 59, Steps: 64 | Train Loss: 0.0683716 Vali Loss: 0.1778214 Test Loss: 0.2701606
Validation loss decreased (0.179001 --> 0.177821).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 60 cost time: 0.9623584747314453
Epoch: 60, Steps: 64 | Train Loss: 0.0685282 Vali Loss: 0.1827273 Test Loss: 0.2697531
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.27016064524650574, mae:0.3389849364757538, rse:0.23855243623256683
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.0656743049621582 GB
Epoch: 1 cost time: 2.2872872352600098
Epoch: 1, Steps: 64 | Train Loss: 0.8690644 Vali Loss: 2.5886128 Test Loss: 4.4554238
Validation loss decreased (inf --> 2.588613).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 2 cost time: 0.8853485584259033
Epoch: 2, Steps: 64 | Train Loss: 0.5918893 Vali Loss: 1.1029143 Test Loss: 1.7092414
Validation loss decreased (2.588613 --> 1.102914).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 3 cost time: 0.8910000324249268
Epoch: 3, Steps: 64 | Train Loss: 0.3065209 Vali Loss: 0.6394348 Test Loss: 0.8939731
Validation loss decreased (1.102914 --> 0.639435).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 4 cost time: 0.881049394607544
Epoch: 4, Steps: 64 | Train Loss: 0.1919883 Vali Loss: 0.4387109 Test Loss: 0.5847898
Validation loss decreased (0.639435 --> 0.438711).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 5 cost time: 0.8714652061462402
Epoch: 5, Steps: 64 | Train Loss: 0.1409124 Vali Loss: 0.3336419 Test Loss: 0.4321119
Validation loss decreased (0.438711 --> 0.333642).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 6 cost time: 0.8654274940490723
Epoch: 6, Steps: 64 | Train Loss: 0.1194639 Vali Loss: 0.2872350 Test Loss: 0.3669188
Validation loss decreased (0.333642 --> 0.287235).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 7 cost time: 0.8764288425445557
Epoch: 7, Steps: 64 | Train Loss: 0.1090178 Vali Loss: 0.2598003 Test Loss: 0.3279936
Validation loss decreased (0.287235 --> 0.259800).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 8 cost time: 0.8638255596160889
Epoch: 8, Steps: 64 | Train Loss: 0.1028106 Vali Loss: 0.2477578 Test Loss: 0.3142967
Validation loss decreased (0.259800 --> 0.247758).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 9 cost time: 0.8640000820159912
Epoch: 9, Steps: 64 | Train Loss: 0.0991720 Vali Loss: 0.2401439 Test Loss: 0.3054603
Validation loss decreased (0.247758 --> 0.240144).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 10 cost time: 0.866619348526001
Epoch: 10, Steps: 64 | Train Loss: 0.0969231 Vali Loss: 0.2339845 Test Loss: 0.3010913
Validation loss decreased (0.240144 --> 0.233984).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 11 cost time: 0.882361650466919
Epoch: 11, Steps: 64 | Train Loss: 0.0943172 Vali Loss: 0.2291060 Test Loss: 0.2944566
Validation loss decreased (0.233984 --> 0.229106).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 12 cost time: 0.8754057884216309
Epoch: 12, Steps: 64 | Train Loss: 0.0928595 Vali Loss: 0.2256619 Test Loss: 0.2924568
Validation loss decreased (0.229106 --> 0.225662).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 13 cost time: 0.8704254627227783
Epoch: 13, Steps: 64 | Train Loss: 0.0916701 Vali Loss: 0.2210969 Test Loss: 0.2907118
Validation loss decreased (0.225662 --> 0.221097).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 14 cost time: 0.8717617988586426
Epoch: 14, Steps: 64 | Train Loss: 0.0906872 Vali Loss: 0.2230498 Test Loss: 0.2922605
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 15 cost time: 0.8678860664367676
Epoch: 15, Steps: 64 | Train Loss: 0.0894143 Vali Loss: 0.2177849 Test Loss: 0.2896791
Validation loss decreased (0.221097 --> 0.217785).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 16 cost time: 0.8596200942993164
Epoch: 16, Steps: 64 | Train Loss: 0.0886733 Vali Loss: 0.2183741 Test Loss: 0.2897668
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 17 cost time: 0.8623685836791992
Epoch: 17, Steps: 64 | Train Loss: 0.0877997 Vali Loss: 0.2147315 Test Loss: 0.2865969
Validation loss decreased (0.217785 --> 0.214732).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 18 cost time: 0.8623535633087158
Epoch: 18, Steps: 64 | Train Loss: 0.0870043 Vali Loss: 0.2128236 Test Loss: 0.2858704
Validation loss decreased (0.214732 --> 0.212824).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 19 cost time: 0.8727900981903076
Epoch: 19, Steps: 64 | Train Loss: 0.0867994 Vali Loss: 0.2128071 Test Loss: 0.2847335
Validation loss decreased (0.212824 --> 0.212807).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 20 cost time: 0.8649997711181641
Epoch: 20, Steps: 64 | Train Loss: 0.0854798 Vali Loss: 0.2121127 Test Loss: 0.2859196
Validation loss decreased (0.212807 --> 0.212113).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 21 cost time: 0.871617317199707
Epoch: 21, Steps: 64 | Train Loss: 0.0856360 Vali Loss: 0.2093401 Test Loss: 0.2843468
Validation loss decreased (0.212113 --> 0.209340).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 22 cost time: 0.8753368854522705
Epoch: 22, Steps: 64 | Train Loss: 0.0845866 Vali Loss: 0.2091823 Test Loss: 0.2854507
Validation loss decreased (0.209340 --> 0.209182).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 23 cost time: 0.8694753646850586
Epoch: 23, Steps: 64 | Train Loss: 0.0843683 Vali Loss: 0.2106921 Test Loss: 0.2844869
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 24 cost time: 0.8617734909057617
Epoch: 24, Steps: 64 | Train Loss: 0.0838835 Vali Loss: 0.2076332 Test Loss: 0.2830640
Validation loss decreased (0.209182 --> 0.207633).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 25 cost time: 0.8618407249450684
Epoch: 25, Steps: 64 | Train Loss: 0.0839304 Vali Loss: 0.2058686 Test Loss: 0.2835616
Validation loss decreased (0.207633 --> 0.205869).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 26 cost time: 0.8339996337890625
Epoch: 26, Steps: 64 | Train Loss: 0.0831492 Vali Loss: 0.2023095 Test Loss: 0.2820267
Validation loss decreased (0.205869 --> 0.202310).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 27 cost time: 0.8326351642608643
Epoch: 27, Steps: 64 | Train Loss: 0.0832077 Vali Loss: 0.2025595 Test Loss: 0.2829120
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 28 cost time: 0.8740811347961426
Epoch: 28, Steps: 64 | Train Loss: 0.0825084 Vali Loss: 0.2047618 Test Loss: 0.2819728
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 29 cost time: 0.8783447742462158
Epoch: 29, Steps: 64 | Train Loss: 0.0821272 Vali Loss: 0.2049301 Test Loss: 0.2815669
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 30 cost time: 0.9338436126708984
Epoch: 30, Steps: 64 | Train Loss: 0.0820597 Vali Loss: 0.2042635 Test Loss: 0.2806553
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 31 cost time: 0.9418559074401855
Epoch: 31, Steps: 64 | Train Loss: 0.0819214 Vali Loss: 0.2029869 Test Loss: 0.2820993
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 32 cost time: 0.9358811378479004
Epoch: 32, Steps: 64 | Train Loss: 0.0819855 Vali Loss: 0.2010615 Test Loss: 0.2813219
Validation loss decreased (0.202310 --> 0.201061).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 33 cost time: 0.8376331329345703
Epoch: 33, Steps: 64 | Train Loss: 0.0817829 Vali Loss: 0.2013684 Test Loss: 0.2807143
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 34 cost time: 0.8624238967895508
Epoch: 34, Steps: 64 | Train Loss: 0.0818781 Vali Loss: 0.2036808 Test Loss: 0.2800076
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 35 cost time: 0.860398530960083
Epoch: 35, Steps: 64 | Train Loss: 0.0814022 Vali Loss: 0.2006349 Test Loss: 0.2810686
Validation loss decreased (0.201061 --> 0.200635).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 36 cost time: 0.8627974987030029
Epoch: 36, Steps: 64 | Train Loss: 0.0814874 Vali Loss: 0.2000963 Test Loss: 0.2796337
Validation loss decreased (0.200635 --> 0.200096).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 37 cost time: 0.8712646961212158
Epoch: 37, Steps: 64 | Train Loss: 0.0810990 Vali Loss: 0.2041747 Test Loss: 0.2814452
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 38 cost time: 0.8666303157806396
Epoch: 38, Steps: 64 | Train Loss: 0.0812581 Vali Loss: 0.2005333 Test Loss: 0.2799451
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 39 cost time: 0.8695213794708252
Epoch: 39, Steps: 64 | Train Loss: 0.0808282 Vali Loss: 0.2018567 Test Loss: 0.2809699
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 40 cost time: 0.8815441131591797
Epoch: 40, Steps: 64 | Train Loss: 0.0811276 Vali Loss: 0.1989052 Test Loss: 0.2799310
Validation loss decreased (0.200096 --> 0.198905).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 41 cost time: 0.8674123287200928
Epoch: 41, Steps: 64 | Train Loss: 0.0809459 Vali Loss: 0.2023856 Test Loss: 0.2802796
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 42 cost time: 0.8641870021820068
Epoch: 42, Steps: 64 | Train Loss: 0.0810079 Vali Loss: 0.1999612 Test Loss: 0.2792737
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 43 cost time: 0.8649997711181641
Epoch: 43, Steps: 64 | Train Loss: 0.0808149 Vali Loss: 0.1990286 Test Loss: 0.2788205
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 44 cost time: 0.8746294975280762
Epoch: 44, Steps: 64 | Train Loss: 0.0808013 Vali Loss: 0.1987916 Test Loss: 0.2805781
Validation loss decreased (0.198905 --> 0.198792).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 45 cost time: 0.8613600730895996
Epoch: 45, Steps: 64 | Train Loss: 0.0807958 Vali Loss: 0.1999920 Test Loss: 0.2792154
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 46 cost time: 0.8683373928070068
Epoch: 46, Steps: 64 | Train Loss: 0.0807335 Vali Loss: 0.2011122 Test Loss: 0.2796001
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 47 cost time: 0.8807971477508545
Epoch: 47, Steps: 64 | Train Loss: 0.0805009 Vali Loss: 0.1991751 Test Loss: 0.2790060
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 48 cost time: 0.8700006008148193
Epoch: 48, Steps: 64 | Train Loss: 0.0804362 Vali Loss: 0.2019039 Test Loss: 0.2784524
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 49 cost time: 0.868628978729248
Epoch: 49, Steps: 64 | Train Loss: 0.0806574 Vali Loss: 0.1976273 Test Loss: 0.2791033
Validation loss decreased (0.198792 --> 0.197627).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 50 cost time: 0.869471549987793
Epoch: 50, Steps: 64 | Train Loss: 0.0803396 Vali Loss: 0.1999545 Test Loss: 0.2786407
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 51 cost time: 0.8658223152160645
Epoch: 51, Steps: 64 | Train Loss: 0.0802985 Vali Loss: 0.1983232 Test Loss: 0.2781046
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 52 cost time: 0.8613560199737549
Epoch: 52, Steps: 64 | Train Loss: 0.0803343 Vali Loss: 0.2009645 Test Loss: 0.2813087
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 53 cost time: 0.8627965450286865
Epoch: 53, Steps: 64 | Train Loss: 0.0800852 Vali Loss: 0.1980227 Test Loss: 0.2788913
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 54 cost time: 0.8589999675750732
Epoch: 54, Steps: 64 | Train Loss: 0.0808798 Vali Loss: 0.2012922 Test Loss: 0.2790380
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 55 cost time: 0.8643949031829834
Epoch: 55, Steps: 64 | Train Loss: 0.0810194 Vali Loss: 0.2009916 Test Loss: 0.2790250
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 56 cost time: 0.870250940322876
Epoch: 56, Steps: 64 | Train Loss: 0.0806567 Vali Loss: 0.1985689 Test Loss: 0.2794760
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 57 cost time: 0.8703975677490234
Epoch: 57, Steps: 64 | Train Loss: 0.0808254 Vali Loss: 0.2007161 Test Loss: 0.2782984
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 58 cost time: 0.8680243492126465
Epoch: 58, Steps: 64 | Train Loss: 0.0804431 Vali Loss: 0.1994986 Test Loss: 0.2788876
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 59 cost time: 0.8740005493164062
Epoch: 59, Steps: 64 | Train Loss: 0.0803556 Vali Loss: 0.1974557 Test Loss: 0.2780449
Validation loss decreased (0.197627 --> 0.197456).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 60 cost time: 0.8692383766174316
Epoch: 60, Steps: 64 | Train Loss: 0.0801760 Vali Loss: 0.1998450 Test Loss: 0.2779805
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2780449390411377, mae:0.3425307869911194, rse:0.24200831353664398
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.0699467658996582 GB
Epoch: 1 cost time: 2.258683443069458
Epoch: 1, Steps: 64 | Train Loss: 0.8609482 Vali Loss: 2.5804956 Test Loss: 4.5520482
Validation loss decreased (inf --> 2.580496).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 2 cost time: 0.9134347438812256
Epoch: 2, Steps: 64 | Train Loss: 0.3565448 Vali Loss: 0.2842850 Test Loss: 0.2943639
Validation loss decreased (2.580496 --> 0.284285).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 3 cost time: 0.9214046001434326
Epoch: 3, Steps: 64 | Train Loss: 0.1032900 Vali Loss: 0.2492691 Test Loss: 0.2959610
Validation loss decreased (0.284285 --> 0.249269).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 4 cost time: 0.9183821678161621
Epoch: 4, Steps: 64 | Train Loss: 0.0923789 Vali Loss: 0.2381286 Test Loss: 0.2801719
Validation loss decreased (0.249269 --> 0.238129).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 5 cost time: 0.920121431350708
Epoch: 5, Steps: 64 | Train Loss: 0.0874288 Vali Loss: 0.2290522 Test Loss: 0.2767506
Validation loss decreased (0.238129 --> 0.229052).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 6 cost time: 0.9020013809204102
Epoch: 6, Steps: 64 | Train Loss: 0.0851203 Vali Loss: 0.2211660 Test Loss: 0.2749598
Validation loss decreased (0.229052 --> 0.221166).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 7 cost time: 0.9116148948669434
Epoch: 7, Steps: 64 | Train Loss: 0.0829783 Vali Loss: 0.2145763 Test Loss: 0.2768765
Validation loss decreased (0.221166 --> 0.214576).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 8 cost time: 0.909404993057251
Epoch: 8, Steps: 64 | Train Loss: 0.0812059 Vali Loss: 0.2138990 Test Loss: 0.2756697
Validation loss decreased (0.214576 --> 0.213899).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 9 cost time: 0.915637731552124
Epoch: 9, Steps: 64 | Train Loss: 0.0792680 Vali Loss: 0.2086118 Test Loss: 0.2767809
Validation loss decreased (0.213899 --> 0.208612).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 10 cost time: 0.9113545417785645
Epoch: 10, Steps: 64 | Train Loss: 0.0785567 Vali Loss: 0.2020428 Test Loss: 0.2757084
Validation loss decreased (0.208612 --> 0.202043).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 11 cost time: 0.9124500751495361
Epoch: 11, Steps: 64 | Train Loss: 0.0770379 Vali Loss: 0.1999386 Test Loss: 0.2750751
Validation loss decreased (0.202043 --> 0.199939).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 12 cost time: 0.9227609634399414
Epoch: 12, Steps: 64 | Train Loss: 0.0758195 Vali Loss: 0.1982546 Test Loss: 0.2769929
Validation loss decreased (0.199939 --> 0.198255).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 13 cost time: 0.9097239971160889
Epoch: 13, Steps: 64 | Train Loss: 0.0754395 Vali Loss: 0.1954212 Test Loss: 0.2752550
Validation loss decreased (0.198255 --> 0.195421).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 14 cost time: 0.8999972343444824
Epoch: 14, Steps: 64 | Train Loss: 0.0748796 Vali Loss: 0.1958465 Test Loss: 0.2730451
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 15 cost time: 0.9066143035888672
Epoch: 15, Steps: 64 | Train Loss: 0.0740297 Vali Loss: 0.1983692 Test Loss: 0.2749077
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 16 cost time: 0.9201116561889648
Epoch: 16, Steps: 64 | Train Loss: 0.0736946 Vali Loss: 0.1946020 Test Loss: 0.2736332
Validation loss decreased (0.195421 --> 0.194602).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 17 cost time: 0.9043641090393066
Epoch: 17, Steps: 64 | Train Loss: 0.0732242 Vali Loss: 0.1913243 Test Loss: 0.2733248
Validation loss decreased (0.194602 --> 0.191324).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 18 cost time: 0.9109687805175781
Epoch: 18, Steps: 64 | Train Loss: 0.0722346 Vali Loss: 0.1922993 Test Loss: 0.2731017
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 19 cost time: 0.9223854541778564
Epoch: 19, Steps: 64 | Train Loss: 0.0717866 Vali Loss: 0.1907576 Test Loss: 0.2724544
Validation loss decreased (0.191324 --> 0.190758).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 20 cost time: 0.9178030490875244
Epoch: 20, Steps: 64 | Train Loss: 0.0714494 Vali Loss: 0.1902556 Test Loss: 0.2731186
Validation loss decreased (0.190758 --> 0.190256).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 21 cost time: 0.9129998683929443
Epoch: 21, Steps: 64 | Train Loss: 0.0713914 Vali Loss: 0.1889432 Test Loss: 0.2729869
Validation loss decreased (0.190256 --> 0.188943).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 22 cost time: 0.9172544479370117
Epoch: 22, Steps: 64 | Train Loss: 0.0706654 Vali Loss: 0.1885896 Test Loss: 0.2726112
Validation loss decreased (0.188943 --> 0.188590).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 23 cost time: 0.8974072933197021
Epoch: 23, Steps: 64 | Train Loss: 0.0704068 Vali Loss: 0.1865764 Test Loss: 0.2719661
Validation loss decreased (0.188590 --> 0.186576).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 24 cost time: 0.9824104309082031
Epoch: 24, Steps: 64 | Train Loss: 0.0697582 Vali Loss: 0.1894903 Test Loss: 0.2707876
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 25 cost time: 0.9833879470825195
Epoch: 25, Steps: 64 | Train Loss: 0.0703838 Vali Loss: 0.1873322 Test Loss: 0.2718551
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 26 cost time: 0.9484896659851074
Epoch: 26, Steps: 64 | Train Loss: 0.0705039 Vali Loss: 0.1859808 Test Loss: 0.2714230
Validation loss decreased (0.186576 --> 0.185981).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 27 cost time: 0.9173812866210938
Epoch: 27, Steps: 64 | Train Loss: 0.0698180 Vali Loss: 0.1852501 Test Loss: 0.2706127
Validation loss decreased (0.185981 --> 0.185250).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 28 cost time: 0.9173479080200195
Epoch: 28, Steps: 64 | Train Loss: 0.0699524 Vali Loss: 0.1852081 Test Loss: 0.2716094
Validation loss decreased (0.185250 --> 0.185208).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 29 cost time: 0.9147481918334961
Epoch: 29, Steps: 64 | Train Loss: 0.0697443 Vali Loss: 0.1849820 Test Loss: 0.2716627
Validation loss decreased (0.185208 --> 0.184982).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 30 cost time: 0.9204177856445312
Epoch: 30, Steps: 64 | Train Loss: 0.0700337 Vali Loss: 0.1843163 Test Loss: 0.2707604
Validation loss decreased (0.184982 --> 0.184316).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 31 cost time: 0.9066135883331299
Epoch: 31, Steps: 64 | Train Loss: 0.0694352 Vali Loss: 0.1851994 Test Loss: 0.2706128
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 32 cost time: 0.9045290946960449
Epoch: 32, Steps: 64 | Train Loss: 0.0696194 Vali Loss: 0.1840493 Test Loss: 0.2707965
Validation loss decreased (0.184316 --> 0.184049).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 33 cost time: 0.915640115737915
Epoch: 33, Steps: 64 | Train Loss: 0.0689005 Vali Loss: 0.1856935 Test Loss: 0.2709420
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 34 cost time: 0.9112668037414551
Epoch: 34, Steps: 64 | Train Loss: 0.0691954 Vali Loss: 0.1850962 Test Loss: 0.2705278
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 35 cost time: 0.9163970947265625
Epoch: 35, Steps: 64 | Train Loss: 0.0691023 Vali Loss: 0.1849517 Test Loss: 0.2704259
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 36 cost time: 0.922776460647583
Epoch: 36, Steps: 64 | Train Loss: 0.0688573 Vali Loss: 0.1849444 Test Loss: 0.2704265
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 37 cost time: 0.9988555908203125
Epoch: 37, Steps: 64 | Train Loss: 0.0691761 Vali Loss: 0.1840862 Test Loss: 0.2700045
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 38 cost time: 0.996842622756958
Epoch: 38, Steps: 64 | Train Loss: 0.0690641 Vali Loss: 0.1836149 Test Loss: 0.2703412
Validation loss decreased (0.184049 --> 0.183615).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 39 cost time: 0.9476137161254883
Epoch: 39, Steps: 64 | Train Loss: 0.0692279 Vali Loss: 0.1849851 Test Loss: 0.2702389
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 40 cost time: 0.9196150302886963
Epoch: 40, Steps: 64 | Train Loss: 0.0686517 Vali Loss: 0.1840625 Test Loss: 0.2699758
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 41 cost time: 0.9140205383300781
Epoch: 41, Steps: 64 | Train Loss: 0.0690945 Vali Loss: 0.1813128 Test Loss: 0.2703666
Validation loss decreased (0.183615 --> 0.181313).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 42 cost time: 0.9110002517700195
Epoch: 42, Steps: 64 | Train Loss: 0.0686849 Vali Loss: 0.1832192 Test Loss: 0.2705103
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 43 cost time: 0.9210903644561768
Epoch: 43, Steps: 64 | Train Loss: 0.0686086 Vali Loss: 0.1835538 Test Loss: 0.2708447
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 44 cost time: 0.9127213954925537
Epoch: 44, Steps: 64 | Train Loss: 0.0688141 Vali Loss: 0.1818899 Test Loss: 0.2705155
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 45 cost time: 0.9272139072418213
Epoch: 45, Steps: 64 | Train Loss: 0.0685128 Vali Loss: 0.1838879 Test Loss: 0.2703245
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 46 cost time: 0.9316110610961914
Epoch: 46, Steps: 64 | Train Loss: 0.0684361 Vali Loss: 0.1829239 Test Loss: 0.2704480
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 47 cost time: 0.9180393218994141
Epoch: 47, Steps: 64 | Train Loss: 0.0691577 Vali Loss: 0.1834776 Test Loss: 0.2697082
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 48 cost time: 0.9084601402282715
Epoch: 48, Steps: 64 | Train Loss: 0.0685892 Vali Loss: 0.1820101 Test Loss: 0.2706651
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 49 cost time: 0.9085395336151123
Epoch: 49, Steps: 64 | Train Loss: 0.0683044 Vali Loss: 0.1840176 Test Loss: 0.2695224
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 50 cost time: 0.9083201885223389
Epoch: 50, Steps: 64 | Train Loss: 0.0689403 Vali Loss: 0.1839229 Test Loss: 0.2705283
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 51 cost time: 0.9064552783966064
Epoch: 51, Steps: 64 | Train Loss: 0.0686842 Vali Loss: 0.1823461 Test Loss: 0.2703910
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 52 cost time: 0.9179999828338623
Epoch: 52, Steps: 64 | Train Loss: 0.0692015 Vali Loss: 0.1827527 Test Loss: 0.2702508
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 53 cost time: 0.9149999618530273
Epoch: 53, Steps: 64 | Train Loss: 0.0689000 Vali Loss: 0.1808959 Test Loss: 0.2696818
Validation loss decreased (0.181313 --> 0.180896).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 54 cost time: 0.8939220905303955
Epoch: 54, Steps: 64 | Train Loss: 0.0684568 Vali Loss: 0.1834115 Test Loss: 0.2702537
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 55 cost time: 0.9866225719451904
Epoch: 55, Steps: 64 | Train Loss: 0.0687539 Vali Loss: 0.1822002 Test Loss: 0.2702856
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 56 cost time: 0.9774308204650879
Epoch: 56, Steps: 64 | Train Loss: 0.0686099 Vali Loss: 0.1857561 Test Loss: 0.2703475
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 57 cost time: 0.9239811897277832
Epoch: 57, Steps: 64 | Train Loss: 0.0684571 Vali Loss: 0.1849680 Test Loss: 0.2701750
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 58 cost time: 0.9084255695343018
Epoch: 58, Steps: 64 | Train Loss: 0.0690035 Vali Loss: 0.1840866 Test Loss: 0.2699191
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 59 cost time: 0.911365270614624
Epoch: 59, Steps: 64 | Train Loss: 0.0689301 Vali Loss: 0.1820710 Test Loss: 0.2698678
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 60 cost time: 0.9233682155609131
Epoch: 60, Steps: 64 | Train Loss: 0.0682677 Vali Loss: 0.1824014 Test Loss: 0.2691631
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.26968178153038025, mae:0.34321123361587524, rse:0.23834089934825897
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07306241989135742 GB
Epoch: 1 cost time: 2.350059986114502
Epoch: 1, Steps: 64 | Train Loss: 0.8107853 Vali Loss: 2.4555073 Test Loss: 4.3318987
Validation loss decreased (inf --> 2.455507).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 2 cost time: 0.9440000057220459
Epoch: 2, Steps: 64 | Train Loss: 0.3073419 Vali Loss: 0.3447616 Test Loss: 0.4273766
Validation loss decreased (2.455507 --> 0.344762).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 3 cost time: 0.9406216144561768
Epoch: 3, Steps: 64 | Train Loss: 0.0989995 Vali Loss: 0.2403926 Test Loss: 0.2737142
Validation loss decreased (0.344762 --> 0.240393).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 4 cost time: 0.9461765289306641
Epoch: 4, Steps: 64 | Train Loss: 0.0876493 Vali Loss: 0.2259570 Test Loss: 0.2799888
Validation loss decreased (0.240393 --> 0.225957).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 5 cost time: 0.942028284072876
Epoch: 5, Steps: 64 | Train Loss: 0.0835945 Vali Loss: 0.2187212 Test Loss: 0.2744461
Validation loss decreased (0.225957 --> 0.218721).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 6 cost time: 0.9413833618164062
Epoch: 6, Steps: 64 | Train Loss: 0.0798398 Vali Loss: 0.2080830 Test Loss: 0.2724792
Validation loss decreased (0.218721 --> 0.208083).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 7 cost time: 0.9440336227416992
Epoch: 7, Steps: 64 | Train Loss: 0.0783641 Vali Loss: 0.2082009 Test Loss: 0.2737844
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 8 cost time: 0.9393491744995117
Epoch: 8, Steps: 64 | Train Loss: 0.0765390 Vali Loss: 0.2036381 Test Loss: 0.2762610
Validation loss decreased (0.208083 --> 0.203638).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 9 cost time: 0.9390718936920166
Epoch: 9, Steps: 64 | Train Loss: 0.0741880 Vali Loss: 0.2010933 Test Loss: 0.2727127
Validation loss decreased (0.203638 --> 0.201093).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 10 cost time: 0.9518711566925049
Epoch: 10, Steps: 64 | Train Loss: 0.0737500 Vali Loss: 0.1952747 Test Loss: 0.2740774
Validation loss decreased (0.201093 --> 0.195275).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 11 cost time: 1.018803596496582
Epoch: 11, Steps: 64 | Train Loss: 0.0725059 Vali Loss: 0.1961130 Test Loss: 0.2707695
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 12 cost time: 1.0250000953674316
Epoch: 12, Steps: 64 | Train Loss: 0.0713152 Vali Loss: 0.1901177 Test Loss: 0.2722317
Validation loss decreased (0.195275 --> 0.190118).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 13 cost time: 0.9573781490325928
Epoch: 13, Steps: 64 | Train Loss: 0.0709923 Vali Loss: 0.1898980 Test Loss: 0.2722911
Validation loss decreased (0.190118 --> 0.189898).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 14 cost time: 0.9426178932189941
Epoch: 14, Steps: 64 | Train Loss: 0.0704543 Vali Loss: 0.1864039 Test Loss: 0.2720467
Validation loss decreased (0.189898 --> 0.186404).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 15 cost time: 0.9376239776611328
Epoch: 15, Steps: 64 | Train Loss: 0.0694623 Vali Loss: 0.1880459 Test Loss: 0.2691560
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 16 cost time: 0.9431068897247314
Epoch: 16, Steps: 64 | Train Loss: 0.0690180 Vali Loss: 0.1862233 Test Loss: 0.2697878
Validation loss decreased (0.186404 --> 0.186223).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 17 cost time: 0.9476385116577148
Epoch: 17, Steps: 64 | Train Loss: 0.0679809 Vali Loss: 0.1842885 Test Loss: 0.2696615
Validation loss decreased (0.186223 --> 0.184289).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 18 cost time: 0.945326566696167
Epoch: 18, Steps: 64 | Train Loss: 0.0679179 Vali Loss: 0.1836514 Test Loss: 0.2691043
Validation loss decreased (0.184289 --> 0.183651).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 19 cost time: 0.9457912445068359
Epoch: 19, Steps: 64 | Train Loss: 0.0674760 Vali Loss: 0.1826880 Test Loss: 0.2677986
Validation loss decreased (0.183651 --> 0.182688).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 20 cost time: 0.9564228057861328
Epoch: 20, Steps: 64 | Train Loss: 0.0674898 Vali Loss: 0.1803779 Test Loss: 0.2701065
Validation loss decreased (0.182688 --> 0.180378).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 21 cost time: 0.9427938461303711
Epoch: 21, Steps: 64 | Train Loss: 0.0667806 Vali Loss: 0.1832575 Test Loss: 0.2692958
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 22 cost time: 0.9349997043609619
Epoch: 22, Steps: 64 | Train Loss: 0.0666553 Vali Loss: 0.1825805 Test Loss: 0.2675835
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 23 cost time: 0.9360001087188721
Epoch: 23, Steps: 64 | Train Loss: 0.0669988 Vali Loss: 0.1829245 Test Loss: 0.2697546
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 24 cost time: 0.9376084804534912
Epoch: 24, Steps: 64 | Train Loss: 0.0665759 Vali Loss: 0.1815946 Test Loss: 0.2686563
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 25 cost time: 0.9361062049865723
Epoch: 25, Steps: 64 | Train Loss: 0.0664649 Vali Loss: 0.1804150 Test Loss: 0.2685049
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 26 cost time: 0.9403448104858398
Epoch: 26, Steps: 64 | Train Loss: 0.0665255 Vali Loss: 0.1803202 Test Loss: 0.2665850
Validation loss decreased (0.180378 --> 0.180320).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 27 cost time: 0.9474012851715088
Epoch: 27, Steps: 64 | Train Loss: 0.0663360 Vali Loss: 0.1810419 Test Loss: 0.2693236
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 28 cost time: 0.9443860054016113
Epoch: 28, Steps: 64 | Train Loss: 0.0657667 Vali Loss: 0.1803701 Test Loss: 0.2682996
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 29 cost time: 0.9393796920776367
Epoch: 29, Steps: 64 | Train Loss: 0.0660086 Vali Loss: 0.1811349 Test Loss: 0.2684858
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 30 cost time: 0.9375863075256348
Epoch: 30, Steps: 64 | Train Loss: 0.0657985 Vali Loss: 0.1821593 Test Loss: 0.2689619
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 31 cost time: 0.9360001087188721
Epoch: 31, Steps: 64 | Train Loss: 0.0659223 Vali Loss: 0.1812114 Test Loss: 0.2689775
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 32 cost time: 0.9429991245269775
Epoch: 32, Steps: 64 | Train Loss: 0.0656043 Vali Loss: 0.1805111 Test Loss: 0.2697263
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 33 cost time: 0.9486179351806641
Epoch: 33, Steps: 64 | Train Loss: 0.0653896 Vali Loss: 0.1784516 Test Loss: 0.2685051
Validation loss decreased (0.180320 --> 0.178452).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 34 cost time: 0.9406015872955322
Epoch: 34, Steps: 64 | Train Loss: 0.0656206 Vali Loss: 0.1807195 Test Loss: 0.2682860
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 35 cost time: 0.9453661441802979
Epoch: 35, Steps: 64 | Train Loss: 0.0656978 Vali Loss: 0.1786790 Test Loss: 0.2683331
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 36 cost time: 0.9440276622772217
Epoch: 36, Steps: 64 | Train Loss: 0.0654045 Vali Loss: 0.1800346 Test Loss: 0.2686387
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 37 cost time: 0.9563312530517578
Epoch: 37, Steps: 64 | Train Loss: 0.0656079 Vali Loss: 0.1806139 Test Loss: 0.2684571
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 38 cost time: 0.9418556690216064
Epoch: 38, Steps: 64 | Train Loss: 0.0657201 Vali Loss: 0.1787739 Test Loss: 0.2678336
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 39 cost time: 0.9387454986572266
Epoch: 39, Steps: 64 | Train Loss: 0.0654752 Vali Loss: 0.1803578 Test Loss: 0.2687698
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 40 cost time: 0.9519996643066406
Epoch: 40, Steps: 64 | Train Loss: 0.0657033 Vali Loss: 0.1798098 Test Loss: 0.2683934
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 41 cost time: 0.9436984062194824
Epoch: 41, Steps: 64 | Train Loss: 0.0654465 Vali Loss: 0.1805895 Test Loss: 0.2681895
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 42 cost time: 0.9380550384521484
Epoch: 42, Steps: 64 | Train Loss: 0.0654901 Vali Loss: 0.1797063 Test Loss: 0.2682023
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 43 cost time: 0.937363862991333
Epoch: 43, Steps: 64 | Train Loss: 0.0656723 Vali Loss: 0.1803373 Test Loss: 0.2690087
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 44 cost time: 0.9268312454223633
Epoch: 44, Steps: 64 | Train Loss: 0.0653277 Vali Loss: 0.1800342 Test Loss: 0.2691901
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 45 cost time: 0.9473977088928223
Epoch: 45, Steps: 64 | Train Loss: 0.0652273 Vali Loss: 0.1825555 Test Loss: 0.2690737
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 46 cost time: 0.9444103240966797
Epoch: 46, Steps: 64 | Train Loss: 0.0652632 Vali Loss: 0.1795689 Test Loss: 0.2689781
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 47 cost time: 0.9378757476806641
Epoch: 47, Steps: 64 | Train Loss: 0.0651637 Vali Loss: 0.1810541 Test Loss: 0.2691265
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 48 cost time: 0.9387354850769043
Epoch: 48, Steps: 64 | Train Loss: 0.0645699 Vali Loss: 0.1787217 Test Loss: 0.2687439
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 49 cost time: 0.94100022315979
Epoch: 49, Steps: 64 | Train Loss: 0.0651172 Vali Loss: 0.1801417 Test Loss: 0.2691749
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 50 cost time: 0.9390056133270264
Epoch: 50, Steps: 64 | Train Loss: 0.0652077 Vali Loss: 0.1804993 Test Loss: 0.2690404
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 51 cost time: 0.9496121406555176
Epoch: 51, Steps: 64 | Train Loss: 0.0653328 Vali Loss: 0.1777915 Test Loss: 0.2683936
Validation loss decreased (0.178452 --> 0.177792).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 52 cost time: 0.9453680515289307
Epoch: 52, Steps: 64 | Train Loss: 0.0649530 Vali Loss: 0.1779244 Test Loss: 0.2682204
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 53 cost time: 0.9453296661376953
Epoch: 53, Steps: 64 | Train Loss: 0.0652256 Vali Loss: 0.1794906 Test Loss: 0.2693983
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 54 cost time: 0.957207441329956
Epoch: 54, Steps: 64 | Train Loss: 0.0651344 Vali Loss: 0.1809422 Test Loss: 0.2687863
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 55 cost time: 0.9403989315032959
Epoch: 55, Steps: 64 | Train Loss: 0.0653044 Vali Loss: 0.1804141 Test Loss: 0.2685350
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 56 cost time: 0.9413809776306152
Epoch: 56, Steps: 64 | Train Loss: 0.0652075 Vali Loss: 0.1802344 Test Loss: 0.2693676
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 57 cost time: 0.9507131576538086
Epoch: 57, Steps: 64 | Train Loss: 0.0656407 Vali Loss: 0.1795749 Test Loss: 0.2686020
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 58 cost time: 0.9498157501220703
Epoch: 58, Steps: 64 | Train Loss: 0.0654382 Vali Loss: 0.1812882 Test Loss: 0.2692729
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 59 cost time: 0.9419996738433838
Epoch: 59, Steps: 64 | Train Loss: 0.0654307 Vali Loss: 0.1795114 Test Loss: 0.2687288
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 60 cost time: 0.9506173133850098
Epoch: 60, Steps: 64 | Train Loss: 0.0652257 Vali Loss: 0.1816400 Test Loss: 0.2689569
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2683936357498169, mae:0.34831181168556213, rse:0.23777100443840027
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06583642959594727 GB
Epoch: 1 cost time: 2.199155569076538
Epoch: 1, Steps: 64 | Train Loss: 0.9148823 Vali Loss: 2.6755297 Test Loss: 4.6445503
Validation loss decreased (inf --> 2.675530).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 2 cost time: 0.8199996948242188
Epoch: 2, Steps: 64 | Train Loss: 0.5891116 Vali Loss: 0.9831262 Test Loss: 1.5443903
Validation loss decreased (2.675530 --> 0.983126).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 3 cost time: 0.821000337600708
Epoch: 3, Steps: 64 | Train Loss: 0.2801390 Vali Loss: 0.5419604 Test Loss: 0.7602968
Validation loss decreased (0.983126 --> 0.541960).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 4 cost time: 0.8266267776489258
Epoch: 4, Steps: 64 | Train Loss: 0.1726107 Vali Loss: 0.3692070 Test Loss: 0.4667627
Validation loss decreased (0.541960 --> 0.369207).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 5 cost time: 0.8209996223449707
Epoch: 5, Steps: 64 | Train Loss: 0.1292883 Vali Loss: 0.2958007 Test Loss: 0.3705509
Validation loss decreased (0.369207 --> 0.295801).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 6 cost time: 0.8106410503387451
Epoch: 6, Steps: 64 | Train Loss: 0.1127799 Vali Loss: 0.2648957 Test Loss: 0.3281797
Validation loss decreased (0.295801 --> 0.264896).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 7 cost time: 0.8146305084228516
Epoch: 7, Steps: 64 | Train Loss: 0.1050038 Vali Loss: 0.2535906 Test Loss: 0.3089873
Validation loss decreased (0.264896 --> 0.253591).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 8 cost time: 0.8148958683013916
Epoch: 8, Steps: 64 | Train Loss: 0.1017117 Vali Loss: 0.2444790 Test Loss: 0.3035027
Validation loss decreased (0.253591 --> 0.244479).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 9 cost time: 0.8120007514953613
Epoch: 9, Steps: 64 | Train Loss: 0.0976437 Vali Loss: 0.2357834 Test Loss: 0.2943598
Validation loss decreased (0.244479 --> 0.235783).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 10 cost time: 0.814619779586792
Epoch: 10, Steps: 64 | Train Loss: 0.0957478 Vali Loss: 0.2365580 Test Loss: 0.2926224
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 11 cost time: 0.8174910545349121
Epoch: 11, Steps: 64 | Train Loss: 0.0937613 Vali Loss: 0.2282678 Test Loss: 0.2906787
Validation loss decreased (0.235783 --> 0.228268).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 12 cost time: 0.8223555088043213
Epoch: 12, Steps: 64 | Train Loss: 0.0922785 Vali Loss: 0.2250616 Test Loss: 0.2912221
Validation loss decreased (0.228268 --> 0.225062).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 13 cost time: 0.8941965103149414
Epoch: 13, Steps: 64 | Train Loss: 0.0910613 Vali Loss: 0.2267867 Test Loss: 0.2875583
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 14 cost time: 0.8189985752105713
Epoch: 14, Steps: 64 | Train Loss: 0.0903482 Vali Loss: 0.2208983 Test Loss: 0.2897215
Validation loss decreased (0.225062 --> 0.220898).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 15 cost time: 0.8166215419769287
Epoch: 15, Steps: 64 | Train Loss: 0.0894623 Vali Loss: 0.2193322 Test Loss: 0.2872478
Validation loss decreased (0.220898 --> 0.219332).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 16 cost time: 0.8153493404388428
Epoch: 16, Steps: 64 | Train Loss: 0.0879739 Vali Loss: 0.2183624 Test Loss: 0.2864860
Validation loss decreased (0.219332 --> 0.218362).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 17 cost time: 0.8113360404968262
Epoch: 17, Steps: 64 | Train Loss: 0.0874954 Vali Loss: 0.2155671 Test Loss: 0.2870888
Validation loss decreased (0.218362 --> 0.215567).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 18 cost time: 0.8113696575164795
Epoch: 18, Steps: 64 | Train Loss: 0.0863325 Vali Loss: 0.2139157 Test Loss: 0.2877895
Validation loss decreased (0.215567 --> 0.213916).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 19 cost time: 0.8126325607299805
Epoch: 19, Steps: 64 | Train Loss: 0.0860375 Vali Loss: 0.2123167 Test Loss: 0.2873252
Validation loss decreased (0.213916 --> 0.212317).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 20 cost time: 0.8203604221343994
Epoch: 20, Steps: 64 | Train Loss: 0.0852897 Vali Loss: 0.2076092 Test Loss: 0.2868889
Validation loss decreased (0.212317 --> 0.207609).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 21 cost time: 0.8194143772125244
Epoch: 21, Steps: 64 | Train Loss: 0.0846714 Vali Loss: 0.2099465 Test Loss: 0.2863579
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 22 cost time: 0.8545622825622559
Epoch: 22, Steps: 64 | Train Loss: 0.0846590 Vali Loss: 0.2085945 Test Loss: 0.2840750
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 23 cost time: 0.8706214427947998
Epoch: 23, Steps: 64 | Train Loss: 0.0836664 Vali Loss: 0.2074737 Test Loss: 0.2850312
Validation loss decreased (0.207609 --> 0.207474).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 24 cost time: 0.8208096027374268
Epoch: 24, Steps: 64 | Train Loss: 0.0833011 Vali Loss: 0.2072810 Test Loss: 0.2862405
Validation loss decreased (0.207474 --> 0.207281).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 25 cost time: 0.8273181915283203
Epoch: 25, Steps: 64 | Train Loss: 0.0837708 Vali Loss: 0.2057461 Test Loss: 0.2843983
Validation loss decreased (0.207281 --> 0.205746).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 26 cost time: 0.8190391063690186
Epoch: 26, Steps: 64 | Train Loss: 0.0831571 Vali Loss: 0.2043381 Test Loss: 0.2838899
Validation loss decreased (0.205746 --> 0.204338).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 27 cost time: 0.816443681716919
Epoch: 27, Steps: 64 | Train Loss: 0.0824451 Vali Loss: 0.2041160 Test Loss: 0.2849091
Validation loss decreased (0.204338 --> 0.204116).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 28 cost time: 0.7990450859069824
Epoch: 28, Steps: 64 | Train Loss: 0.0819261 Vali Loss: 0.2044131 Test Loss: 0.2834072
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 29 cost time: 0.8266098499298096
Epoch: 29, Steps: 64 | Train Loss: 0.0820444 Vali Loss: 0.2013742 Test Loss: 0.2845451
Validation loss decreased (0.204116 --> 0.201374).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 30 cost time: 0.8781599998474121
Epoch: 30, Steps: 64 | Train Loss: 0.0818641 Vali Loss: 0.2037050 Test Loss: 0.2841069
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 31 cost time: 0.8311915397644043
Epoch: 31, Steps: 64 | Train Loss: 0.0820885 Vali Loss: 0.2032705 Test Loss: 0.2839476
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 32 cost time: 0.8222839832305908
Epoch: 32, Steps: 64 | Train Loss: 0.0818499 Vali Loss: 0.2062187 Test Loss: 0.2844180
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 33 cost time: 0.8220000267028809
Epoch: 33, Steps: 64 | Train Loss: 0.0817835 Vali Loss: 0.2035655 Test Loss: 0.2832362
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 34 cost time: 0.8114075660705566
Epoch: 34, Steps: 64 | Train Loss: 0.0816465 Vali Loss: 0.2005025 Test Loss: 0.2829556
Validation loss decreased (0.201374 --> 0.200503).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 35 cost time: 0.8194019794464111
Epoch: 35, Steps: 64 | Train Loss: 0.0812856 Vali Loss: 0.2023651 Test Loss: 0.2832395
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 36 cost time: 0.814777135848999
Epoch: 36, Steps: 64 | Train Loss: 0.0813668 Vali Loss: 0.2016040 Test Loss: 0.2829613
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 37 cost time: 0.8159997463226318
Epoch: 37, Steps: 64 | Train Loss: 0.0809004 Vali Loss: 0.2038219 Test Loss: 0.2828921
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 38 cost time: 0.8176290988922119
Epoch: 38, Steps: 64 | Train Loss: 0.0815168 Vali Loss: 0.2032243 Test Loss: 0.2826904
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 39 cost time: 0.8234398365020752
Epoch: 39, Steps: 64 | Train Loss: 0.0808404 Vali Loss: 0.2012426 Test Loss: 0.2819840
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 40 cost time: 0.8233695030212402
Epoch: 40, Steps: 64 | Train Loss: 0.0806699 Vali Loss: 0.1993220 Test Loss: 0.2822952
Validation loss decreased (0.200503 --> 0.199322).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 41 cost time: 0.8215210437774658
Epoch: 41, Steps: 64 | Train Loss: 0.0805584 Vali Loss: 0.2020116 Test Loss: 0.2827304
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 42 cost time: 0.8280000686645508
Epoch: 42, Steps: 64 | Train Loss: 0.0806249 Vali Loss: 0.2004651 Test Loss: 0.2823818
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 43 cost time: 0.8953673839569092
Epoch: 43, Steps: 64 | Train Loss: 0.0807872 Vali Loss: 0.1997228 Test Loss: 0.2828224
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 44 cost time: 0.8923850059509277
Epoch: 44, Steps: 64 | Train Loss: 0.0806858 Vali Loss: 0.1997130 Test Loss: 0.2828566
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 45 cost time: 0.8974409103393555
Epoch: 45, Steps: 64 | Train Loss: 0.0805966 Vali Loss: 0.1997640 Test Loss: 0.2829701
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 46 cost time: 0.8553342819213867
Epoch: 46, Steps: 64 | Train Loss: 0.0808777 Vali Loss: 0.1992457 Test Loss: 0.2835688
Validation loss decreased (0.199322 --> 0.199246).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 47 cost time: 0.815000057220459
Epoch: 47, Steps: 64 | Train Loss: 0.0797913 Vali Loss: 0.1997363 Test Loss: 0.2825759
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 48 cost time: 0.8136284351348877
Epoch: 48, Steps: 64 | Train Loss: 0.0803877 Vali Loss: 0.1981861 Test Loss: 0.2829857
Validation loss decreased (0.199246 --> 0.198186).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 49 cost time: 0.8204257488250732
Epoch: 49, Steps: 64 | Train Loss: 0.0807447 Vali Loss: 0.1995370 Test Loss: 0.2824980
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 50 cost time: 0.8201606273651123
Epoch: 50, Steps: 64 | Train Loss: 0.0807028 Vali Loss: 0.1989323 Test Loss: 0.2835002
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 51 cost time: 0.8198750019073486
Epoch: 51, Steps: 64 | Train Loss: 0.0803268 Vali Loss: 0.1988998 Test Loss: 0.2836190
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 52 cost time: 0.8219995498657227
Epoch: 52, Steps: 64 | Train Loss: 0.0806299 Vali Loss: 0.2003211 Test Loss: 0.2826306
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 53 cost time: 0.8124315738677979
Epoch: 53, Steps: 64 | Train Loss: 0.0805223 Vali Loss: 0.2025887 Test Loss: 0.2829674
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 54 cost time: 0.7830638885498047
Epoch: 54, Steps: 64 | Train Loss: 0.0807435 Vali Loss: 0.1992955 Test Loss: 0.2831637
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 55 cost time: 0.8164806365966797
Epoch: 55, Steps: 64 | Train Loss: 0.0806627 Vali Loss: 0.1998627 Test Loss: 0.2821043
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 56 cost time: 0.7824833393096924
Epoch: 56, Steps: 64 | Train Loss: 0.0807934 Vali Loss: 0.1998987 Test Loss: 0.2827672
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 57 cost time: 0.8166134357452393
Epoch: 57, Steps: 64 | Train Loss: 0.0801718 Vali Loss: 0.1979161 Test Loss: 0.2827455
Validation loss decreased (0.198186 --> 0.197916).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 58 cost time: 0.8243944644927979
Epoch: 58, Steps: 64 | Train Loss: 0.0805933 Vali Loss: 0.2007169 Test Loss: 0.2829270
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 59 cost time: 0.8243997097015381
Epoch: 59, Steps: 64 | Train Loss: 0.0804801 Vali Loss: 0.2023908 Test Loss: 0.2830042
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 60 cost time: 0.8204505443572998
Epoch: 60, Steps: 64 | Train Loss: 0.0803608 Vali Loss: 0.1997740 Test Loss: 0.2821640
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2827455401420593, mae:0.3454943299293518, rse:0.2440454363822937
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07010889053344727 GB
Epoch: 1 cost time: 2.348513126373291
Epoch: 1, Steps: 64 | Train Loss: 0.8177488 Vali Loss: 2.4459846 Test Loss: 4.2931204
Validation loss decreased (inf --> 2.445985).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 2 cost time: 0.9006116390228271
Epoch: 2, Steps: 64 | Train Loss: 0.3708622 Vali Loss: 0.2903645 Test Loss: 0.3029922
Validation loss decreased (2.445985 --> 0.290365).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 3 cost time: 0.9104194641113281
Epoch: 3, Steps: 64 | Train Loss: 0.1057288 Vali Loss: 0.2461383 Test Loss: 0.2866032
Validation loss decreased (0.290365 --> 0.246138).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 4 cost time: 0.9153897762298584
Epoch: 4, Steps: 64 | Train Loss: 0.0926378 Vali Loss: 0.2344619 Test Loss: 0.2743517
Validation loss decreased (0.246138 --> 0.234462).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 5 cost time: 0.9237685203552246
Epoch: 5, Steps: 64 | Train Loss: 0.0887950 Vali Loss: 0.2227582 Test Loss: 0.2760355
Validation loss decreased (0.234462 --> 0.222758).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 6 cost time: 0.9278385639190674
Epoch: 6, Steps: 64 | Train Loss: 0.0848138 Vali Loss: 0.2155976 Test Loss: 0.2780975
Validation loss decreased (0.222758 --> 0.215598).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 7 cost time: 0.9277195930480957
Epoch: 7, Steps: 64 | Train Loss: 0.0822179 Vali Loss: 0.2076794 Test Loss: 0.2740866
Validation loss decreased (0.215598 --> 0.207679).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 8 cost time: 0.9278366565704346
Epoch: 8, Steps: 64 | Train Loss: 0.0795016 Vali Loss: 0.2062591 Test Loss: 0.2730270
Validation loss decreased (0.207679 --> 0.206259).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 9 cost time: 0.9233016967773438
Epoch: 9, Steps: 64 | Train Loss: 0.0775906 Vali Loss: 0.2007877 Test Loss: 0.2749623
Validation loss decreased (0.206259 --> 0.200788).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 10 cost time: 0.939612865447998
Epoch: 10, Steps: 64 | Train Loss: 0.0762232 Vali Loss: 0.1985317 Test Loss: 0.2741802
Validation loss decreased (0.200788 --> 0.198532).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 11 cost time: 0.9447145462036133
Epoch: 11, Steps: 64 | Train Loss: 0.0749726 Vali Loss: 0.1952975 Test Loss: 0.2733790
Validation loss decreased (0.198532 --> 0.195298).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 12 cost time: 0.9964182376861572
Epoch: 12, Steps: 64 | Train Loss: 0.0738841 Vali Loss: 0.1919104 Test Loss: 0.2717243
Validation loss decreased (0.195298 --> 0.191910).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 13 cost time: 0.9369494915008545
Epoch: 13, Steps: 64 | Train Loss: 0.0727272 Vali Loss: 0.1890783 Test Loss: 0.2703237
Validation loss decreased (0.191910 --> 0.189078).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 14 cost time: 0.9293985366821289
Epoch: 14, Steps: 64 | Train Loss: 0.0723848 Vali Loss: 0.1862398 Test Loss: 0.2688132
Validation loss decreased (0.189078 --> 0.186240).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 15 cost time: 0.9294471740722656
Epoch: 15, Steps: 64 | Train Loss: 0.0715598 Vali Loss: 0.1880686 Test Loss: 0.2690287
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 16 cost time: 0.9278233051300049
Epoch: 16, Steps: 64 | Train Loss: 0.0710584 Vali Loss: 0.1849430 Test Loss: 0.2690199
Validation loss decreased (0.186240 --> 0.184943).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 17 cost time: 0.9234976768493652
Epoch: 17, Steps: 64 | Train Loss: 0.0704401 Vali Loss: 0.1873890 Test Loss: 0.2707000
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 18 cost time: 0.9428138732910156
Epoch: 18, Steps: 64 | Train Loss: 0.0698775 Vali Loss: 0.1850830 Test Loss: 0.2694963
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 19 cost time: 0.9325876235961914
Epoch: 19, Steps: 64 | Train Loss: 0.0698388 Vali Loss: 0.1859756 Test Loss: 0.2702706
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 20 cost time: 0.9346170425415039
Epoch: 20, Steps: 64 | Train Loss: 0.0695673 Vali Loss: 0.1837644 Test Loss: 0.2690394
Validation loss decreased (0.184943 --> 0.183764).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 21 cost time: 0.9361228942871094
Epoch: 21, Steps: 64 | Train Loss: 0.0697899 Vali Loss: 0.1843099 Test Loss: 0.2695471
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 22 cost time: 0.923346757888794
Epoch: 22, Steps: 64 | Train Loss: 0.0692297 Vali Loss: 0.1834863 Test Loss: 0.2680239
Validation loss decreased (0.183764 --> 0.183486).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 23 cost time: 0.921391487121582
Epoch: 23, Steps: 64 | Train Loss: 0.0688990 Vali Loss: 0.1837257 Test Loss: 0.2687048
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 24 cost time: 0.9233644008636475
Epoch: 24, Steps: 64 | Train Loss: 0.0688474 Vali Loss: 0.1821511 Test Loss: 0.2680701
Validation loss decreased (0.183486 --> 0.182151).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 25 cost time: 0.9277575016021729
Epoch: 25, Steps: 64 | Train Loss: 0.0686693 Vali Loss: 0.1819195 Test Loss: 0.2685301
Validation loss decreased (0.182151 --> 0.181919).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 26 cost time: 0.9273250102996826
Epoch: 26, Steps: 64 | Train Loss: 0.0683707 Vali Loss: 0.1814492 Test Loss: 0.2676358
Validation loss decreased (0.181919 --> 0.181449).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 27 cost time: 0.932999849319458
Epoch: 27, Steps: 64 | Train Loss: 0.0682370 Vali Loss: 0.1831525 Test Loss: 0.2683564
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 28 cost time: 0.9356307983398438
Epoch: 28, Steps: 64 | Train Loss: 0.0680109 Vali Loss: 0.1826024 Test Loss: 0.2680172
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 29 cost time: 0.9313015937805176
Epoch: 29, Steps: 64 | Train Loss: 0.0679616 Vali Loss: 0.1784230 Test Loss: 0.2680662
Validation loss decreased (0.181449 --> 0.178423).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 30 cost time: 0.9305951595306396
Epoch: 30, Steps: 64 | Train Loss: 0.0677132 Vali Loss: 0.1796636 Test Loss: 0.2681659
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 31 cost time: 0.9203765392303467
Epoch: 31, Steps: 64 | Train Loss: 0.0678725 Vali Loss: 0.1818426 Test Loss: 0.2685358
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 32 cost time: 0.9134044647216797
Epoch: 32, Steps: 64 | Train Loss: 0.0679084 Vali Loss: 0.1791401 Test Loss: 0.2685271
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 33 cost time: 0.9202654361724854
Epoch: 33, Steps: 64 | Train Loss: 0.0680382 Vali Loss: 0.1806749 Test Loss: 0.2689061
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 34 cost time: 0.9227209091186523
Epoch: 34, Steps: 64 | Train Loss: 0.0676902 Vali Loss: 0.1820301 Test Loss: 0.2680727
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 35 cost time: 0.9459998607635498
Epoch: 35, Steps: 64 | Train Loss: 0.0679017 Vali Loss: 0.1820724 Test Loss: 0.2678772
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 36 cost time: 0.9345426559448242
Epoch: 36, Steps: 64 | Train Loss: 0.0676500 Vali Loss: 0.1808171 Test Loss: 0.2679660
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 37 cost time: 0.9367494583129883
Epoch: 37, Steps: 64 | Train Loss: 0.0676396 Vali Loss: 0.1806504 Test Loss: 0.2682372
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 38 cost time: 0.941359281539917
Epoch: 38, Steps: 64 | Train Loss: 0.0674137 Vali Loss: 0.1806892 Test Loss: 0.2684498
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 39 cost time: 0.9390103816986084
Epoch: 39, Steps: 64 | Train Loss: 0.0680155 Vali Loss: 0.1800474 Test Loss: 0.2680765
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 40 cost time: 0.9234163761138916
Epoch: 40, Steps: 64 | Train Loss: 0.0675503 Vali Loss: 0.1797984 Test Loss: 0.2677898
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 41 cost time: 0.926459550857544
Epoch: 41, Steps: 64 | Train Loss: 0.0675308 Vali Loss: 0.1798741 Test Loss: 0.2677136
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 42 cost time: 0.9269566535949707
Epoch: 42, Steps: 64 | Train Loss: 0.0674376 Vali Loss: 0.1816512 Test Loss: 0.2683423
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 43 cost time: 0.9134750366210938
Epoch: 43, Steps: 64 | Train Loss: 0.0674981 Vali Loss: 0.1796125 Test Loss: 0.2679190
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 44 cost time: 0.9056246280670166
Epoch: 44, Steps: 64 | Train Loss: 0.0672995 Vali Loss: 0.1793814 Test Loss: 0.2680029
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 45 cost time: 0.9106147289276123
Epoch: 45, Steps: 64 | Train Loss: 0.0675111 Vali Loss: 0.1809248 Test Loss: 0.2678901
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 46 cost time: 0.8868653774261475
Epoch: 46, Steps: 64 | Train Loss: 0.0670317 Vali Loss: 0.1785316 Test Loss: 0.2681229
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 47 cost time: 0.9033455848693848
Epoch: 47, Steps: 64 | Train Loss: 0.0673918 Vali Loss: 0.1802210 Test Loss: 0.2681536
EarlyStopping counter: 18 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 48 cost time: 0.9040918350219727
Epoch: 48, Steps: 64 | Train Loss: 0.0675647 Vali Loss: 0.1802216 Test Loss: 0.2682813
EarlyStopping counter: 19 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 49 cost time: 0.8897106647491455
Epoch: 49, Steps: 64 | Train Loss: 0.0672273 Vali Loss: 0.1818391 Test Loss: 0.2683218
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 50 cost time: 0.9000000953674316
Epoch: 50, Steps: 64 | Train Loss: 0.0667679 Vali Loss: 0.1795539 Test Loss: 0.2682694
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 51 cost time: 0.9046218395233154
Epoch: 51, Steps: 64 | Train Loss: 0.0673128 Vali Loss: 0.1804826 Test Loss: 0.2680736
EarlyStopping counter: 22 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 52 cost time: 0.925506591796875
Epoch: 52, Steps: 64 | Train Loss: 0.0674108 Vali Loss: 0.1811211 Test Loss: 0.2683964
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 53 cost time: 0.9153525829315186
Epoch: 53, Steps: 64 | Train Loss: 0.0668089 Vali Loss: 0.1801070 Test Loss: 0.2684454
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 54 cost time: 0.9153835773468018
Epoch: 54, Steps: 64 | Train Loss: 0.0673615 Vali Loss: 0.1816105 Test Loss: 0.2680778
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 55 cost time: 0.9133973121643066
Epoch: 55, Steps: 64 | Train Loss: 0.0669929 Vali Loss: 0.1819882 Test Loss: 0.2680639
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 56 cost time: 0.919410228729248
Epoch: 56, Steps: 64 | Train Loss: 0.0671417 Vali Loss: 0.1790906 Test Loss: 0.2678670
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 57 cost time: 0.9030001163482666
Epoch: 57, Steps: 64 | Train Loss: 0.0674740 Vali Loss: 0.1780350 Test Loss: 0.2679053
Validation loss decreased (0.178423 --> 0.178035).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 58 cost time: 0.902000904083252
Epoch: 58, Steps: 64 | Train Loss: 0.0677027 Vali Loss: 0.1809949 Test Loss: 0.2678508
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 59 cost time: 0.910609245300293
Epoch: 59, Steps: 64 | Train Loss: 0.0674152 Vali Loss: 0.1807730 Test Loss: 0.2680750
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 60 cost time: 0.9111783504486084
Epoch: 60, Steps: 64 | Train Loss: 0.0668097 Vali Loss: 0.1799162 Test Loss: 0.2683468
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.26790517568588257, mae:0.337995707988739, rse:0.23755456507205963
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07322454452514648 GB
Epoch: 1 cost time: 2.2403337955474854
Epoch: 1, Steps: 64 | Train Loss: 0.8042777 Vali Loss: 2.4847531 Test Loss: 4.3120322
Validation loss decreased (inf --> 2.484753).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 2 cost time: 0.8810195922851562
Epoch: 2, Steps: 64 | Train Loss: 0.3203301 Vali Loss: 0.3768687 Test Loss: 0.4681084
Validation loss decreased (2.484753 --> 0.376869).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 3 cost time: 0.8638918399810791
Epoch: 3, Steps: 64 | Train Loss: 0.1014940 Vali Loss: 0.2376188 Test Loss: 0.2702512
Validation loss decreased (0.376869 --> 0.237619).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 4 cost time: 0.8786044120788574
Epoch: 4, Steps: 64 | Train Loss: 0.0897331 Vali Loss: 0.2277647 Test Loss: 0.2784755
Validation loss decreased (0.237619 --> 0.227765).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 5 cost time: 0.871999979019165
Epoch: 5, Steps: 64 | Train Loss: 0.0843222 Vali Loss: 0.2166138 Test Loss: 0.2759570
Validation loss decreased (0.227765 --> 0.216614).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 6 cost time: 0.8752317428588867
Epoch: 6, Steps: 64 | Train Loss: 0.0814701 Vali Loss: 0.2156579 Test Loss: 0.2725475
Validation loss decreased (0.216614 --> 0.215658).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 7 cost time: 0.8733675479888916
Epoch: 7, Steps: 64 | Train Loss: 0.0791146 Vali Loss: 0.2073451 Test Loss: 0.2760867
Validation loss decreased (0.215658 --> 0.207345).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 8 cost time: 0.8774569034576416
Epoch: 8, Steps: 64 | Train Loss: 0.0763882 Vali Loss: 0.2024144 Test Loss: 0.2750461
Validation loss decreased (0.207345 --> 0.202414).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 9 cost time: 0.876816987991333
Epoch: 9, Steps: 64 | Train Loss: 0.0750537 Vali Loss: 0.1951170 Test Loss: 0.2733170
Validation loss decreased (0.202414 --> 0.195117).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 10 cost time: 0.8724801540374756
Epoch: 10, Steps: 64 | Train Loss: 0.0735145 Vali Loss: 0.1921305 Test Loss: 0.2771003
Validation loss decreased (0.195117 --> 0.192131).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 11 cost time: 0.876000165939331
Epoch: 11, Steps: 64 | Train Loss: 0.0722284 Vali Loss: 0.1877630 Test Loss: 0.2719001
Validation loss decreased (0.192131 --> 0.187763).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 12 cost time: 0.8776254653930664
Epoch: 12, Steps: 64 | Train Loss: 0.0713659 Vali Loss: 0.1898908 Test Loss: 0.2699256
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 13 cost time: 0.8834969997406006
Epoch: 13, Steps: 64 | Train Loss: 0.0704205 Vali Loss: 0.1868722 Test Loss: 0.2712818
Validation loss decreased (0.187763 --> 0.186872).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 14 cost time: 0.8780114650726318
Epoch: 14, Steps: 64 | Train Loss: 0.0702318 Vali Loss: 0.1839581 Test Loss: 0.2719471
Validation loss decreased (0.186872 --> 0.183958).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 15 cost time: 0.876436710357666
Epoch: 15, Steps: 64 | Train Loss: 0.0692298 Vali Loss: 0.1832235 Test Loss: 0.2720973
Validation loss decreased (0.183958 --> 0.183223).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 16 cost time: 0.8738377094268799
Epoch: 16, Steps: 64 | Train Loss: 0.0688995 Vali Loss: 0.1804932 Test Loss: 0.2709175
Validation loss decreased (0.183223 --> 0.180493).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 17 cost time: 0.8723509311676025
Epoch: 17, Steps: 64 | Train Loss: 0.0688377 Vali Loss: 0.1837775 Test Loss: 0.2702283
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 18 cost time: 0.8746180534362793
Epoch: 18, Steps: 64 | Train Loss: 0.0689725 Vali Loss: 0.1790052 Test Loss: 0.2727051
Validation loss decreased (0.180493 --> 0.179005).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 19 cost time: 0.873237133026123
Epoch: 19, Steps: 64 | Train Loss: 0.0680126 Vali Loss: 0.1805169 Test Loss: 0.2715483
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 20 cost time: 0.8803439140319824
Epoch: 20, Steps: 64 | Train Loss: 0.0676082 Vali Loss: 0.1824850 Test Loss: 0.2724738
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 21 cost time: 0.8817241191864014
Epoch: 21, Steps: 64 | Train Loss: 0.0676822 Vali Loss: 0.1801400 Test Loss: 0.2687242
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 22 cost time: 0.8747274875640869
Epoch: 22, Steps: 64 | Train Loss: 0.0673702 Vali Loss: 0.1793361 Test Loss: 0.2706850
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 23 cost time: 0.871457576751709
Epoch: 23, Steps: 64 | Train Loss: 0.0672420 Vali Loss: 0.1804829 Test Loss: 0.2707440
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 24 cost time: 0.8876338005065918
Epoch: 24, Steps: 64 | Train Loss: 0.0669954 Vali Loss: 0.1801592 Test Loss: 0.2696097
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 25 cost time: 0.8799290657043457
Epoch: 25, Steps: 64 | Train Loss: 0.0669097 Vali Loss: 0.1789513 Test Loss: 0.2702110
Validation loss decreased (0.179005 --> 0.178951).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 26 cost time: 0.8754069805145264
Epoch: 26, Steps: 64 | Train Loss: 0.0667996 Vali Loss: 0.1777944 Test Loss: 0.2706764
Validation loss decreased (0.178951 --> 0.177794).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 27 cost time: 0.8759944438934326
Epoch: 27, Steps: 64 | Train Loss: 0.0665890 Vali Loss: 0.1771920 Test Loss: 0.2717615
Validation loss decreased (0.177794 --> 0.177192).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 28 cost time: 0.8607344627380371
Epoch: 28, Steps: 64 | Train Loss: 0.0666286 Vali Loss: 0.1795727 Test Loss: 0.2706774
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 29 cost time: 0.8779995441436768
Epoch: 29, Steps: 64 | Train Loss: 0.0667733 Vali Loss: 0.1806976 Test Loss: 0.2714092
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 30 cost time: 0.8686256408691406
Epoch: 30, Steps: 64 | Train Loss: 0.0663035 Vali Loss: 0.1802735 Test Loss: 0.2706904
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 31 cost time: 0.8794677257537842
Epoch: 31, Steps: 64 | Train Loss: 0.0664545 Vali Loss: 0.1783188 Test Loss: 0.2705282
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 32 cost time: 0.8794896602630615
Epoch: 32, Steps: 64 | Train Loss: 0.0665682 Vali Loss: 0.1775193 Test Loss: 0.2704044
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 33 cost time: 0.8764750957489014
Epoch: 33, Steps: 64 | Train Loss: 0.0662185 Vali Loss: 0.1775441 Test Loss: 0.2708532
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 34 cost time: 0.8737785816192627
Epoch: 34, Steps: 64 | Train Loss: 0.0660541 Vali Loss: 0.1808572 Test Loss: 0.2706207
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 35 cost time: 0.868999719619751
Epoch: 35, Steps: 64 | Train Loss: 0.0663891 Vali Loss: 0.1769544 Test Loss: 0.2704315
Validation loss decreased (0.177192 --> 0.176954).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 36 cost time: 0.8746142387390137
Epoch: 36, Steps: 64 | Train Loss: 0.0658397 Vali Loss: 0.1810401 Test Loss: 0.2709825
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 37 cost time: 0.8774311542510986
Epoch: 37, Steps: 64 | Train Loss: 0.0663129 Vali Loss: 0.1769777 Test Loss: 0.2699019
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 38 cost time: 0.8843529224395752
Epoch: 38, Steps: 64 | Train Loss: 0.0656693 Vali Loss: 0.1767464 Test Loss: 0.2705654
Validation loss decreased (0.176954 --> 0.176746).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 39 cost time: 0.8823873996734619
Epoch: 39, Steps: 64 | Train Loss: 0.0659541 Vali Loss: 0.1788942 Test Loss: 0.2699384
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 40 cost time: 0.8747673034667969
Epoch: 40, Steps: 64 | Train Loss: 0.0656412 Vali Loss: 0.1787426 Test Loss: 0.2709398
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 41 cost time: 0.8773324489593506
Epoch: 41, Steps: 64 | Train Loss: 0.0658156 Vali Loss: 0.1777864 Test Loss: 0.2708112
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 42 cost time: 0.8840000629425049
Epoch: 42, Steps: 64 | Train Loss: 0.0656994 Vali Loss: 0.1765591 Test Loss: 0.2708014
Validation loss decreased (0.176746 --> 0.176559).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 43 cost time: 0.87762451171875
Epoch: 43, Steps: 64 | Train Loss: 0.0660095 Vali Loss: 0.1784482 Test Loss: 0.2705974
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 44 cost time: 0.8794846534729004
Epoch: 44, Steps: 64 | Train Loss: 0.0656866 Vali Loss: 0.1797955 Test Loss: 0.2718497
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 45 cost time: 0.8773660659790039
Epoch: 45, Steps: 64 | Train Loss: 0.0657863 Vali Loss: 0.1780671 Test Loss: 0.2709096
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 46 cost time: 0.8778584003448486
Epoch: 46, Steps: 64 | Train Loss: 0.0659228 Vali Loss: 0.1773665 Test Loss: 0.2718932
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 47 cost time: 0.8788247108459473
Epoch: 47, Steps: 64 | Train Loss: 0.0663887 Vali Loss: 0.1788068 Test Loss: 0.2708930
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 48 cost time: 0.874997615814209
Epoch: 48, Steps: 64 | Train Loss: 0.0656500 Vali Loss: 0.1769480 Test Loss: 0.2705649
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 49 cost time: 0.8646035194396973
Epoch: 49, Steps: 64 | Train Loss: 0.0656113 Vali Loss: 0.1783744 Test Loss: 0.2713806
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 50 cost time: 0.841484546661377
Epoch: 50, Steps: 64 | Train Loss: 0.0658335 Vali Loss: 0.1795611 Test Loss: 0.2709235
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 51 cost time: 0.8756368160247803
Epoch: 51, Steps: 64 | Train Loss: 0.0657653 Vali Loss: 0.1793604 Test Loss: 0.2711697
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 52 cost time: 0.8743672370910645
Epoch: 52, Steps: 64 | Train Loss: 0.0658697 Vali Loss: 0.1804424 Test Loss: 0.2711875
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 53 cost time: 0.8619997501373291
Epoch: 53, Steps: 64 | Train Loss: 0.0658370 Vali Loss: 0.1754002 Test Loss: 0.2706216
Validation loss decreased (0.176559 --> 0.175400).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 54 cost time: 0.8747820854187012
Epoch: 54, Steps: 64 | Train Loss: 0.0662417 Vali Loss: 0.1779065 Test Loss: 0.2708645
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 55 cost time: 0.884619951248169
Epoch: 55, Steps: 64 | Train Loss: 0.0657103 Vali Loss: 0.1775960 Test Loss: 0.2712092
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 56 cost time: 0.882392168045044
Epoch: 56, Steps: 64 | Train Loss: 0.0658808 Vali Loss: 0.1787444 Test Loss: 0.2719370
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 57 cost time: 0.8694274425506592
Epoch: 57, Steps: 64 | Train Loss: 0.0659709 Vali Loss: 0.1776602 Test Loss: 0.2701165
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 58 cost time: 0.8718173503875732
Epoch: 58, Steps: 64 | Train Loss: 0.0661353 Vali Loss: 0.1789583 Test Loss: 0.2705702
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 59 cost time: 0.8734836578369141
Epoch: 59, Steps: 64 | Train Loss: 0.0660677 Vali Loss: 0.1761572 Test Loss: 0.2703452
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 60 cost time: 0.8749997615814209
Epoch: 60, Steps: 64 | Train Loss: 0.0658357 Vali Loss: 0.1777362 Test Loss: 0.2706853
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2706215977668762, mae:0.3429102897644043, rse:0.23875583708286285
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.06599807739257812 GB
Epoch: 1 cost time: 2.291827440261841
Epoch: 1, Steps: 64 | Train Loss: 1.0779637 Vali Loss: 3.1205285 Test Loss: 5.6278253
Validation loss decreased (inf --> 3.120528).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 2 cost time: 0.8909509181976318
Epoch: 2, Steps: 64 | Train Loss: 0.6860401 Vali Loss: 1.2136981 Test Loss: 2.0484476
Validation loss decreased (3.120528 --> 1.213698).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 3 cost time: 0.9003341197967529
Epoch: 3, Steps: 64 | Train Loss: 0.3467595 Vali Loss: 0.7243417 Test Loss: 1.1556967
Validation loss decreased (1.213698 --> 0.724342).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 4 cost time: 0.8990480899810791
Epoch: 4, Steps: 64 | Train Loss: 0.2232781 Vali Loss: 0.4884501 Test Loss: 0.7335085
Validation loss decreased (0.724342 --> 0.488450).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 5 cost time: 0.9205505847930908
Epoch: 5, Steps: 64 | Train Loss: 0.1587247 Vali Loss: 0.3706129 Test Loss: 0.5307236
Validation loss decreased (0.488450 --> 0.370613).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 6 cost time: 0.872999906539917
Epoch: 6, Steps: 64 | Train Loss: 0.1284293 Vali Loss: 0.3076471 Test Loss: 0.4215565
Validation loss decreased (0.370613 --> 0.307647).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 7 cost time: 0.8756177425384521
Epoch: 7, Steps: 64 | Train Loss: 0.1133252 Vali Loss: 0.2769344 Test Loss: 0.3656359
Validation loss decreased (0.307647 --> 0.276934).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 8 cost time: 0.877126932144165
Epoch: 8, Steps: 64 | Train Loss: 0.1035896 Vali Loss: 0.2570654 Test Loss: 0.3375108
Validation loss decreased (0.276934 --> 0.257065).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 9 cost time: 0.8756468296051025
Epoch: 9, Steps: 64 | Train Loss: 0.0994123 Vali Loss: 0.2476114 Test Loss: 0.3225130
Validation loss decreased (0.257065 --> 0.247611).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 10 cost time: 0.8913450241088867
Epoch: 10, Steps: 64 | Train Loss: 0.0966820 Vali Loss: 0.2349770 Test Loss: 0.3097634
Validation loss decreased (0.247611 --> 0.234977).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 11 cost time: 0.8894016742706299
Epoch: 11, Steps: 64 | Train Loss: 0.0940760 Vali Loss: 0.2310208 Test Loss: 0.3050593
Validation loss decreased (0.234977 --> 0.231021).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 12 cost time: 0.8937466144561768
Epoch: 12, Steps: 64 | Train Loss: 0.0917796 Vali Loss: 0.2210590 Test Loss: 0.2972039
Validation loss decreased (0.231021 --> 0.221059).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 13 cost time: 0.8906078338623047
Epoch: 13, Steps: 64 | Train Loss: 0.0907750 Vali Loss: 0.2230024 Test Loss: 0.2966932
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 14 cost time: 0.9009742736816406
Epoch: 14, Steps: 64 | Train Loss: 0.0895484 Vali Loss: 0.2225903 Test Loss: 0.2935070
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 15 cost time: 0.8843209743499756
Epoch: 15, Steps: 64 | Train Loss: 0.0880060 Vali Loss: 0.2160050 Test Loss: 0.2925744
Validation loss decreased (0.221059 --> 0.216005).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 16 cost time: 0.8840181827545166
Epoch: 16, Steps: 64 | Train Loss: 0.0878129 Vali Loss: 0.2166259 Test Loss: 0.2926137
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 17 cost time: 0.8774797916412354
Epoch: 17, Steps: 64 | Train Loss: 0.0870095 Vali Loss: 0.2170639 Test Loss: 0.2909938
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 18 cost time: 0.8770370483398438
Epoch: 18, Steps: 64 | Train Loss: 0.0868815 Vali Loss: 0.2140324 Test Loss: 0.2903650
Validation loss decreased (0.216005 --> 0.214032).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 19 cost time: 0.8880000114440918
Epoch: 19, Steps: 64 | Train Loss: 0.0861263 Vali Loss: 0.2152544 Test Loss: 0.2889980
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 20 cost time: 0.8846185207366943
Epoch: 20, Steps: 64 | Train Loss: 0.0855200 Vali Loss: 0.2121793 Test Loss: 0.2890715
Validation loss decreased (0.214032 --> 0.212179).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 21 cost time: 0.896334171295166
Epoch: 21, Steps: 64 | Train Loss: 0.0847078 Vali Loss: 0.2103509 Test Loss: 0.2882490
Validation loss decreased (0.212179 --> 0.210351).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 22 cost time: 0.8848011493682861
Epoch: 22, Steps: 64 | Train Loss: 0.0849658 Vali Loss: 0.2087811 Test Loss: 0.2873803
Validation loss decreased (0.210351 --> 0.208781).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 23 cost time: 0.8773813247680664
Epoch: 23, Steps: 64 | Train Loss: 0.0841914 Vali Loss: 0.2108861 Test Loss: 0.2882259
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 24 cost time: 0.8777415752410889
Epoch: 24, Steps: 64 | Train Loss: 0.0838832 Vali Loss: 0.2072841 Test Loss: 0.2871960
Validation loss decreased (0.208781 --> 0.207284).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 25 cost time: 0.8729996681213379
Epoch: 25, Steps: 64 | Train Loss: 0.0837974 Vali Loss: 0.2051887 Test Loss: 0.2867468
Validation loss decreased (0.207284 --> 0.205189).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 26 cost time: 0.8716170787811279
Epoch: 26, Steps: 64 | Train Loss: 0.0836965 Vali Loss: 0.2064325 Test Loss: 0.2857763
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 27 cost time: 0.879237174987793
Epoch: 27, Steps: 64 | Train Loss: 0.0832601 Vali Loss: 0.2079279 Test Loss: 0.2852311
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 28 cost time: 0.8984136581420898
Epoch: 28, Steps: 64 | Train Loss: 0.0833227 Vali Loss: 0.2069443 Test Loss: 0.2870066
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 29 cost time: 0.8853461742401123
Epoch: 29, Steps: 64 | Train Loss: 0.0829937 Vali Loss: 0.2049078 Test Loss: 0.2861882
Validation loss decreased (0.205189 --> 0.204908).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 30 cost time: 0.8817753791809082
Epoch: 30, Steps: 64 | Train Loss: 0.0820774 Vali Loss: 0.2085373 Test Loss: 0.2867109
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 31 cost time: 0.8884363174438477
Epoch: 31, Steps: 64 | Train Loss: 0.0825759 Vali Loss: 0.2032268 Test Loss: 0.2869332
Validation loss decreased (0.204908 --> 0.203227).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 32 cost time: 0.8596210479736328
Epoch: 32, Steps: 64 | Train Loss: 0.0826922 Vali Loss: 0.2043143 Test Loss: 0.2865232
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 33 cost time: 0.8733792304992676
Epoch: 33, Steps: 64 | Train Loss: 0.0822043 Vali Loss: 0.2032979 Test Loss: 0.2857273
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 34 cost time: 0.8758063316345215
Epoch: 34, Steps: 64 | Train Loss: 0.0820910 Vali Loss: 0.2040919 Test Loss: 0.2852395
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 35 cost time: 0.8774120807647705
Epoch: 35, Steps: 64 | Train Loss: 0.0818279 Vali Loss: 0.2043891 Test Loss: 0.2860226
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 36 cost time: 0.8818342685699463
Epoch: 36, Steps: 64 | Train Loss: 0.0822574 Vali Loss: 0.2033574 Test Loss: 0.2854535
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 37 cost time: 0.886998176574707
Epoch: 37, Steps: 64 | Train Loss: 0.0819648 Vali Loss: 0.2006124 Test Loss: 0.2854154
Validation loss decreased (0.203227 --> 0.200612).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 38 cost time: 0.8856208324432373
Epoch: 38, Steps: 64 | Train Loss: 0.0817029 Vali Loss: 0.2030487 Test Loss: 0.2851675
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 39 cost time: 0.8943758010864258
Epoch: 39, Steps: 64 | Train Loss: 0.0816932 Vali Loss: 0.2017903 Test Loss: 0.2851756
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 40 cost time: 0.8863425254821777
Epoch: 40, Steps: 64 | Train Loss: 0.0817437 Vali Loss: 0.2022556 Test Loss: 0.2849112
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 41 cost time: 0.8789372444152832
Epoch: 41, Steps: 64 | Train Loss: 0.0815034 Vali Loss: 0.2003089 Test Loss: 0.2855675
Validation loss decreased (0.200612 --> 0.200309).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 42 cost time: 0.890408992767334
Epoch: 42, Steps: 64 | Train Loss: 0.0822521 Vali Loss: 0.2014786 Test Loss: 0.2854157
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 43 cost time: 0.885319709777832
Epoch: 43, Steps: 64 | Train Loss: 0.0815822 Vali Loss: 0.2033687 Test Loss: 0.2848182
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 44 cost time: 0.9016005992889404
Epoch: 44, Steps: 64 | Train Loss: 0.0813421 Vali Loss: 0.2024425 Test Loss: 0.2859424
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 45 cost time: 0.912367582321167
Epoch: 45, Steps: 64 | Train Loss: 0.0811618 Vali Loss: 0.2034641 Test Loss: 0.2857294
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 46 cost time: 0.9012420177459717
Epoch: 46, Steps: 64 | Train Loss: 0.0811944 Vali Loss: 0.2013618 Test Loss: 0.2854864
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 47 cost time: 0.8847699165344238
Epoch: 47, Steps: 64 | Train Loss: 0.0812330 Vali Loss: 0.2036715 Test Loss: 0.2847247
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 48 cost time: 0.8934328556060791
Epoch: 48, Steps: 64 | Train Loss: 0.0809189 Vali Loss: 0.2031260 Test Loss: 0.2855062
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 49 cost time: 0.8937835693359375
Epoch: 49, Steps: 64 | Train Loss: 0.0815614 Vali Loss: 0.2014763 Test Loss: 0.2864051
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 50 cost time: 0.8933684825897217
Epoch: 50, Steps: 64 | Train Loss: 0.0814263 Vali Loss: 0.2020643 Test Loss: 0.2856544
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 51 cost time: 0.8786158561706543
Epoch: 51, Steps: 64 | Train Loss: 0.0806623 Vali Loss: 0.2026103 Test Loss: 0.2847559
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 52 cost time: 0.881380558013916
Epoch: 52, Steps: 64 | Train Loss: 0.0813934 Vali Loss: 0.2043113 Test Loss: 0.2855202
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 53 cost time: 0.8813395500183105
Epoch: 53, Steps: 64 | Train Loss: 0.0811851 Vali Loss: 0.2008204 Test Loss: 0.2859090
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 54 cost time: 0.8838202953338623
Epoch: 54, Steps: 64 | Train Loss: 0.0810264 Vali Loss: 0.2025507 Test Loss: 0.2858536
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 55 cost time: 0.888746976852417
Epoch: 55, Steps: 64 | Train Loss: 0.0815519 Vali Loss: 0.2015846 Test Loss: 0.2863438
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 56 cost time: 0.8849999904632568
Epoch: 56, Steps: 64 | Train Loss: 0.0806802 Vali Loss: 0.2022927 Test Loss: 0.2847494
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 57 cost time: 0.8976278305053711
Epoch: 57, Steps: 64 | Train Loss: 0.0810975 Vali Loss: 0.2008581 Test Loss: 0.2846387
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 58 cost time: 0.8883414268493652
Epoch: 58, Steps: 64 | Train Loss: 0.0813019 Vali Loss: 0.2002032 Test Loss: 0.2861585
Validation loss decreased (0.200309 --> 0.200203).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 59 cost time: 0.8861527442932129
Epoch: 59, Steps: 64 | Train Loss: 0.0812042 Vali Loss: 0.1997279 Test Loss: 0.2848870
Validation loss decreased (0.200203 --> 0.199728).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 60 cost time: 0.8925018310546875
Epoch: 60, Steps: 64 | Train Loss: 0.0812555 Vali Loss: 0.2011148 Test Loss: 0.2846167
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2848869860172272, mae:0.35105976462364197, rse:0.24496783316135406
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.07027053833007812 GB
Epoch: 1 cost time: 2.27728271484375
Epoch: 1, Steps: 64 | Train Loss: 0.8649011 Vali Loss: 2.5793457 Test Loss: 4.5767412
Validation loss decreased (inf --> 2.579346).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 2 cost time: 0.8576183319091797
Epoch: 2, Steps: 64 | Train Loss: 0.3666303 Vali Loss: 0.2643176 Test Loss: 0.3060152
Validation loss decreased (2.579346 --> 0.264318).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 3 cost time: 0.8590002059936523
Epoch: 3, Steps: 64 | Train Loss: 0.1025277 Vali Loss: 0.2503839 Test Loss: 0.3018462
Validation loss decreased (0.264318 --> 0.250384).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 4 cost time: 0.8590002059936523
Epoch: 4, Steps: 64 | Train Loss: 0.0920712 Vali Loss: 0.2320343 Test Loss: 0.2819978
Validation loss decreased (0.250384 --> 0.232034).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 5 cost time: 0.8909835815429688
Epoch: 5, Steps: 64 | Train Loss: 0.0874633 Vali Loss: 0.2262065 Test Loss: 0.2846231
Validation loss decreased (0.232034 --> 0.226206).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 6 cost time: 0.8528602123260498
Epoch: 6, Steps: 64 | Train Loss: 0.0851697 Vali Loss: 0.2218859 Test Loss: 0.2840615
Validation loss decreased (0.226206 --> 0.221886).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 7 cost time: 0.8507497310638428
Epoch: 7, Steps: 64 | Train Loss: 0.0820126 Vali Loss: 0.2135117 Test Loss: 0.2833915
Validation loss decreased (0.221886 --> 0.213512).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 8 cost time: 0.8480000495910645
Epoch: 8, Steps: 64 | Train Loss: 0.0807637 Vali Loss: 0.2081447 Test Loss: 0.2803939
Validation loss decreased (0.213512 --> 0.208145).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 9 cost time: 0.848461389541626
Epoch: 9, Steps: 64 | Train Loss: 0.0794791 Vali Loss: 0.2075445 Test Loss: 0.2809997
Validation loss decreased (0.208145 --> 0.207544).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 10 cost time: 0.8613848686218262
Epoch: 10, Steps: 64 | Train Loss: 0.0782408 Vali Loss: 0.2036339 Test Loss: 0.2808006
Validation loss decreased (0.207544 --> 0.203634).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 11 cost time: 0.8593873977661133
Epoch: 11, Steps: 64 | Train Loss: 0.0769099 Vali Loss: 0.2007831 Test Loss: 0.2821142
Validation loss decreased (0.203634 --> 0.200783).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 12 cost time: 0.8578498363494873
Epoch: 12, Steps: 64 | Train Loss: 0.0759085 Vali Loss: 0.1996287 Test Loss: 0.2793889
Validation loss decreased (0.200783 --> 0.199629).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 13 cost time: 0.8567512035369873
Epoch: 13, Steps: 64 | Train Loss: 0.0745365 Vali Loss: 0.1987618 Test Loss: 0.2812235
Validation loss decreased (0.199629 --> 0.198762).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 14 cost time: 0.8540005683898926
Epoch: 14, Steps: 64 | Train Loss: 0.0739517 Vali Loss: 0.1939380 Test Loss: 0.2796167
Validation loss decreased (0.198762 --> 0.193938).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 15 cost time: 0.8675267696380615
Epoch: 15, Steps: 64 | Train Loss: 0.0731459 Vali Loss: 0.1940727 Test Loss: 0.2778420
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 16 cost time: 0.8642065525054932
Epoch: 16, Steps: 64 | Train Loss: 0.0728011 Vali Loss: 0.1918042 Test Loss: 0.2780038
Validation loss decreased (0.193938 --> 0.191804).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 17 cost time: 0.8526217937469482
Epoch: 17, Steps: 64 | Train Loss: 0.0718419 Vali Loss: 0.1899747 Test Loss: 0.2778637
Validation loss decreased (0.191804 --> 0.189975).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 18 cost time: 0.8568878173828125
Epoch: 18, Steps: 64 | Train Loss: 0.0715559 Vali Loss: 0.1894873 Test Loss: 0.2776545
Validation loss decreased (0.189975 --> 0.189487).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 19 cost time: 0.8579998016357422
Epoch: 19, Steps: 64 | Train Loss: 0.0712813 Vali Loss: 0.1874222 Test Loss: 0.2751543
Validation loss decreased (0.189487 --> 0.187422).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 20 cost time: 0.863624095916748
Epoch: 20, Steps: 64 | Train Loss: 0.0706678 Vali Loss: 0.1900411 Test Loss: 0.2756873
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 21 cost time: 0.8634421825408936
Epoch: 21, Steps: 64 | Train Loss: 0.0703721 Vali Loss: 0.1881087 Test Loss: 0.2744090
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 22 cost time: 0.8724560737609863
Epoch: 22, Steps: 64 | Train Loss: 0.0702809 Vali Loss: 0.1867400 Test Loss: 0.2739416
Validation loss decreased (0.187422 --> 0.186740).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 23 cost time: 0.8581192493438721
Epoch: 23, Steps: 64 | Train Loss: 0.0694884 Vali Loss: 0.1883060 Test Loss: 0.2742254
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 24 cost time: 0.8568375110626221
Epoch: 24, Steps: 64 | Train Loss: 0.0696912 Vali Loss: 0.1847274 Test Loss: 0.2741121
Validation loss decreased (0.186740 --> 0.184727).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 25 cost time: 0.8528256416320801
Epoch: 25, Steps: 64 | Train Loss: 0.0695284 Vali Loss: 0.1852124 Test Loss: 0.2729189
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 26 cost time: 0.8276112079620361
Epoch: 26, Steps: 64 | Train Loss: 0.0694612 Vali Loss: 0.1839188 Test Loss: 0.2717355
Validation loss decreased (0.184727 --> 0.183919).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 27 cost time: 0.8136072158813477
Epoch: 27, Steps: 64 | Train Loss: 0.0692670 Vali Loss: 0.1850806 Test Loss: 0.2735721
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 28 cost time: 0.8657417297363281
Epoch: 28, Steps: 64 | Train Loss: 0.0691859 Vali Loss: 0.1849504 Test Loss: 0.2733406
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 29 cost time: 0.8656516075134277
Epoch: 29, Steps: 64 | Train Loss: 0.0690240 Vali Loss: 0.1829604 Test Loss: 0.2730302
Validation loss decreased (0.183919 --> 0.182960).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 30 cost time: 0.8220903873443604
Epoch: 30, Steps: 64 | Train Loss: 0.0688803 Vali Loss: 0.1839833 Test Loss: 0.2723831
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 31 cost time: 0.8235642910003662
Epoch: 31, Steps: 64 | Train Loss: 0.0687037 Vali Loss: 0.1837541 Test Loss: 0.2724505
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 32 cost time: 0.8073623180389404
Epoch: 32, Steps: 64 | Train Loss: 0.0688716 Vali Loss: 0.1846783 Test Loss: 0.2723184
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 33 cost time: 0.8525235652923584
Epoch: 33, Steps: 64 | Train Loss: 0.0685577 Vali Loss: 0.1837362 Test Loss: 0.2721591
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 34 cost time: 0.8597989082336426
Epoch: 34, Steps: 64 | Train Loss: 0.0685256 Vali Loss: 0.1817498 Test Loss: 0.2723013
Validation loss decreased (0.182960 --> 0.181750).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 35 cost time: 0.8539998531341553
Epoch: 35, Steps: 64 | Train Loss: 0.0683510 Vali Loss: 0.1848629 Test Loss: 0.2722012
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 36 cost time: 0.8566310405731201
Epoch: 36, Steps: 64 | Train Loss: 0.0681803 Vali Loss: 0.1824766 Test Loss: 0.2714300
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 37 cost time: 0.8613061904907227
Epoch: 37, Steps: 64 | Train Loss: 0.0684408 Vali Loss: 0.1841723 Test Loss: 0.2714946
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 38 cost time: 0.8563680648803711
Epoch: 38, Steps: 64 | Train Loss: 0.0680525 Vali Loss: 0.1831248 Test Loss: 0.2719164
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 39 cost time: 0.8583347797393799
Epoch: 39, Steps: 64 | Train Loss: 0.0681826 Vali Loss: 0.1838903 Test Loss: 0.2712171
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 40 cost time: 0.8587870597839355
Epoch: 40, Steps: 64 | Train Loss: 0.0682314 Vali Loss: 0.1865869 Test Loss: 0.2715598
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 41 cost time: 0.8574824333190918
Epoch: 41, Steps: 64 | Train Loss: 0.0680226 Vali Loss: 0.1828435 Test Loss: 0.2712364
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 42 cost time: 0.8566248416900635
Epoch: 42, Steps: 64 | Train Loss: 0.0681860 Vali Loss: 0.1836681 Test Loss: 0.2714179
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 43 cost time: 0.8463618755340576
Epoch: 43, Steps: 64 | Train Loss: 0.0677599 Vali Loss: 0.1835557 Test Loss: 0.2717087
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 44 cost time: 0.8689534664154053
Epoch: 44, Steps: 64 | Train Loss: 0.0677399 Vali Loss: 0.1818056 Test Loss: 0.2710059
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 45 cost time: 0.862762451171875
Epoch: 45, Steps: 64 | Train Loss: 0.0680063 Vali Loss: 0.1828573 Test Loss: 0.2717068
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 46 cost time: 0.8587498664855957
Epoch: 46, Steps: 64 | Train Loss: 0.0680809 Vali Loss: 0.1815678 Test Loss: 0.2719817
Validation loss decreased (0.181750 --> 0.181568).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 47 cost time: 0.8566141128540039
Epoch: 47, Steps: 64 | Train Loss: 0.0675933 Vali Loss: 0.1835645 Test Loss: 0.2711892
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 48 cost time: 0.8683581352233887
Epoch: 48, Steps: 64 | Train Loss: 0.0680297 Vali Loss: 0.1841325 Test Loss: 0.2715415
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 49 cost time: 0.8573939800262451
Epoch: 49, Steps: 64 | Train Loss: 0.0680931 Vali Loss: 0.1819247 Test Loss: 0.2715690
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 50 cost time: 0.8533351421356201
Epoch: 50, Steps: 64 | Train Loss: 0.0679659 Vali Loss: 0.1823358 Test Loss: 0.2714944
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 51 cost time: 0.8572242259979248
Epoch: 51, Steps: 64 | Train Loss: 0.0678093 Vali Loss: 0.1831911 Test Loss: 0.2715021
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 52 cost time: 0.8490028381347656
Epoch: 52, Steps: 64 | Train Loss: 0.0675609 Vali Loss: 0.1838993 Test Loss: 0.2714367
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 53 cost time: 0.8486218452453613
Epoch: 53, Steps: 64 | Train Loss: 0.0680108 Vali Loss: 0.1791749 Test Loss: 0.2715140
Validation loss decreased (0.181568 --> 0.179175).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 54 cost time: 0.8583550453186035
Epoch: 54, Steps: 64 | Train Loss: 0.0681295 Vali Loss: 0.1827012 Test Loss: 0.2714575
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 55 cost time: 0.8553287982940674
Epoch: 55, Steps: 64 | Train Loss: 0.0679271 Vali Loss: 0.1834013 Test Loss: 0.2717418
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 56 cost time: 0.8522651195526123
Epoch: 56, Steps: 64 | Train Loss: 0.0681433 Vali Loss: 0.1845858 Test Loss: 0.2718343
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 57 cost time: 0.8489997386932373
Epoch: 57, Steps: 64 | Train Loss: 0.0681114 Vali Loss: 0.1820338 Test Loss: 0.2713998
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 58 cost time: 0.8536405563354492
Epoch: 58, Steps: 64 | Train Loss: 0.0678263 Vali Loss: 0.1830715 Test Loss: 0.2712138
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 59 cost time: 0.8323788642883301
Epoch: 59, Steps: 64 | Train Loss: 0.0677811 Vali Loss: 0.1815071 Test Loss: 0.2713928
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 60 cost time: 0.8460249900817871
Epoch: 60, Steps: 64 | Train Loss: 0.0673899 Vali Loss: 0.1822031 Test Loss: 0.2711473
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.27151408791542053, mae:0.3418980538845062, rse:0.23914921283721924
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07338619232177734 GB
Epoch: 1 cost time: 2.334078073501587
Epoch: 1, Steps: 64 | Train Loss: 0.8053811 Vali Loss: 2.4565580 Test Loss: 4.3285756
Validation loss decreased (inf --> 2.456558).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 2 cost time: 0.9724814891815186
Epoch: 2, Steps: 64 | Train Loss: 0.3056840 Vali Loss: 0.3234351 Test Loss: 0.4126485
Validation loss decreased (2.456558 --> 0.323435).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 3 cost time: 0.9697403907775879
Epoch: 3, Steps: 64 | Train Loss: 0.0991206 Vali Loss: 0.2415235 Test Loss: 0.2789543
Validation loss decreased (0.323435 --> 0.241523).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 4 cost time: 0.9657714366912842
Epoch: 4, Steps: 64 | Train Loss: 0.0884046 Vali Loss: 0.2296670 Test Loss: 0.2854971
Validation loss decreased (0.241523 --> 0.229667).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 5 cost time: 0.9595463275909424
Epoch: 5, Steps: 64 | Train Loss: 0.0839349 Vali Loss: 0.2279561 Test Loss: 0.2799940
Validation loss decreased (0.229667 --> 0.227956).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 6 cost time: 0.9489996433258057
Epoch: 6, Steps: 64 | Train Loss: 0.0811509 Vali Loss: 0.2153655 Test Loss: 0.2874252
Validation loss decreased (0.227956 --> 0.215365).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 7 cost time: 0.9556155204772949
Epoch: 7, Steps: 64 | Train Loss: 0.0789460 Vali Loss: 0.2077810 Test Loss: 0.2817691
Validation loss decreased (0.215365 --> 0.207781).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 8 cost time: 0.961611270904541
Epoch: 8, Steps: 64 | Train Loss: 0.0769487 Vali Loss: 0.2084625 Test Loss: 0.2877193
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 9 cost time: 0.9630615711212158
Epoch: 9, Steps: 64 | Train Loss: 0.0757421 Vali Loss: 0.2013210 Test Loss: 0.2853416
Validation loss decreased (0.207781 --> 0.201321).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 10 cost time: 0.957432746887207
Epoch: 10, Steps: 64 | Train Loss: 0.0743827 Vali Loss: 0.1998402 Test Loss: 0.2833165
Validation loss decreased (0.201321 --> 0.199840).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 11 cost time: 0.9613423347473145
Epoch: 11, Steps: 64 | Train Loss: 0.0735655 Vali Loss: 0.1967958 Test Loss: 0.2828878
Validation loss decreased (0.199840 --> 0.196796).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 12 cost time: 0.9760668277740479
Epoch: 12, Steps: 64 | Train Loss: 0.0722996 Vali Loss: 0.1944764 Test Loss: 0.2819110
Validation loss decreased (0.196796 --> 0.194476).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 13 cost time: 0.9570410251617432
Epoch: 13, Steps: 64 | Train Loss: 0.0715604 Vali Loss: 0.1963192 Test Loss: 0.2816116
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 14 cost time: 0.9554376602172852
Epoch: 14, Steps: 64 | Train Loss: 0.0713312 Vali Loss: 0.1910258 Test Loss: 0.2792750
Validation loss decreased (0.194476 --> 0.191026).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 15 cost time: 0.9778101444244385
Epoch: 15, Steps: 64 | Train Loss: 0.0705166 Vali Loss: 0.1907688 Test Loss: 0.2808437
Validation loss decreased (0.191026 --> 0.190769).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 16 cost time: 0.9607152938842773
Epoch: 16, Steps: 64 | Train Loss: 0.0700330 Vali Loss: 0.1848658 Test Loss: 0.2783483
Validation loss decreased (0.190769 --> 0.184866).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 17 cost time: 0.9574360847473145
Epoch: 17, Steps: 64 | Train Loss: 0.0695223 Vali Loss: 0.1884265 Test Loss: 0.2789462
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 18 cost time: 0.9597084522247314
Epoch: 18, Steps: 64 | Train Loss: 0.0691737 Vali Loss: 0.1844102 Test Loss: 0.2764261
Validation loss decreased (0.184866 --> 0.184410).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 19 cost time: 0.9747443199157715
Epoch: 19, Steps: 64 | Train Loss: 0.0689994 Vali Loss: 0.1857888 Test Loss: 0.2782042
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 20 cost time: 0.9666314125061035
Epoch: 20, Steps: 64 | Train Loss: 0.0684199 Vali Loss: 0.1852331 Test Loss: 0.2762782
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 21 cost time: 0.9585018157958984
Epoch: 21, Steps: 64 | Train Loss: 0.0684116 Vali Loss: 0.1846134 Test Loss: 0.2771082
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 22 cost time: 0.9542429447174072
Epoch: 22, Steps: 64 | Train Loss: 0.0682733 Vali Loss: 0.1828332 Test Loss: 0.2754848
Validation loss decreased (0.184410 --> 0.182833).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 23 cost time: 0.9640445709228516
Epoch: 23, Steps: 64 | Train Loss: 0.0680887 Vali Loss: 0.1838570 Test Loss: 0.2763510
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 24 cost time: 0.9565451145172119
Epoch: 24, Steps: 64 | Train Loss: 0.0674447 Vali Loss: 0.1845780 Test Loss: 0.2771021
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 25 cost time: 0.9655730724334717
Epoch: 25, Steps: 64 | Train Loss: 0.0678213 Vali Loss: 0.1797037 Test Loss: 0.2771727
Validation loss decreased (0.182833 --> 0.179704).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 26 cost time: 0.9590585231781006
Epoch: 26, Steps: 64 | Train Loss: 0.0668587 Vali Loss: 0.1840382 Test Loss: 0.2747891
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 27 cost time: 0.9563896656036377
Epoch: 27, Steps: 64 | Train Loss: 0.0676503 Vali Loss: 0.1831094 Test Loss: 0.2762837
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 28 cost time: 0.9597957134246826
Epoch: 28, Steps: 64 | Train Loss: 0.0673998 Vali Loss: 0.1822478 Test Loss: 0.2756618
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 29 cost time: 0.9362022876739502
Epoch: 29, Steps: 64 | Train Loss: 0.0674881 Vali Loss: 0.1803035 Test Loss: 0.2756167
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 30 cost time: 0.9596138000488281
Epoch: 30, Steps: 64 | Train Loss: 0.0667385 Vali Loss: 0.1827338 Test Loss: 0.2761158
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 31 cost time: 0.9590637683868408
Epoch: 31, Steps: 64 | Train Loss: 0.0670320 Vali Loss: 0.1817602 Test Loss: 0.2760585
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 32 cost time: 0.9441776275634766
Epoch: 32, Steps: 64 | Train Loss: 0.0668280 Vali Loss: 0.1843864 Test Loss: 0.2765332
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 33 cost time: 0.9533233642578125
Epoch: 33, Steps: 64 | Train Loss: 0.0668571 Vali Loss: 0.1799037 Test Loss: 0.2761591
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 34 cost time: 0.9562485218048096
Epoch: 34, Steps: 64 | Train Loss: 0.0665589 Vali Loss: 0.1813215 Test Loss: 0.2759859
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 35 cost time: 0.966404914855957
Epoch: 35, Steps: 64 | Train Loss: 0.0668633 Vali Loss: 0.1808248 Test Loss: 0.2750617
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 36 cost time: 0.9561951160430908
Epoch: 36, Steps: 64 | Train Loss: 0.0665107 Vali Loss: 0.1794203 Test Loss: 0.2755536
Validation loss decreased (0.179704 --> 0.179420).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 37 cost time: 0.948493242263794
Epoch: 37, Steps: 64 | Train Loss: 0.0664854 Vali Loss: 0.1845001 Test Loss: 0.2752320
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 38 cost time: 0.9608912467956543
Epoch: 38, Steps: 64 | Train Loss: 0.0664856 Vali Loss: 0.1830983 Test Loss: 0.2749929
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 39 cost time: 0.9524414539337158
Epoch: 39, Steps: 64 | Train Loss: 0.0663954 Vali Loss: 0.1836215 Test Loss: 0.2744856
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 40 cost time: 0.9459929466247559
Epoch: 40, Steps: 64 | Train Loss: 0.0664618 Vali Loss: 0.1819210 Test Loss: 0.2754011
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 41 cost time: 0.9506189823150635
Epoch: 41, Steps: 64 | Train Loss: 0.0664746 Vali Loss: 0.1824118 Test Loss: 0.2759622
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 42 cost time: 0.9565999507904053
Epoch: 42, Steps: 64 | Train Loss: 0.0662060 Vali Loss: 0.1823252 Test Loss: 0.2750280
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 43 cost time: 0.9514124393463135
Epoch: 43, Steps: 64 | Train Loss: 0.0664129 Vali Loss: 0.1807962 Test Loss: 0.2760718
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 44 cost time: 0.9554548263549805
Epoch: 44, Steps: 64 | Train Loss: 0.0666316 Vali Loss: 0.1808006 Test Loss: 0.2747776
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 45 cost time: 0.9456405639648438
Epoch: 45, Steps: 64 | Train Loss: 0.0665735 Vali Loss: 0.1850082 Test Loss: 0.2763592
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 46 cost time: 0.9470787048339844
Epoch: 46, Steps: 64 | Train Loss: 0.0660400 Vali Loss: 0.1786841 Test Loss: 0.2753456
Validation loss decreased (0.179420 --> 0.178684).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 47 cost time: 0.949352502822876
Epoch: 47, Steps: 64 | Train Loss: 0.0663152 Vali Loss: 0.1818603 Test Loss: 0.2758172
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 48 cost time: 0.9464004039764404
Epoch: 48, Steps: 64 | Train Loss: 0.0662570 Vali Loss: 0.1835407 Test Loss: 0.2753377
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 49 cost time: 0.9487724304199219
Epoch: 49, Steps: 64 | Train Loss: 0.0660359 Vali Loss: 0.1827529 Test Loss: 0.2742380
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 50 cost time: 0.9529955387115479
Epoch: 50, Steps: 64 | Train Loss: 0.0664298 Vali Loss: 0.1809791 Test Loss: 0.2749153
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 51 cost time: 0.9540019035339355
Epoch: 51, Steps: 64 | Train Loss: 0.0661837 Vali Loss: 0.1795594 Test Loss: 0.2752583
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 52 cost time: 0.9496297836303711
Epoch: 52, Steps: 64 | Train Loss: 0.0668388 Vali Loss: 0.1833548 Test Loss: 0.2750833
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 53 cost time: 0.9526302814483643
Epoch: 53, Steps: 64 | Train Loss: 0.0660818 Vali Loss: 0.1797400 Test Loss: 0.2752626
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 54 cost time: 0.9520633220672607
Epoch: 54, Steps: 64 | Train Loss: 0.0663540 Vali Loss: 0.1781444 Test Loss: 0.2742153
Validation loss decreased (0.178684 --> 0.178144).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 55 cost time: 0.9592070579528809
Epoch: 55, Steps: 64 | Train Loss: 0.0661168 Vali Loss: 0.1810983 Test Loss: 0.2753494
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 56 cost time: 0.9443295001983643
Epoch: 56, Steps: 64 | Train Loss: 0.0662585 Vali Loss: 0.1839707 Test Loss: 0.2752511
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 57 cost time: 0.9474442005157471
Epoch: 57, Steps: 64 | Train Loss: 0.0662580 Vali Loss: 0.1802091 Test Loss: 0.2751491
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 58 cost time: 0.965153694152832
Epoch: 58, Steps: 64 | Train Loss: 0.0661395 Vali Loss: 0.1796559 Test Loss: 0.2758003
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 59 cost time: 0.9498312473297119
Epoch: 59, Steps: 64 | Train Loss: 0.0663266 Vali Loss: 0.1788122 Test Loss: 0.2750634
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 60 cost time: 0.9527685642242432
Epoch: 60, Steps: 64 | Train Loss: 0.0659825 Vali Loss: 0.1808241 Test Loss: 0.2758219
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2742152512073517, mae:0.3461880683898926, rse:0.2403358668088913
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.06616020202636719 GB
Epoch: 1 cost time: 2.2819535732269287
Epoch: 1, Steps: 64 | Train Loss: 0.9611720 Vali Loss: 2.8306620 Test Loss: 4.9590712
Validation loss decreased (inf --> 2.830662).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 2 cost time: 0.9745972156524658
Epoch: 2, Steps: 64 | Train Loss: 0.6285062 Vali Loss: 1.1363316 Test Loss: 1.8543514
Validation loss decreased (2.830662 --> 1.136332).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 3 cost time: 0.9072036743164062
Epoch: 3, Steps: 64 | Train Loss: 0.3168593 Vali Loss: 0.6216423 Test Loss: 0.9155313
Validation loss decreased (1.136332 --> 0.621642).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 4 cost time: 0.9073960781097412
Epoch: 4, Steps: 64 | Train Loss: 0.1934347 Vali Loss: 0.4223939 Test Loss: 0.5822031
Validation loss decreased (0.621642 --> 0.422394).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 5 cost time: 0.917414665222168
Epoch: 5, Steps: 64 | Train Loss: 0.1405420 Vali Loss: 0.3274113 Test Loss: 0.4281056
Validation loss decreased (0.422394 --> 0.327411).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 6 cost time: 0.8904285430908203
Epoch: 6, Steps: 64 | Train Loss: 0.1186549 Vali Loss: 0.2830200 Test Loss: 0.3586940
Validation loss decreased (0.327411 --> 0.283020).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 7 cost time: 0.8903968334197998
Epoch: 7, Steps: 64 | Train Loss: 0.1082176 Vali Loss: 0.2614552 Test Loss: 0.3216692
Validation loss decreased (0.283020 --> 0.261455).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 8 cost time: 0.893817663192749
Epoch: 8, Steps: 64 | Train Loss: 0.1020121 Vali Loss: 0.2452328 Test Loss: 0.3084103
Validation loss decreased (0.261455 --> 0.245233).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 9 cost time: 0.8779997825622559
Epoch: 9, Steps: 64 | Train Loss: 0.0989817 Vali Loss: 0.2401334 Test Loss: 0.3000540
Validation loss decreased (0.245233 --> 0.240133).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 10 cost time: 0.8896095752716064
Epoch: 10, Steps: 64 | Train Loss: 0.0961641 Vali Loss: 0.2368785 Test Loss: 0.2961190
Validation loss decreased (0.240133 --> 0.236878).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 11 cost time: 0.8873867988586426
Epoch: 11, Steps: 64 | Train Loss: 0.0951137 Vali Loss: 0.2297261 Test Loss: 0.2909656
Validation loss decreased (0.236878 --> 0.229726).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 12 cost time: 0.8924133777618408
Epoch: 12, Steps: 64 | Train Loss: 0.0933407 Vali Loss: 0.2263353 Test Loss: 0.2894781
Validation loss decreased (0.229726 --> 0.226335).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 13 cost time: 0.8904056549072266
Epoch: 13, Steps: 64 | Train Loss: 0.0921150 Vali Loss: 0.2278289 Test Loss: 0.2889152
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 14 cost time: 0.8797397613525391
Epoch: 14, Steps: 64 | Train Loss: 0.0907458 Vali Loss: 0.2225779 Test Loss: 0.2879090
Validation loss decreased (0.226335 --> 0.222578).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 15 cost time: 0.887000322341919
Epoch: 15, Steps: 64 | Train Loss: 0.0898555 Vali Loss: 0.2179651 Test Loss: 0.2852353
Validation loss decreased (0.222578 --> 0.217965).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 16 cost time: 0.8742396831512451
Epoch: 16, Steps: 64 | Train Loss: 0.0888962 Vali Loss: 0.2180253 Test Loss: 0.2839528
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 17 cost time: 0.874356746673584
Epoch: 17, Steps: 64 | Train Loss: 0.0883287 Vali Loss: 0.2173708 Test Loss: 0.2835815
Validation loss decreased (0.217965 --> 0.217371).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 18 cost time: 0.8793411254882812
Epoch: 18, Steps: 64 | Train Loss: 0.0874273 Vali Loss: 0.2158683 Test Loss: 0.2815720
Validation loss decreased (0.217371 --> 0.215868).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 19 cost time: 0.9053363800048828
Epoch: 19, Steps: 64 | Train Loss: 0.0861310 Vali Loss: 0.2121446 Test Loss: 0.2834133
Validation loss decreased (0.215868 --> 0.212145).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 20 cost time: 0.8867995738983154
Epoch: 20, Steps: 64 | Train Loss: 0.0861570 Vali Loss: 0.2135393 Test Loss: 0.2817940
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 21 cost time: 0.8870000839233398
Epoch: 21, Steps: 64 | Train Loss: 0.0855850 Vali Loss: 0.2115487 Test Loss: 0.2805024
Validation loss decreased (0.212145 --> 0.211549).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 22 cost time: 0.885608434677124
Epoch: 22, Steps: 64 | Train Loss: 0.0847000 Vali Loss: 0.2100339 Test Loss: 0.2795490
Validation loss decreased (0.211549 --> 0.210034).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 23 cost time: 0.8622865676879883
Epoch: 23, Steps: 64 | Train Loss: 0.0841470 Vali Loss: 0.2074474 Test Loss: 0.2798032
Validation loss decreased (0.210034 --> 0.207447).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 24 cost time: 0.8744857311248779
Epoch: 24, Steps: 64 | Train Loss: 0.0840879 Vali Loss: 0.2072816 Test Loss: 0.2798640
Validation loss decreased (0.207447 --> 0.207282).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 25 cost time: 0.8759627342224121
Epoch: 25, Steps: 64 | Train Loss: 0.0836798 Vali Loss: 0.2069142 Test Loss: 0.2784280
Validation loss decreased (0.207282 --> 0.206914).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 26 cost time: 0.8648331165313721
Epoch: 26, Steps: 64 | Train Loss: 0.0829265 Vali Loss: 0.2059298 Test Loss: 0.2790441
Validation loss decreased (0.206914 --> 0.205930).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 27 cost time: 0.875
Epoch: 27, Steps: 64 | Train Loss: 0.0835269 Vali Loss: 0.2035649 Test Loss: 0.2789545
Validation loss decreased (0.205930 --> 0.203565).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 28 cost time: 0.8919997215270996
Epoch: 28, Steps: 64 | Train Loss: 0.0832664 Vali Loss: 0.2027522 Test Loss: 0.2782688
Validation loss decreased (0.203565 --> 0.202752).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 29 cost time: 0.8930034637451172
Epoch: 29, Steps: 64 | Train Loss: 0.0825184 Vali Loss: 0.2044320 Test Loss: 0.2778224
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 30 cost time: 0.8553969860076904
Epoch: 30, Steps: 64 | Train Loss: 0.0827813 Vali Loss: 0.2017707 Test Loss: 0.2777265
Validation loss decreased (0.202752 --> 0.201771).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 31 cost time: 0.8819625377655029
Epoch: 31, Steps: 64 | Train Loss: 0.0824936 Vali Loss: 0.2012855 Test Loss: 0.2773897
Validation loss decreased (0.201771 --> 0.201285).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 32 cost time: 0.8803753852844238
Epoch: 32, Steps: 64 | Train Loss: 0.0820322 Vali Loss: 0.2023431 Test Loss: 0.2777185
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 33 cost time: 0.8907899856567383
Epoch: 33, Steps: 64 | Train Loss: 0.0819725 Vali Loss: 0.1999646 Test Loss: 0.2784250
Validation loss decreased (0.201285 --> 0.199965).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 34 cost time: 0.8919997215270996
Epoch: 34, Steps: 64 | Train Loss: 0.0821518 Vali Loss: 0.2022211 Test Loss: 0.2773959
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 35 cost time: 0.8946123123168945
Epoch: 35, Steps: 64 | Train Loss: 0.0816660 Vali Loss: 0.1988429 Test Loss: 0.2758781
Validation loss decreased (0.199965 --> 0.198843).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 36 cost time: 0.9133265018463135
Epoch: 36, Steps: 64 | Train Loss: 0.0816148 Vali Loss: 0.2014921 Test Loss: 0.2769631
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 37 cost time: 0.9093015193939209
Epoch: 37, Steps: 64 | Train Loss: 0.0816461 Vali Loss: 0.1970252 Test Loss: 0.2772517
Validation loss decreased (0.198843 --> 0.197025).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 38 cost time: 0.9069619178771973
Epoch: 38, Steps: 64 | Train Loss: 0.0809644 Vali Loss: 0.2017878 Test Loss: 0.2772681
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 39 cost time: 0.9084231853485107
Epoch: 39, Steps: 64 | Train Loss: 0.0814244 Vali Loss: 0.2002016 Test Loss: 0.2760580
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 40 cost time: 0.9087958335876465
Epoch: 40, Steps: 64 | Train Loss: 0.0814863 Vali Loss: 0.1984735 Test Loss: 0.2759697
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 41 cost time: 0.8889997005462646
Epoch: 41, Steps: 64 | Train Loss: 0.0812295 Vali Loss: 0.2008008 Test Loss: 0.2764738
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 42 cost time: 0.8919453620910645
Epoch: 42, Steps: 64 | Train Loss: 0.0809342 Vali Loss: 0.1989893 Test Loss: 0.2753678
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 43 cost time: 0.8933711051940918
Epoch: 43, Steps: 64 | Train Loss: 0.0812246 Vali Loss: 0.1974922 Test Loss: 0.2760038
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 44 cost time: 0.9023633003234863
Epoch: 44, Steps: 64 | Train Loss: 0.0809076 Vali Loss: 0.1994601 Test Loss: 0.2754113
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 45 cost time: 0.9093637466430664
Epoch: 45, Steps: 64 | Train Loss: 0.0810352 Vali Loss: 0.1975517 Test Loss: 0.2759017
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 46 cost time: 0.9108331203460693
Epoch: 46, Steps: 64 | Train Loss: 0.0807981 Vali Loss: 0.2002063 Test Loss: 0.2762388
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 47 cost time: 0.9049999713897705
Epoch: 47, Steps: 64 | Train Loss: 0.0810851 Vali Loss: 0.1981604 Test Loss: 0.2758339
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 48 cost time: 0.8559999465942383
Epoch: 48, Steps: 64 | Train Loss: 0.0806107 Vali Loss: 0.2005956 Test Loss: 0.2766206
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 49 cost time: 0.8993983268737793
Epoch: 49, Steps: 64 | Train Loss: 0.0809460 Vali Loss: 0.1979361 Test Loss: 0.2763776
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 50 cost time: 0.8883230686187744
Epoch: 50, Steps: 64 | Train Loss: 0.0808740 Vali Loss: 0.2005188 Test Loss: 0.2763541
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 51 cost time: 0.8860359191894531
Epoch: 51, Steps: 64 | Train Loss: 0.0807269 Vali Loss: 0.1985728 Test Loss: 0.2770612
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 52 cost time: 0.8924989700317383
Epoch: 52, Steps: 64 | Train Loss: 0.0811377 Vali Loss: 0.1996033 Test Loss: 0.2758768
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 53 cost time: 0.8957641124725342
Epoch: 53, Steps: 64 | Train Loss: 0.0805120 Vali Loss: 0.1995313 Test Loss: 0.2762725
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 54 cost time: 0.9154243469238281
Epoch: 54, Steps: 64 | Train Loss: 0.0803947 Vali Loss: 0.1989558 Test Loss: 0.2756514
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 55 cost time: 0.9039394855499268
Epoch: 55, Steps: 64 | Train Loss: 0.0807374 Vali Loss: 0.1973219 Test Loss: 0.2764216
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 56 cost time: 0.9624443054199219
Epoch: 56, Steps: 64 | Train Loss: 0.0800161 Vali Loss: 0.1955184 Test Loss: 0.2759175
Validation loss decreased (0.197025 --> 0.195518).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 57 cost time: 0.9072329998016357
Epoch: 57, Steps: 64 | Train Loss: 0.0809604 Vali Loss: 0.1986896 Test Loss: 0.2743004
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 58 cost time: 0.9094769954681396
Epoch: 58, Steps: 64 | Train Loss: 0.0803879 Vali Loss: 0.1988563 Test Loss: 0.2761436
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 59 cost time: 0.9118297100067139
Epoch: 59, Steps: 64 | Train Loss: 0.0803013 Vali Loss: 0.1972714 Test Loss: 0.2757686
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 60 cost time: 0.9048366546630859
Epoch: 60, Steps: 64 | Train Loss: 0.0805406 Vali Loss: 0.1981232 Test Loss: 0.2753824
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2759174406528473, mae:0.33615007996559143, rse:0.24108067154884338
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.07043266296386719 GB
Epoch: 1 cost time: 2.2975172996520996
Epoch: 1, Steps: 64 | Train Loss: 0.7602676 Vali Loss: 2.2459164 Test Loss: 3.9555566
Validation loss decreased (inf --> 2.245916).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 2 cost time: 0.8620002269744873
Epoch: 2, Steps: 64 | Train Loss: 0.2945632 Vali Loss: 0.2999021 Test Loss: 0.3253428
Validation loss decreased (2.245916 --> 0.299902).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 3 cost time: 0.862619161605835
Epoch: 3, Steps: 64 | Train Loss: 0.1010971 Vali Loss: 0.2493143 Test Loss: 0.2997351
Validation loss decreased (0.299902 --> 0.249314).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 4 cost time: 0.8624377250671387
Epoch: 4, Steps: 64 | Train Loss: 0.0912357 Vali Loss: 0.2313065 Test Loss: 0.2789918
Validation loss decreased (0.249314 --> 0.231306).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 5 cost time: 0.8450107574462891
Epoch: 5, Steps: 64 | Train Loss: 0.0868503 Vali Loss: 0.2254080 Test Loss: 0.2803326
Validation loss decreased (0.231306 --> 0.225408).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 6 cost time: 0.8549613952636719
Epoch: 6, Steps: 64 | Train Loss: 0.0837253 Vali Loss: 0.2197886 Test Loss: 0.2785464
Validation loss decreased (0.225408 --> 0.219789).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 7 cost time: 0.8550000190734863
Epoch: 7, Steps: 64 | Train Loss: 0.0818557 Vali Loss: 0.2130725 Test Loss: 0.2772011
Validation loss decreased (0.219789 --> 0.213073).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 8 cost time: 0.8640000820159912
Epoch: 8, Steps: 64 | Train Loss: 0.0801465 Vali Loss: 0.2075015 Test Loss: 0.2734078
Validation loss decreased (0.213073 --> 0.207502).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 9 cost time: 0.8573770523071289
Epoch: 9, Steps: 64 | Train Loss: 0.0784446 Vali Loss: 0.2013427 Test Loss: 0.2730916
Validation loss decreased (0.207502 --> 0.201343).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 10 cost time: 0.863391637802124
Epoch: 10, Steps: 64 | Train Loss: 0.0770893 Vali Loss: 0.2031398 Test Loss: 0.2748303
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 11 cost time: 0.8593988418579102
Epoch: 11, Steps: 64 | Train Loss: 0.0763265 Vali Loss: 0.1984966 Test Loss: 0.2690522
Validation loss decreased (0.201343 --> 0.198497).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 12 cost time: 0.8577098846435547
Epoch: 12, Steps: 64 | Train Loss: 0.0753299 Vali Loss: 0.1974176 Test Loss: 0.2738872
Validation loss decreased (0.198497 --> 0.197418).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 13 cost time: 0.8840005397796631
Epoch: 13, Steps: 64 | Train Loss: 0.0744577 Vali Loss: 0.1938993 Test Loss: 0.2696179
Validation loss decreased (0.197418 --> 0.193899).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 14 cost time: 0.8616321086883545
Epoch: 14, Steps: 64 | Train Loss: 0.0740362 Vali Loss: 0.1912515 Test Loss: 0.2697946
Validation loss decreased (0.193899 --> 0.191252).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 15 cost time: 0.8564584255218506
Epoch: 15, Steps: 64 | Train Loss: 0.0732194 Vali Loss: 0.1932382 Test Loss: 0.2694503
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 16 cost time: 0.8600256443023682
Epoch: 16, Steps: 64 | Train Loss: 0.0729728 Vali Loss: 0.1886695 Test Loss: 0.2702212
Validation loss decreased (0.191252 --> 0.188669).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 17 cost time: 0.876401424407959
Epoch: 17, Steps: 64 | Train Loss: 0.0725341 Vali Loss: 0.1924055 Test Loss: 0.2681447
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 18 cost time: 0.875760555267334
Epoch: 18, Steps: 64 | Train Loss: 0.0717464 Vali Loss: 0.1892543 Test Loss: 0.2685819
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 19 cost time: 0.8889999389648438
Epoch: 19, Steps: 64 | Train Loss: 0.0715613 Vali Loss: 0.1846604 Test Loss: 0.2693877
Validation loss decreased (0.188669 --> 0.184660).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 20 cost time: 0.875999927520752
Epoch: 20, Steps: 64 | Train Loss: 0.0713609 Vali Loss: 0.1864215 Test Loss: 0.2695850
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 21 cost time: 0.8866050243377686
Epoch: 21, Steps: 64 | Train Loss: 0.0713195 Vali Loss: 0.1862875 Test Loss: 0.2681465
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 22 cost time: 0.880364179611206
Epoch: 22, Steps: 64 | Train Loss: 0.0709313 Vali Loss: 0.1817823 Test Loss: 0.2679853
Validation loss decreased (0.184660 --> 0.181782).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 23 cost time: 0.8809325695037842
Epoch: 23, Steps: 64 | Train Loss: 0.0702219 Vali Loss: 0.1848978 Test Loss: 0.2679008
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 24 cost time: 0.8743438720703125
Epoch: 24, Steps: 64 | Train Loss: 0.0703004 Vali Loss: 0.1847815 Test Loss: 0.2672780
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 25 cost time: 0.8718109130859375
Epoch: 25, Steps: 64 | Train Loss: 0.0693799 Vali Loss: 0.1806166 Test Loss: 0.2681780
Validation loss decreased (0.181782 --> 0.180617).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 26 cost time: 0.874000072479248
Epoch: 26, Steps: 64 | Train Loss: 0.0699992 Vali Loss: 0.1827160 Test Loss: 0.2671010
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 27 cost time: 0.8306002616882324
Epoch: 27, Steps: 64 | Train Loss: 0.0698366 Vali Loss: 0.1826640 Test Loss: 0.2669540
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 28 cost time: 0.9524788856506348
Epoch: 28, Steps: 64 | Train Loss: 0.0692664 Vali Loss: 0.1806871 Test Loss: 0.2671905
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 29 cost time: 0.8665950298309326
Epoch: 29, Steps: 64 | Train Loss: 0.0695782 Vali Loss: 0.1800601 Test Loss: 0.2678818
Validation loss decreased (0.180617 --> 0.180060).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 30 cost time: 0.8616149425506592
Epoch: 30, Steps: 64 | Train Loss: 0.0694920 Vali Loss: 0.1813198 Test Loss: 0.2675267
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 31 cost time: 0.8577797412872314
Epoch: 31, Steps: 64 | Train Loss: 0.0691454 Vali Loss: 0.1833615 Test Loss: 0.2671975
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 32 cost time: 0.8559999465942383
Epoch: 32, Steps: 64 | Train Loss: 0.0695023 Vali Loss: 0.1816076 Test Loss: 0.2672111
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 33 cost time: 0.8656282424926758
Epoch: 33, Steps: 64 | Train Loss: 0.0689845 Vali Loss: 0.1815923 Test Loss: 0.2673193
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 34 cost time: 0.8564012050628662
Epoch: 34, Steps: 64 | Train Loss: 0.0690846 Vali Loss: 0.1804806 Test Loss: 0.2670756
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 35 cost time: 0.8594434261322021
Epoch: 35, Steps: 64 | Train Loss: 0.0692998 Vali Loss: 0.1812991 Test Loss: 0.2673845
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 36 cost time: 0.8662247657775879
Epoch: 36, Steps: 64 | Train Loss: 0.0691557 Vali Loss: 0.1817227 Test Loss: 0.2674812
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 37 cost time: 0.8710000514984131
Epoch: 37, Steps: 64 | Train Loss: 0.0685948 Vali Loss: 0.1811734 Test Loss: 0.2671546
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 38 cost time: 0.8659994602203369
Epoch: 38, Steps: 64 | Train Loss: 0.0688700 Vali Loss: 0.1814692 Test Loss: 0.2670381
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 39 cost time: 0.8594098091125488
Epoch: 39, Steps: 64 | Train Loss: 0.0690536 Vali Loss: 0.1797266 Test Loss: 0.2674584
Validation loss decreased (0.180060 --> 0.179727).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 40 cost time: 0.8587210178375244
Epoch: 40, Steps: 64 | Train Loss: 0.0691315 Vali Loss: 0.1837288 Test Loss: 0.2671091
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 41 cost time: 0.8689405918121338
Epoch: 41, Steps: 64 | Train Loss: 0.0693198 Vali Loss: 0.1815309 Test Loss: 0.2666193
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 42 cost time: 0.8578016757965088
Epoch: 42, Steps: 64 | Train Loss: 0.0689245 Vali Loss: 0.1808153 Test Loss: 0.2673633
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 43 cost time: 0.8560001850128174
Epoch: 43, Steps: 64 | Train Loss: 0.0688568 Vali Loss: 0.1817979 Test Loss: 0.2668440
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 44 cost time: 0.8706223964691162
Epoch: 44, Steps: 64 | Train Loss: 0.0687157 Vali Loss: 0.1830667 Test Loss: 0.2670225
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 45 cost time: 0.8654537200927734
Epoch: 45, Steps: 64 | Train Loss: 0.0685896 Vali Loss: 0.1804007 Test Loss: 0.2669210
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 46 cost time: 0.8643438816070557
Epoch: 46, Steps: 64 | Train Loss: 0.0685172 Vali Loss: 0.1795053 Test Loss: 0.2669033
Validation loss decreased (0.179727 --> 0.179505).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 47 cost time: 0.8594295978546143
Epoch: 47, Steps: 64 | Train Loss: 0.0687645 Vali Loss: 0.1825898 Test Loss: 0.2668464
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 48 cost time: 0.8718571662902832
Epoch: 48, Steps: 64 | Train Loss: 0.0684373 Vali Loss: 0.1780375 Test Loss: 0.2670053
Validation loss decreased (0.179505 --> 0.178038).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 49 cost time: 0.8650033473968506
Epoch: 49, Steps: 64 | Train Loss: 0.0685470 Vali Loss: 0.1807597 Test Loss: 0.2668439
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 50 cost time: 0.8556180000305176
Epoch: 50, Steps: 64 | Train Loss: 0.0683736 Vali Loss: 0.1808596 Test Loss: 0.2667337
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 51 cost time: 0.858227014541626
Epoch: 51, Steps: 64 | Train Loss: 0.0684019 Vali Loss: 0.1804109 Test Loss: 0.2673380
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 52 cost time: 0.8483490943908691
Epoch: 52, Steps: 64 | Train Loss: 0.0685090 Vali Loss: 0.1802683 Test Loss: 0.2669568
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 53 cost time: 0.8514719009399414
Epoch: 53, Steps: 64 | Train Loss: 0.0685245 Vali Loss: 0.1803935 Test Loss: 0.2669442
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 54 cost time: 0.8596251010894775
Epoch: 54, Steps: 64 | Train Loss: 0.0687623 Vali Loss: 0.1806190 Test Loss: 0.2670034
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 55 cost time: 0.8654491901397705
Epoch: 55, Steps: 64 | Train Loss: 0.0683130 Vali Loss: 0.1785425 Test Loss: 0.2672467
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 56 cost time: 0.8614180088043213
Epoch: 56, Steps: 64 | Train Loss: 0.0682482 Vali Loss: 0.1812583 Test Loss: 0.2669297
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 57 cost time: 0.8593358993530273
Epoch: 57, Steps: 64 | Train Loss: 0.0684640 Vali Loss: 0.1805028 Test Loss: 0.2665242
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 58 cost time: 0.8614184856414795
Epoch: 58, Steps: 64 | Train Loss: 0.0685925 Vali Loss: 0.1794440 Test Loss: 0.2669874
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 59 cost time: 0.8377401828765869
Epoch: 59, Steps: 64 | Train Loss: 0.0691765 Vali Loss: 0.1829300 Test Loss: 0.2671967
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 60 cost time: 0.8530001640319824
Epoch: 60, Steps: 64 | Train Loss: 0.0689029 Vali Loss: 0.1821348 Test Loss: 0.2668114
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2670053243637085, mae:0.33463990688323975, rse:0.2371552586555481
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityBh_336_96', model='PerioDformer', data='CityBh', root_path='./dataset/', data_path='CityBh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.0735483169555664 GB
Epoch: 1 cost time: 2.3423073291778564
Epoch: 1, Steps: 64 | Train Loss: 0.8082428 Vali Loss: 2.4818981 Test Loss: 4.3483267
Validation loss decreased (inf --> 2.481898).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 2 cost time: 0.9776084423065186
Epoch: 2, Steps: 64 | Train Loss: 0.3009549 Vali Loss: 0.3446481 Test Loss: 0.4250682
Validation loss decreased (2.481898 --> 0.344648).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 3 cost time: 0.9727532863616943
Epoch: 3, Steps: 64 | Train Loss: 0.0964822 Vali Loss: 0.2323872 Test Loss: 0.2751423
Validation loss decreased (0.344648 --> 0.232387).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 4 cost time: 0.9751718044281006
Epoch: 4, Steps: 64 | Train Loss: 0.0862116 Vali Loss: 0.2289186 Test Loss: 0.2823418
Validation loss decreased (0.232387 --> 0.228919).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 5 cost time: 0.9669685363769531
Epoch: 5, Steps: 64 | Train Loss: 0.0822095 Vali Loss: 0.2204931 Test Loss: 0.2759394
Validation loss decreased (0.228919 --> 0.220493).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 6 cost time: 0.9634196758270264
Epoch: 6, Steps: 64 | Train Loss: 0.0798597 Vali Loss: 0.2127660 Test Loss: 0.2773101
Validation loss decreased (0.220493 --> 0.212766).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 7 cost time: 0.9664382934570312
Epoch: 7, Steps: 64 | Train Loss: 0.0772227 Vali Loss: 0.2050581 Test Loss: 0.2770441
Validation loss decreased (0.212766 --> 0.205058).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 8 cost time: 0.96494460105896
Epoch: 8, Steps: 64 | Train Loss: 0.0750390 Vali Loss: 0.1985308 Test Loss: 0.2732881
Validation loss decreased (0.205058 --> 0.198531).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 9 cost time: 0.9763646125793457
Epoch: 9, Steps: 64 | Train Loss: 0.0738996 Vali Loss: 0.1947663 Test Loss: 0.2713094
Validation loss decreased (0.198531 --> 0.194766).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 10 cost time: 0.9734501838684082
Epoch: 10, Steps: 64 | Train Loss: 0.0725938 Vali Loss: 0.1920679 Test Loss: 0.2735076
Validation loss decreased (0.194766 --> 0.192068).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 11 cost time: 0.9707314968109131
Epoch: 11, Steps: 64 | Train Loss: 0.0719504 Vali Loss: 0.1916088 Test Loss: 0.2705564
Validation loss decreased (0.192068 --> 0.191609).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 12 cost time: 0.9828701019287109
Epoch: 12, Steps: 64 | Train Loss: 0.0712768 Vali Loss: 0.1896709 Test Loss: 0.2685033
Validation loss decreased (0.191609 --> 0.189671).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 13 cost time: 0.9675812721252441
Epoch: 13, Steps: 64 | Train Loss: 0.0709014 Vali Loss: 0.1859123 Test Loss: 0.2683280
Validation loss decreased (0.189671 --> 0.185912).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 14 cost time: 0.9639997482299805
Epoch: 14, Steps: 64 | Train Loss: 0.0702846 Vali Loss: 0.1874181 Test Loss: 0.2681510
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 15 cost time: 0.9747788906097412
Epoch: 15, Steps: 64 | Train Loss: 0.0697495 Vali Loss: 0.1864184 Test Loss: 0.2697521
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 16 cost time: 0.9666299819946289
Epoch: 16, Steps: 64 | Train Loss: 0.0692182 Vali Loss: 0.1828203 Test Loss: 0.2681846
Validation loss decreased (0.185912 --> 0.182820).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 17 cost time: 0.9753823280334473
Epoch: 17, Steps: 64 | Train Loss: 0.0690825 Vali Loss: 0.1857941 Test Loss: 0.2692748
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 18 cost time: 0.9684677124023438
Epoch: 18, Steps: 64 | Train Loss: 0.0687582 Vali Loss: 0.1837341 Test Loss: 0.2676742
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 19 cost time: 0.9721801280975342
Epoch: 19, Steps: 64 | Train Loss: 0.0682325 Vali Loss: 0.1809728 Test Loss: 0.2680614
Validation loss decreased (0.182820 --> 0.180973).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 20 cost time: 0.9703841209411621
Epoch: 20, Steps: 64 | Train Loss: 0.0678777 Vali Loss: 0.1821568 Test Loss: 0.2692666
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 21 cost time: 0.9573974609375
Epoch: 21, Steps: 64 | Train Loss: 0.0680753 Vali Loss: 0.1824861 Test Loss: 0.2667826
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 22 cost time: 0.9334194660186768
Epoch: 22, Steps: 64 | Train Loss: 0.0676403 Vali Loss: 0.1813317 Test Loss: 0.2682389
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 23 cost time: 0.9553580284118652
Epoch: 23, Steps: 64 | Train Loss: 0.0678588 Vali Loss: 0.1789398 Test Loss: 0.2674538
Validation loss decreased (0.180973 --> 0.178940).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 24 cost time: 0.9542908668518066
Epoch: 24, Steps: 64 | Train Loss: 0.0672832 Vali Loss: 0.1833512 Test Loss: 0.2690537
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 25 cost time: 0.9547505378723145
Epoch: 25, Steps: 64 | Train Loss: 0.0676459 Vali Loss: 0.1773246 Test Loss: 0.2675874
Validation loss decreased (0.178940 --> 0.177325).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 26 cost time: 0.9639999866485596
Epoch: 26, Steps: 64 | Train Loss: 0.0671669 Vali Loss: 0.1818209 Test Loss: 0.2674485
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 27 cost time: 0.9659998416900635
Epoch: 27, Steps: 64 | Train Loss: 0.0672736 Vali Loss: 0.1808300 Test Loss: 0.2670003
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 28 cost time: 0.9630069732666016
Epoch: 28, Steps: 64 | Train Loss: 0.0669914 Vali Loss: 0.1815438 Test Loss: 0.2676957
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 29 cost time: 0.9726128578186035
Epoch: 29, Steps: 64 | Train Loss: 0.0668754 Vali Loss: 0.1773853 Test Loss: 0.2687097
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 30 cost time: 0.9513764381408691
Epoch: 30, Steps: 64 | Train Loss: 0.0668062 Vali Loss: 0.1788285 Test Loss: 0.2684270
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 31 cost time: 0.9673817157745361
Epoch: 31, Steps: 64 | Train Loss: 0.0670630 Vali Loss: 0.1787109 Test Loss: 0.2676185
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 32 cost time: 0.9554007053375244
Epoch: 32, Steps: 64 | Train Loss: 0.0665926 Vali Loss: 0.1798212 Test Loss: 0.2691467
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 33 cost time: 0.9633703231811523
Epoch: 33, Steps: 64 | Train Loss: 0.0670569 Vali Loss: 0.1797780 Test Loss: 0.2683802
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 34 cost time: 0.9675734043121338
Epoch: 34, Steps: 64 | Train Loss: 0.0665630 Vali Loss: 0.1815525 Test Loss: 0.2669465
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 35 cost time: 0.9707591533660889
Epoch: 35, Steps: 64 | Train Loss: 0.0668574 Vali Loss: 0.1801760 Test Loss: 0.2678901
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 36 cost time: 0.9638605117797852
Epoch: 36, Steps: 64 | Train Loss: 0.0667657 Vali Loss: 0.1806089 Test Loss: 0.2672600
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 37 cost time: 0.9627313613891602
Epoch: 37, Steps: 64 | Train Loss: 0.0666385 Vali Loss: 0.1788336 Test Loss: 0.2678217
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 38 cost time: 0.9717533588409424
Epoch: 38, Steps: 64 | Train Loss: 0.0665328 Vali Loss: 0.1786102 Test Loss: 0.2680558
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 39 cost time: 0.9590001106262207
Epoch: 39, Steps: 64 | Train Loss: 0.0664611 Vali Loss: 0.1788839 Test Loss: 0.2684790
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 40 cost time: 0.9609971046447754
Epoch: 40, Steps: 64 | Train Loss: 0.0665283 Vali Loss: 0.1763404 Test Loss: 0.2680154
Validation loss decreased (0.177325 --> 0.176340).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 41 cost time: 0.98262619972229
Epoch: 41, Steps: 64 | Train Loss: 0.0662995 Vali Loss: 0.1807859 Test Loss: 0.2677802
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 42 cost time: 0.9693198204040527
Epoch: 42, Steps: 64 | Train Loss: 0.0669608 Vali Loss: 0.1781065 Test Loss: 0.2674640
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 43 cost time: 0.9663517475128174
Epoch: 43, Steps: 64 | Train Loss: 0.0666078 Vali Loss: 0.1787302 Test Loss: 0.2680724
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 44 cost time: 0.9713840484619141
Epoch: 44, Steps: 64 | Train Loss: 0.0667506 Vali Loss: 0.1784719 Test Loss: 0.2673869
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 45 cost time: 0.9513959884643555
Epoch: 45, Steps: 64 | Train Loss: 0.0659207 Vali Loss: 0.1772216 Test Loss: 0.2674932
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 46 cost time: 0.9554426670074463
Epoch: 46, Steps: 64 | Train Loss: 0.0664327 Vali Loss: 0.1795604 Test Loss: 0.2680360
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 47 cost time: 0.951474666595459
Epoch: 47, Steps: 64 | Train Loss: 0.0667479 Vali Loss: 0.1805637 Test Loss: 0.2684192
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 48 cost time: 0.9679763317108154
Epoch: 48, Steps: 64 | Train Loss: 0.0658903 Vali Loss: 0.1783801 Test Loss: 0.2689681
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 49 cost time: 0.9637846946716309
Epoch: 49, Steps: 64 | Train Loss: 0.0658963 Vali Loss: 0.1791347 Test Loss: 0.2684689
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 50 cost time: 0.9657361507415771
Epoch: 50, Steps: 64 | Train Loss: 0.0659189 Vali Loss: 0.1815535 Test Loss: 0.2674741
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 51 cost time: 0.9659998416900635
Epoch: 51, Steps: 64 | Train Loss: 0.0663815 Vali Loss: 0.1778641 Test Loss: 0.2685248
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 52 cost time: 0.96002197265625
Epoch: 52, Steps: 64 | Train Loss: 0.0667526 Vali Loss: 0.1786807 Test Loss: 0.2684580
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 53 cost time: 0.9616358280181885
Epoch: 53, Steps: 64 | Train Loss: 0.0660796 Vali Loss: 0.1783447 Test Loss: 0.2678121
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 54 cost time: 0.9693567752838135
Epoch: 54, Steps: 64 | Train Loss: 0.0662592 Vali Loss: 0.1759807 Test Loss: 0.2685763
Validation loss decreased (0.176340 --> 0.175981).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 55 cost time: 0.9563698768615723
Epoch: 55, Steps: 64 | Train Loss: 0.0660750 Vali Loss: 0.1807031 Test Loss: 0.2682207
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 56 cost time: 0.9563276767730713
Epoch: 56, Steps: 64 | Train Loss: 0.0659440 Vali Loss: 0.1796998 Test Loss: 0.2683015
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 57 cost time: 0.9594423770904541
Epoch: 57, Steps: 64 | Train Loss: 0.0663528 Vali Loss: 0.1787593 Test Loss: 0.2675714
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 58 cost time: 0.965397834777832
Epoch: 58, Steps: 64 | Train Loss: 0.0660806 Vali Loss: 0.1811849 Test Loss: 0.2678872
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 59 cost time: 0.9683904647827148
Epoch: 59, Steps: 64 | Train Loss: 0.0659985 Vali Loss: 0.1784566 Test Loss: 0.2670157
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 60 cost time: 0.9640300273895264
Epoch: 60, Steps: 64 | Train Loss: 0.0659116 Vali Loss: 0.1794113 Test Loss: 0.2678953
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityBh_336_96_PerioDformer_CityBh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2685762643814087, mae:0.3387160897254944, rse:0.23785190284252167
