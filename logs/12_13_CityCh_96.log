nohup: ignoring input
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03554582595825195 GB
Epoch: 1 cost time: 2.406261920928955
Epoch: 1, Steps: 64 | Train Loss: 1.2106801 Vali Loss: 2.9721599 Test Loss: 4.8067007
Validation loss decreased (inf --> 2.972160).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 2 cost time: 0.9690766334533691
Epoch: 2, Steps: 64 | Train Loss: 1.0326080 Vali Loss: 2.0658689 Test Loss: 3.2791581
Validation loss decreased (2.972160 --> 2.065869).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 3 cost time: 0.9833219051361084
Epoch: 3, Steps: 64 | Train Loss: 0.7606593 Vali Loss: 1.4396706 Test Loss: 2.2250609
Validation loss decreased (2.065869 --> 1.439671).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 4 cost time: 0.9664762020111084
Epoch: 4, Steps: 64 | Train Loss: 0.5600926 Vali Loss: 1.0061522 Test Loss: 1.5031025
Validation loss decreased (1.439671 --> 1.006152).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 5 cost time: 0.9739015102386475
Epoch: 5, Steps: 64 | Train Loss: 0.4263671 Vali Loss: 0.7488071 Test Loss: 1.0852063
Validation loss decreased (1.006152 --> 0.748807).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 6 cost time: 0.9743983745574951
Epoch: 6, Steps: 64 | Train Loss: 0.3470142 Vali Loss: 0.5860543 Test Loss: 0.8215913
Validation loss decreased (0.748807 --> 0.586054).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 7 cost time: 0.896216869354248
Epoch: 7, Steps: 64 | Train Loss: 0.2997844 Vali Loss: 0.4926813 Test Loss: 0.6681446
Validation loss decreased (0.586054 --> 0.492681).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 8 cost time: 0.8849973678588867
Epoch: 8, Steps: 64 | Train Loss: 0.2698344 Vali Loss: 0.4284316 Test Loss: 0.5711745
Validation loss decreased (0.492681 --> 0.428432).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 9 cost time: 0.9100518226623535
Epoch: 9, Steps: 64 | Train Loss: 0.2486668 Vali Loss: 0.3841910 Test Loss: 0.5010221
Validation loss decreased (0.428432 --> 0.384191).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 10 cost time: 0.9206478595733643
Epoch: 10, Steps: 64 | Train Loss: 0.2327491 Vali Loss: 0.3529406 Test Loss: 0.4519216
Validation loss decreased (0.384191 --> 0.352941).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 11 cost time: 0.9528474807739258
Epoch: 11, Steps: 64 | Train Loss: 0.2223485 Vali Loss: 0.3250152 Test Loss: 0.4106230
Validation loss decreased (0.352941 --> 0.325015).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 12 cost time: 0.9504044055938721
Epoch: 12, Steps: 64 | Train Loss: 0.2120235 Vali Loss: 0.3074172 Test Loss: 0.3840753
Validation loss decreased (0.325015 --> 0.307417).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 13 cost time: 0.9430005550384521
Epoch: 13, Steps: 64 | Train Loss: 0.2040109 Vali Loss: 0.2911178 Test Loss: 0.3597396
Validation loss decreased (0.307417 --> 0.291118).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 14 cost time: 0.9256143569946289
Epoch: 14, Steps: 64 | Train Loss: 0.1998576 Vali Loss: 0.2794163 Test Loss: 0.3449222
Validation loss decreased (0.291118 --> 0.279416).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 15 cost time: 0.9208014011383057
Epoch: 15, Steps: 64 | Train Loss: 0.1958019 Vali Loss: 0.2701283 Test Loss: 0.3303031
Validation loss decreased (0.279416 --> 0.270128).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 16 cost time: 0.9250001907348633
Epoch: 16, Steps: 64 | Train Loss: 0.1919621 Vali Loss: 0.2624261 Test Loss: 0.3180326
Validation loss decreased (0.270128 --> 0.262426).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 17 cost time: 0.9356489181518555
Epoch: 17, Steps: 64 | Train Loss: 0.1872858 Vali Loss: 0.2555386 Test Loss: 0.3083679
Validation loss decreased (0.262426 --> 0.255539).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 18 cost time: 0.9375178813934326
Epoch: 18, Steps: 64 | Train Loss: 0.1850186 Vali Loss: 0.2485995 Test Loss: 0.3001086
Validation loss decreased (0.255539 --> 0.248599).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 19 cost time: 0.9434618949890137
Epoch: 19, Steps: 64 | Train Loss: 0.1826945 Vali Loss: 0.2451389 Test Loss: 0.2944232
Validation loss decreased (0.248599 --> 0.245139).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 20 cost time: 0.9330005645751953
Epoch: 20, Steps: 64 | Train Loss: 0.1803954 Vali Loss: 0.2411404 Test Loss: 0.2897349
Validation loss decreased (0.245139 --> 0.241140).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 21 cost time: 0.9352860450744629
Epoch: 21, Steps: 64 | Train Loss: 0.1794594 Vali Loss: 0.2391290 Test Loss: 0.2875378
Validation loss decreased (0.241140 --> 0.239129).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 22 cost time: 0.8987288475036621
Epoch: 22, Steps: 64 | Train Loss: 0.1776649 Vali Loss: 0.2317154 Test Loss: 0.2806138
Validation loss decreased (0.239129 --> 0.231715).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 23 cost time: 0.8969993591308594
Epoch: 23, Steps: 64 | Train Loss: 0.1761494 Vali Loss: 0.2330133 Test Loss: 0.2759630
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 24 cost time: 0.9046187400817871
Epoch: 24, Steps: 64 | Train Loss: 0.1750967 Vali Loss: 0.2292109 Test Loss: 0.2729378
Validation loss decreased (0.231715 --> 0.229211).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 25 cost time: 0.8930001258850098
Epoch: 25, Steps: 64 | Train Loss: 0.1733893 Vali Loss: 0.2276439 Test Loss: 0.2727177
Validation loss decreased (0.229211 --> 0.227644).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 26 cost time: 0.9147336483001709
Epoch: 26, Steps: 64 | Train Loss: 0.1726513 Vali Loss: 0.2246208 Test Loss: 0.2715415
Validation loss decreased (0.227644 --> 0.224621).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 27 cost time: 0.8870751857757568
Epoch: 27, Steps: 64 | Train Loss: 0.1713543 Vali Loss: 0.2258689 Test Loss: 0.2677752
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 28 cost time: 0.8980000019073486
Epoch: 28, Steps: 64 | Train Loss: 0.1727262 Vali Loss: 0.2236054 Test Loss: 0.2663997
Validation loss decreased (0.224621 --> 0.223605).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 29 cost time: 0.887214183807373
Epoch: 29, Steps: 64 | Train Loss: 0.1705694 Vali Loss: 0.2202381 Test Loss: 0.2632098
Validation loss decreased (0.223605 --> 0.220238).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 30 cost time: 0.9069993495941162
Epoch: 30, Steps: 64 | Train Loss: 0.1695126 Vali Loss: 0.2217114 Test Loss: 0.2633000
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 31 cost time: 0.9326303005218506
Epoch: 31, Steps: 64 | Train Loss: 0.1691095 Vali Loss: 0.2188874 Test Loss: 0.2607781
Validation loss decreased (0.220238 --> 0.218887).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 32 cost time: 0.9173364639282227
Epoch: 32, Steps: 64 | Train Loss: 0.1693666 Vali Loss: 0.2173633 Test Loss: 0.2611697
Validation loss decreased (0.218887 --> 0.217363).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 33 cost time: 0.9273874759674072
Epoch: 33, Steps: 64 | Train Loss: 0.1694246 Vali Loss: 0.2167698 Test Loss: 0.2601473
Validation loss decreased (0.217363 --> 0.216770).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 34 cost time: 0.9219996929168701
Epoch: 34, Steps: 64 | Train Loss: 0.1688752 Vali Loss: 0.2193038 Test Loss: 0.2598270
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 35 cost time: 0.9352681636810303
Epoch: 35, Steps: 64 | Train Loss: 0.1692415 Vali Loss: 0.2149360 Test Loss: 0.2574884
Validation loss decreased (0.216770 --> 0.214936).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 36 cost time: 0.928002119064331
Epoch: 36, Steps: 64 | Train Loss: 0.1689471 Vali Loss: 0.2179277 Test Loss: 0.2570413
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 37 cost time: 0.9196295738220215
Epoch: 37, Steps: 64 | Train Loss: 0.1677749 Vali Loss: 0.2184827 Test Loss: 0.2579912
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 38 cost time: 0.9339995384216309
Epoch: 38, Steps: 64 | Train Loss: 0.1671573 Vali Loss: 0.2172980 Test Loss: 0.2597112
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 39 cost time: 0.9286432266235352
Epoch: 39, Steps: 64 | Train Loss: 0.1675649 Vali Loss: 0.2148186 Test Loss: 0.2543140
Validation loss decreased (0.214936 --> 0.214819).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 40 cost time: 0.9319987297058105
Epoch: 40, Steps: 64 | Train Loss: 0.1671038 Vali Loss: 0.2165962 Test Loss: 0.2574044
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 41 cost time: 0.9096262454986572
Epoch: 41, Steps: 64 | Train Loss: 0.1662892 Vali Loss: 0.2140007 Test Loss: 0.2543589
Validation loss decreased (0.214819 --> 0.214001).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 42 cost time: 0.912653923034668
Epoch: 42, Steps: 64 | Train Loss: 0.1666675 Vali Loss: 0.2137167 Test Loss: 0.2534961
Validation loss decreased (0.214001 --> 0.213717).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 43 cost time: 0.8959991931915283
Epoch: 43, Steps: 64 | Train Loss: 0.1663643 Vali Loss: 0.2157252 Test Loss: 0.2553608
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 44 cost time: 0.914609432220459
Epoch: 44, Steps: 64 | Train Loss: 0.1663083 Vali Loss: 0.2145059 Test Loss: 0.2548093
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 45 cost time: 0.922001838684082
Epoch: 45, Steps: 64 | Train Loss: 0.1657500 Vali Loss: 0.2151482 Test Loss: 0.2571725
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 46 cost time: 0.9256546497344971
Epoch: 46, Steps: 64 | Train Loss: 0.1664068 Vali Loss: 0.2152737 Test Loss: 0.2525955
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 47 cost time: 0.9110016822814941
Epoch: 47, Steps: 64 | Train Loss: 0.1654569 Vali Loss: 0.2120330 Test Loss: 0.2519034
Validation loss decreased (0.213717 --> 0.212033).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 48 cost time: 0.9085879325866699
Epoch: 48, Steps: 64 | Train Loss: 0.1656101 Vali Loss: 0.2144209 Test Loss: 0.2532039
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 49 cost time: 0.9189999103546143
Epoch: 49, Steps: 64 | Train Loss: 0.1665136 Vali Loss: 0.2129535 Test Loss: 0.2517552
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 50 cost time: 0.9066240787506104
Epoch: 50, Steps: 64 | Train Loss: 0.1661366 Vali Loss: 0.2148575 Test Loss: 0.2552497
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 51 cost time: 0.9179995059967041
Epoch: 51, Steps: 64 | Train Loss: 0.1662555 Vali Loss: 0.2132597 Test Loss: 0.2530662
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 52 cost time: 0.9182188510894775
Epoch: 52, Steps: 64 | Train Loss: 0.1659460 Vali Loss: 0.2122512 Test Loss: 0.2541230
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 53 cost time: 0.8883869647979736
Epoch: 53, Steps: 64 | Train Loss: 0.1660260 Vali Loss: 0.2140336 Test Loss: 0.2546268
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 54 cost time: 0.8824164867401123
Epoch: 54, Steps: 64 | Train Loss: 0.1657358 Vali Loss: 0.2118548 Test Loss: 0.2513488
Validation loss decreased (0.212033 --> 0.211855).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 55 cost time: 0.8637325763702393
Epoch: 55, Steps: 64 | Train Loss: 0.1660886 Vali Loss: 0.2131907 Test Loss: 0.2538918
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 56 cost time: 0.924401044845581
Epoch: 56, Steps: 64 | Train Loss: 0.1644290 Vali Loss: 0.2129628 Test Loss: 0.2528987
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 57 cost time: 0.918137788772583
Epoch: 57, Steps: 64 | Train Loss: 0.1659187 Vali Loss: 0.2135582 Test Loss: 0.2508831
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 58 cost time: 0.9186468124389648
Epoch: 58, Steps: 64 | Train Loss: 0.1652470 Vali Loss: 0.2126813 Test Loss: 0.2524535
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 59 cost time: 0.913909912109375
Epoch: 59, Steps: 64 | Train Loss: 0.1661134 Vali Loss: 0.2139607 Test Loss: 0.2524656
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 60 cost time: 0.9139471054077148
Epoch: 60, Steps: 64 | Train Loss: 0.1646538 Vali Loss: 0.2133132 Test Loss: 0.2537149
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2513487935066223, mae:0.36166611313819885, rse:0.25408121943473816
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.03624725341796875 GB
Epoch: 1 cost time: 2.2682552337646484
Epoch: 1, Steps: 64 | Train Loss: 1.1324485 Vali Loss: 2.9717400 Test Loss: 4.7738657
Validation loss decreased (inf --> 2.971740).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 2 cost time: 0.9009511470794678
Epoch: 2, Steps: 64 | Train Loss: 0.9220667 Vali Loss: 1.9160514 Test Loss: 3.0030422
Validation loss decreased (2.971740 --> 1.916051).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 3 cost time: 0.9017729759216309
Epoch: 3, Steps: 64 | Train Loss: 0.6207731 Vali Loss: 1.2237391 Test Loss: 1.8600075
Validation loss decreased (1.916051 --> 1.223739).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 4 cost time: 0.8699989318847656
Epoch: 4, Steps: 64 | Train Loss: 0.4146667 Vali Loss: 0.7254378 Test Loss: 1.0376257
Validation loss decreased (1.223739 --> 0.725438).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 5 cost time: 0.8626465797424316
Epoch: 5, Steps: 64 | Train Loss: 0.2859986 Vali Loss: 0.4701247 Test Loss: 0.6142610
Validation loss decreased (0.725438 --> 0.470125).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 6 cost time: 0.8454306125640869
Epoch: 6, Steps: 64 | Train Loss: 0.2220587 Vali Loss: 0.3459426 Test Loss: 0.4159514
Validation loss decreased (0.470125 --> 0.345943).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 7 cost time: 0.8549418449401855
Epoch: 7, Steps: 64 | Train Loss: 0.1907427 Vali Loss: 0.2898375 Test Loss: 0.3293726
Validation loss decreased (0.345943 --> 0.289838).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 8 cost time: 0.8383495807647705
Epoch: 8, Steps: 64 | Train Loss: 0.1767592 Vali Loss: 0.2586487 Test Loss: 0.2863090
Validation loss decreased (0.289838 --> 0.258649).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 9 cost time: 0.8479979038238525
Epoch: 9, Steps: 64 | Train Loss: 0.1679353 Vali Loss: 0.2457552 Test Loss: 0.2703930
Validation loss decreased (0.258649 --> 0.245755).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 10 cost time: 0.8482217788696289
Epoch: 10, Steps: 64 | Train Loss: 0.1627027 Vali Loss: 0.2335974 Test Loss: 0.2599439
Validation loss decreased (0.245755 --> 0.233597).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 11 cost time: 0.8633029460906982
Epoch: 11, Steps: 64 | Train Loss: 0.1587215 Vali Loss: 0.2271964 Test Loss: 0.2527378
Validation loss decreased (0.233597 --> 0.227196).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 12 cost time: 0.8864035606384277
Epoch: 12, Steps: 64 | Train Loss: 0.1564357 Vali Loss: 0.2221584 Test Loss: 0.2511375
Validation loss decreased (0.227196 --> 0.222158).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 13 cost time: 0.8807761669158936
Epoch: 13, Steps: 64 | Train Loss: 0.1542829 Vali Loss: 0.2203686 Test Loss: 0.2478111
Validation loss decreased (0.222158 --> 0.220369).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 14 cost time: 0.8919992446899414
Epoch: 14, Steps: 64 | Train Loss: 0.1515280 Vali Loss: 0.2186728 Test Loss: 0.2475744
Validation loss decreased (0.220369 --> 0.218673).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 15 cost time: 0.8676414489746094
Epoch: 15, Steps: 64 | Train Loss: 0.1510400 Vali Loss: 0.2151753 Test Loss: 0.2452066
Validation loss decreased (0.218673 --> 0.215175).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 16 cost time: 0.8624434471130371
Epoch: 16, Steps: 64 | Train Loss: 0.1486236 Vali Loss: 0.2135812 Test Loss: 0.2433475
Validation loss decreased (0.215175 --> 0.213581).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 17 cost time: 0.8638761043548584
Epoch: 17, Steps: 64 | Train Loss: 0.1477060 Vali Loss: 0.2148832 Test Loss: 0.2442819
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 18 cost time: 0.8713357448577881
Epoch: 18, Steps: 64 | Train Loss: 0.1468439 Vali Loss: 0.2124495 Test Loss: 0.2427160
Validation loss decreased (0.213581 --> 0.212449).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 19 cost time: 0.8598172664642334
Epoch: 19, Steps: 64 | Train Loss: 0.1452623 Vali Loss: 0.2103070 Test Loss: 0.2411304
Validation loss decreased (0.212449 --> 0.210307).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 20 cost time: 0.8815274238586426
Epoch: 20, Steps: 64 | Train Loss: 0.1450922 Vali Loss: 0.2091168 Test Loss: 0.2414468
Validation loss decreased (0.210307 --> 0.209117).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 21 cost time: 0.8982856273651123
Epoch: 21, Steps: 64 | Train Loss: 0.1446963 Vali Loss: 0.2076201 Test Loss: 0.2409239
Validation loss decreased (0.209117 --> 0.207620).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 22 cost time: 0.8913571834564209
Epoch: 22, Steps: 64 | Train Loss: 0.1434517 Vali Loss: 0.2086314 Test Loss: 0.2412466
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 23 cost time: 0.8720569610595703
Epoch: 23, Steps: 64 | Train Loss: 0.1425468 Vali Loss: 0.2061287 Test Loss: 0.2400247
Validation loss decreased (0.207620 --> 0.206129).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 24 cost time: 0.862762451171875
Epoch: 24, Steps: 64 | Train Loss: 0.1416723 Vali Loss: 0.2079151 Test Loss: 0.2410672
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 25 cost time: 0.8695063591003418
Epoch: 25, Steps: 64 | Train Loss: 0.1417656 Vali Loss: 0.2048790 Test Loss: 0.2410047
Validation loss decreased (0.206129 --> 0.204879).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 26 cost time: 0.8646206855773926
Epoch: 26, Steps: 64 | Train Loss: 0.1411550 Vali Loss: 0.2054428 Test Loss: 0.2401609
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 27 cost time: 0.8564372062683105
Epoch: 27, Steps: 64 | Train Loss: 0.1415780 Vali Loss: 0.2061277 Test Loss: 0.2406610
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 28 cost time: 0.8624284267425537
Epoch: 28, Steps: 64 | Train Loss: 0.1405569 Vali Loss: 0.2039464 Test Loss: 0.2401402
Validation loss decreased (0.204879 --> 0.203946).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 29 cost time: 0.8878424167633057
Epoch: 29, Steps: 64 | Train Loss: 0.1409987 Vali Loss: 0.2062218 Test Loss: 0.2408461
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 30 cost time: 0.877000093460083
Epoch: 30, Steps: 64 | Train Loss: 0.1403860 Vali Loss: 0.2048724 Test Loss: 0.2405059
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 31 cost time: 0.8736310005187988
Epoch: 31, Steps: 64 | Train Loss: 0.1393474 Vali Loss: 0.2059334 Test Loss: 0.2407966
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 32 cost time: 0.8783948421478271
Epoch: 32, Steps: 64 | Train Loss: 0.1393866 Vali Loss: 0.2036507 Test Loss: 0.2395678
Validation loss decreased (0.203946 --> 0.203651).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 33 cost time: 0.8813881874084473
Epoch: 33, Steps: 64 | Train Loss: 0.1401464 Vali Loss: 0.2030750 Test Loss: 0.2398450
Validation loss decreased (0.203651 --> 0.203075).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 34 cost time: 0.8797929286956787
Epoch: 34, Steps: 64 | Train Loss: 0.1395841 Vali Loss: 0.2051006 Test Loss: 0.2413885
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 35 cost time: 0.8790013790130615
Epoch: 35, Steps: 64 | Train Loss: 0.1387580 Vali Loss: 0.2044148 Test Loss: 0.2400013
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 36 cost time: 0.8799984455108643
Epoch: 36, Steps: 64 | Train Loss: 0.1391563 Vali Loss: 0.2051126 Test Loss: 0.2411655
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 37 cost time: 0.8713886737823486
Epoch: 37, Steps: 64 | Train Loss: 0.1388529 Vali Loss: 0.2043598 Test Loss: 0.2406986
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 38 cost time: 0.9013583660125732
Epoch: 38, Steps: 64 | Train Loss: 0.1387325 Vali Loss: 0.2022571 Test Loss: 0.2399849
Validation loss decreased (0.203075 --> 0.202257).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 39 cost time: 0.8975419998168945
Epoch: 39, Steps: 64 | Train Loss: 0.1381387 Vali Loss: 0.2016479 Test Loss: 0.2405808
Validation loss decreased (0.202257 --> 0.201648).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 40 cost time: 0.907249927520752
Epoch: 40, Steps: 64 | Train Loss: 0.1380957 Vali Loss: 0.2034391 Test Loss: 0.2397086
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 41 cost time: 0.9049992561340332
Epoch: 41, Steps: 64 | Train Loss: 0.1380194 Vali Loss: 0.2042111 Test Loss: 0.2391145
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 42 cost time: 0.8996400833129883
Epoch: 42, Steps: 64 | Train Loss: 0.1376754 Vali Loss: 0.2034877 Test Loss: 0.2413633
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 43 cost time: 0.8687992095947266
Epoch: 43, Steps: 64 | Train Loss: 0.1373813 Vali Loss: 0.2009150 Test Loss: 0.2390522
Validation loss decreased (0.201648 --> 0.200915).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 44 cost time: 0.8404726982116699
Epoch: 44, Steps: 64 | Train Loss: 0.1383159 Vali Loss: 0.2026040 Test Loss: 0.2400980
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 45 cost time: 0.8554096221923828
Epoch: 45, Steps: 64 | Train Loss: 0.1382321 Vali Loss: 0.2030193 Test Loss: 0.2397050
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 46 cost time: 0.8569974899291992
Epoch: 46, Steps: 64 | Train Loss: 0.1379006 Vali Loss: 0.2028091 Test Loss: 0.2400247
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 47 cost time: 0.8856499195098877
Epoch: 47, Steps: 64 | Train Loss: 0.1378712 Vali Loss: 0.2034423 Test Loss: 0.2395472
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 48 cost time: 0.8699111938476562
Epoch: 48, Steps: 64 | Train Loss: 0.1370987 Vali Loss: 0.2016687 Test Loss: 0.2392904
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 49 cost time: 0.8714091777801514
Epoch: 49, Steps: 64 | Train Loss: 0.1377825 Vali Loss: 0.2042978 Test Loss: 0.2396443
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 50 cost time: 0.8814899921417236
Epoch: 50, Steps: 64 | Train Loss: 0.1377434 Vali Loss: 0.2017735 Test Loss: 0.2399250
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 51 cost time: 0.8855292797088623
Epoch: 51, Steps: 64 | Train Loss: 0.1370215 Vali Loss: 0.2029087 Test Loss: 0.2394131
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 52 cost time: 0.8545477390289307
Epoch: 52, Steps: 64 | Train Loss: 0.1377975 Vali Loss: 0.2028382 Test Loss: 0.2406063
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 53 cost time: 0.8596274852752686
Epoch: 53, Steps: 64 | Train Loss: 0.1375167 Vali Loss: 0.2005231 Test Loss: 0.2402039
Validation loss decreased (0.200915 --> 0.200523).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 54 cost time: 0.8654115200042725
Epoch: 54, Steps: 64 | Train Loss: 0.1376900 Vali Loss: 0.2018128 Test Loss: 0.2400943
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 55 cost time: 0.8994324207305908
Epoch: 55, Steps: 64 | Train Loss: 0.1374111 Vali Loss: 0.1992470 Test Loss: 0.2391929
Validation loss decreased (0.200523 --> 0.199247).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 56 cost time: 0.892988920211792
Epoch: 56, Steps: 64 | Train Loss: 0.1378077 Vali Loss: 0.2025882 Test Loss: 0.2394582
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 57 cost time: 0.8946239948272705
Epoch: 57, Steps: 64 | Train Loss: 0.1376742 Vali Loss: 0.1997940 Test Loss: 0.2392395
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 58 cost time: 0.8996443748474121
Epoch: 58, Steps: 64 | Train Loss: 0.1376885 Vali Loss: 0.2036006 Test Loss: 0.2399585
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 59 cost time: 0.8944690227508545
Epoch: 59, Steps: 64 | Train Loss: 0.1371891 Vali Loss: 0.2041019 Test Loss: 0.2396750
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 60 cost time: 0.901435375213623
Epoch: 60, Steps: 64 | Train Loss: 0.1376191 Vali Loss: 0.2028912 Test Loss: 0.2395830
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2391929179430008, mae:0.3591665029525757, rse:0.24786105751991272
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03681135177612305 GB
Epoch: 1 cost time: 2.285252332687378
Epoch: 1, Steps: 64 | Train Loss: 0.9322368 Vali Loss: 2.5179231 Test Loss: 4.0639553
Validation loss decreased (inf --> 2.517923).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 2 cost time: 0.9549546241760254
Epoch: 2, Steps: 64 | Train Loss: 0.8003441 Vali Loss: 1.7923989 Test Loss: 2.8426957
Validation loss decreased (2.517923 --> 1.792399).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 3 cost time: 0.945775032043457
Epoch: 3, Steps: 64 | Train Loss: 0.5633477 Vali Loss: 1.1061784 Test Loss: 1.7004782
Validation loss decreased (1.792399 --> 1.106178).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 4 cost time: 0.9529988765716553
Epoch: 4, Steps: 64 | Train Loss: 0.3544571 Vali Loss: 0.5569566 Test Loss: 0.7983298
Validation loss decreased (1.106178 --> 0.556957).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 5 cost time: 0.9580001831054688
Epoch: 5, Steps: 64 | Train Loss: 0.2257710 Vali Loss: 0.3332112 Test Loss: 0.4302880
Validation loss decreased (0.556957 --> 0.333211).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 6 cost time: 0.9372694492340088
Epoch: 6, Steps: 64 | Train Loss: 0.1790791 Vali Loss: 0.2570304 Test Loss: 0.3178001
Validation loss decreased (0.333211 --> 0.257030).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 7 cost time: 0.9323656558990479
Epoch: 7, Steps: 64 | Train Loss: 0.1628310 Vali Loss: 0.2291791 Test Loss: 0.2838943
Validation loss decreased (0.257030 --> 0.229179).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 8 cost time: 0.9243535995483398
Epoch: 8, Steps: 64 | Train Loss: 0.1552033 Vali Loss: 0.2150888 Test Loss: 0.2662481
Validation loss decreased (0.229179 --> 0.215089).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 9 cost time: 0.9304952621459961
Epoch: 9, Steps: 64 | Train Loss: 0.1503379 Vali Loss: 0.2106357 Test Loss: 0.2594304
Validation loss decreased (0.215089 --> 0.210636).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 10 cost time: 0.9725255966186523
Epoch: 10, Steps: 64 | Train Loss: 0.1464891 Vali Loss: 0.2022386 Test Loss: 0.2516233
Validation loss decreased (0.210636 --> 0.202239).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 11 cost time: 0.9737510681152344
Epoch: 11, Steps: 64 | Train Loss: 0.1443798 Vali Loss: 0.1994431 Test Loss: 0.2476702
Validation loss decreased (0.202239 --> 0.199443).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 12 cost time: 0.9758646488189697
Epoch: 12, Steps: 64 | Train Loss: 0.1422292 Vali Loss: 0.1977381 Test Loss: 0.2474457
Validation loss decreased (0.199443 --> 0.197738).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 13 cost time: 0.9769999980926514
Epoch: 13, Steps: 64 | Train Loss: 0.1400886 Vali Loss: 0.1906402 Test Loss: 0.2432807
Validation loss decreased (0.197738 --> 0.190640).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 14 cost time: 0.9729771614074707
Epoch: 14, Steps: 64 | Train Loss: 0.1397351 Vali Loss: 0.1953602 Test Loss: 0.2432595
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 15 cost time: 0.9736552238464355
Epoch: 15, Steps: 64 | Train Loss: 0.1371540 Vali Loss: 0.1927865 Test Loss: 0.2426290
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 16 cost time: 0.9473743438720703
Epoch: 16, Steps: 64 | Train Loss: 0.1365565 Vali Loss: 0.1910625 Test Loss: 0.2401807
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 17 cost time: 0.9559509754180908
Epoch: 17, Steps: 64 | Train Loss: 0.1355626 Vali Loss: 0.1905571 Test Loss: 0.2393665
Validation loss decreased (0.190640 --> 0.190557).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 18 cost time: 0.9540054798126221
Epoch: 18, Steps: 64 | Train Loss: 0.1354124 Vali Loss: 0.1899354 Test Loss: 0.2392891
Validation loss decreased (0.190557 --> 0.189935).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 19 cost time: 0.9673974514007568
Epoch: 19, Steps: 64 | Train Loss: 0.1346467 Vali Loss: 0.1909114 Test Loss: 0.2394605
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 20 cost time: 0.9554016590118408
Epoch: 20, Steps: 64 | Train Loss: 0.1333966 Vali Loss: 0.1884165 Test Loss: 0.2390561
Validation loss decreased (0.189935 --> 0.188417).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 21 cost time: 0.9467504024505615
Epoch: 21, Steps: 64 | Train Loss: 0.1338759 Vali Loss: 0.1900958 Test Loss: 0.2403492
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 22 cost time: 0.9558374881744385
Epoch: 22, Steps: 64 | Train Loss: 0.1328695 Vali Loss: 0.1897229 Test Loss: 0.2397354
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 23 cost time: 0.9386422634124756
Epoch: 23, Steps: 64 | Train Loss: 0.1324939 Vali Loss: 0.1874496 Test Loss: 0.2374590
Validation loss decreased (0.188417 --> 0.187450).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 24 cost time: 0.9334039688110352
Epoch: 24, Steps: 64 | Train Loss: 0.1316816 Vali Loss: 0.1877508 Test Loss: 0.2373185
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 25 cost time: 0.9413917064666748
Epoch: 25, Steps: 64 | Train Loss: 0.1313889 Vali Loss: 0.1887366 Test Loss: 0.2392584
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 26 cost time: 0.9323439598083496
Epoch: 26, Steps: 64 | Train Loss: 0.1307674 Vali Loss: 0.1868183 Test Loss: 0.2359853
Validation loss decreased (0.187450 --> 0.186818).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 27 cost time: 0.9530718326568604
Epoch: 27, Steps: 64 | Train Loss: 0.1310562 Vali Loss: 0.1878612 Test Loss: 0.2371034
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 28 cost time: 0.9493718147277832
Epoch: 28, Steps: 64 | Train Loss: 0.1306356 Vali Loss: 0.1887776 Test Loss: 0.2381976
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 29 cost time: 0.9757871627807617
Epoch: 29, Steps: 64 | Train Loss: 0.1302778 Vali Loss: 0.1875536 Test Loss: 0.2373995
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 30 cost time: 0.9820020198822021
Epoch: 30, Steps: 64 | Train Loss: 0.1305453 Vali Loss: 0.1860618 Test Loss: 0.2367390
Validation loss decreased (0.186818 --> 0.186062).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 31 cost time: 0.9846222400665283
Epoch: 31, Steps: 64 | Train Loss: 0.1302182 Vali Loss: 0.1857929 Test Loss: 0.2376192
Validation loss decreased (0.186062 --> 0.185793).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 32 cost time: 0.9566299915313721
Epoch: 32, Steps: 64 | Train Loss: 0.1298851 Vali Loss: 0.1859513 Test Loss: 0.2362843
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 33 cost time: 0.9563751220703125
Epoch: 33, Steps: 64 | Train Loss: 0.1300567 Vali Loss: 0.1868756 Test Loss: 0.2356737
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 34 cost time: 0.9503684043884277
Epoch: 34, Steps: 64 | Train Loss: 0.1292632 Vali Loss: 0.1862746 Test Loss: 0.2369177
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 35 cost time: 0.9535267353057861
Epoch: 35, Steps: 64 | Train Loss: 0.1298702 Vali Loss: 0.1855418 Test Loss: 0.2359922
Validation loss decreased (0.185793 --> 0.185542).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 36 cost time: 0.9953763484954834
Epoch: 36, Steps: 64 | Train Loss: 0.1299786 Vali Loss: 0.1865358 Test Loss: 0.2368499
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 37 cost time: 0.9649903774261475
Epoch: 37, Steps: 64 | Train Loss: 0.1298941 Vali Loss: 0.1827668 Test Loss: 0.2360377
Validation loss decreased (0.185542 --> 0.182767).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 38 cost time: 0.9587459564208984
Epoch: 38, Steps: 64 | Train Loss: 0.1297888 Vali Loss: 0.1860306 Test Loss: 0.2365444
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 39 cost time: 0.9549987316131592
Epoch: 39, Steps: 64 | Train Loss: 0.1295707 Vali Loss: 0.1857447 Test Loss: 0.2356553
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 40 cost time: 0.9286317825317383
Epoch: 40, Steps: 64 | Train Loss: 0.1297513 Vali Loss: 0.1864738 Test Loss: 0.2357877
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 41 cost time: 0.9326412677764893
Epoch: 41, Steps: 64 | Train Loss: 0.1293773 Vali Loss: 0.1858220 Test Loss: 0.2368884
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 42 cost time: 0.9294712543487549
Epoch: 42, Steps: 64 | Train Loss: 0.1297116 Vali Loss: 0.1867228 Test Loss: 0.2364731
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 43 cost time: 0.9333600997924805
Epoch: 43, Steps: 64 | Train Loss: 0.1288684 Vali Loss: 0.1844202 Test Loss: 0.2374600
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 44 cost time: 0.9393265247344971
Epoch: 44, Steps: 64 | Train Loss: 0.1293044 Vali Loss: 0.1853404 Test Loss: 0.2372556
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 45 cost time: 0.947223424911499
Epoch: 45, Steps: 64 | Train Loss: 0.1295268 Vali Loss: 0.1865108 Test Loss: 0.2361672
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 46 cost time: 0.9557867050170898
Epoch: 46, Steps: 64 | Train Loss: 0.1294850 Vali Loss: 0.1845226 Test Loss: 0.2366557
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 47 cost time: 0.9539992809295654
Epoch: 47, Steps: 64 | Train Loss: 0.1288611 Vali Loss: 0.1846562 Test Loss: 0.2353869
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 48 cost time: 0.9706308841705322
Epoch: 48, Steps: 64 | Train Loss: 0.1290716 Vali Loss: 0.1843394 Test Loss: 0.2355485
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 49 cost time: 0.9616327285766602
Epoch: 49, Steps: 64 | Train Loss: 0.1292061 Vali Loss: 0.1866774 Test Loss: 0.2385928
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 50 cost time: 0.9547746181488037
Epoch: 50, Steps: 64 | Train Loss: 0.1283391 Vali Loss: 0.1848818 Test Loss: 0.2355007
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 51 cost time: 0.9544453620910645
Epoch: 51, Steps: 64 | Train Loss: 0.1290213 Vali Loss: 0.1866861 Test Loss: 0.2360504
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 52 cost time: 0.9487864971160889
Epoch: 52, Steps: 64 | Train Loss: 0.1283267 Vali Loss: 0.1841107 Test Loss: 0.2352098
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 53 cost time: 0.9728994369506836
Epoch: 53, Steps: 64 | Train Loss: 0.1292220 Vali Loss: 0.1864787 Test Loss: 0.2351344
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 54 cost time: 0.9717457294464111
Epoch: 54, Steps: 64 | Train Loss: 0.1290340 Vali Loss: 0.1858201 Test Loss: 0.2358575
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 55 cost time: 0.9757146835327148
Epoch: 55, Steps: 64 | Train Loss: 0.1288306 Vali Loss: 0.1863119 Test Loss: 0.2368446
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 56 cost time: 0.9490008354187012
Epoch: 56, Steps: 64 | Train Loss: 0.1286468 Vali Loss: 0.1844804 Test Loss: 0.2348388
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 57 cost time: 0.9475808143615723
Epoch: 57, Steps: 64 | Train Loss: 0.1288320 Vali Loss: 0.1851903 Test Loss: 0.2363812
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 58 cost time: 0.9495041370391846
Epoch: 58, Steps: 64 | Train Loss: 0.1288901 Vali Loss: 0.1852419 Test Loss: 0.2351598
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 59 cost time: 0.9429583549499512
Epoch: 59, Steps: 64 | Train Loss: 0.1292716 Vali Loss: 0.1860750 Test Loss: 0.2358246
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 60 cost time: 0.946373701095581
Epoch: 60, Steps: 64 | Train Loss: 0.1286288 Vali Loss: 0.1855560 Test Loss: 0.2360499
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2360377162694931, mae:0.34910809993743896, rse:0.24622085690498352
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03570699691772461 GB
Epoch: 1 cost time: 2.217221260070801
Epoch: 1, Steps: 64 | Train Loss: 1.2665283 Vali Loss: 3.1367512 Test Loss: 5.0120902
Validation loss decreased (inf --> 3.136751).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 2 cost time: 0.8565402030944824
Epoch: 2, Steps: 64 | Train Loss: 1.0256350 Vali Loss: 1.9761622 Test Loss: 3.1058295
Validation loss decreased (3.136751 --> 1.976162).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 3 cost time: 0.8640003204345703
Epoch: 3, Steps: 64 | Train Loss: 0.7002860 Vali Loss: 1.2616419 Test Loss: 1.9173334
Validation loss decreased (1.976162 --> 1.261642).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 4 cost time: 0.8640949726104736
Epoch: 4, Steps: 64 | Train Loss: 0.4750547 Vali Loss: 0.8206174 Test Loss: 1.1981866
Validation loss decreased (1.261642 --> 0.820617).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 5 cost time: 0.8634185791015625
Epoch: 5, Steps: 64 | Train Loss: 0.3658695 Vali Loss: 0.6415969 Test Loss: 0.9124845
Validation loss decreased (0.820617 --> 0.641597).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 6 cost time: 0.8313679695129395
Epoch: 6, Steps: 64 | Train Loss: 0.3051211 Vali Loss: 0.5286385 Test Loss: 0.7403864
Validation loss decreased (0.641597 --> 0.528639).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 7 cost time: 0.8401618003845215
Epoch: 7, Steps: 64 | Train Loss: 0.2658939 Vali Loss: 0.4584517 Test Loss: 0.6329816
Validation loss decreased (0.528639 --> 0.458452).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 8 cost time: 0.8310351371765137
Epoch: 8, Steps: 64 | Train Loss: 0.2411452 Vali Loss: 0.4040502 Test Loss: 0.5535315
Validation loss decreased (0.458452 --> 0.404050).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 9 cost time: 0.8326480388641357
Epoch: 9, Steps: 64 | Train Loss: 0.2220722 Vali Loss: 0.3570295 Test Loss: 0.4926669
Validation loss decreased (0.404050 --> 0.357030).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 10 cost time: 0.8339657783508301
Epoch: 10, Steps: 64 | Train Loss: 0.2078599 Vali Loss: 0.3301132 Test Loss: 0.4459670
Validation loss decreased (0.357030 --> 0.330113).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 11 cost time: 0.8509998321533203
Epoch: 11, Steps: 64 | Train Loss: 0.1979763 Vali Loss: 0.3024767 Test Loss: 0.4075131
Validation loss decreased (0.330113 --> 0.302477).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 12 cost time: 0.864630937576294
Epoch: 12, Steps: 64 | Train Loss: 0.1894758 Vali Loss: 0.2876724 Test Loss: 0.3860112
Validation loss decreased (0.302477 --> 0.287672).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 13 cost time: 0.876000165939331
Epoch: 13, Steps: 64 | Train Loss: 0.1819617 Vali Loss: 0.2748878 Test Loss: 0.3671283
Validation loss decreased (0.287672 --> 0.274888).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 14 cost time: 0.8866274356842041
Epoch: 14, Steps: 64 | Train Loss: 0.1780855 Vali Loss: 0.2642266 Test Loss: 0.3503393
Validation loss decreased (0.274888 --> 0.264227).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 15 cost time: 0.8326127529144287
Epoch: 15, Steps: 64 | Train Loss: 0.1733408 Vali Loss: 0.2521613 Test Loss: 0.3367686
Validation loss decreased (0.264227 --> 0.252161).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 16 cost time: 0.8174092769622803
Epoch: 16, Steps: 64 | Train Loss: 0.1715786 Vali Loss: 0.2474850 Test Loss: 0.3304891
Validation loss decreased (0.252161 --> 0.247485).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 17 cost time: 0.8430013656616211
Epoch: 17, Steps: 64 | Train Loss: 0.1672137 Vali Loss: 0.2411744 Test Loss: 0.3198171
Validation loss decreased (0.247485 --> 0.241174).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 18 cost time: 0.8746466636657715
Epoch: 18, Steps: 64 | Train Loss: 0.1648592 Vali Loss: 0.2348707 Test Loss: 0.3089115
Validation loss decreased (0.241174 --> 0.234871).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 19 cost time: 0.8586325645446777
Epoch: 19, Steps: 64 | Train Loss: 0.1630729 Vali Loss: 0.2304090 Test Loss: 0.3031217
Validation loss decreased (0.234871 --> 0.230409).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 20 cost time: 0.8894398212432861
Epoch: 20, Steps: 64 | Train Loss: 0.1611001 Vali Loss: 0.2283158 Test Loss: 0.2993084
Validation loss decreased (0.230409 --> 0.228316).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 21 cost time: 0.8911166191101074
Epoch: 21, Steps: 64 | Train Loss: 0.1608574 Vali Loss: 0.2246182 Test Loss: 0.2967207
Validation loss decreased (0.228316 --> 0.224618).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 22 cost time: 0.8823795318603516
Epoch: 22, Steps: 64 | Train Loss: 0.1600768 Vali Loss: 0.2228905 Test Loss: 0.2940384
Validation loss decreased (0.224618 --> 0.222890).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 23 cost time: 0.84200119972229
Epoch: 23, Steps: 64 | Train Loss: 0.1580817 Vali Loss: 0.2220937 Test Loss: 0.2909950
Validation loss decreased (0.222890 --> 0.222094).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 24 cost time: 0.8352720737457275
Epoch: 24, Steps: 64 | Train Loss: 0.1569815 Vali Loss: 0.2186304 Test Loss: 0.2877697
Validation loss decreased (0.222094 --> 0.218630).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 25 cost time: 0.8286042213439941
Epoch: 25, Steps: 64 | Train Loss: 0.1563378 Vali Loss: 0.2196593 Test Loss: 0.2860832
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 26 cost time: 0.8271350860595703
Epoch: 26, Steps: 64 | Train Loss: 0.1560499 Vali Loss: 0.2168352 Test Loss: 0.2833927
Validation loss decreased (0.218630 --> 0.216835).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 27 cost time: 0.8418047428131104
Epoch: 27, Steps: 64 | Train Loss: 0.1556031 Vali Loss: 0.2153918 Test Loss: 0.2824757
Validation loss decreased (0.216835 --> 0.215392).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 28 cost time: 0.8269996643066406
Epoch: 28, Steps: 64 | Train Loss: 0.1542398 Vali Loss: 0.2129622 Test Loss: 0.2806500
Validation loss decreased (0.215392 --> 0.212962).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 29 cost time: 0.8466405868530273
Epoch: 29, Steps: 64 | Train Loss: 0.1543475 Vali Loss: 0.2124415 Test Loss: 0.2789055
Validation loss decreased (0.212962 --> 0.212442).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 30 cost time: 0.8451535701751709
Epoch: 30, Steps: 64 | Train Loss: 0.1532730 Vali Loss: 0.2128611 Test Loss: 0.2763688
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 31 cost time: 0.8413703441619873
Epoch: 31, Steps: 64 | Train Loss: 0.1536100 Vali Loss: 0.2117237 Test Loss: 0.2746762
Validation loss decreased (0.212442 --> 0.211724).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 32 cost time: 0.8607523441314697
Epoch: 32, Steps: 64 | Train Loss: 0.1528869 Vali Loss: 0.2095122 Test Loss: 0.2745067
Validation loss decreased (0.211724 --> 0.209512).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 33 cost time: 0.8590004444122314
Epoch: 33, Steps: 64 | Train Loss: 0.1528432 Vali Loss: 0.2086884 Test Loss: 0.2721458
Validation loss decreased (0.209512 --> 0.208688).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 34 cost time: 0.8556325435638428
Epoch: 34, Steps: 64 | Train Loss: 0.1523832 Vali Loss: 0.2087807 Test Loss: 0.2729522
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 35 cost time: 0.8622229099273682
Epoch: 35, Steps: 64 | Train Loss: 0.1524948 Vali Loss: 0.2057917 Test Loss: 0.2705159
Validation loss decreased (0.208688 --> 0.205792).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 36 cost time: 0.8643398284912109
Epoch: 36, Steps: 64 | Train Loss: 0.1511978 Vali Loss: 0.2086686 Test Loss: 0.2745313
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 37 cost time: 0.8658914566040039
Epoch: 37, Steps: 64 | Train Loss: 0.1511064 Vali Loss: 0.2080960 Test Loss: 0.2710323
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 38 cost time: 0.8829998970031738
Epoch: 38, Steps: 64 | Train Loss: 0.1516671 Vali Loss: 0.2072258 Test Loss: 0.2709744
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 39 cost time: 0.8866262435913086
Epoch: 39, Steps: 64 | Train Loss: 0.1520621 Vali Loss: 0.2059380 Test Loss: 0.2703416
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 40 cost time: 0.898261308670044
Epoch: 40, Steps: 64 | Train Loss: 0.1507639 Vali Loss: 0.2033037 Test Loss: 0.2729483
Validation loss decreased (0.205792 --> 0.203304).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 41 cost time: 0.8673970699310303
Epoch: 41, Steps: 64 | Train Loss: 0.1506918 Vali Loss: 0.2041202 Test Loss: 0.2687106
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 42 cost time: 0.869999885559082
Epoch: 42, Steps: 64 | Train Loss: 0.1509437 Vali Loss: 0.2033333 Test Loss: 0.2668272
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 43 cost time: 0.8676137924194336
Epoch: 43, Steps: 64 | Train Loss: 0.1508145 Vali Loss: 0.2073883 Test Loss: 0.2689806
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 44 cost time: 0.8596394062042236
Epoch: 44, Steps: 64 | Train Loss: 0.1506370 Vali Loss: 0.2033468 Test Loss: 0.2684703
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 45 cost time: 0.8224127292633057
Epoch: 45, Steps: 64 | Train Loss: 0.1511940 Vali Loss: 0.2056039 Test Loss: 0.2682680
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 46 cost time: 0.825448751449585
Epoch: 46, Steps: 64 | Train Loss: 0.1502936 Vali Loss: 0.2057410 Test Loss: 0.2693857
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 47 cost time: 0.8347556591033936
Epoch: 47, Steps: 64 | Train Loss: 0.1494582 Vali Loss: 0.2051452 Test Loss: 0.2692520
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 48 cost time: 0.8462278842926025
Epoch: 48, Steps: 64 | Train Loss: 0.1506716 Vali Loss: 0.2067739 Test Loss: 0.2700726
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 49 cost time: 0.845055341720581
Epoch: 49, Steps: 64 | Train Loss: 0.1498113 Vali Loss: 0.2056238 Test Loss: 0.2675425
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 50 cost time: 0.8454163074493408
Epoch: 50, Steps: 64 | Train Loss: 0.1496870 Vali Loss: 0.2034696 Test Loss: 0.2665161
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 51 cost time: 0.8513674736022949
Epoch: 51, Steps: 64 | Train Loss: 0.1498441 Vali Loss: 0.2041171 Test Loss: 0.2661584
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 52 cost time: 0.8438148498535156
Epoch: 52, Steps: 64 | Train Loss: 0.1493020 Vali Loss: 0.2041214 Test Loss: 0.2664272
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 53 cost time: 0.8366875648498535
Epoch: 53, Steps: 64 | Train Loss: 0.1500012 Vali Loss: 0.2021964 Test Loss: 0.2630024
Validation loss decreased (0.203304 --> 0.202196).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 54 cost time: 0.8336374759674072
Epoch: 54, Steps: 64 | Train Loss: 0.1495530 Vali Loss: 0.2042291 Test Loss: 0.2676800
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 55 cost time: 0.8323876857757568
Epoch: 55, Steps: 64 | Train Loss: 0.1492548 Vali Loss: 0.2047814 Test Loss: 0.2666536
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 56 cost time: 0.8484249114990234
Epoch: 56, Steps: 64 | Train Loss: 0.1494096 Vali Loss: 0.2039964 Test Loss: 0.2663745
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 57 cost time: 0.8689999580383301
Epoch: 57, Steps: 64 | Train Loss: 0.1502186 Vali Loss: 0.2041468 Test Loss: 0.2655027
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 58 cost time: 0.8766262531280518
Epoch: 58, Steps: 64 | Train Loss: 0.1501662 Vali Loss: 0.2046760 Test Loss: 0.2678590
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 59 cost time: 0.8677470684051514
Epoch: 59, Steps: 64 | Train Loss: 0.1497430 Vali Loss: 0.2033434 Test Loss: 0.2665858
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 60 cost time: 0.8129866123199463
Epoch: 60, Steps: 64 | Train Loss: 0.1493447 Vali Loss: 0.2043427 Test Loss: 0.2676385
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2630023658275604, mae:0.3744438886642456, rse:0.2599045932292938
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.036408424377441406 GB
Epoch: 1 cost time: 2.252164602279663
Epoch: 1, Steps: 64 | Train Loss: 0.9515343 Vali Loss: 2.4871211 Test Loss: 3.8980670
Validation loss decreased (inf --> 2.487121).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 2 cost time: 0.8857696056365967
Epoch: 2, Steps: 64 | Train Loss: 0.7791499 Vali Loss: 1.5586010 Test Loss: 2.3697946
Validation loss decreased (2.487121 --> 1.558601).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 3 cost time: 0.8969993591308594
Epoch: 3, Steps: 64 | Train Loss: 0.4941335 Vali Loss: 0.8797671 Test Loss: 1.2425108
Validation loss decreased (1.558601 --> 0.879767).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 4 cost time: 0.8812522888183594
Epoch: 4, Steps: 64 | Train Loss: 0.3115865 Vali Loss: 0.5265987 Test Loss: 0.6670566
Validation loss decreased (0.879767 --> 0.526599).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 5 cost time: 0.8792886734008789
Epoch: 5, Steps: 64 | Train Loss: 0.2254440 Vali Loss: 0.3731508 Test Loss: 0.4423974
Validation loss decreased (0.526599 --> 0.373151).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 6 cost time: 0.8646202087402344
Epoch: 6, Steps: 64 | Train Loss: 0.1876021 Vali Loss: 0.2925363 Test Loss: 0.3382058
Validation loss decreased (0.373151 --> 0.292536).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 7 cost time: 0.8663527965545654
Epoch: 7, Steps: 64 | Train Loss: 0.1681446 Vali Loss: 0.2459883 Test Loss: 0.2883231
Validation loss decreased (0.292536 --> 0.245988).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 8 cost time: 0.8669338226318359
Epoch: 8, Steps: 64 | Train Loss: 0.1570216 Vali Loss: 0.2168890 Test Loss: 0.2621230
Validation loss decreased (0.245988 --> 0.216889).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 9 cost time: 0.8669993877410889
Epoch: 9, Steps: 64 | Train Loss: 0.1503063 Vali Loss: 0.2034677 Test Loss: 0.2504663
Validation loss decreased (0.216889 --> 0.203468).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 10 cost time: 0.8830220699310303
Epoch: 10, Steps: 64 | Train Loss: 0.1465961 Vali Loss: 0.1934865 Test Loss: 0.2448728
Validation loss decreased (0.203468 --> 0.193487).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 11 cost time: 0.8843851089477539
Epoch: 11, Steps: 64 | Train Loss: 0.1436817 Vali Loss: 0.1905514 Test Loss: 0.2381868
Validation loss decreased (0.193487 --> 0.190551).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 12 cost time: 0.8983564376831055
Epoch: 12, Steps: 64 | Train Loss: 0.1405660 Vali Loss: 0.1877669 Test Loss: 0.2379143
Validation loss decreased (0.190551 --> 0.187767).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 13 cost time: 0.9044055938720703
Epoch: 13, Steps: 64 | Train Loss: 0.1393788 Vali Loss: 0.1862403 Test Loss: 0.2372672
Validation loss decreased (0.187767 --> 0.186240).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 14 cost time: 0.9047260284423828
Epoch: 14, Steps: 64 | Train Loss: 0.1380096 Vali Loss: 0.1844452 Test Loss: 0.2363975
Validation loss decreased (0.186240 --> 0.184445).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 15 cost time: 0.8749804496765137
Epoch: 15, Steps: 64 | Train Loss: 0.1362250 Vali Loss: 0.1841142 Test Loss: 0.2345692
Validation loss decreased (0.184445 --> 0.184114).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 16 cost time: 0.8906428813934326
Epoch: 16, Steps: 64 | Train Loss: 0.1347286 Vali Loss: 0.1835065 Test Loss: 0.2375910
Validation loss decreased (0.184114 --> 0.183507).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 17 cost time: 0.88238525390625
Epoch: 17, Steps: 64 | Train Loss: 0.1343929 Vali Loss: 0.1838668 Test Loss: 0.2347749
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 18 cost time: 0.8704314231872559
Epoch: 18, Steps: 64 | Train Loss: 0.1335420 Vali Loss: 0.1824972 Test Loss: 0.2344021
Validation loss decreased (0.183507 --> 0.182497).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 19 cost time: 0.8947505950927734
Epoch: 19, Steps: 64 | Train Loss: 0.1325366 Vali Loss: 0.1821378 Test Loss: 0.2357702
Validation loss decreased (0.182497 --> 0.182138).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 20 cost time: 0.8983635902404785
Epoch: 20, Steps: 64 | Train Loss: 0.1319403 Vali Loss: 0.1814739 Test Loss: 0.2344797
Validation loss decreased (0.182138 --> 0.181474).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 21 cost time: 0.9170000553131104
Epoch: 21, Steps: 64 | Train Loss: 0.1317005 Vali Loss: 0.1826221 Test Loss: 0.2363381
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 22 cost time: 0.8826255798339844
Epoch: 22, Steps: 64 | Train Loss: 0.1312773 Vali Loss: 0.1816998 Test Loss: 0.2354657
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 23 cost time: 0.8733956813812256
Epoch: 23, Steps: 64 | Train Loss: 0.1307378 Vali Loss: 0.1793511 Test Loss: 0.2342767
Validation loss decreased (0.181474 --> 0.179351).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 24 cost time: 0.8559608459472656
Epoch: 24, Steps: 64 | Train Loss: 0.1301911 Vali Loss: 0.1836330 Test Loss: 0.2368394
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 25 cost time: 0.8687853813171387
Epoch: 25, Steps: 64 | Train Loss: 0.1306324 Vali Loss: 0.1823193 Test Loss: 0.2354807
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 26 cost time: 0.8584136962890625
Epoch: 26, Steps: 64 | Train Loss: 0.1295401 Vali Loss: 0.1799659 Test Loss: 0.2355983
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 27 cost time: 0.8556241989135742
Epoch: 27, Steps: 64 | Train Loss: 0.1300185 Vali Loss: 0.1799643 Test Loss: 0.2353865
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 28 cost time: 0.8723821640014648
Epoch: 28, Steps: 64 | Train Loss: 0.1300589 Vali Loss: 0.1822411 Test Loss: 0.2351309
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 29 cost time: 0.875058650970459
Epoch: 29, Steps: 64 | Train Loss: 0.1289780 Vali Loss: 0.1802744 Test Loss: 0.2353985
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 30 cost time: 0.8708264827728271
Epoch: 30, Steps: 64 | Train Loss: 0.1281487 Vali Loss: 0.1800672 Test Loss: 0.2347508
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 31 cost time: 0.8839998245239258
Epoch: 31, Steps: 64 | Train Loss: 0.1288386 Vali Loss: 0.1824040 Test Loss: 0.2362771
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 32 cost time: 0.8826427459716797
Epoch: 32, Steps: 64 | Train Loss: 0.1287095 Vali Loss: 0.1817180 Test Loss: 0.2361484
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 33 cost time: 0.8711903095245361
Epoch: 33, Steps: 64 | Train Loss: 0.1288895 Vali Loss: 0.1797121 Test Loss: 0.2349319
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 34 cost time: 0.8723998069763184
Epoch: 34, Steps: 64 | Train Loss: 0.1285557 Vali Loss: 0.1807489 Test Loss: 0.2353813
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 35 cost time: 0.8763799667358398
Epoch: 35, Steps: 64 | Train Loss: 0.1280333 Vali Loss: 0.1794720 Test Loss: 0.2354367
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 36 cost time: 0.887751579284668
Epoch: 36, Steps: 64 | Train Loss: 0.1278549 Vali Loss: 0.1822261 Test Loss: 0.2364737
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 37 cost time: 0.8889985084533691
Epoch: 37, Steps: 64 | Train Loss: 0.1273329 Vali Loss: 0.1812379 Test Loss: 0.2373021
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 38 cost time: 0.900611162185669
Epoch: 38, Steps: 64 | Train Loss: 0.1275501 Vali Loss: 0.1812129 Test Loss: 0.2349211
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 39 cost time: 0.9063796997070312
Epoch: 39, Steps: 64 | Train Loss: 0.1288543 Vali Loss: 0.1816963 Test Loss: 0.2375035
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 40 cost time: 0.9014363288879395
Epoch: 40, Steps: 64 | Train Loss: 0.1280736 Vali Loss: 0.1790254 Test Loss: 0.2356626
Validation loss decreased (0.179351 --> 0.179025).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 41 cost time: 0.9034261703491211
Epoch: 41, Steps: 64 | Train Loss: 0.1273684 Vali Loss: 0.1802917 Test Loss: 0.2357854
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 42 cost time: 0.8914365768432617
Epoch: 42, Steps: 64 | Train Loss: 0.1279289 Vali Loss: 0.1796506 Test Loss: 0.2351034
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 43 cost time: 0.8980000019073486
Epoch: 43, Steps: 64 | Train Loss: 0.1270675 Vali Loss: 0.1806384 Test Loss: 0.2361049
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 44 cost time: 0.8956303596496582
Epoch: 44, Steps: 64 | Train Loss: 0.1274373 Vali Loss: 0.1804539 Test Loss: 0.2347765
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 45 cost time: 0.904926061630249
Epoch: 45, Steps: 64 | Train Loss: 0.1278186 Vali Loss: 0.1808384 Test Loss: 0.2345048
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 46 cost time: 0.8684065341949463
Epoch: 46, Steps: 64 | Train Loss: 0.1270242 Vali Loss: 0.1793919 Test Loss: 0.2356551
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 47 cost time: 0.9044888019561768
Epoch: 47, Steps: 64 | Train Loss: 0.1278170 Vali Loss: 0.1806542 Test Loss: 0.2361541
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 48 cost time: 0.8757295608520508
Epoch: 48, Steps: 64 | Train Loss: 0.1271879 Vali Loss: 0.1808384 Test Loss: 0.2370192
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 49 cost time: 0.8794620037078857
Epoch: 49, Steps: 64 | Train Loss: 0.1269603 Vali Loss: 0.1799897 Test Loss: 0.2361168
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 50 cost time: 0.8816475868225098
Epoch: 50, Steps: 64 | Train Loss: 0.1272146 Vali Loss: 0.1799029 Test Loss: 0.2355527
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 51 cost time: 0.8450829982757568
Epoch: 51, Steps: 64 | Train Loss: 0.1271344 Vali Loss: 0.1805458 Test Loss: 0.2368423
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 52 cost time: 0.8500931262969971
Epoch: 52, Steps: 64 | Train Loss: 0.1274812 Vali Loss: 0.1802657 Test Loss: 0.2345299
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 53 cost time: 0.8525958061218262
Epoch: 53, Steps: 64 | Train Loss: 0.1269465 Vali Loss: 0.1797477 Test Loss: 0.2363126
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 54 cost time: 0.864274263381958
Epoch: 54, Steps: 64 | Train Loss: 0.1274818 Vali Loss: 0.1800676 Test Loss: 0.2348964
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 55 cost time: 0.8954403400421143
Epoch: 55, Steps: 64 | Train Loss: 0.1272478 Vali Loss: 0.1815165 Test Loss: 0.2378861
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 56 cost time: 0.90478515625
Epoch: 56, Steps: 64 | Train Loss: 0.1272743 Vali Loss: 0.1810878 Test Loss: 0.2364219
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 57 cost time: 0.9054183959960938
Epoch: 57, Steps: 64 | Train Loss: 0.1269177 Vali Loss: 0.1805463 Test Loss: 0.2354433
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 58 cost time: 0.9063796997070312
Epoch: 58, Steps: 64 | Train Loss: 0.1272087 Vali Loss: 0.1796773 Test Loss: 0.2355409
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 59 cost time: 0.9045186042785645
Epoch: 59, Steps: 64 | Train Loss: 0.1272670 Vali Loss: 0.1798066 Test Loss: 0.2354463
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 60 cost time: 0.88800048828125
Epoch: 60, Steps: 64 | Train Loss: 0.1275303 Vali Loss: 0.1816887 Test Loss: 0.2371745
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23566262423992157, mae:0.3474971055984497, rse:0.24602514505386353
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.0369725227355957 GB
Epoch: 1 cost time: 2.3304450511932373
Epoch: 1, Steps: 64 | Train Loss: 0.9069878 Vali Loss: 2.4794943 Test Loss: 3.9721186
Validation loss decreased (inf --> 2.479494).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 2 cost time: 0.990635871887207
Epoch: 2, Steps: 64 | Train Loss: 0.7715459 Vali Loss: 1.7109102 Test Loss: 2.6967397
Validation loss decreased (2.479494 --> 1.710910).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 3 cost time: 0.9919228553771973
Epoch: 3, Steps: 64 | Train Loss: 0.5215844 Vali Loss: 0.9563009 Test Loss: 1.4608114
Validation loss decreased (1.710910 --> 0.956301).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 4 cost time: 0.9909298419952393
Epoch: 4, Steps: 64 | Train Loss: 0.3121495 Vali Loss: 0.4637479 Test Loss: 0.6633317
Validation loss decreased (0.956301 --> 0.463748).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 5 cost time: 0.9518048763275146
Epoch: 5, Steps: 64 | Train Loss: 0.1943415 Vali Loss: 0.2560649 Test Loss: 0.3406487
Validation loss decreased (0.463748 --> 0.256065).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 6 cost time: 0.9402663707733154
Epoch: 6, Steps: 64 | Train Loss: 0.1540866 Vali Loss: 0.1993955 Test Loss: 0.2586208
Validation loss decreased (0.256065 --> 0.199396).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 7 cost time: 0.9432260990142822
Epoch: 7, Steps: 64 | Train Loss: 0.1433306 Vali Loss: 0.1859103 Test Loss: 0.2405511
Validation loss decreased (0.199396 --> 0.185910).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 8 cost time: 0.9462342262268066
Epoch: 8, Steps: 64 | Train Loss: 0.1400797 Vali Loss: 0.1807814 Test Loss: 0.2392503
Validation loss decreased (0.185910 --> 0.180781).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 9 cost time: 0.9287471771240234
Epoch: 9, Steps: 64 | Train Loss: 0.1362504 Vali Loss: 0.1812451 Test Loss: 0.2369409
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 10 cost time: 0.9789993762969971
Epoch: 10, Steps: 64 | Train Loss: 0.1345379 Vali Loss: 0.1800849 Test Loss: 0.2362950
Validation loss decreased (0.180781 --> 0.180085).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 11 cost time: 0.992511510848999
Epoch: 11, Steps: 64 | Train Loss: 0.1331067 Vali Loss: 0.1777380 Test Loss: 0.2345584
Validation loss decreased (0.180085 --> 0.177738).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 12 cost time: 1.0058362483978271
Epoch: 12, Steps: 64 | Train Loss: 0.1317268 Vali Loss: 0.1783383 Test Loss: 0.2350857
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 13 cost time: 0.9911525249481201
Epoch: 13, Steps: 64 | Train Loss: 0.1302733 Vali Loss: 0.1765130 Test Loss: 0.2338653
Validation loss decreased (0.177738 --> 0.176513).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 14 cost time: 0.9703612327575684
Epoch: 14, Steps: 64 | Train Loss: 0.1296275 Vali Loss: 0.1760215 Test Loss: 0.2356187
Validation loss decreased (0.176513 --> 0.176021).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 15 cost time: 0.980074405670166
Epoch: 15, Steps: 64 | Train Loss: 0.1284935 Vali Loss: 0.1769600 Test Loss: 0.2335487
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 16 cost time: 0.9897964000701904
Epoch: 16, Steps: 64 | Train Loss: 0.1278542 Vali Loss: 0.1758463 Test Loss: 0.2328663
Validation loss decreased (0.176021 --> 0.175846).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 17 cost time: 0.9753608703613281
Epoch: 17, Steps: 64 | Train Loss: 0.1277082 Vali Loss: 0.1736830 Test Loss: 0.2324903
Validation loss decreased (0.175846 --> 0.173683).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 18 cost time: 0.9885251522064209
Epoch: 18, Steps: 64 | Train Loss: 0.1268340 Vali Loss: 0.1750012 Test Loss: 0.2327196
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 19 cost time: 0.9727232456207275
Epoch: 19, Steps: 64 | Train Loss: 0.1263310 Vali Loss: 0.1757711 Test Loss: 0.2344866
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 20 cost time: 0.9608170986175537
Epoch: 20, Steps: 64 | Train Loss: 0.1264453 Vali Loss: 0.1754938 Test Loss: 0.2319582
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 21 cost time: 0.9610004425048828
Epoch: 21, Steps: 64 | Train Loss: 0.1257570 Vali Loss: 0.1758155 Test Loss: 0.2335514
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 22 cost time: 0.9526183605194092
Epoch: 22, Steps: 64 | Train Loss: 0.1259147 Vali Loss: 0.1752330 Test Loss: 0.2332917
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 23 cost time: 0.9383742809295654
Epoch: 23, Steps: 64 | Train Loss: 0.1242525 Vali Loss: 0.1746911 Test Loss: 0.2335582
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 24 cost time: 0.9469659328460693
Epoch: 24, Steps: 64 | Train Loss: 0.1245935 Vali Loss: 0.1733797 Test Loss: 0.2324585
Validation loss decreased (0.173683 --> 0.173380).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 25 cost time: 0.9374115467071533
Epoch: 25, Steps: 64 | Train Loss: 0.1237437 Vali Loss: 0.1745598 Test Loss: 0.2322725
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 26 cost time: 0.9475679397583008
Epoch: 26, Steps: 64 | Train Loss: 0.1243293 Vali Loss: 0.1738503 Test Loss: 0.2326276
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 27 cost time: 0.9551494121551514
Epoch: 27, Steps: 64 | Train Loss: 0.1238418 Vali Loss: 0.1737790 Test Loss: 0.2337220
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 28 cost time: 0.9773716926574707
Epoch: 28, Steps: 64 | Train Loss: 0.1232844 Vali Loss: 0.1751972 Test Loss: 0.2326813
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 29 cost time: 0.9780001640319824
Epoch: 29, Steps: 64 | Train Loss: 0.1239126 Vali Loss: 0.1727069 Test Loss: 0.2317303
Validation loss decreased (0.173380 --> 0.172707).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 30 cost time: 0.9863834381103516
Epoch: 30, Steps: 64 | Train Loss: 0.1233471 Vali Loss: 0.1731784 Test Loss: 0.2315915
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 31 cost time: 0.9846374988555908
Epoch: 31, Steps: 64 | Train Loss: 0.1232806 Vali Loss: 0.1753540 Test Loss: 0.2341591
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 32 cost time: 0.9665994644165039
Epoch: 32, Steps: 64 | Train Loss: 0.1234437 Vali Loss: 0.1728490 Test Loss: 0.2305450
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 33 cost time: 0.9683976173400879
Epoch: 33, Steps: 64 | Train Loss: 0.1232523 Vali Loss: 0.1725689 Test Loss: 0.2322694
Validation loss decreased (0.172707 --> 0.172569).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 34 cost time: 0.9659543037414551
Epoch: 34, Steps: 64 | Train Loss: 0.1236160 Vali Loss: 0.1764435 Test Loss: 0.2342229
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 35 cost time: 0.990368127822876
Epoch: 35, Steps: 64 | Train Loss: 0.1229956 Vali Loss: 0.1736369 Test Loss: 0.2337373
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 36 cost time: 0.990044355392456
Epoch: 36, Steps: 64 | Train Loss: 0.1223177 Vali Loss: 0.1733531 Test Loss: 0.2328849
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 37 cost time: 0.9853599071502686
Epoch: 37, Steps: 64 | Train Loss: 0.1232768 Vali Loss: 0.1756785 Test Loss: 0.2329758
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 38 cost time: 0.9757547378540039
Epoch: 38, Steps: 64 | Train Loss: 0.1228293 Vali Loss: 0.1725016 Test Loss: 0.2324659
Validation loss decreased (0.172569 --> 0.172502).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 39 cost time: 0.934382438659668
Epoch: 39, Steps: 64 | Train Loss: 0.1230479 Vali Loss: 0.1742616 Test Loss: 0.2329120
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 40 cost time: 0.9364757537841797
Epoch: 40, Steps: 64 | Train Loss: 0.1229300 Vali Loss: 0.1749898 Test Loss: 0.2327045
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 41 cost time: 0.9346094131469727
Epoch: 41, Steps: 64 | Train Loss: 0.1232589 Vali Loss: 0.1737699 Test Loss: 0.2319048
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 42 cost time: 0.9793682098388672
Epoch: 42, Steps: 64 | Train Loss: 0.1225868 Vali Loss: 0.1732201 Test Loss: 0.2316798
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 43 cost time: 0.9921474456787109
Epoch: 43, Steps: 64 | Train Loss: 0.1223148 Vali Loss: 0.1725743 Test Loss: 0.2325271
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 44 cost time: 0.974759578704834
Epoch: 44, Steps: 64 | Train Loss: 0.1229134 Vali Loss: 0.1740682 Test Loss: 0.2323448
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 45 cost time: 0.9613759517669678
Epoch: 45, Steps: 64 | Train Loss: 0.1229933 Vali Loss: 0.1734956 Test Loss: 0.2325064
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 46 cost time: 0.9593889713287354
Epoch: 46, Steps: 64 | Train Loss: 0.1225635 Vali Loss: 0.1753581 Test Loss: 0.2327084
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 47 cost time: 0.9562370777130127
Epoch: 47, Steps: 64 | Train Loss: 0.1225204 Vali Loss: 0.1715943 Test Loss: 0.2317143
Validation loss decreased (0.172502 --> 0.171594).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 48 cost time: 0.9769206047058105
Epoch: 48, Steps: 64 | Train Loss: 0.1227312 Vali Loss: 0.1747126 Test Loss: 0.2338160
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 49 cost time: 0.976001501083374
Epoch: 49, Steps: 64 | Train Loss: 0.1226000 Vali Loss: 0.1733732 Test Loss: 0.2337484
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 50 cost time: 0.969989538192749
Epoch: 50, Steps: 64 | Train Loss: 0.1219516 Vali Loss: 0.1735543 Test Loss: 0.2326617
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 51 cost time: 0.9696154594421387
Epoch: 51, Steps: 64 | Train Loss: 0.1221566 Vali Loss: 0.1738716 Test Loss: 0.2318073
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 52 cost time: 0.9863953590393066
Epoch: 52, Steps: 64 | Train Loss: 0.1219382 Vali Loss: 0.1758511 Test Loss: 0.2329343
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 53 cost time: 0.9915461540222168
Epoch: 53, Steps: 64 | Train Loss: 0.1221679 Vali Loss: 0.1740430 Test Loss: 0.2329360
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 54 cost time: 0.9964067935943604
Epoch: 54, Steps: 64 | Train Loss: 0.1223817 Vali Loss: 0.1729537 Test Loss: 0.2318906
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 55 cost time: 0.9889869689941406
Epoch: 55, Steps: 64 | Train Loss: 0.1221645 Vali Loss: 0.1719145 Test Loss: 0.2318137
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 56 cost time: 0.9690678119659424
Epoch: 56, Steps: 64 | Train Loss: 0.1224452 Vali Loss: 0.1728832 Test Loss: 0.2325201
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 57 cost time: 0.9487531185150146
Epoch: 57, Steps: 64 | Train Loss: 0.1222288 Vali Loss: 0.1740630 Test Loss: 0.2321644
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 58 cost time: 0.9457159042358398
Epoch: 58, Steps: 64 | Train Loss: 0.1223160 Vali Loss: 0.1745354 Test Loss: 0.2319496
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 59 cost time: 0.9380002021789551
Epoch: 59, Steps: 64 | Train Loss: 0.1225733 Vali Loss: 0.1749905 Test Loss: 0.2319328
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 60 cost time: 0.9520974159240723
Epoch: 60, Steps: 64 | Train Loss: 0.1220509 Vali Loss: 0.1741174 Test Loss: 0.2326314
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23171427845954895, mae:0.33983004093170166, rse:0.24395546317100525
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.035868167877197266 GB
Epoch: 1 cost time: 2.2716169357299805
Epoch: 1, Steps: 64 | Train Loss: 1.3398252 Vali Loss: 3.2086356 Test Loss: 5.1444116
Validation loss decreased (inf --> 3.208636).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 2 cost time: 0.9066479206085205
Epoch: 2, Steps: 64 | Train Loss: 0.9571127 Vali Loss: 1.2798318 Test Loss: 1.9214152
Validation loss decreased (3.208636 --> 1.279832).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 3 cost time: 0.9124283790588379
Epoch: 3, Steps: 64 | Train Loss: 0.4759994 Vali Loss: 0.6873811 Test Loss: 0.9442267
Validation loss decreased (1.279832 --> 0.687381).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 4 cost time: 0.9197702407836914
Epoch: 4, Steps: 64 | Train Loss: 0.3410970 Vali Loss: 0.5129628 Test Loss: 0.6611223
Validation loss decreased (0.687381 --> 0.512963).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 5 cost time: 0.9123976230621338
Epoch: 5, Steps: 64 | Train Loss: 0.2796184 Vali Loss: 0.4278957 Test Loss: 0.5285161
Validation loss decreased (0.512963 --> 0.427896).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 6 cost time: 0.885643720626831
Epoch: 6, Steps: 64 | Train Loss: 0.2485502 Vali Loss: 0.3710653 Test Loss: 0.4418364
Validation loss decreased (0.427896 --> 0.371065).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 7 cost time: 0.8936388492584229
Epoch: 7, Steps: 64 | Train Loss: 0.2269821 Vali Loss: 0.3316862 Test Loss: 0.3858114
Validation loss decreased (0.371065 --> 0.331686).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 8 cost time: 0.8903207778930664
Epoch: 8, Steps: 64 | Train Loss: 0.2105126 Vali Loss: 0.3033966 Test Loss: 0.3483882
Validation loss decreased (0.331686 --> 0.303397).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 9 cost time: 0.8877584934234619
Epoch: 9, Steps: 64 | Train Loss: 0.2004766 Vali Loss: 0.2814203 Test Loss: 0.3185386
Validation loss decreased (0.303397 --> 0.281420).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 10 cost time: 0.9233839511871338
Epoch: 10, Steps: 64 | Train Loss: 0.1919771 Vali Loss: 0.2673467 Test Loss: 0.3012761
Validation loss decreased (0.281420 --> 0.267347).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 11 cost time: 0.9304921627044678
Epoch: 11, Steps: 64 | Train Loss: 0.1869459 Vali Loss: 0.2534823 Test Loss: 0.2829219
Validation loss decreased (0.267347 --> 0.253482).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 12 cost time: 0.9453577995300293
Epoch: 12, Steps: 64 | Train Loss: 0.1814294 Vali Loss: 0.2462857 Test Loss: 0.2758538
Validation loss decreased (0.253482 --> 0.246286).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 13 cost time: 0.9431595802307129
Epoch: 13, Steps: 64 | Train Loss: 0.1778294 Vali Loss: 0.2359223 Test Loss: 0.2663220
Validation loss decreased (0.246286 --> 0.235922).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 14 cost time: 0.934788703918457
Epoch: 14, Steps: 64 | Train Loss: 0.1743013 Vali Loss: 0.2315008 Test Loss: 0.2613628
Validation loss decreased (0.235922 --> 0.231501).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 15 cost time: 0.944631814956665
Epoch: 15, Steps: 64 | Train Loss: 0.1716616 Vali Loss: 0.2264617 Test Loss: 0.2551545
Validation loss decreased (0.231501 --> 0.226462).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 16 cost time: 0.9207971096038818
Epoch: 16, Steps: 64 | Train Loss: 0.1704654 Vali Loss: 0.2227695 Test Loss: 0.2531821
Validation loss decreased (0.226462 --> 0.222769).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 17 cost time: 0.9204461574554443
Epoch: 17, Steps: 64 | Train Loss: 0.1674382 Vali Loss: 0.2192333 Test Loss: 0.2504586
Validation loss decreased (0.222769 --> 0.219233).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 18 cost time: 0.9305150508880615
Epoch: 18, Steps: 64 | Train Loss: 0.1667835 Vali Loss: 0.2135752 Test Loss: 0.2441272
Validation loss decreased (0.219233 --> 0.213575).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 19 cost time: 0.9374392032623291
Epoch: 19, Steps: 64 | Train Loss: 0.1647130 Vali Loss: 0.2109913 Test Loss: 0.2417532
Validation loss decreased (0.213575 --> 0.210991).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 20 cost time: 0.9395565986633301
Epoch: 20, Steps: 64 | Train Loss: 0.1637065 Vali Loss: 0.2104493 Test Loss: 0.2409386
Validation loss decreased (0.210991 --> 0.210449).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 21 cost time: 0.9544124603271484
Epoch: 21, Steps: 64 | Train Loss: 0.1623745 Vali Loss: 0.2077207 Test Loss: 0.2414312
Validation loss decreased (0.210449 --> 0.207721).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 22 cost time: 0.9699416160583496
Epoch: 22, Steps: 64 | Train Loss: 0.1624465 Vali Loss: 0.2072275 Test Loss: 0.2392604
Validation loss decreased (0.207721 --> 0.207227).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 23 cost time: 0.8866419792175293
Epoch: 23, Steps: 64 | Train Loss: 0.1610021 Vali Loss: 0.2068097 Test Loss: 0.2371467
Validation loss decreased (0.207227 --> 0.206810).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 24 cost time: 0.8853857517242432
Epoch: 24, Steps: 64 | Train Loss: 0.1598736 Vali Loss: 0.2040268 Test Loss: 0.2367663
Validation loss decreased (0.206810 --> 0.204027).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 25 cost time: 0.8964786529541016
Epoch: 25, Steps: 64 | Train Loss: 0.1593780 Vali Loss: 0.2043154 Test Loss: 0.2369231
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 26 cost time: 0.8849999904632568
Epoch: 26, Steps: 64 | Train Loss: 0.1580376 Vali Loss: 0.2033890 Test Loss: 0.2370655
Validation loss decreased (0.204027 --> 0.203389).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 27 cost time: 0.9066369533538818
Epoch: 27, Steps: 64 | Train Loss: 0.1588200 Vali Loss: 0.1997415 Test Loss: 0.2350169
Validation loss decreased (0.203389 --> 0.199741).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 28 cost time: 0.9189999103546143
Epoch: 28, Steps: 64 | Train Loss: 0.1586555 Vali Loss: 0.1990259 Test Loss: 0.2340328
Validation loss decreased (0.199741 --> 0.199026).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 29 cost time: 0.9216415882110596
Epoch: 29, Steps: 64 | Train Loss: 0.1569667 Vali Loss: 0.1974776 Test Loss: 0.2333530
Validation loss decreased (0.199026 --> 0.197478).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 30 cost time: 0.9176366329193115
Epoch: 30, Steps: 64 | Train Loss: 0.1570915 Vali Loss: 0.2001359 Test Loss: 0.2338131
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 31 cost time: 0.9189980030059814
Epoch: 31, Steps: 64 | Train Loss: 0.1576862 Vali Loss: 0.1996253 Test Loss: 0.2343769
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 32 cost time: 0.9176363945007324
Epoch: 32, Steps: 64 | Train Loss: 0.1573941 Vali Loss: 0.1966770 Test Loss: 0.2328522
Validation loss decreased (0.197478 --> 0.196677).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 33 cost time: 0.9130001068115234
Epoch: 33, Steps: 64 | Train Loss: 0.1563001 Vali Loss: 0.1983436 Test Loss: 0.2330425
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 34 cost time: 0.91361403465271
Epoch: 34, Steps: 64 | Train Loss: 0.1561718 Vali Loss: 0.1986631 Test Loss: 0.2334330
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 35 cost time: 0.917999267578125
Epoch: 35, Steps: 64 | Train Loss: 0.1561634 Vali Loss: 0.1970946 Test Loss: 0.2324525
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 36 cost time: 0.9444341659545898
Epoch: 36, Steps: 64 | Train Loss: 0.1548058 Vali Loss: 0.1949309 Test Loss: 0.2319680
Validation loss decreased (0.196677 --> 0.194931).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 37 cost time: 0.9394309520721436
Epoch: 37, Steps: 64 | Train Loss: 0.1554483 Vali Loss: 0.1981772 Test Loss: 0.2326448
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 38 cost time: 0.9411523342132568
Epoch: 38, Steps: 64 | Train Loss: 0.1555937 Vali Loss: 0.1943538 Test Loss: 0.2310984
Validation loss decreased (0.194931 --> 0.194354).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 39 cost time: 0.9534134864807129
Epoch: 39, Steps: 64 | Train Loss: 0.1549650 Vali Loss: 0.1964509 Test Loss: 0.2322758
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 40 cost time: 0.9254217147827148
Epoch: 40, Steps: 64 | Train Loss: 0.1542107 Vali Loss: 0.1965340 Test Loss: 0.2340001
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 41 cost time: 0.8954377174377441
Epoch: 41, Steps: 64 | Train Loss: 0.1539746 Vali Loss: 0.1949691 Test Loss: 0.2318393
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 42 cost time: 0.8910009860992432
Epoch: 42, Steps: 64 | Train Loss: 0.1550469 Vali Loss: 0.1959554 Test Loss: 0.2323283
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 43 cost time: 0.8949384689331055
Epoch: 43, Steps: 64 | Train Loss: 0.1541232 Vali Loss: 0.1939881 Test Loss: 0.2311093
Validation loss decreased (0.194354 --> 0.193988).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 44 cost time: 0.8883609771728516
Epoch: 44, Steps: 64 | Train Loss: 0.1541009 Vali Loss: 0.1967169 Test Loss: 0.2326413
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 45 cost time: 0.9163408279418945
Epoch: 45, Steps: 64 | Train Loss: 0.1543567 Vali Loss: 0.1950499 Test Loss: 0.2317090
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 46 cost time: 0.9129867553710938
Epoch: 46, Steps: 64 | Train Loss: 0.1540152 Vali Loss: 0.1972217 Test Loss: 0.2326855
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 47 cost time: 0.9193685054779053
Epoch: 47, Steps: 64 | Train Loss: 0.1547220 Vali Loss: 0.1950677 Test Loss: 0.2313654
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 48 cost time: 0.9099998474121094
Epoch: 48, Steps: 64 | Train Loss: 0.1540657 Vali Loss: 0.1974923 Test Loss: 0.2313447
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 49 cost time: 0.8956143856048584
Epoch: 49, Steps: 64 | Train Loss: 0.1543051 Vali Loss: 0.1922170 Test Loss: 0.2320687
Validation loss decreased (0.193988 --> 0.192217).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 50 cost time: 0.9083902835845947
Epoch: 50, Steps: 64 | Train Loss: 0.1543005 Vali Loss: 0.1958856 Test Loss: 0.2302236
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 51 cost time: 0.8983614444732666
Epoch: 51, Steps: 64 | Train Loss: 0.1545755 Vali Loss: 0.1950257 Test Loss: 0.2309725
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 52 cost time: 0.9202675819396973
Epoch: 52, Steps: 64 | Train Loss: 0.1538829 Vali Loss: 0.1946930 Test Loss: 0.2308120
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 53 cost time: 0.922370433807373
Epoch: 53, Steps: 64 | Train Loss: 0.1530120 Vali Loss: 0.1942697 Test Loss: 0.2317597
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 54 cost time: 0.9515724182128906
Epoch: 54, Steps: 64 | Train Loss: 0.1530199 Vali Loss: 0.1956534 Test Loss: 0.2304616
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 55 cost time: 0.9452846050262451
Epoch: 55, Steps: 64 | Train Loss: 0.1539454 Vali Loss: 0.1935897 Test Loss: 0.2306528
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 56 cost time: 0.9430017471313477
Epoch: 56, Steps: 64 | Train Loss: 0.1541038 Vali Loss: 0.1965129 Test Loss: 0.2336984
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 57 cost time: 0.9436361789703369
Epoch: 57, Steps: 64 | Train Loss: 0.1538060 Vali Loss: 0.1948739 Test Loss: 0.2309355
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 58 cost time: 0.9166336059570312
Epoch: 58, Steps: 64 | Train Loss: 0.1536007 Vali Loss: 0.1951860 Test Loss: 0.2306767
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 59 cost time: 0.9179978370666504
Epoch: 59, Steps: 64 | Train Loss: 0.1545536 Vali Loss: 0.1959755 Test Loss: 0.2313700
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 60 cost time: 0.921377420425415
Epoch: 60, Steps: 64 | Train Loss: 0.1533208 Vali Loss: 0.1949642 Test Loss: 0.2298255
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23206867277622223, mae:0.3366018533706665, rse:0.24414193630218506
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03656959533691406 GB
Epoch: 1 cost time: 2.245532751083374
Epoch: 1, Steps: 64 | Train Loss: 0.8329148 Vali Loss: 2.1652000 Test Loss: 3.4348845
Validation loss decreased (inf --> 2.165200).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 2 cost time: 0.88330078125
Epoch: 2, Steps: 64 | Train Loss: 0.6293831 Vali Loss: 1.0519552 Test Loss: 1.5634252
Validation loss decreased (2.165200 --> 1.051955).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 3 cost time: 0.8829977512359619
Epoch: 3, Steps: 64 | Train Loss: 0.3372866 Vali Loss: 0.4867657 Test Loss: 0.6214889
Validation loss decreased (1.051955 --> 0.486766).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 4 cost time: 0.8956406116485596
Epoch: 4, Steps: 64 | Train Loss: 0.2046835 Vali Loss: 0.2920094 Test Loss: 0.3229627
Validation loss decreased (0.486766 --> 0.292009).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 5 cost time: 0.8936145305633545
Epoch: 5, Steps: 64 | Train Loss: 0.1652850 Vali Loss: 0.2370940 Test Loss: 0.2587720
Validation loss decreased (0.292009 --> 0.237094).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 6 cost time: 0.871408224105835
Epoch: 6, Steps: 64 | Train Loss: 0.1532376 Vali Loss: 0.2152781 Test Loss: 0.2406076
Validation loss decreased (0.237094 --> 0.215278).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 7 cost time: 0.861443042755127
Epoch: 7, Steps: 64 | Train Loss: 0.1474011 Vali Loss: 0.2068505 Test Loss: 0.2371670
Validation loss decreased (0.215278 --> 0.206851).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 8 cost time: 0.8637290000915527
Epoch: 8, Steps: 64 | Train Loss: 0.1426104 Vali Loss: 0.1967781 Test Loss: 0.2316393
Validation loss decreased (0.206851 --> 0.196778).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 9 cost time: 0.8693113327026367
Epoch: 9, Steps: 64 | Train Loss: 0.1410251 Vali Loss: 0.1901392 Test Loss: 0.2293630
Validation loss decreased (0.196778 --> 0.190139).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 10 cost time: 0.8956329822540283
Epoch: 10, Steps: 64 | Train Loss: 0.1382148 Vali Loss: 0.1880069 Test Loss: 0.2264674
Validation loss decreased (0.190139 --> 0.188007).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 11 cost time: 0.8943860530853271
Epoch: 11, Steps: 64 | Train Loss: 0.1372443 Vali Loss: 0.1850361 Test Loss: 0.2261716
Validation loss decreased (0.188007 --> 0.185036).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 12 cost time: 0.9133784770965576
Epoch: 12, Steps: 64 | Train Loss: 0.1350661 Vali Loss: 0.1817564 Test Loss: 0.2256027
Validation loss decreased (0.185036 --> 0.181756).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 13 cost time: 0.9114491939544678
Epoch: 13, Steps: 64 | Train Loss: 0.1333498 Vali Loss: 0.1804802 Test Loss: 0.2250544
Validation loss decreased (0.181756 --> 0.180480).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 14 cost time: 0.9047796726226807
Epoch: 14, Steps: 64 | Train Loss: 0.1333000 Vali Loss: 0.1802183 Test Loss: 0.2252302
Validation loss decreased (0.180480 --> 0.180218).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 15 cost time: 0.8959996700286865
Epoch: 15, Steps: 64 | Train Loss: 0.1323255 Vali Loss: 0.1761652 Test Loss: 0.2238673
Validation loss decreased (0.180218 --> 0.176165).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 16 cost time: 0.8916201591491699
Epoch: 16, Steps: 64 | Train Loss: 0.1313851 Vali Loss: 0.1793850 Test Loss: 0.2240593
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 17 cost time: 0.884845495223999
Epoch: 17, Steps: 64 | Train Loss: 0.1308135 Vali Loss: 0.1776664 Test Loss: 0.2244950
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 18 cost time: 0.8953826427459717
Epoch: 18, Steps: 64 | Train Loss: 0.1298435 Vali Loss: 0.1773964 Test Loss: 0.2238414
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 19 cost time: 0.9148471355438232
Epoch: 19, Steps: 64 | Train Loss: 0.1296900 Vali Loss: 0.1760186 Test Loss: 0.2233291
Validation loss decreased (0.176165 --> 0.176019).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 20 cost time: 0.9200353622436523
Epoch: 20, Steps: 64 | Train Loss: 0.1292158 Vali Loss: 0.1744822 Test Loss: 0.2225912
Validation loss decreased (0.176019 --> 0.174482).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 21 cost time: 0.9100005626678467
Epoch: 21, Steps: 64 | Train Loss: 0.1290603 Vali Loss: 0.1753484 Test Loss: 0.2229879
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 22 cost time: 0.8814260959625244
Epoch: 22, Steps: 64 | Train Loss: 0.1287930 Vali Loss: 0.1770496 Test Loss: 0.2237469
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 23 cost time: 0.8821485042572021
Epoch: 23, Steps: 64 | Train Loss: 0.1285650 Vali Loss: 0.1737133 Test Loss: 0.2233641
Validation loss decreased (0.174482 --> 0.173713).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 24 cost time: 0.883673906326294
Epoch: 24, Steps: 64 | Train Loss: 0.1277796 Vali Loss: 0.1738437 Test Loss: 0.2245299
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 25 cost time: 0.8893728256225586
Epoch: 25, Steps: 64 | Train Loss: 0.1273952 Vali Loss: 0.1756852 Test Loss: 0.2228595
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 26 cost time: 0.8788414001464844
Epoch: 26, Steps: 64 | Train Loss: 0.1274341 Vali Loss: 0.1751032 Test Loss: 0.2232754
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 27 cost time: 0.8880021572113037
Epoch: 27, Steps: 64 | Train Loss: 0.1271985 Vali Loss: 0.1754630 Test Loss: 0.2219989
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 28 cost time: 0.901613712310791
Epoch: 28, Steps: 64 | Train Loss: 0.1271614 Vali Loss: 0.1757317 Test Loss: 0.2234671
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 29 cost time: 0.9099223613739014
Epoch: 29, Steps: 64 | Train Loss: 0.1264680 Vali Loss: 0.1739500 Test Loss: 0.2236849
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 30 cost time: 0.8973867893218994
Epoch: 30, Steps: 64 | Train Loss: 0.1272704 Vali Loss: 0.1744173 Test Loss: 0.2229991
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 31 cost time: 0.8843638896942139
Epoch: 31, Steps: 64 | Train Loss: 0.1265797 Vali Loss: 0.1736003 Test Loss: 0.2237430
Validation loss decreased (0.173713 --> 0.173600).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 32 cost time: 0.8597450256347656
Epoch: 32, Steps: 64 | Train Loss: 0.1263402 Vali Loss: 0.1728079 Test Loss: 0.2223705
Validation loss decreased (0.173600 --> 0.172808).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 33 cost time: 0.8787682056427002
Epoch: 33, Steps: 64 | Train Loss: 0.1265257 Vali Loss: 0.1754014 Test Loss: 0.2237557
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 34 cost time: 0.8919985294342041
Epoch: 34, Steps: 64 | Train Loss: 0.1265808 Vali Loss: 0.1725013 Test Loss: 0.2227906
Validation loss decreased (0.172808 --> 0.172501).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 35 cost time: 0.886467456817627
Epoch: 35, Steps: 64 | Train Loss: 0.1260106 Vali Loss: 0.1727000 Test Loss: 0.2238742
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 36 cost time: 0.9013748168945312
Epoch: 36, Steps: 64 | Train Loss: 0.1256323 Vali Loss: 0.1745568 Test Loss: 0.2231193
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 37 cost time: 0.9094247817993164
Epoch: 37, Steps: 64 | Train Loss: 0.1257997 Vali Loss: 0.1730232 Test Loss: 0.2221537
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 38 cost time: 0.921778678894043
Epoch: 38, Steps: 64 | Train Loss: 0.1257569 Vali Loss: 0.1732363 Test Loss: 0.2242968
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 39 cost time: 0.9138176441192627
Epoch: 39, Steps: 64 | Train Loss: 0.1264048 Vali Loss: 0.1737982 Test Loss: 0.2226283
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 40 cost time: 0.9200005531311035
Epoch: 40, Steps: 64 | Train Loss: 0.1259300 Vali Loss: 0.1739008 Test Loss: 0.2230337
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 41 cost time: 0.8946084976196289
Epoch: 41, Steps: 64 | Train Loss: 0.1255676 Vali Loss: 0.1742955 Test Loss: 0.2233791
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 42 cost time: 0.889169454574585
Epoch: 42, Steps: 64 | Train Loss: 0.1259888 Vali Loss: 0.1736173 Test Loss: 0.2233198
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 43 cost time: 0.8913869857788086
Epoch: 43, Steps: 64 | Train Loss: 0.1261287 Vali Loss: 0.1722803 Test Loss: 0.2219903
Validation loss decreased (0.172501 --> 0.172280).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 44 cost time: 0.8579776287078857
Epoch: 44, Steps: 64 | Train Loss: 0.1258724 Vali Loss: 0.1742708 Test Loss: 0.2245012
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 45 cost time: 0.8759982585906982
Epoch: 45, Steps: 64 | Train Loss: 0.1255686 Vali Loss: 0.1729648 Test Loss: 0.2231645
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 46 cost time: 0.8899996280670166
Epoch: 46, Steps: 64 | Train Loss: 0.1253881 Vali Loss: 0.1730710 Test Loss: 0.2226620
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 47 cost time: 0.8926434516906738
Epoch: 47, Steps: 64 | Train Loss: 0.1254389 Vali Loss: 0.1737013 Test Loss: 0.2222350
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 48 cost time: 0.8864703178405762
Epoch: 48, Steps: 64 | Train Loss: 0.1252769 Vali Loss: 0.1733178 Test Loss: 0.2227831
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 49 cost time: 0.8883819580078125
Epoch: 49, Steps: 64 | Train Loss: 0.1259189 Vali Loss: 0.1744677 Test Loss: 0.2230423
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 50 cost time: 0.8617842197418213
Epoch: 50, Steps: 64 | Train Loss: 0.1254849 Vali Loss: 0.1727780 Test Loss: 0.2238280
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 51 cost time: 0.8694500923156738
Epoch: 51, Steps: 64 | Train Loss: 0.1259617 Vali Loss: 0.1739234 Test Loss: 0.2226976
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 52 cost time: 0.8646318912506104
Epoch: 52, Steps: 64 | Train Loss: 0.1255842 Vali Loss: 0.1728539 Test Loss: 0.2230474
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 53 cost time: 0.861581563949585
Epoch: 53, Steps: 64 | Train Loss: 0.1257241 Vali Loss: 0.1706920 Test Loss: 0.2217939
Validation loss decreased (0.172280 --> 0.170692).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 54 cost time: 0.8925204277038574
Epoch: 54, Steps: 64 | Train Loss: 0.1255309 Vali Loss: 0.1718455 Test Loss: 0.2231106
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 55 cost time: 0.9133672714233398
Epoch: 55, Steps: 64 | Train Loss: 0.1250279 Vali Loss: 0.1739405 Test Loss: 0.2228222
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 56 cost time: 0.910283088684082
Epoch: 56, Steps: 64 | Train Loss: 0.1255566 Vali Loss: 0.1732208 Test Loss: 0.2221887
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 57 cost time: 0.9199981689453125
Epoch: 57, Steps: 64 | Train Loss: 0.1251713 Vali Loss: 0.1730503 Test Loss: 0.2227271
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 58 cost time: 0.9160068035125732
Epoch: 58, Steps: 64 | Train Loss: 0.1254461 Vali Loss: 0.1728463 Test Loss: 0.2227026
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 59 cost time: 0.8956344127655029
Epoch: 59, Steps: 64 | Train Loss: 0.1252856 Vali Loss: 0.1713813 Test Loss: 0.2221991
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 60 cost time: 0.8903744220733643
Epoch: 60, Steps: 64 | Train Loss: 0.1255367 Vali Loss: 0.1729987 Test Loss: 0.2227434
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22179386019706726, mae:0.32833006978034973, rse:0.2386760711669922
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03713369369506836 GB
Epoch: 1 cost time: 2.3642446994781494
Epoch: 1, Steps: 64 | Train Loss: 0.9445690 Vali Loss: 2.5837054 Test Loss: 4.0902848
Validation loss decreased (inf --> 2.583705).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 2 cost time: 0.9851484298706055
Epoch: 2, Steps: 64 | Train Loss: 0.8380495 Vali Loss: 2.0063136 Test Loss: 3.1102808
Validation loss decreased (2.583705 --> 2.006314).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 3 cost time: 0.9840052127838135
Epoch: 3, Steps: 64 | Train Loss: 0.6356761 Vali Loss: 1.3297737 Test Loss: 1.9983490
Validation loss decreased (2.006314 --> 1.329774).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 4 cost time: 0.9833908081054688
Epoch: 4, Steps: 64 | Train Loss: 0.3991447 Vali Loss: 0.6546749 Test Loss: 0.9059726
Validation loss decreased (1.329774 --> 0.654675).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 5 cost time: 0.9711360931396484
Epoch: 5, Steps: 64 | Train Loss: 0.2246251 Vali Loss: 0.3231476 Test Loss: 0.3905534
Validation loss decreased (0.654675 --> 0.323148).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 6 cost time: 0.9547429084777832
Epoch: 6, Steps: 64 | Train Loss: 0.1644815 Vali Loss: 0.2350264 Test Loss: 0.2762075
Validation loss decreased (0.323148 --> 0.235026).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 7 cost time: 0.9536395072937012
Epoch: 7, Steps: 64 | Train Loss: 0.1512587 Vali Loss: 0.2141031 Test Loss: 0.2553680
Validation loss decreased (0.235026 --> 0.214103).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 8 cost time: 0.9586336612701416
Epoch: 8, Steps: 64 | Train Loss: 0.1447517 Vali Loss: 0.1967930 Test Loss: 0.2423246
Validation loss decreased (0.214103 --> 0.196793).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 9 cost time: 0.958636999130249
Epoch: 9, Steps: 64 | Train Loss: 0.1415496 Vali Loss: 0.1956999 Test Loss: 0.2421652
Validation loss decreased (0.196793 --> 0.195700).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 10 cost time: 0.9843504428863525
Epoch: 10, Steps: 64 | Train Loss: 0.1382768 Vali Loss: 0.1908567 Test Loss: 0.2388756
Validation loss decreased (0.195700 --> 0.190857).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 11 cost time: 0.9943711757659912
Epoch: 11, Steps: 64 | Train Loss: 0.1366285 Vali Loss: 0.1858514 Test Loss: 0.2352585
Validation loss decreased (0.190857 --> 0.185851).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 12 cost time: 1.0064926147460938
Epoch: 12, Steps: 64 | Train Loss: 0.1343551 Vali Loss: 0.1863738 Test Loss: 0.2360645
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 13 cost time: 1.0050406455993652
Epoch: 13, Steps: 64 | Train Loss: 0.1333253 Vali Loss: 0.1849029 Test Loss: 0.2340979
Validation loss decreased (0.185851 --> 0.184903).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 14 cost time: 0.9929766654968262
Epoch: 14, Steps: 64 | Train Loss: 0.1320613 Vali Loss: 0.1817386 Test Loss: 0.2345071
Validation loss decreased (0.184903 --> 0.181739).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 15 cost time: 0.9789867401123047
Epoch: 15, Steps: 64 | Train Loss: 0.1312118 Vali Loss: 0.1805231 Test Loss: 0.2326283
Validation loss decreased (0.181739 --> 0.180523).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 16 cost time: 0.9844489097595215
Epoch: 16, Steps: 64 | Train Loss: 0.1302536 Vali Loss: 0.1813842 Test Loss: 0.2345252
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 17 cost time: 0.9791204929351807
Epoch: 17, Steps: 64 | Train Loss: 0.1298534 Vali Loss: 0.1809744 Test Loss: 0.2322679
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 18 cost time: 1.003730058670044
Epoch: 18, Steps: 64 | Train Loss: 0.1293055 Vali Loss: 0.1797297 Test Loss: 0.2309015
Validation loss decreased (0.180523 --> 0.179730).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 19 cost time: 0.9870004653930664
Epoch: 19, Steps: 64 | Train Loss: 0.1290274 Vali Loss: 0.1782495 Test Loss: 0.2315347
Validation loss decreased (0.179730 --> 0.178249).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 20 cost time: 1.0390615463256836
Epoch: 20, Steps: 64 | Train Loss: 0.1280790 Vali Loss: 0.1791553 Test Loss: 0.2313766
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 21 cost time: 1.0266425609588623
Epoch: 21, Steps: 64 | Train Loss: 0.1286589 Vali Loss: 0.1777325 Test Loss: 0.2319659
Validation loss decreased (0.178249 --> 0.177732).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 22 cost time: 1.012627363204956
Epoch: 22, Steps: 64 | Train Loss: 0.1273767 Vali Loss: 0.1783700 Test Loss: 0.2323101
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 23 cost time: 0.9852175712585449
Epoch: 23, Steps: 64 | Train Loss: 0.1271568 Vali Loss: 0.1797924 Test Loss: 0.2320717
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 24 cost time: 0.9836471080780029
Epoch: 24, Steps: 64 | Train Loss: 0.1266486 Vali Loss: 0.1772641 Test Loss: 0.2315196
Validation loss decreased (0.177732 --> 0.177264).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 25 cost time: 0.9434115886688232
Epoch: 25, Steps: 64 | Train Loss: 0.1262059 Vali Loss: 0.1773244 Test Loss: 0.2317957
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 26 cost time: 0.9642963409423828
Epoch: 26, Steps: 64 | Train Loss: 0.1257277 Vali Loss: 0.1786624 Test Loss: 0.2322221
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 27 cost time: 0.9703612327575684
Epoch: 27, Steps: 64 | Train Loss: 0.1262973 Vali Loss: 0.1789765 Test Loss: 0.2320934
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 28 cost time: 0.9665155410766602
Epoch: 28, Steps: 64 | Train Loss: 0.1258481 Vali Loss: 0.1764082 Test Loss: 0.2312116
Validation loss decreased (0.177264 --> 0.176408).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 29 cost time: 0.9831678867340088
Epoch: 29, Steps: 64 | Train Loss: 0.1253185 Vali Loss: 0.1779223 Test Loss: 0.2320629
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 30 cost time: 0.9670000076293945
Epoch: 30, Steps: 64 | Train Loss: 0.1251042 Vali Loss: 0.1755705 Test Loss: 0.2308909
Validation loss decreased (0.176408 --> 0.175570).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 31 cost time: 0.9730000495910645
Epoch: 31, Steps: 64 | Train Loss: 0.1256989 Vali Loss: 0.1764245 Test Loss: 0.2314125
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 32 cost time: 0.9723422527313232
Epoch: 32, Steps: 64 | Train Loss: 0.1256141 Vali Loss: 0.1780576 Test Loss: 0.2311436
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 33 cost time: 0.9700284004211426
Epoch: 33, Steps: 64 | Train Loss: 0.1256238 Vali Loss: 0.1762750 Test Loss: 0.2329868
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 34 cost time: 0.9913790225982666
Epoch: 34, Steps: 64 | Train Loss: 0.1250164 Vali Loss: 0.1778913 Test Loss: 0.2322717
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 35 cost time: 0.9913620948791504
Epoch: 35, Steps: 64 | Train Loss: 0.1247855 Vali Loss: 0.1785134 Test Loss: 0.2310951
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 36 cost time: 0.992405891418457
Epoch: 36, Steps: 64 | Train Loss: 0.1248318 Vali Loss: 0.1772110 Test Loss: 0.2313685
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 37 cost time: 0.994429349899292
Epoch: 37, Steps: 64 | Train Loss: 0.1245890 Vali Loss: 0.1782466 Test Loss: 0.2315808
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 38 cost time: 0.9600121974945068
Epoch: 38, Steps: 64 | Train Loss: 0.1247043 Vali Loss: 0.1771841 Test Loss: 0.2319033
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 39 cost time: 0.9317541122436523
Epoch: 39, Steps: 64 | Train Loss: 0.1248958 Vali Loss: 0.1775956 Test Loss: 0.2315086
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 40 cost time: 0.9333574771881104
Epoch: 40, Steps: 64 | Train Loss: 0.1249472 Vali Loss: 0.1782027 Test Loss: 0.2316184
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 41 cost time: 0.9374160766601562
Epoch: 41, Steps: 64 | Train Loss: 0.1247604 Vali Loss: 0.1781127 Test Loss: 0.2320444
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 42 cost time: 0.9286208152770996
Epoch: 42, Steps: 64 | Train Loss: 0.1246910 Vali Loss: 0.1778873 Test Loss: 0.2324060
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 43 cost time: 0.966759204864502
Epoch: 43, Steps: 64 | Train Loss: 0.1247005 Vali Loss: 0.1758436 Test Loss: 0.2308952
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 44 cost time: 0.9745991230010986
Epoch: 44, Steps: 64 | Train Loss: 0.1246288 Vali Loss: 0.1779138 Test Loss: 0.2317046
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 45 cost time: 0.9695563316345215
Epoch: 45, Steps: 64 | Train Loss: 0.1241295 Vali Loss: 0.1787947 Test Loss: 0.2315454
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 46 cost time: 0.9598150253295898
Epoch: 46, Steps: 64 | Train Loss: 0.1243863 Vali Loss: 0.1771355 Test Loss: 0.2314906
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 47 cost time: 0.9433934688568115
Epoch: 47, Steps: 64 | Train Loss: 0.1239021 Vali Loss: 0.1755396 Test Loss: 0.2310810
Validation loss decreased (0.175570 --> 0.175540).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 48 cost time: 0.9737029075622559
Epoch: 48, Steps: 64 | Train Loss: 0.1244976 Vali Loss: 0.1763446 Test Loss: 0.2309094
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 49 cost time: 0.9698238372802734
Epoch: 49, Steps: 64 | Train Loss: 0.1246087 Vali Loss: 0.1782258 Test Loss: 0.2319809
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 50 cost time: 0.9757533073425293
Epoch: 50, Steps: 64 | Train Loss: 0.1245749 Vali Loss: 0.1768932 Test Loss: 0.2321583
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 51 cost time: 0.9876546859741211
Epoch: 51, Steps: 64 | Train Loss: 0.1243039 Vali Loss: 0.1773210 Test Loss: 0.2321623
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 52 cost time: 0.9964189529418945
Epoch: 52, Steps: 64 | Train Loss: 0.1244000 Vali Loss: 0.1770185 Test Loss: 0.2312331
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 53 cost time: 0.9902393817901611
Epoch: 53, Steps: 64 | Train Loss: 0.1241352 Vali Loss: 0.1771749 Test Loss: 0.2309746
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 54 cost time: 1.0023446083068848
Epoch: 54, Steps: 64 | Train Loss: 0.1244973 Vali Loss: 0.1769022 Test Loss: 0.2317406
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 55 cost time: 0.98813796043396
Epoch: 55, Steps: 64 | Train Loss: 0.1243156 Vali Loss: 0.1778021 Test Loss: 0.2330852
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 56 cost time: 0.96942138671875
Epoch: 56, Steps: 64 | Train Loss: 0.1245093 Vali Loss: 0.1778212 Test Loss: 0.2324122
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 57 cost time: 0.9463527202606201
Epoch: 57, Steps: 64 | Train Loss: 0.1245581 Vali Loss: 0.1758532 Test Loss: 0.2315193
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 58 cost time: 0.9337482452392578
Epoch: 58, Steps: 64 | Train Loss: 0.1241723 Vali Loss: 0.1772032 Test Loss: 0.2312030
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 59 cost time: 0.9320015907287598
Epoch: 59, Steps: 64 | Train Loss: 0.1242910 Vali Loss: 0.1757389 Test Loss: 0.2316588
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 60 cost time: 0.964000940322876
Epoch: 60, Steps: 64 | Train Loss: 0.1239899 Vali Loss: 0.1750448 Test Loss: 0.2314469
Validation loss decreased (0.175540 --> 0.175045).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23144689202308655, mae:0.3448663651943207, rse:0.24381466209888458
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03602886199951172 GB
Epoch: 1 cost time: 2.2333381175994873
Epoch: 1, Steps: 64 | Train Loss: 1.1495758 Vali Loss: 2.7682362 Test Loss: 4.3282957
Validation loss decreased (inf --> 2.768236).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 2 cost time: 0.8808388710021973
Epoch: 2, Steps: 64 | Train Loss: 0.9200365 Vali Loss: 1.5493351 Test Loss: 2.3379118
Validation loss decreased (2.768236 --> 1.549335).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 3 cost time: 0.8780994415283203
Epoch: 3, Steps: 64 | Train Loss: 0.5643529 Vali Loss: 0.9668638 Test Loss: 1.3819273
Validation loss decreased (1.549335 --> 0.966864).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 4 cost time: 0.8883593082427979
Epoch: 4, Steps: 64 | Train Loss: 0.4102710 Vali Loss: 0.7048486 Test Loss: 0.9445253
Validation loss decreased (0.966864 --> 0.704849).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 5 cost time: 0.8835222721099854
Epoch: 5, Steps: 64 | Train Loss: 0.3195326 Vali Loss: 0.5258886 Test Loss: 0.6738234
Validation loss decreased (0.704849 --> 0.525889).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 6 cost time: 0.8726396560668945
Epoch: 6, Steps: 64 | Train Loss: 0.2661406 Vali Loss: 0.4291666 Test Loss: 0.5344184
Validation loss decreased (0.525889 --> 0.429167).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 7 cost time: 0.8546295166015625
Epoch: 7, Steps: 64 | Train Loss: 0.2360385 Vali Loss: 0.3714293 Test Loss: 0.4551136
Validation loss decreased (0.429167 --> 0.371429).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 8 cost time: 0.8673884868621826
Epoch: 8, Steps: 64 | Train Loss: 0.2158281 Vali Loss: 0.3315469 Test Loss: 0.4019721
Validation loss decreased (0.371429 --> 0.331547).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 9 cost time: 0.8500673770904541
Epoch: 9, Steps: 64 | Train Loss: 0.2018142 Vali Loss: 0.2994076 Test Loss: 0.3636967
Validation loss decreased (0.331547 --> 0.299408).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 10 cost time: 0.8790252208709717
Epoch: 10, Steps: 64 | Train Loss: 0.1916924 Vali Loss: 0.2763488 Test Loss: 0.3342493
Validation loss decreased (0.299408 --> 0.276349).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 11 cost time: 0.8977837562561035
Epoch: 11, Steps: 64 | Train Loss: 0.1844390 Vali Loss: 0.2511798 Test Loss: 0.3085290
Validation loss decreased (0.276349 --> 0.251180).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 12 cost time: 0.9069995880126953
Epoch: 12, Steps: 64 | Train Loss: 0.1783555 Vali Loss: 0.2417414 Test Loss: 0.2961246
Validation loss decreased (0.251180 --> 0.241741).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 13 cost time: 0.9136462211608887
Epoch: 13, Steps: 64 | Train Loss: 0.1742745 Vali Loss: 0.2332651 Test Loss: 0.2830060
Validation loss decreased (0.241741 --> 0.233265).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 14 cost time: 0.9003498554229736
Epoch: 14, Steps: 64 | Train Loss: 0.1701472 Vali Loss: 0.2270230 Test Loss: 0.2766764
Validation loss decreased (0.233265 --> 0.227023).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 15 cost time: 0.893455982208252
Epoch: 15, Steps: 64 | Train Loss: 0.1671186 Vali Loss: 0.2162399 Test Loss: 0.2670538
Validation loss decreased (0.227023 --> 0.216240).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 16 cost time: 0.8864102363586426
Epoch: 16, Steps: 64 | Train Loss: 0.1652386 Vali Loss: 0.2135114 Test Loss: 0.2636766
Validation loss decreased (0.216240 --> 0.213511).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 17 cost time: 0.8833608627319336
Epoch: 17, Steps: 64 | Train Loss: 0.1633003 Vali Loss: 0.2107705 Test Loss: 0.2589582
Validation loss decreased (0.213511 --> 0.210770).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 18 cost time: 0.8863444328308105
Epoch: 18, Steps: 64 | Train Loss: 0.1615817 Vali Loss: 0.2086215 Test Loss: 0.2539141
Validation loss decreased (0.210770 --> 0.208622).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 19 cost time: 0.9036421775817871
Epoch: 19, Steps: 64 | Train Loss: 0.1596917 Vali Loss: 0.2032537 Test Loss: 0.2503901
Validation loss decreased (0.208622 --> 0.203254).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 20 cost time: 0.9085283279418945
Epoch: 20, Steps: 64 | Train Loss: 0.1585245 Vali Loss: 0.2003126 Test Loss: 0.2477665
Validation loss decreased (0.203254 --> 0.200313).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 21 cost time: 0.9034302234649658
Epoch: 21, Steps: 64 | Train Loss: 0.1574302 Vali Loss: 0.2004531 Test Loss: 0.2490747
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 22 cost time: 0.9015443325042725
Epoch: 22, Steps: 64 | Train Loss: 0.1561736 Vali Loss: 0.1994684 Test Loss: 0.2460931
Validation loss decreased (0.200313 --> 0.199468).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 23 cost time: 0.8779547214508057
Epoch: 23, Steps: 64 | Train Loss: 0.1553415 Vali Loss: 0.1962993 Test Loss: 0.2417929
Validation loss decreased (0.199468 --> 0.196299).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 24 cost time: 0.8629982471466064
Epoch: 24, Steps: 64 | Train Loss: 0.1551379 Vali Loss: 0.1967219 Test Loss: 0.2414734
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 25 cost time: 0.8590056896209717
Epoch: 25, Steps: 64 | Train Loss: 0.1539521 Vali Loss: 0.1963654 Test Loss: 0.2430798
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 26 cost time: 0.8765707015991211
Epoch: 26, Steps: 64 | Train Loss: 0.1538430 Vali Loss: 0.1967304 Test Loss: 0.2412050
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 27 cost time: 0.8593668937683105
Epoch: 27, Steps: 64 | Train Loss: 0.1534020 Vali Loss: 0.1927155 Test Loss: 0.2410955
Validation loss decreased (0.196299 --> 0.192715).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 28 cost time: 0.8713734149932861
Epoch: 28, Steps: 64 | Train Loss: 0.1530825 Vali Loss: 0.1926809 Test Loss: 0.2381904
Validation loss decreased (0.192715 --> 0.192681).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 29 cost time: 0.8797359466552734
Epoch: 29, Steps: 64 | Train Loss: 0.1523712 Vali Loss: 0.1920487 Test Loss: 0.2374046
Validation loss decreased (0.192681 --> 0.192049).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 30 cost time: 0.8729994297027588
Epoch: 30, Steps: 64 | Train Loss: 0.1517696 Vali Loss: 0.1912328 Test Loss: 0.2368673
Validation loss decreased (0.192049 --> 0.191233).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 31 cost time: 0.8846421241760254
Epoch: 31, Steps: 64 | Train Loss: 0.1519722 Vali Loss: 0.1900356 Test Loss: 0.2381277
Validation loss decreased (0.191233 --> 0.190036).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 32 cost time: 0.8633177280426025
Epoch: 32, Steps: 64 | Train Loss: 0.1512647 Vali Loss: 0.1906922 Test Loss: 0.2372813
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 33 cost time: 0.8873844146728516
Epoch: 33, Steps: 64 | Train Loss: 0.1514546 Vali Loss: 0.1907479 Test Loss: 0.2365704
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 34 cost time: 0.8824291229248047
Epoch: 34, Steps: 64 | Train Loss: 0.1509306 Vali Loss: 0.1896740 Test Loss: 0.2350889
Validation loss decreased (0.190036 --> 0.189674).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 35 cost time: 0.890836238861084
Epoch: 35, Steps: 64 | Train Loss: 0.1506040 Vali Loss: 0.1884785 Test Loss: 0.2377045
Validation loss decreased (0.189674 --> 0.188478).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 36 cost time: 0.8850440979003906
Epoch: 36, Steps: 64 | Train Loss: 0.1497848 Vali Loss: 0.1898214 Test Loss: 0.2365216
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 37 cost time: 0.9116382598876953
Epoch: 37, Steps: 64 | Train Loss: 0.1502686 Vali Loss: 0.1893466 Test Loss: 0.2359936
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 38 cost time: 0.9003567695617676
Epoch: 38, Steps: 64 | Train Loss: 0.1496893 Vali Loss: 0.1870494 Test Loss: 0.2354903
Validation loss decreased (0.188478 --> 0.187049).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 39 cost time: 0.9093952178955078
Epoch: 39, Steps: 64 | Train Loss: 0.1499604 Vali Loss: 0.1875010 Test Loss: 0.2344472
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 40 cost time: 0.9359927177429199
Epoch: 40, Steps: 64 | Train Loss: 0.1498133 Vali Loss: 0.1886388 Test Loss: 0.2362368
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 41 cost time: 0.893787145614624
Epoch: 41, Steps: 64 | Train Loss: 0.1497022 Vali Loss: 0.1871376 Test Loss: 0.2360753
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 42 cost time: 0.8859982490539551
Epoch: 42, Steps: 64 | Train Loss: 0.1498067 Vali Loss: 0.1878596 Test Loss: 0.2350667
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 43 cost time: 0.8730008602142334
Epoch: 43, Steps: 64 | Train Loss: 0.1483024 Vali Loss: 0.1887973 Test Loss: 0.2341733
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 44 cost time: 0.864844799041748
Epoch: 44, Steps: 64 | Train Loss: 0.1491334 Vali Loss: 0.1894583 Test Loss: 0.2372414
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 45 cost time: 0.8531761169433594
Epoch: 45, Steps: 64 | Train Loss: 0.1486216 Vali Loss: 0.1890313 Test Loss: 0.2339485
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 46 cost time: 0.8774278163909912
Epoch: 46, Steps: 64 | Train Loss: 0.1480775 Vali Loss: 0.1884855 Test Loss: 0.2368504
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 47 cost time: 0.8817753791809082
Epoch: 47, Steps: 64 | Train Loss: 0.1487199 Vali Loss: 0.1869000 Test Loss: 0.2331683
Validation loss decreased (0.187049 --> 0.186900).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 48 cost time: 0.8804426193237305
Epoch: 48, Steps: 64 | Train Loss: 0.1485931 Vali Loss: 0.1864475 Test Loss: 0.2360043
Validation loss decreased (0.186900 --> 0.186448).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 49 cost time: 0.876013994216919
Epoch: 49, Steps: 64 | Train Loss: 0.1480599 Vali Loss: 0.1878991 Test Loss: 0.2336067
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 50 cost time: 0.8614065647125244
Epoch: 50, Steps: 64 | Train Loss: 0.1488908 Vali Loss: 0.1882769 Test Loss: 0.2339596
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 51 cost time: 0.8713257312774658
Epoch: 51, Steps: 64 | Train Loss: 0.1481867 Vali Loss: 0.1867864 Test Loss: 0.2335137
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 52 cost time: 0.8707315921783447
Epoch: 52, Steps: 64 | Train Loss: 0.1496795 Vali Loss: 0.1862700 Test Loss: 0.2332941
Validation loss decreased (0.186448 --> 0.186270).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 53 cost time: 0.862999677658081
Epoch: 53, Steps: 64 | Train Loss: 0.1478917 Vali Loss: 0.1852410 Test Loss: 0.2336189
Validation loss decreased (0.186270 --> 0.185241).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 54 cost time: 0.8682897090911865
Epoch: 54, Steps: 64 | Train Loss: 0.1487421 Vali Loss: 0.1872069 Test Loss: 0.2341488
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 55 cost time: 0.9088594913482666
Epoch: 55, Steps: 64 | Train Loss: 0.1473834 Vali Loss: 0.1864689 Test Loss: 0.2343611
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 56 cost time: 0.909412145614624
Epoch: 56, Steps: 64 | Train Loss: 0.1482517 Vali Loss: 0.1872288 Test Loss: 0.2344847
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 57 cost time: 0.9018824100494385
Epoch: 57, Steps: 64 | Train Loss: 0.1476954 Vali Loss: 0.1880849 Test Loss: 0.2350520
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 58 cost time: 0.9114820957183838
Epoch: 58, Steps: 64 | Train Loss: 0.1485120 Vali Loss: 0.1879256 Test Loss: 0.2340054
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 59 cost time: 0.8900020122528076
Epoch: 59, Steps: 64 | Train Loss: 0.1484692 Vali Loss: 0.1863441 Test Loss: 0.2333145
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 60 cost time: 0.8776454925537109
Epoch: 60, Steps: 64 | Train Loss: 0.1483009 Vali Loss: 0.1847329 Test Loss: 0.2333017
Validation loss decreased (0.185241 --> 0.184733).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23330174386501312, mae:0.34200164675712585, rse:0.2447897046804428
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.036730289459228516 GB
Epoch: 1 cost time: 2.2673146724700928
Epoch: 1, Steps: 64 | Train Loss: 0.9103740 Vali Loss: 2.3205404 Test Loss: 3.7308109
Validation loss decreased (inf --> 2.320540).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 2 cost time: 0.9202511310577393
Epoch: 2, Steps: 64 | Train Loss: 0.6748700 Vali Loss: 1.1238134 Test Loss: 1.7270023
Validation loss decreased (2.320540 --> 1.123813).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 3 cost time: 0.9240744113922119
Epoch: 3, Steps: 64 | Train Loss: 0.3854907 Vali Loss: 0.5977102 Test Loss: 0.8401715
Validation loss decreased (1.123813 --> 0.597710).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 4 cost time: 0.9083602428436279
Epoch: 4, Steps: 64 | Train Loss: 0.2493210 Vali Loss: 0.3712901 Test Loss: 0.4671922
Validation loss decreased (0.597710 --> 0.371290).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 5 cost time: 0.9118578433990479
Epoch: 5, Steps: 64 | Train Loss: 0.1921518 Vali Loss: 0.2722337 Test Loss: 0.3276141
Validation loss decreased (0.371290 --> 0.272234).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 6 cost time: 0.8756458759307861
Epoch: 6, Steps: 64 | Train Loss: 0.1695209 Vali Loss: 0.2292812 Test Loss: 0.2743362
Validation loss decreased (0.272234 --> 0.229281).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 7 cost time: 0.874255895614624
Epoch: 7, Steps: 64 | Train Loss: 0.1577333 Vali Loss: 0.2069811 Test Loss: 0.2559774
Validation loss decreased (0.229281 --> 0.206981).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 8 cost time: 0.8786203861236572
Epoch: 8, Steps: 64 | Train Loss: 0.1513930 Vali Loss: 0.1936351 Test Loss: 0.2431803
Validation loss decreased (0.206981 --> 0.193635).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 9 cost time: 0.8934097290039062
Epoch: 9, Steps: 64 | Train Loss: 0.1468169 Vali Loss: 0.1871249 Test Loss: 0.2335263
Validation loss decreased (0.193635 --> 0.187125).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 10 cost time: 0.9083850383758545
Epoch: 10, Steps: 64 | Train Loss: 0.1433952 Vali Loss: 0.1823591 Test Loss: 0.2319731
Validation loss decreased (0.187125 --> 0.182359).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 11 cost time: 0.9193806648254395
Epoch: 11, Steps: 64 | Train Loss: 0.1405406 Vali Loss: 0.1780068 Test Loss: 0.2256321
Validation loss decreased (0.182359 --> 0.178007).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 12 cost time: 0.9421014785766602
Epoch: 12, Steps: 64 | Train Loss: 0.1391712 Vali Loss: 0.1802315 Test Loss: 0.2285686
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 13 cost time: 0.9359984397888184
Epoch: 13, Steps: 64 | Train Loss: 0.1368252 Vali Loss: 0.1749067 Test Loss: 0.2246620
Validation loss decreased (0.178007 --> 0.174907).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 14 cost time: 0.9086387157440186
Epoch: 14, Steps: 64 | Train Loss: 0.1352980 Vali Loss: 0.1747032 Test Loss: 0.2218792
Validation loss decreased (0.174907 --> 0.174703).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 15 cost time: 0.9144504070281982
Epoch: 15, Steps: 64 | Train Loss: 0.1337220 Vali Loss: 0.1708872 Test Loss: 0.2217118
Validation loss decreased (0.174703 --> 0.170887).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 16 cost time: 0.9150567054748535
Epoch: 16, Steps: 64 | Train Loss: 0.1334400 Vali Loss: 0.1696170 Test Loss: 0.2235042
Validation loss decreased (0.170887 --> 0.169617).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 17 cost time: 0.9073491096496582
Epoch: 17, Steps: 64 | Train Loss: 0.1322470 Vali Loss: 0.1686507 Test Loss: 0.2205482
Validation loss decreased (0.169617 --> 0.168651).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 18 cost time: 0.9109756946563721
Epoch: 18, Steps: 64 | Train Loss: 0.1312660 Vali Loss: 0.1704614 Test Loss: 0.2217273
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 19 cost time: 0.9237399101257324
Epoch: 19, Steps: 64 | Train Loss: 0.1299451 Vali Loss: 0.1673473 Test Loss: 0.2193291
Validation loss decreased (0.168651 --> 0.167347).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 20 cost time: 0.9287459850311279
Epoch: 20, Steps: 64 | Train Loss: 0.1297596 Vali Loss: 0.1666030 Test Loss: 0.2197771
Validation loss decreased (0.167347 --> 0.166603).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 21 cost time: 0.9246373176574707
Epoch: 21, Steps: 64 | Train Loss: 0.1294141 Vali Loss: 0.1685683 Test Loss: 0.2218764
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 22 cost time: 0.8992722034454346
Epoch: 22, Steps: 64 | Train Loss: 0.1285453 Vali Loss: 0.1664795 Test Loss: 0.2191300
Validation loss decreased (0.166603 --> 0.166480).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 23 cost time: 0.8904640674591064
Epoch: 23, Steps: 64 | Train Loss: 0.1274170 Vali Loss: 0.1645552 Test Loss: 0.2199402
Validation loss decreased (0.166480 --> 0.164555).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 24 cost time: 0.8794023990631104
Epoch: 24, Steps: 64 | Train Loss: 0.1277497 Vali Loss: 0.1664279 Test Loss: 0.2218933
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 25 cost time: 0.889772891998291
Epoch: 25, Steps: 64 | Train Loss: 0.1275674 Vali Loss: 0.1668850 Test Loss: 0.2202647
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 26 cost time: 0.8927736282348633
Epoch: 26, Steps: 64 | Train Loss: 0.1270899 Vali Loss: 0.1664166 Test Loss: 0.2196701
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 27 cost time: 0.9029996395111084
Epoch: 27, Steps: 64 | Train Loss: 0.1268361 Vali Loss: 0.1668143 Test Loss: 0.2188560
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 28 cost time: 0.9066355228424072
Epoch: 28, Steps: 64 | Train Loss: 0.1267235 Vali Loss: 0.1626410 Test Loss: 0.2200618
Validation loss decreased (0.164555 --> 0.162641).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 29 cost time: 0.9026060104370117
Epoch: 29, Steps: 64 | Train Loss: 0.1255956 Vali Loss: 0.1647982 Test Loss: 0.2193890
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 30 cost time: 0.9054815769195557
Epoch: 30, Steps: 64 | Train Loss: 0.1258876 Vali Loss: 0.1636764 Test Loss: 0.2191916
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 31 cost time: 0.9003956317901611
Epoch: 31, Steps: 64 | Train Loss: 0.1256310 Vali Loss: 0.1639988 Test Loss: 0.2199754
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 32 cost time: 0.8937675952911377
Epoch: 32, Steps: 64 | Train Loss: 0.1258439 Vali Loss: 0.1649887 Test Loss: 0.2196346
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 33 cost time: 0.9128048419952393
Epoch: 33, Steps: 64 | Train Loss: 0.1246850 Vali Loss: 0.1627550 Test Loss: 0.2191222
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 34 cost time: 0.9076273441314697
Epoch: 34, Steps: 64 | Train Loss: 0.1252982 Vali Loss: 0.1605918 Test Loss: 0.2187037
Validation loss decreased (0.162641 --> 0.160592).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 35 cost time: 0.9093644618988037
Epoch: 35, Steps: 64 | Train Loss: 0.1255956 Vali Loss: 0.1627302 Test Loss: 0.2192678
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 36 cost time: 0.933384895324707
Epoch: 36, Steps: 64 | Train Loss: 0.1250997 Vali Loss: 0.1665482 Test Loss: 0.2211844
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 37 cost time: 0.9363956451416016
Epoch: 37, Steps: 64 | Train Loss: 0.1254679 Vali Loss: 0.1650554 Test Loss: 0.2196967
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 38 cost time: 0.9287333488464355
Epoch: 38, Steps: 64 | Train Loss: 0.1248965 Vali Loss: 0.1635261 Test Loss: 0.2198401
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 39 cost time: 0.9407286643981934
Epoch: 39, Steps: 64 | Train Loss: 0.1255317 Vali Loss: 0.1628213 Test Loss: 0.2198613
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 40 cost time: 0.9250020980834961
Epoch: 40, Steps: 64 | Train Loss: 0.1243213 Vali Loss: 0.1631083 Test Loss: 0.2191147
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 41 cost time: 0.9106395244598389
Epoch: 41, Steps: 64 | Train Loss: 0.1246281 Vali Loss: 0.1623561 Test Loss: 0.2195513
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 42 cost time: 0.9015955924987793
Epoch: 42, Steps: 64 | Train Loss: 0.1241771 Vali Loss: 0.1650483 Test Loss: 0.2201050
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 43 cost time: 0.8814709186553955
Epoch: 43, Steps: 64 | Train Loss: 0.1246611 Vali Loss: 0.1635410 Test Loss: 0.2205147
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 44 cost time: 0.8893961906433105
Epoch: 44, Steps: 64 | Train Loss: 0.1241565 Vali Loss: 0.1627843 Test Loss: 0.2200636
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 45 cost time: 0.9077701568603516
Epoch: 45, Steps: 64 | Train Loss: 0.1244070 Vali Loss: 0.1600543 Test Loss: 0.2186927
Validation loss decreased (0.160592 --> 0.160054).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 46 cost time: 0.9037272930145264
Epoch: 46, Steps: 64 | Train Loss: 0.1242195 Vali Loss: 0.1619817 Test Loss: 0.2186894
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 47 cost time: 0.9076321125030518
Epoch: 47, Steps: 64 | Train Loss: 0.1238746 Vali Loss: 0.1641667 Test Loss: 0.2179938
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 48 cost time: 0.904674768447876
Epoch: 48, Steps: 64 | Train Loss: 0.1245339 Vali Loss: 0.1624329 Test Loss: 0.2200063
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 49 cost time: 0.8923647403717041
Epoch: 49, Steps: 64 | Train Loss: 0.1246378 Vali Loss: 0.1622365 Test Loss: 0.2186514
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 50 cost time: 0.8948874473571777
Epoch: 50, Steps: 64 | Train Loss: 0.1241542 Vali Loss: 0.1633105 Test Loss: 0.2205620
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 51 cost time: 0.8987810611724854
Epoch: 51, Steps: 64 | Train Loss: 0.1245189 Vali Loss: 0.1626174 Test Loss: 0.2185543
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 52 cost time: 0.8906362056732178
Epoch: 52, Steps: 64 | Train Loss: 0.1244504 Vali Loss: 0.1631641 Test Loss: 0.2194382
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 53 cost time: 0.9119997024536133
Epoch: 53, Steps: 64 | Train Loss: 0.1241282 Vali Loss: 0.1637017 Test Loss: 0.2205611
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 54 cost time: 0.9280002117156982
Epoch: 54, Steps: 64 | Train Loss: 0.1241667 Vali Loss: 0.1647698 Test Loss: 0.2202183
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 55 cost time: 0.927776575088501
Epoch: 55, Steps: 64 | Train Loss: 0.1237495 Vali Loss: 0.1622442 Test Loss: 0.2189722
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 56 cost time: 0.9244379997253418
Epoch: 56, Steps: 64 | Train Loss: 0.1238725 Vali Loss: 0.1632608 Test Loss: 0.2198205
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 57 cost time: 0.935387372970581
Epoch: 57, Steps: 64 | Train Loss: 0.1238020 Vali Loss: 0.1630078 Test Loss: 0.2187958
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 58 cost time: 0.9103803634643555
Epoch: 58, Steps: 64 | Train Loss: 0.1242109 Vali Loss: 0.1623787 Test Loss: 0.2190619
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 59 cost time: 0.9057676792144775
Epoch: 59, Steps: 64 | Train Loss: 0.1243828 Vali Loss: 0.1630553 Test Loss: 0.2203922
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 60 cost time: 0.9074430465698242
Epoch: 60, Steps: 64 | Train Loss: 0.1240711 Vali Loss: 0.1624866 Test Loss: 0.2202151
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.21869274973869324, mae:0.3217099606990814, rse:0.23700164258480072
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03729438781738281 GB
Epoch: 1 cost time: 2.32780385017395
Epoch: 1, Steps: 64 | Train Loss: 0.8750657 Vali Loss: 2.3754489 Test Loss: 3.7570426
Validation loss decreased (inf --> 2.375449).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 2 cost time: 0.9783196449279785
Epoch: 2, Steps: 64 | Train Loss: 0.7394618 Vali Loss: 1.5872713 Test Loss: 2.4349566
Validation loss decreased (2.375449 --> 1.587271).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 3 cost time: 0.9793848991394043
Epoch: 3, Steps: 64 | Train Loss: 0.4792734 Vali Loss: 0.8396448 Test Loss: 1.1842070
Validation loss decreased (1.587271 --> 0.839645).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 4 cost time: 0.9824056625366211
Epoch: 4, Steps: 64 | Train Loss: 0.2767486 Vali Loss: 0.4288871 Test Loss: 0.5133561
Validation loss decreased (0.839645 --> 0.428887).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 5 cost time: 0.9711880683898926
Epoch: 5, Steps: 64 | Train Loss: 0.1860138 Vali Loss: 0.2916322 Test Loss: 0.3151408
Validation loss decreased (0.428887 --> 0.291632).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 6 cost time: 0.9680657386779785
Epoch: 6, Steps: 64 | Train Loss: 0.1581732 Vali Loss: 0.2340616 Test Loss: 0.2639752
Validation loss decreased (0.291632 --> 0.234062).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 7 cost time: 0.9941539764404297
Epoch: 7, Steps: 64 | Train Loss: 0.1468486 Vali Loss: 0.2011130 Test Loss: 0.2418580
Validation loss decreased (0.234062 --> 0.201113).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 8 cost time: 0.9784412384033203
Epoch: 8, Steps: 64 | Train Loss: 0.1417491 Vali Loss: 0.1949476 Test Loss: 0.2359208
Validation loss decreased (0.201113 --> 0.194948).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 9 cost time: 0.9724135398864746
Epoch: 9, Steps: 64 | Train Loss: 0.1379131 Vali Loss: 0.1918510 Test Loss: 0.2348351
Validation loss decreased (0.194948 --> 0.191851).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 10 cost time: 0.995441198348999
Epoch: 10, Steps: 64 | Train Loss: 0.1357335 Vali Loss: 0.1881210 Test Loss: 0.2329108
Validation loss decreased (0.191851 --> 0.188121).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 11 cost time: 1.0217673778533936
Epoch: 11, Steps: 64 | Train Loss: 0.1339080 Vali Loss: 0.1800185 Test Loss: 0.2293370
Validation loss decreased (0.188121 --> 0.180018).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 12 cost time: 0.9940016269683838
Epoch: 12, Steps: 64 | Train Loss: 0.1326258 Vali Loss: 0.1817380 Test Loss: 0.2298196
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 13 cost time: 0.9937546253204346
Epoch: 13, Steps: 64 | Train Loss: 0.1310823 Vali Loss: 0.1789044 Test Loss: 0.2282302
Validation loss decreased (0.180018 --> 0.178904).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 14 cost time: 0.9796180725097656
Epoch: 14, Steps: 64 | Train Loss: 0.1295779 Vali Loss: 0.1801056 Test Loss: 0.2280418
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 15 cost time: 0.9836249351501465
Epoch: 15, Steps: 64 | Train Loss: 0.1292036 Vali Loss: 0.1778292 Test Loss: 0.2265845
Validation loss decreased (0.178904 --> 0.177829).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 16 cost time: 0.9773678779602051
Epoch: 16, Steps: 64 | Train Loss: 0.1279481 Vali Loss: 0.1770140 Test Loss: 0.2266962
Validation loss decreased (0.177829 --> 0.177014).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 17 cost time: 0.9862353801727295
Epoch: 17, Steps: 64 | Train Loss: 0.1274332 Vali Loss: 0.1743190 Test Loss: 0.2258962
Validation loss decreased (0.177014 --> 0.174319).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 18 cost time: 1.0024852752685547
Epoch: 18, Steps: 64 | Train Loss: 0.1276106 Vali Loss: 0.1758647 Test Loss: 0.2273528
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 19 cost time: 0.992408275604248
Epoch: 19, Steps: 64 | Train Loss: 0.1262647 Vali Loss: 0.1758069 Test Loss: 0.2265258
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 20 cost time: 0.9824199676513672
Epoch: 20, Steps: 64 | Train Loss: 0.1258251 Vali Loss: 0.1734890 Test Loss: 0.2270277
Validation loss decreased (0.174319 --> 0.173489).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 21 cost time: 0.9893715381622314
Epoch: 21, Steps: 64 | Train Loss: 0.1261281 Vali Loss: 0.1736086 Test Loss: 0.2275385
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 22 cost time: 0.9643473625183105
Epoch: 22, Steps: 64 | Train Loss: 0.1255746 Vali Loss: 0.1721808 Test Loss: 0.2260902
Validation loss decreased (0.173489 --> 0.172181).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 23 cost time: 0.9707303047180176
Epoch: 23, Steps: 64 | Train Loss: 0.1253488 Vali Loss: 0.1718931 Test Loss: 0.2258508
Validation loss decreased (0.172181 --> 0.171893).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 24 cost time: 0.972999095916748
Epoch: 24, Steps: 64 | Train Loss: 0.1242508 Vali Loss: 0.1733653 Test Loss: 0.2257305
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 25 cost time: 0.9677848815917969
Epoch: 25, Steps: 64 | Train Loss: 0.1247059 Vali Loss: 0.1724410 Test Loss: 0.2261304
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 26 cost time: 0.9766345024108887
Epoch: 26, Steps: 64 | Train Loss: 0.1244469 Vali Loss: 0.1702592 Test Loss: 0.2260238
Validation loss decreased (0.171893 --> 0.170259).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 27 cost time: 0.9763777256011963
Epoch: 27, Steps: 64 | Train Loss: 0.1243302 Vali Loss: 0.1728987 Test Loss: 0.2259466
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 28 cost time: 0.9753463268280029
Epoch: 28, Steps: 64 | Train Loss: 0.1239263 Vali Loss: 0.1730385 Test Loss: 0.2262008
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 29 cost time: 1.0011348724365234
Epoch: 29, Steps: 64 | Train Loss: 0.1239511 Vali Loss: 0.1719345 Test Loss: 0.2256470
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 30 cost time: 0.9901399612426758
Epoch: 30, Steps: 64 | Train Loss: 0.1233043 Vali Loss: 0.1702918 Test Loss: 0.2249969
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 31 cost time: 1.0022900104522705
Epoch: 31, Steps: 64 | Train Loss: 0.1235230 Vali Loss: 0.1708328 Test Loss: 0.2256537
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 32 cost time: 0.9813394546508789
Epoch: 32, Steps: 64 | Train Loss: 0.1234602 Vali Loss: 0.1727823 Test Loss: 0.2252384
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 33 cost time: 0.9803612232208252
Epoch: 33, Steps: 64 | Train Loss: 0.1230861 Vali Loss: 0.1723346 Test Loss: 0.2260840
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 34 cost time: 1.0074505805969238
Epoch: 34, Steps: 64 | Train Loss: 0.1232868 Vali Loss: 0.1691454 Test Loss: 0.2242010
Validation loss decreased (0.170259 --> 0.169145).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 35 cost time: 1.0047433376312256
Epoch: 35, Steps: 64 | Train Loss: 0.1225905 Vali Loss: 0.1687871 Test Loss: 0.2248934
Validation loss decreased (0.169145 --> 0.168787).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 36 cost time: 1.0009992122650146
Epoch: 36, Steps: 64 | Train Loss: 0.1228840 Vali Loss: 0.1708334 Test Loss: 0.2253389
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 37 cost time: 1.0137567520141602
Epoch: 37, Steps: 64 | Train Loss: 0.1222753 Vali Loss: 0.1710163 Test Loss: 0.2258340
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 38 cost time: 0.9676220417022705
Epoch: 38, Steps: 64 | Train Loss: 0.1233335 Vali Loss: 0.1711324 Test Loss: 0.2249441
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 39 cost time: 0.9596250057220459
Epoch: 39, Steps: 64 | Train Loss: 0.1228767 Vali Loss: 0.1682164 Test Loss: 0.2256266
Validation loss decreased (0.168787 --> 0.168216).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 40 cost time: 0.9723756313323975
Epoch: 40, Steps: 64 | Train Loss: 0.1228755 Vali Loss: 0.1710827 Test Loss: 0.2254869
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 41 cost time: 0.9674937725067139
Epoch: 41, Steps: 64 | Train Loss: 0.1228153 Vali Loss: 0.1683569 Test Loss: 0.2249022
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 42 cost time: 0.9660289287567139
Epoch: 42, Steps: 64 | Train Loss: 0.1228503 Vali Loss: 0.1697484 Test Loss: 0.2253722
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 43 cost time: 0.9823744297027588
Epoch: 43, Steps: 64 | Train Loss: 0.1224333 Vali Loss: 0.1703288 Test Loss: 0.2254525
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 44 cost time: 0.9944243431091309
Epoch: 44, Steps: 64 | Train Loss: 0.1229643 Vali Loss: 0.1684575 Test Loss: 0.2244237
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 45 cost time: 0.9813849925994873
Epoch: 45, Steps: 64 | Train Loss: 0.1228994 Vali Loss: 0.1698133 Test Loss: 0.2255500
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 46 cost time: 0.9733693599700928
Epoch: 46, Steps: 64 | Train Loss: 0.1226681 Vali Loss: 0.1690418 Test Loss: 0.2248753
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 47 cost time: 0.9794352054595947
Epoch: 47, Steps: 64 | Train Loss: 0.1224739 Vali Loss: 0.1688980 Test Loss: 0.2256601
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 48 cost time: 0.9799990653991699
Epoch: 48, Steps: 64 | Train Loss: 0.1224716 Vali Loss: 0.1697976 Test Loss: 0.2250541
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 49 cost time: 0.9796195030212402
Epoch: 49, Steps: 64 | Train Loss: 0.1228092 Vali Loss: 0.1707642 Test Loss: 0.2258429
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 50 cost time: 0.9912893772125244
Epoch: 50, Steps: 64 | Train Loss: 0.1227133 Vali Loss: 0.1693729 Test Loss: 0.2251509
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 51 cost time: 1.0084152221679688
Epoch: 51, Steps: 64 | Train Loss: 0.1226600 Vali Loss: 0.1700653 Test Loss: 0.2258296
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 52 cost time: 1.0003585815429688
Epoch: 52, Steps: 64 | Train Loss: 0.1217716 Vali Loss: 0.1691289 Test Loss: 0.2263214
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 53 cost time: 0.9983770847320557
Epoch: 53, Steps: 64 | Train Loss: 0.1225940 Vali Loss: 0.1698820 Test Loss: 0.2259724
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 54 cost time: 1.0009722709655762
Epoch: 54, Steps: 64 | Train Loss: 0.1226748 Vali Loss: 0.1700254 Test Loss: 0.2253708
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 55 cost time: 0.9804060459136963
Epoch: 55, Steps: 64 | Train Loss: 0.1224974 Vali Loss: 0.1697070 Test Loss: 0.2248562
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 56 cost time: 0.9793479442596436
Epoch: 56, Steps: 64 | Train Loss: 0.1226053 Vali Loss: 0.1686603 Test Loss: 0.2262432
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 57 cost time: 0.970510721206665
Epoch: 57, Steps: 64 | Train Loss: 0.1222296 Vali Loss: 0.1715773 Test Loss: 0.2263410
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 58 cost time: 0.9633731842041016
Epoch: 58, Steps: 64 | Train Loss: 0.1229610 Vali Loss: 0.1699723 Test Loss: 0.2259038
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 59 cost time: 0.9800021648406982
Epoch: 59, Steps: 64 | Train Loss: 0.1223803 Vali Loss: 0.1701228 Test Loss: 0.2256788
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 60 cost time: 0.9879980087280273
Epoch: 60, Steps: 64 | Train Loss: 0.1224711 Vali Loss: 0.1685526 Test Loss: 0.2249645
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2256266176700592, mae:0.3319571912288666, rse:0.24072949588298798
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.036190032958984375 GB
Epoch: 1 cost time: 2.27898907661438
Epoch: 1, Steps: 64 | Train Loss: 1.1864943 Vali Loss: 2.8494096 Test Loss: 4.3185387
Validation loss decreased (inf --> 2.849410).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 2 cost time: 0.9277942180633545
Epoch: 2, Steps: 64 | Train Loss: 0.7160508 Vali Loss: 0.9542656 Test Loss: 1.3027242
Validation loss decreased (2.849410 --> 0.954266).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 3 cost time: 0.9305086135864258
Epoch: 3, Steps: 64 | Train Loss: 0.4135760 Vali Loss: 0.7011819 Test Loss: 0.9244910
Validation loss decreased (0.954266 --> 0.701182).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 4 cost time: 0.9414393901824951
Epoch: 4, Steps: 64 | Train Loss: 0.3242900 Vali Loss: 0.5440379 Test Loss: 0.6790264
Validation loss decreased (0.701182 --> 0.544038).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 5 cost time: 0.9224362373352051
Epoch: 5, Steps: 64 | Train Loss: 0.2689098 Vali Loss: 0.4392702 Test Loss: 0.5352995
Validation loss decreased (0.544038 --> 0.439270).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 6 cost time: 0.9093890190124512
Epoch: 6, Steps: 64 | Train Loss: 0.2358826 Vali Loss: 0.3713346 Test Loss: 0.4409869
Validation loss decreased (0.439270 --> 0.371335).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 7 cost time: 0.9073576927185059
Epoch: 7, Steps: 64 | Train Loss: 0.2150287 Vali Loss: 0.3198971 Test Loss: 0.3847229
Validation loss decreased (0.371335 --> 0.319897).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 8 cost time: 0.906998872756958
Epoch: 8, Steps: 64 | Train Loss: 0.2004548 Vali Loss: 0.2875485 Test Loss: 0.3433345
Validation loss decreased (0.319897 --> 0.287549).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 9 cost time: 0.8996403217315674
Epoch: 9, Steps: 64 | Train Loss: 0.1888291 Vali Loss: 0.2640372 Test Loss: 0.3094636
Validation loss decreased (0.287549 --> 0.264037).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 10 cost time: 0.9414105415344238
Epoch: 10, Steps: 64 | Train Loss: 0.1812149 Vali Loss: 0.2482400 Test Loss: 0.2969010
Validation loss decreased (0.264037 --> 0.248240).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 11 cost time: 0.9543676376342773
Epoch: 11, Steps: 64 | Train Loss: 0.1752995 Vali Loss: 0.2341993 Test Loss: 0.2788284
Validation loss decreased (0.248240 --> 0.234199).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 12 cost time: 0.9533481597900391
Epoch: 12, Steps: 64 | Train Loss: 0.1705328 Vali Loss: 0.2244816 Test Loss: 0.2692428
Validation loss decreased (0.234199 --> 0.224482).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 13 cost time: 0.9523317813873291
Epoch: 13, Steps: 64 | Train Loss: 0.1669867 Vali Loss: 0.2189879 Test Loss: 0.2612370
Validation loss decreased (0.224482 --> 0.218988).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 14 cost time: 0.9093737602233887
Epoch: 14, Steps: 64 | Train Loss: 0.1644257 Vali Loss: 0.2133860 Test Loss: 0.2580434
Validation loss decreased (0.218988 --> 0.213386).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 15 cost time: 0.9231839179992676
Epoch: 15, Steps: 64 | Train Loss: 0.1624868 Vali Loss: 0.2105367 Test Loss: 0.2520789
Validation loss decreased (0.213386 --> 0.210537).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 16 cost time: 0.928619384765625
Epoch: 16, Steps: 64 | Train Loss: 0.1602737 Vali Loss: 0.2048019 Test Loss: 0.2496015
Validation loss decreased (0.210537 --> 0.204802).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 17 cost time: 0.9242463111877441
Epoch: 17, Steps: 64 | Train Loss: 0.1582023 Vali Loss: 0.2014216 Test Loss: 0.2448942
Validation loss decreased (0.204802 --> 0.201422).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 18 cost time: 0.9401853084564209
Epoch: 18, Steps: 64 | Train Loss: 0.1565221 Vali Loss: 0.2014857 Test Loss: 0.2442416
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 19 cost time: 0.9548218250274658
Epoch: 19, Steps: 64 | Train Loss: 0.1566344 Vali Loss: 0.1989951 Test Loss: 0.2419796
Validation loss decreased (0.201422 --> 0.198995).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 20 cost time: 0.9533610343933105
Epoch: 20, Steps: 64 | Train Loss: 0.1545203 Vali Loss: 0.1949410 Test Loss: 0.2405175
Validation loss decreased (0.198995 --> 0.194941).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 21 cost time: 0.9384429454803467
Epoch: 21, Steps: 64 | Train Loss: 0.1541153 Vali Loss: 0.1964554 Test Loss: 0.2398633
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 22 cost time: 0.9234070777893066
Epoch: 22, Steps: 64 | Train Loss: 0.1531009 Vali Loss: 0.1956809 Test Loss: 0.2389968
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 23 cost time: 0.9067103862762451
Epoch: 23, Steps: 64 | Train Loss: 0.1524342 Vali Loss: 0.1931466 Test Loss: 0.2376469
Validation loss decreased (0.194941 --> 0.193147).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 24 cost time: 0.9200007915496826
Epoch: 24, Steps: 64 | Train Loss: 0.1511464 Vali Loss: 0.1917805 Test Loss: 0.2365824
Validation loss decreased (0.193147 --> 0.191781).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 25 cost time: 0.9126486778259277
Epoch: 25, Steps: 64 | Train Loss: 0.1510221 Vali Loss: 0.1931618 Test Loss: 0.2368544
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 26 cost time: 0.9133274555206299
Epoch: 26, Steps: 64 | Train Loss: 0.1509457 Vali Loss: 0.1905901 Test Loss: 0.2350561
Validation loss decreased (0.191781 --> 0.190590).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 27 cost time: 0.9255423545837402
Epoch: 27, Steps: 64 | Train Loss: 0.1495029 Vali Loss: 0.1920766 Test Loss: 0.2364631
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 28 cost time: 0.9390168190002441
Epoch: 28, Steps: 64 | Train Loss: 0.1498420 Vali Loss: 0.1906399 Test Loss: 0.2342047
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 29 cost time: 0.943366527557373
Epoch: 29, Steps: 64 | Train Loss: 0.1499779 Vali Loss: 0.1890098 Test Loss: 0.2345585
Validation loss decreased (0.190590 --> 0.189010).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 30 cost time: 0.9264647960662842
Epoch: 30, Steps: 64 | Train Loss: 0.1485030 Vali Loss: 0.1891106 Test Loss: 0.2341278
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 31 cost time: 0.9215164184570312
Epoch: 31, Steps: 64 | Train Loss: 0.1481246 Vali Loss: 0.1902395 Test Loss: 0.2333182
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 32 cost time: 0.9194035530090332
Epoch: 32, Steps: 64 | Train Loss: 0.1478439 Vali Loss: 0.1875499 Test Loss: 0.2340389
Validation loss decreased (0.189010 --> 0.187550).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 33 cost time: 0.9366426467895508
Epoch: 33, Steps: 64 | Train Loss: 0.1480215 Vali Loss: 0.1882844 Test Loss: 0.2340309
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 34 cost time: 0.9333162307739258
Epoch: 34, Steps: 64 | Train Loss: 0.1473153 Vali Loss: 0.1866903 Test Loss: 0.2329357
Validation loss decreased (0.187550 --> 0.186690).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 35 cost time: 0.9474048614501953
Epoch: 35, Steps: 64 | Train Loss: 0.1485973 Vali Loss: 0.1889797 Test Loss: 0.2329855
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 36 cost time: 0.9584150314331055
Epoch: 36, Steps: 64 | Train Loss: 0.1470070 Vali Loss: 0.1879956 Test Loss: 0.2328004
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 37 cost time: 0.95241379737854
Epoch: 37, Steps: 64 | Train Loss: 0.1477961 Vali Loss: 0.1884033 Test Loss: 0.2322676
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 38 cost time: 0.9573662281036377
Epoch: 38, Steps: 64 | Train Loss: 0.1477750 Vali Loss: 0.1868329 Test Loss: 0.2327993
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 39 cost time: 0.940716028213501
Epoch: 39, Steps: 64 | Train Loss: 0.1471878 Vali Loss: 0.1873948 Test Loss: 0.2325842
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 40 cost time: 0.9314887523651123
Epoch: 40, Steps: 64 | Train Loss: 0.1475684 Vali Loss: 0.1889566 Test Loss: 0.2323962
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 41 cost time: 0.931643009185791
Epoch: 41, Steps: 64 | Train Loss: 0.1466537 Vali Loss: 0.1870749 Test Loss: 0.2326961
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 42 cost time: 0.9083397388458252
Epoch: 42, Steps: 64 | Train Loss: 0.1465952 Vali Loss: 0.1879332 Test Loss: 0.2329602
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 43 cost time: 0.9084298610687256
Epoch: 43, Steps: 64 | Train Loss: 0.1464948 Vali Loss: 0.1868718 Test Loss: 0.2320089
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 44 cost time: 0.9313850402832031
Epoch: 44, Steps: 64 | Train Loss: 0.1463018 Vali Loss: 0.1862552 Test Loss: 0.2316957
Validation loss decreased (0.186690 --> 0.186255).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 45 cost time: 0.9314074516296387
Epoch: 45, Steps: 64 | Train Loss: 0.1460402 Vali Loss: 0.1868474 Test Loss: 0.2310113
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 46 cost time: 0.9207561016082764
Epoch: 46, Steps: 64 | Train Loss: 0.1459122 Vali Loss: 0.1859020 Test Loss: 0.2316078
Validation loss decreased (0.186255 --> 0.185902).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 47 cost time: 0.9257364273071289
Epoch: 47, Steps: 64 | Train Loss: 0.1462423 Vali Loss: 0.1850137 Test Loss: 0.2321132
Validation loss decreased (0.185902 --> 0.185014).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 48 cost time: 0.9140000343322754
Epoch: 48, Steps: 64 | Train Loss: 0.1457037 Vali Loss: 0.1873590 Test Loss: 0.2325457
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 49 cost time: 0.9036660194396973
Epoch: 49, Steps: 64 | Train Loss: 0.1464828 Vali Loss: 0.1878787 Test Loss: 0.2322421
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 50 cost time: 0.9124293327331543
Epoch: 50, Steps: 64 | Train Loss: 0.1464258 Vali Loss: 0.1855695 Test Loss: 0.2322915
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 51 cost time: 0.9153430461883545
Epoch: 51, Steps: 64 | Train Loss: 0.1458734 Vali Loss: 0.1857139 Test Loss: 0.2314848
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 52 cost time: 0.9101598262786865
Epoch: 52, Steps: 64 | Train Loss: 0.1454841 Vali Loss: 0.1868248 Test Loss: 0.2324407
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 53 cost time: 0.955054521560669
Epoch: 53, Steps: 64 | Train Loss: 0.1454734 Vali Loss: 0.1841965 Test Loss: 0.2308046
Validation loss decreased (0.185014 --> 0.184197).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 54 cost time: 0.9438083171844482
Epoch: 54, Steps: 64 | Train Loss: 0.1462845 Vali Loss: 0.1862985 Test Loss: 0.2320634
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 55 cost time: 0.9519994258880615
Epoch: 55, Steps: 64 | Train Loss: 0.1456262 Vali Loss: 0.1866389 Test Loss: 0.2317615
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 56 cost time: 0.9486305713653564
Epoch: 56, Steps: 64 | Train Loss: 0.1462456 Vali Loss: 0.1849429 Test Loss: 0.2322184
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 57 cost time: 0.9509944915771484
Epoch: 57, Steps: 64 | Train Loss: 0.1455194 Vali Loss: 0.1851399 Test Loss: 0.2311004
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 58 cost time: 0.9442665576934814
Epoch: 58, Steps: 64 | Train Loss: 0.1462732 Vali Loss: 0.1864722 Test Loss: 0.2325006
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 59 cost time: 0.9254083633422852
Epoch: 59, Steps: 64 | Train Loss: 0.1455038 Vali Loss: 0.1859954 Test Loss: 0.2311599
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 60 cost time: 0.9284212589263916
Epoch: 60, Steps: 64 | Train Loss: 0.1458636 Vali Loss: 0.1853298 Test Loss: 0.2311178
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23080462217330933, mae:0.34397488832473755, rse:0.24347612261772156
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.03689146041870117 GB
Epoch: 1 cost time: 2.2347869873046875
Epoch: 1, Steps: 64 | Train Loss: 0.9937045 Vali Loss: 2.6040390 Test Loss: 4.1262488
Validation loss decreased (inf --> 2.604039).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 2 cost time: 0.9011657238006592
Epoch: 2, Steps: 64 | Train Loss: 0.6785222 Vali Loss: 1.1181853 Test Loss: 1.6751887
Validation loss decreased (2.604039 --> 1.118185).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 3 cost time: 0.8972196578979492
Epoch: 3, Steps: 64 | Train Loss: 0.3772203 Vali Loss: 0.6035501 Test Loss: 0.8258901
Validation loss decreased (1.118185 --> 0.603550).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 4 cost time: 0.8936231136322021
Epoch: 4, Steps: 64 | Train Loss: 0.2362067 Vali Loss: 0.3651395 Test Loss: 0.4458463
Validation loss decreased (0.603550 --> 0.365140).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 5 cost time: 0.8944060802459717
Epoch: 5, Steps: 64 | Train Loss: 0.1800831 Vali Loss: 0.2730773 Test Loss: 0.3140869
Validation loss decreased (0.365140 --> 0.273077).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 6 cost time: 0.8683912754058838
Epoch: 6, Steps: 64 | Train Loss: 0.1604410 Vali Loss: 0.2328594 Test Loss: 0.2669895
Validation loss decreased (0.273077 --> 0.232859).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 7 cost time: 0.8764550685882568
Epoch: 7, Steps: 64 | Train Loss: 0.1533191 Vali Loss: 0.2191634 Test Loss: 0.2510877
Validation loss decreased (0.232859 --> 0.219163).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 8 cost time: 0.8757250308990479
Epoch: 8, Steps: 64 | Train Loss: 0.1471263 Vali Loss: 0.2089695 Test Loss: 0.2425177
Validation loss decreased (0.219163 --> 0.208970).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 9 cost time: 0.8849999904632568
Epoch: 9, Steps: 64 | Train Loss: 0.1438551 Vali Loss: 0.2009349 Test Loss: 0.2344309
Validation loss decreased (0.208970 --> 0.200935).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 10 cost time: 0.899630069732666
Epoch: 10, Steps: 64 | Train Loss: 0.1417881 Vali Loss: 0.1992659 Test Loss: 0.2342936
Validation loss decreased (0.200935 --> 0.199266).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 11 cost time: 0.9042129516601562
Epoch: 11, Steps: 64 | Train Loss: 0.1393405 Vali Loss: 0.1946875 Test Loss: 0.2321612
Validation loss decreased (0.199266 --> 0.194687).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 12 cost time: 0.9223949909210205
Epoch: 12, Steps: 64 | Train Loss: 0.1384524 Vali Loss: 0.1949776 Test Loss: 0.2312381
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 13 cost time: 0.9284334182739258
Epoch: 13, Steps: 64 | Train Loss: 0.1364109 Vali Loss: 0.1915439 Test Loss: 0.2285568
Validation loss decreased (0.194687 --> 0.191544).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 14 cost time: 0.9023551940917969
Epoch: 14, Steps: 64 | Train Loss: 0.1348489 Vali Loss: 0.1927695 Test Loss: 0.2288959
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 15 cost time: 0.8947257995605469
Epoch: 15, Steps: 64 | Train Loss: 0.1338499 Vali Loss: 0.1905787 Test Loss: 0.2271188
Validation loss decreased (0.191544 --> 0.190579).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 16 cost time: 0.906649112701416
Epoch: 16, Steps: 64 | Train Loss: 0.1326368 Vali Loss: 0.1881053 Test Loss: 0.2274347
Validation loss decreased (0.190579 --> 0.188105).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 17 cost time: 0.8905649185180664
Epoch: 17, Steps: 64 | Train Loss: 0.1326412 Vali Loss: 0.1874390 Test Loss: 0.2264511
Validation loss decreased (0.188105 --> 0.187439).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 18 cost time: 0.8981614112854004
Epoch: 18, Steps: 64 | Train Loss: 0.1314793 Vali Loss: 0.1859913 Test Loss: 0.2269960
Validation loss decreased (0.187439 --> 0.185991).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 19 cost time: 0.920403003692627
Epoch: 19, Steps: 64 | Train Loss: 0.1311534 Vali Loss: 0.1866487 Test Loss: 0.2258570
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 20 cost time: 0.9154186248779297
Epoch: 20, Steps: 64 | Train Loss: 0.1302433 Vali Loss: 0.1842396 Test Loss: 0.2262409
Validation loss decreased (0.185991 --> 0.184240).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 21 cost time: 0.9053716659545898
Epoch: 21, Steps: 64 | Train Loss: 0.1300641 Vali Loss: 0.1835185 Test Loss: 0.2266711
Validation loss decreased (0.184240 --> 0.183518).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 22 cost time: 0.8947584629058838
Epoch: 22, Steps: 64 | Train Loss: 0.1296718 Vali Loss: 0.1856638 Test Loss: 0.2258939
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 23 cost time: 0.8920004367828369
Epoch: 23, Steps: 64 | Train Loss: 0.1289754 Vali Loss: 0.1843467 Test Loss: 0.2255083
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 24 cost time: 0.9124140739440918
Epoch: 24, Steps: 64 | Train Loss: 0.1287048 Vali Loss: 0.1826113 Test Loss: 0.2258537
Validation loss decreased (0.183518 --> 0.182611).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 25 cost time: 0.9193744659423828
Epoch: 25, Steps: 64 | Train Loss: 0.1281065 Vali Loss: 0.1831714 Test Loss: 0.2256019
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 26 cost time: 0.9214234352111816
Epoch: 26, Steps: 64 | Train Loss: 0.1278658 Vali Loss: 0.1841860 Test Loss: 0.2252959
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 27 cost time: 0.9053723812103271
Epoch: 27, Steps: 64 | Train Loss: 0.1274867 Vali Loss: 0.1851950 Test Loss: 0.2254498
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 28 cost time: 0.8957419395446777
Epoch: 28, Steps: 64 | Train Loss: 0.1280227 Vali Loss: 0.1824656 Test Loss: 0.2250031
Validation loss decreased (0.182611 --> 0.182466).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 29 cost time: 0.8956236839294434
Epoch: 29, Steps: 64 | Train Loss: 0.1278313 Vali Loss: 0.1851758 Test Loss: 0.2266607
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 30 cost time: 0.9019994735717773
Epoch: 30, Steps: 64 | Train Loss: 0.1277369 Vali Loss: 0.1845599 Test Loss: 0.2256790
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 31 cost time: 0.8966357707977295
Epoch: 31, Steps: 64 | Train Loss: 0.1271150 Vali Loss: 0.1835473 Test Loss: 0.2261917
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 32 cost time: 0.8803939819335938
Epoch: 32, Steps: 64 | Train Loss: 0.1275015 Vali Loss: 0.1812207 Test Loss: 0.2253574
Validation loss decreased (0.182466 --> 0.181221).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 33 cost time: 0.8873779773712158
Epoch: 33, Steps: 64 | Train Loss: 0.1272120 Vali Loss: 0.1820081 Test Loss: 0.2250654
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 34 cost time: 0.8994505405426025
Epoch: 34, Steps: 64 | Train Loss: 0.1265516 Vali Loss: 0.1850231 Test Loss: 0.2253078
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 35 cost time: 0.8900034427642822
Epoch: 35, Steps: 64 | Train Loss: 0.1268490 Vali Loss: 0.1825206 Test Loss: 0.2258621
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 36 cost time: 0.9076440334320068
Epoch: 36, Steps: 64 | Train Loss: 0.1259325 Vali Loss: 0.1832087 Test Loss: 0.2248229
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 37 cost time: 0.924440860748291
Epoch: 37, Steps: 64 | Train Loss: 0.1269675 Vali Loss: 0.1800390 Test Loss: 0.2251484
Validation loss decreased (0.181221 --> 0.180039).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 38 cost time: 0.9183962345123291
Epoch: 38, Steps: 64 | Train Loss: 0.1269424 Vali Loss: 0.1830047 Test Loss: 0.2254401
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 39 cost time: 0.914360523223877
Epoch: 39, Steps: 64 | Train Loss: 0.1264486 Vali Loss: 0.1831520 Test Loss: 0.2243045
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 40 cost time: 0.9160127639770508
Epoch: 40, Steps: 64 | Train Loss: 0.1266901 Vali Loss: 0.1816677 Test Loss: 0.2251129
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 41 cost time: 0.9027388095855713
Epoch: 41, Steps: 64 | Train Loss: 0.1258646 Vali Loss: 0.1822313 Test Loss: 0.2255950
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 42 cost time: 0.9033620357513428
Epoch: 42, Steps: 64 | Train Loss: 0.1265744 Vali Loss: 0.1821009 Test Loss: 0.2249319
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 43 cost time: 0.8866472244262695
Epoch: 43, Steps: 64 | Train Loss: 0.1263002 Vali Loss: 0.1828386 Test Loss: 0.2250462
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 44 cost time: 0.8707010746002197
Epoch: 44, Steps: 64 | Train Loss: 0.1264458 Vali Loss: 0.1808983 Test Loss: 0.2257023
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 45 cost time: 0.894874095916748
Epoch: 45, Steps: 64 | Train Loss: 0.1261854 Vali Loss: 0.1842374 Test Loss: 0.2253500
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 46 cost time: 0.8904807567596436
Epoch: 46, Steps: 64 | Train Loss: 0.1264646 Vali Loss: 0.1824088 Test Loss: 0.2252449
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 47 cost time: 0.8884181976318359
Epoch: 47, Steps: 64 | Train Loss: 0.1263838 Vali Loss: 0.1815544 Test Loss: 0.2251554
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 48 cost time: 0.9049978256225586
Epoch: 48, Steps: 64 | Train Loss: 0.1261396 Vali Loss: 0.1817251 Test Loss: 0.2253194
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 49 cost time: 0.8826131820678711
Epoch: 49, Steps: 64 | Train Loss: 0.1261169 Vali Loss: 0.1818286 Test Loss: 0.2255419
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 50 cost time: 0.8844351768493652
Epoch: 50, Steps: 64 | Train Loss: 0.1259082 Vali Loss: 0.1818272 Test Loss: 0.2258575
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 51 cost time: 0.8770222663879395
Epoch: 51, Steps: 64 | Train Loss: 0.1261393 Vali Loss: 0.1839758 Test Loss: 0.2255487
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 52 cost time: 0.8753743171691895
Epoch: 52, Steps: 64 | Train Loss: 0.1258802 Vali Loss: 0.1826434 Test Loss: 0.2251808
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 53 cost time: 0.8777298927307129
Epoch: 53, Steps: 64 | Train Loss: 0.1264454 Vali Loss: 0.1816392 Test Loss: 0.2252735
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 54 cost time: 0.9020006656646729
Epoch: 54, Steps: 64 | Train Loss: 0.1256263 Vali Loss: 0.1816839 Test Loss: 0.2253773
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 55 cost time: 0.9220025539398193
Epoch: 55, Steps: 64 | Train Loss: 0.1261312 Vali Loss: 0.1817760 Test Loss: 0.2255888
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 56 cost time: 0.9184777736663818
Epoch: 56, Steps: 64 | Train Loss: 0.1265170 Vali Loss: 0.1817546 Test Loss: 0.2259027
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 57 cost time: 0.9224908351898193
Epoch: 57, Steps: 64 | Train Loss: 0.1257602 Vali Loss: 0.1824188 Test Loss: 0.2260329
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 58 cost time: 0.8973875045776367
Epoch: 58, Steps: 64 | Train Loss: 0.1254705 Vali Loss: 0.1806734 Test Loss: 0.2250303
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 59 cost time: 0.8963632583618164
Epoch: 59, Steps: 64 | Train Loss: 0.1259615 Vali Loss: 0.1804714 Test Loss: 0.2245129
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 60 cost time: 0.8929991722106934
Epoch: 60, Steps: 64 | Train Loss: 0.1259683 Vali Loss: 0.1823355 Test Loss: 0.2249710
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22514843940734863, mae:0.3389860987663269, rse:0.24047428369522095
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03745555877685547 GB
Epoch: 1 cost time: 2.3550291061401367
Epoch: 1, Steps: 64 | Train Loss: 0.9240978 Vali Loss: 2.5355673 Test Loss: 4.0087910
Validation loss decreased (inf --> 2.535567).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 2 cost time: 1.007612705230713
Epoch: 2, Steps: 64 | Train Loss: 0.7789882 Vali Loss: 1.6869309 Test Loss: 2.6031146
Validation loss decreased (2.535567 --> 1.686931).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 3 cost time: 0.9936294555664062
Epoch: 3, Steps: 64 | Train Loss: 0.5143175 Vali Loss: 0.9217935 Test Loss: 1.3326871
Validation loss decreased (1.686931 --> 0.921793).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 4 cost time: 0.9936246871948242
Epoch: 4, Steps: 64 | Train Loss: 0.2868979 Vali Loss: 0.4437196 Test Loss: 0.5547849
Validation loss decreased (0.921793 --> 0.443720).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 5 cost time: 0.9906394481658936
Epoch: 5, Steps: 64 | Train Loss: 0.1788647 Vali Loss: 0.2734120 Test Loss: 0.3179941
Validation loss decreased (0.443720 --> 0.273412).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 6 cost time: 0.9703993797302246
Epoch: 6, Steps: 64 | Train Loss: 0.1512499 Vali Loss: 0.2210098 Test Loss: 0.2614305
Validation loss decreased (0.273412 --> 0.221010).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 7 cost time: 0.965205192565918
Epoch: 7, Steps: 64 | Train Loss: 0.1418092 Vali Loss: 0.2039700 Test Loss: 0.2434880
Validation loss decreased (0.221010 --> 0.203970).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 8 cost time: 0.9773662090301514
Epoch: 8, Steps: 64 | Train Loss: 0.1371371 Vali Loss: 0.1970650 Test Loss: 0.2383951
Validation loss decreased (0.203970 --> 0.197065).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 9 cost time: 1.0014219284057617
Epoch: 9, Steps: 64 | Train Loss: 0.1336257 Vali Loss: 0.1948145 Test Loss: 0.2397029
Validation loss decreased (0.197065 --> 0.194814).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 10 cost time: 1.009376049041748
Epoch: 10, Steps: 64 | Train Loss: 0.1317204 Vali Loss: 0.1872579 Test Loss: 0.2308386
Validation loss decreased (0.194814 --> 0.187258).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 11 cost time: 1.0149359703063965
Epoch: 11, Steps: 64 | Train Loss: 0.1296249 Vali Loss: 0.1869749 Test Loss: 0.2333908
Validation loss decreased (0.187258 --> 0.186975).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 12 cost time: 1.0123755931854248
Epoch: 12, Steps: 64 | Train Loss: 0.1279220 Vali Loss: 0.1860264 Test Loss: 0.2336059
Validation loss decreased (0.186975 --> 0.186026).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 13 cost time: 1.01790189743042
Epoch: 13, Steps: 64 | Train Loss: 0.1271167 Vali Loss: 0.1833095 Test Loss: 0.2335202
Validation loss decreased (0.186026 --> 0.183309).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 14 cost time: 0.9884359836578369
Epoch: 14, Steps: 64 | Train Loss: 0.1258637 Vali Loss: 0.1829083 Test Loss: 0.2309232
Validation loss decreased (0.183309 --> 0.182908).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 15 cost time: 0.9938044548034668
Epoch: 15, Steps: 64 | Train Loss: 0.1249334 Vali Loss: 0.1816958 Test Loss: 0.2316824
Validation loss decreased (0.182908 --> 0.181696).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 16 cost time: 0.9890003204345703
Epoch: 16, Steps: 64 | Train Loss: 0.1246143 Vali Loss: 0.1820112 Test Loss: 0.2314681
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 17 cost time: 0.9929871559143066
Epoch: 17, Steps: 64 | Train Loss: 0.1240455 Vali Loss: 0.1810596 Test Loss: 0.2301221
Validation loss decreased (0.181696 --> 0.181060).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 18 cost time: 1.0166332721710205
Epoch: 18, Steps: 64 | Train Loss: 0.1233187 Vali Loss: 0.1794022 Test Loss: 0.2305789
Validation loss decreased (0.181060 --> 0.179402).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 19 cost time: 0.999445915222168
Epoch: 19, Steps: 64 | Train Loss: 0.1232009 Vali Loss: 0.1812210 Test Loss: 0.2303880
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 20 cost time: 0.9833641052246094
Epoch: 20, Steps: 64 | Train Loss: 0.1223681 Vali Loss: 0.1797382 Test Loss: 0.2305878
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 21 cost time: 0.9843595027923584
Epoch: 21, Steps: 64 | Train Loss: 0.1223445 Vali Loss: 0.1782823 Test Loss: 0.2306147
Validation loss decreased (0.179402 --> 0.178282).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 22 cost time: 0.9753532409667969
Epoch: 22, Steps: 64 | Train Loss: 0.1220559 Vali Loss: 0.1788360 Test Loss: 0.2305631
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 23 cost time: 0.9753754138946533
Epoch: 23, Steps: 64 | Train Loss: 0.1207547 Vali Loss: 0.1786344 Test Loss: 0.2304820
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 24 cost time: 0.974449872970581
Epoch: 24, Steps: 64 | Train Loss: 0.1216977 Vali Loss: 0.1788924 Test Loss: 0.2303419
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 25 cost time: 0.9883866310119629
Epoch: 25, Steps: 64 | Train Loss: 0.1210343 Vali Loss: 0.1766875 Test Loss: 0.2318475
Validation loss decreased (0.178282 --> 0.176688).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 26 cost time: 0.9827868938446045
Epoch: 26, Steps: 64 | Train Loss: 0.1214130 Vali Loss: 0.1800430 Test Loss: 0.2302540
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 27 cost time: 0.9777603149414062
Epoch: 27, Steps: 64 | Train Loss: 0.1207285 Vali Loss: 0.1792411 Test Loss: 0.2304723
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 28 cost time: 1.013120412826538
Epoch: 28, Steps: 64 | Train Loss: 0.1209827 Vali Loss: 0.1788234 Test Loss: 0.2306771
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 29 cost time: 1.0109996795654297
Epoch: 29, Steps: 64 | Train Loss: 0.1211327 Vali Loss: 0.1782524 Test Loss: 0.2306554
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 30 cost time: 0.9879446029663086
Epoch: 30, Steps: 64 | Train Loss: 0.1203780 Vali Loss: 0.1781194 Test Loss: 0.2314332
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 31 cost time: 0.9996433258056641
Epoch: 31, Steps: 64 | Train Loss: 0.1205872 Vali Loss: 0.1800748 Test Loss: 0.2316808
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 32 cost time: 0.9933645725250244
Epoch: 32, Steps: 64 | Train Loss: 0.1203774 Vali Loss: 0.1775464 Test Loss: 0.2303059
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 33 cost time: 0.9934165477752686
Epoch: 33, Steps: 64 | Train Loss: 0.1201910 Vali Loss: 0.1784587 Test Loss: 0.2308108
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 34 cost time: 1.0182592868804932
Epoch: 34, Steps: 64 | Train Loss: 0.1199448 Vali Loss: 0.1794270 Test Loss: 0.2308482
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 35 cost time: 1.0123493671417236
Epoch: 35, Steps: 64 | Train Loss: 0.1201283 Vali Loss: 0.1781926 Test Loss: 0.2309317
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 36 cost time: 1.0264105796813965
Epoch: 36, Steps: 64 | Train Loss: 0.1197371 Vali Loss: 0.1759714 Test Loss: 0.2311430
Validation loss decreased (0.176688 --> 0.175971).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 37 cost time: 1.0113868713378906
Epoch: 37, Steps: 64 | Train Loss: 0.1200895 Vali Loss: 0.1774818 Test Loss: 0.2315221
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 38 cost time: 0.9757187366485596
Epoch: 38, Steps: 64 | Train Loss: 0.1197489 Vali Loss: 0.1770160 Test Loss: 0.2311684
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 39 cost time: 0.958202600479126
Epoch: 39, Steps: 64 | Train Loss: 0.1198857 Vali Loss: 0.1774254 Test Loss: 0.2301152
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 40 cost time: 0.963965892791748
Epoch: 40, Steps: 64 | Train Loss: 0.1198755 Vali Loss: 0.1788267 Test Loss: 0.2308526
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 41 cost time: 0.9700005054473877
Epoch: 41, Steps: 64 | Train Loss: 0.1196284 Vali Loss: 0.1777532 Test Loss: 0.2312345
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 42 cost time: 0.987616777420044
Epoch: 42, Steps: 64 | Train Loss: 0.1200776 Vali Loss: 0.1771643 Test Loss: 0.2301276
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 43 cost time: 0.9966468811035156
Epoch: 43, Steps: 64 | Train Loss: 0.1196852 Vali Loss: 0.1776268 Test Loss: 0.2305435
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 44 cost time: 0.9933714866638184
Epoch: 44, Steps: 64 | Train Loss: 0.1202667 Vali Loss: 0.1779145 Test Loss: 0.2309492
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 45 cost time: 0.9865267276763916
Epoch: 45, Steps: 64 | Train Loss: 0.1204182 Vali Loss: 0.1754171 Test Loss: 0.2306141
Validation loss decreased (0.175971 --> 0.175417).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 46 cost time: 0.976388692855835
Epoch: 46, Steps: 64 | Train Loss: 0.1196585 Vali Loss: 0.1779601 Test Loss: 0.2310361
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 47 cost time: 0.9919404983520508
Epoch: 47, Steps: 64 | Train Loss: 0.1195034 Vali Loss: 0.1771923 Test Loss: 0.2309205
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 48 cost time: 0.9895284175872803
Epoch: 48, Steps: 64 | Train Loss: 0.1196116 Vali Loss: 0.1789190 Test Loss: 0.2319274
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 49 cost time: 1.0002529621124268
Epoch: 49, Steps: 64 | Train Loss: 0.1196246 Vali Loss: 0.1767519 Test Loss: 0.2309621
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 50 cost time: 1.0141246318817139
Epoch: 50, Steps: 64 | Train Loss: 0.1194547 Vali Loss: 0.1759223 Test Loss: 0.2310759
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 51 cost time: 1.0261781215667725
Epoch: 51, Steps: 64 | Train Loss: 0.1194031 Vali Loss: 0.1770550 Test Loss: 0.2308742
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 52 cost time: 1.0163891315460205
Epoch: 52, Steps: 64 | Train Loss: 0.1196008 Vali Loss: 0.1773079 Test Loss: 0.2309112
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 53 cost time: 1.0208165645599365
Epoch: 53, Steps: 64 | Train Loss: 0.1195107 Vali Loss: 0.1762055 Test Loss: 0.2308300
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 54 cost time: 1.0027122497558594
Epoch: 54, Steps: 64 | Train Loss: 0.1197845 Vali Loss: 0.1782874 Test Loss: 0.2309314
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 55 cost time: 0.9927332401275635
Epoch: 55, Steps: 64 | Train Loss: 0.1189822 Vali Loss: 0.1777765 Test Loss: 0.2309683
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 56 cost time: 0.9716744422912598
Epoch: 56, Steps: 64 | Train Loss: 0.1195132 Vali Loss: 0.1786872 Test Loss: 0.2320027
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 57 cost time: 0.9786334037780762
Epoch: 57, Steps: 64 | Train Loss: 0.1196457 Vali Loss: 0.1795292 Test Loss: 0.2318089
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 58 cost time: 0.9753677845001221
Epoch: 58, Steps: 64 | Train Loss: 0.1194966 Vali Loss: 0.1754594 Test Loss: 0.2300998
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 59 cost time: 1.015383243560791
Epoch: 59, Steps: 64 | Train Loss: 0.1192380 Vali Loss: 0.1779073 Test Loss: 0.2312117
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 60 cost time: 0.9984335899353027
Epoch: 60, Steps: 64 | Train Loss: 0.1194585 Vali Loss: 0.1762313 Test Loss: 0.2306324
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23061412572860718, mae:0.3464375436306, rse:0.24337564408779144
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03948259353637695 GB
Epoch: 1 cost time: 2.3147525787353516
Epoch: 1, Steps: 64 | Train Loss: 0.9904880 Vali Loss: 2.3513997 Test Loss: 3.6797619
Validation loss decreased (inf --> 2.351400).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 2 cost time: 0.9183158874511719
Epoch: 2, Steps: 64 | Train Loss: 0.8269636 Vali Loss: 1.5492474 Test Loss: 2.3952789
Validation loss decreased (2.351400 --> 1.549247).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 3 cost time: 0.9244308471679688
Epoch: 3, Steps: 64 | Train Loss: 0.5945291 Vali Loss: 1.0622965 Test Loss: 1.5894960
Validation loss decreased (1.549247 --> 1.062297).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 4 cost time: 0.9277582168579102
Epoch: 4, Steps: 64 | Train Loss: 0.4374521 Vali Loss: 0.7567956 Test Loss: 1.0741662
Validation loss decreased (1.062297 --> 0.756796).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 5 cost time: 0.9219987392425537
Epoch: 5, Steps: 64 | Train Loss: 0.3429232 Vali Loss: 0.5896165 Test Loss: 0.8032365
Validation loss decreased (0.756796 --> 0.589616).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 6 cost time: 0.8986325263977051
Epoch: 6, Steps: 64 | Train Loss: 0.2887017 Vali Loss: 0.4873788 Test Loss: 0.6397759
Validation loss decreased (0.589616 --> 0.487379).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 7 cost time: 0.916480541229248
Epoch: 7, Steps: 64 | Train Loss: 0.2535242 Vali Loss: 0.4182765 Test Loss: 0.5354052
Validation loss decreased (0.487379 --> 0.418277).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 8 cost time: 0.8994014263153076
Epoch: 8, Steps: 64 | Train Loss: 0.2304627 Vali Loss: 0.3636281 Test Loss: 0.4551452
Validation loss decreased (0.418277 --> 0.363628).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 9 cost time: 0.9009394645690918
Epoch: 9, Steps: 64 | Train Loss: 0.2133296 Vali Loss: 0.3320109 Test Loss: 0.4129130
Validation loss decreased (0.363628 --> 0.332011).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 10 cost time: 0.9253761768341064
Epoch: 10, Steps: 64 | Train Loss: 0.2031390 Vali Loss: 0.3077365 Test Loss: 0.3743427
Validation loss decreased (0.332011 --> 0.307736).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 11 cost time: 0.9527223110198975
Epoch: 11, Steps: 64 | Train Loss: 0.1953762 Vali Loss: 0.2863754 Test Loss: 0.3489319
Validation loss decreased (0.307736 --> 0.286375).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 12 cost time: 0.939000129699707
Epoch: 12, Steps: 64 | Train Loss: 0.1892463 Vali Loss: 0.2729095 Test Loss: 0.3317985
Validation loss decreased (0.286375 --> 0.272909).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 13 cost time: 0.9480009078979492
Epoch: 13, Steps: 64 | Train Loss: 0.1846353 Vali Loss: 0.2586630 Test Loss: 0.3158686
Validation loss decreased (0.272909 --> 0.258663).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 14 cost time: 0.9484443664550781
Epoch: 14, Steps: 64 | Train Loss: 0.1790567 Vali Loss: 0.2510983 Test Loss: 0.3058329
Validation loss decreased (0.258663 --> 0.251098).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 15 cost time: 0.9200005531311035
Epoch: 15, Steps: 64 | Train Loss: 0.1769738 Vali Loss: 0.2439494 Test Loss: 0.2950435
Validation loss decreased (0.251098 --> 0.243949).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 16 cost time: 0.9202225208282471
Epoch: 16, Steps: 64 | Train Loss: 0.1747209 Vali Loss: 0.2382377 Test Loss: 0.2881584
Validation loss decreased (0.243949 --> 0.238238).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 17 cost time: 0.9223964214324951
Epoch: 17, Steps: 64 | Train Loss: 0.1720546 Vali Loss: 0.2332431 Test Loss: 0.2838472
Validation loss decreased (0.238238 --> 0.233243).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 18 cost time: 0.926734447479248
Epoch: 18, Steps: 64 | Train Loss: 0.1694494 Vali Loss: 0.2295851 Test Loss: 0.2807535
Validation loss decreased (0.233243 --> 0.229585).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 19 cost time: 0.9500007629394531
Epoch: 19, Steps: 64 | Train Loss: 0.1698680 Vali Loss: 0.2289826 Test Loss: 0.2766991
Validation loss decreased (0.229585 --> 0.228983).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 20 cost time: 0.9406332969665527
Epoch: 20, Steps: 64 | Train Loss: 0.1677628 Vali Loss: 0.2251867 Test Loss: 0.2747020
Validation loss decreased (0.228983 --> 0.225187).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 21 cost time: 0.9483282566070557
Epoch: 21, Steps: 64 | Train Loss: 0.1674671 Vali Loss: 0.2222759 Test Loss: 0.2738633
Validation loss decreased (0.225187 --> 0.222276).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 22 cost time: 0.9104082584381104
Epoch: 22, Steps: 64 | Train Loss: 0.1658597 Vali Loss: 0.2213940 Test Loss: 0.2704055
Validation loss decreased (0.222276 --> 0.221394).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 23 cost time: 0.9444007873535156
Epoch: 23, Steps: 64 | Train Loss: 0.1649880 Vali Loss: 0.2211006 Test Loss: 0.2699432
Validation loss decreased (0.221394 --> 0.221101).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 24 cost time: 0.9316458702087402
Epoch: 24, Steps: 64 | Train Loss: 0.1641981 Vali Loss: 0.2182584 Test Loss: 0.2660414
Validation loss decreased (0.221101 --> 0.218258).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 25 cost time: 0.8933639526367188
Epoch: 25, Steps: 64 | Train Loss: 0.1622859 Vali Loss: 0.2176446 Test Loss: 0.2676101
Validation loss decreased (0.218258 --> 0.217645).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 26 cost time: 0.897411584854126
Epoch: 26, Steps: 64 | Train Loss: 0.1622278 Vali Loss: 0.2154450 Test Loss: 0.2650901
Validation loss decreased (0.217645 --> 0.215445).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 27 cost time: 0.9070000648498535
Epoch: 27, Steps: 64 | Train Loss: 0.1615257 Vali Loss: 0.2173066 Test Loss: 0.2661199
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 28 cost time: 0.9226419925689697
Epoch: 28, Steps: 64 | Train Loss: 0.1613415 Vali Loss: 0.2139591 Test Loss: 0.2628309
Validation loss decreased (0.215445 --> 0.213959).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 29 cost time: 0.9143915176391602
Epoch: 29, Steps: 64 | Train Loss: 0.1599962 Vali Loss: 0.2166080 Test Loss: 0.2647480
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 30 cost time: 0.9353501796722412
Epoch: 30, Steps: 64 | Train Loss: 0.1610953 Vali Loss: 0.2123806 Test Loss: 0.2621582
Validation loss decreased (0.213959 --> 0.212381).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 31 cost time: 0.945002555847168
Epoch: 31, Steps: 64 | Train Loss: 0.1599808 Vali Loss: 0.2141243 Test Loss: 0.2626416
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 32 cost time: 0.9268546104431152
Epoch: 32, Steps: 64 | Train Loss: 0.1602194 Vali Loss: 0.2122244 Test Loss: 0.2601615
Validation loss decreased (0.212381 --> 0.212224).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 33 cost time: 0.9257345199584961
Epoch: 33, Steps: 64 | Train Loss: 0.1589256 Vali Loss: 0.2124010 Test Loss: 0.2628446
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 34 cost time: 0.9230008125305176
Epoch: 34, Steps: 64 | Train Loss: 0.1595982 Vali Loss: 0.2124337 Test Loss: 0.2634941
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 35 cost time: 0.9266107082366943
Epoch: 35, Steps: 64 | Train Loss: 0.1585194 Vali Loss: 0.2122129 Test Loss: 0.2614468
Validation loss decreased (0.212224 --> 0.212213).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 36 cost time: 0.9223544597625732
Epoch: 36, Steps: 64 | Train Loss: 0.1585095 Vali Loss: 0.2114243 Test Loss: 0.2614405
Validation loss decreased (0.212213 --> 0.211424).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 37 cost time: 0.9384262561798096
Epoch: 37, Steps: 64 | Train Loss: 0.1580006 Vali Loss: 0.2108458 Test Loss: 0.2616227
Validation loss decreased (0.211424 --> 0.210846).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 38 cost time: 0.9393534660339355
Epoch: 38, Steps: 64 | Train Loss: 0.1583880 Vali Loss: 0.2112623 Test Loss: 0.2598481
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 39 cost time: 0.9329898357391357
Epoch: 39, Steps: 64 | Train Loss: 0.1579279 Vali Loss: 0.2098385 Test Loss: 0.2604533
Validation loss decreased (0.210846 --> 0.209839).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 40 cost time: 0.9157590866088867
Epoch: 40, Steps: 64 | Train Loss: 0.1581869 Vali Loss: 0.2090740 Test Loss: 0.2584412
Validation loss decreased (0.209839 --> 0.209074).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 41 cost time: 0.9040002822875977
Epoch: 41, Steps: 64 | Train Loss: 0.1580609 Vali Loss: 0.2114327 Test Loss: 0.2596438
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 42 cost time: 0.9006125926971436
Epoch: 42, Steps: 64 | Train Loss: 0.1574789 Vali Loss: 0.2085612 Test Loss: 0.2575730
Validation loss decreased (0.209074 --> 0.208561).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 43 cost time: 0.9032368659973145
Epoch: 43, Steps: 64 | Train Loss: 0.1579117 Vali Loss: 0.2099592 Test Loss: 0.2590619
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 44 cost time: 0.9023823738098145
Epoch: 44, Steps: 64 | Train Loss: 0.1570576 Vali Loss: 0.2084626 Test Loss: 0.2610494
Validation loss decreased (0.208561 --> 0.208463).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 45 cost time: 0.9014310836791992
Epoch: 45, Steps: 64 | Train Loss: 0.1571280 Vali Loss: 0.2102381 Test Loss: 0.2600759
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 46 cost time: 0.9207346439361572
Epoch: 46, Steps: 64 | Train Loss: 0.1578613 Vali Loss: 0.2085789 Test Loss: 0.2589508
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 47 cost time: 0.9189989566802979
Epoch: 47, Steps: 64 | Train Loss: 0.1563575 Vali Loss: 0.2091231 Test Loss: 0.2588910
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 48 cost time: 0.9192724227905273
Epoch: 48, Steps: 64 | Train Loss: 0.1577462 Vali Loss: 0.2106406 Test Loss: 0.2587847
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 49 cost time: 0.9507496356964111
Epoch: 49, Steps: 64 | Train Loss: 0.1573420 Vali Loss: 0.2075206 Test Loss: 0.2583711
Validation loss decreased (0.208463 --> 0.207521).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 50 cost time: 0.9213476181030273
Epoch: 50, Steps: 64 | Train Loss: 0.1575234 Vali Loss: 0.2097444 Test Loss: 0.2595137
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 51 cost time: 0.9163680076599121
Epoch: 51, Steps: 64 | Train Loss: 0.1565857 Vali Loss: 0.2102516 Test Loss: 0.2588676
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 52 cost time: 0.9233548641204834
Epoch: 52, Steps: 64 | Train Loss: 0.1566344 Vali Loss: 0.2106156 Test Loss: 0.2609289
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 53 cost time: 0.9364011287689209
Epoch: 53, Steps: 64 | Train Loss: 0.1573120 Vali Loss: 0.2091405 Test Loss: 0.2572927
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 54 cost time: 0.9329996109008789
Epoch: 54, Steps: 64 | Train Loss: 0.1568004 Vali Loss: 0.2076104 Test Loss: 0.2573811
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 55 cost time: 0.9416356086730957
Epoch: 55, Steps: 64 | Train Loss: 0.1578149 Vali Loss: 0.2084037 Test Loss: 0.2586388
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 56 cost time: 0.9497933387756348
Epoch: 56, Steps: 64 | Train Loss: 0.1564612 Vali Loss: 0.2090277 Test Loss: 0.2578081
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 57 cost time: 0.9433822631835938
Epoch: 57, Steps: 64 | Train Loss: 0.1572606 Vali Loss: 0.2076729 Test Loss: 0.2579468
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 58 cost time: 0.941988468170166
Epoch: 58, Steps: 64 | Train Loss: 0.1568915 Vali Loss: 0.2056855 Test Loss: 0.2575389
Validation loss decreased (0.207521 --> 0.205685).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 59 cost time: 0.9033238887786865
Epoch: 59, Steps: 64 | Train Loss: 0.1565438 Vali Loss: 0.2088918 Test Loss: 0.2577099
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 60 cost time: 0.8971953392028809
Epoch: 60, Steps: 64 | Train Loss: 0.1569033 Vali Loss: 0.2072197 Test Loss: 0.2597427
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2575388252735138, mae:0.37932339310646057, rse:0.2571908235549927
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.04018402099609375 GB
Epoch: 1 cost time: 2.3196256160736084
Epoch: 1, Steps: 64 | Train Loss: 0.8737631 Vali Loss: 2.2641170 Test Loss: 3.6368892
Validation loss decreased (inf --> 2.264117).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 2 cost time: 0.9428143501281738
Epoch: 2, Steps: 64 | Train Loss: 0.7047754 Vali Loss: 1.3819680 Test Loss: 2.1531825
Validation loss decreased (2.264117 --> 1.381968).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 3 cost time: 0.9496352672576904
Epoch: 3, Steps: 64 | Train Loss: 0.4497555 Vali Loss: 0.8016567 Test Loss: 1.1958073
Validation loss decreased (1.381968 --> 0.801657).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 4 cost time: 0.9413402080535889
Epoch: 4, Steps: 64 | Train Loss: 0.2938097 Vali Loss: 0.4808167 Test Loss: 0.6650283
Validation loss decreased (0.801657 --> 0.480817).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 5 cost time: 0.9392557144165039
Epoch: 5, Steps: 64 | Train Loss: 0.2138627 Vali Loss: 0.3299195 Test Loss: 0.4303323
Validation loss decreased (0.480817 --> 0.329919).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 6 cost time: 0.919356107711792
Epoch: 6, Steps: 64 | Train Loss: 0.1766963 Vali Loss: 0.2633443 Test Loss: 0.3296350
Validation loss decreased (0.329919 --> 0.263344).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 7 cost time: 0.9302277565002441
Epoch: 7, Steps: 64 | Train Loss: 0.1608835 Vali Loss: 0.2347605 Test Loss: 0.2923993
Validation loss decreased (0.263344 --> 0.234761).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 8 cost time: 0.9329593181610107
Epoch: 8, Steps: 64 | Train Loss: 0.1530816 Vali Loss: 0.2198209 Test Loss: 0.2740753
Validation loss decreased (0.234761 --> 0.219821).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 9 cost time: 0.927746057510376
Epoch: 9, Steps: 64 | Train Loss: 0.1485918 Vali Loss: 0.2108269 Test Loss: 0.2633714
Validation loss decreased (0.219821 --> 0.210827).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 10 cost time: 0.9609813690185547
Epoch: 10, Steps: 64 | Train Loss: 0.1446244 Vali Loss: 0.2046911 Test Loss: 0.2569078
Validation loss decreased (0.210827 --> 0.204691).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 11 cost time: 0.9656422138214111
Epoch: 11, Steps: 64 | Train Loss: 0.1425210 Vali Loss: 0.2048986 Test Loss: 0.2531102
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 12 cost time: 0.9653728008270264
Epoch: 12, Steps: 64 | Train Loss: 0.1399757 Vali Loss: 0.2010619 Test Loss: 0.2513747
Validation loss decreased (0.204691 --> 0.201062).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 13 cost time: 0.9723706245422363
Epoch: 13, Steps: 64 | Train Loss: 0.1382222 Vali Loss: 0.1969133 Test Loss: 0.2470855
Validation loss decreased (0.201062 --> 0.196913).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 14 cost time: 0.9574072360992432
Epoch: 14, Steps: 64 | Train Loss: 0.1370506 Vali Loss: 0.1961345 Test Loss: 0.2459621
Validation loss decreased (0.196913 --> 0.196134).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 15 cost time: 0.9433503150939941
Epoch: 15, Steps: 64 | Train Loss: 0.1362310 Vali Loss: 0.1966230 Test Loss: 0.2450796
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 16 cost time: 0.9441094398498535
Epoch: 16, Steps: 64 | Train Loss: 0.1344312 Vali Loss: 0.1942644 Test Loss: 0.2441218
Validation loss decreased (0.196134 --> 0.194264).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 17 cost time: 0.951784610748291
Epoch: 17, Steps: 64 | Train Loss: 0.1338060 Vali Loss: 0.1925839 Test Loss: 0.2432715
Validation loss decreased (0.194264 --> 0.192584).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 18 cost time: 0.9524908065795898
Epoch: 18, Steps: 64 | Train Loss: 0.1328315 Vali Loss: 0.1947281 Test Loss: 0.2434856
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 19 cost time: 0.9629993438720703
Epoch: 19, Steps: 64 | Train Loss: 0.1329347 Vali Loss: 0.1926868 Test Loss: 0.2414143
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 20 cost time: 0.9486687183380127
Epoch: 20, Steps: 64 | Train Loss: 0.1317518 Vali Loss: 0.1927744 Test Loss: 0.2416765
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 21 cost time: 0.9393737316131592
Epoch: 21, Steps: 64 | Train Loss: 0.1315260 Vali Loss: 0.1919618 Test Loss: 0.2418985
Validation loss decreased (0.192584 --> 0.191962).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 22 cost time: 0.9471390247344971
Epoch: 22, Steps: 64 | Train Loss: 0.1307490 Vali Loss: 0.1910839 Test Loss: 0.2411216
Validation loss decreased (0.191962 --> 0.191084).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 23 cost time: 0.9313585758209229
Epoch: 23, Steps: 64 | Train Loss: 0.1305052 Vali Loss: 0.1927893 Test Loss: 0.2409623
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 24 cost time: 0.9294257164001465
Epoch: 24, Steps: 64 | Train Loss: 0.1301087 Vali Loss: 0.1911679 Test Loss: 0.2415694
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 25 cost time: 0.924720048904419
Epoch: 25, Steps: 64 | Train Loss: 0.1294692 Vali Loss: 0.1923903 Test Loss: 0.2420620
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 26 cost time: 0.9291951656341553
Epoch: 26, Steps: 64 | Train Loss: 0.1293132 Vali Loss: 0.1913666 Test Loss: 0.2408486
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 27 cost time: 0.9486367702484131
Epoch: 27, Steps: 64 | Train Loss: 0.1297644 Vali Loss: 0.1903698 Test Loss: 0.2394032
Validation loss decreased (0.191084 --> 0.190370).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 28 cost time: 0.9414184093475342
Epoch: 28, Steps: 64 | Train Loss: 0.1287392 Vali Loss: 0.1897502 Test Loss: 0.2400479
Validation loss decreased (0.190370 --> 0.189750).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 29 cost time: 0.9493944644927979
Epoch: 29, Steps: 64 | Train Loss: 0.1285876 Vali Loss: 0.1892474 Test Loss: 0.2403873
Validation loss decreased (0.189750 --> 0.189247).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 30 cost time: 0.9723906517028809
Epoch: 30, Steps: 64 | Train Loss: 0.1288402 Vali Loss: 0.1895607 Test Loss: 0.2410169
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 31 cost time: 0.949805498123169
Epoch: 31, Steps: 64 | Train Loss: 0.1278735 Vali Loss: 0.1882288 Test Loss: 0.2405440
Validation loss decreased (0.189247 --> 0.188229).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 32 cost time: 0.9453470706939697
Epoch: 32, Steps: 64 | Train Loss: 0.1281837 Vali Loss: 0.1869920 Test Loss: 0.2388876
Validation loss decreased (0.188229 --> 0.186992).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 33 cost time: 0.9478223323822021
Epoch: 33, Steps: 64 | Train Loss: 0.1286351 Vali Loss: 0.1883845 Test Loss: 0.2400012
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 34 cost time: 0.9513990879058838
Epoch: 34, Steps: 64 | Train Loss: 0.1281737 Vali Loss: 0.1894653 Test Loss: 0.2399062
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 35 cost time: 0.9500465393066406
Epoch: 35, Steps: 64 | Train Loss: 0.1276167 Vali Loss: 0.1884623 Test Loss: 0.2404686
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 36 cost time: 0.958641529083252
Epoch: 36, Steps: 64 | Train Loss: 0.1269631 Vali Loss: 0.1888644 Test Loss: 0.2396255
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 37 cost time: 0.9724140167236328
Epoch: 37, Steps: 64 | Train Loss: 0.1271043 Vali Loss: 0.1874544 Test Loss: 0.2388743
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 38 cost time: 0.9694151878356934
Epoch: 38, Steps: 64 | Train Loss: 0.1276947 Vali Loss: 0.1883313 Test Loss: 0.2391627
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 39 cost time: 0.9604315757751465
Epoch: 39, Steps: 64 | Train Loss: 0.1267322 Vali Loss: 0.1875322 Test Loss: 0.2390972
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 40 cost time: 0.9233455657958984
Epoch: 40, Steps: 64 | Train Loss: 0.1271539 Vali Loss: 0.1899647 Test Loss: 0.2400581
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 41 cost time: 1.007690668106079
Epoch: 41, Steps: 64 | Train Loss: 0.1273042 Vali Loss: 0.1884808 Test Loss: 0.2394599
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 42 cost time: 1.0080304145812988
Epoch: 42, Steps: 64 | Train Loss: 0.1276277 Vali Loss: 0.1890388 Test Loss: 0.2399036
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 43 cost time: 1.0024096965789795
Epoch: 43, Steps: 64 | Train Loss: 0.1275565 Vali Loss: 0.1882816 Test Loss: 0.2393753
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 44 cost time: 1.0069999694824219
Epoch: 44, Steps: 64 | Train Loss: 0.1274271 Vali Loss: 0.1890788 Test Loss: 0.2407026
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 45 cost time: 0.9446358680725098
Epoch: 45, Steps: 64 | Train Loss: 0.1272060 Vali Loss: 0.1884546 Test Loss: 0.2400241
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 46 cost time: 0.9326350688934326
Epoch: 46, Steps: 64 | Train Loss: 0.1268523 Vali Loss: 0.1885159 Test Loss: 0.2401812
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 47 cost time: 0.9488601684570312
Epoch: 47, Steps: 64 | Train Loss: 0.1268387 Vali Loss: 0.1890283 Test Loss: 0.2406925
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 48 cost time: 0.9554176330566406
Epoch: 48, Steps: 64 | Train Loss: 0.1270808 Vali Loss: 0.1876995 Test Loss: 0.2397818
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 49 cost time: 0.9523599147796631
Epoch: 49, Steps: 64 | Train Loss: 0.1263594 Vali Loss: 0.1876485 Test Loss: 0.2391636
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 50 cost time: 0.9554588794708252
Epoch: 50, Steps: 64 | Train Loss: 0.1266112 Vali Loss: 0.1871044 Test Loss: 0.2405959
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 51 cost time: 0.9537324905395508
Epoch: 51, Steps: 64 | Train Loss: 0.1265067 Vali Loss: 0.1874004 Test Loss: 0.2385720
EarlyStopping counter: 19 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 52 cost time: 0.9424185752868652
Epoch: 52, Steps: 64 | Train Loss: 0.1264138 Vali Loss: 0.1887855 Test Loss: 0.2400749
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 53 cost time: 0.9600000381469727
Epoch: 53, Steps: 64 | Train Loss: 0.1267537 Vali Loss: 0.1858882 Test Loss: 0.2391304
Validation loss decreased (0.186992 --> 0.185888).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 54 cost time: 0.965651273727417
Epoch: 54, Steps: 64 | Train Loss: 0.1270517 Vali Loss: 0.1898162 Test Loss: 0.2397877
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 55 cost time: 0.9624531269073486
Epoch: 55, Steps: 64 | Train Loss: 0.1270612 Vali Loss: 0.1884891 Test Loss: 0.2395135
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 56 cost time: 0.9672682285308838
Epoch: 56, Steps: 64 | Train Loss: 0.1265486 Vali Loss: 0.1874241 Test Loss: 0.2395003
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 57 cost time: 0.9733841419219971
Epoch: 57, Steps: 64 | Train Loss: 0.1266578 Vali Loss: 0.1876051 Test Loss: 0.2395387
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 58 cost time: 0.9163837432861328
Epoch: 58, Steps: 64 | Train Loss: 0.1269642 Vali Loss: 0.1867325 Test Loss: 0.2396115
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 59 cost time: 0.9147262573242188
Epoch: 59, Steps: 64 | Train Loss: 0.1267947 Vali Loss: 0.1886765 Test Loss: 0.2393818
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 60 cost time: 0.9124975204467773
Epoch: 60, Steps: 64 | Train Loss: 0.1271119 Vali Loss: 0.1876143 Test Loss: 0.2405510
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23913037776947021, mae:0.35663843154907227, rse:0.2478286623954773
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04074811935424805 GB
Epoch: 1 cost time: 2.265138864517212
Epoch: 1, Steps: 64 | Train Loss: 0.8606094 Vali Loss: 2.2862630 Test Loss: 3.6394238
Validation loss decreased (inf --> 2.286263).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 2 cost time: 0.884951114654541
Epoch: 2, Steps: 64 | Train Loss: 0.7137107 Vali Loss: 1.4685026 Test Loss: 2.2719748
Validation loss decreased (2.286263 --> 1.468503).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 3 cost time: 0.8844137191772461
Epoch: 3, Steps: 64 | Train Loss: 0.4590499 Vali Loss: 0.7923345 Test Loss: 1.1466581
Validation loss decreased (1.468503 --> 0.792334).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 4 cost time: 0.8954408168792725
Epoch: 4, Steps: 64 | Train Loss: 0.2735518 Vali Loss: 0.3967203 Test Loss: 0.5006544
Validation loss decreased (0.792334 --> 0.396720).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 5 cost time: 0.8920736312866211
Epoch: 5, Steps: 64 | Train Loss: 0.1889693 Vali Loss: 0.2702900 Test Loss: 0.3192804
Validation loss decreased (0.396720 --> 0.270290).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 6 cost time: 0.8619987964630127
Epoch: 6, Steps: 64 | Train Loss: 0.1655714 Vali Loss: 0.2342230 Test Loss: 0.2736671
Validation loss decreased (0.270290 --> 0.234223).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 7 cost time: 0.8639993667602539
Epoch: 7, Steps: 64 | Train Loss: 0.1554626 Vali Loss: 0.2141557 Test Loss: 0.2577505
Validation loss decreased (0.234223 --> 0.214156).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 8 cost time: 0.8694827556610107
Epoch: 8, Steps: 64 | Train Loss: 0.1507278 Vali Loss: 0.2082751 Test Loss: 0.2491833
Validation loss decreased (0.214156 --> 0.208275).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 9 cost time: 0.8634002208709717
Epoch: 9, Steps: 64 | Train Loss: 0.1466316 Vali Loss: 0.2005817 Test Loss: 0.2425949
Validation loss decreased (0.208275 --> 0.200582).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 10 cost time: 0.8850307464599609
Epoch: 10, Steps: 64 | Train Loss: 0.1433074 Vali Loss: 0.1946835 Test Loss: 0.2392746
Validation loss decreased (0.200582 --> 0.194683).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 11 cost time: 0.9008040428161621
Epoch: 11, Steps: 64 | Train Loss: 0.1406303 Vali Loss: 0.1936059 Test Loss: 0.2361728
Validation loss decreased (0.194683 --> 0.193606).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 12 cost time: 0.9190008640289307
Epoch: 12, Steps: 64 | Train Loss: 0.1381823 Vali Loss: 0.1927945 Test Loss: 0.2355208
Validation loss decreased (0.193606 --> 0.192794).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 13 cost time: 0.9156191349029541
Epoch: 13, Steps: 64 | Train Loss: 0.1365837 Vali Loss: 0.1897279 Test Loss: 0.2332875
Validation loss decreased (0.192794 --> 0.189728).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 14 cost time: 0.9151883125305176
Epoch: 14, Steps: 64 | Train Loss: 0.1355587 Vali Loss: 0.1891909 Test Loss: 0.2336600
Validation loss decreased (0.189728 --> 0.189191).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 15 cost time: 0.8993749618530273
Epoch: 15, Steps: 64 | Train Loss: 0.1341355 Vali Loss: 0.1851013 Test Loss: 0.2323020
Validation loss decreased (0.189191 --> 0.185101).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 16 cost time: 0.895352840423584
Epoch: 16, Steps: 64 | Train Loss: 0.1328780 Vali Loss: 0.1859023 Test Loss: 0.2321235
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 17 cost time: 0.8937995433807373
Epoch: 17, Steps: 64 | Train Loss: 0.1320585 Vali Loss: 0.1872609 Test Loss: 0.2318099
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 18 cost time: 0.8890001773834229
Epoch: 18, Steps: 64 | Train Loss: 0.1315656 Vali Loss: 0.1867284 Test Loss: 0.2322626
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 19 cost time: 0.9136579036712646
Epoch: 19, Steps: 64 | Train Loss: 0.1311138 Vali Loss: 0.1857296 Test Loss: 0.2319518
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 20 cost time: 0.9116461277008057
Epoch: 20, Steps: 64 | Train Loss: 0.1297796 Vali Loss: 0.1831024 Test Loss: 0.2319186
Validation loss decreased (0.185101 --> 0.183102).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 21 cost time: 0.9144256114959717
Epoch: 21, Steps: 64 | Train Loss: 0.1301654 Vali Loss: 0.1853940 Test Loss: 0.2312911
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 22 cost time: 0.8973569869995117
Epoch: 22, Steps: 64 | Train Loss: 0.1288758 Vali Loss: 0.1855364 Test Loss: 0.2315251
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 23 cost time: 0.8857665061950684
Epoch: 23, Steps: 64 | Train Loss: 0.1283791 Vali Loss: 0.1835769 Test Loss: 0.2316026
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 24 cost time: 0.8634617328643799
Epoch: 24, Steps: 64 | Train Loss: 0.1286471 Vali Loss: 0.1839953 Test Loss: 0.2316550
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 25 cost time: 0.8646328449249268
Epoch: 25, Steps: 64 | Train Loss: 0.1279686 Vali Loss: 0.1841238 Test Loss: 0.2314572
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 26 cost time: 0.8734419345855713
Epoch: 26, Steps: 64 | Train Loss: 0.1280562 Vali Loss: 0.1847340 Test Loss: 0.2316384
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 27 cost time: 0.8603842258453369
Epoch: 27, Steps: 64 | Train Loss: 0.1272857 Vali Loss: 0.1818473 Test Loss: 0.2314512
Validation loss decreased (0.183102 --> 0.181847).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 28 cost time: 0.8748767375946045
Epoch: 28, Steps: 64 | Train Loss: 0.1278741 Vali Loss: 0.1822200 Test Loss: 0.2315209
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 29 cost time: 0.9010002613067627
Epoch: 29, Steps: 64 | Train Loss: 0.1262870 Vali Loss: 0.1832052 Test Loss: 0.2321762
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 30 cost time: 0.8609998226165771
Epoch: 30, Steps: 64 | Train Loss: 0.1266874 Vali Loss: 0.1811069 Test Loss: 0.2316956
Validation loss decreased (0.181847 --> 0.181107).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 31 cost time: 0.8819024562835693
Epoch: 31, Steps: 64 | Train Loss: 0.1262693 Vali Loss: 0.1819820 Test Loss: 0.2316747
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 32 cost time: 0.9024343490600586
Epoch: 32, Steps: 64 | Train Loss: 0.1266811 Vali Loss: 0.1829640 Test Loss: 0.2311558
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 33 cost time: 0.9180827140808105
Epoch: 33, Steps: 64 | Train Loss: 0.1264981 Vali Loss: 0.1821097 Test Loss: 0.2319939
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 34 cost time: 0.9087543487548828
Epoch: 34, Steps: 64 | Train Loss: 0.1268057 Vali Loss: 0.1821665 Test Loss: 0.2320214
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 35 cost time: 0.8979997634887695
Epoch: 35, Steps: 64 | Train Loss: 0.1258257 Vali Loss: 0.1842138 Test Loss: 0.2324275
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 36 cost time: 0.8900351524353027
Epoch: 36, Steps: 64 | Train Loss: 0.1260159 Vali Loss: 0.1820603 Test Loss: 0.2314886
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 37 cost time: 0.9081568717956543
Epoch: 37, Steps: 64 | Train Loss: 0.1259039 Vali Loss: 0.1819879 Test Loss: 0.2315842
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 38 cost time: 0.9143803119659424
Epoch: 38, Steps: 64 | Train Loss: 0.1260811 Vali Loss: 0.1806878 Test Loss: 0.2320780
Validation loss decreased (0.181107 --> 0.180688).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 39 cost time: 0.9123733043670654
Epoch: 39, Steps: 64 | Train Loss: 0.1257982 Vali Loss: 0.1810435 Test Loss: 0.2322672
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 40 cost time: 0.9163844585418701
Epoch: 40, Steps: 64 | Train Loss: 0.1253111 Vali Loss: 0.1840601 Test Loss: 0.2327571
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 41 cost time: 0.9197695255279541
Epoch: 41, Steps: 64 | Train Loss: 0.1252042 Vali Loss: 0.1823810 Test Loss: 0.2317510
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 42 cost time: 0.8736286163330078
Epoch: 42, Steps: 64 | Train Loss: 0.1253534 Vali Loss: 0.1816401 Test Loss: 0.2316036
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 43 cost time: 0.8563687801361084
Epoch: 43, Steps: 64 | Train Loss: 0.1253724 Vali Loss: 0.1825451 Test Loss: 0.2318547
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 44 cost time: 0.8614530563354492
Epoch: 44, Steps: 64 | Train Loss: 0.1253497 Vali Loss: 0.1829624 Test Loss: 0.2323322
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 45 cost time: 0.8614273071289062
Epoch: 45, Steps: 64 | Train Loss: 0.1260416 Vali Loss: 0.1831588 Test Loss: 0.2320503
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 46 cost time: 0.8514924049377441
Epoch: 46, Steps: 64 | Train Loss: 0.1261175 Vali Loss: 0.1819874 Test Loss: 0.2318660
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 47 cost time: 0.8830008506774902
Epoch: 47, Steps: 64 | Train Loss: 0.1254430 Vali Loss: 0.1817200 Test Loss: 0.2321100
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 48 cost time: 0.8956265449523926
Epoch: 48, Steps: 64 | Train Loss: 0.1255261 Vali Loss: 0.1816103 Test Loss: 0.2323378
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 49 cost time: 0.8913609981536865
Epoch: 49, Steps: 64 | Train Loss: 0.1254594 Vali Loss: 0.1823900 Test Loss: 0.2325053
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 50 cost time: 0.8893895149230957
Epoch: 50, Steps: 64 | Train Loss: 0.1257276 Vali Loss: 0.1812886 Test Loss: 0.2319392
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 51 cost time: 0.8622870445251465
Epoch: 51, Steps: 64 | Train Loss: 0.1253117 Vali Loss: 0.1816329 Test Loss: 0.2320727
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 52 cost time: 0.8704957962036133
Epoch: 52, Steps: 64 | Train Loss: 0.1253856 Vali Loss: 0.1822849 Test Loss: 0.2319978
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 53 cost time: 0.888648509979248
Epoch: 53, Steps: 64 | Train Loss: 0.1252846 Vali Loss: 0.1817708 Test Loss: 0.2321793
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 54 cost time: 0.8993833065032959
Epoch: 54, Steps: 64 | Train Loss: 0.1256410 Vali Loss: 0.1808814 Test Loss: 0.2319570
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 55 cost time: 0.8990838527679443
Epoch: 55, Steps: 64 | Train Loss: 0.1257801 Vali Loss: 0.1830279 Test Loss: 0.2331279
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 56 cost time: 0.9153594970703125
Epoch: 56, Steps: 64 | Train Loss: 0.1254790 Vali Loss: 0.1824977 Test Loss: 0.2319258
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 57 cost time: 0.9157609939575195
Epoch: 57, Steps: 64 | Train Loss: 0.1255995 Vali Loss: 0.1821693 Test Loss: 0.2322699
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 58 cost time: 0.9090018272399902
Epoch: 58, Steps: 64 | Train Loss: 0.1252459 Vali Loss: 0.1810855 Test Loss: 0.2324447
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 59 cost time: 0.912642240524292
Epoch: 59, Steps: 64 | Train Loss: 0.1250216 Vali Loss: 0.1811969 Test Loss: 0.2311724
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 60 cost time: 0.9006319046020508
Epoch: 60, Steps: 64 | Train Loss: 0.1255608 Vali Loss: 0.1815398 Test Loss: 0.2324687
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23207804560661316, mae:0.34820789098739624, rse:0.24414686858654022
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.03964376449584961 GB
Epoch: 1 cost time: 2.289713144302368
Epoch: 1, Steps: 64 | Train Loss: 1.2457845 Vali Loss: 2.9370027 Test Loss: 4.6804209
Validation loss decreased (inf --> 2.937003).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 2 cost time: 0.9511618614196777
Epoch: 2, Steps: 64 | Train Loss: 0.9813285 Vali Loss: 1.6382904 Test Loss: 2.5466394
Validation loss decreased (2.937003 --> 1.638290).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 3 cost time: 0.9053549766540527
Epoch: 3, Steps: 64 | Train Loss: 0.5901547 Vali Loss: 0.8858233 Test Loss: 1.2983465
Validation loss decreased (1.638290 --> 0.885823).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 4 cost time: 0.9369378089904785
Epoch: 4, Steps: 64 | Train Loss: 0.3874365 Vali Loss: 0.6189764 Test Loss: 0.8621765
Validation loss decreased (0.885823 --> 0.618976).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 5 cost time: 0.9316396713256836
Epoch: 5, Steps: 64 | Train Loss: 0.3081242 Vali Loss: 0.4933121 Test Loss: 0.6659459
Validation loss decreased (0.618976 --> 0.493312).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 6 cost time: 0.9066193103790283
Epoch: 6, Steps: 64 | Train Loss: 0.2650384 Vali Loss: 0.4120535 Test Loss: 0.5390143
Validation loss decreased (0.493312 --> 0.412053).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 7 cost time: 0.8836150169372559
Epoch: 7, Steps: 64 | Train Loss: 0.2378632 Vali Loss: 0.3597744 Test Loss: 0.4614101
Validation loss decreased (0.412053 --> 0.359774).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 8 cost time: 0.8884520530700684
Epoch: 8, Steps: 64 | Train Loss: 0.2188837 Vali Loss: 0.3236591 Test Loss: 0.4134767
Validation loss decreased (0.359774 --> 0.323659).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 9 cost time: 0.8924400806427002
Epoch: 9, Steps: 64 | Train Loss: 0.2055902 Vali Loss: 0.2938344 Test Loss: 0.3785197
Validation loss decreased (0.323659 --> 0.293834).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 10 cost time: 0.9141025543212891
Epoch: 10, Steps: 64 | Train Loss: 0.1957964 Vali Loss: 0.2715776 Test Loss: 0.3478062
Validation loss decreased (0.293834 --> 0.271578).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 11 cost time: 0.9328255653381348
Epoch: 11, Steps: 64 | Train Loss: 0.1869033 Vali Loss: 0.2586378 Test Loss: 0.3311851
Validation loss decreased (0.271578 --> 0.258638).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 12 cost time: 0.944000244140625
Epoch: 12, Steps: 64 | Train Loss: 0.1815948 Vali Loss: 0.2447012 Test Loss: 0.3144352
Validation loss decreased (0.258638 --> 0.244701).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 13 cost time: 0.93963623046875
Epoch: 13, Steps: 64 | Train Loss: 0.1764570 Vali Loss: 0.2350805 Test Loss: 0.3023891
Validation loss decreased (0.244701 --> 0.235081).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 14 cost time: 0.9257926940917969
Epoch: 14, Steps: 64 | Train Loss: 0.1730038 Vali Loss: 0.2298172 Test Loss: 0.2938971
Validation loss decreased (0.235081 --> 0.229817).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 15 cost time: 0.9165968894958496
Epoch: 15, Steps: 64 | Train Loss: 0.1698857 Vali Loss: 0.2195962 Test Loss: 0.2844886
Validation loss decreased (0.229817 --> 0.219596).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 16 cost time: 0.9273972511291504
Epoch: 16, Steps: 64 | Train Loss: 0.1672262 Vali Loss: 0.2180309 Test Loss: 0.2808850
Validation loss decreased (0.219596 --> 0.218031).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 17 cost time: 0.9133796691894531
Epoch: 17, Steps: 64 | Train Loss: 0.1651819 Vali Loss: 0.2159719 Test Loss: 0.2782312
Validation loss decreased (0.218031 --> 0.215972).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 18 cost time: 0.9168245792388916
Epoch: 18, Steps: 64 | Train Loss: 0.1631783 Vali Loss: 0.2121530 Test Loss: 0.2727466
Validation loss decreased (0.215972 --> 0.212153).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 19 cost time: 0.939276933670044
Epoch: 19, Steps: 64 | Train Loss: 0.1623220 Vali Loss: 0.2102394 Test Loss: 0.2712902
Validation loss decreased (0.212153 --> 0.210239).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 20 cost time: 0.9470024108886719
Epoch: 20, Steps: 64 | Train Loss: 0.1605079 Vali Loss: 0.2064425 Test Loss: 0.2657105
Validation loss decreased (0.210239 --> 0.206443).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 21 cost time: 0.9196364879608154
Epoch: 21, Steps: 64 | Train Loss: 0.1598888 Vali Loss: 0.2052238 Test Loss: 0.2646034
Validation loss decreased (0.206443 --> 0.205224).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 22 cost time: 0.9114186763763428
Epoch: 22, Steps: 64 | Train Loss: 0.1576285 Vali Loss: 0.2028235 Test Loss: 0.2618538
Validation loss decreased (0.205224 --> 0.202824).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 23 cost time: 0.8971595764160156
Epoch: 23, Steps: 64 | Train Loss: 0.1579733 Vali Loss: 0.1984947 Test Loss: 0.2605935
Validation loss decreased (0.202824 --> 0.198495).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 24 cost time: 0.8884100914001465
Epoch: 24, Steps: 64 | Train Loss: 0.1567345 Vali Loss: 0.2021598 Test Loss: 0.2613615
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 25 cost time: 0.9180376529693604
Epoch: 25, Steps: 64 | Train Loss: 0.1564966 Vali Loss: 0.1990722 Test Loss: 0.2585076
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 26 cost time: 0.9019978046417236
Epoch: 26, Steps: 64 | Train Loss: 0.1553467 Vali Loss: 0.1988867 Test Loss: 0.2563026
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 27 cost time: 0.9126079082489014
Epoch: 27, Steps: 64 | Train Loss: 0.1545727 Vali Loss: 0.1974017 Test Loss: 0.2562786
Validation loss decreased (0.198495 --> 0.197402).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 28 cost time: 0.9116380214691162
Epoch: 28, Steps: 64 | Train Loss: 0.1548359 Vali Loss: 0.1963025 Test Loss: 0.2537895
Validation loss decreased (0.197402 --> 0.196303).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 29 cost time: 0.9140784740447998
Epoch: 29, Steps: 64 | Train Loss: 0.1540192 Vali Loss: 0.1953350 Test Loss: 0.2554679
Validation loss decreased (0.196303 --> 0.195335).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 30 cost time: 0.9163994789123535
Epoch: 30, Steps: 64 | Train Loss: 0.1539042 Vali Loss: 0.1938791 Test Loss: 0.2527748
Validation loss decreased (0.195335 --> 0.193879).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 31 cost time: 0.9263663291931152
Epoch: 31, Steps: 64 | Train Loss: 0.1527569 Vali Loss: 0.1928455 Test Loss: 0.2539197
Validation loss decreased (0.193879 --> 0.192846).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 32 cost time: 0.9203851222991943
Epoch: 32, Steps: 64 | Train Loss: 0.1527645 Vali Loss: 0.1934199 Test Loss: 0.2541901
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 33 cost time: 0.9110007286071777
Epoch: 33, Steps: 64 | Train Loss: 0.1520989 Vali Loss: 0.1924801 Test Loss: 0.2513898
Validation loss decreased (0.192846 --> 0.192480).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 34 cost time: 0.9270007610321045
Epoch: 34, Steps: 64 | Train Loss: 0.1521767 Vali Loss: 0.1909994 Test Loss: 0.2512751
Validation loss decreased (0.192480 --> 0.190999).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 35 cost time: 0.9126091003417969
Epoch: 35, Steps: 64 | Train Loss: 0.1513922 Vali Loss: 0.1912166 Test Loss: 0.2520948
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 36 cost time: 0.9411370754241943
Epoch: 36, Steps: 64 | Train Loss: 0.1522513 Vali Loss: 0.1925866 Test Loss: 0.2505114
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 37 cost time: 0.9423918724060059
Epoch: 37, Steps: 64 | Train Loss: 0.1508738 Vali Loss: 0.1910747 Test Loss: 0.2506700
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 38 cost time: 0.9333813190460205
Epoch: 38, Steps: 64 | Train Loss: 0.1516410 Vali Loss: 0.1890948 Test Loss: 0.2464364
Validation loss decreased (0.190999 --> 0.189095).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 39 cost time: 0.9405040740966797
Epoch: 39, Steps: 64 | Train Loss: 0.1507712 Vali Loss: 0.1904179 Test Loss: 0.2476351
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 40 cost time: 0.9315536022186279
Epoch: 40, Steps: 64 | Train Loss: 0.1505385 Vali Loss: 0.1915158 Test Loss: 0.2504088
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 41 cost time: 0.9056351184844971
Epoch: 41, Steps: 64 | Train Loss: 0.1517746 Vali Loss: 0.1915253 Test Loss: 0.2481764
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 42 cost time: 0.8946328163146973
Epoch: 42, Steps: 64 | Train Loss: 0.1505755 Vali Loss: 0.1895397 Test Loss: 0.2484712
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 43 cost time: 0.889096736907959
Epoch: 43, Steps: 64 | Train Loss: 0.1510574 Vali Loss: 0.1896270 Test Loss: 0.2484111
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 44 cost time: 0.9034106731414795
Epoch: 44, Steps: 64 | Train Loss: 0.1503809 Vali Loss: 0.1900236 Test Loss: 0.2477866
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 45 cost time: 0.9170327186584473
Epoch: 45, Steps: 64 | Train Loss: 0.1509639 Vali Loss: 0.1911592 Test Loss: 0.2495894
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 46 cost time: 0.9117810726165771
Epoch: 46, Steps: 64 | Train Loss: 0.1510952 Vali Loss: 0.1911094 Test Loss: 0.2489212
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 47 cost time: 0.916309118270874
Epoch: 47, Steps: 64 | Train Loss: 0.1504297 Vali Loss: 0.1921788 Test Loss: 0.2514743
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 48 cost time: 0.9176340103149414
Epoch: 48, Steps: 64 | Train Loss: 0.1508302 Vali Loss: 0.1885757 Test Loss: 0.2468508
Validation loss decreased (0.189095 --> 0.188576).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 49 cost time: 0.9006364345550537
Epoch: 49, Steps: 64 | Train Loss: 0.1508441 Vali Loss: 0.1892055 Test Loss: 0.2475704
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 50 cost time: 0.8904080390930176
Epoch: 50, Steps: 64 | Train Loss: 0.1502026 Vali Loss: 0.1884529 Test Loss: 0.2471106
Validation loss decreased (0.188576 --> 0.188453).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 51 cost time: 0.9163846969604492
Epoch: 51, Steps: 64 | Train Loss: 0.1502189 Vali Loss: 0.1912096 Test Loss: 0.2485115
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 52 cost time: 0.921018123626709
Epoch: 52, Steps: 64 | Train Loss: 0.1508517 Vali Loss: 0.1893047 Test Loss: 0.2481242
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 53 cost time: 0.9237570762634277
Epoch: 53, Steps: 64 | Train Loss: 0.1496294 Vali Loss: 0.1881029 Test Loss: 0.2471986
Validation loss decreased (0.188453 --> 0.188103).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 54 cost time: 0.9353985786437988
Epoch: 54, Steps: 64 | Train Loss: 0.1498220 Vali Loss: 0.1911732 Test Loss: 0.2485302
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 55 cost time: 0.9326255321502686
Epoch: 55, Steps: 64 | Train Loss: 0.1512078 Vali Loss: 0.1896922 Test Loss: 0.2473800
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 56 cost time: 0.9384417533874512
Epoch: 56, Steps: 64 | Train Loss: 0.1504697 Vali Loss: 0.1906288 Test Loss: 0.2493322
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 57 cost time: 0.9333558082580566
Epoch: 57, Steps: 64 | Train Loss: 0.1506262 Vali Loss: 0.1881256 Test Loss: 0.2469654
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 58 cost time: 0.9193651676177979
Epoch: 58, Steps: 64 | Train Loss: 0.1503936 Vali Loss: 0.1906533 Test Loss: 0.2489186
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 59 cost time: 0.9177305698394775
Epoch: 59, Steps: 64 | Train Loss: 0.1499680 Vali Loss: 0.1874163 Test Loss: 0.2460201
Validation loss decreased (0.188103 --> 0.187416).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 60 cost time: 0.9138007164001465
Epoch: 60, Steps: 64 | Train Loss: 0.1499720 Vali Loss: 0.1894707 Test Loss: 0.2481040
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2460201233625412, mae:0.35847917199134827, rse:0.2513734698295593
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.040345191955566406 GB
Epoch: 1 cost time: 2.2409417629241943
Epoch: 1, Steps: 64 | Train Loss: 1.0044129 Vali Loss: 2.6106639 Test Loss: 4.2210422
Validation loss decreased (inf --> 2.610664).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 2 cost time: 0.8876066207885742
Epoch: 2, Steps: 64 | Train Loss: 0.8088765 Vali Loss: 1.5495900 Test Loss: 2.4251163
Validation loss decreased (2.610664 --> 1.549590).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 3 cost time: 0.876361608505249
Epoch: 3, Steps: 64 | Train Loss: 0.4956281 Vali Loss: 0.8193926 Test Loss: 1.2019030
Validation loss decreased (1.549590 --> 0.819393).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 4 cost time: 0.8834013938903809
Epoch: 4, Steps: 64 | Train Loss: 0.2983571 Vali Loss: 0.4555204 Test Loss: 0.5993004
Validation loss decreased (0.819393 --> 0.455520).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 5 cost time: 0.8883848190307617
Epoch: 5, Steps: 64 | Train Loss: 0.2048484 Vali Loss: 0.3069577 Test Loss: 0.3731334
Validation loss decreased (0.455520 --> 0.306958).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 6 cost time: 0.8607997894287109
Epoch: 6, Steps: 64 | Train Loss: 0.1698654 Vali Loss: 0.2388524 Test Loss: 0.2878856
Validation loss decreased (0.306958 --> 0.238852).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 7 cost time: 0.8659982681274414
Epoch: 7, Steps: 64 | Train Loss: 0.1560303 Vali Loss: 0.2088764 Test Loss: 0.2563861
Validation loss decreased (0.238852 --> 0.208876).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 8 cost time: 0.8553640842437744
Epoch: 8, Steps: 64 | Train Loss: 0.1489395 Vali Loss: 0.1999533 Test Loss: 0.2441548
Validation loss decreased (0.208876 --> 0.199953).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 9 cost time: 0.8643810749053955
Epoch: 9, Steps: 64 | Train Loss: 0.1446778 Vali Loss: 0.1904579 Test Loss: 0.2376578
Validation loss decreased (0.199953 --> 0.190458).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 10 cost time: 0.8674173355102539
Epoch: 10, Steps: 64 | Train Loss: 0.1423559 Vali Loss: 0.1880638 Test Loss: 0.2334387
Validation loss decreased (0.190458 --> 0.188064).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 11 cost time: 0.8923859596252441
Epoch: 11, Steps: 64 | Train Loss: 0.1395138 Vali Loss: 0.1859451 Test Loss: 0.2316727
Validation loss decreased (0.188064 --> 0.185945).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 12 cost time: 0.8967268466949463
Epoch: 12, Steps: 64 | Train Loss: 0.1375411 Vali Loss: 0.1837850 Test Loss: 0.2317312
Validation loss decreased (0.185945 --> 0.183785).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 13 cost time: 0.8814120292663574
Epoch: 13, Steps: 64 | Train Loss: 0.1374408 Vali Loss: 0.1836918 Test Loss: 0.2311995
Validation loss decreased (0.183785 --> 0.183692).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 14 cost time: 0.9006197452545166
Epoch: 14, Steps: 64 | Train Loss: 0.1350731 Vali Loss: 0.1831933 Test Loss: 0.2298273
Validation loss decreased (0.183692 --> 0.183193).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 15 cost time: 0.8800773620605469
Epoch: 15, Steps: 64 | Train Loss: 0.1345395 Vali Loss: 0.1823032 Test Loss: 0.2308203
Validation loss decreased (0.183193 --> 0.182303).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 16 cost time: 0.885373592376709
Epoch: 16, Steps: 64 | Train Loss: 0.1341018 Vali Loss: 0.1787582 Test Loss: 0.2293394
Validation loss decreased (0.182303 --> 0.178758).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 17 cost time: 0.8824543952941895
Epoch: 17, Steps: 64 | Train Loss: 0.1320029 Vali Loss: 0.1813409 Test Loss: 0.2291580
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 18 cost time: 0.8832700252532959
Epoch: 18, Steps: 64 | Train Loss: 0.1322713 Vali Loss: 0.1790032 Test Loss: 0.2284905
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 19 cost time: 0.892000675201416
Epoch: 19, Steps: 64 | Train Loss: 0.1314336 Vali Loss: 0.1811177 Test Loss: 0.2302161
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 20 cost time: 0.9023551940917969
Epoch: 20, Steps: 64 | Train Loss: 0.1311248 Vali Loss: 0.1777248 Test Loss: 0.2284409
Validation loss decreased (0.178758 --> 0.177725).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 21 cost time: 0.8964371681213379
Epoch: 21, Steps: 64 | Train Loss: 0.1305150 Vali Loss: 0.1792685 Test Loss: 0.2294964
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 22 cost time: 0.8863739967346191
Epoch: 22, Steps: 64 | Train Loss: 0.1301736 Vali Loss: 0.1784950 Test Loss: 0.2295491
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 23 cost time: 0.87674880027771
Epoch: 23, Steps: 64 | Train Loss: 0.1295400 Vali Loss: 0.1790223 Test Loss: 0.2283642
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 24 cost time: 0.8600006103515625
Epoch: 24, Steps: 64 | Train Loss: 0.1292783 Vali Loss: 0.1755528 Test Loss: 0.2276173
Validation loss decreased (0.177725 --> 0.175553).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 25 cost time: 0.8456554412841797
Epoch: 25, Steps: 64 | Train Loss: 0.1285036 Vali Loss: 0.1763267 Test Loss: 0.2275307
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 26 cost time: 0.8543698787689209
Epoch: 26, Steps: 64 | Train Loss: 0.1282804 Vali Loss: 0.1790759 Test Loss: 0.2302331
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 27 cost time: 0.8680651187896729
Epoch: 27, Steps: 64 | Train Loss: 0.1281609 Vali Loss: 0.1771488 Test Loss: 0.2279710
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 28 cost time: 0.8683867454528809
Epoch: 28, Steps: 64 | Train Loss: 0.1281265 Vali Loss: 0.1783111 Test Loss: 0.2280069
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 29 cost time: 0.8743934631347656
Epoch: 29, Steps: 64 | Train Loss: 0.1275429 Vali Loss: 0.1778706 Test Loss: 0.2297990
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 30 cost time: 0.8779990673065186
Epoch: 30, Steps: 64 | Train Loss: 0.1279532 Vali Loss: 0.1776697 Test Loss: 0.2296288
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 31 cost time: 0.8841593265533447
Epoch: 31, Steps: 64 | Train Loss: 0.1280082 Vali Loss: 0.1750839 Test Loss: 0.2294718
Validation loss decreased (0.175553 --> 0.175084).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 32 cost time: 0.8783712387084961
Epoch: 32, Steps: 64 | Train Loss: 0.1268771 Vali Loss: 0.1748475 Test Loss: 0.2275947
Validation loss decreased (0.175084 --> 0.174847).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 33 cost time: 0.8705153465270996
Epoch: 33, Steps: 64 | Train Loss: 0.1272802 Vali Loss: 0.1778522 Test Loss: 0.2281643
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 34 cost time: 0.8777599334716797
Epoch: 34, Steps: 64 | Train Loss: 0.1269857 Vali Loss: 0.1769784 Test Loss: 0.2289033
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 35 cost time: 0.8760011196136475
Epoch: 35, Steps: 64 | Train Loss: 0.1271519 Vali Loss: 0.1762988 Test Loss: 0.2293461
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 36 cost time: 0.8793070316314697
Epoch: 36, Steps: 64 | Train Loss: 0.1268057 Vali Loss: 0.1758306 Test Loss: 0.2283184
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 37 cost time: 0.88437819480896
Epoch: 37, Steps: 64 | Train Loss: 0.1269773 Vali Loss: 0.1762543 Test Loss: 0.2288989
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 38 cost time: 0.9024300575256348
Epoch: 38, Steps: 64 | Train Loss: 0.1268021 Vali Loss: 0.1752426 Test Loss: 0.2272182
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 39 cost time: 0.9053559303283691
Epoch: 39, Steps: 64 | Train Loss: 0.1268657 Vali Loss: 0.1770948 Test Loss: 0.2289245
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 40 cost time: 0.8934237957000732
Epoch: 40, Steps: 64 | Train Loss: 0.1274144 Vali Loss: 0.1756603 Test Loss: 0.2273998
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 41 cost time: 0.9059996604919434
Epoch: 41, Steps: 64 | Train Loss: 0.1260230 Vali Loss: 0.1754581 Test Loss: 0.2288866
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 42 cost time: 0.9032485485076904
Epoch: 42, Steps: 64 | Train Loss: 0.1267388 Vali Loss: 0.1756695 Test Loss: 0.2276066
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 43 cost time: 0.8763697147369385
Epoch: 43, Steps: 64 | Train Loss: 0.1263693 Vali Loss: 0.1753937 Test Loss: 0.2284406
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 44 cost time: 0.8594372272491455
Epoch: 44, Steps: 64 | Train Loss: 0.1268434 Vali Loss: 0.1768502 Test Loss: 0.2301972
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 45 cost time: 0.8552579879760742
Epoch: 45, Steps: 64 | Train Loss: 0.1260151 Vali Loss: 0.1763140 Test Loss: 0.2285704
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 46 cost time: 0.8639991283416748
Epoch: 46, Steps: 64 | Train Loss: 0.1265011 Vali Loss: 0.1753626 Test Loss: 0.2277885
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 47 cost time: 0.8806297779083252
Epoch: 47, Steps: 64 | Train Loss: 0.1258953 Vali Loss: 0.1752837 Test Loss: 0.2284370
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 48 cost time: 0.881547212600708
Epoch: 48, Steps: 64 | Train Loss: 0.1267840 Vali Loss: 0.1748017 Test Loss: 0.2287197
Validation loss decreased (0.174847 --> 0.174802).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 49 cost time: 0.8930160999298096
Epoch: 49, Steps: 64 | Train Loss: 0.1263842 Vali Loss: 0.1768339 Test Loss: 0.2283309
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 50 cost time: 0.8773889541625977
Epoch: 50, Steps: 64 | Train Loss: 0.1263492 Vali Loss: 0.1763961 Test Loss: 0.2290894
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 51 cost time: 0.8587486743927002
Epoch: 51, Steps: 64 | Train Loss: 0.1257509 Vali Loss: 0.1751108 Test Loss: 0.2280311
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 52 cost time: 0.860999584197998
Epoch: 52, Steps: 64 | Train Loss: 0.1265291 Vali Loss: 0.1746527 Test Loss: 0.2290422
Validation loss decreased (0.174802 --> 0.174653).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 53 cost time: 0.8696198463439941
Epoch: 53, Steps: 64 | Train Loss: 0.1263195 Vali Loss: 0.1761853 Test Loss: 0.2287182
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 54 cost time: 0.8743917942047119
Epoch: 54, Steps: 64 | Train Loss: 0.1260199 Vali Loss: 0.1755978 Test Loss: 0.2272443
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 55 cost time: 0.8814072608947754
Epoch: 55, Steps: 64 | Train Loss: 0.1256272 Vali Loss: 0.1757511 Test Loss: 0.2296837
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 56 cost time: 0.9023582935333252
Epoch: 56, Steps: 64 | Train Loss: 0.1265623 Vali Loss: 0.1778097 Test Loss: 0.2283635
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 57 cost time: 0.9010000228881836
Epoch: 57, Steps: 64 | Train Loss: 0.1263312 Vali Loss: 0.1771116 Test Loss: 0.2290499
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 58 cost time: 0.9030282497406006
Epoch: 58, Steps: 64 | Train Loss: 0.1267783 Vali Loss: 0.1766164 Test Loss: 0.2301652
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 59 cost time: 0.9043943881988525
Epoch: 59, Steps: 64 | Train Loss: 0.1269061 Vali Loss: 0.1739403 Test Loss: 0.2270371
Validation loss decreased (0.174653 --> 0.173940).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 60 cost time: 0.8943970203399658
Epoch: 60, Steps: 64 | Train Loss: 0.1260470 Vali Loss: 0.1766626 Test Loss: 0.2289589
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22703710198402405, mae:0.3380316495895386, rse:0.2414807677268982
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.0409092903137207 GB
Epoch: 1 cost time: 2.3341259956359863
Epoch: 1, Steps: 64 | Train Loss: 0.8446361 Vali Loss: 2.2797871 Test Loss: 3.5815632
Validation loss decreased (inf --> 2.279787).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 2 cost time: 0.9733707904815674
Epoch: 2, Steps: 64 | Train Loss: 0.6969919 Vali Loss: 1.4081992 Test Loss: 2.1508186
Validation loss decreased (2.279787 --> 1.408199).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 3 cost time: 0.9766190052032471
Epoch: 3, Steps: 64 | Train Loss: 0.4270603 Vali Loss: 0.6791500 Test Loss: 0.9499972
Validation loss decreased (1.408199 --> 0.679150).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 4 cost time: 0.9904019832611084
Epoch: 4, Steps: 64 | Train Loss: 0.2400497 Vali Loss: 0.3351250 Test Loss: 0.4182447
Validation loss decreased (0.679150 --> 0.335125).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 5 cost time: 0.9567124843597412
Epoch: 5, Steps: 64 | Train Loss: 0.1687375 Vali Loss: 0.2340997 Test Loss: 0.2848845
Validation loss decreased (0.335125 --> 0.234100).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 6 cost time: 0.9519999027252197
Epoch: 6, Steps: 64 | Train Loss: 0.1507035 Vali Loss: 0.2058888 Test Loss: 0.2564230
Validation loss decreased (0.234100 --> 0.205889).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 7 cost time: 0.9514167308807373
Epoch: 7, Steps: 64 | Train Loss: 0.1438729 Vali Loss: 0.1997329 Test Loss: 0.2487956
Validation loss decreased (0.205889 --> 0.199733).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 8 cost time: 0.9686322212219238
Epoch: 8, Steps: 64 | Train Loss: 0.1398914 Vali Loss: 0.1919397 Test Loss: 0.2430137
Validation loss decreased (0.199733 --> 0.191940).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 9 cost time: 0.9593310356140137
Epoch: 9, Steps: 64 | Train Loss: 0.1369303 Vali Loss: 0.1904269 Test Loss: 0.2408797
Validation loss decreased (0.191940 --> 0.190427).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 10 cost time: 0.9893767833709717
Epoch: 10, Steps: 64 | Train Loss: 0.1349051 Vali Loss: 0.1872008 Test Loss: 0.2389750
Validation loss decreased (0.190427 --> 0.187201).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 11 cost time: 0.9950428009033203
Epoch: 11, Steps: 64 | Train Loss: 0.1324638 Vali Loss: 0.1846363 Test Loss: 0.2367741
Validation loss decreased (0.187201 --> 0.184636).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 12 cost time: 0.9863865375518799
Epoch: 12, Steps: 64 | Train Loss: 0.1305834 Vali Loss: 0.1849038 Test Loss: 0.2362813
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 13 cost time: 0.9893546104431152
Epoch: 13, Steps: 64 | Train Loss: 0.1293944 Vali Loss: 0.1826352 Test Loss: 0.2358478
Validation loss decreased (0.184636 --> 0.182635).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 14 cost time: 0.9723715782165527
Epoch: 14, Steps: 64 | Train Loss: 0.1287655 Vali Loss: 0.1798305 Test Loss: 0.2346383
Validation loss decreased (0.182635 --> 0.179830).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 15 cost time: 0.9797356128692627
Epoch: 15, Steps: 64 | Train Loss: 0.1270958 Vali Loss: 0.1806708 Test Loss: 0.2330815
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 16 cost time: 0.9737329483032227
Epoch: 16, Steps: 64 | Train Loss: 0.1270043 Vali Loss: 0.1801379 Test Loss: 0.2341283
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 17 cost time: 0.9750008583068848
Epoch: 17, Steps: 64 | Train Loss: 0.1266107 Vali Loss: 0.1793580 Test Loss: 0.2338046
Validation loss decreased (0.179830 --> 0.179358).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 18 cost time: 0.9886407852172852
Epoch: 18, Steps: 64 | Train Loss: 0.1255836 Vali Loss: 0.1796416 Test Loss: 0.2339038
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 19 cost time: 0.9810726642608643
Epoch: 19, Steps: 64 | Train Loss: 0.1255709 Vali Loss: 0.1769169 Test Loss: 0.2326055
Validation loss decreased (0.179358 --> 0.176917).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 20 cost time: 0.9764406681060791
Epoch: 20, Steps: 64 | Train Loss: 0.1250976 Vali Loss: 0.1792912 Test Loss: 0.2344075
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 21 cost time: 0.9633409976959229
Epoch: 21, Steps: 64 | Train Loss: 0.1241096 Vali Loss: 0.1794532 Test Loss: 0.2334430
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 22 cost time: 0.9543893337249756
Epoch: 22, Steps: 64 | Train Loss: 0.1244712 Vali Loss: 0.1774915 Test Loss: 0.2327756
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 23 cost time: 0.9631433486938477
Epoch: 23, Steps: 64 | Train Loss: 0.1238302 Vali Loss: 0.1760135 Test Loss: 0.2327343
Validation loss decreased (0.176917 --> 0.176014).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 24 cost time: 0.9524006843566895
Epoch: 24, Steps: 64 | Train Loss: 0.1236543 Vali Loss: 0.1771668 Test Loss: 0.2340295
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 25 cost time: 0.949772834777832
Epoch: 25, Steps: 64 | Train Loss: 0.1231563 Vali Loss: 0.1760036 Test Loss: 0.2334265
Validation loss decreased (0.176014 --> 0.176004).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 26 cost time: 0.9667186737060547
Epoch: 26, Steps: 64 | Train Loss: 0.1225913 Vali Loss: 0.1766658 Test Loss: 0.2329459
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 27 cost time: 0.9819991588592529
Epoch: 27, Steps: 64 | Train Loss: 0.1230553 Vali Loss: 0.1754967 Test Loss: 0.2327138
Validation loss decreased (0.176004 --> 0.175497).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 28 cost time: 0.9692726135253906
Epoch: 28, Steps: 64 | Train Loss: 0.1222393 Vali Loss: 0.1770949 Test Loss: 0.2329467
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 29 cost time: 0.9866325855255127
Epoch: 29, Steps: 64 | Train Loss: 0.1221962 Vali Loss: 0.1741984 Test Loss: 0.2318403
Validation loss decreased (0.175497 --> 0.174198).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 30 cost time: 0.9913794994354248
Epoch: 30, Steps: 64 | Train Loss: 0.1226694 Vali Loss: 0.1762733 Test Loss: 0.2338072
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 31 cost time: 0.9691545963287354
Epoch: 31, Steps: 64 | Train Loss: 0.1224813 Vali Loss: 0.1757370 Test Loss: 0.2323275
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 32 cost time: 0.9750235080718994
Epoch: 32, Steps: 64 | Train Loss: 0.1217057 Vali Loss: 0.1758449 Test Loss: 0.2325496
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 33 cost time: 0.9799914360046387
Epoch: 33, Steps: 64 | Train Loss: 0.1220519 Vali Loss: 0.1745169 Test Loss: 0.2329674
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 34 cost time: 0.9693424701690674
Epoch: 34, Steps: 64 | Train Loss: 0.1218859 Vali Loss: 0.1758834 Test Loss: 0.2331148
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 35 cost time: 0.9923703670501709
Epoch: 35, Steps: 64 | Train Loss: 0.1216296 Vali Loss: 0.1764446 Test Loss: 0.2335187
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 36 cost time: 1.000091552734375
Epoch: 36, Steps: 64 | Train Loss: 0.1213996 Vali Loss: 0.1775126 Test Loss: 0.2333040
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 37 cost time: 0.988591194152832
Epoch: 37, Steps: 64 | Train Loss: 0.1212398 Vali Loss: 0.1751085 Test Loss: 0.2333910
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 38 cost time: 0.9790012836456299
Epoch: 38, Steps: 64 | Train Loss: 0.1217934 Vali Loss: 0.1745872 Test Loss: 0.2322242
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 39 cost time: 0.9556500911712646
Epoch: 39, Steps: 64 | Train Loss: 0.1212687 Vali Loss: 0.1760639 Test Loss: 0.2329196
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 40 cost time: 0.9587376117706299
Epoch: 40, Steps: 64 | Train Loss: 0.1219791 Vali Loss: 0.1757116 Test Loss: 0.2330689
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 41 cost time: 0.9489891529083252
Epoch: 41, Steps: 64 | Train Loss: 0.1217382 Vali Loss: 0.1736699 Test Loss: 0.2322496
Validation loss decreased (0.174198 --> 0.173670).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 42 cost time: 0.9505190849304199
Epoch: 42, Steps: 64 | Train Loss: 0.1214980 Vali Loss: 0.1748414 Test Loss: 0.2324094
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 43 cost time: 0.9854259490966797
Epoch: 43, Steps: 64 | Train Loss: 0.1217662 Vali Loss: 0.1748538 Test Loss: 0.2324525
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 44 cost time: 0.9724328517913818
Epoch: 44, Steps: 64 | Train Loss: 0.1213767 Vali Loss: 0.1756553 Test Loss: 0.2329807
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 45 cost time: 0.9761004447937012
Epoch: 45, Steps: 64 | Train Loss: 0.1211447 Vali Loss: 0.1762014 Test Loss: 0.2330350
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 46 cost time: 0.9667365550994873
Epoch: 46, Steps: 64 | Train Loss: 0.1209750 Vali Loss: 0.1739098 Test Loss: 0.2330948
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 47 cost time: 0.9559998512268066
Epoch: 47, Steps: 64 | Train Loss: 0.1208136 Vali Loss: 0.1769263 Test Loss: 0.2339547
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 48 cost time: 0.977637767791748
Epoch: 48, Steps: 64 | Train Loss: 0.1209797 Vali Loss: 0.1750321 Test Loss: 0.2318473
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 49 cost time: 0.9690477848052979
Epoch: 49, Steps: 64 | Train Loss: 0.1202542 Vali Loss: 0.1756418 Test Loss: 0.2334446
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 50 cost time: 0.9773569107055664
Epoch: 50, Steps: 64 | Train Loss: 0.1204840 Vali Loss: 0.1763920 Test Loss: 0.2331865
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 51 cost time: 0.982252836227417
Epoch: 51, Steps: 64 | Train Loss: 0.1217431 Vali Loss: 0.1769668 Test Loss: 0.2323862
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 52 cost time: 0.984321117401123
Epoch: 52, Steps: 64 | Train Loss: 0.1208136 Vali Loss: 0.1766660 Test Loss: 0.2335541
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 53 cost time: 0.9955480098724365
Epoch: 53, Steps: 64 | Train Loss: 0.1205973 Vali Loss: 0.1750647 Test Loss: 0.2325348
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 54 cost time: 0.9923908710479736
Epoch: 54, Steps: 64 | Train Loss: 0.1208683 Vali Loss: 0.1740430 Test Loss: 0.2318671
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 55 cost time: 0.9983963966369629
Epoch: 55, Steps: 64 | Train Loss: 0.1206970 Vali Loss: 0.1757889 Test Loss: 0.2335578
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 56 cost time: 0.9767286777496338
Epoch: 56, Steps: 64 | Train Loss: 0.1209001 Vali Loss: 0.1748742 Test Loss: 0.2321028
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 57 cost time: 0.9447939395904541
Epoch: 57, Steps: 64 | Train Loss: 0.1204068 Vali Loss: 0.1742598 Test Loss: 0.2338015
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 58 cost time: 0.9480001926422119
Epoch: 58, Steps: 64 | Train Loss: 0.1211633 Vali Loss: 0.1738894 Test Loss: 0.2325081
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 59 cost time: 0.9636356830596924
Epoch: 59, Steps: 64 | Train Loss: 0.1208479 Vali Loss: 0.1737305 Test Loss: 0.2317922
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 60 cost time: 0.9803459644317627
Epoch: 60, Steps: 64 | Train Loss: 0.1213324 Vali Loss: 0.1744443 Test Loss: 0.2334191
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23224955797195435, mae:0.34665754437446594, rse:0.24423706531524658
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.039804935455322266 GB
Epoch: 1 cost time: 2.210048198699951
Epoch: 1, Steps: 64 | Train Loss: 1.2523718 Vali Loss: 3.0415492 Test Loss: 4.8798518
Validation loss decreased (inf --> 3.041549).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 2 cost time: 0.8631231784820557
Epoch: 2, Steps: 64 | Train Loss: 0.9622572 Vali Loss: 1.6405599 Test Loss: 2.5410838
Validation loss decreased (3.041549 --> 1.640560).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 3 cost time: 0.8601722717285156
Epoch: 3, Steps: 64 | Train Loss: 0.6181521 Vali Loss: 1.1327047 Test Loss: 1.6967156
Validation loss decreased (1.640560 --> 1.132705).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 4 cost time: 0.8639993667602539
Epoch: 4, Steps: 64 | Train Loss: 0.4655148 Vali Loss: 0.8489886 Test Loss: 1.2241658
Validation loss decreased (1.132705 --> 0.848989).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 5 cost time: 0.856630802154541
Epoch: 5, Steps: 64 | Train Loss: 0.3702920 Vali Loss: 0.6587759 Test Loss: 0.9201465
Validation loss decreased (0.848989 --> 0.658776).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 6 cost time: 0.8344743251800537
Epoch: 6, Steps: 64 | Train Loss: 0.3063451 Vali Loss: 0.5331854 Test Loss: 0.7188338
Validation loss decreased (0.658776 --> 0.533185).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 7 cost time: 0.8464300632476807
Epoch: 7, Steps: 64 | Train Loss: 0.2654876 Vali Loss: 0.4467745 Test Loss: 0.5908034
Validation loss decreased (0.533185 --> 0.446775).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 8 cost time: 0.8307356834411621
Epoch: 8, Steps: 64 | Train Loss: 0.2378045 Vali Loss: 0.3878847 Test Loss: 0.5009378
Validation loss decreased (0.446775 --> 0.387885).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 9 cost time: 0.8400022983551025
Epoch: 9, Steps: 64 | Train Loss: 0.2192540 Vali Loss: 0.3506038 Test Loss: 0.4486979
Validation loss decreased (0.387885 --> 0.350604).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 10 cost time: 0.8466308116912842
Epoch: 10, Steps: 64 | Train Loss: 0.2040161 Vali Loss: 0.3161595 Test Loss: 0.4041893
Validation loss decreased (0.350604 --> 0.316159).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 11 cost time: 0.8855807781219482
Epoch: 11, Steps: 64 | Train Loss: 0.1947765 Vali Loss: 0.2914122 Test Loss: 0.3751679
Validation loss decreased (0.316159 --> 0.291412).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 12 cost time: 0.9071440696716309
Epoch: 12, Steps: 64 | Train Loss: 0.1860977 Vali Loss: 0.2744701 Test Loss: 0.3537688
Validation loss decreased (0.291412 --> 0.274470).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 13 cost time: 0.8770191669464111
Epoch: 13, Steps: 64 | Train Loss: 0.1800188 Vali Loss: 0.2583928 Test Loss: 0.3342448
Validation loss decreased (0.274470 --> 0.258393).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 14 cost time: 0.8880002498626709
Epoch: 14, Steps: 64 | Train Loss: 0.1759448 Vali Loss: 0.2469943 Test Loss: 0.3175298
Validation loss decreased (0.258393 --> 0.246994).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 15 cost time: 0.8554995059967041
Epoch: 15, Steps: 64 | Train Loss: 0.1714185 Vali Loss: 0.2414654 Test Loss: 0.3103929
Validation loss decreased (0.246994 --> 0.241465).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 16 cost time: 0.8564462661743164
Epoch: 16, Steps: 64 | Train Loss: 0.1682311 Vali Loss: 0.2310903 Test Loss: 0.2985557
Validation loss decreased (0.241465 --> 0.231090).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 17 cost time: 0.8572628498077393
Epoch: 17, Steps: 64 | Train Loss: 0.1656744 Vali Loss: 0.2279030 Test Loss: 0.2938626
Validation loss decreased (0.231090 --> 0.227903).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 18 cost time: 0.8680577278137207
Epoch: 18, Steps: 64 | Train Loss: 0.1632801 Vali Loss: 0.2211530 Test Loss: 0.2849738
Validation loss decreased (0.227903 --> 0.221153).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 19 cost time: 0.8647851943969727
Epoch: 19, Steps: 64 | Train Loss: 0.1611207 Vali Loss: 0.2180973 Test Loss: 0.2812903
Validation loss decreased (0.221153 --> 0.218097).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 20 cost time: 0.8783054351806641
Epoch: 20, Steps: 64 | Train Loss: 0.1594042 Vali Loss: 0.2141958 Test Loss: 0.2772486
Validation loss decreased (0.218097 --> 0.214196).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 21 cost time: 0.8776187896728516
Epoch: 21, Steps: 64 | Train Loss: 0.1586601 Vali Loss: 0.2115248 Test Loss: 0.2739321
Validation loss decreased (0.214196 --> 0.211525).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 22 cost time: 0.8854327201843262
Epoch: 22, Steps: 64 | Train Loss: 0.1572105 Vali Loss: 0.2105977 Test Loss: 0.2716767
Validation loss decreased (0.211525 --> 0.210598).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 23 cost time: 0.8543827533721924
Epoch: 23, Steps: 64 | Train Loss: 0.1562403 Vali Loss: 0.2072169 Test Loss: 0.2683469
Validation loss decreased (0.210598 --> 0.207217).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 24 cost time: 0.8253345489501953
Epoch: 24, Steps: 64 | Train Loss: 0.1551194 Vali Loss: 0.2083236 Test Loss: 0.2683847
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 25 cost time: 0.8283615112304688
Epoch: 25, Steps: 64 | Train Loss: 0.1541169 Vali Loss: 0.2048984 Test Loss: 0.2645239
Validation loss decreased (0.207217 --> 0.204898).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 26 cost time: 0.8236546516418457
Epoch: 26, Steps: 64 | Train Loss: 0.1534373 Vali Loss: 0.2014566 Test Loss: 0.2621596
Validation loss decreased (0.204898 --> 0.201457).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 27 cost time: 0.8233520984649658
Epoch: 27, Steps: 64 | Train Loss: 0.1532239 Vali Loss: 0.2025697 Test Loss: 0.2618700
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 28 cost time: 0.8463621139526367
Epoch: 28, Steps: 64 | Train Loss: 0.1522343 Vali Loss: 0.2010066 Test Loss: 0.2604904
Validation loss decreased (0.201457 --> 0.201007).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 29 cost time: 0.859776496887207
Epoch: 29, Steps: 64 | Train Loss: 0.1524119 Vali Loss: 0.2013188 Test Loss: 0.2590169
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 30 cost time: 0.8504254817962646
Epoch: 30, Steps: 64 | Train Loss: 0.1519837 Vali Loss: 0.1987542 Test Loss: 0.2579422
Validation loss decreased (0.201007 --> 0.198754).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 31 cost time: 0.8566379547119141
Epoch: 31, Steps: 64 | Train Loss: 0.1503438 Vali Loss: 0.1993866 Test Loss: 0.2551671
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 32 cost time: 0.8534431457519531
Epoch: 32, Steps: 64 | Train Loss: 0.1503754 Vali Loss: 0.1985977 Test Loss: 0.2557047
Validation loss decreased (0.198754 --> 0.198598).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 33 cost time: 0.8436353206634521
Epoch: 33, Steps: 64 | Train Loss: 0.1507940 Vali Loss: 0.1985920 Test Loss: 0.2578861
Validation loss decreased (0.198598 --> 0.198592).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 34 cost time: 0.8408944606781006
Epoch: 34, Steps: 64 | Train Loss: 0.1491990 Vali Loss: 0.1976875 Test Loss: 0.2533280
Validation loss decreased (0.198592 --> 0.197687).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 35 cost time: 0.8600003719329834
Epoch: 35, Steps: 64 | Train Loss: 0.1500795 Vali Loss: 0.1947420 Test Loss: 0.2540501
Validation loss decreased (0.197687 --> 0.194742).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 36 cost time: 0.8556270599365234
Epoch: 36, Steps: 64 | Train Loss: 0.1484894 Vali Loss: 0.1964820 Test Loss: 0.2548757
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 37 cost time: 0.8663685321807861
Epoch: 37, Steps: 64 | Train Loss: 0.1500600 Vali Loss: 0.1972457 Test Loss: 0.2538136
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 38 cost time: 0.8843936920166016
Epoch: 38, Steps: 64 | Train Loss: 0.1489667 Vali Loss: 0.1932436 Test Loss: 0.2506697
Validation loss decreased (0.194742 --> 0.193244).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 39 cost time: 0.8868453502655029
Epoch: 39, Steps: 64 | Train Loss: 0.1484661 Vali Loss: 0.1949253 Test Loss: 0.2525645
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 40 cost time: 0.8927273750305176
Epoch: 40, Steps: 64 | Train Loss: 0.1487598 Vali Loss: 0.1957298 Test Loss: 0.2524955
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 41 cost time: 0.8759992122650146
Epoch: 41, Steps: 64 | Train Loss: 0.1485672 Vali Loss: 0.1943566 Test Loss: 0.2518893
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 42 cost time: 0.8707578182220459
Epoch: 42, Steps: 64 | Train Loss: 0.1482798 Vali Loss: 0.1959671 Test Loss: 0.2534901
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 43 cost time: 0.8611311912536621
Epoch: 43, Steps: 64 | Train Loss: 0.1490489 Vali Loss: 0.1942695 Test Loss: 0.2512795
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 44 cost time: 0.8683667182922363
Epoch: 44, Steps: 64 | Train Loss: 0.1482120 Vali Loss: 0.1944907 Test Loss: 0.2523557
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 45 cost time: 0.8437538146972656
Epoch: 45, Steps: 64 | Train Loss: 0.1487377 Vali Loss: 0.1965431 Test Loss: 0.2526068
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 46 cost time: 0.8260009288787842
Epoch: 46, Steps: 64 | Train Loss: 0.1477364 Vali Loss: 0.1937028 Test Loss: 0.2512422
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 47 cost time: 0.8523671627044678
Epoch: 47, Steps: 64 | Train Loss: 0.1477465 Vali Loss: 0.1928246 Test Loss: 0.2505113
Validation loss decreased (0.193244 --> 0.192825).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 48 cost time: 0.8784055709838867
Epoch: 48, Steps: 64 | Train Loss: 0.1483753 Vali Loss: 0.1955355 Test Loss: 0.2505954
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 49 cost time: 0.8473598957061768
Epoch: 49, Steps: 64 | Train Loss: 0.1480523 Vali Loss: 0.1920818 Test Loss: 0.2492868
Validation loss decreased (0.192825 --> 0.192082).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 50 cost time: 0.8537774085998535
Epoch: 50, Steps: 64 | Train Loss: 0.1476707 Vali Loss: 0.1936349 Test Loss: 0.2532461
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 51 cost time: 0.8551390171051025
Epoch: 51, Steps: 64 | Train Loss: 0.1466936 Vali Loss: 0.1929848 Test Loss: 0.2502752
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 52 cost time: 0.8316404819488525
Epoch: 52, Steps: 64 | Train Loss: 0.1475553 Vali Loss: 0.1916142 Test Loss: 0.2500391
Validation loss decreased (0.192082 --> 0.191614).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 53 cost time: 0.8440561294555664
Epoch: 53, Steps: 64 | Train Loss: 0.1476579 Vali Loss: 0.1905904 Test Loss: 0.2476250
Validation loss decreased (0.191614 --> 0.190590).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 54 cost time: 0.8373849391937256
Epoch: 54, Steps: 64 | Train Loss: 0.1481896 Vali Loss: 0.1926750 Test Loss: 0.2498918
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 55 cost time: 0.8309991359710693
Epoch: 55, Steps: 64 | Train Loss: 0.1479597 Vali Loss: 0.1920443 Test Loss: 0.2503982
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 56 cost time: 0.8430006504058838
Epoch: 56, Steps: 64 | Train Loss: 0.1477955 Vali Loss: 0.1930407 Test Loss: 0.2522156
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 57 cost time: 0.8857629299163818
Epoch: 57, Steps: 64 | Train Loss: 0.1468815 Vali Loss: 0.1932719 Test Loss: 0.2501685
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 58 cost time: 0.8753917217254639
Epoch: 58, Steps: 64 | Train Loss: 0.1477752 Vali Loss: 0.1930134 Test Loss: 0.2500000
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 59 cost time: 0.8863470554351807
Epoch: 59, Steps: 64 | Train Loss: 0.1473956 Vali Loss: 0.1909350 Test Loss: 0.2504042
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 60 cost time: 0.8818259239196777
Epoch: 60, Steps: 64 | Train Loss: 0.1483411 Vali Loss: 0.1933526 Test Loss: 0.2504717
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.24762502312660217, mae:0.3646349012851715, rse:0.25219205021858215
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04050636291503906 GB
Epoch: 1 cost time: 2.330557346343994
Epoch: 1, Steps: 64 | Train Loss: 1.0738840 Vali Loss: 2.8107519 Test Loss: 4.4888153
Validation loss decreased (inf --> 2.810752).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 2 cost time: 0.9664437770843506
Epoch: 2, Steps: 64 | Train Loss: 0.8203596 Vali Loss: 1.5183790 Test Loss: 2.3342228
Validation loss decreased (2.810752 --> 1.518379).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 3 cost time: 0.9590001106262207
Epoch: 3, Steps: 64 | Train Loss: 0.4641108 Vali Loss: 0.7417313 Test Loss: 1.0565360
Validation loss decreased (1.518379 --> 0.741731).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 4 cost time: 0.9636187553405762
Epoch: 4, Steps: 64 | Train Loss: 0.2732212 Vali Loss: 0.4036891 Test Loss: 0.5128590
Validation loss decreased (0.741731 --> 0.403689).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 5 cost time: 0.9472873210906982
Epoch: 5, Steps: 64 | Train Loss: 0.1972877 Vali Loss: 0.2851311 Test Loss: 0.3413564
Validation loss decreased (0.403689 --> 0.285131).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 6 cost time: 0.9361987113952637
Epoch: 6, Steps: 64 | Train Loss: 0.1701554 Vali Loss: 0.2364402 Test Loss: 0.2799033
Validation loss decreased (0.285131 --> 0.236440).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 7 cost time: 0.9319944381713867
Epoch: 7, Steps: 64 | Train Loss: 0.1590964 Vali Loss: 0.2165944 Test Loss: 0.2589513
Validation loss decreased (0.236440 --> 0.216594).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 8 cost time: 0.9253818988800049
Epoch: 8, Steps: 64 | Train Loss: 0.1525894 Vali Loss: 0.2024700 Test Loss: 0.2498074
Validation loss decreased (0.216594 --> 0.202470).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 9 cost time: 0.9397354125976562
Epoch: 9, Steps: 64 | Train Loss: 0.1479142 Vali Loss: 0.1924133 Test Loss: 0.2414912
Validation loss decreased (0.202470 --> 0.192413).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 10 cost time: 0.9637274742126465
Epoch: 10, Steps: 64 | Train Loss: 0.1443772 Vali Loss: 0.1885885 Test Loss: 0.2374443
Validation loss decreased (0.192413 --> 0.188589).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 11 cost time: 0.968409538269043
Epoch: 11, Steps: 64 | Train Loss: 0.1416685 Vali Loss: 0.1816970 Test Loss: 0.2323277
Validation loss decreased (0.188589 --> 0.181697).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 12 cost time: 0.9736120700836182
Epoch: 12, Steps: 64 | Train Loss: 0.1386712 Vali Loss: 0.1825339 Test Loss: 0.2316711
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 13 cost time: 0.9736239910125732
Epoch: 13, Steps: 64 | Train Loss: 0.1371463 Vali Loss: 0.1817581 Test Loss: 0.2298162
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 14 cost time: 0.9533901214599609
Epoch: 14, Steps: 64 | Train Loss: 0.1354617 Vali Loss: 0.1798429 Test Loss: 0.2327979
Validation loss decreased (0.181697 --> 0.179843).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 15 cost time: 0.9544167518615723
Epoch: 15, Steps: 64 | Train Loss: 0.1351768 Vali Loss: 0.1788411 Test Loss: 0.2293482
Validation loss decreased (0.179843 --> 0.178841).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 16 cost time: 0.9603979587554932
Epoch: 16, Steps: 64 | Train Loss: 0.1334995 Vali Loss: 0.1784621 Test Loss: 0.2286345
Validation loss decreased (0.178841 --> 0.178462).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 17 cost time: 0.9574744701385498
Epoch: 17, Steps: 64 | Train Loss: 0.1327150 Vali Loss: 0.1781799 Test Loss: 0.2299623
Validation loss decreased (0.178462 --> 0.178180).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 18 cost time: 0.9674413204193115
Epoch: 18, Steps: 64 | Train Loss: 0.1325217 Vali Loss: 0.1760465 Test Loss: 0.2307430
Validation loss decreased (0.178180 --> 0.176046).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 19 cost time: 0.9783570766448975
Epoch: 19, Steps: 64 | Train Loss: 0.1315134 Vali Loss: 0.1774025 Test Loss: 0.2296214
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 20 cost time: 0.9550004005432129
Epoch: 20, Steps: 64 | Train Loss: 0.1303483 Vali Loss: 0.1765417 Test Loss: 0.2283158
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 21 cost time: 0.9560000896453857
Epoch: 21, Steps: 64 | Train Loss: 0.1303614 Vali Loss: 0.1766066 Test Loss: 0.2294099
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 22 cost time: 0.9356215000152588
Epoch: 22, Steps: 64 | Train Loss: 0.1301557 Vali Loss: 0.1764806 Test Loss: 0.2287465
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 23 cost time: 0.9327731132507324
Epoch: 23, Steps: 64 | Train Loss: 0.1297685 Vali Loss: 0.1772736 Test Loss: 0.2290197
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 24 cost time: 0.936500072479248
Epoch: 24, Steps: 64 | Train Loss: 0.1296879 Vali Loss: 0.1769284 Test Loss: 0.2277001
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 25 cost time: 0.9304831027984619
Epoch: 25, Steps: 64 | Train Loss: 0.1291329 Vali Loss: 0.1780232 Test Loss: 0.2303712
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 26 cost time: 0.9403669834136963
Epoch: 26, Steps: 64 | Train Loss: 0.1285703 Vali Loss: 0.1759306 Test Loss: 0.2303445
Validation loss decreased (0.176046 --> 0.175931).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 27 cost time: 0.9537665843963623
Epoch: 27, Steps: 64 | Train Loss: 0.1280567 Vali Loss: 0.1764536 Test Loss: 0.2286059
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 28 cost time: 0.9440004825592041
Epoch: 28, Steps: 64 | Train Loss: 0.1279519 Vali Loss: 0.1744836 Test Loss: 0.2282429
Validation loss decreased (0.175931 --> 0.174484).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 29 cost time: 0.9539999961853027
Epoch: 29, Steps: 64 | Train Loss: 0.1277987 Vali Loss: 0.1778131 Test Loss: 0.2291272
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 30 cost time: 0.9816250801086426
Epoch: 30, Steps: 64 | Train Loss: 0.1272541 Vali Loss: 0.1775268 Test Loss: 0.2302187
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 31 cost time: 0.9513776302337646
Epoch: 31, Steps: 64 | Train Loss: 0.1279308 Vali Loss: 0.1758647 Test Loss: 0.2287228
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 32 cost time: 0.9493601322174072
Epoch: 32, Steps: 64 | Train Loss: 0.1276550 Vali Loss: 0.1761895 Test Loss: 0.2288065
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 33 cost time: 0.971454381942749
Epoch: 33, Steps: 64 | Train Loss: 0.1270742 Vali Loss: 0.1751328 Test Loss: 0.2287247
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 34 cost time: 0.9755353927612305
Epoch: 34, Steps: 64 | Train Loss: 0.1278196 Vali Loss: 0.1752543 Test Loss: 0.2278434
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 35 cost time: 0.9743678569793701
Epoch: 35, Steps: 64 | Train Loss: 0.1266740 Vali Loss: 0.1743074 Test Loss: 0.2277420
Validation loss decreased (0.174484 --> 0.174307).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 36 cost time: 0.9821314811706543
Epoch: 36, Steps: 64 | Train Loss: 0.1264075 Vali Loss: 0.1751291 Test Loss: 0.2277432
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 37 cost time: 0.989753007888794
Epoch: 37, Steps: 64 | Train Loss: 0.1270753 Vali Loss: 0.1760186 Test Loss: 0.2285834
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 38 cost time: 0.9847886562347412
Epoch: 38, Steps: 64 | Train Loss: 0.1262278 Vali Loss: 0.1740917 Test Loss: 0.2276714
Validation loss decreased (0.174307 --> 0.174092).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 39 cost time: 0.9640014171600342
Epoch: 39, Steps: 64 | Train Loss: 0.1264454 Vali Loss: 0.1763186 Test Loss: 0.2283878
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 40 cost time: 0.9191076755523682
Epoch: 40, Steps: 64 | Train Loss: 0.1266842 Vali Loss: 0.1750772 Test Loss: 0.2286204
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 41 cost time: 0.9163775444030762
Epoch: 41, Steps: 64 | Train Loss: 0.1264229 Vali Loss: 0.1744902 Test Loss: 0.2280762
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 42 cost time: 0.9403703212738037
Epoch: 42, Steps: 64 | Train Loss: 0.1264501 Vali Loss: 0.1743280 Test Loss: 0.2279756
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 43 cost time: 0.9364681243896484
Epoch: 43, Steps: 64 | Train Loss: 0.1260279 Vali Loss: 0.1735624 Test Loss: 0.2274632
Validation loss decreased (0.174092 --> 0.173562).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 44 cost time: 0.9487457275390625
Epoch: 44, Steps: 64 | Train Loss: 0.1267578 Vali Loss: 0.1754022 Test Loss: 0.2285675
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 45 cost time: 0.9487628936767578
Epoch: 45, Steps: 64 | Train Loss: 0.1263691 Vali Loss: 0.1758407 Test Loss: 0.2288963
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 46 cost time: 0.9627518653869629
Epoch: 46, Steps: 64 | Train Loss: 0.1262136 Vali Loss: 0.1752973 Test Loss: 0.2285018
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 47 cost time: 0.9459996223449707
Epoch: 47, Steps: 64 | Train Loss: 0.1261316 Vali Loss: 0.1750157 Test Loss: 0.2292912
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 48 cost time: 0.9306435585021973
Epoch: 48, Steps: 64 | Train Loss: 0.1266410 Vali Loss: 0.1735835 Test Loss: 0.2277723
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 49 cost time: 0.9435245990753174
Epoch: 49, Steps: 64 | Train Loss: 0.1263030 Vali Loss: 0.1745321 Test Loss: 0.2288079
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 50 cost time: 0.9601321220397949
Epoch: 50, Steps: 64 | Train Loss: 0.1262338 Vali Loss: 0.1749427 Test Loss: 0.2284700
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 51 cost time: 0.95438551902771
Epoch: 51, Steps: 64 | Train Loss: 0.1259577 Vali Loss: 0.1746021 Test Loss: 0.2287506
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 52 cost time: 0.9703772068023682
Epoch: 52, Steps: 64 | Train Loss: 0.1264274 Vali Loss: 0.1769584 Test Loss: 0.2296730
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 53 cost time: 0.9858298301696777
Epoch: 53, Steps: 64 | Train Loss: 0.1263476 Vali Loss: 0.1752797 Test Loss: 0.2288173
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 54 cost time: 0.9687681198120117
Epoch: 54, Steps: 64 | Train Loss: 0.1257987 Vali Loss: 0.1748395 Test Loss: 0.2286905
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 55 cost time: 0.9727818965911865
Epoch: 55, Steps: 64 | Train Loss: 0.1260429 Vali Loss: 0.1763773 Test Loss: 0.2293201
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 56 cost time: 0.9549999237060547
Epoch: 56, Steps: 64 | Train Loss: 0.1270081 Vali Loss: 0.1765108 Test Loss: 0.2294205
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 57 cost time: 0.9461297988891602
Epoch: 57, Steps: 64 | Train Loss: 0.1260424 Vali Loss: 0.1758009 Test Loss: 0.2289721
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 58 cost time: 0.9443850517272949
Epoch: 58, Steps: 64 | Train Loss: 0.1263126 Vali Loss: 0.1736119 Test Loss: 0.2272396
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 59 cost time: 0.9213657379150391
Epoch: 59, Steps: 64 | Train Loss: 0.1261307 Vali Loss: 0.1745431 Test Loss: 0.2280460
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 60 cost time: 0.9343674182891846
Epoch: 60, Steps: 64 | Train Loss: 0.1269846 Vali Loss: 0.1748479 Test Loss: 0.2281340
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22746317088603973, mae:0.33978238701820374, rse:0.24170726537704468
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04107046127319336 GB
Epoch: 1 cost time: 2.322148561477661
Epoch: 1, Steps: 64 | Train Loss: 0.9683447 Vali Loss: 2.6240246 Test Loss: 4.2307916
Validation loss decreased (inf --> 2.624025).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 2 cost time: 0.9760696887969971
Epoch: 2, Steps: 64 | Train Loss: 0.7733721 Vali Loss: 1.5363617 Test Loss: 2.4059510
Validation loss decreased (2.624025 --> 1.536362).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 3 cost time: 0.974719762802124
Epoch: 3, Steps: 64 | Train Loss: 0.4536279 Vali Loss: 0.7376289 Test Loss: 1.0687134
Validation loss decreased (1.536362 --> 0.737629).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 4 cost time: 0.973773717880249
Epoch: 4, Steps: 64 | Train Loss: 0.2471114 Vali Loss: 0.3488238 Test Loss: 0.4347535
Validation loss decreased (0.737629 --> 0.348824).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 5 cost time: 0.9609999656677246
Epoch: 5, Steps: 64 | Train Loss: 0.1705664 Vali Loss: 0.2399940 Test Loss: 0.2824357
Validation loss decreased (0.348824 --> 0.239994).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 6 cost time: 0.9510438442230225
Epoch: 6, Steps: 64 | Train Loss: 0.1524190 Vali Loss: 0.2049351 Test Loss: 0.2553986
Validation loss decreased (0.239994 --> 0.204935).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 7 cost time: 0.9476349353790283
Epoch: 7, Steps: 64 | Train Loss: 0.1449423 Vali Loss: 0.1936793 Test Loss: 0.2442160
Validation loss decreased (0.204935 --> 0.193679).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 8 cost time: 0.9513866901397705
Epoch: 8, Steps: 64 | Train Loss: 0.1405290 Vali Loss: 0.1886241 Test Loss: 0.2414233
Validation loss decreased (0.193679 --> 0.188624).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 9 cost time: 0.9543821811676025
Epoch: 9, Steps: 64 | Train Loss: 0.1377076 Vali Loss: 0.1853941 Test Loss: 0.2401941
Validation loss decreased (0.188624 --> 0.185394).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 10 cost time: 0.9874253273010254
Epoch: 10, Steps: 64 | Train Loss: 0.1361942 Vali Loss: 0.1807146 Test Loss: 0.2364049
Validation loss decreased (0.185394 --> 0.180715).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 11 cost time: 0.9913647174835205
Epoch: 11, Steps: 64 | Train Loss: 0.1344002 Vali Loss: 0.1810683 Test Loss: 0.2348795
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 12 cost time: 0.9994814395904541
Epoch: 12, Steps: 64 | Train Loss: 0.1317007 Vali Loss: 0.1807595 Test Loss: 0.2346949
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 13 cost time: 1.0080125331878662
Epoch: 13, Steps: 64 | Train Loss: 0.1312432 Vali Loss: 0.1800220 Test Loss: 0.2342612
Validation loss decreased (0.180715 --> 0.180022).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 14 cost time: 0.9787483215332031
Epoch: 14, Steps: 64 | Train Loss: 0.1303693 Vali Loss: 0.1762309 Test Loss: 0.2344557
Validation loss decreased (0.180022 --> 0.176231).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 15 cost time: 0.9754204750061035
Epoch: 15, Steps: 64 | Train Loss: 0.1290913 Vali Loss: 0.1757491 Test Loss: 0.2334177
Validation loss decreased (0.176231 --> 0.175749).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 16 cost time: 0.9820022583007812
Epoch: 16, Steps: 64 | Train Loss: 0.1283146 Vali Loss: 0.1764642 Test Loss: 0.2325989
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 17 cost time: 0.9716427326202393
Epoch: 17, Steps: 64 | Train Loss: 0.1272217 Vali Loss: 0.1733494 Test Loss: 0.2320392
Validation loss decreased (0.175749 --> 0.173349).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 18 cost time: 0.9916462898254395
Epoch: 18, Steps: 64 | Train Loss: 0.1271451 Vali Loss: 0.1727379 Test Loss: 0.2319071
Validation loss decreased (0.173349 --> 0.172738).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 19 cost time: 0.9860811233520508
Epoch: 19, Steps: 64 | Train Loss: 0.1270489 Vali Loss: 0.1720339 Test Loss: 0.2306888
Validation loss decreased (0.172738 --> 0.172034).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 20 cost time: 0.9663910865783691
Epoch: 20, Steps: 64 | Train Loss: 0.1263910 Vali Loss: 0.1751603 Test Loss: 0.2316021
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 21 cost time: 0.967388391494751
Epoch: 21, Steps: 64 | Train Loss: 0.1255273 Vali Loss: 0.1726612 Test Loss: 0.2309090
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 22 cost time: 0.9463686943054199
Epoch: 22, Steps: 64 | Train Loss: 0.1254340 Vali Loss: 0.1717243 Test Loss: 0.2309229
Validation loss decreased (0.172034 --> 0.171724).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 23 cost time: 0.9667723178863525
Epoch: 23, Steps: 64 | Train Loss: 0.1246223 Vali Loss: 0.1703769 Test Loss: 0.2298755
Validation loss decreased (0.171724 --> 0.170377).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 24 cost time: 0.9513673782348633
Epoch: 24, Steps: 64 | Train Loss: 0.1249619 Vali Loss: 0.1730489 Test Loss: 0.2304474
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 25 cost time: 0.945734977722168
Epoch: 25, Steps: 64 | Train Loss: 0.1243979 Vali Loss: 0.1737524 Test Loss: 0.2305481
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 26 cost time: 0.9819986820220947
Epoch: 26, Steps: 64 | Train Loss: 0.1238601 Vali Loss: 0.1706123 Test Loss: 0.2312681
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 27 cost time: 0.9801015853881836
Epoch: 27, Steps: 64 | Train Loss: 0.1239773 Vali Loss: 0.1719285 Test Loss: 0.2302097
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 28 cost time: 0.9996380805969238
Epoch: 28, Steps: 64 | Train Loss: 0.1236644 Vali Loss: 0.1721256 Test Loss: 0.2313425
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 29 cost time: 0.9935264587402344
Epoch: 29, Steps: 64 | Train Loss: 0.1232811 Vali Loss: 0.1732343 Test Loss: 0.2314330
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 30 cost time: 0.9943931102752686
Epoch: 30, Steps: 64 | Train Loss: 0.1234444 Vali Loss: 0.1721217 Test Loss: 0.2302878
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 31 cost time: 0.9756574630737305
Epoch: 31, Steps: 64 | Train Loss: 0.1236036 Vali Loss: 0.1742613 Test Loss: 0.2305848
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 32 cost time: 0.9853854179382324
Epoch: 32, Steps: 64 | Train Loss: 0.1227295 Vali Loss: 0.1724351 Test Loss: 0.2297437
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 33 cost time: 0.9803810119628906
Epoch: 33, Steps: 64 | Train Loss: 0.1224847 Vali Loss: 0.1725358 Test Loss: 0.2293435
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 34 cost time: 0.9763853549957275
Epoch: 34, Steps: 64 | Train Loss: 0.1227210 Vali Loss: 0.1710956 Test Loss: 0.2297690
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 35 cost time: 1.0031802654266357
Epoch: 35, Steps: 64 | Train Loss: 0.1225053 Vali Loss: 0.1724523 Test Loss: 0.2293998
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 36 cost time: 1.001718521118164
Epoch: 36, Steps: 64 | Train Loss: 0.1226250 Vali Loss: 0.1711688 Test Loss: 0.2304198
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 37 cost time: 0.993999719619751
Epoch: 37, Steps: 64 | Train Loss: 0.1230992 Vali Loss: 0.1721846 Test Loss: 0.2302563
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 38 cost time: 0.9719996452331543
Epoch: 38, Steps: 64 | Train Loss: 0.1225574 Vali Loss: 0.1721953 Test Loss: 0.2292204
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 39 cost time: 0.9490547180175781
Epoch: 39, Steps: 64 | Train Loss: 0.1219779 Vali Loss: 0.1702015 Test Loss: 0.2292556
Validation loss decreased (0.170377 --> 0.170201).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 40 cost time: 0.9494199752807617
Epoch: 40, Steps: 64 | Train Loss: 0.1227411 Vali Loss: 0.1730583 Test Loss: 0.2298553
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 41 cost time: 0.9453608989715576
Epoch: 41, Steps: 64 | Train Loss: 0.1226557 Vali Loss: 0.1721717 Test Loss: 0.2304352
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 42 cost time: 0.9414045810699463
Epoch: 42, Steps: 64 | Train Loss: 0.1222454 Vali Loss: 0.1723492 Test Loss: 0.2299717
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 43 cost time: 0.9754214286804199
Epoch: 43, Steps: 64 | Train Loss: 0.1224664 Vali Loss: 0.1722792 Test Loss: 0.2289347
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 44 cost time: 0.9813921451568604
Epoch: 44, Steps: 64 | Train Loss: 0.1222946 Vali Loss: 0.1712427 Test Loss: 0.2310790
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 45 cost time: 0.9717392921447754
Epoch: 45, Steps: 64 | Train Loss: 0.1218068 Vali Loss: 0.1719671 Test Loss: 0.2308176
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 46 cost time: 0.9827256202697754
Epoch: 46, Steps: 64 | Train Loss: 0.1226102 Vali Loss: 0.1713450 Test Loss: 0.2302858
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 47 cost time: 0.9664106369018555
Epoch: 47, Steps: 64 | Train Loss: 0.1225406 Vali Loss: 0.1709268 Test Loss: 0.2296917
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 48 cost time: 0.9726502895355225
Epoch: 48, Steps: 64 | Train Loss: 0.1226626 Vali Loss: 0.1713406 Test Loss: 0.2284455
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 49 cost time: 0.9816319942474365
Epoch: 49, Steps: 64 | Train Loss: 0.1220234 Vali Loss: 0.1720875 Test Loss: 0.2287410
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 50 cost time: 0.9763617515563965
Epoch: 50, Steps: 64 | Train Loss: 0.1219475 Vali Loss: 0.1731271 Test Loss: 0.2298421
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 51 cost time: 0.9888255596160889
Epoch: 51, Steps: 64 | Train Loss: 0.1221761 Vali Loss: 0.1721743 Test Loss: 0.2299526
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 52 cost time: 1.0033588409423828
Epoch: 52, Steps: 64 | Train Loss: 0.1220826 Vali Loss: 0.1708334 Test Loss: 0.2293944
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 53 cost time: 1.0055019855499268
Epoch: 53, Steps: 64 | Train Loss: 0.1215273 Vali Loss: 0.1706942 Test Loss: 0.2291990
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 54 cost time: 0.9964032173156738
Epoch: 54, Steps: 64 | Train Loss: 0.1215971 Vali Loss: 0.1718425 Test Loss: 0.2294009
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 55 cost time: 1.0024309158325195
Epoch: 55, Steps: 64 | Train Loss: 0.1217777 Vali Loss: 0.1725716 Test Loss: 0.2293580
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 56 cost time: 0.9884161949157715
Epoch: 56, Steps: 64 | Train Loss: 0.1216672 Vali Loss: 0.1726306 Test Loss: 0.2295420
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 57 cost time: 0.9457788467407227
Epoch: 57, Steps: 64 | Train Loss: 0.1222902 Vali Loss: 0.1717874 Test Loss: 0.2293575
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 58 cost time: 0.9570009708404541
Epoch: 58, Steps: 64 | Train Loss: 0.1215821 Vali Loss: 0.1721185 Test Loss: 0.2293507
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 59 cost time: 0.959688663482666
Epoch: 59, Steps: 64 | Train Loss: 0.1218090 Vali Loss: 0.1699714 Test Loss: 0.2291760
Validation loss decreased (0.170201 --> 0.169971).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 60 cost time: 0.9796316623687744
Epoch: 60, Steps: 64 | Train Loss: 0.1217266 Vali Loss: 0.1709397 Test Loss: 0.2294706
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22917599976062775, mae:0.3434258997440338, rse:0.24261559545993805
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.03996562957763672 GB
Epoch: 1 cost time: 2.301130533218384
Epoch: 1, Steps: 64 | Train Loss: 1.0035382 Vali Loss: 2.2822716 Test Loss: 3.4196575
Validation loss decreased (inf --> 2.282272).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 2 cost time: 0.952552080154419
Epoch: 2, Steps: 64 | Train Loss: 0.7351574 Vali Loss: 1.1013383 Test Loss: 1.5802538
Validation loss decreased (2.282272 --> 1.101338).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 3 cost time: 0.9313740730285645
Epoch: 3, Steps: 64 | Train Loss: 0.4617443 Vali Loss: 0.7349536 Test Loss: 0.9936647
Validation loss decreased (1.101338 --> 0.734954).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 4 cost time: 0.9303815364837646
Epoch: 4, Steps: 64 | Train Loss: 0.3437261 Vali Loss: 0.5554980 Test Loss: 0.7109531
Validation loss decreased (0.734954 --> 0.555498).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 5 cost time: 0.9254457950592041
Epoch: 5, Steps: 64 | Train Loss: 0.2753336 Vali Loss: 0.4403787 Test Loss: 0.5484520
Validation loss decreased (0.555498 --> 0.440379).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 6 cost time: 0.9138257503509521
Epoch: 6, Steps: 64 | Train Loss: 0.2361442 Vali Loss: 0.3554931 Test Loss: 0.4370566
Validation loss decreased (0.440379 --> 0.355493).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 7 cost time: 0.9660000801086426
Epoch: 7, Steps: 64 | Train Loss: 0.2110449 Vali Loss: 0.3064526 Test Loss: 0.3701481
Validation loss decreased (0.355493 --> 0.306453).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 8 cost time: 0.9587938785552979
Epoch: 8, Steps: 64 | Train Loss: 0.1952838 Vali Loss: 0.2699139 Test Loss: 0.3296583
Validation loss decreased (0.306453 --> 0.269914).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 9 cost time: 0.9702496528625488
Epoch: 9, Steps: 64 | Train Loss: 0.1840136 Vali Loss: 0.2490782 Test Loss: 0.3019301
Validation loss decreased (0.269914 --> 0.249078).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 10 cost time: 0.9394094944000244
Epoch: 10, Steps: 64 | Train Loss: 0.1764478 Vali Loss: 0.2376277 Test Loss: 0.2833858
Validation loss decreased (0.249078 --> 0.237628).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 11 cost time: 0.9684281349182129
Epoch: 11, Steps: 64 | Train Loss: 0.1707630 Vali Loss: 0.2246029 Test Loss: 0.2708059
Validation loss decreased (0.237628 --> 0.224603).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 12 cost time: 0.9711523056030273
Epoch: 12, Steps: 64 | Train Loss: 0.1675454 Vali Loss: 0.2140722 Test Loss: 0.2614008
Validation loss decreased (0.224603 --> 0.214072).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 13 cost time: 0.9774391651153564
Epoch: 13, Steps: 64 | Train Loss: 0.1631437 Vali Loss: 0.2081657 Test Loss: 0.2517409
Validation loss decreased (0.214072 --> 0.208166).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 14 cost time: 0.9474954605102539
Epoch: 14, Steps: 64 | Train Loss: 0.1606864 Vali Loss: 0.2088462 Test Loss: 0.2520368
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 15 cost time: 0.9297792911529541
Epoch: 15, Steps: 64 | Train Loss: 0.1589448 Vali Loss: 0.2017411 Test Loss: 0.2450430
Validation loss decreased (0.208166 --> 0.201741).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 16 cost time: 0.9317336082458496
Epoch: 16, Steps: 64 | Train Loss: 0.1571134 Vali Loss: 0.1967745 Test Loss: 0.2413999
Validation loss decreased (0.201741 --> 0.196775).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 17 cost time: 0.9309954643249512
Epoch: 17, Steps: 64 | Train Loss: 0.1562787 Vali Loss: 0.1965593 Test Loss: 0.2390771
Validation loss decreased (0.196775 --> 0.196559).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 18 cost time: 0.9586434364318848
Epoch: 18, Steps: 64 | Train Loss: 0.1539445 Vali Loss: 0.1952442 Test Loss: 0.2382110
Validation loss decreased (0.196559 --> 0.195244).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 19 cost time: 0.9573690891265869
Epoch: 19, Steps: 64 | Train Loss: 0.1530628 Vali Loss: 0.1913939 Test Loss: 0.2350834
Validation loss decreased (0.195244 --> 0.191394).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 20 cost time: 0.945443868637085
Epoch: 20, Steps: 64 | Train Loss: 0.1521275 Vali Loss: 0.1921701 Test Loss: 0.2362384
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 21 cost time: 0.931441068649292
Epoch: 21, Steps: 64 | Train Loss: 0.1514443 Vali Loss: 0.1913742 Test Loss: 0.2342149
Validation loss decreased (0.191394 --> 0.191374).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 22 cost time: 0.9160130023956299
Epoch: 22, Steps: 64 | Train Loss: 0.1505741 Vali Loss: 0.1896323 Test Loss: 0.2324334
Validation loss decreased (0.191374 --> 0.189632).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 23 cost time: 0.9093806743621826
Epoch: 23, Steps: 64 | Train Loss: 0.1505875 Vali Loss: 0.1878111 Test Loss: 0.2316020
Validation loss decreased (0.189632 --> 0.187811).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 24 cost time: 0.9057354927062988
Epoch: 24, Steps: 64 | Train Loss: 0.1490401 Vali Loss: 0.1860738 Test Loss: 0.2314975
Validation loss decreased (0.187811 --> 0.186074).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 25 cost time: 0.8970012664794922
Epoch: 25, Steps: 64 | Train Loss: 0.1488786 Vali Loss: 0.1869525 Test Loss: 0.2319359
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 26 cost time: 0.9132769107818604
Epoch: 26, Steps: 64 | Train Loss: 0.1475965 Vali Loss: 0.1879618 Test Loss: 0.2315962
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 27 cost time: 0.9303879737854004
Epoch: 27, Steps: 64 | Train Loss: 0.1481830 Vali Loss: 0.1846036 Test Loss: 0.2289958
Validation loss decreased (0.186074 --> 0.184604).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 28 cost time: 0.9263710975646973
Epoch: 28, Steps: 64 | Train Loss: 0.1467373 Vali Loss: 0.1880431 Test Loss: 0.2324995
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 29 cost time: 0.9304018020629883
Epoch: 29, Steps: 64 | Train Loss: 0.1472521 Vali Loss: 0.1854675 Test Loss: 0.2295383
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 30 cost time: 0.9423744678497314
Epoch: 30, Steps: 64 | Train Loss: 0.1472117 Vali Loss: 0.1839899 Test Loss: 0.2281066
Validation loss decreased (0.184604 --> 0.183990).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 31 cost time: 0.9347643852233887
Epoch: 31, Steps: 64 | Train Loss: 0.1471014 Vali Loss: 0.1827322 Test Loss: 0.2269994
Validation loss decreased (0.183990 --> 0.182732).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 32 cost time: 0.927001953125
Epoch: 32, Steps: 64 | Train Loss: 0.1461236 Vali Loss: 0.1848353 Test Loss: 0.2288448
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 33 cost time: 0.9366276264190674
Epoch: 33, Steps: 64 | Train Loss: 0.1461607 Vali Loss: 0.1840181 Test Loss: 0.2279902
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 34 cost time: 0.9263825416564941
Epoch: 34, Steps: 64 | Train Loss: 0.1455589 Vali Loss: 0.1817875 Test Loss: 0.2269992
Validation loss decreased (0.182732 --> 0.181787).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 35 cost time: 0.9443895816802979
Epoch: 35, Steps: 64 | Train Loss: 0.1452700 Vali Loss: 0.1830187 Test Loss: 0.2280756
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 36 cost time: 0.9584391117095947
Epoch: 36, Steps: 64 | Train Loss: 0.1450454 Vali Loss: 0.1836897 Test Loss: 0.2284350
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 37 cost time: 0.9713647365570068
Epoch: 37, Steps: 64 | Train Loss: 0.1454169 Vali Loss: 0.1816699 Test Loss: 0.2288906
Validation loss decreased (0.181787 --> 0.181670).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 38 cost time: 0.9638862609863281
Epoch: 38, Steps: 64 | Train Loss: 0.1453833 Vali Loss: 0.1797043 Test Loss: 0.2268275
Validation loss decreased (0.181670 --> 0.179704).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 39 cost time: 0.9735171794891357
Epoch: 39, Steps: 64 | Train Loss: 0.1439169 Vali Loss: 0.1811754 Test Loss: 0.2272547
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 40 cost time: 0.946812629699707
Epoch: 40, Steps: 64 | Train Loss: 0.1448542 Vali Loss: 0.1845166 Test Loss: 0.2271882
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 41 cost time: 0.9140269756317139
Epoch: 41, Steps: 64 | Train Loss: 0.1448221 Vali Loss: 0.1824501 Test Loss: 0.2260174
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 42 cost time: 0.9166183471679688
Epoch: 42, Steps: 64 | Train Loss: 0.1456529 Vali Loss: 0.1818106 Test Loss: 0.2258690
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 43 cost time: 0.9196317195892334
Epoch: 43, Steps: 64 | Train Loss: 0.1445284 Vali Loss: 0.1807345 Test Loss: 0.2271236
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 44 cost time: 0.9374277591705322
Epoch: 44, Steps: 64 | Train Loss: 0.1445110 Vali Loss: 0.1817007 Test Loss: 0.2266382
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 45 cost time: 0.9264280796051025
Epoch: 45, Steps: 64 | Train Loss: 0.1441145 Vali Loss: 0.1809078 Test Loss: 0.2267141
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 46 cost time: 0.9153871536254883
Epoch: 46, Steps: 64 | Train Loss: 0.1445997 Vali Loss: 0.1790082 Test Loss: 0.2263705
Validation loss decreased (0.179704 --> 0.179008).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 47 cost time: 0.936368465423584
Epoch: 47, Steps: 64 | Train Loss: 0.1444073 Vali Loss: 0.1816542 Test Loss: 0.2274506
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 48 cost time: 0.9119987487792969
Epoch: 48, Steps: 64 | Train Loss: 0.1439337 Vali Loss: 0.1804798 Test Loss: 0.2260898
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 49 cost time: 0.9036417007446289
Epoch: 49, Steps: 64 | Train Loss: 0.1434254 Vali Loss: 0.1824469 Test Loss: 0.2263031
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 50 cost time: 0.9174044132232666
Epoch: 50, Steps: 64 | Train Loss: 0.1441405 Vali Loss: 0.1809232 Test Loss: 0.2260296
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 51 cost time: 0.9300165176391602
Epoch: 51, Steps: 64 | Train Loss: 0.1444778 Vali Loss: 0.1811642 Test Loss: 0.2268100
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 52 cost time: 0.940716028213501
Epoch: 52, Steps: 64 | Train Loss: 0.1442050 Vali Loss: 0.1823439 Test Loss: 0.2276021
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 53 cost time: 0.9554190635681152
Epoch: 53, Steps: 64 | Train Loss: 0.1441814 Vali Loss: 0.1811667 Test Loss: 0.2254112
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 54 cost time: 0.9664287567138672
Epoch: 54, Steps: 64 | Train Loss: 0.1444199 Vali Loss: 0.1829820 Test Loss: 0.2287418
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 55 cost time: 0.9587030410766602
Epoch: 55, Steps: 64 | Train Loss: 0.1436143 Vali Loss: 0.1820467 Test Loss: 0.2261679
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 56 cost time: 0.9443755149841309
Epoch: 56, Steps: 64 | Train Loss: 0.1439373 Vali Loss: 0.1839423 Test Loss: 0.2273467
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 57 cost time: 0.9336304664611816
Epoch: 57, Steps: 64 | Train Loss: 0.1444926 Vali Loss: 0.1804588 Test Loss: 0.2270904
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 58 cost time: 0.9316408634185791
Epoch: 58, Steps: 64 | Train Loss: 0.1440138 Vali Loss: 0.1816487 Test Loss: 0.2267158
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 59 cost time: 0.9233932495117188
Epoch: 59, Steps: 64 | Train Loss: 0.1443293 Vali Loss: 0.1816023 Test Loss: 0.2275906
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 60 cost time: 0.9124319553375244
Epoch: 60, Steps: 64 | Train Loss: 0.1435953 Vali Loss: 0.1847478 Test Loss: 0.2287310
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22637046873569489, mae:0.3315119445323944, rse:0.24112600088119507
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.040667057037353516 GB
Epoch: 1 cost time: 2.3193819522857666
Epoch: 1, Steps: 64 | Train Loss: 0.9377585 Vali Loss: 2.4139340 Test Loss: 3.7900784
Validation loss decreased (inf --> 2.413934).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 2 cost time: 0.9453845024108887
Epoch: 2, Steps: 64 | Train Loss: 0.7106223 Vali Loss: 1.2636058 Test Loss: 1.8784274
Validation loss decreased (2.413934 --> 1.263606).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 3 cost time: 0.9667224884033203
Epoch: 3, Steps: 64 | Train Loss: 0.4185124 Vali Loss: 0.7053005 Test Loss: 0.9755849
Validation loss decreased (1.263606 --> 0.705300).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 4 cost time: 0.9603700637817383
Epoch: 4, Steps: 64 | Train Loss: 0.2588414 Vali Loss: 0.3975360 Test Loss: 0.5070276
Validation loss decreased (0.705300 --> 0.397536).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 5 cost time: 0.9372153282165527
Epoch: 5, Steps: 64 | Train Loss: 0.1884635 Vali Loss: 0.2734500 Test Loss: 0.3318470
Validation loss decreased (0.397536 --> 0.273450).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 6 cost time: 0.9176385402679443
Epoch: 6, Steps: 64 | Train Loss: 0.1620104 Vali Loss: 0.2275246 Test Loss: 0.2758295
Validation loss decreased (0.273450 --> 0.227525).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 7 cost time: 0.9413859844207764
Epoch: 7, Steps: 64 | Train Loss: 0.1514020 Vali Loss: 0.2074377 Test Loss: 0.2470942
Validation loss decreased (0.227525 --> 0.207438).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 8 cost time: 0.9295110702514648
Epoch: 8, Steps: 64 | Train Loss: 0.1443357 Vali Loss: 0.1989549 Test Loss: 0.2450664
Validation loss decreased (0.207438 --> 0.198955).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 9 cost time: 0.9350664615631104
Epoch: 9, Steps: 64 | Train Loss: 0.1402784 Vali Loss: 0.1875061 Test Loss: 0.2327824
Validation loss decreased (0.198955 --> 0.187506).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 10 cost time: 0.9563257694244385
Epoch: 10, Steps: 64 | Train Loss: 0.1376114 Vali Loss: 0.1846942 Test Loss: 0.2327727
Validation loss decreased (0.187506 --> 0.184694).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 11 cost time: 0.9883859157562256
Epoch: 11, Steps: 64 | Train Loss: 0.1346151 Vali Loss: 0.1851169 Test Loss: 0.2362505
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 12 cost time: 0.9904401302337646
Epoch: 12, Steps: 64 | Train Loss: 0.1332958 Vali Loss: 0.1839873 Test Loss: 0.2316463
Validation loss decreased (0.184694 --> 0.183987).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 13 cost time: 0.9844217300415039
Epoch: 13, Steps: 64 | Train Loss: 0.1321471 Vali Loss: 0.1768648 Test Loss: 0.2282747
Validation loss decreased (0.183987 --> 0.176865).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 14 cost time: 0.9746956825256348
Epoch: 14, Steps: 64 | Train Loss: 0.1309798 Vali Loss: 0.1789777 Test Loss: 0.2305553
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 15 cost time: 0.9590010643005371
Epoch: 15, Steps: 64 | Train Loss: 0.1297697 Vali Loss: 0.1797276 Test Loss: 0.2316051
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 16 cost time: 0.9546351432800293
Epoch: 16, Steps: 64 | Train Loss: 0.1281950 Vali Loss: 0.1778587 Test Loss: 0.2305002
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 17 cost time: 0.9610981941223145
Epoch: 17, Steps: 64 | Train Loss: 0.1272282 Vali Loss: 0.1767361 Test Loss: 0.2295275
Validation loss decreased (0.176865 --> 0.176736).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 18 cost time: 0.9817423820495605
Epoch: 18, Steps: 64 | Train Loss: 0.1273083 Vali Loss: 0.1774057 Test Loss: 0.2308672
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 19 cost time: 0.9773602485656738
Epoch: 19, Steps: 64 | Train Loss: 0.1261915 Vali Loss: 0.1758915 Test Loss: 0.2305786
Validation loss decreased (0.176736 --> 0.175892).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 20 cost time: 0.9624695777893066
Epoch: 20, Steps: 64 | Train Loss: 0.1256474 Vali Loss: 0.1742339 Test Loss: 0.2310669
Validation loss decreased (0.175892 --> 0.174234).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 21 cost time: 0.9543948173522949
Epoch: 21, Steps: 64 | Train Loss: 0.1257283 Vali Loss: 0.1769682 Test Loss: 0.2329124
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 22 cost time: 0.927361249923706
Epoch: 22, Steps: 64 | Train Loss: 0.1255227 Vali Loss: 0.1769038 Test Loss: 0.2319429
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 23 cost time: 0.9403002262115479
Epoch: 23, Steps: 64 | Train Loss: 0.1246565 Vali Loss: 0.1746096 Test Loss: 0.2323871
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 24 cost time: 0.9459996223449707
Epoch: 24, Steps: 64 | Train Loss: 0.1238489 Vali Loss: 0.1749820 Test Loss: 0.2300891
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 25 cost time: 0.9286482334136963
Epoch: 25, Steps: 64 | Train Loss: 0.1243064 Vali Loss: 0.1754384 Test Loss: 0.2318811
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 26 cost time: 0.9516372680664062
Epoch: 26, Steps: 64 | Train Loss: 0.1239700 Vali Loss: 0.1728918 Test Loss: 0.2296885
Validation loss decreased (0.174234 --> 0.172892).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 27 cost time: 0.9563562870025635
Epoch: 27, Steps: 64 | Train Loss: 0.1238468 Vali Loss: 0.1738081 Test Loss: 0.2293656
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 28 cost time: 0.9504115581512451
Epoch: 28, Steps: 64 | Train Loss: 0.1226602 Vali Loss: 0.1741943 Test Loss: 0.2308717
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 29 cost time: 0.9570212364196777
Epoch: 29, Steps: 64 | Train Loss: 0.1232428 Vali Loss: 0.1732639 Test Loss: 0.2309964
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 30 cost time: 0.9660582542419434
Epoch: 30, Steps: 64 | Train Loss: 0.1230829 Vali Loss: 0.1722429 Test Loss: 0.2301261
Validation loss decreased (0.172892 --> 0.172243).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 31 cost time: 0.9687573909759521
Epoch: 31, Steps: 64 | Train Loss: 0.1225430 Vali Loss: 0.1752980 Test Loss: 0.2314943
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 32 cost time: 0.9617571830749512
Epoch: 32, Steps: 64 | Train Loss: 0.1222334 Vali Loss: 0.1736417 Test Loss: 0.2307027
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 33 cost time: 0.9590005874633789
Epoch: 33, Steps: 64 | Train Loss: 0.1228840 Vali Loss: 0.1731354 Test Loss: 0.2312684
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 34 cost time: 0.9642610549926758
Epoch: 34, Steps: 64 | Train Loss: 0.1223317 Vali Loss: 0.1738257 Test Loss: 0.2302790
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 35 cost time: 0.9726169109344482
Epoch: 35, Steps: 64 | Train Loss: 0.1225815 Vali Loss: 0.1732463 Test Loss: 0.2321215
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 36 cost time: 0.9794182777404785
Epoch: 36, Steps: 64 | Train Loss: 0.1219466 Vali Loss: 0.1718111 Test Loss: 0.2300415
Validation loss decreased (0.172243 --> 0.171811).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 37 cost time: 0.9833765029907227
Epoch: 37, Steps: 64 | Train Loss: 0.1220332 Vali Loss: 0.1706623 Test Loss: 0.2294539
Validation loss decreased (0.171811 --> 0.170662).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 38 cost time: 0.9793434143066406
Epoch: 38, Steps: 64 | Train Loss: 0.1217231 Vali Loss: 0.1728413 Test Loss: 0.2312755
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 39 cost time: 0.9503936767578125
Epoch: 39, Steps: 64 | Train Loss: 0.1210255 Vali Loss: 0.1736569 Test Loss: 0.2313066
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 40 cost time: 0.940340518951416
Epoch: 40, Steps: 64 | Train Loss: 0.1222422 Vali Loss: 0.1737299 Test Loss: 0.2307348
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 41 cost time: 0.9417192935943604
Epoch: 41, Steps: 64 | Train Loss: 0.1215721 Vali Loss: 0.1739545 Test Loss: 0.2309708
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 42 cost time: 0.9393815994262695
Epoch: 42, Steps: 64 | Train Loss: 0.1216296 Vali Loss: 0.1713338 Test Loss: 0.2306566
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 43 cost time: 0.9599978923797607
Epoch: 43, Steps: 64 | Train Loss: 0.1216472 Vali Loss: 0.1706964 Test Loss: 0.2304470
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 44 cost time: 0.9636213779449463
Epoch: 44, Steps: 64 | Train Loss: 0.1219399 Vali Loss: 0.1726075 Test Loss: 0.2310342
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 45 cost time: 0.9544022083282471
Epoch: 45, Steps: 64 | Train Loss: 0.1218013 Vali Loss: 0.1703926 Test Loss: 0.2311909
Validation loss decreased (0.170662 --> 0.170393).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 46 cost time: 0.9579658508300781
Epoch: 46, Steps: 64 | Train Loss: 0.1218029 Vali Loss: 0.1724699 Test Loss: 0.2306087
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 47 cost time: 0.9473752975463867
Epoch: 47, Steps: 64 | Train Loss: 0.1216726 Vali Loss: 0.1719215 Test Loss: 0.2301483
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 48 cost time: 0.9395816326141357
Epoch: 48, Steps: 64 | Train Loss: 0.1214031 Vali Loss: 0.1724293 Test Loss: 0.2301873
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 49 cost time: 0.9473559856414795
Epoch: 49, Steps: 64 | Train Loss: 0.1214238 Vali Loss: 0.1716817 Test Loss: 0.2302205
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 50 cost time: 0.9628374576568604
Epoch: 50, Steps: 64 | Train Loss: 0.1217684 Vali Loss: 0.1722077 Test Loss: 0.2310582
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 51 cost time: 0.9684178829193115
Epoch: 51, Steps: 64 | Train Loss: 0.1209648 Vali Loss: 0.1738783 Test Loss: 0.2321088
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 52 cost time: 0.9779996871948242
Epoch: 52, Steps: 64 | Train Loss: 0.1214268 Vali Loss: 0.1734751 Test Loss: 0.2311440
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 53 cost time: 0.9826538562774658
Epoch: 53, Steps: 64 | Train Loss: 0.1210111 Vali Loss: 0.1723984 Test Loss: 0.2307730
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 54 cost time: 0.9863882064819336
Epoch: 54, Steps: 64 | Train Loss: 0.1219892 Vali Loss: 0.1704301 Test Loss: 0.2294377
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 55 cost time: 0.9854381084442139
Epoch: 55, Steps: 64 | Train Loss: 0.1221436 Vali Loss: 0.1717451 Test Loss: 0.2289918
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 56 cost time: 0.9754323959350586
Epoch: 56, Steps: 64 | Train Loss: 0.1217010 Vali Loss: 0.1742894 Test Loss: 0.2306446
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 57 cost time: 0.9785065650939941
Epoch: 57, Steps: 64 | Train Loss: 0.1216247 Vali Loss: 0.1728356 Test Loss: 0.2303501
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 58 cost time: 0.9511964321136475
Epoch: 58, Steps: 64 | Train Loss: 0.1217237 Vali Loss: 0.1710065 Test Loss: 0.2306096
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 59 cost time: 0.934577226638794
Epoch: 59, Steps: 64 | Train Loss: 0.1217637 Vali Loss: 0.1714631 Test Loss: 0.2299699
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 60 cost time: 0.9587581157684326
Epoch: 60, Steps: 64 | Train Loss: 0.1215080 Vali Loss: 0.1725951 Test Loss: 0.2310457
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23119087517261505, mae:0.34485700726509094, rse:0.24367977678775787
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04123115539550781 GB
Epoch: 1 cost time: 2.36578369140625
Epoch: 1, Steps: 64 | Train Loss: 0.8976731 Vali Loss: 2.4503264 Test Loss: 3.9099855
Validation loss decreased (inf --> 2.450326).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 2 cost time: 1.003387212753296
Epoch: 2, Steps: 64 | Train Loss: 0.7539672 Vali Loss: 1.5825611 Test Loss: 2.4595647
Validation loss decreased (2.450326 --> 1.582561).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 3 cost time: 0.9973125457763672
Epoch: 3, Steps: 64 | Train Loss: 0.4926716 Vali Loss: 0.9149723 Test Loss: 1.3394769
Validation loss decreased (1.582561 --> 0.914972).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 4 cost time: 1.0039987564086914
Epoch: 4, Steps: 64 | Train Loss: 0.3072105 Vali Loss: 0.5208558 Test Loss: 0.7174549
Validation loss decreased (0.914972 --> 0.520856).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 5 cost time: 0.9866394996643066
Epoch: 5, Steps: 64 | Train Loss: 0.2057895 Vali Loss: 0.3148915 Test Loss: 0.4175379
Validation loss decreased (0.520856 --> 0.314892).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 6 cost time: 0.977637529373169
Epoch: 6, Steps: 64 | Train Loss: 0.1609324 Vali Loss: 0.2293424 Test Loss: 0.2963685
Validation loss decreased (0.314892 --> 0.229342).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 7 cost time: 0.9878954887390137
Epoch: 7, Steps: 64 | Train Loss: 0.1430875 Vali Loss: 0.1955346 Test Loss: 0.2473709
Validation loss decreased (0.229342 --> 0.195535).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 8 cost time: 0.992464542388916
Epoch: 8, Steps: 64 | Train Loss: 0.1357247 Vali Loss: 0.1855007 Test Loss: 0.2378138
Validation loss decreased (0.195535 --> 0.185501).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 9 cost time: 0.9990012645721436
Epoch: 9, Steps: 64 | Train Loss: 0.1328041 Vali Loss: 0.1778362 Test Loss: 0.2298871
Validation loss decreased (0.185501 --> 0.177836).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 10 cost time: 1.0204401016235352
Epoch: 10, Steps: 64 | Train Loss: 0.1306579 Vali Loss: 0.1789466 Test Loss: 0.2298186
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 11 cost time: 1.0285215377807617
Epoch: 11, Steps: 64 | Train Loss: 0.1288648 Vali Loss: 0.1783814 Test Loss: 0.2292494
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 12 cost time: 1.0317645072937012
Epoch: 12, Steps: 64 | Train Loss: 0.1274044 Vali Loss: 0.1766199 Test Loss: 0.2291334
Validation loss decreased (0.177836 --> 0.176620).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 13 cost time: 1.0085391998291016
Epoch: 13, Steps: 64 | Train Loss: 0.1268121 Vali Loss: 0.1734968 Test Loss: 0.2275626
Validation loss decreased (0.176620 --> 0.173497).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 14 cost time: 0.9970488548278809
Epoch: 14, Steps: 64 | Train Loss: 0.1255809 Vali Loss: 0.1744398 Test Loss: 0.2283239
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 15 cost time: 0.9964230060577393
Epoch: 15, Steps: 64 | Train Loss: 0.1253434 Vali Loss: 0.1720893 Test Loss: 0.2271382
Validation loss decreased (0.173497 --> 0.172089).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 16 cost time: 0.9910576343536377
Epoch: 16, Steps: 64 | Train Loss: 0.1241066 Vali Loss: 0.1744151 Test Loss: 0.2287883
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 17 cost time: 1.0144100189208984
Epoch: 17, Steps: 64 | Train Loss: 0.1232532 Vali Loss: 0.1732852 Test Loss: 0.2287199
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 18 cost time: 1.0538089275360107
Epoch: 18, Steps: 64 | Train Loss: 0.1235056 Vali Loss: 0.1719502 Test Loss: 0.2291715
Validation loss decreased (0.172089 --> 0.171950).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 19 cost time: 0.9997920989990234
Epoch: 19, Steps: 64 | Train Loss: 0.1225701 Vali Loss: 0.1699584 Test Loss: 0.2273805
Validation loss decreased (0.171950 --> 0.169958).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 20 cost time: 0.9950013160705566
Epoch: 20, Steps: 64 | Train Loss: 0.1223971 Vali Loss: 0.1688040 Test Loss: 0.2271974
Validation loss decreased (0.169958 --> 0.168804).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 21 cost time: 0.9686660766601562
Epoch: 21, Steps: 64 | Train Loss: 0.1223416 Vali Loss: 0.1705179 Test Loss: 0.2277966
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 22 cost time: 0.965634822845459
Epoch: 22, Steps: 64 | Train Loss: 0.1220621 Vali Loss: 0.1723500 Test Loss: 0.2280335
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 23 cost time: 0.9703702926635742
Epoch: 23, Steps: 64 | Train Loss: 0.1215588 Vali Loss: 0.1694257 Test Loss: 0.2283449
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 24 cost time: 0.965930700302124
Epoch: 24, Steps: 64 | Train Loss: 0.1212078 Vali Loss: 0.1709591 Test Loss: 0.2275168
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 25 cost time: 0.9823780059814453
Epoch: 25, Steps: 64 | Train Loss: 0.1212862 Vali Loss: 0.1708526 Test Loss: 0.2275682
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 26 cost time: 0.9873814582824707
Epoch: 26, Steps: 64 | Train Loss: 0.1209675 Vali Loss: 0.1691710 Test Loss: 0.2273363
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 27 cost time: 0.9883761405944824
Epoch: 27, Steps: 64 | Train Loss: 0.1210145 Vali Loss: 0.1680355 Test Loss: 0.2278169
Validation loss decreased (0.168804 --> 0.168035).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 28 cost time: 0.9800698757171631
Epoch: 28, Steps: 64 | Train Loss: 0.1204428 Vali Loss: 0.1692602 Test Loss: 0.2283427
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 29 cost time: 0.9987156391143799
Epoch: 29, Steps: 64 | Train Loss: 0.1206131 Vali Loss: 0.1700464 Test Loss: 0.2280839
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 30 cost time: 0.9987351894378662
Epoch: 30, Steps: 64 | Train Loss: 0.1201134 Vali Loss: 0.1688886 Test Loss: 0.2274185
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 31 cost time: 0.9980003833770752
Epoch: 31, Steps: 64 | Train Loss: 0.1197412 Vali Loss: 0.1699939 Test Loss: 0.2277428
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 32 cost time: 1.0176286697387695
Epoch: 32, Steps: 64 | Train Loss: 0.1202320 Vali Loss: 0.1695498 Test Loss: 0.2278222
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 33 cost time: 1.018631935119629
Epoch: 33, Steps: 64 | Train Loss: 0.1205412 Vali Loss: 0.1697106 Test Loss: 0.2277382
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 34 cost time: 1.0056257247924805
Epoch: 34, Steps: 64 | Train Loss: 0.1198647 Vali Loss: 0.1687135 Test Loss: 0.2274468
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 35 cost time: 1.0284650325775146
Epoch: 35, Steps: 64 | Train Loss: 0.1195305 Vali Loss: 0.1707471 Test Loss: 0.2285891
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 36 cost time: 1.0252833366394043
Epoch: 36, Steps: 64 | Train Loss: 0.1194746 Vali Loss: 0.1688543 Test Loss: 0.2287592
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 37 cost time: 1.0104141235351562
Epoch: 37, Steps: 64 | Train Loss: 0.1189650 Vali Loss: 0.1691989 Test Loss: 0.2277719
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 38 cost time: 0.9554662704467773
Epoch: 38, Steps: 64 | Train Loss: 0.1191926 Vali Loss: 0.1700276 Test Loss: 0.2276753
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 39 cost time: 0.9684154987335205
Epoch: 39, Steps: 64 | Train Loss: 0.1188945 Vali Loss: 0.1691348 Test Loss: 0.2287041
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 40 cost time: 0.9620656967163086
Epoch: 40, Steps: 64 | Train Loss: 0.1200541 Vali Loss: 0.1688704 Test Loss: 0.2271932
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 41 cost time: 0.969519853591919
Epoch: 41, Steps: 64 | Train Loss: 0.1200236 Vali Loss: 0.1697931 Test Loss: 0.2273199
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 42 cost time: 0.990736722946167
Epoch: 42, Steps: 64 | Train Loss: 0.1190530 Vali Loss: 0.1700191 Test Loss: 0.2286096
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 43 cost time: 0.9927339553833008
Epoch: 43, Steps: 64 | Train Loss: 0.1195148 Vali Loss: 0.1679979 Test Loss: 0.2280553
Validation loss decreased (0.168035 --> 0.167998).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 44 cost time: 0.9814012050628662
Epoch: 44, Steps: 64 | Train Loss: 0.1200654 Vali Loss: 0.1690386 Test Loss: 0.2279108
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 45 cost time: 0.9850001335144043
Epoch: 45, Steps: 64 | Train Loss: 0.1191832 Vali Loss: 0.1700763 Test Loss: 0.2289991
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 46 cost time: 0.9946331977844238
Epoch: 46, Steps: 64 | Train Loss: 0.1196737 Vali Loss: 0.1687855 Test Loss: 0.2288878
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 47 cost time: 0.9840242862701416
Epoch: 47, Steps: 64 | Train Loss: 0.1194900 Vali Loss: 0.1682270 Test Loss: 0.2279356
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 48 cost time: 1.004828691482544
Epoch: 48, Steps: 64 | Train Loss: 0.1193012 Vali Loss: 0.1676310 Test Loss: 0.2273091
Validation loss decreased (0.167998 --> 0.167631).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 49 cost time: 1.0144987106323242
Epoch: 49, Steps: 64 | Train Loss: 0.1189677 Vali Loss: 0.1684911 Test Loss: 0.2285011
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 50 cost time: 1.0324411392211914
Epoch: 50, Steps: 64 | Train Loss: 0.1189421 Vali Loss: 0.1683692 Test Loss: 0.2286680
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 51 cost time: 1.0293681621551514
Epoch: 51, Steps: 64 | Train Loss: 0.1193497 Vali Loss: 0.1676401 Test Loss: 0.2274983
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 52 cost time: 1.0170397758483887
Epoch: 52, Steps: 64 | Train Loss: 0.1190271 Vali Loss: 0.1690717 Test Loss: 0.2289880
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 53 cost time: 0.9563827514648438
Epoch: 53, Steps: 64 | Train Loss: 0.1191672 Vali Loss: 0.1687070 Test Loss: 0.2282461
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 54 cost time: 1.0003585815429688
Epoch: 54, Steps: 64 | Train Loss: 0.1193403 Vali Loss: 0.1668935 Test Loss: 0.2274829
Validation loss decreased (0.167631 --> 0.166893).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 55 cost time: 0.9903855323791504
Epoch: 55, Steps: 64 | Train Loss: 0.1192705 Vali Loss: 0.1684964 Test Loss: 0.2275691
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 56 cost time: 0.9877223968505859
Epoch: 56, Steps: 64 | Train Loss: 0.1193865 Vali Loss: 0.1695553 Test Loss: 0.2274688
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 57 cost time: 0.9588305950164795
Epoch: 57, Steps: 64 | Train Loss: 0.1188979 Vali Loss: 0.1685388 Test Loss: 0.2276580
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 58 cost time: 0.9960019588470459
Epoch: 58, Steps: 64 | Train Loss: 0.1195468 Vali Loss: 0.1682481 Test Loss: 0.2280984
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 59 cost time: 0.9956564903259277
Epoch: 59, Steps: 64 | Train Loss: 0.1189341 Vali Loss: 0.1686772 Test Loss: 0.2274640
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 60 cost time: 0.9910109043121338
Epoch: 60, Steps: 64 | Train Loss: 0.1193251 Vali Loss: 0.1700732 Test Loss: 0.2285873
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.227482870221138, mae:0.3421010375022888, rse:0.24171772599220276
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.040126800537109375 GB
Epoch: 1 cost time: 2.2846577167510986
Epoch: 1, Steps: 64 | Train Loss: 0.7647032 Vali Loss: 1.6328250 Test Loss: 2.5197976
Validation loss decreased (inf --> 1.632825).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 2 cost time: 0.9463884830474854
Epoch: 2, Steps: 64 | Train Loss: 0.5279200 Vali Loss: 0.7369135 Test Loss: 1.0451734
Validation loss decreased (1.632825 --> 0.736914).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 3 cost time: 0.942406177520752
Epoch: 3, Steps: 64 | Train Loss: 0.3493293 Vali Loss: 0.5273904 Test Loss: 0.7190844
Validation loss decreased (0.736914 --> 0.527390).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 4 cost time: 0.9413433074951172
Epoch: 4, Steps: 64 | Train Loss: 0.2699617 Vali Loss: 0.3970224 Test Loss: 0.5146685
Validation loss decreased (0.527390 --> 0.397022).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 5 cost time: 0.9247205257415771
Epoch: 5, Steps: 64 | Train Loss: 0.2250265 Vali Loss: 0.3247558 Test Loss: 0.4102683
Validation loss decreased (0.397022 --> 0.324756).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 6 cost time: 0.9148354530334473
Epoch: 6, Steps: 64 | Train Loss: 0.1993140 Vali Loss: 0.2831569 Test Loss: 0.3477291
Validation loss decreased (0.324756 --> 0.283157).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 7 cost time: 0.9139988422393799
Epoch: 7, Steps: 64 | Train Loss: 0.1845337 Vali Loss: 0.2532536 Test Loss: 0.3067915
Validation loss decreased (0.283157 --> 0.253254).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 8 cost time: 0.915999174118042
Epoch: 8, Steps: 64 | Train Loss: 0.1739887 Vali Loss: 0.2337522 Test Loss: 0.2817680
Validation loss decreased (0.253254 --> 0.233752).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 9 cost time: 0.9180908203125
Epoch: 9, Steps: 64 | Train Loss: 0.1678595 Vali Loss: 0.2259150 Test Loss: 0.2690713
Validation loss decreased (0.233752 --> 0.225915).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 10 cost time: 0.9433746337890625
Epoch: 10, Steps: 64 | Train Loss: 0.1622883 Vali Loss: 0.2173955 Test Loss: 0.2573878
Validation loss decreased (0.225915 --> 0.217395).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 11 cost time: 0.9703552722930908
Epoch: 11, Steps: 64 | Train Loss: 0.1587417 Vali Loss: 0.2082094 Test Loss: 0.2493694
Validation loss decreased (0.217395 --> 0.208209).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 12 cost time: 0.9663608074188232
Epoch: 12, Steps: 64 | Train Loss: 0.1559552 Vali Loss: 0.2013007 Test Loss: 0.2424218
Validation loss decreased (0.208209 --> 0.201301).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 13 cost time: 0.9603457450866699
Epoch: 13, Steps: 64 | Train Loss: 0.1542316 Vali Loss: 0.2007755 Test Loss: 0.2416445
Validation loss decreased (0.201301 --> 0.200776).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 14 cost time: 0.9393744468688965
Epoch: 14, Steps: 64 | Train Loss: 0.1524059 Vali Loss: 0.1997136 Test Loss: 0.2388369
Validation loss decreased (0.200776 --> 0.199714).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 15 cost time: 0.9437510967254639
Epoch: 15, Steps: 64 | Train Loss: 0.1508179 Vali Loss: 0.1981626 Test Loss: 0.2349765
Validation loss decreased (0.199714 --> 0.198163).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 16 cost time: 0.9409995079040527
Epoch: 16, Steps: 64 | Train Loss: 0.1483826 Vali Loss: 0.1962179 Test Loss: 0.2351581
Validation loss decreased (0.198163 --> 0.196218).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 17 cost time: 0.9327917098999023
Epoch: 17, Steps: 64 | Train Loss: 0.1477447 Vali Loss: 0.1914204 Test Loss: 0.2322736
Validation loss decreased (0.196218 --> 0.191420).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 18 cost time: 0.9596412181854248
Epoch: 18, Steps: 64 | Train Loss: 0.1462246 Vali Loss: 0.1925646 Test Loss: 0.2324084
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 19 cost time: 0.9664037227630615
Epoch: 19, Steps: 64 | Train Loss: 0.1455965 Vali Loss: 0.1907986 Test Loss: 0.2314499
Validation loss decreased (0.191420 --> 0.190799).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 20 cost time: 0.9614458084106445
Epoch: 20, Steps: 64 | Train Loss: 0.1453970 Vali Loss: 0.1921193 Test Loss: 0.2311603
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 21 cost time: 0.9387364387512207
Epoch: 21, Steps: 64 | Train Loss: 0.1439085 Vali Loss: 0.1902540 Test Loss: 0.2311749
Validation loss decreased (0.190799 --> 0.190254).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 22 cost time: 0.9303915500640869
Epoch: 22, Steps: 64 | Train Loss: 0.1439310 Vali Loss: 0.1899423 Test Loss: 0.2293718
Validation loss decreased (0.190254 --> 0.189942).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 23 cost time: 0.9183752536773682
Epoch: 23, Steps: 64 | Train Loss: 0.1426864 Vali Loss: 0.1881195 Test Loss: 0.2302659
Validation loss decreased (0.189942 --> 0.188120).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 24 cost time: 0.9137866497039795
Epoch: 24, Steps: 64 | Train Loss: 0.1428349 Vali Loss: 0.1857424 Test Loss: 0.2271504
Validation loss decreased (0.188120 --> 0.185742).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 25 cost time: 0.9089980125427246
Epoch: 25, Steps: 64 | Train Loss: 0.1422844 Vali Loss: 0.1878901 Test Loss: 0.2294222
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 26 cost time: 0.9736039638519287
Epoch: 26, Steps: 64 | Train Loss: 0.1413518 Vali Loss: 0.1862532 Test Loss: 0.2271344
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 27 cost time: 0.9865427017211914
Epoch: 27, Steps: 64 | Train Loss: 0.1411860 Vali Loss: 0.1866569 Test Loss: 0.2278249
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 28 cost time: 0.9857616424560547
Epoch: 28, Steps: 64 | Train Loss: 0.1409663 Vali Loss: 0.1877433 Test Loss: 0.2283371
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 29 cost time: 0.9784023761749268
Epoch: 29, Steps: 64 | Train Loss: 0.1410646 Vali Loss: 0.1869618 Test Loss: 0.2289055
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 30 cost time: 0.9638090133666992
Epoch: 30, Steps: 64 | Train Loss: 0.1402590 Vali Loss: 0.1853526 Test Loss: 0.2272966
Validation loss decreased (0.185742 --> 0.185353).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 31 cost time: 0.9484500885009766
Epoch: 31, Steps: 64 | Train Loss: 0.1394191 Vali Loss: 0.1839986 Test Loss: 0.2263298
Validation loss decreased (0.185353 --> 0.183999).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 32 cost time: 0.9533929824829102
Epoch: 32, Steps: 64 | Train Loss: 0.1398783 Vali Loss: 0.1825669 Test Loss: 0.2247936
Validation loss decreased (0.183999 --> 0.182567).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 33 cost time: 0.9517662525177002
Epoch: 33, Steps: 64 | Train Loss: 0.1394456 Vali Loss: 0.1841938 Test Loss: 0.2260819
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 34 cost time: 0.9533977508544922
Epoch: 34, Steps: 64 | Train Loss: 0.1399556 Vali Loss: 0.1843773 Test Loss: 0.2265948
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 35 cost time: 0.9629981517791748
Epoch: 35, Steps: 64 | Train Loss: 0.1391004 Vali Loss: 0.1829474 Test Loss: 0.2261706
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 36 cost time: 0.966637134552002
Epoch: 36, Steps: 64 | Train Loss: 0.1388960 Vali Loss: 0.1824776 Test Loss: 0.2260650
Validation loss decreased (0.182567 --> 0.182478).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 37 cost time: 0.9623422622680664
Epoch: 37, Steps: 64 | Train Loss: 0.1387368 Vali Loss: 0.1827102 Test Loss: 0.2258667
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 38 cost time: 0.9633772373199463
Epoch: 38, Steps: 64 | Train Loss: 0.1390298 Vali Loss: 0.1841092 Test Loss: 0.2253259
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 39 cost time: 0.9551420211791992
Epoch: 39, Steps: 64 | Train Loss: 0.1384813 Vali Loss: 0.1836675 Test Loss: 0.2248524
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 40 cost time: 0.9194104671478271
Epoch: 40, Steps: 64 | Train Loss: 0.1384698 Vali Loss: 0.1844784 Test Loss: 0.2271295
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 41 cost time: 0.9123601913452148
Epoch: 41, Steps: 64 | Train Loss: 0.1391536 Vali Loss: 0.1812928 Test Loss: 0.2249843
Validation loss decreased (0.182478 --> 0.181293).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 42 cost time: 0.9119489192962646
Epoch: 42, Steps: 64 | Train Loss: 0.1390937 Vali Loss: 0.1822134 Test Loss: 0.2256407
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 43 cost time: 0.9230012893676758
Epoch: 43, Steps: 64 | Train Loss: 0.1393066 Vali Loss: 0.1848345 Test Loss: 0.2267472
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 44 cost time: 0.9426295757293701
Epoch: 44, Steps: 64 | Train Loss: 0.1381842 Vali Loss: 0.1826997 Test Loss: 0.2248110
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 45 cost time: 0.9193811416625977
Epoch: 45, Steps: 64 | Train Loss: 0.1385982 Vali Loss: 0.1838772 Test Loss: 0.2264647
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 46 cost time: 0.9151432514190674
Epoch: 46, Steps: 64 | Train Loss: 0.1384394 Vali Loss: 0.1841272 Test Loss: 0.2260807
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 47 cost time: 0.9353733062744141
Epoch: 47, Steps: 64 | Train Loss: 0.1387626 Vali Loss: 0.1843299 Test Loss: 0.2255271
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 48 cost time: 0.9183955192565918
Epoch: 48, Steps: 64 | Train Loss: 0.1383451 Vali Loss: 0.1810157 Test Loss: 0.2247075
Validation loss decreased (0.181293 --> 0.181016).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 49 cost time: 0.9147951602935791
Epoch: 49, Steps: 64 | Train Loss: 0.1382297 Vali Loss: 0.1821969 Test Loss: 0.2253711
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 50 cost time: 0.9239988327026367
Epoch: 50, Steps: 64 | Train Loss: 0.1382221 Vali Loss: 0.1848879 Test Loss: 0.2260814
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 51 cost time: 0.9410233497619629
Epoch: 51, Steps: 64 | Train Loss: 0.1376460 Vali Loss: 0.1829959 Test Loss: 0.2257608
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 52 cost time: 0.9586441516876221
Epoch: 52, Steps: 64 | Train Loss: 0.1381026 Vali Loss: 0.1845317 Test Loss: 0.2261835
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 53 cost time: 0.9683780670166016
Epoch: 53, Steps: 64 | Train Loss: 0.1375821 Vali Loss: 0.1834564 Test Loss: 0.2249958
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 54 cost time: 0.9573397636413574
Epoch: 54, Steps: 64 | Train Loss: 0.1378682 Vali Loss: 0.1832855 Test Loss: 0.2253675
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 55 cost time: 0.9660606384277344
Epoch: 55, Steps: 64 | Train Loss: 0.1378152 Vali Loss: 0.1831447 Test Loss: 0.2255140
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 56 cost time: 0.9600422382354736
Epoch: 56, Steps: 64 | Train Loss: 0.1378720 Vali Loss: 0.1845001 Test Loss: 0.2269410
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 57 cost time: 0.9394190311431885
Epoch: 57, Steps: 64 | Train Loss: 0.1386010 Vali Loss: 0.1814845 Test Loss: 0.2253484
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 58 cost time: 0.9367284774780273
Epoch: 58, Steps: 64 | Train Loss: 0.1382050 Vali Loss: 0.1829253 Test Loss: 0.2250541
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 59 cost time: 0.9433717727661133
Epoch: 59, Steps: 64 | Train Loss: 0.1380278 Vali Loss: 0.1810329 Test Loss: 0.2249279
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 60 cost time: 0.9396262168884277
Epoch: 60, Steps: 64 | Train Loss: 0.1383212 Vali Loss: 0.1845012 Test Loss: 0.2266500
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2247074842453003, mae:0.3361639380455017, rse:0.24023866653442383
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.04082822799682617 GB
Epoch: 1 cost time: 2.3391783237457275
Epoch: 1, Steps: 64 | Train Loss: 0.9498032 Vali Loss: 2.4638040 Test Loss: 3.8732090
Validation loss decreased (inf --> 2.463804).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 2 cost time: 0.988368034362793
Epoch: 2, Steps: 64 | Train Loss: 0.6797844 Vali Loss: 1.1162630 Test Loss: 1.6698930
Validation loss decreased (2.463804 --> 1.116263).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 3 cost time: 0.9813709259033203
Epoch: 3, Steps: 64 | Train Loss: 0.3594259 Vali Loss: 0.4924558 Test Loss: 0.6381001
Validation loss decreased (1.116263 --> 0.492456).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 4 cost time: 0.9650070667266846
Epoch: 4, Steps: 64 | Train Loss: 0.2063326 Vali Loss: 0.2827566 Test Loss: 0.3234106
Validation loss decreased (0.492456 --> 0.282757).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 5 cost time: 0.9463818073272705
Epoch: 5, Steps: 64 | Train Loss: 0.1620337 Vali Loss: 0.2295317 Test Loss: 0.2589939
Validation loss decreased (0.282757 --> 0.229532).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 6 cost time: 0.9403562545776367
Epoch: 6, Steps: 64 | Train Loss: 0.1503517 Vali Loss: 0.2096697 Test Loss: 0.2408355
Validation loss decreased (0.229532 --> 0.209670).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 7 cost time: 0.9393253326416016
Epoch: 7, Steps: 64 | Train Loss: 0.1447166 Vali Loss: 0.2027117 Test Loss: 0.2353580
Validation loss decreased (0.209670 --> 0.202712).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 8 cost time: 0.9380702972412109
Epoch: 8, Steps: 64 | Train Loss: 0.1413418 Vali Loss: 0.1981696 Test Loss: 0.2328730
Validation loss decreased (0.202712 --> 0.198170).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 9 cost time: 0.9429998397827148
Epoch: 9, Steps: 64 | Train Loss: 0.1377618 Vali Loss: 0.1946268 Test Loss: 0.2330884
Validation loss decreased (0.198170 --> 0.194627).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 10 cost time: 0.968001127243042
Epoch: 10, Steps: 64 | Train Loss: 0.1363635 Vali Loss: 0.1956345 Test Loss: 0.2320844
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 11 cost time: 0.988609790802002
Epoch: 11, Steps: 64 | Train Loss: 0.1338922 Vali Loss: 0.1901247 Test Loss: 0.2309547
Validation loss decreased (0.194627 --> 0.190125).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 12 cost time: 0.9860520362854004
Epoch: 12, Steps: 64 | Train Loss: 0.1318336 Vali Loss: 0.1898542 Test Loss: 0.2309630
Validation loss decreased (0.190125 --> 0.189854).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 13 cost time: 0.9883897304534912
Epoch: 13, Steps: 64 | Train Loss: 0.1314576 Vali Loss: 0.1891757 Test Loss: 0.2311917
Validation loss decreased (0.189854 --> 0.189176).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 14 cost time: 0.9521634578704834
Epoch: 14, Steps: 64 | Train Loss: 0.1308574 Vali Loss: 0.1848386 Test Loss: 0.2322510
Validation loss decreased (0.189176 --> 0.184839).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 15 cost time: 0.957444429397583
Epoch: 15, Steps: 64 | Train Loss: 0.1296894 Vali Loss: 0.1868060 Test Loss: 0.2322134
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 16 cost time: 0.9814307689666748
Epoch: 16, Steps: 64 | Train Loss: 0.1284152 Vali Loss: 0.1861663 Test Loss: 0.2313558
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 17 cost time: 0.9623503684997559
Epoch: 17, Steps: 64 | Train Loss: 0.1278056 Vali Loss: 0.1854618 Test Loss: 0.2320229
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 18 cost time: 1.000751256942749
Epoch: 18, Steps: 64 | Train Loss: 0.1274468 Vali Loss: 0.1826062 Test Loss: 0.2307597
Validation loss decreased (0.184839 --> 0.182606).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 19 cost time: 0.9807207584381104
Epoch: 19, Steps: 64 | Train Loss: 0.1268377 Vali Loss: 0.1839712 Test Loss: 0.2314287
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 20 cost time: 0.9614136219024658
Epoch: 20, Steps: 64 | Train Loss: 0.1263712 Vali Loss: 0.1835603 Test Loss: 0.2308345
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 21 cost time: 0.9559981822967529
Epoch: 21, Steps: 64 | Train Loss: 0.1255514 Vali Loss: 0.1842267 Test Loss: 0.2323374
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 22 cost time: 0.9486393928527832
Epoch: 22, Steps: 64 | Train Loss: 0.1257650 Vali Loss: 0.1803250 Test Loss: 0.2316395
Validation loss decreased (0.182606 --> 0.180325).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 23 cost time: 0.9523978233337402
Epoch: 23, Steps: 64 | Train Loss: 0.1251368 Vali Loss: 0.1822411 Test Loss: 0.2313758
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 24 cost time: 0.9438784122467041
Epoch: 24, Steps: 64 | Train Loss: 0.1254811 Vali Loss: 0.1804518 Test Loss: 0.2322344
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 25 cost time: 0.9353954792022705
Epoch: 25, Steps: 64 | Train Loss: 0.1247558 Vali Loss: 0.1840101 Test Loss: 0.2326905
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 26 cost time: 0.958397626876831
Epoch: 26, Steps: 64 | Train Loss: 0.1244819 Vali Loss: 0.1833808 Test Loss: 0.2317416
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 27 cost time: 0.9573788642883301
Epoch: 27, Steps: 64 | Train Loss: 0.1241538 Vali Loss: 0.1823607 Test Loss: 0.2324266
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 28 cost time: 0.9593551158905029
Epoch: 28, Steps: 64 | Train Loss: 0.1238339 Vali Loss: 0.1827842 Test Loss: 0.2327131
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 29 cost time: 0.9720003604888916
Epoch: 29, Steps: 64 | Train Loss: 0.1243564 Vali Loss: 0.1816761 Test Loss: 0.2328650
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 30 cost time: 0.97300124168396
Epoch: 30, Steps: 64 | Train Loss: 0.1242229 Vali Loss: 0.1822485 Test Loss: 0.2322349
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 31 cost time: 0.9616153240203857
Epoch: 31, Steps: 64 | Train Loss: 0.1232760 Vali Loss: 0.1814762 Test Loss: 0.2321679
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 32 cost time: 0.963172197341919
Epoch: 32, Steps: 64 | Train Loss: 0.1232071 Vali Loss: 0.1802802 Test Loss: 0.2321392
Validation loss decreased (0.180325 --> 0.180280).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 33 cost time: 0.9853696823120117
Epoch: 33, Steps: 64 | Train Loss: 0.1233644 Vali Loss: 0.1814905 Test Loss: 0.2331528
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 34 cost time: 0.9854822158813477
Epoch: 34, Steps: 64 | Train Loss: 0.1233351 Vali Loss: 0.1797458 Test Loss: 0.2314529
Validation loss decreased (0.180280 --> 0.179746).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 35 cost time: 0.9943890571594238
Epoch: 35, Steps: 64 | Train Loss: 0.1233520 Vali Loss: 0.1812897 Test Loss: 0.2336468
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 36 cost time: 1.021402359008789
Epoch: 36, Steps: 64 | Train Loss: 0.1233878 Vali Loss: 0.1826620 Test Loss: 0.2335119
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 37 cost time: 0.9954285621643066
Epoch: 37, Steps: 64 | Train Loss: 0.1230399 Vali Loss: 0.1827112 Test Loss: 0.2335447
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 38 cost time: 0.9943709373474121
Epoch: 38, Steps: 64 | Train Loss: 0.1233071 Vali Loss: 0.1803600 Test Loss: 0.2328132
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 39 cost time: 0.9927873611450195
Epoch: 39, Steps: 64 | Train Loss: 0.1224864 Vali Loss: 0.1811821 Test Loss: 0.2334079
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 40 cost time: 0.9283812046051025
Epoch: 40, Steps: 64 | Train Loss: 0.1227909 Vali Loss: 0.1828096 Test Loss: 0.2338263
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 41 cost time: 0.931999683380127
Epoch: 41, Steps: 64 | Train Loss: 0.1228360 Vali Loss: 0.1822397 Test Loss: 0.2331531
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 42 cost time: 0.9386589527130127
Epoch: 42, Steps: 64 | Train Loss: 0.1228741 Vali Loss: 0.1814405 Test Loss: 0.2333009
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 43 cost time: 0.9713897705078125
Epoch: 43, Steps: 64 | Train Loss: 0.1229281 Vali Loss: 0.1804828 Test Loss: 0.2325872
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 44 cost time: 0.9623582363128662
Epoch: 44, Steps: 64 | Train Loss: 0.1230764 Vali Loss: 0.1818505 Test Loss: 0.2331901
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 45 cost time: 0.9683432579040527
Epoch: 45, Steps: 64 | Train Loss: 0.1225218 Vali Loss: 0.1803278 Test Loss: 0.2328303
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 46 cost time: 0.9533867835998535
Epoch: 46, Steps: 64 | Train Loss: 0.1225527 Vali Loss: 0.1813801 Test Loss: 0.2324841
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 47 cost time: 0.9383723735809326
Epoch: 47, Steps: 64 | Train Loss: 0.1226400 Vali Loss: 0.1803504 Test Loss: 0.2331001
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 48 cost time: 0.9427840709686279
Epoch: 48, Steps: 64 | Train Loss: 0.1223380 Vali Loss: 0.1811489 Test Loss: 0.2329132
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 49 cost time: 0.9486422538757324
Epoch: 49, Steps: 64 | Train Loss: 0.1224400 Vali Loss: 0.1826136 Test Loss: 0.2327459
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 50 cost time: 0.9569995403289795
Epoch: 50, Steps: 64 | Train Loss: 0.1227482 Vali Loss: 0.1814952 Test Loss: 0.2328322
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 51 cost time: 0.9936375617980957
Epoch: 51, Steps: 64 | Train Loss: 0.1225412 Vali Loss: 0.1813785 Test Loss: 0.2337878
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 52 cost time: 0.9934093952178955
Epoch: 52, Steps: 64 | Train Loss: 0.1226420 Vali Loss: 0.1817557 Test Loss: 0.2333142
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 53 cost time: 1.0053462982177734
Epoch: 53, Steps: 64 | Train Loss: 0.1225432 Vali Loss: 0.1816639 Test Loss: 0.2328883
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 54 cost time: 0.984837532043457
Epoch: 54, Steps: 64 | Train Loss: 0.1225896 Vali Loss: 0.1811739 Test Loss: 0.2333767
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 55 cost time: 0.9884288311004639
Epoch: 55, Steps: 64 | Train Loss: 0.1228965 Vali Loss: 0.1793970 Test Loss: 0.2334319
Validation loss decreased (0.179746 --> 0.179397).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 56 cost time: 0.983154296875
Epoch: 56, Steps: 64 | Train Loss: 0.1228664 Vali Loss: 0.1801994 Test Loss: 0.2332195
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 57 cost time: 0.9637961387634277
Epoch: 57, Steps: 64 | Train Loss: 0.1226420 Vali Loss: 0.1820407 Test Loss: 0.2330817
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 58 cost time: 0.957495927810669
Epoch: 58, Steps: 64 | Train Loss: 0.1226126 Vali Loss: 0.1804714 Test Loss: 0.2325169
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 59 cost time: 0.9497907161712646
Epoch: 59, Steps: 64 | Train Loss: 0.1222996 Vali Loss: 0.1788168 Test Loss: 0.2326586
Validation loss decreased (0.179397 --> 0.178817).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 60 cost time: 0.9694910049438477
Epoch: 60, Steps: 64 | Train Loss: 0.1222324 Vali Loss: 0.1815515 Test Loss: 0.2333158
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23265855014324188, mae:0.35279035568237305, rse:0.24445202946662903
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04139232635498047 GB
Epoch: 1 cost time: 2.3639819622039795
Epoch: 1, Steps: 64 | Train Loss: 0.9449693 Vali Loss: 2.5430493 Test Loss: 4.0309739
Validation loss decreased (inf --> 2.543049).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 2 cost time: 1.015000820159912
Epoch: 2, Steps: 64 | Train Loss: 0.7170155 Vali Loss: 1.3363707 Test Loss: 2.0388174
Validation loss decreased (2.543049 --> 1.336371).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 3 cost time: 0.9809982776641846
Epoch: 3, Steps: 64 | Train Loss: 0.4013566 Vali Loss: 0.6225719 Test Loss: 0.8634127
Validation loss decreased (1.336371 --> 0.622572).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 4 cost time: 1.0106103420257568
Epoch: 4, Steps: 64 | Train Loss: 0.2262415 Vali Loss: 0.3203347 Test Loss: 0.3809597
Validation loss decreased (0.622572 --> 0.320335).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 5 cost time: 1.0195043087005615
Epoch: 5, Steps: 64 | Train Loss: 0.1688599 Vali Loss: 0.2381717 Test Loss: 0.2773181
Validation loss decreased (0.320335 --> 0.238172).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 6 cost time: 0.9696078300476074
Epoch: 6, Steps: 64 | Train Loss: 0.1535255 Vali Loss: 0.2124858 Test Loss: 0.2515661
Validation loss decreased (0.238172 --> 0.212486).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 7 cost time: 0.957188606262207
Epoch: 7, Steps: 64 | Train Loss: 0.1455643 Vali Loss: 0.2039020 Test Loss: 0.2445173
Validation loss decreased (0.212486 --> 0.203902).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 8 cost time: 0.9453704357147217
Epoch: 8, Steps: 64 | Train Loss: 0.1409012 Vali Loss: 0.1953227 Test Loss: 0.2396937
Validation loss decreased (0.203902 --> 0.195323).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 9 cost time: 0.976407527923584
Epoch: 9, Steps: 64 | Train Loss: 0.1376114 Vali Loss: 0.1930716 Test Loss: 0.2382710
Validation loss decreased (0.195323 --> 0.193072).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 10 cost time: 1.0189933776855469
Epoch: 10, Steps: 64 | Train Loss: 0.1348658 Vali Loss: 0.1871724 Test Loss: 0.2338065
Validation loss decreased (0.193072 --> 0.187172).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 11 cost time: 1.0223698616027832
Epoch: 11, Steps: 64 | Train Loss: 0.1332784 Vali Loss: 0.1880785 Test Loss: 0.2360004
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 12 cost time: 1.0254874229431152
Epoch: 12, Steps: 64 | Train Loss: 0.1316409 Vali Loss: 0.1822929 Test Loss: 0.2356161
Validation loss decreased (0.187172 --> 0.182293).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 13 cost time: 0.9959850311279297
Epoch: 13, Steps: 64 | Train Loss: 0.1295851 Vali Loss: 0.1838975 Test Loss: 0.2365299
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 14 cost time: 0.994687557220459
Epoch: 14, Steps: 64 | Train Loss: 0.1286643 Vali Loss: 0.1822726 Test Loss: 0.2350892
Validation loss decreased (0.182293 --> 0.182273).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 15 cost time: 0.9950687885284424
Epoch: 15, Steps: 64 | Train Loss: 0.1280887 Vali Loss: 0.1801798 Test Loss: 0.2335564
Validation loss decreased (0.182273 --> 0.180180).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 16 cost time: 0.9919986724853516
Epoch: 16, Steps: 64 | Train Loss: 0.1274270 Vali Loss: 0.1820283 Test Loss: 0.2352670
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 17 cost time: 1.0000011920928955
Epoch: 17, Steps: 64 | Train Loss: 0.1264336 Vali Loss: 0.1806624 Test Loss: 0.2356130
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 18 cost time: 1.0130512714385986
Epoch: 18, Steps: 64 | Train Loss: 0.1261247 Vali Loss: 0.1782682 Test Loss: 0.2340863
Validation loss decreased (0.180180 --> 0.178268).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 19 cost time: 0.9996387958526611
Epoch: 19, Steps: 64 | Train Loss: 0.1254248 Vali Loss: 0.1787420 Test Loss: 0.2333825
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 20 cost time: 0.9894070625305176
Epoch: 20, Steps: 64 | Train Loss: 0.1257733 Vali Loss: 0.1798424 Test Loss: 0.2346816
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 21 cost time: 0.9703516960144043
Epoch: 21, Steps: 64 | Train Loss: 0.1249479 Vali Loss: 0.1786920 Test Loss: 0.2348563
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 22 cost time: 0.9633796215057373
Epoch: 22, Steps: 64 | Train Loss: 0.1239263 Vali Loss: 0.1774605 Test Loss: 0.2335184
Validation loss decreased (0.178268 --> 0.177460).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 23 cost time: 0.9653773307800293
Epoch: 23, Steps: 64 | Train Loss: 0.1242647 Vali Loss: 0.1767973 Test Loss: 0.2348232
Validation loss decreased (0.177460 --> 0.176797).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 24 cost time: 0.9633867740631104
Epoch: 24, Steps: 64 | Train Loss: 0.1237399 Vali Loss: 0.1770431 Test Loss: 0.2341769
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 25 cost time: 0.9766526222229004
Epoch: 25, Steps: 64 | Train Loss: 0.1233145 Vali Loss: 0.1764394 Test Loss: 0.2335238
Validation loss decreased (0.176797 --> 0.176439).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 26 cost time: 0.988356351852417
Epoch: 26, Steps: 64 | Train Loss: 0.1232638 Vali Loss: 0.1761897 Test Loss: 0.2335670
Validation loss decreased (0.176439 --> 0.176190).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 27 cost time: 0.9837853908538818
Epoch: 27, Steps: 64 | Train Loss: 0.1230588 Vali Loss: 0.1738413 Test Loss: 0.2338850
Validation loss decreased (0.176190 --> 0.173841).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 28 cost time: 0.9898509979248047
Epoch: 28, Steps: 64 | Train Loss: 0.1228963 Vali Loss: 0.1764880 Test Loss: 0.2348962
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 29 cost time: 1.0116536617279053
Epoch: 29, Steps: 64 | Train Loss: 0.1227371 Vali Loss: 0.1752724 Test Loss: 0.2332149
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 30 cost time: 0.9844887256622314
Epoch: 30, Steps: 64 | Train Loss: 0.1225461 Vali Loss: 0.1767459 Test Loss: 0.2354519
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 31 cost time: 0.991635799407959
Epoch: 31, Steps: 64 | Train Loss: 0.1223293 Vali Loss: 0.1755084 Test Loss: 0.2341936
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 32 cost time: 0.9914543628692627
Epoch: 32, Steps: 64 | Train Loss: 0.1218740 Vali Loss: 0.1755708 Test Loss: 0.2334571
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 33 cost time: 0.9924302101135254
Epoch: 33, Steps: 64 | Train Loss: 0.1220906 Vali Loss: 0.1755467 Test Loss: 0.2341927
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 34 cost time: 1.013155221939087
Epoch: 34, Steps: 64 | Train Loss: 0.1224053 Vali Loss: 0.1765076 Test Loss: 0.2336722
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 35 cost time: 1.0197932720184326
Epoch: 35, Steps: 64 | Train Loss: 0.1228212 Vali Loss: 0.1763378 Test Loss: 0.2352056
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 36 cost time: 1.0143792629241943
Epoch: 36, Steps: 64 | Train Loss: 0.1222821 Vali Loss: 0.1779177 Test Loss: 0.2356488
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 37 cost time: 1.0263936519622803
Epoch: 37, Steps: 64 | Train Loss: 0.1222998 Vali Loss: 0.1767642 Test Loss: 0.2354215
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 38 cost time: 1.0017032623291016
Epoch: 38, Steps: 64 | Train Loss: 0.1218768 Vali Loss: 0.1766532 Test Loss: 0.2337682
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 39 cost time: 0.9493749141693115
Epoch: 39, Steps: 64 | Train Loss: 0.1221197 Vali Loss: 0.1759444 Test Loss: 0.2336474
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 40 cost time: 0.959721565246582
Epoch: 40, Steps: 64 | Train Loss: 0.1211842 Vali Loss: 0.1762591 Test Loss: 0.2340859
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 41 cost time: 0.9570004940032959
Epoch: 41, Steps: 64 | Train Loss: 0.1222068 Vali Loss: 0.1760677 Test Loss: 0.2342942
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 42 cost time: 0.9898133277893066
Epoch: 42, Steps: 64 | Train Loss: 0.1218111 Vali Loss: 0.1746055 Test Loss: 0.2343029
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 43 cost time: 0.9866952896118164
Epoch: 43, Steps: 64 | Train Loss: 0.1220848 Vali Loss: 0.1751712 Test Loss: 0.2333563
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 44 cost time: 0.9973809719085693
Epoch: 44, Steps: 64 | Train Loss: 0.1216881 Vali Loss: 0.1738974 Test Loss: 0.2337511
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 45 cost time: 1.0018310546875
Epoch: 45, Steps: 64 | Train Loss: 0.1215867 Vali Loss: 0.1776045 Test Loss: 0.2350105
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 46 cost time: 0.9781079292297363
Epoch: 46, Steps: 64 | Train Loss: 0.1219492 Vali Loss: 0.1757407 Test Loss: 0.2352172
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 47 cost time: 0.9994077682495117
Epoch: 47, Steps: 64 | Train Loss: 0.1213230 Vali Loss: 0.1747120 Test Loss: 0.2346473
EarlyStopping counter: 20 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 48 cost time: 1.014880895614624
Epoch: 48, Steps: 64 | Train Loss: 0.1214002 Vali Loss: 0.1744938 Test Loss: 0.2341567
EarlyStopping counter: 21 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 49 cost time: 1.0092041492462158
Epoch: 49, Steps: 64 | Train Loss: 0.1213423 Vali Loss: 0.1755240 Test Loss: 0.2336851
EarlyStopping counter: 22 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 50 cost time: 1.0143611431121826
Epoch: 50, Steps: 64 | Train Loss: 0.1210383 Vali Loss: 0.1747060 Test Loss: 0.2340243
EarlyStopping counter: 23 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 51 cost time: 1.0383949279785156
Epoch: 51, Steps: 64 | Train Loss: 0.1212929 Vali Loss: 0.1751027 Test Loss: 0.2326628
EarlyStopping counter: 24 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 52 cost time: 1.0388503074645996
Epoch: 52, Steps: 64 | Train Loss: 0.1210299 Vali Loss: 0.1753173 Test Loss: 0.2349328
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 53 cost time: 1.021803379058838
Epoch: 53, Steps: 64 | Train Loss: 0.1213135 Vali Loss: 0.1749253 Test Loss: 0.2326745
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 54 cost time: 1.0103912353515625
Epoch: 54, Steps: 64 | Train Loss: 0.1217946 Vali Loss: 0.1774167 Test Loss: 0.2359750
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 55 cost time: 0.9999914169311523
Epoch: 55, Steps: 64 | Train Loss: 0.1218607 Vali Loss: 0.1732795 Test Loss: 0.2328765
Validation loss decreased (0.173841 --> 0.173279).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 56 cost time: 0.9847517013549805
Epoch: 56, Steps: 64 | Train Loss: 0.1209794 Vali Loss: 0.1737965 Test Loss: 0.2339960
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 57 cost time: 0.9669985771179199
Epoch: 57, Steps: 64 | Train Loss: 0.1211498 Vali Loss: 0.1748618 Test Loss: 0.2331346
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 58 cost time: 0.9906356334686279
Epoch: 58, Steps: 64 | Train Loss: 0.1213829 Vali Loss: 0.1759156 Test Loss: 0.2336252
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 59 cost time: 1.0026206970214844
Epoch: 59, Steps: 64 | Train Loss: 0.1217303 Vali Loss: 0.1735693 Test Loss: 0.2346608
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 60 cost time: 1.007622241973877
Epoch: 60, Steps: 64 | Train Loss: 0.1217566 Vali Loss: 0.1752651 Test Loss: 0.2354150
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2328764796257019, mae:0.3475149869918823, rse:0.24456648528575897
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04735612869262695 GB
Epoch: 1 cost time: 2.257580280303955
Epoch: 1, Steps: 64 | Train Loss: 0.9254395 Vali Loss: 2.1668906 Test Loss: 3.3901997
Validation loss decreased (inf --> 2.166891).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 2 cost time: 0.897228479385376
Epoch: 2, Steps: 64 | Train Loss: 0.6699420 Vali Loss: 1.0144125 Test Loss: 1.5271530
Validation loss decreased (2.166891 --> 1.014413).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 3 cost time: 0.8994102478027344
Epoch: 3, Steps: 64 | Train Loss: 0.4092575 Vali Loss: 0.6096738 Test Loss: 0.8720399
Validation loss decreased (1.014413 --> 0.609674).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 4 cost time: 0.9017691612243652
Epoch: 4, Steps: 64 | Train Loss: 0.2933346 Vali Loss: 0.4313160 Test Loss: 0.5852210
Validation loss decreased (0.609674 --> 0.431316).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 5 cost time: 0.9017770290374756
Epoch: 5, Steps: 64 | Train Loss: 0.2426138 Vali Loss: 0.3522105 Test Loss: 0.4594944
Validation loss decreased (0.431316 --> 0.352210).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 6 cost time: 0.8892776966094971
Epoch: 6, Steps: 64 | Train Loss: 0.2166056 Vali Loss: 0.3036116 Test Loss: 0.3887143
Validation loss decreased (0.352210 --> 0.303612).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 7 cost time: 0.8816304206848145
Epoch: 7, Steps: 64 | Train Loss: 0.1996180 Vali Loss: 0.2721345 Test Loss: 0.3465519
Validation loss decreased (0.303612 --> 0.272134).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 8 cost time: 0.8961408138275146
Epoch: 8, Steps: 64 | Train Loss: 0.1890694 Vali Loss: 0.2510656 Test Loss: 0.3146513
Validation loss decreased (0.272134 --> 0.251066).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 9 cost time: 0.8893697261810303
Epoch: 9, Steps: 64 | Train Loss: 0.1827260 Vali Loss: 0.2364994 Test Loss: 0.2949193
Validation loss decreased (0.251066 --> 0.236499).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 10 cost time: 0.9048774242401123
Epoch: 10, Steps: 64 | Train Loss: 0.1767026 Vali Loss: 0.2283597 Test Loss: 0.2817394
Validation loss decreased (0.236499 --> 0.228360).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 11 cost time: 0.9567735195159912
Epoch: 11, Steps: 64 | Train Loss: 0.1725256 Vali Loss: 0.2157461 Test Loss: 0.2701103
Validation loss decreased (0.228360 --> 0.215746).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 12 cost time: 0.9400022029876709
Epoch: 12, Steps: 64 | Train Loss: 0.1696410 Vali Loss: 0.2123429 Test Loss: 0.2643718
Validation loss decreased (0.215746 --> 0.212343).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 13 cost time: 0.9386494159698486
Epoch: 13, Steps: 64 | Train Loss: 0.1661876 Vali Loss: 0.2099873 Test Loss: 0.2604324
Validation loss decreased (0.212343 --> 0.209987).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 14 cost time: 0.9292683601379395
Epoch: 14, Steps: 64 | Train Loss: 0.1641945 Vali Loss: 0.2058769 Test Loss: 0.2562609
Validation loss decreased (0.209987 --> 0.205877).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 15 cost time: 0.8703761100769043
Epoch: 15, Steps: 64 | Train Loss: 0.1616122 Vali Loss: 0.2034760 Test Loss: 0.2549151
Validation loss decreased (0.205877 --> 0.203476).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 16 cost time: 0.875413179397583
Epoch: 16, Steps: 64 | Train Loss: 0.1599420 Vali Loss: 0.2014533 Test Loss: 0.2516617
Validation loss decreased (0.203476 --> 0.201453).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 17 cost time: 0.9173834323883057
Epoch: 17, Steps: 64 | Train Loss: 0.1583676 Vali Loss: 0.1990869 Test Loss: 0.2493284
Validation loss decreased (0.201453 --> 0.199087).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 18 cost time: 0.932776927947998
Epoch: 18, Steps: 64 | Train Loss: 0.1578327 Vali Loss: 0.1970000 Test Loss: 0.2479428
Validation loss decreased (0.199087 --> 0.197000).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 19 cost time: 0.9339995384216309
Epoch: 19, Steps: 64 | Train Loss: 0.1561997 Vali Loss: 0.1971764 Test Loss: 0.2480095
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 20 cost time: 0.9196362495422363
Epoch: 20, Steps: 64 | Train Loss: 0.1560518 Vali Loss: 0.1948863 Test Loss: 0.2471931
Validation loss decreased (0.197000 --> 0.194886).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 21 cost time: 0.9334330558776855
Epoch: 21, Steps: 64 | Train Loss: 0.1543192 Vali Loss: 0.1941014 Test Loss: 0.2448062
Validation loss decreased (0.194886 --> 0.194101).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 22 cost time: 0.9134387969970703
Epoch: 22, Steps: 64 | Train Loss: 0.1533330 Vali Loss: 0.1936322 Test Loss: 0.2444275
Validation loss decreased (0.194101 --> 0.193632).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 23 cost time: 0.905043363571167
Epoch: 23, Steps: 64 | Train Loss: 0.1530544 Vali Loss: 0.1940778 Test Loss: 0.2448182
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 24 cost time: 0.8943631649017334
Epoch: 24, Steps: 64 | Train Loss: 0.1521366 Vali Loss: 0.1913714 Test Loss: 0.2436712
Validation loss decreased (0.193632 --> 0.191371).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 25 cost time: 0.9078304767608643
Epoch: 25, Steps: 64 | Train Loss: 0.1521822 Vali Loss: 0.1922401 Test Loss: 0.2425288
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 26 cost time: 0.8889994621276855
Epoch: 26, Steps: 64 | Train Loss: 0.1513054 Vali Loss: 0.1895149 Test Loss: 0.2433411
Validation loss decreased (0.191371 --> 0.189515).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 27 cost time: 0.8909957408905029
Epoch: 27, Steps: 64 | Train Loss: 0.1508395 Vali Loss: 0.1885210 Test Loss: 0.2410954
Validation loss decreased (0.189515 --> 0.188521).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 28 cost time: 0.9133987426757812
Epoch: 28, Steps: 64 | Train Loss: 0.1508263 Vali Loss: 0.1902713 Test Loss: 0.2419273
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 29 cost time: 0.9223647117614746
Epoch: 29, Steps: 64 | Train Loss: 0.1500243 Vali Loss: 0.1872236 Test Loss: 0.2418477
Validation loss decreased (0.188521 --> 0.187224).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 30 cost time: 0.9114415645599365
Epoch: 30, Steps: 64 | Train Loss: 0.1503990 Vali Loss: 0.1896854 Test Loss: 0.2423016
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 31 cost time: 0.9270939826965332
Epoch: 31, Steps: 64 | Train Loss: 0.1497310 Vali Loss: 0.1907508 Test Loss: 0.2415681
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 32 cost time: 0.9149994850158691
Epoch: 32, Steps: 64 | Train Loss: 0.1481526 Vali Loss: 0.1899947 Test Loss: 0.2411675
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 33 cost time: 0.906266450881958
Epoch: 33, Steps: 64 | Train Loss: 0.1485545 Vali Loss: 0.1881253 Test Loss: 0.2412596
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 34 cost time: 0.9034130573272705
Epoch: 34, Steps: 64 | Train Loss: 0.1486158 Vali Loss: 0.1918157 Test Loss: 0.2430773
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 35 cost time: 0.9033451080322266
Epoch: 35, Steps: 64 | Train Loss: 0.1479241 Vali Loss: 0.1885415 Test Loss: 0.2417120
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 36 cost time: 0.9099879264831543
Epoch: 36, Steps: 64 | Train Loss: 0.1478240 Vali Loss: 0.1887455 Test Loss: 0.2409637
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 37 cost time: 0.9237399101257324
Epoch: 37, Steps: 64 | Train Loss: 0.1483567 Vali Loss: 0.1880468 Test Loss: 0.2413397
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 38 cost time: 0.9270000457763672
Epoch: 38, Steps: 64 | Train Loss: 0.1469221 Vali Loss: 0.1889227 Test Loss: 0.2425343
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 39 cost time: 0.9310014247894287
Epoch: 39, Steps: 64 | Train Loss: 0.1477252 Vali Loss: 0.1885450 Test Loss: 0.2410344
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 40 cost time: 0.9266395568847656
Epoch: 40, Steps: 64 | Train Loss: 0.1467492 Vali Loss: 0.1890424 Test Loss: 0.2414501
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 41 cost time: 0.8813779354095459
Epoch: 41, Steps: 64 | Train Loss: 0.1475285 Vali Loss: 0.1886988 Test Loss: 0.2403609
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 42 cost time: 0.8692102432250977
Epoch: 42, Steps: 64 | Train Loss: 0.1474732 Vali Loss: 0.1873709 Test Loss: 0.2410739
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 43 cost time: 0.8783736228942871
Epoch: 43, Steps: 64 | Train Loss: 0.1474532 Vali Loss: 0.1878892 Test Loss: 0.2414556
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 44 cost time: 0.8739986419677734
Epoch: 44, Steps: 64 | Train Loss: 0.1475481 Vali Loss: 0.1872989 Test Loss: 0.2404906
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 45 cost time: 0.8746194839477539
Epoch: 45, Steps: 64 | Train Loss: 0.1473464 Vali Loss: 0.1882650 Test Loss: 0.2411311
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 46 cost time: 0.9056344032287598
Epoch: 46, Steps: 64 | Train Loss: 0.1480371 Vali Loss: 0.1878856 Test Loss: 0.2395509
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 47 cost time: 0.899411678314209
Epoch: 47, Steps: 64 | Train Loss: 0.1476665 Vali Loss: 0.1870945 Test Loss: 0.2397247
Validation loss decreased (0.187224 --> 0.187095).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 48 cost time: 0.8966774940490723
Epoch: 48, Steps: 64 | Train Loss: 0.1470692 Vali Loss: 0.1873655 Test Loss: 0.2401820
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 49 cost time: 0.910365104675293
Epoch: 49, Steps: 64 | Train Loss: 0.1470504 Vali Loss: 0.1889767 Test Loss: 0.2408965
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 50 cost time: 0.9062888622283936
Epoch: 50, Steps: 64 | Train Loss: 0.1469483 Vali Loss: 0.1875446 Test Loss: 0.2403142
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 51 cost time: 0.9160008430480957
Epoch: 51, Steps: 64 | Train Loss: 0.1469022 Vali Loss: 0.1870100 Test Loss: 0.2399364
Validation loss decreased (0.187095 --> 0.187010).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 52 cost time: 0.9239645004272461
Epoch: 52, Steps: 64 | Train Loss: 0.1463489 Vali Loss: 0.1880733 Test Loss: 0.2398172
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 53 cost time: 0.928412914276123
Epoch: 53, Steps: 64 | Train Loss: 0.1469628 Vali Loss: 0.1888525 Test Loss: 0.2411313
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 54 cost time: 0.924468994140625
Epoch: 54, Steps: 64 | Train Loss: 0.1468228 Vali Loss: 0.1863731 Test Loss: 0.2403892
Validation loss decreased (0.187010 --> 0.186373).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 55 cost time: 0.940375804901123
Epoch: 55, Steps: 64 | Train Loss: 0.1467023 Vali Loss: 0.1873790 Test Loss: 0.2402252
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 56 cost time: 0.9393453598022461
Epoch: 56, Steps: 64 | Train Loss: 0.1471339 Vali Loss: 0.1865338 Test Loss: 0.2412152
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 57 cost time: 0.9357874393463135
Epoch: 57, Steps: 64 | Train Loss: 0.1468548 Vali Loss: 0.1862236 Test Loss: 0.2401806
Validation loss decreased (0.186373 --> 0.186224).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 58 cost time: 0.9358048439025879
Epoch: 58, Steps: 64 | Train Loss: 0.1471414 Vali Loss: 0.1873785 Test Loss: 0.2408834
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 59 cost time: 0.9126439094543457
Epoch: 59, Steps: 64 | Train Loss: 0.1468155 Vali Loss: 0.1867880 Test Loss: 0.2403898
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 60 cost time: 0.9064779281616211
Epoch: 60, Steps: 64 | Train Loss: 0.1468892 Vali Loss: 0.1894599 Test Loss: 0.2409569
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.24018064141273499, mae:0.35958215594291687, rse:0.24837228655815125
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.04805755615234375 GB
Epoch: 1 cost time: 2.3021111488342285
Epoch: 1, Steps: 64 | Train Loss: 0.9934671 Vali Loss: 2.6209335 Test Loss: 4.1497836
Validation loss decreased (inf --> 2.620934).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 2 cost time: 0.9444162845611572
Epoch: 2, Steps: 64 | Train Loss: 0.7795971 Vali Loss: 1.5175864 Test Loss: 2.3366616
Validation loss decreased (2.620934 --> 1.517586).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 3 cost time: 0.9358241558074951
Epoch: 3, Steps: 64 | Train Loss: 0.4804342 Vali Loss: 0.8816102 Test Loss: 1.2932509
Validation loss decreased (1.517586 --> 0.881610).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 4 cost time: 0.9457204341888428
Epoch: 4, Steps: 64 | Train Loss: 0.3096439 Vali Loss: 0.5380436 Test Loss: 0.7439565
Validation loss decreased (0.881610 --> 0.538044).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 5 cost time: 0.9370009899139404
Epoch: 5, Steps: 64 | Train Loss: 0.2232468 Vali Loss: 0.3719254 Test Loss: 0.4809525
Validation loss decreased (0.538044 --> 0.371925).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 6 cost time: 0.9200329780578613
Epoch: 6, Steps: 64 | Train Loss: 0.1840326 Vali Loss: 0.2852485 Test Loss: 0.3527702
Validation loss decreased (0.371925 --> 0.285248).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 7 cost time: 0.935636043548584
Epoch: 7, Steps: 64 | Train Loss: 0.1652968 Vali Loss: 0.2485437 Test Loss: 0.2982344
Validation loss decreased (0.285248 --> 0.248544).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 8 cost time: 0.9472434520721436
Epoch: 8, Steps: 64 | Train Loss: 0.1569068 Vali Loss: 0.2288248 Test Loss: 0.2727875
Validation loss decreased (0.248544 --> 0.228825).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 9 cost time: 0.9413611888885498
Epoch: 9, Steps: 64 | Train Loss: 0.1518261 Vali Loss: 0.2155288 Test Loss: 0.2592257
Validation loss decreased (0.228825 --> 0.215529).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 10 cost time: 0.9574182033538818
Epoch: 10, Steps: 64 | Train Loss: 0.1484859 Vali Loss: 0.2094923 Test Loss: 0.2552457
Validation loss decreased (0.215529 --> 0.209492).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 11 cost time: 0.9854176044464111
Epoch: 11, Steps: 64 | Train Loss: 0.1452174 Vali Loss: 0.2063138 Test Loss: 0.2519953
Validation loss decreased (0.209492 --> 0.206314).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 12 cost time: 0.9728093147277832
Epoch: 12, Steps: 64 | Train Loss: 0.1441093 Vali Loss: 0.2002033 Test Loss: 0.2472107
Validation loss decreased (0.206314 --> 0.200203).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 13 cost time: 0.9747228622436523
Epoch: 13, Steps: 64 | Train Loss: 0.1414939 Vali Loss: 0.1980500 Test Loss: 0.2461599
Validation loss decreased (0.200203 --> 0.198050).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 14 cost time: 0.9517192840576172
Epoch: 14, Steps: 64 | Train Loss: 0.1407321 Vali Loss: 0.2002721 Test Loss: 0.2462192
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 15 cost time: 0.94100022315979
Epoch: 15, Steps: 64 | Train Loss: 0.1389740 Vali Loss: 0.1982017 Test Loss: 0.2458921
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 16 cost time: 0.9386692047119141
Epoch: 16, Steps: 64 | Train Loss: 0.1377424 Vali Loss: 0.1972412 Test Loss: 0.2461674
Validation loss decreased (0.198050 --> 0.197241).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 17 cost time: 0.9443473815917969
Epoch: 17, Steps: 64 | Train Loss: 0.1373839 Vali Loss: 0.1972530 Test Loss: 0.2441666
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 18 cost time: 0.9503788948059082
Epoch: 18, Steps: 64 | Train Loss: 0.1360956 Vali Loss: 0.1951088 Test Loss: 0.2446569
Validation loss decreased (0.197241 --> 0.195109).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 19 cost time: 0.9549813270568848
Epoch: 19, Steps: 64 | Train Loss: 0.1359067 Vali Loss: 0.1959399 Test Loss: 0.2452751
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 20 cost time: 0.9437699317932129
Epoch: 20, Steps: 64 | Train Loss: 0.1348173 Vali Loss: 0.1940285 Test Loss: 0.2442257
Validation loss decreased (0.195109 --> 0.194028).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 21 cost time: 0.9563758373260498
Epoch: 21, Steps: 64 | Train Loss: 0.1341186 Vali Loss: 0.1932747 Test Loss: 0.2438995
Validation loss decreased (0.194028 --> 0.193275).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 22 cost time: 0.956524133682251
Epoch: 22, Steps: 64 | Train Loss: 0.1335229 Vali Loss: 0.1943697 Test Loss: 0.2436941
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 23 cost time: 0.9380013942718506
Epoch: 23, Steps: 64 | Train Loss: 0.1332640 Vali Loss: 0.1923622 Test Loss: 0.2433358
Validation loss decreased (0.193275 --> 0.192362).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 24 cost time: 0.9416344165802002
Epoch: 24, Steps: 64 | Train Loss: 0.1330029 Vali Loss: 0.1916776 Test Loss: 0.2439292
Validation loss decreased (0.192362 --> 0.191678).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 25 cost time: 0.9348881244659424
Epoch: 25, Steps: 64 | Train Loss: 0.1326736 Vali Loss: 0.1902763 Test Loss: 0.2421361
Validation loss decreased (0.191678 --> 0.190276).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 26 cost time: 0.9413485527038574
Epoch: 26, Steps: 64 | Train Loss: 0.1321207 Vali Loss: 0.1919982 Test Loss: 0.2436875
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 27 cost time: 0.9553725719451904
Epoch: 27, Steps: 64 | Train Loss: 0.1322413 Vali Loss: 0.1906322 Test Loss: 0.2423602
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 28 cost time: 0.9565615653991699
Epoch: 28, Steps: 64 | Train Loss: 0.1321007 Vali Loss: 0.1922583 Test Loss: 0.2450670
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 29 cost time: 0.9477488994598389
Epoch: 29, Steps: 64 | Train Loss: 0.1314127 Vali Loss: 0.1929929 Test Loss: 0.2438169
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 30 cost time: 0.959749698638916
Epoch: 30, Steps: 64 | Train Loss: 0.1314697 Vali Loss: 0.1912603 Test Loss: 0.2440063
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 31 cost time: 0.9500012397766113
Epoch: 31, Steps: 64 | Train Loss: 0.1312952 Vali Loss: 0.1911681 Test Loss: 0.2434147
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 32 cost time: 0.9476308822631836
Epoch: 32, Steps: 64 | Train Loss: 0.1314516 Vali Loss: 0.1917718 Test Loss: 0.2429175
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 33 cost time: 0.9446406364440918
Epoch: 33, Steps: 64 | Train Loss: 0.1303276 Vali Loss: 0.1917166 Test Loss: 0.2436251
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 34 cost time: 0.9432406425476074
Epoch: 34, Steps: 64 | Train Loss: 0.1303061 Vali Loss: 0.1911569 Test Loss: 0.2447212
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 35 cost time: 0.9464244842529297
Epoch: 35, Steps: 64 | Train Loss: 0.1301607 Vali Loss: 0.1902480 Test Loss: 0.2446334
Validation loss decreased (0.190276 --> 0.190248).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 36 cost time: 0.9683651924133301
Epoch: 36, Steps: 64 | Train Loss: 0.1307279 Vali Loss: 0.1914261 Test Loss: 0.2453972
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 37 cost time: 0.9573688507080078
Epoch: 37, Steps: 64 | Train Loss: 0.1301463 Vali Loss: 0.1911421 Test Loss: 0.2443931
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 38 cost time: 0.962712287902832
Epoch: 38, Steps: 64 | Train Loss: 0.1300860 Vali Loss: 0.1890149 Test Loss: 0.2433459
Validation loss decreased (0.190248 --> 0.189015).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 39 cost time: 0.9439976215362549
Epoch: 39, Steps: 64 | Train Loss: 0.1294791 Vali Loss: 0.1901717 Test Loss: 0.2442800
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 40 cost time: 0.9359993934631348
Epoch: 40, Steps: 64 | Train Loss: 0.1298921 Vali Loss: 0.1904780 Test Loss: 0.2438551
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 41 cost time: 0.935600996017456
Epoch: 41, Steps: 64 | Train Loss: 0.1306830 Vali Loss: 0.1908366 Test Loss: 0.2442257
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 42 cost time: 0.9210426807403564
Epoch: 42, Steps: 64 | Train Loss: 0.1299680 Vali Loss: 0.1898563 Test Loss: 0.2433269
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 43 cost time: 0.9249770641326904
Epoch: 43, Steps: 64 | Train Loss: 0.1298682 Vali Loss: 0.1910596 Test Loss: 0.2445158
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 44 cost time: 0.9323794841766357
Epoch: 44, Steps: 64 | Train Loss: 0.1298953 Vali Loss: 0.1894110 Test Loss: 0.2429481
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 45 cost time: 0.9464507102966309
Epoch: 45, Steps: 64 | Train Loss: 0.1290993 Vali Loss: 0.1911532 Test Loss: 0.2443075
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 46 cost time: 0.9458122253417969
Epoch: 46, Steps: 64 | Train Loss: 0.1299452 Vali Loss: 0.1905127 Test Loss: 0.2439625
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 47 cost time: 0.9422943592071533
Epoch: 47, Steps: 64 | Train Loss: 0.1301443 Vali Loss: 0.1898051 Test Loss: 0.2438397
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 48 cost time: 0.954625129699707
Epoch: 48, Steps: 64 | Train Loss: 0.1296564 Vali Loss: 0.1919893 Test Loss: 0.2436740
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 49 cost time: 0.9494209289550781
Epoch: 49, Steps: 64 | Train Loss: 0.1288168 Vali Loss: 0.1904748 Test Loss: 0.2447004
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 50 cost time: 0.9473705291748047
Epoch: 50, Steps: 64 | Train Loss: 0.1295729 Vali Loss: 0.1885568 Test Loss: 0.2433251
Validation loss decreased (0.189015 --> 0.188557).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 51 cost time: 0.9421877861022949
Epoch: 51, Steps: 64 | Train Loss: 0.1291661 Vali Loss: 0.1887101 Test Loss: 0.2435317
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 52 cost time: 0.9434618949890137
Epoch: 52, Steps: 64 | Train Loss: 0.1292655 Vali Loss: 0.1911135 Test Loss: 0.2435317
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 53 cost time: 0.9584770202636719
Epoch: 53, Steps: 64 | Train Loss: 0.1295001 Vali Loss: 0.1887525 Test Loss: 0.2437956
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 54 cost time: 0.957197904586792
Epoch: 54, Steps: 64 | Train Loss: 0.1298128 Vali Loss: 0.1908783 Test Loss: 0.2441776
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 55 cost time: 0.9629993438720703
Epoch: 55, Steps: 64 | Train Loss: 0.1296822 Vali Loss: 0.1887740 Test Loss: 0.2436050
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 56 cost time: 0.9636211395263672
Epoch: 56, Steps: 64 | Train Loss: 0.1291003 Vali Loss: 0.1917970 Test Loss: 0.2439249
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 57 cost time: 0.9506435394287109
Epoch: 57, Steps: 64 | Train Loss: 0.1297185 Vali Loss: 0.1899757 Test Loss: 0.2432979
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 58 cost time: 0.9323544502258301
Epoch: 58, Steps: 64 | Train Loss: 0.1294731 Vali Loss: 0.1911660 Test Loss: 0.2445633
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 59 cost time: 0.924368143081665
Epoch: 59, Steps: 64 | Train Loss: 0.1290313 Vali Loss: 0.1889169 Test Loss: 0.2433489
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 60 cost time: 0.9277358055114746
Epoch: 60, Steps: 64 | Train Loss: 0.1295328 Vali Loss: 0.1898741 Test Loss: 0.2442824
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2433251589536667, mae:0.3665406405925751, rse:0.24999289214611053
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.04862165451049805 GB
Epoch: 1 cost time: 2.3231356143951416
Epoch: 1, Steps: 64 | Train Loss: 0.9488936 Vali Loss: 2.5676150 Test Loss: 4.1342831
Validation loss decreased (inf --> 2.567615).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 2 cost time: 0.9877700805664062
Epoch: 2, Steps: 64 | Train Loss: 0.7662963 Vali Loss: 1.5186111 Test Loss: 2.3784215
Validation loss decreased (2.567615 --> 1.518611).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 3 cost time: 0.9877378940582275
Epoch: 3, Steps: 64 | Train Loss: 0.4569469 Vali Loss: 0.7575545 Test Loss: 1.1014246
Validation loss decreased (1.518611 --> 0.757555).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 4 cost time: 0.9800000190734863
Epoch: 4, Steps: 64 | Train Loss: 0.2578310 Vali Loss: 0.3734698 Test Loss: 0.4779376
Validation loss decreased (0.757555 --> 0.373470).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 5 cost time: 0.9790763854980469
Epoch: 5, Steps: 64 | Train Loss: 0.1775300 Vali Loss: 0.2489573 Test Loss: 0.2919342
Validation loss decreased (0.373470 --> 0.248957).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 6 cost time: 0.9641451835632324
Epoch: 6, Steps: 64 | Train Loss: 0.1561006 Vali Loss: 0.2178552 Test Loss: 0.2542446
Validation loss decreased (0.248957 --> 0.217855).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 7 cost time: 0.9614458084106445
Epoch: 7, Steps: 64 | Train Loss: 0.1484879 Vali Loss: 0.2079116 Test Loss: 0.2443779
Validation loss decreased (0.217855 --> 0.207912).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 8 cost time: 0.9614496231079102
Epoch: 8, Steps: 64 | Train Loss: 0.1453869 Vali Loss: 0.2031594 Test Loss: 0.2406842
Validation loss decreased (0.207912 --> 0.203159).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 9 cost time: 0.9661061763763428
Epoch: 9, Steps: 64 | Train Loss: 0.1410147 Vali Loss: 0.2014333 Test Loss: 0.2400601
Validation loss decreased (0.203159 --> 0.201433).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 10 cost time: 0.9983994960784912
Epoch: 10, Steps: 64 | Train Loss: 0.1389650 Vali Loss: 0.1959984 Test Loss: 0.2393154
Validation loss decreased (0.201433 --> 0.195998).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 11 cost time: 1.0046536922454834
Epoch: 11, Steps: 64 | Train Loss: 0.1375255 Vali Loss: 0.1951562 Test Loss: 0.2400859
Validation loss decreased (0.195998 --> 0.195156).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 12 cost time: 1.0083508491516113
Epoch: 12, Steps: 64 | Train Loss: 0.1352731 Vali Loss: 0.1956870 Test Loss: 0.2410196
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 13 cost time: 0.9794161319732666
Epoch: 13, Steps: 64 | Train Loss: 0.1339784 Vali Loss: 0.1920637 Test Loss: 0.2397598
Validation loss decreased (0.195156 --> 0.192064).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 14 cost time: 0.9695250988006592
Epoch: 14, Steps: 64 | Train Loss: 0.1326819 Vali Loss: 0.1924544 Test Loss: 0.2419174
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 15 cost time: 0.9709987640380859
Epoch: 15, Steps: 64 | Train Loss: 0.1317857 Vali Loss: 0.1891330 Test Loss: 0.2406193
Validation loss decreased (0.192064 --> 0.189133).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 16 cost time: 0.9619989395141602
Epoch: 16, Steps: 64 | Train Loss: 0.1307394 Vali Loss: 0.1916915 Test Loss: 0.2421914
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 17 cost time: 0.9659864902496338
Epoch: 17, Steps: 64 | Train Loss: 0.1301664 Vali Loss: 0.1908427 Test Loss: 0.2426265
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 18 cost time: 0.9861021041870117
Epoch: 18, Steps: 64 | Train Loss: 0.1296593 Vali Loss: 0.1894635 Test Loss: 0.2419414
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 19 cost time: 0.9393925666809082
Epoch: 19, Steps: 64 | Train Loss: 0.1287405 Vali Loss: 0.1888285 Test Loss: 0.2429991
Validation loss decreased (0.189133 --> 0.188828).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 20 cost time: 0.9742732048034668
Epoch: 20, Steps: 64 | Train Loss: 0.1288516 Vali Loss: 0.1897811 Test Loss: 0.2435908
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 21 cost time: 0.9733831882476807
Epoch: 21, Steps: 64 | Train Loss: 0.1282485 Vali Loss: 0.1896450 Test Loss: 0.2438916
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 22 cost time: 0.9753482341766357
Epoch: 22, Steps: 64 | Train Loss: 0.1277423 Vali Loss: 0.1915484 Test Loss: 0.2457259
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 23 cost time: 0.963756799697876
Epoch: 23, Steps: 64 | Train Loss: 0.1278160 Vali Loss: 0.1880984 Test Loss: 0.2448216
Validation loss decreased (0.188828 --> 0.188098).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 24 cost time: 0.9667665958404541
Epoch: 24, Steps: 64 | Train Loss: 0.1272088 Vali Loss: 0.1891293 Test Loss: 0.2454569
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 25 cost time: 0.9727587699890137
Epoch: 25, Steps: 64 | Train Loss: 0.1270055 Vali Loss: 0.1866322 Test Loss: 0.2451952
Validation loss decreased (0.188098 --> 0.186632).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 26 cost time: 0.9796285629272461
Epoch: 26, Steps: 64 | Train Loss: 0.1263403 Vali Loss: 0.1885605 Test Loss: 0.2460544
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 27 cost time: 0.961400032043457
Epoch: 27, Steps: 64 | Train Loss: 0.1270268 Vali Loss: 0.1879838 Test Loss: 0.2439507
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 28 cost time: 0.9673607349395752
Epoch: 28, Steps: 64 | Train Loss: 0.1261152 Vali Loss: 0.1896849 Test Loss: 0.2459526
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 29 cost time: 0.9964144229888916
Epoch: 29, Steps: 64 | Train Loss: 0.1259805 Vali Loss: 0.1881963 Test Loss: 0.2464664
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 30 cost time: 0.9782123565673828
Epoch: 30, Steps: 64 | Train Loss: 0.1256711 Vali Loss: 0.1873515 Test Loss: 0.2463261
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 31 cost time: 0.964378833770752
Epoch: 31, Steps: 64 | Train Loss: 0.1255386 Vali Loss: 0.1887413 Test Loss: 0.2468611
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 32 cost time: 0.9654438495635986
Epoch: 32, Steps: 64 | Train Loss: 0.1256437 Vali Loss: 0.1875214 Test Loss: 0.2463599
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 33 cost time: 0.9637324810028076
Epoch: 33, Steps: 64 | Train Loss: 0.1253758 Vali Loss: 0.1880164 Test Loss: 0.2457598
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 34 cost time: 0.9646134376525879
Epoch: 34, Steps: 64 | Train Loss: 0.1258308 Vali Loss: 0.1873517 Test Loss: 0.2477963
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 35 cost time: 0.9930002689361572
Epoch: 35, Steps: 64 | Train Loss: 0.1252985 Vali Loss: 0.1898339 Test Loss: 0.2488037
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 36 cost time: 0.9846363067626953
Epoch: 36, Steps: 64 | Train Loss: 0.1250804 Vali Loss: 0.1870485 Test Loss: 0.2462573
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 37 cost time: 0.9863669872283936
Epoch: 37, Steps: 64 | Train Loss: 0.1246734 Vali Loss: 0.1863240 Test Loss: 0.2470331
Validation loss decreased (0.186632 --> 0.186324).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 38 cost time: 0.9646322727203369
Epoch: 38, Steps: 64 | Train Loss: 0.1252898 Vali Loss: 0.1883435 Test Loss: 0.2467614
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 39 cost time: 0.9573569297790527
Epoch: 39, Steps: 64 | Train Loss: 0.1248663 Vali Loss: 0.1867243 Test Loss: 0.2475586
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 40 cost time: 0.9505288600921631
Epoch: 40, Steps: 64 | Train Loss: 0.1250524 Vali Loss: 0.1877415 Test Loss: 0.2479498
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 41 cost time: 0.9533581733703613
Epoch: 41, Steps: 64 | Train Loss: 0.1249443 Vali Loss: 0.1891704 Test Loss: 0.2483064
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 42 cost time: 0.965242862701416
Epoch: 42, Steps: 64 | Train Loss: 0.1245638 Vali Loss: 0.1879770 Test Loss: 0.2478128
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 43 cost time: 0.9687097072601318
Epoch: 43, Steps: 64 | Train Loss: 0.1241419 Vali Loss: 0.1877288 Test Loss: 0.2496175
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 44 cost time: 0.9760010242462158
Epoch: 44, Steps: 64 | Train Loss: 0.1250771 Vali Loss: 0.1874718 Test Loss: 0.2475791
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 45 cost time: 0.98162841796875
Epoch: 45, Steps: 64 | Train Loss: 0.1251519 Vali Loss: 0.1881092 Test Loss: 0.2472852
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 46 cost time: 0.9826486110687256
Epoch: 46, Steps: 64 | Train Loss: 0.1244435 Vali Loss: 0.1854157 Test Loss: 0.2461348
Validation loss decreased (0.186324 --> 0.185416).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 47 cost time: 0.993354082107544
Epoch: 47, Steps: 64 | Train Loss: 0.1246353 Vali Loss: 0.1889402 Test Loss: 0.2476947
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 48 cost time: 0.9803893566131592
Epoch: 48, Steps: 64 | Train Loss: 0.1249192 Vali Loss: 0.1871242 Test Loss: 0.2459601
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 49 cost time: 0.9643921852111816
Epoch: 49, Steps: 64 | Train Loss: 0.1247381 Vali Loss: 0.1879921 Test Loss: 0.2472177
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 50 cost time: 0.9653849601745605
Epoch: 50, Steps: 64 | Train Loss: 0.1236154 Vali Loss: 0.1886321 Test Loss: 0.2484921
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 51 cost time: 0.9707565307617188
Epoch: 51, Steps: 64 | Train Loss: 0.1248214 Vali Loss: 0.1866138 Test Loss: 0.2486405
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 52 cost time: 0.9903955459594727
Epoch: 52, Steps: 64 | Train Loss: 0.1241034 Vali Loss: 0.1869353 Test Loss: 0.2480996
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 53 cost time: 0.9867260456085205
Epoch: 53, Steps: 64 | Train Loss: 0.1244063 Vali Loss: 0.1884290 Test Loss: 0.2477583
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 54 cost time: 0.9900021553039551
Epoch: 54, Steps: 64 | Train Loss: 0.1239580 Vali Loss: 0.1866203 Test Loss: 0.2472053
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 55 cost time: 1.000999927520752
Epoch: 55, Steps: 64 | Train Loss: 0.1243619 Vali Loss: 0.1881006 Test Loss: 0.2476796
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 56 cost time: 0.9596226215362549
Epoch: 56, Steps: 64 | Train Loss: 0.1244668 Vali Loss: 0.1869278 Test Loss: 0.2473273
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 57 cost time: 0.9603774547576904
Epoch: 57, Steps: 64 | Train Loss: 0.1247021 Vali Loss: 0.1874126 Test Loss: 0.2486988
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 58 cost time: 0.9568064212799072
Epoch: 58, Steps: 64 | Train Loss: 0.1245529 Vali Loss: 0.1867244 Test Loss: 0.2475438
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 59 cost time: 0.9573683738708496
Epoch: 59, Steps: 64 | Train Loss: 0.1239045 Vali Loss: 0.1894017 Test Loss: 0.2484046
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 60 cost time: 0.9774081707000732
Epoch: 60, Steps: 64 | Train Loss: 0.1244324 Vali Loss: 0.1882874 Test Loss: 0.2465366
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.24613486230373383, mae:0.3704424798488617, rse:0.2514320909976959
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04751729965209961 GB
Epoch: 1 cost time: 2.262721061706543
Epoch: 1, Steps: 64 | Train Loss: 0.9502871 Vali Loss: 2.1340840 Test Loss: 3.3914876
Validation loss decreased (inf --> 2.134084).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 2 cost time: 0.9217391014099121
Epoch: 2, Steps: 64 | Train Loss: 0.6697331 Vali Loss: 1.0093876 Test Loss: 1.5138218
Validation loss decreased (2.134084 --> 1.009388).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 3 cost time: 0.9194061756134033
Epoch: 3, Steps: 64 | Train Loss: 0.4482840 Vali Loss: 0.7684706 Test Loss: 1.1289413
Validation loss decreased (1.009388 --> 0.768471).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 4 cost time: 0.9156398773193359
Epoch: 4, Steps: 64 | Train Loss: 0.3570465 Vali Loss: 0.6184026 Test Loss: 0.8908789
Validation loss decreased (0.768471 --> 0.618403).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 5 cost time: 0.9156360626220703
Epoch: 5, Steps: 64 | Train Loss: 0.2962545 Vali Loss: 0.5036861 Test Loss: 0.7086746
Validation loss decreased (0.618403 --> 0.503686).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 6 cost time: 0.9003918170928955
Epoch: 6, Steps: 64 | Train Loss: 0.2568711 Vali Loss: 0.4282665 Test Loss: 0.5867721
Validation loss decreased (0.503686 --> 0.428267).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 7 cost time: 0.9095814228057861
Epoch: 7, Steps: 64 | Train Loss: 0.2257934 Vali Loss: 0.3629544 Test Loss: 0.4925879
Validation loss decreased (0.428267 --> 0.362954).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 8 cost time: 0.9123594760894775
Epoch: 8, Steps: 64 | Train Loss: 0.2055074 Vali Loss: 0.3225211 Test Loss: 0.4291659
Validation loss decreased (0.362954 --> 0.322521).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 9 cost time: 0.9117810726165771
Epoch: 9, Steps: 64 | Train Loss: 0.1911233 Vali Loss: 0.2908036 Test Loss: 0.3821160
Validation loss decreased (0.322521 --> 0.290804).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 10 cost time: 0.9339993000030518
Epoch: 10, Steps: 64 | Train Loss: 0.1797324 Vali Loss: 0.2656771 Test Loss: 0.3455134
Validation loss decreased (0.290804 --> 0.265677).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 11 cost time: 0.9570004940032959
Epoch: 11, Steps: 64 | Train Loss: 0.1719460 Vali Loss: 0.2496718 Test Loss: 0.3241937
Validation loss decreased (0.265677 --> 0.249672).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 12 cost time: 0.9656260013580322
Epoch: 12, Steps: 64 | Train Loss: 0.1652209 Vali Loss: 0.2358118 Test Loss: 0.3014999
Validation loss decreased (0.249672 --> 0.235812).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 13 cost time: 0.9644248485565186
Epoch: 13, Steps: 64 | Train Loss: 0.1606501 Vali Loss: 0.2256952 Test Loss: 0.2907409
Validation loss decreased (0.235812 --> 0.225695).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 14 cost time: 0.9324004650115967
Epoch: 14, Steps: 64 | Train Loss: 0.1573790 Vali Loss: 0.2140468 Test Loss: 0.2750973
Validation loss decreased (0.225695 --> 0.214047).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 15 cost time: 0.9163756370544434
Epoch: 15, Steps: 64 | Train Loss: 0.1554216 Vali Loss: 0.2084800 Test Loss: 0.2678240
Validation loss decreased (0.214047 --> 0.208480).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 16 cost time: 0.9168000221252441
Epoch: 16, Steps: 64 | Train Loss: 0.1523231 Vali Loss: 0.2046602 Test Loss: 0.2638637
Validation loss decreased (0.208480 --> 0.204660).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 17 cost time: 0.9362552165985107
Epoch: 17, Steps: 64 | Train Loss: 0.1505100 Vali Loss: 0.2017268 Test Loss: 0.2612956
Validation loss decreased (0.204660 --> 0.201727).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 18 cost time: 0.937636137008667
Epoch: 18, Steps: 64 | Train Loss: 0.1482565 Vali Loss: 0.1968329 Test Loss: 0.2554411
Validation loss decreased (0.201727 --> 0.196833).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 19 cost time: 0.9559996128082275
Epoch: 19, Steps: 64 | Train Loss: 0.1468300 Vali Loss: 0.1954288 Test Loss: 0.2523890
Validation loss decreased (0.196833 --> 0.195429).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 20 cost time: 0.9570193290710449
Epoch: 20, Steps: 64 | Train Loss: 0.1460974 Vali Loss: 0.1958519 Test Loss: 0.2536710
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 21 cost time: 0.9263589382171631
Epoch: 21, Steps: 64 | Train Loss: 0.1450256 Vali Loss: 0.1910512 Test Loss: 0.2467107
Validation loss decreased (0.195429 --> 0.191051).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 22 cost time: 0.9303522109985352
Epoch: 22, Steps: 64 | Train Loss: 0.1445370 Vali Loss: 0.1907910 Test Loss: 0.2466355
Validation loss decreased (0.191051 --> 0.190791).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 23 cost time: 0.9183511734008789
Epoch: 23, Steps: 64 | Train Loss: 0.1441504 Vali Loss: 0.1871567 Test Loss: 0.2438576
Validation loss decreased (0.190791 --> 0.187157).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 24 cost time: 0.9134900569915771
Epoch: 24, Steps: 64 | Train Loss: 0.1439375 Vali Loss: 0.1879422 Test Loss: 0.2434539
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 25 cost time: 0.9147758483886719
Epoch: 25, Steps: 64 | Train Loss: 0.1416146 Vali Loss: 0.1853035 Test Loss: 0.2427588
Validation loss decreased (0.187157 --> 0.185304).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 26 cost time: 0.9049997329711914
Epoch: 26, Steps: 64 | Train Loss: 0.1418213 Vali Loss: 0.1845626 Test Loss: 0.2417186
Validation loss decreased (0.185304 --> 0.184563).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 27 cost time: 0.9116265773773193
Epoch: 27, Steps: 64 | Train Loss: 0.1418191 Vali Loss: 0.1851480 Test Loss: 0.2415393
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 28 cost time: 0.9113912582397461
Epoch: 28, Steps: 64 | Train Loss: 0.1413210 Vali Loss: 0.1850303 Test Loss: 0.2407791
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 29 cost time: 0.9160056114196777
Epoch: 29, Steps: 64 | Train Loss: 0.1404371 Vali Loss: 0.1836226 Test Loss: 0.2402618
Validation loss decreased (0.184563 --> 0.183623).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 30 cost time: 0.9214019775390625
Epoch: 30, Steps: 64 | Train Loss: 0.1406100 Vali Loss: 0.1842157 Test Loss: 0.2392786
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 31 cost time: 0.9379892349243164
Epoch: 31, Steps: 64 | Train Loss: 0.1403781 Vali Loss: 0.1841771 Test Loss: 0.2418831
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 32 cost time: 0.9107255935668945
Epoch: 32, Steps: 64 | Train Loss: 0.1397565 Vali Loss: 0.1819876 Test Loss: 0.2389631
Validation loss decreased (0.183623 --> 0.181988).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 33 cost time: 0.9324431419372559
Epoch: 33, Steps: 64 | Train Loss: 0.1399250 Vali Loss: 0.1823412 Test Loss: 0.2393058
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 34 cost time: 0.9146232604980469
Epoch: 34, Steps: 64 | Train Loss: 0.1388987 Vali Loss: 0.1811959 Test Loss: 0.2387962
Validation loss decreased (0.181988 --> 0.181196).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 35 cost time: 0.9184153079986572
Epoch: 35, Steps: 64 | Train Loss: 0.1384559 Vali Loss: 0.1832179 Test Loss: 0.2411046
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 36 cost time: 0.941399097442627
Epoch: 36, Steps: 64 | Train Loss: 0.1387333 Vali Loss: 0.1786767 Test Loss: 0.2365554
Validation loss decreased (0.181196 --> 0.178677).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 37 cost time: 0.93434739112854
Epoch: 37, Steps: 64 | Train Loss: 0.1394489 Vali Loss: 0.1811958 Test Loss: 0.2388484
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 38 cost time: 0.9373683929443359
Epoch: 38, Steps: 64 | Train Loss: 0.1384865 Vali Loss: 0.1811962 Test Loss: 0.2402206
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 39 cost time: 0.929724931716919
Epoch: 39, Steps: 64 | Train Loss: 0.1387445 Vali Loss: 0.1817803 Test Loss: 0.2379278
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 40 cost time: 0.9267549514770508
Epoch: 40, Steps: 64 | Train Loss: 0.1393573 Vali Loss: 0.1803639 Test Loss: 0.2363731
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 41 cost time: 0.8977577686309814
Epoch: 41, Steps: 64 | Train Loss: 0.1389886 Vali Loss: 0.1788835 Test Loss: 0.2365955
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 42 cost time: 0.8986368179321289
Epoch: 42, Steps: 64 | Train Loss: 0.1376654 Vali Loss: 0.1827031 Test Loss: 0.2382209
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 43 cost time: 0.9013478755950928
Epoch: 43, Steps: 64 | Train Loss: 0.1390468 Vali Loss: 0.1822783 Test Loss: 0.2396959
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 44 cost time: 0.922419548034668
Epoch: 44, Steps: 64 | Train Loss: 0.1379340 Vali Loss: 0.1805623 Test Loss: 0.2369919
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 45 cost time: 0.9396276473999023
Epoch: 45, Steps: 64 | Train Loss: 0.1386099 Vali Loss: 0.1810952 Test Loss: 0.2377839
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 46 cost time: 0.932523250579834
Epoch: 46, Steps: 64 | Train Loss: 0.1372829 Vali Loss: 0.1799685 Test Loss: 0.2368634
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 47 cost time: 0.9389996528625488
Epoch: 47, Steps: 64 | Train Loss: 0.1377303 Vali Loss: 0.1820062 Test Loss: 0.2375877
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 48 cost time: 0.9379994869232178
Epoch: 48, Steps: 64 | Train Loss: 0.1373381 Vali Loss: 0.1799328 Test Loss: 0.2364054
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 49 cost time: 0.9326322078704834
Epoch: 49, Steps: 64 | Train Loss: 0.1376802 Vali Loss: 0.1812755 Test Loss: 0.2368667
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 50 cost time: 0.945986270904541
Epoch: 50, Steps: 64 | Train Loss: 0.1374998 Vali Loss: 0.1786089 Test Loss: 0.2350495
Validation loss decreased (0.178677 --> 0.178609).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 51 cost time: 0.9194352626800537
Epoch: 51, Steps: 64 | Train Loss: 0.1370189 Vali Loss: 0.1803956 Test Loss: 0.2378501
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 52 cost time: 0.914391040802002
Epoch: 52, Steps: 64 | Train Loss: 0.1374937 Vali Loss: 0.1784435 Test Loss: 0.2346843
Validation loss decreased (0.178609 --> 0.178443).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 53 cost time: 0.923912763595581
Epoch: 53, Steps: 64 | Train Loss: 0.1372646 Vali Loss: 0.1787711 Test Loss: 0.2364263
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 54 cost time: 0.9351711273193359
Epoch: 54, Steps: 64 | Train Loss: 0.1376495 Vali Loss: 0.1810346 Test Loss: 0.2381074
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 55 cost time: 0.9380021095275879
Epoch: 55, Steps: 64 | Train Loss: 0.1374357 Vali Loss: 0.1784854 Test Loss: 0.2338063
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 56 cost time: 0.9336526393890381
Epoch: 56, Steps: 64 | Train Loss: 0.1374364 Vali Loss: 0.1783793 Test Loss: 0.2370590
Validation loss decreased (0.178443 --> 0.178379).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 57 cost time: 0.9453456401824951
Epoch: 57, Steps: 64 | Train Loss: 0.1376788 Vali Loss: 0.1790970 Test Loss: 0.2370209
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 58 cost time: 0.9181313514709473
Epoch: 58, Steps: 64 | Train Loss: 0.1376475 Vali Loss: 0.1800142 Test Loss: 0.2373215
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 59 cost time: 0.9225070476531982
Epoch: 59, Steps: 64 | Train Loss: 0.1377144 Vali Loss: 0.1779348 Test Loss: 0.2377276
Validation loss decreased (0.178379 --> 0.177935).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 60 cost time: 0.9133040904998779
Epoch: 60, Steps: 64 | Train Loss: 0.1374379 Vali Loss: 0.1794629 Test Loss: 0.2373179
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23772765696048737, mae:0.3463822603225708, rse:0.24710071086883545
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.048218727111816406 GB
Epoch: 1 cost time: 2.3062427043914795
Epoch: 1, Steps: 64 | Train Loss: 1.0372584 Vali Loss: 2.7143826 Test Loss: 4.3423238
Validation loss decreased (inf --> 2.714383).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 2 cost time: 0.9496126174926758
Epoch: 2, Steps: 64 | Train Loss: 0.8264833 Vali Loss: 1.6779484 Test Loss: 2.6337709
Validation loss decreased (2.714383 --> 1.677948).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 3 cost time: 0.9557621479034424
Epoch: 3, Steps: 64 | Train Loss: 0.5377976 Vali Loss: 0.9813311 Test Loss: 1.4788977
Validation loss decreased (1.677948 --> 0.981331).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 4 cost time: 0.9516446590423584
Epoch: 4, Steps: 64 | Train Loss: 0.3391289 Vali Loss: 0.5450717 Test Loss: 0.7704440
Validation loss decreased (0.981331 --> 0.545072).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 5 cost time: 0.9343750476837158
Epoch: 5, Steps: 64 | Train Loss: 0.2273944 Vali Loss: 0.3458101 Test Loss: 0.4577292
Validation loss decreased (0.545072 --> 0.345810).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 6 cost time: 0.9263579845428467
Epoch: 6, Steps: 64 | Train Loss: 0.1789401 Vali Loss: 0.2566248 Test Loss: 0.3308601
Validation loss decreased (0.345810 --> 0.256625).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 7 cost time: 0.9474198818206787
Epoch: 7, Steps: 64 | Train Loss: 0.1590720 Vali Loss: 0.2226989 Test Loss: 0.2816924
Validation loss decreased (0.256625 --> 0.222699).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 8 cost time: 0.9294261932373047
Epoch: 8, Steps: 64 | Train Loss: 0.1499358 Vali Loss: 0.2048379 Test Loss: 0.2587693
Validation loss decreased (0.222699 --> 0.204838).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 9 cost time: 0.9247570037841797
Epoch: 9, Steps: 64 | Train Loss: 0.1429603 Vali Loss: 0.1944836 Test Loss: 0.2467495
Validation loss decreased (0.204838 --> 0.194484).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 10 cost time: 0.9668805599212646
Epoch: 10, Steps: 64 | Train Loss: 0.1405255 Vali Loss: 0.1913233 Test Loss: 0.2404830
Validation loss decreased (0.194484 --> 0.191323).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 11 cost time: 0.9779987335205078
Epoch: 11, Steps: 64 | Train Loss: 0.1371477 Vali Loss: 0.1910477 Test Loss: 0.2401312
Validation loss decreased (0.191323 --> 0.191048).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 12 cost time: 0.9736101627349854
Epoch: 12, Steps: 64 | Train Loss: 0.1347356 Vali Loss: 0.1849530 Test Loss: 0.2373236
Validation loss decreased (0.191048 --> 0.184953).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 13 cost time: 0.9689998626708984
Epoch: 13, Steps: 64 | Train Loss: 0.1326757 Vali Loss: 0.1836250 Test Loss: 0.2353702
Validation loss decreased (0.184953 --> 0.183625).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 14 cost time: 0.9513671398162842
Epoch: 14, Steps: 64 | Train Loss: 0.1312963 Vali Loss: 0.1815198 Test Loss: 0.2350227
Validation loss decreased (0.183625 --> 0.181520).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 15 cost time: 0.9464766979217529
Epoch: 15, Steps: 64 | Train Loss: 0.1302394 Vali Loss: 0.1829677 Test Loss: 0.2343438
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 16 cost time: 0.9569885730743408
Epoch: 16, Steps: 64 | Train Loss: 0.1289641 Vali Loss: 0.1799425 Test Loss: 0.2354287
Validation loss decreased (0.181520 --> 0.179942).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 17 cost time: 0.950026273727417
Epoch: 17, Steps: 64 | Train Loss: 0.1282744 Vali Loss: 0.1789436 Test Loss: 0.2341050
Validation loss decreased (0.179942 --> 0.178944).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 18 cost time: 0.910391092300415
Epoch: 18, Steps: 64 | Train Loss: 0.1276867 Vali Loss: 0.1762385 Test Loss: 0.2331740
Validation loss decreased (0.178944 --> 0.176239).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 19 cost time: 0.9207336902618408
Epoch: 19, Steps: 64 | Train Loss: 0.1265300 Vali Loss: 0.1773973 Test Loss: 0.2339540
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 20 cost time: 0.9534144401550293
Epoch: 20, Steps: 64 | Train Loss: 0.1262246 Vali Loss: 0.1784045 Test Loss: 0.2334372
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 21 cost time: 0.9526371955871582
Epoch: 21, Steps: 64 | Train Loss: 0.1259290 Vali Loss: 0.1757258 Test Loss: 0.2315169
Validation loss decreased (0.176239 --> 0.175726).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 22 cost time: 0.9423670768737793
Epoch: 22, Steps: 64 | Train Loss: 0.1253482 Vali Loss: 0.1763157 Test Loss: 0.2327831
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 23 cost time: 0.9294629096984863
Epoch: 23, Steps: 64 | Train Loss: 0.1252110 Vali Loss: 0.1771365 Test Loss: 0.2338698
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 24 cost time: 0.9343886375427246
Epoch: 24, Steps: 64 | Train Loss: 0.1241362 Vali Loss: 0.1763504 Test Loss: 0.2324268
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 25 cost time: 0.9397387504577637
Epoch: 25, Steps: 64 | Train Loss: 0.1243733 Vali Loss: 0.1752818 Test Loss: 0.2320714
Validation loss decreased (0.175726 --> 0.175282).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 26 cost time: 0.9293627738952637
Epoch: 26, Steps: 64 | Train Loss: 0.1244593 Vali Loss: 0.1744060 Test Loss: 0.2315681
Validation loss decreased (0.175282 --> 0.174406).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 27 cost time: 0.96573805809021
Epoch: 27, Steps: 64 | Train Loss: 0.1230401 Vali Loss: 0.1756280 Test Loss: 0.2310390
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 28 cost time: 0.9619998931884766
Epoch: 28, Steps: 64 | Train Loss: 0.1240505 Vali Loss: 0.1751385 Test Loss: 0.2319995
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 29 cost time: 0.9484281539916992
Epoch: 29, Steps: 64 | Train Loss: 0.1235147 Vali Loss: 0.1754097 Test Loss: 0.2307889
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 30 cost time: 0.9706275463104248
Epoch: 30, Steps: 64 | Train Loss: 0.1233927 Vali Loss: 0.1746427 Test Loss: 0.2317250
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 31 cost time: 0.9743704795837402
Epoch: 31, Steps: 64 | Train Loss: 0.1222836 Vali Loss: 0.1754351 Test Loss: 0.2317548
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 32 cost time: 0.9465024471282959
Epoch: 32, Steps: 64 | Train Loss: 0.1230416 Vali Loss: 0.1751937 Test Loss: 0.2321475
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 33 cost time: 0.9453573226928711
Epoch: 33, Steps: 64 | Train Loss: 0.1224511 Vali Loss: 0.1745940 Test Loss: 0.2313927
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 34 cost time: 0.9540181159973145
Epoch: 34, Steps: 64 | Train Loss: 0.1223051 Vali Loss: 0.1746200 Test Loss: 0.2327578
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 35 cost time: 0.9604828357696533
Epoch: 35, Steps: 64 | Train Loss: 0.1227972 Vali Loss: 0.1749278 Test Loss: 0.2319451
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 36 cost time: 0.9723272323608398
Epoch: 36, Steps: 64 | Train Loss: 0.1222573 Vali Loss: 0.1744252 Test Loss: 0.2325076
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 37 cost time: 0.9650003910064697
Epoch: 37, Steps: 64 | Train Loss: 0.1217837 Vali Loss: 0.1740931 Test Loss: 0.2318805
Validation loss decreased (0.174406 --> 0.174093).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 38 cost time: 0.9862515926361084
Epoch: 38, Steps: 64 | Train Loss: 0.1222016 Vali Loss: 0.1730783 Test Loss: 0.2317686
Validation loss decreased (0.174093 --> 0.173078).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 39 cost time: 0.9576315879821777
Epoch: 39, Steps: 64 | Train Loss: 0.1225995 Vali Loss: 0.1745075 Test Loss: 0.2312335
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 40 cost time: 0.9313879013061523
Epoch: 40, Steps: 64 | Train Loss: 0.1220803 Vali Loss: 0.1748028 Test Loss: 0.2323629
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 41 cost time: 0.9433977603912354
Epoch: 41, Steps: 64 | Train Loss: 0.1220189 Vali Loss: 0.1726789 Test Loss: 0.2309700
Validation loss decreased (0.173078 --> 0.172679).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 42 cost time: 0.931373119354248
Epoch: 42, Steps: 64 | Train Loss: 0.1222325 Vali Loss: 0.1732803 Test Loss: 0.2316232
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 43 cost time: 0.922358512878418
Epoch: 43, Steps: 64 | Train Loss: 0.1213328 Vali Loss: 0.1734116 Test Loss: 0.2313692
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 44 cost time: 0.9407169818878174
Epoch: 44, Steps: 64 | Train Loss: 0.1226352 Vali Loss: 0.1738993 Test Loss: 0.2309636
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 45 cost time: 0.9509978294372559
Epoch: 45, Steps: 64 | Train Loss: 0.1222524 Vali Loss: 0.1745993 Test Loss: 0.2312559
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 46 cost time: 0.9484426975250244
Epoch: 46, Steps: 64 | Train Loss: 0.1217598 Vali Loss: 0.1724103 Test Loss: 0.2315669
Validation loss decreased (0.172679 --> 0.172410).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 47 cost time: 0.9406232833862305
Epoch: 47, Steps: 64 | Train Loss: 0.1219727 Vali Loss: 0.1735533 Test Loss: 0.2306710
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 48 cost time: 0.9353790283203125
Epoch: 48, Steps: 64 | Train Loss: 0.1214135 Vali Loss: 0.1722726 Test Loss: 0.2307003
Validation loss decreased (0.172410 --> 0.172273).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 49 cost time: 0.9503729343414307
Epoch: 49, Steps: 64 | Train Loss: 0.1219751 Vali Loss: 0.1731708 Test Loss: 0.2311908
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 50 cost time: 0.9530453681945801
Epoch: 50, Steps: 64 | Train Loss: 0.1216193 Vali Loss: 0.1742115 Test Loss: 0.2313348
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 51 cost time: 0.9503536224365234
Epoch: 51, Steps: 64 | Train Loss: 0.1214705 Vali Loss: 0.1735075 Test Loss: 0.2301406
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 52 cost time: 0.9577395915985107
Epoch: 52, Steps: 64 | Train Loss: 0.1220809 Vali Loss: 0.1732354 Test Loss: 0.2302837
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 53 cost time: 0.9787373542785645
Epoch: 53, Steps: 64 | Train Loss: 0.1218371 Vali Loss: 0.1738758 Test Loss: 0.2302644
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 54 cost time: 0.9767951965332031
Epoch: 54, Steps: 64 | Train Loss: 0.1216635 Vali Loss: 0.1728266 Test Loss: 0.2322332
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 55 cost time: 0.9866347312927246
Epoch: 55, Steps: 64 | Train Loss: 0.1212383 Vali Loss: 0.1719583 Test Loss: 0.2311732
Validation loss decreased (0.172273 --> 0.171958).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 56 cost time: 0.9832184314727783
Epoch: 56, Steps: 64 | Train Loss: 0.1212283 Vali Loss: 0.1726204 Test Loss: 0.2304963
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 57 cost time: 0.9623973369598389
Epoch: 57, Steps: 64 | Train Loss: 0.1215876 Vali Loss: 0.1743991 Test Loss: 0.2327840
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 58 cost time: 0.9654088020324707
Epoch: 58, Steps: 64 | Train Loss: 0.1215683 Vali Loss: 0.1731559 Test Loss: 0.2309094
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 59 cost time: 0.9481492042541504
Epoch: 59, Steps: 64 | Train Loss: 0.1209787 Vali Loss: 0.1731263 Test Loss: 0.2304384
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 60 cost time: 0.9437956809997559
Epoch: 60, Steps: 64 | Train Loss: 0.1213208 Vali Loss: 0.1730530 Test Loss: 0.2315962
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23117318749427795, mae:0.3426516354084015, rse:0.24367044866085052
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.0487828254699707 GB
Epoch: 1 cost time: 2.2716007232666016
Epoch: 1, Steps: 64 | Train Loss: 0.8718079 Vali Loss: 2.3806155 Test Loss: 3.7940645
Validation loss decreased (inf --> 2.380615).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 2 cost time: 0.9158093929290771
Epoch: 2, Steps: 64 | Train Loss: 0.7318971 Vali Loss: 1.5577871 Test Loss: 2.4249032
Validation loss decreased (2.380615 --> 1.557787).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 3 cost time: 0.9142749309539795
Epoch: 3, Steps: 64 | Train Loss: 0.4775122 Vali Loss: 0.8301352 Test Loss: 1.2293133
Validation loss decreased (1.557787 --> 0.830135).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 4 cost time: 0.909616231918335
Epoch: 4, Steps: 64 | Train Loss: 0.2715290 Vali Loss: 0.4060043 Test Loss: 0.5446683
Validation loss decreased (0.830135 --> 0.406004).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 5 cost time: 0.9064178466796875
Epoch: 5, Steps: 64 | Train Loss: 0.1744378 Vali Loss: 0.2368931 Test Loss: 0.3012525
Validation loss decreased (0.406004 --> 0.236893).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 6 cost time: 0.8873856067657471
Epoch: 6, Steps: 64 | Train Loss: 0.1461903 Vali Loss: 0.1948940 Test Loss: 0.2504683
Validation loss decreased (0.236893 --> 0.194894).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 7 cost time: 0.8853702545166016
Epoch: 7, Steps: 64 | Train Loss: 0.1390399 Vali Loss: 0.1832208 Test Loss: 0.2384433
Validation loss decreased (0.194894 --> 0.183221).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 8 cost time: 0.8791565895080566
Epoch: 8, Steps: 64 | Train Loss: 0.1355691 Vali Loss: 0.1806657 Test Loss: 0.2359861
Validation loss decreased (0.183221 --> 0.180666).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 9 cost time: 0.8940005302429199
Epoch: 9, Steps: 64 | Train Loss: 0.1324427 Vali Loss: 0.1734631 Test Loss: 0.2338962
Validation loss decreased (0.180666 --> 0.173463).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 10 cost time: 0.9066264629364014
Epoch: 10, Steps: 64 | Train Loss: 0.1297564 Vali Loss: 0.1725595 Test Loss: 0.2314082
Validation loss decreased (0.173463 --> 0.172560).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 11 cost time: 0.9336376190185547
Epoch: 11, Steps: 64 | Train Loss: 0.1283076 Vali Loss: 0.1719012 Test Loss: 0.2312164
Validation loss decreased (0.172560 --> 0.171901).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 12 cost time: 0.9454903602600098
Epoch: 12, Steps: 64 | Train Loss: 0.1273436 Vali Loss: 0.1697356 Test Loss: 0.2279851
Validation loss decreased (0.171901 --> 0.169736).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 13 cost time: 0.942234992980957
Epoch: 13, Steps: 64 | Train Loss: 0.1260630 Vali Loss: 0.1700076 Test Loss: 0.2270614
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 14 cost time: 0.9234049320220947
Epoch: 14, Steps: 64 | Train Loss: 0.1248991 Vali Loss: 0.1662700 Test Loss: 0.2265097
Validation loss decreased (0.169736 --> 0.166270).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 15 cost time: 0.9154446125030518
Epoch: 15, Steps: 64 | Train Loss: 0.1239822 Vali Loss: 0.1664644 Test Loss: 0.2259871
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 16 cost time: 0.9118127822875977
Epoch: 16, Steps: 64 | Train Loss: 0.1231227 Vali Loss: 0.1644654 Test Loss: 0.2255836
Validation loss decreased (0.166270 --> 0.164465).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 17 cost time: 0.9200010299682617
Epoch: 17, Steps: 64 | Train Loss: 0.1227751 Vali Loss: 0.1649395 Test Loss: 0.2262479
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 18 cost time: 0.9186301231384277
Epoch: 18, Steps: 64 | Train Loss: 0.1221009 Vali Loss: 0.1645329 Test Loss: 0.2247789
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 19 cost time: 0.9253959655761719
Epoch: 19, Steps: 64 | Train Loss: 0.1214635 Vali Loss: 0.1639413 Test Loss: 0.2250308
Validation loss decreased (0.164465 --> 0.163941).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 20 cost time: 0.9153599739074707
Epoch: 20, Steps: 64 | Train Loss: 0.1211102 Vali Loss: 0.1635924 Test Loss: 0.2251946
Validation loss decreased (0.163941 --> 0.163592).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 21 cost time: 0.9178369045257568
Epoch: 21, Steps: 64 | Train Loss: 0.1211719 Vali Loss: 0.1639876 Test Loss: 0.2234927
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 22 cost time: 0.9039201736450195
Epoch: 22, Steps: 64 | Train Loss: 0.1209059 Vali Loss: 0.1643653 Test Loss: 0.2243747
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 23 cost time: 0.9099993705749512
Epoch: 23, Steps: 64 | Train Loss: 0.1203318 Vali Loss: 0.1638221 Test Loss: 0.2254668
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 24 cost time: 0.9000060558319092
Epoch: 24, Steps: 64 | Train Loss: 0.1206212 Vali Loss: 0.1636620 Test Loss: 0.2247096
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 25 cost time: 0.9013473987579346
Epoch: 25, Steps: 64 | Train Loss: 0.1197985 Vali Loss: 0.1610676 Test Loss: 0.2230969
Validation loss decreased (0.163592 --> 0.161068).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 26 cost time: 0.9039969444274902
Epoch: 26, Steps: 64 | Train Loss: 0.1199703 Vali Loss: 0.1632571 Test Loss: 0.2242420
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 27 cost time: 0.8894422054290771
Epoch: 27, Steps: 64 | Train Loss: 0.1194237 Vali Loss: 0.1643638 Test Loss: 0.2244041
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 28 cost time: 0.9083702564239502
Epoch: 28, Steps: 64 | Train Loss: 0.1193476 Vali Loss: 0.1631679 Test Loss: 0.2244108
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 29 cost time: 0.9157822132110596
Epoch: 29, Steps: 64 | Train Loss: 0.1190570 Vali Loss: 0.1626592 Test Loss: 0.2239509
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 30 cost time: 0.9280009269714355
Epoch: 30, Steps: 64 | Train Loss: 0.1189499 Vali Loss: 0.1625675 Test Loss: 0.2239605
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 31 cost time: 0.9146215915679932
Epoch: 31, Steps: 64 | Train Loss: 0.1190442 Vali Loss: 0.1620055 Test Loss: 0.2236051
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 32 cost time: 0.918142557144165
Epoch: 32, Steps: 64 | Train Loss: 0.1183354 Vali Loss: 0.1618808 Test Loss: 0.2233965
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 33 cost time: 0.9294960498809814
Epoch: 33, Steps: 64 | Train Loss: 0.1186285 Vali Loss: 0.1607935 Test Loss: 0.2245604
Validation loss decreased (0.161068 --> 0.160793).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 34 cost time: 0.915367603302002
Epoch: 34, Steps: 64 | Train Loss: 0.1187046 Vali Loss: 0.1621939 Test Loss: 0.2230854
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 35 cost time: 0.9167330265045166
Epoch: 35, Steps: 64 | Train Loss: 0.1182915 Vali Loss: 0.1635720 Test Loss: 0.2248246
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 36 cost time: 0.9290006160736084
Epoch: 36, Steps: 64 | Train Loss: 0.1187383 Vali Loss: 0.1621774 Test Loss: 0.2226001
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 37 cost time: 0.9419991970062256
Epoch: 37, Steps: 64 | Train Loss: 0.1180797 Vali Loss: 0.1626281 Test Loss: 0.2243168
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 38 cost time: 0.9486348628997803
Epoch: 38, Steps: 64 | Train Loss: 0.1180222 Vali Loss: 0.1627948 Test Loss: 0.2240831
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 39 cost time: 0.940852165222168
Epoch: 39, Steps: 64 | Train Loss: 0.1178005 Vali Loss: 0.1616007 Test Loss: 0.2237347
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 40 cost time: 0.9453723430633545
Epoch: 40, Steps: 64 | Train Loss: 0.1180585 Vali Loss: 0.1622473 Test Loss: 0.2240500
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 41 cost time: 0.9253659248352051
Epoch: 41, Steps: 64 | Train Loss: 0.1182120 Vali Loss: 0.1641751 Test Loss: 0.2239167
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 42 cost time: 0.8996922969818115
Epoch: 42, Steps: 64 | Train Loss: 0.1188421 Vali Loss: 0.1624735 Test Loss: 0.2239239
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 43 cost time: 0.9012761116027832
Epoch: 43, Steps: 64 | Train Loss: 0.1179933 Vali Loss: 0.1637571 Test Loss: 0.2236852
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 44 cost time: 0.8945767879486084
Epoch: 44, Steps: 64 | Train Loss: 0.1179088 Vali Loss: 0.1620970 Test Loss: 0.2230173
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 45 cost time: 0.9076371192932129
Epoch: 45, Steps: 64 | Train Loss: 0.1181022 Vali Loss: 0.1635493 Test Loss: 0.2243867
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 46 cost time: 0.909367561340332
Epoch: 46, Steps: 64 | Train Loss: 0.1176828 Vali Loss: 0.1643488 Test Loss: 0.2248004
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 47 cost time: 0.9304416179656982
Epoch: 47, Steps: 64 | Train Loss: 0.1178738 Vali Loss: 0.1631371 Test Loss: 0.2237140
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 48 cost time: 0.9205174446105957
Epoch: 48, Steps: 64 | Train Loss: 0.1181127 Vali Loss: 0.1635037 Test Loss: 0.2243879
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 49 cost time: 0.9204967021942139
Epoch: 49, Steps: 64 | Train Loss: 0.1177151 Vali Loss: 0.1620001 Test Loss: 0.2236470
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 50 cost time: 0.9089980125427246
Epoch: 50, Steps: 64 | Train Loss: 0.1173672 Vali Loss: 0.1632879 Test Loss: 0.2240853
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 51 cost time: 0.9126338958740234
Epoch: 51, Steps: 64 | Train Loss: 0.1180157 Vali Loss: 0.1631675 Test Loss: 0.2244364
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 52 cost time: 0.9106197357177734
Epoch: 52, Steps: 64 | Train Loss: 0.1171262 Vali Loss: 0.1609184 Test Loss: 0.2241844
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 53 cost time: 0.9242799282073975
Epoch: 53, Steps: 64 | Train Loss: 0.1179436 Vali Loss: 0.1633280 Test Loss: 0.2242478
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 54 cost time: 0.9428832530975342
Epoch: 54, Steps: 64 | Train Loss: 0.1172048 Vali Loss: 0.1630595 Test Loss: 0.2249859
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 55 cost time: 0.9545543193817139
Epoch: 55, Steps: 64 | Train Loss: 0.1179184 Vali Loss: 0.1629303 Test Loss: 0.2239935
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 56 cost time: 0.9459133148193359
Epoch: 56, Steps: 64 | Train Loss: 0.1174023 Vali Loss: 0.1634011 Test Loss: 0.2243713
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 57 cost time: 0.9487895965576172
Epoch: 57, Steps: 64 | Train Loss: 0.1178009 Vali Loss: 0.1619758 Test Loss: 0.2239573
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 58 cost time: 0.9290013313293457
Epoch: 58, Steps: 64 | Train Loss: 0.1179635 Vali Loss: 0.1635683 Test Loss: 0.2245904
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 59 cost time: 0.914635419845581
Epoch: 59, Steps: 64 | Train Loss: 0.1178624 Vali Loss: 0.1608900 Test Loss: 0.2234038
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 60 cost time: 0.9179942607879639
Epoch: 60, Steps: 64 | Train Loss: 0.1176130 Vali Loss: 0.1630354 Test Loss: 0.2237857
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22456037998199463, mae:0.3273276388645172, rse:0.2401600182056427
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.047678470611572266 GB
Epoch: 1 cost time: 2.3228609561920166
Epoch: 1, Steps: 64 | Train Loss: 0.9463403 Vali Loss: 2.1313152 Test Loss: 3.2722163
Validation loss decreased (inf --> 2.131315).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 2 cost time: 0.9313459396362305
Epoch: 2, Steps: 64 | Train Loss: 0.6442846 Vali Loss: 0.8197275 Test Loss: 1.1511444
Validation loss decreased (2.131315 --> 0.819727).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 3 cost time: 0.9263901710510254
Epoch: 3, Steps: 64 | Train Loss: 0.3603249 Vali Loss: 0.4553685 Test Loss: 0.5778061
Validation loss decreased (0.819727 --> 0.455368).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 4 cost time: 0.9305078983306885
Epoch: 4, Steps: 64 | Train Loss: 0.2558102 Vali Loss: 0.3357315 Test Loss: 0.4204506
Validation loss decreased (0.455368 --> 0.335732).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 5 cost time: 0.9264025688171387
Epoch: 5, Steps: 64 | Train Loss: 0.2192684 Vali Loss: 0.2819118 Test Loss: 0.3490604
Validation loss decreased (0.335732 --> 0.281912).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 6 cost time: 0.9040019512176514
Epoch: 6, Steps: 64 | Train Loss: 0.1987758 Vali Loss: 0.2530398 Test Loss: 0.3095938
Validation loss decreased (0.281912 --> 0.253040).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 7 cost time: 0.9126203060150146
Epoch: 7, Steps: 64 | Train Loss: 0.1869247 Vali Loss: 0.2385840 Test Loss: 0.2883301
Validation loss decreased (0.253040 --> 0.238584).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 8 cost time: 0.9233815670013428
Epoch: 8, Steps: 64 | Train Loss: 0.1780620 Vali Loss: 0.2215228 Test Loss: 0.2728217
Validation loss decreased (0.238584 --> 0.221523).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 9 cost time: 0.9119954109191895
Epoch: 9, Steps: 64 | Train Loss: 0.1711809 Vali Loss: 0.2161802 Test Loss: 0.2612415
Validation loss decreased (0.221523 --> 0.216180).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 10 cost time: 0.9384093284606934
Epoch: 10, Steps: 64 | Train Loss: 0.1662762 Vali Loss: 0.2101114 Test Loss: 0.2545368
Validation loss decreased (0.216180 --> 0.210111).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 11 cost time: 0.9554028511047363
Epoch: 11, Steps: 64 | Train Loss: 0.1630813 Vali Loss: 0.2070222 Test Loss: 0.2496942
Validation loss decreased (0.210111 --> 0.207022).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 12 cost time: 0.9447343349456787
Epoch: 12, Steps: 64 | Train Loss: 0.1587315 Vali Loss: 0.2008848 Test Loss: 0.2433479
Validation loss decreased (0.207022 --> 0.200885).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 13 cost time: 0.9518063068389893
Epoch: 13, Steps: 64 | Train Loss: 0.1563432 Vali Loss: 0.1965717 Test Loss: 0.2402766
Validation loss decreased (0.200885 --> 0.196572).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 14 cost time: 0.9299981594085693
Epoch: 14, Steps: 64 | Train Loss: 0.1542758 Vali Loss: 0.1929941 Test Loss: 0.2389114
Validation loss decreased (0.196572 --> 0.192994).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 15 cost time: 0.9286110401153564
Epoch: 15, Steps: 64 | Train Loss: 0.1524563 Vali Loss: 0.1905800 Test Loss: 0.2356016
Validation loss decreased (0.192994 --> 0.190580).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 16 cost time: 0.9334049224853516
Epoch: 16, Steps: 64 | Train Loss: 0.1506424 Vali Loss: 0.1930677 Test Loss: 0.2380731
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 17 cost time: 0.9283552169799805
Epoch: 17, Steps: 64 | Train Loss: 0.1497330 Vali Loss: 0.1916070 Test Loss: 0.2361004
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 18 cost time: 0.9449903964996338
Epoch: 18, Steps: 64 | Train Loss: 0.1490881 Vali Loss: 0.1916986 Test Loss: 0.2358307
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 19 cost time: 0.9494037628173828
Epoch: 19, Steps: 64 | Train Loss: 0.1473715 Vali Loss: 0.1906004 Test Loss: 0.2346771
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 20 cost time: 0.949739933013916
Epoch: 20, Steps: 64 | Train Loss: 0.1460029 Vali Loss: 0.1871623 Test Loss: 0.2344706
Validation loss decreased (0.190580 --> 0.187162).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 21 cost time: 0.9287497997283936
Epoch: 21, Steps: 64 | Train Loss: 0.1453578 Vali Loss: 0.1872011 Test Loss: 0.2331928
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 22 cost time: 0.9306325912475586
Epoch: 22, Steps: 64 | Train Loss: 0.1441769 Vali Loss: 0.1857652 Test Loss: 0.2347220
Validation loss decreased (0.187162 --> 0.185765).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 23 cost time: 0.9156253337860107
Epoch: 23, Steps: 64 | Train Loss: 0.1445829 Vali Loss: 0.1858142 Test Loss: 0.2326444
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 24 cost time: 0.9093551635742188
Epoch: 24, Steps: 64 | Train Loss: 0.1437421 Vali Loss: 0.1852976 Test Loss: 0.2334498
Validation loss decreased (0.185765 --> 0.185298).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 25 cost time: 0.9303951263427734
Epoch: 25, Steps: 64 | Train Loss: 0.1430999 Vali Loss: 0.1867296 Test Loss: 0.2335401
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 26 cost time: 0.9154529571533203
Epoch: 26, Steps: 64 | Train Loss: 0.1423535 Vali Loss: 0.1837018 Test Loss: 0.2320210
Validation loss decreased (0.185298 --> 0.183702).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 27 cost time: 0.9243464469909668
Epoch: 27, Steps: 64 | Train Loss: 0.1428368 Vali Loss: 0.1813057 Test Loss: 0.2311589
Validation loss decreased (0.183702 --> 0.181306).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 28 cost time: 0.9288120269775391
Epoch: 28, Steps: 64 | Train Loss: 0.1421050 Vali Loss: 0.1858512 Test Loss: 0.2327004
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 29 cost time: 0.9320008754730225
Epoch: 29, Steps: 64 | Train Loss: 0.1416259 Vali Loss: 0.1834104 Test Loss: 0.2325835
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 30 cost time: 0.9319696426391602
Epoch: 30, Steps: 64 | Train Loss: 0.1415107 Vali Loss: 0.1830049 Test Loss: 0.2323396
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 31 cost time: 0.9492518901824951
Epoch: 31, Steps: 64 | Train Loss: 0.1415835 Vali Loss: 0.1823061 Test Loss: 0.2311709
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 32 cost time: 0.9413213729858398
Epoch: 32, Steps: 64 | Train Loss: 0.1408938 Vali Loss: 0.1831223 Test Loss: 0.2324129
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 33 cost time: 0.9455335140228271
Epoch: 33, Steps: 64 | Train Loss: 0.1410151 Vali Loss: 0.1815315 Test Loss: 0.2319625
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 34 cost time: 0.9441487789154053
Epoch: 34, Steps: 64 | Train Loss: 0.1398901 Vali Loss: 0.1825072 Test Loss: 0.2322905
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 35 cost time: 0.9593849182128906
Epoch: 35, Steps: 64 | Train Loss: 0.1396108 Vali Loss: 0.1843077 Test Loss: 0.2326796
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 36 cost time: 0.9667153358459473
Epoch: 36, Steps: 64 | Train Loss: 0.1396565 Vali Loss: 0.1829619 Test Loss: 0.2320078
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 37 cost time: 0.9678237438201904
Epoch: 37, Steps: 64 | Train Loss: 0.1390526 Vali Loss: 0.1841742 Test Loss: 0.2324698
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 38 cost time: 0.9599997997283936
Epoch: 38, Steps: 64 | Train Loss: 0.1390132 Vali Loss: 0.1837155 Test Loss: 0.2331565
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 39 cost time: 0.9546291828155518
Epoch: 39, Steps: 64 | Train Loss: 0.1393006 Vali Loss: 0.1819500 Test Loss: 0.2323624
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 40 cost time: 0.9273662567138672
Epoch: 40, Steps: 64 | Train Loss: 0.1391222 Vali Loss: 0.1827783 Test Loss: 0.2318608
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 41 cost time: 0.9213924407958984
Epoch: 41, Steps: 64 | Train Loss: 0.1386284 Vali Loss: 0.1834199 Test Loss: 0.2322394
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 42 cost time: 0.9159994125366211
Epoch: 42, Steps: 64 | Train Loss: 0.1397645 Vali Loss: 0.1811046 Test Loss: 0.2316974
Validation loss decreased (0.181306 --> 0.181105).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 43 cost time: 0.9045350551605225
Epoch: 43, Steps: 64 | Train Loss: 0.1385616 Vali Loss: 0.1818367 Test Loss: 0.2320551
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 44 cost time: 0.927741289138794
Epoch: 44, Steps: 64 | Train Loss: 0.1387652 Vali Loss: 0.1809596 Test Loss: 0.2315741
Validation loss decreased (0.181105 --> 0.180960).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 45 cost time: 0.9260003566741943
Epoch: 45, Steps: 64 | Train Loss: 0.1383064 Vali Loss: 0.1839525 Test Loss: 0.2319903
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 46 cost time: 0.934546709060669
Epoch: 46, Steps: 64 | Train Loss: 0.1391290 Vali Loss: 0.1796699 Test Loss: 0.2317998
Validation loss decreased (0.180960 --> 0.179670).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 47 cost time: 0.9239649772644043
Epoch: 47, Steps: 64 | Train Loss: 0.1385542 Vali Loss: 0.1815654 Test Loss: 0.2308033
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 48 cost time: 0.9164843559265137
Epoch: 48, Steps: 64 | Train Loss: 0.1384388 Vali Loss: 0.1811211 Test Loss: 0.2312344
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 49 cost time: 0.9253768920898438
Epoch: 49, Steps: 64 | Train Loss: 0.1379506 Vali Loss: 0.1794528 Test Loss: 0.2314243
Validation loss decreased (0.179670 --> 0.179453).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 50 cost time: 0.9143824577331543
Epoch: 50, Steps: 64 | Train Loss: 0.1378903 Vali Loss: 0.1811721 Test Loss: 0.2314317
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 51 cost time: 0.9277918338775635
Epoch: 51, Steps: 64 | Train Loss: 0.1383374 Vali Loss: 0.1831654 Test Loss: 0.2326116
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 52 cost time: 0.9357168674468994
Epoch: 52, Steps: 64 | Train Loss: 0.1379699 Vali Loss: 0.1807225 Test Loss: 0.2314221
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 53 cost time: 0.9039995670318604
Epoch: 53, Steps: 64 | Train Loss: 0.1386285 Vali Loss: 0.1812977 Test Loss: 0.2311966
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 54 cost time: 0.9476363658905029
Epoch: 54, Steps: 64 | Train Loss: 0.1373818 Vali Loss: 0.1810849 Test Loss: 0.2326511
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 55 cost time: 0.9533507823944092
Epoch: 55, Steps: 64 | Train Loss: 0.1381203 Vali Loss: 0.1814509 Test Loss: 0.2319821
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 56 cost time: 0.9434080123901367
Epoch: 56, Steps: 64 | Train Loss: 0.1382572 Vali Loss: 0.1831311 Test Loss: 0.2317121
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 57 cost time: 0.9167273044586182
Epoch: 57, Steps: 64 | Train Loss: 0.1374091 Vali Loss: 0.1825687 Test Loss: 0.2318109
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 58 cost time: 0.9224212169647217
Epoch: 58, Steps: 64 | Train Loss: 0.1384454 Vali Loss: 0.1811910 Test Loss: 0.2311657
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 59 cost time: 0.926738977432251
Epoch: 59, Steps: 64 | Train Loss: 0.1385758 Vali Loss: 0.1803121 Test Loss: 0.2311286
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 60 cost time: 0.9223611354827881
Epoch: 60, Steps: 64 | Train Loss: 0.1381524 Vali Loss: 0.1805702 Test Loss: 0.2310828
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2314242422580719, mae:0.34703537821769714, rse:0.2438027262687683
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04837989807128906 GB
Epoch: 1 cost time: 2.317230224609375
Epoch: 1, Steps: 64 | Train Loss: 0.9881802 Vali Loss: 2.5727696 Test Loss: 4.0812659
Validation loss decreased (inf --> 2.572770).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 2 cost time: 0.9696440696716309
Epoch: 2, Steps: 64 | Train Loss: 0.7496522 Vali Loss: 1.4171504 Test Loss: 2.1275966
Validation loss decreased (2.572770 --> 1.417150).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 3 cost time: 0.966372013092041
Epoch: 3, Steps: 64 | Train Loss: 0.4453393 Vali Loss: 0.7962495 Test Loss: 1.1317840
Validation loss decreased (1.417150 --> 0.796250).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 4 cost time: 0.9723389148712158
Epoch: 4, Steps: 64 | Train Loss: 0.2877560 Vali Loss: 0.4917175 Test Loss: 0.6650252
Validation loss decreased (0.796250 --> 0.491718).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 5 cost time: 0.9550752639770508
Epoch: 5, Steps: 64 | Train Loss: 0.2093626 Vali Loss: 0.3342449 Test Loss: 0.4405819
Validation loss decreased (0.491718 --> 0.334245).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 6 cost time: 0.945441484451294
Epoch: 6, Steps: 64 | Train Loss: 0.1727857 Vali Loss: 0.2613751 Test Loss: 0.3359565
Validation loss decreased (0.334245 --> 0.261375).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 7 cost time: 0.9383540153503418
Epoch: 7, Steps: 64 | Train Loss: 0.1544025 Vali Loss: 0.2236973 Test Loss: 0.2851135
Validation loss decreased (0.261375 --> 0.223697).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 8 cost time: 0.9513711929321289
Epoch: 8, Steps: 64 | Train Loss: 0.1461988 Vali Loss: 0.2033259 Test Loss: 0.2591935
Validation loss decreased (0.223697 --> 0.203326).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 9 cost time: 0.9563543796539307
Epoch: 9, Steps: 64 | Train Loss: 0.1397879 Vali Loss: 0.1917284 Test Loss: 0.2454910
Validation loss decreased (0.203326 --> 0.191728).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 10 cost time: 0.9749977588653564
Epoch: 10, Steps: 64 | Train Loss: 0.1371527 Vali Loss: 0.1890742 Test Loss: 0.2383574
Validation loss decreased (0.191728 --> 0.189074).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 11 cost time: 0.9989972114562988
Epoch: 11, Steps: 64 | Train Loss: 0.1349435 Vali Loss: 0.1882263 Test Loss: 0.2368492
Validation loss decreased (0.189074 --> 0.188226).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 12 cost time: 0.9986453056335449
Epoch: 12, Steps: 64 | Train Loss: 0.1328956 Vali Loss: 0.1791995 Test Loss: 0.2315542
Validation loss decreased (0.188226 --> 0.179200).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 13 cost time: 1.005622386932373
Epoch: 13, Steps: 64 | Train Loss: 0.1312116 Vali Loss: 0.1776658 Test Loss: 0.2312076
Validation loss decreased (0.179200 --> 0.177666).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 14 cost time: 0.9843864440917969
Epoch: 14, Steps: 64 | Train Loss: 0.1297767 Vali Loss: 0.1769537 Test Loss: 0.2303548
Validation loss decreased (0.177666 --> 0.176954).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 15 cost time: 0.9764525890350342
Epoch: 15, Steps: 64 | Train Loss: 0.1287269 Vali Loss: 0.1765211 Test Loss: 0.2295425
Validation loss decreased (0.176954 --> 0.176521).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 16 cost time: 0.9914331436157227
Epoch: 16, Steps: 64 | Train Loss: 0.1279762 Vali Loss: 0.1766746 Test Loss: 0.2302594
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 17 cost time: 0.9804513454437256
Epoch: 17, Steps: 64 | Train Loss: 0.1277995 Vali Loss: 0.1744586 Test Loss: 0.2298407
Validation loss decreased (0.176521 --> 0.174459).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 18 cost time: 1.001729965209961
Epoch: 18, Steps: 64 | Train Loss: 0.1269297 Vali Loss: 0.1734345 Test Loss: 0.2277437
Validation loss decreased (0.174459 --> 0.173435).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 19 cost time: 0.9994790554046631
Epoch: 19, Steps: 64 | Train Loss: 0.1265811 Vali Loss: 0.1745120 Test Loss: 0.2292083
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 20 cost time: 0.971343994140625
Epoch: 20, Steps: 64 | Train Loss: 0.1262196 Vali Loss: 0.1743736 Test Loss: 0.2297206
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 21 cost time: 0.9803595542907715
Epoch: 21, Steps: 64 | Train Loss: 0.1253704 Vali Loss: 0.1732220 Test Loss: 0.2286367
Validation loss decreased (0.173435 --> 0.173222).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 22 cost time: 0.9649989604949951
Epoch: 22, Steps: 64 | Train Loss: 0.1246044 Vali Loss: 0.1733814 Test Loss: 0.2296173
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 23 cost time: 0.9720005989074707
Epoch: 23, Steps: 64 | Train Loss: 0.1250269 Vali Loss: 0.1751065 Test Loss: 0.2292972
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 24 cost time: 0.9576303958892822
Epoch: 24, Steps: 64 | Train Loss: 0.1242283 Vali Loss: 0.1736429 Test Loss: 0.2284877
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 25 cost time: 0.9463841915130615
Epoch: 25, Steps: 64 | Train Loss: 0.1233335 Vali Loss: 0.1726707 Test Loss: 0.2293391
Validation loss decreased (0.173222 --> 0.172671).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 26 cost time: 0.9664289951324463
Epoch: 26, Steps: 64 | Train Loss: 0.1232186 Vali Loss: 0.1734174 Test Loss: 0.2292869
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 27 cost time: 0.9538037776947021
Epoch: 27, Steps: 64 | Train Loss: 0.1236879 Vali Loss: 0.1725497 Test Loss: 0.2284157
Validation loss decreased (0.172671 --> 0.172550).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 28 cost time: 0.9644005298614502
Epoch: 28, Steps: 64 | Train Loss: 0.1225958 Vali Loss: 0.1717884 Test Loss: 0.2293008
Validation loss decreased (0.172550 --> 0.171788).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 29 cost time: 0.9958384037017822
Epoch: 29, Steps: 64 | Train Loss: 0.1230306 Vali Loss: 0.1720466 Test Loss: 0.2294454
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 30 cost time: 0.9713623523712158
Epoch: 30, Steps: 64 | Train Loss: 0.1229583 Vali Loss: 0.1712879 Test Loss: 0.2294067
Validation loss decreased (0.171788 --> 0.171288).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 31 cost time: 0.9687376022338867
Epoch: 31, Steps: 64 | Train Loss: 0.1230162 Vali Loss: 0.1730924 Test Loss: 0.2285837
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 32 cost time: 0.966001033782959
Epoch: 32, Steps: 64 | Train Loss: 0.1226340 Vali Loss: 0.1720649 Test Loss: 0.2291089
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 33 cost time: 0.9625439643859863
Epoch: 33, Steps: 64 | Train Loss: 0.1229962 Vali Loss: 0.1712103 Test Loss: 0.2290196
Validation loss decreased (0.171288 --> 0.171210).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 34 cost time: 0.9946141242980957
Epoch: 34, Steps: 64 | Train Loss: 0.1219773 Vali Loss: 0.1738877 Test Loss: 0.2289687
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 35 cost time: 1.0016593933105469
Epoch: 35, Steps: 64 | Train Loss: 0.1222610 Vali Loss: 0.1706829 Test Loss: 0.2297574
Validation loss decreased (0.171210 --> 0.170683).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 36 cost time: 1.0093333721160889
Epoch: 36, Steps: 64 | Train Loss: 0.1218187 Vali Loss: 0.1728819 Test Loss: 0.2293142
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 37 cost time: 1.0044617652893066
Epoch: 37, Steps: 64 | Train Loss: 0.1219675 Vali Loss: 0.1705540 Test Loss: 0.2292090
Validation loss decreased (0.170683 --> 0.170554).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 38 cost time: 0.9903535842895508
Epoch: 38, Steps: 64 | Train Loss: 0.1220140 Vali Loss: 0.1718845 Test Loss: 0.2293462
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 39 cost time: 0.9654297828674316
Epoch: 39, Steps: 64 | Train Loss: 0.1218763 Vali Loss: 0.1723734 Test Loss: 0.2289387
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 40 cost time: 0.9663629531860352
Epoch: 40, Steps: 64 | Train Loss: 0.1216752 Vali Loss: 0.1727728 Test Loss: 0.2292278
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 41 cost time: 0.9564108848571777
Epoch: 41, Steps: 64 | Train Loss: 0.1219160 Vali Loss: 0.1716323 Test Loss: 0.2289264
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 42 cost time: 0.9567868709564209
Epoch: 42, Steps: 64 | Train Loss: 0.1221945 Vali Loss: 0.1708828 Test Loss: 0.2288622
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 43 cost time: 0.9659998416900635
Epoch: 43, Steps: 64 | Train Loss: 0.1213111 Vali Loss: 0.1718237 Test Loss: 0.2295205
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 44 cost time: 0.9639992713928223
Epoch: 44, Steps: 64 | Train Loss: 0.1213275 Vali Loss: 0.1711308 Test Loss: 0.2285104
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 45 cost time: 0.9676268100738525
Epoch: 45, Steps: 64 | Train Loss: 0.1214980 Vali Loss: 0.1710429 Test Loss: 0.2300770
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 46 cost time: 0.9634244441986084
Epoch: 46, Steps: 64 | Train Loss: 0.1217052 Vali Loss: 0.1712228 Test Loss: 0.2294580
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 47 cost time: 0.9497666358947754
Epoch: 47, Steps: 64 | Train Loss: 0.1209546 Vali Loss: 0.1716063 Test Loss: 0.2295352
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 48 cost time: 0.9754006862640381
Epoch: 48, Steps: 64 | Train Loss: 0.1216459 Vali Loss: 0.1710668 Test Loss: 0.2290003
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 49 cost time: 0.9753954410552979
Epoch: 49, Steps: 64 | Train Loss: 0.1213325 Vali Loss: 0.1702666 Test Loss: 0.2289685
Validation loss decreased (0.170554 --> 0.170267).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 50 cost time: 0.9649522304534912
Epoch: 50, Steps: 64 | Train Loss: 0.1215310 Vali Loss: 0.1727452 Test Loss: 0.2288423
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 51 cost time: 0.9843738079071045
Epoch: 51, Steps: 64 | Train Loss: 0.1213038 Vali Loss: 0.1735775 Test Loss: 0.2294183
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 52 cost time: 0.9887254238128662
Epoch: 52, Steps: 64 | Train Loss: 0.1209136 Vali Loss: 0.1723302 Test Loss: 0.2290665
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 53 cost time: 0.981848955154419
Epoch: 53, Steps: 64 | Train Loss: 0.1212072 Vali Loss: 0.1718615 Test Loss: 0.2294634
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 54 cost time: 0.9900000095367432
Epoch: 54, Steps: 64 | Train Loss: 0.1213136 Vali Loss: 0.1719146 Test Loss: 0.2300775
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 55 cost time: 0.9686233997344971
Epoch: 55, Steps: 64 | Train Loss: 0.1215034 Vali Loss: 0.1697752 Test Loss: 0.2290403
Validation loss decreased (0.170267 --> 0.169775).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 56 cost time: 0.9666280746459961
Epoch: 56, Steps: 64 | Train Loss: 0.1207652 Vali Loss: 0.1708243 Test Loss: 0.2294428
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 57 cost time: 0.9503626823425293
Epoch: 57, Steps: 64 | Train Loss: 0.1214069 Vali Loss: 0.1709488 Test Loss: 0.2293280
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 58 cost time: 0.9583740234375
Epoch: 58, Steps: 64 | Train Loss: 0.1213682 Vali Loss: 0.1708306 Test Loss: 0.2293400
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 59 cost time: 0.9613571166992188
Epoch: 59, Steps: 64 | Train Loss: 0.1213671 Vali Loss: 0.1704658 Test Loss: 0.2287004
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 60 cost time: 0.9723536968231201
Epoch: 60, Steps: 64 | Train Loss: 0.1214161 Vali Loss: 0.1703296 Test Loss: 0.2289314
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.229040265083313, mae:0.3445587158203125, rse:0.24254374206066132
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.04894399642944336 GB
Epoch: 1 cost time: 2.351613998413086
Epoch: 1, Steps: 64 | Train Loss: 0.9564858 Vali Loss: 2.6069102 Test Loss: 4.1681118
Validation loss decreased (inf --> 2.606910).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 2 cost time: 1.0096890926361084
Epoch: 2, Steps: 64 | Train Loss: 0.8008285 Vali Loss: 1.7055869 Test Loss: 2.6533070
Validation loss decreased (2.606910 --> 1.705587).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 3 cost time: 1.0004050731658936
Epoch: 3, Steps: 64 | Train Loss: 0.5069792 Vali Loss: 0.8401895 Test Loss: 1.2325022
Validation loss decreased (1.705587 --> 0.840190).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 4 cost time: 1.0013656616210938
Epoch: 4, Steps: 64 | Train Loss: 0.2801883 Vali Loss: 0.3921086 Test Loss: 0.5119039
Validation loss decreased (0.840190 --> 0.392109).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 5 cost time: 0.991830587387085
Epoch: 5, Steps: 64 | Train Loss: 0.1756472 Vali Loss: 0.2384068 Test Loss: 0.2858673
Validation loss decreased (0.392109 --> 0.238407).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 6 cost time: 0.9829995632171631
Epoch: 6, Steps: 64 | Train Loss: 0.1493125 Vali Loss: 0.2033770 Test Loss: 0.2445175
Validation loss decreased (0.238407 --> 0.203377).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 7 cost time: 0.9856219291687012
Epoch: 7, Steps: 64 | Train Loss: 0.1399997 Vali Loss: 0.1922630 Test Loss: 0.2366062
Validation loss decreased (0.203377 --> 0.192263).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 8 cost time: 0.9796276092529297
Epoch: 8, Steps: 64 | Train Loss: 0.1354405 Vali Loss: 0.1827902 Test Loss: 0.2353077
Validation loss decreased (0.192263 --> 0.182790).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 9 cost time: 0.9813406467437744
Epoch: 9, Steps: 64 | Train Loss: 0.1324779 Vali Loss: 0.1782262 Test Loss: 0.2301257
Validation loss decreased (0.182790 --> 0.178226).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 10 cost time: 1.0083692073822021
Epoch: 10, Steps: 64 | Train Loss: 0.1302026 Vali Loss: 0.1787867 Test Loss: 0.2314401
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 11 cost time: 1.01035737991333
Epoch: 11, Steps: 64 | Train Loss: 0.1280011 Vali Loss: 0.1751494 Test Loss: 0.2287598
Validation loss decreased (0.178226 --> 0.175149).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 12 cost time: 1.0083856582641602
Epoch: 12, Steps: 64 | Train Loss: 0.1269024 Vali Loss: 0.1748665 Test Loss: 0.2277818
Validation loss decreased (0.175149 --> 0.174866).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 13 cost time: 0.9931156635284424
Epoch: 13, Steps: 64 | Train Loss: 0.1254819 Vali Loss: 0.1729113 Test Loss: 0.2277880
Validation loss decreased (0.174866 --> 0.172911).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 14 cost time: 0.982433557510376
Epoch: 14, Steps: 64 | Train Loss: 0.1250298 Vali Loss: 0.1738374 Test Loss: 0.2294385
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 15 cost time: 1.0014698505401611
Epoch: 15, Steps: 64 | Train Loss: 0.1235811 Vali Loss: 0.1696158 Test Loss: 0.2276240
Validation loss decreased (0.172911 --> 0.169616).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 16 cost time: 0.9833626747131348
Epoch: 16, Steps: 64 | Train Loss: 0.1231722 Vali Loss: 0.1729832 Test Loss: 0.2285438
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 17 cost time: 0.9897944927215576
Epoch: 17, Steps: 64 | Train Loss: 0.1224642 Vali Loss: 0.1706698 Test Loss: 0.2275004
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 18 cost time: 1.0047271251678467
Epoch: 18, Steps: 64 | Train Loss: 0.1214408 Vali Loss: 0.1702038 Test Loss: 0.2275074
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 19 cost time: 0.9679996967315674
Epoch: 19, Steps: 64 | Train Loss: 0.1215537 Vali Loss: 0.1698009 Test Loss: 0.2286234
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 20 cost time: 0.983041524887085
Epoch: 20, Steps: 64 | Train Loss: 0.1209208 Vali Loss: 0.1698887 Test Loss: 0.2276545
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 21 cost time: 1.0036909580230713
Epoch: 21, Steps: 64 | Train Loss: 0.1204670 Vali Loss: 0.1693425 Test Loss: 0.2285816
Validation loss decreased (0.169616 --> 0.169343).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 22 cost time: 0.9814131259918213
Epoch: 22, Steps: 64 | Train Loss: 0.1202645 Vali Loss: 0.1698538 Test Loss: 0.2295662
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 23 cost time: 0.9813544750213623
Epoch: 23, Steps: 64 | Train Loss: 0.1201399 Vali Loss: 0.1694795 Test Loss: 0.2277230
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 24 cost time: 0.9877760410308838
Epoch: 24, Steps: 64 | Train Loss: 0.1195646 Vali Loss: 0.1680631 Test Loss: 0.2275270
Validation loss decreased (0.169343 --> 0.168063).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 25 cost time: 0.9884014129638672
Epoch: 25, Steps: 64 | Train Loss: 0.1196736 Vali Loss: 0.1675591 Test Loss: 0.2280971
Validation loss decreased (0.168063 --> 0.167559).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 26 cost time: 1.001338243484497
Epoch: 26, Steps: 64 | Train Loss: 0.1188709 Vali Loss: 0.1680321 Test Loss: 0.2284496
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 27 cost time: 0.9813544750213623
Epoch: 27, Steps: 64 | Train Loss: 0.1192653 Vali Loss: 0.1694161 Test Loss: 0.2280453
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 28 cost time: 0.9956405162811279
Epoch: 28, Steps: 64 | Train Loss: 0.1185572 Vali Loss: 0.1704826 Test Loss: 0.2298068
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 29 cost time: 1.0017390251159668
Epoch: 29, Steps: 64 | Train Loss: 0.1188390 Vali Loss: 0.1699853 Test Loss: 0.2292135
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 30 cost time: 0.9827499389648438
Epoch: 30, Steps: 64 | Train Loss: 0.1189952 Vali Loss: 0.1689858 Test Loss: 0.2282436
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 31 cost time: 0.9860012531280518
Epoch: 31, Steps: 64 | Train Loss: 0.1187163 Vali Loss: 0.1678196 Test Loss: 0.2283372
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 32 cost time: 1.0176329612731934
Epoch: 32, Steps: 64 | Train Loss: 0.1189183 Vali Loss: 0.1695917 Test Loss: 0.2290027
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 33 cost time: 0.9826340675354004
Epoch: 33, Steps: 64 | Train Loss: 0.1181799 Vali Loss: 0.1681029 Test Loss: 0.2291747
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 34 cost time: 1.0080926418304443
Epoch: 34, Steps: 64 | Train Loss: 0.1184625 Vali Loss: 0.1708029 Test Loss: 0.2295806
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 35 cost time: 1.0174484252929688
Epoch: 35, Steps: 64 | Train Loss: 0.1183875 Vali Loss: 0.1679448 Test Loss: 0.2296388
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 36 cost time: 1.019289255142212
Epoch: 36, Steps: 64 | Train Loss: 0.1185761 Vali Loss: 0.1690274 Test Loss: 0.2278095
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 37 cost time: 1.0123190879821777
Epoch: 37, Steps: 64 | Train Loss: 0.1179086 Vali Loss: 0.1683528 Test Loss: 0.2278918
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 38 cost time: 0.9783356189727783
Epoch: 38, Steps: 64 | Train Loss: 0.1176061 Vali Loss: 0.1698700 Test Loss: 0.2287202
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 39 cost time: 0.9644393920898438
Epoch: 39, Steps: 64 | Train Loss: 0.1180173 Vali Loss: 0.1672523 Test Loss: 0.2302500
Validation loss decreased (0.167559 --> 0.167252).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 40 cost time: 0.962346076965332
Epoch: 40, Steps: 64 | Train Loss: 0.1179400 Vali Loss: 0.1693613 Test Loss: 0.2290435
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 41 cost time: 0.9771802425384521
Epoch: 41, Steps: 64 | Train Loss: 0.1177216 Vali Loss: 0.1670425 Test Loss: 0.2278414
Validation loss decreased (0.167252 --> 0.167043).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 42 cost time: 0.9747593402862549
Epoch: 42, Steps: 64 | Train Loss: 0.1176094 Vali Loss: 0.1690690 Test Loss: 0.2292079
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 43 cost time: 0.9719994068145752
Epoch: 43, Steps: 64 | Train Loss: 0.1176562 Vali Loss: 0.1679827 Test Loss: 0.2283685
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 44 cost time: 0.9826228618621826
Epoch: 44, Steps: 64 | Train Loss: 0.1176286 Vali Loss: 0.1677244 Test Loss: 0.2284202
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 45 cost time: 0.9790005683898926
Epoch: 45, Steps: 64 | Train Loss: 0.1173865 Vali Loss: 0.1692497 Test Loss: 0.2282076
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 46 cost time: 0.9633731842041016
Epoch: 46, Steps: 64 | Train Loss: 0.1178428 Vali Loss: 0.1692099 Test Loss: 0.2279315
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 47 cost time: 0.9795675277709961
Epoch: 47, Steps: 64 | Train Loss: 0.1172013 Vali Loss: 0.1670365 Test Loss: 0.2285196
Validation loss decreased (0.167043 --> 0.167036).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 48 cost time: 0.9963548183441162
Epoch: 48, Steps: 64 | Train Loss: 0.1177608 Vali Loss: 0.1693901 Test Loss: 0.2289753
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 49 cost time: 0.9863488674163818
Epoch: 49, Steps: 64 | Train Loss: 0.1172597 Vali Loss: 0.1681972 Test Loss: 0.2285228
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 50 cost time: 0.9958038330078125
Epoch: 50, Steps: 64 | Train Loss: 0.1176583 Vali Loss: 0.1675807 Test Loss: 0.2287422
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 51 cost time: 1.0080735683441162
Epoch: 51, Steps: 64 | Train Loss: 0.1174186 Vali Loss: 0.1675889 Test Loss: 0.2279882
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 52 cost time: 1.0053679943084717
Epoch: 52, Steps: 64 | Train Loss: 0.1179515 Vali Loss: 0.1692823 Test Loss: 0.2281666
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 53 cost time: 1.003143548965454
Epoch: 53, Steps: 64 | Train Loss: 0.1174152 Vali Loss: 0.1687080 Test Loss: 0.2305490
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 54 cost time: 0.9977366924285889
Epoch: 54, Steps: 64 | Train Loss: 0.1174576 Vali Loss: 0.1695519 Test Loss: 0.2295761
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 55 cost time: 0.9880001544952393
Epoch: 55, Steps: 64 | Train Loss: 0.1175198 Vali Loss: 0.1659233 Test Loss: 0.2280129
Validation loss decreased (0.167036 --> 0.165923).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 56 cost time: 0.9636240005493164
Epoch: 56, Steps: 64 | Train Loss: 0.1170362 Vali Loss: 0.1679790 Test Loss: 0.2295655
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 57 cost time: 0.949390172958374
Epoch: 57, Steps: 64 | Train Loss: 0.1178769 Vali Loss: 0.1657867 Test Loss: 0.2281911
Validation loss decreased (0.165923 --> 0.165787).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 58 cost time: 0.956667423248291
Epoch: 58, Steps: 64 | Train Loss: 0.1170699 Vali Loss: 0.1690067 Test Loss: 0.2285073
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 59 cost time: 0.9814248085021973
Epoch: 59, Steps: 64 | Train Loss: 0.1174593 Vali Loss: 0.1681047 Test Loss: 0.2298750
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 60 cost time: 0.9783649444580078
Epoch: 60, Steps: 64 | Train Loss: 0.1172781 Vali Loss: 0.1680184 Test Loss: 0.2291738
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.228191077709198, mae:0.34150803089141846, rse:0.24209368228912354
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04783916473388672 GB
Epoch: 1 cost time: 2.2253472805023193
Epoch: 1, Steps: 64 | Train Loss: 1.3399489 Vali Loss: 3.2360215 Test Loss: 5.1941128
Validation loss decreased (inf --> 3.236022).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 2 cost time: 0.8709266185760498
Epoch: 2, Steps: 64 | Train Loss: 0.8172302 Vali Loss: 0.9111608 Test Loss: 1.2765837
Validation loss decreased (3.236022 --> 0.911161).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 3 cost time: 0.877223014831543
Epoch: 3, Steps: 64 | Train Loss: 0.3842465 Vali Loss: 0.5405555 Test Loss: 0.6953628
Validation loss decreased (0.911161 --> 0.540555).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 4 cost time: 0.8749988079071045
Epoch: 4, Steps: 64 | Train Loss: 0.2809679 Vali Loss: 0.4082650 Test Loss: 0.4967190
Validation loss decreased (0.540555 --> 0.408265).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 5 cost time: 0.8646354675292969
Epoch: 5, Steps: 64 | Train Loss: 0.2362783 Vali Loss: 0.3352192 Test Loss: 0.4003882
Validation loss decreased (0.408265 --> 0.335219).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 6 cost time: 0.8343634605407715
Epoch: 6, Steps: 64 | Train Loss: 0.2106641 Vali Loss: 0.2877555 Test Loss: 0.3453997
Validation loss decreased (0.335219 --> 0.287756).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 7 cost time: 0.8441057205200195
Epoch: 7, Steps: 64 | Train Loss: 0.1954988 Vali Loss: 0.2580828 Test Loss: 0.3079782
Validation loss decreased (0.287756 --> 0.258083).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 8 cost time: 0.8507404327392578
Epoch: 8, Steps: 64 | Train Loss: 0.1836057 Vali Loss: 0.2357556 Test Loss: 0.2845108
Validation loss decreased (0.258083 --> 0.235756).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 9 cost time: 0.8419990539550781
Epoch: 9, Steps: 64 | Train Loss: 0.1765144 Vali Loss: 0.2195358 Test Loss: 0.2650856
Validation loss decreased (0.235756 --> 0.219536).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 10 cost time: 0.8696494102478027
Epoch: 10, Steps: 64 | Train Loss: 0.1697682 Vali Loss: 0.2117661 Test Loss: 0.2571749
Validation loss decreased (0.219536 --> 0.211766).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 11 cost time: 0.870119571685791
Epoch: 11, Steps: 64 | Train Loss: 0.1655133 Vali Loss: 0.2039095 Test Loss: 0.2490632
Validation loss decreased (0.211766 --> 0.203910).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 12 cost time: 0.9023501873016357
Epoch: 12, Steps: 64 | Train Loss: 0.1631853 Vali Loss: 0.1969465 Test Loss: 0.2429662
Validation loss decreased (0.203910 --> 0.196946).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 13 cost time: 0.9003677368164062
Epoch: 13, Steps: 64 | Train Loss: 0.1595141 Vali Loss: 0.1939015 Test Loss: 0.2386644
Validation loss decreased (0.196946 --> 0.193901).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 14 cost time: 0.9078118801116943
Epoch: 14, Steps: 64 | Train Loss: 0.1575189 Vali Loss: 0.1883061 Test Loss: 0.2355162
Validation loss decreased (0.193901 --> 0.188306).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 15 cost time: 0.905001163482666
Epoch: 15, Steps: 64 | Train Loss: 0.1559343 Vali Loss: 0.1875293 Test Loss: 0.2339125
Validation loss decreased (0.188306 --> 0.187529).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 16 cost time: 0.8786435127258301
Epoch: 16, Steps: 64 | Train Loss: 0.1536108 Vali Loss: 0.1866042 Test Loss: 0.2340130
Validation loss decreased (0.187529 --> 0.186604).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 17 cost time: 0.8714146614074707
Epoch: 17, Steps: 64 | Train Loss: 0.1521892 Vali Loss: 0.1825740 Test Loss: 0.2324688
Validation loss decreased (0.186604 --> 0.182574).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 18 cost time: 0.8833744525909424
Epoch: 18, Steps: 64 | Train Loss: 0.1510566 Vali Loss: 0.1814026 Test Loss: 0.2305136
Validation loss decreased (0.182574 --> 0.181403).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 19 cost time: 0.908348560333252
Epoch: 19, Steps: 64 | Train Loss: 0.1500197 Vali Loss: 0.1822191 Test Loss: 0.2303645
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 20 cost time: 0.9003725051879883
Epoch: 20, Steps: 64 | Train Loss: 0.1490812 Vali Loss: 0.1784226 Test Loss: 0.2295191
Validation loss decreased (0.181403 --> 0.178423).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 21 cost time: 0.9040012359619141
Epoch: 21, Steps: 64 | Train Loss: 0.1484650 Vali Loss: 0.1794081 Test Loss: 0.2285759
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 22 cost time: 0.9026315212249756
Epoch: 22, Steps: 64 | Train Loss: 0.1476367 Vali Loss: 0.1779855 Test Loss: 0.2288491
Validation loss decreased (0.178423 --> 0.177986).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 23 cost time: 0.8623778820037842
Epoch: 23, Steps: 64 | Train Loss: 0.1465420 Vali Loss: 0.1780244 Test Loss: 0.2273484
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 24 cost time: 0.8453714847564697
Epoch: 24, Steps: 64 | Train Loss: 0.1463587 Vali Loss: 0.1771115 Test Loss: 0.2272186
Validation loss decreased (0.177986 --> 0.177111).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 25 cost time: 0.8380022048950195
Epoch: 25, Steps: 64 | Train Loss: 0.1461958 Vali Loss: 0.1746551 Test Loss: 0.2274172
Validation loss decreased (0.177111 --> 0.174655).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 26 cost time: 0.8469979763031006
Epoch: 26, Steps: 64 | Train Loss: 0.1455723 Vali Loss: 0.1752252 Test Loss: 0.2266924
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 27 cost time: 0.8440017700195312
Epoch: 27, Steps: 64 | Train Loss: 0.1446407 Vali Loss: 0.1758656 Test Loss: 0.2260891
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 28 cost time: 0.8723495006561279
Epoch: 28, Steps: 64 | Train Loss: 0.1446367 Vali Loss: 0.1754384 Test Loss: 0.2260074
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 29 cost time: 0.8683533668518066
Epoch: 29, Steps: 64 | Train Loss: 0.1454707 Vali Loss: 0.1746565 Test Loss: 0.2255288
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 30 cost time: 0.8493838310241699
Epoch: 30, Steps: 64 | Train Loss: 0.1440551 Vali Loss: 0.1744309 Test Loss: 0.2265588
Validation loss decreased (0.174655 --> 0.174431).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 31 cost time: 0.8427250385284424
Epoch: 31, Steps: 64 | Train Loss: 0.1434889 Vali Loss: 0.1723448 Test Loss: 0.2266380
Validation loss decreased (0.174431 --> 0.172345).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 32 cost time: 0.8969986438751221
Epoch: 32, Steps: 64 | Train Loss: 0.1435273 Vali Loss: 0.1741956 Test Loss: 0.2256494
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 33 cost time: 0.8906259536743164
Epoch: 33, Steps: 64 | Train Loss: 0.1433313 Vali Loss: 0.1727519 Test Loss: 0.2256753
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 34 cost time: 0.8592581748962402
Epoch: 34, Steps: 64 | Train Loss: 0.1437528 Vali Loss: 0.1762869 Test Loss: 0.2263196
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 35 cost time: 0.8774528503417969
Epoch: 35, Steps: 64 | Train Loss: 0.1434820 Vali Loss: 0.1761378 Test Loss: 0.2260472
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 36 cost time: 0.879763126373291
Epoch: 36, Steps: 64 | Train Loss: 0.1432691 Vali Loss: 0.1755363 Test Loss: 0.2258708
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 37 cost time: 0.9130008220672607
Epoch: 37, Steps: 64 | Train Loss: 0.1424941 Vali Loss: 0.1719577 Test Loss: 0.2252492
Validation loss decreased (0.172345 --> 0.171958).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 38 cost time: 0.9034430980682373
Epoch: 38, Steps: 64 | Train Loss: 0.1425213 Vali Loss: 0.1730848 Test Loss: 0.2254217
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 39 cost time: 0.9056203365325928
Epoch: 39, Steps: 64 | Train Loss: 0.1421587 Vali Loss: 0.1745143 Test Loss: 0.2254702
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 40 cost time: 0.9102699756622314
Epoch: 40, Steps: 64 | Train Loss: 0.1413558 Vali Loss: 0.1729012 Test Loss: 0.2247799
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 41 cost time: 0.8994617462158203
Epoch: 41, Steps: 64 | Train Loss: 0.1416611 Vali Loss: 0.1745704 Test Loss: 0.2250747
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 42 cost time: 0.8948554992675781
Epoch: 42, Steps: 64 | Train Loss: 0.1415702 Vali Loss: 0.1746791 Test Loss: 0.2254809
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 43 cost time: 0.8977856636047363
Epoch: 43, Steps: 64 | Train Loss: 0.1423591 Vali Loss: 0.1748919 Test Loss: 0.2253446
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 44 cost time: 0.8970003128051758
Epoch: 44, Steps: 64 | Train Loss: 0.1422494 Vali Loss: 0.1731520 Test Loss: 0.2253563
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 45 cost time: 0.8586280345916748
Epoch: 45, Steps: 64 | Train Loss: 0.1418143 Vali Loss: 0.1716500 Test Loss: 0.2249943
Validation loss decreased (0.171958 --> 0.171650).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 46 cost time: 0.8733289241790771
Epoch: 46, Steps: 64 | Train Loss: 0.1408612 Vali Loss: 0.1734941 Test Loss: 0.2259991
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 47 cost time: 0.867417573928833
Epoch: 47, Steps: 64 | Train Loss: 0.1413717 Vali Loss: 0.1734360 Test Loss: 0.2250901
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 48 cost time: 0.8820846080780029
Epoch: 48, Steps: 64 | Train Loss: 0.1408259 Vali Loss: 0.1720686 Test Loss: 0.2248451
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 49 cost time: 0.8957626819610596
Epoch: 49, Steps: 64 | Train Loss: 0.1417126 Vali Loss: 0.1727464 Test Loss: 0.2252373
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 50 cost time: 0.8731820583343506
Epoch: 50, Steps: 64 | Train Loss: 0.1413749 Vali Loss: 0.1735245 Test Loss: 0.2247587
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 51 cost time: 0.8417329788208008
Epoch: 51, Steps: 64 | Train Loss: 0.1411388 Vali Loss: 0.1721042 Test Loss: 0.2248396
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 52 cost time: 0.8780009746551514
Epoch: 52, Steps: 64 | Train Loss: 0.1416696 Vali Loss: 0.1729568 Test Loss: 0.2248348
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 53 cost time: 0.8454794883728027
Epoch: 53, Steps: 64 | Train Loss: 0.1418048 Vali Loss: 0.1705396 Test Loss: 0.2247416
Validation loss decreased (0.171650 --> 0.170540).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 54 cost time: 0.8497622013092041
Epoch: 54, Steps: 64 | Train Loss: 0.1414029 Vali Loss: 0.1737189 Test Loss: 0.2244201
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 55 cost time: 0.8878304958343506
Epoch: 55, Steps: 64 | Train Loss: 0.1413346 Vali Loss: 0.1717312 Test Loss: 0.2248754
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 56 cost time: 0.9047210216522217
Epoch: 56, Steps: 64 | Train Loss: 0.1414804 Vali Loss: 0.1705763 Test Loss: 0.2248457
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 57 cost time: 0.9132814407348633
Epoch: 57, Steps: 64 | Train Loss: 0.1413022 Vali Loss: 0.1716996 Test Loss: 0.2252061
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 58 cost time: 0.9133424758911133
Epoch: 58, Steps: 64 | Train Loss: 0.1415347 Vali Loss: 0.1713150 Test Loss: 0.2251819
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 59 cost time: 0.9003844261169434
Epoch: 59, Steps: 64 | Train Loss: 0.1408669 Vali Loss: 0.1724978 Test Loss: 0.2245985
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 60 cost time: 0.8927261829376221
Epoch: 60, Steps: 64 | Train Loss: 0.1410435 Vali Loss: 0.1707915 Test Loss: 0.2250214
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2247416228055954, mae:0.3341280519962311, rse:0.2402569055557251
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.048540592193603516 GB
Epoch: 1 cost time: 2.266186475753784
Epoch: 1, Steps: 64 | Train Loss: 0.9516192 Vali Loss: 2.4881561 Test Loss: 3.9805465
Validation loss decreased (inf --> 2.488156).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 2 cost time: 0.9206206798553467
Epoch: 2, Steps: 64 | Train Loss: 0.7133168 Vali Loss: 1.2133861 Test Loss: 1.8430399
Validation loss decreased (2.488156 --> 1.213386).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 3 cost time: 0.9096288681030273
Epoch: 3, Steps: 64 | Train Loss: 0.3968723 Vali Loss: 0.6630508 Test Loss: 0.9300078
Validation loss decreased (1.213386 --> 0.663051).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 4 cost time: 0.9093692302703857
Epoch: 4, Steps: 64 | Train Loss: 0.2515871 Vali Loss: 0.4184835 Test Loss: 0.5439070
Validation loss decreased (0.663051 --> 0.418483).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 5 cost time: 0.9100091457366943
Epoch: 5, Steps: 64 | Train Loss: 0.1889992 Vali Loss: 0.2949518 Test Loss: 0.3718247
Validation loss decreased (0.418483 --> 0.294952).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 6 cost time: 0.8983614444732666
Epoch: 6, Steps: 64 | Train Loss: 0.1627378 Vali Loss: 0.2385894 Test Loss: 0.2948522
Validation loss decreased (0.294952 --> 0.238589).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 7 cost time: 0.8973944187164307
Epoch: 7, Steps: 64 | Train Loss: 0.1498209 Vali Loss: 0.2111111 Test Loss: 0.2605236
Validation loss decreased (0.238589 --> 0.211111).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 8 cost time: 0.8879969120025635
Epoch: 8, Steps: 64 | Train Loss: 0.1435512 Vali Loss: 0.1985343 Test Loss: 0.2448193
Validation loss decreased (0.211111 --> 0.198534).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 9 cost time: 0.8949978351593018
Epoch: 9, Steps: 64 | Train Loss: 0.1396068 Vali Loss: 0.1896075 Test Loss: 0.2390947
Validation loss decreased (0.198534 --> 0.189607).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 10 cost time: 0.9026319980621338
Epoch: 10, Steps: 64 | Train Loss: 0.1371299 Vali Loss: 0.1852595 Test Loss: 0.2340398
Validation loss decreased (0.189607 --> 0.185260).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 11 cost time: 0.9035501480102539
Epoch: 11, Steps: 64 | Train Loss: 0.1343521 Vali Loss: 0.1815615 Test Loss: 0.2305313
Validation loss decreased (0.185260 --> 0.181562).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 12 cost time: 0.926386833190918
Epoch: 12, Steps: 64 | Train Loss: 0.1329353 Vali Loss: 0.1771975 Test Loss: 0.2281429
Validation loss decreased (0.181562 --> 0.177197).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 13 cost time: 0.9264276027679443
Epoch: 13, Steps: 64 | Train Loss: 0.1313614 Vali Loss: 0.1778572 Test Loss: 0.2277033
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 14 cost time: 0.900083065032959
Epoch: 14, Steps: 64 | Train Loss: 0.1304484 Vali Loss: 0.1772034 Test Loss: 0.2270890
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 15 cost time: 0.9059996604919434
Epoch: 15, Steps: 64 | Train Loss: 0.1291191 Vali Loss: 0.1748828 Test Loss: 0.2258536
Validation loss decreased (0.177197 --> 0.174883).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 16 cost time: 0.9060008525848389
Epoch: 16, Steps: 64 | Train Loss: 0.1287822 Vali Loss: 0.1757265 Test Loss: 0.2268333
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 17 cost time: 0.8963415622711182
Epoch: 17, Steps: 64 | Train Loss: 0.1277409 Vali Loss: 0.1742492 Test Loss: 0.2256225
Validation loss decreased (0.174883 --> 0.174249).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 18 cost time: 0.9020345211029053
Epoch: 18, Steps: 64 | Train Loss: 0.1266713 Vali Loss: 0.1714803 Test Loss: 0.2245970
Validation loss decreased (0.174249 --> 0.171480).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 19 cost time: 0.9193530082702637
Epoch: 19, Steps: 64 | Train Loss: 0.1262970 Vali Loss: 0.1720407 Test Loss: 0.2254361
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 20 cost time: 0.9204113483428955
Epoch: 20, Steps: 64 | Train Loss: 0.1254879 Vali Loss: 0.1718913 Test Loss: 0.2259223
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 21 cost time: 0.922752857208252
Epoch: 21, Steps: 64 | Train Loss: 0.1259040 Vali Loss: 0.1707837 Test Loss: 0.2248905
Validation loss decreased (0.171480 --> 0.170784).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 22 cost time: 0.9038019180297852
Epoch: 22, Steps: 64 | Train Loss: 0.1252368 Vali Loss: 0.1717648 Test Loss: 0.2260199
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 23 cost time: 0.8946409225463867
Epoch: 23, Steps: 64 | Train Loss: 0.1242592 Vali Loss: 0.1696214 Test Loss: 0.2252878
Validation loss decreased (0.170784 --> 0.169621).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 24 cost time: 0.8823726177215576
Epoch: 24, Steps: 64 | Train Loss: 0.1242886 Vali Loss: 0.1718040 Test Loss: 0.2246339
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 25 cost time: 0.8853485584259033
Epoch: 25, Steps: 64 | Train Loss: 0.1236261 Vali Loss: 0.1709858 Test Loss: 0.2248796
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 26 cost time: 0.8820135593414307
Epoch: 26, Steps: 64 | Train Loss: 0.1236354 Vali Loss: 0.1703107 Test Loss: 0.2256922
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 27 cost time: 0.8977398872375488
Epoch: 27, Steps: 64 | Train Loss: 0.1238291 Vali Loss: 0.1709388 Test Loss: 0.2242551
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 28 cost time: 0.8959987163543701
Epoch: 28, Steps: 64 | Train Loss: 0.1227985 Vali Loss: 0.1718377 Test Loss: 0.2258037
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 29 cost time: 0.8976240158081055
Epoch: 29, Steps: 64 | Train Loss: 0.1230932 Vali Loss: 0.1703238 Test Loss: 0.2246331
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 30 cost time: 0.8974997997283936
Epoch: 30, Steps: 64 | Train Loss: 0.1227913 Vali Loss: 0.1705962 Test Loss: 0.2253359
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 31 cost time: 0.8888332843780518
Epoch: 31, Steps: 64 | Train Loss: 0.1227036 Vali Loss: 0.1683297 Test Loss: 0.2243954
Validation loss decreased (0.169621 --> 0.168330).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 32 cost time: 0.8657436370849609
Epoch: 32, Steps: 64 | Train Loss: 0.1226619 Vali Loss: 0.1688362 Test Loss: 0.2245646
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 33 cost time: 0.8977963924407959
Epoch: 33, Steps: 64 | Train Loss: 0.1225139 Vali Loss: 0.1687394 Test Loss: 0.2249393
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 34 cost time: 0.9109995365142822
Epoch: 34, Steps: 64 | Train Loss: 0.1224692 Vali Loss: 0.1688967 Test Loss: 0.2248930
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 35 cost time: 0.9006223678588867
Epoch: 35, Steps: 64 | Train Loss: 0.1225883 Vali Loss: 0.1696474 Test Loss: 0.2252964
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 36 cost time: 0.9128544330596924
Epoch: 36, Steps: 64 | Train Loss: 0.1219454 Vali Loss: 0.1686777 Test Loss: 0.2252803
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 37 cost time: 0.9253480434417725
Epoch: 37, Steps: 64 | Train Loss: 0.1223717 Vali Loss: 0.1690947 Test Loss: 0.2252280
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 38 cost time: 0.9163742065429688
Epoch: 38, Steps: 64 | Train Loss: 0.1226312 Vali Loss: 0.1694272 Test Loss: 0.2251808
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 39 cost time: 0.9223501682281494
Epoch: 39, Steps: 64 | Train Loss: 0.1221822 Vali Loss: 0.1687952 Test Loss: 0.2253883
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 40 cost time: 0.9227492809295654
Epoch: 40, Steps: 64 | Train Loss: 0.1221206 Vali Loss: 0.1677817 Test Loss: 0.2246059
Validation loss decreased (0.168330 --> 0.167782).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 41 cost time: 0.9104018211364746
Epoch: 41, Steps: 64 | Train Loss: 0.1215764 Vali Loss: 0.1673581 Test Loss: 0.2243596
Validation loss decreased (0.167782 --> 0.167358).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 42 cost time: 0.8946528434753418
Epoch: 42, Steps: 64 | Train Loss: 0.1216594 Vali Loss: 0.1678102 Test Loss: 0.2246339
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 43 cost time: 0.8774116039276123
Epoch: 43, Steps: 64 | Train Loss: 0.1218527 Vali Loss: 0.1690103 Test Loss: 0.2251845
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 44 cost time: 0.865962028503418
Epoch: 44, Steps: 64 | Train Loss: 0.1217511 Vali Loss: 0.1687971 Test Loss: 0.2252876
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 45 cost time: 0.9168169498443604
Epoch: 45, Steps: 64 | Train Loss: 0.1218711 Vali Loss: 0.1695005 Test Loss: 0.2249845
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 46 cost time: 0.8807449340820312
Epoch: 46, Steps: 64 | Train Loss: 0.1216989 Vali Loss: 0.1668493 Test Loss: 0.2254154
Validation loss decreased (0.167358 --> 0.166849).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 47 cost time: 0.8880019187927246
Epoch: 47, Steps: 64 | Train Loss: 0.1215241 Vali Loss: 0.1674766 Test Loss: 0.2248954
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 48 cost time: 0.901618480682373
Epoch: 48, Steps: 64 | Train Loss: 0.1218155 Vali Loss: 0.1683386 Test Loss: 0.2247725
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 49 cost time: 0.8778696060180664
Epoch: 49, Steps: 64 | Train Loss: 0.1221414 Vali Loss: 0.1694427 Test Loss: 0.2253633
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 50 cost time: 0.8774285316467285
Epoch: 50, Steps: 64 | Train Loss: 0.1213899 Vali Loss: 0.1690510 Test Loss: 0.2248428
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 51 cost time: 0.8743724822998047
Epoch: 51, Steps: 64 | Train Loss: 0.1220967 Vali Loss: 0.1679932 Test Loss: 0.2243632
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 52 cost time: 0.8837687969207764
Epoch: 52, Steps: 64 | Train Loss: 0.1213814 Vali Loss: 0.1684986 Test Loss: 0.2248736
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 53 cost time: 0.8650000095367432
Epoch: 53, Steps: 64 | Train Loss: 0.1214067 Vali Loss: 0.1678123 Test Loss: 0.2246675
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 54 cost time: 0.923105001449585
Epoch: 54, Steps: 64 | Train Loss: 0.1214432 Vali Loss: 0.1686299 Test Loss: 0.2248166
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 55 cost time: 0.9343619346618652
Epoch: 55, Steps: 64 | Train Loss: 0.1213565 Vali Loss: 0.1675615 Test Loss: 0.2244353
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 56 cost time: 0.9255037307739258
Epoch: 56, Steps: 64 | Train Loss: 0.1212366 Vali Loss: 0.1685433 Test Loss: 0.2251161
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 57 cost time: 0.940354585647583
Epoch: 57, Steps: 64 | Train Loss: 0.1217603 Vali Loss: 0.1668060 Test Loss: 0.2240777
Validation loss decreased (0.166849 --> 0.166806).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 58 cost time: 0.9303200244903564
Epoch: 58, Steps: 64 | Train Loss: 0.1214295 Vali Loss: 0.1682935 Test Loss: 0.2247579
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 59 cost time: 0.9127299785614014
Epoch: 59, Steps: 64 | Train Loss: 0.1213884 Vali Loss: 0.1686866 Test Loss: 0.2251835
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 60 cost time: 0.9105112552642822
Epoch: 60, Steps: 64 | Train Loss: 0.1213548 Vali Loss: 0.1660345 Test Loss: 0.2246946
Validation loss decreased (0.166806 --> 0.166035).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2246946096420288, mae:0.3394484221935272, rse:0.24023178219795227
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.04910469055175781 GB
Epoch: 1 cost time: 2.3721256256103516
Epoch: 1, Steps: 64 | Train Loss: 0.9168282 Vali Loss: 2.5005040 Test Loss: 4.0237756
Validation loss decreased (inf --> 2.500504).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 2 cost time: 1.0046229362487793
Epoch: 2, Steps: 64 | Train Loss: 0.7666513 Vali Loss: 1.6361576 Test Loss: 2.5623345
Validation loss decreased (2.500504 --> 1.636158).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 3 cost time: 0.9874038696289062
Epoch: 3, Steps: 64 | Train Loss: 0.5015178 Vali Loss: 0.9012190 Test Loss: 1.3482130
Validation loss decreased (1.636158 --> 0.901219).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 4 cost time: 0.9813797473907471
Epoch: 4, Steps: 64 | Train Loss: 0.2882084 Vali Loss: 0.4395170 Test Loss: 0.6145905
Validation loss decreased (0.901219 --> 0.439517).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 5 cost time: 0.9743771553039551
Epoch: 5, Steps: 64 | Train Loss: 0.1791465 Vali Loss: 0.2446571 Test Loss: 0.3171243
Validation loss decreased (0.439517 --> 0.244657).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 6 cost time: 0.9553167819976807
Epoch: 6, Steps: 64 | Train Loss: 0.1463967 Vali Loss: 0.1980135 Test Loss: 0.2583529
Validation loss decreased (0.244657 --> 0.198014).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 7 cost time: 0.9563815593719482
Epoch: 7, Steps: 64 | Train Loss: 0.1372192 Vali Loss: 0.1863483 Test Loss: 0.2353532
Validation loss decreased (0.198014 --> 0.186348).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 8 cost time: 0.9534072875976562
Epoch: 8, Steps: 64 | Train Loss: 0.1328273 Vali Loss: 0.1822659 Test Loss: 0.2381283
Validation loss decreased (0.186348 --> 0.182266).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 9 cost time: 0.986384391784668
Epoch: 9, Steps: 64 | Train Loss: 0.1301989 Vali Loss: 0.1790025 Test Loss: 0.2340488
Validation loss decreased (0.182266 --> 0.179002).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 10 cost time: 1.0173718929290771
Epoch: 10, Steps: 64 | Train Loss: 0.1279636 Vali Loss: 0.1757994 Test Loss: 0.2329583
Validation loss decreased (0.179002 --> 0.175799).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 11 cost time: 1.0087494850158691
Epoch: 11, Steps: 64 | Train Loss: 0.1260118 Vali Loss: 0.1768145 Test Loss: 0.2344977
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 12 cost time: 1.0228016376495361
Epoch: 12, Steps: 64 | Train Loss: 0.1249315 Vali Loss: 0.1718111 Test Loss: 0.2330031
Validation loss decreased (0.175799 --> 0.171811).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 13 cost time: 1.0047459602355957
Epoch: 13, Steps: 64 | Train Loss: 0.1240396 Vali Loss: 0.1749910 Test Loss: 0.2325013
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 14 cost time: 0.9879992008209229
Epoch: 14, Steps: 64 | Train Loss: 0.1227818 Vali Loss: 0.1740235 Test Loss: 0.2331736
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 15 cost time: 1.0020782947540283
Epoch: 15, Steps: 64 | Train Loss: 0.1220702 Vali Loss: 0.1728635 Test Loss: 0.2316541
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 16 cost time: 0.9889566898345947
Epoch: 16, Steps: 64 | Train Loss: 0.1211421 Vali Loss: 0.1731032 Test Loss: 0.2344285
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 17 cost time: 0.996387243270874
Epoch: 17, Steps: 64 | Train Loss: 0.1211562 Vali Loss: 0.1707295 Test Loss: 0.2336776
Validation loss decreased (0.171811 --> 0.170730).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 18 cost time: 1.0163512229919434
Epoch: 18, Steps: 64 | Train Loss: 0.1202888 Vali Loss: 0.1708656 Test Loss: 0.2350975
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 19 cost time: 0.9944155216217041
Epoch: 19, Steps: 64 | Train Loss: 0.1199719 Vali Loss: 0.1711857 Test Loss: 0.2338150
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 20 cost time: 0.9754714965820312
Epoch: 20, Steps: 64 | Train Loss: 0.1196213 Vali Loss: 0.1726708 Test Loss: 0.2359623
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 21 cost time: 0.9784352779388428
Epoch: 21, Steps: 64 | Train Loss: 0.1187812 Vali Loss: 0.1719506 Test Loss: 0.2356131
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 22 cost time: 0.9554057121276855
Epoch: 22, Steps: 64 | Train Loss: 0.1189270 Vali Loss: 0.1712063 Test Loss: 0.2357859
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 23 cost time: 0.9537615776062012
Epoch: 23, Steps: 64 | Train Loss: 0.1188881 Vali Loss: 0.1688786 Test Loss: 0.2352148
Validation loss decreased (0.170730 --> 0.168879).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 24 cost time: 0.9571223258972168
Epoch: 24, Steps: 64 | Train Loss: 0.1181356 Vali Loss: 0.1708857 Test Loss: 0.2348745
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 25 cost time: 0.9670004844665527
Epoch: 25, Steps: 64 | Train Loss: 0.1181452 Vali Loss: 0.1722430 Test Loss: 0.2361475
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 26 cost time: 0.9726436138153076
Epoch: 26, Steps: 64 | Train Loss: 0.1177936 Vali Loss: 0.1703088 Test Loss: 0.2353388
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 27 cost time: 0.9766137599945068
Epoch: 27, Steps: 64 | Train Loss: 0.1176114 Vali Loss: 0.1695444 Test Loss: 0.2350506
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 28 cost time: 0.9857292175292969
Epoch: 28, Steps: 64 | Train Loss: 0.1179394 Vali Loss: 0.1695871 Test Loss: 0.2365419
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 29 cost time: 1.0144646167755127
Epoch: 29, Steps: 64 | Train Loss: 0.1176555 Vali Loss: 0.1709046 Test Loss: 0.2361093
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 30 cost time: 1.0020167827606201
Epoch: 30, Steps: 64 | Train Loss: 0.1176187 Vali Loss: 0.1695213 Test Loss: 0.2363247
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 31 cost time: 1.0115094184875488
Epoch: 31, Steps: 64 | Train Loss: 0.1177023 Vali Loss: 0.1700349 Test Loss: 0.2366264
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 32 cost time: 0.9840066432952881
Epoch: 32, Steps: 64 | Train Loss: 0.1169689 Vali Loss: 0.1676027 Test Loss: 0.2361741
Validation loss decreased (0.168879 --> 0.167603).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 33 cost time: 0.9939789772033691
Epoch: 33, Steps: 64 | Train Loss: 0.1170599 Vali Loss: 0.1684544 Test Loss: 0.2364741
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 34 cost time: 1.0150389671325684
Epoch: 34, Steps: 64 | Train Loss: 0.1169960 Vali Loss: 0.1698052 Test Loss: 0.2361364
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 35 cost time: 1.0114109516143799
Epoch: 35, Steps: 64 | Train Loss: 0.1168432 Vali Loss: 0.1689570 Test Loss: 0.2368055
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 36 cost time: 1.009749412536621
Epoch: 36, Steps: 64 | Train Loss: 0.1165150 Vali Loss: 0.1699755 Test Loss: 0.2364433
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 37 cost time: 1.0255424976348877
Epoch: 37, Steps: 64 | Train Loss: 0.1164607 Vali Loss: 0.1705561 Test Loss: 0.2369418
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 38 cost time: 0.991743803024292
Epoch: 38, Steps: 64 | Train Loss: 0.1166240 Vali Loss: 0.1694470 Test Loss: 0.2362691
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 39 cost time: 0.9539997577667236
Epoch: 39, Steps: 64 | Train Loss: 0.1159964 Vali Loss: 0.1705813 Test Loss: 0.2374979
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 40 cost time: 0.9536385536193848
Epoch: 40, Steps: 64 | Train Loss: 0.1164681 Vali Loss: 0.1690737 Test Loss: 0.2365020
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 41 cost time: 0.9609553813934326
Epoch: 41, Steps: 64 | Train Loss: 0.1169300 Vali Loss: 0.1691552 Test Loss: 0.2365322
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 42 cost time: 0.9713723659515381
Epoch: 42, Steps: 64 | Train Loss: 0.1162304 Vali Loss: 0.1685551 Test Loss: 0.2370286
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 43 cost time: 0.9833893775939941
Epoch: 43, Steps: 64 | Train Loss: 0.1164430 Vali Loss: 0.1704370 Test Loss: 0.2375838
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 44 cost time: 0.9871799945831299
Epoch: 44, Steps: 64 | Train Loss: 0.1158682 Vali Loss: 0.1690406 Test Loss: 0.2368586
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 45 cost time: 0.9821064472198486
Epoch: 45, Steps: 64 | Train Loss: 0.1162503 Vali Loss: 0.1689280 Test Loss: 0.2363112
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 46 cost time: 0.969367265701294
Epoch: 46, Steps: 64 | Train Loss: 0.1161414 Vali Loss: 0.1704790 Test Loss: 0.2372575
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 47 cost time: 0.9678544998168945
Epoch: 47, Steps: 64 | Train Loss: 0.1162835 Vali Loss: 0.1680214 Test Loss: 0.2375562
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 48 cost time: 0.992729663848877
Epoch: 48, Steps: 64 | Train Loss: 0.1160538 Vali Loss: 0.1688664 Test Loss: 0.2377226
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 49 cost time: 0.9886257648468018
Epoch: 49, Steps: 64 | Train Loss: 0.1159208 Vali Loss: 0.1707218 Test Loss: 0.2369642
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 50 cost time: 0.998645544052124
Epoch: 50, Steps: 64 | Train Loss: 0.1157297 Vali Loss: 0.1704389 Test Loss: 0.2375357
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 51 cost time: 1.008620262145996
Epoch: 51, Steps: 64 | Train Loss: 0.1157189 Vali Loss: 0.1675303 Test Loss: 0.2369232
Validation loss decreased (0.167603 --> 0.167530).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 52 cost time: 1.0146172046661377
Epoch: 52, Steps: 64 | Train Loss: 0.1158103 Vali Loss: 0.1700274 Test Loss: 0.2372734
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 53 cost time: 1.0146424770355225
Epoch: 53, Steps: 64 | Train Loss: 0.1164735 Vali Loss: 0.1697119 Test Loss: 0.2375481
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 54 cost time: 1.0173802375793457
Epoch: 54, Steps: 64 | Train Loss: 0.1160019 Vali Loss: 0.1700158 Test Loss: 0.2376138
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 55 cost time: 0.9993810653686523
Epoch: 55, Steps: 64 | Train Loss: 0.1159934 Vali Loss: 0.1707854 Test Loss: 0.2375812
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 56 cost time: 1.0080296993255615
Epoch: 56, Steps: 64 | Train Loss: 0.1158274 Vali Loss: 0.1673208 Test Loss: 0.2365740
Validation loss decreased (0.167530 --> 0.167321).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 57 cost time: 1.0132067203521729
Epoch: 57, Steps: 64 | Train Loss: 0.1162404 Vali Loss: 0.1689648 Test Loss: 0.2375327
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 58 cost time: 0.9704527854919434
Epoch: 58, Steps: 64 | Train Loss: 0.1156611 Vali Loss: 0.1705331 Test Loss: 0.2372609
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 59 cost time: 0.9853487014770508
Epoch: 59, Steps: 64 | Train Loss: 0.1160905 Vali Loss: 0.1702654 Test Loss: 0.2376162
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 60 cost time: 0.9893717765808105
Epoch: 60, Steps: 64 | Train Loss: 0.1158554 Vali Loss: 0.1704847 Test Loss: 0.2379590
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23657403886318207, mae:0.3572048544883728, rse:0.2465004324913025
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.048000335693359375 GB
Epoch: 1 cost time: 2.205836772918701
Epoch: 1, Steps: 64 | Train Loss: 1.0903305 Vali Loss: 2.4658999 Test Loss: 3.9547038
Validation loss decreased (inf --> 2.465900).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 2 cost time: 0.8696112632751465
Epoch: 2, Steps: 64 | Train Loss: 0.6303433 Vali Loss: 0.7320542 Test Loss: 1.0370737
Validation loss decreased (2.465900 --> 0.732054).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 3 cost time: 0.8636312484741211
Epoch: 3, Steps: 64 | Train Loss: 0.3570457 Vali Loss: 0.5716697 Test Loss: 0.7648602
Validation loss decreased (0.732054 --> 0.571670).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 4 cost time: 0.8823156356811523
Epoch: 4, Steps: 64 | Train Loss: 0.2796700 Vali Loss: 0.4523857 Test Loss: 0.5910428
Validation loss decreased (0.571670 --> 0.452386).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 5 cost time: 0.9004490375518799
Epoch: 5, Steps: 64 | Train Loss: 0.2367401 Vali Loss: 0.3701732 Test Loss: 0.4737204
Validation loss decreased (0.452386 --> 0.370173).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 6 cost time: 0.8889837265014648
Epoch: 6, Steps: 64 | Train Loss: 0.2106609 Vali Loss: 0.3188841 Test Loss: 0.4057037
Validation loss decreased (0.370173 --> 0.318884).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 7 cost time: 0.8928840160369873
Epoch: 7, Steps: 64 | Train Loss: 0.1934157 Vali Loss: 0.2817518 Test Loss: 0.3573596
Validation loss decreased (0.318884 --> 0.281752).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 8 cost time: 0.8610002994537354
Epoch: 8, Steps: 64 | Train Loss: 0.1815965 Vali Loss: 0.2583610 Test Loss: 0.3224660
Validation loss decreased (0.281752 --> 0.258361).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 9 cost time: 0.8356297016143799
Epoch: 9, Steps: 64 | Train Loss: 0.1733648 Vali Loss: 0.2369962 Test Loss: 0.2955482
Validation loss decreased (0.258361 --> 0.236996).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 10 cost time: 0.8708016872406006
Epoch: 10, Steps: 64 | Train Loss: 0.1667605 Vali Loss: 0.2279278 Test Loss: 0.2788784
Validation loss decreased (0.236996 --> 0.227928).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 11 cost time: 0.868478536605835
Epoch: 11, Steps: 64 | Train Loss: 0.1633710 Vali Loss: 0.2177646 Test Loss: 0.2701301
Validation loss decreased (0.227928 --> 0.217765).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 12 cost time: 0.892498254776001
Epoch: 12, Steps: 64 | Train Loss: 0.1594427 Vali Loss: 0.2091337 Test Loss: 0.2584993
Validation loss decreased (0.217765 --> 0.209134).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 13 cost time: 0.8907663822174072
Epoch: 13, Steps: 64 | Train Loss: 0.1567765 Vali Loss: 0.2016726 Test Loss: 0.2527358
Validation loss decreased (0.209134 --> 0.201673).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 14 cost time: 0.9030005931854248
Epoch: 14, Steps: 64 | Train Loss: 0.1546061 Vali Loss: 0.2010184 Test Loss: 0.2482917
Validation loss decreased (0.201673 --> 0.201018).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 15 cost time: 0.9006452560424805
Epoch: 15, Steps: 64 | Train Loss: 0.1528239 Vali Loss: 0.1973105 Test Loss: 0.2450024
Validation loss decreased (0.201018 --> 0.197310).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 16 cost time: 0.8749744892120361
Epoch: 16, Steps: 64 | Train Loss: 0.1508764 Vali Loss: 0.1919804 Test Loss: 0.2411240
Validation loss decreased (0.197310 --> 0.191980).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 17 cost time: 0.8753666877746582
Epoch: 17, Steps: 64 | Train Loss: 0.1496413 Vali Loss: 0.1916660 Test Loss: 0.2381153
Validation loss decreased (0.191980 --> 0.191666).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 18 cost time: 0.8694274425506592
Epoch: 18, Steps: 64 | Train Loss: 0.1482679 Vali Loss: 0.1922246 Test Loss: 0.2379683
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 19 cost time: 0.9081892967224121
Epoch: 19, Steps: 64 | Train Loss: 0.1470117 Vali Loss: 0.1895114 Test Loss: 0.2340590
Validation loss decreased (0.191666 --> 0.189511).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 20 cost time: 0.8989994525909424
Epoch: 20, Steps: 64 | Train Loss: 0.1463414 Vali Loss: 0.1887841 Test Loss: 0.2341866
Validation loss decreased (0.189511 --> 0.188784).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 21 cost time: 0.9051272869110107
Epoch: 21, Steps: 64 | Train Loss: 0.1463436 Vali Loss: 0.1870019 Test Loss: 0.2337092
Validation loss decreased (0.188784 --> 0.187002).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 22 cost time: 0.909372091293335
Epoch: 22, Steps: 64 | Train Loss: 0.1454414 Vali Loss: 0.1860175 Test Loss: 0.2325090
Validation loss decreased (0.187002 --> 0.186018).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 23 cost time: 0.8542287349700928
Epoch: 23, Steps: 64 | Train Loss: 0.1452681 Vali Loss: 0.1854910 Test Loss: 0.2314188
Validation loss decreased (0.186018 --> 0.185491).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 24 cost time: 0.8353912830352783
Epoch: 24, Steps: 64 | Train Loss: 0.1441720 Vali Loss: 0.1853785 Test Loss: 0.2315057
Validation loss decreased (0.185491 --> 0.185379).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 25 cost time: 0.8396890163421631
Epoch: 25, Steps: 64 | Train Loss: 0.1426605 Vali Loss: 0.1842618 Test Loss: 0.2317254
Validation loss decreased (0.185379 --> 0.184262).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 26 cost time: 0.8489999771118164
Epoch: 26, Steps: 64 | Train Loss: 0.1426758 Vali Loss: 0.1824068 Test Loss: 0.2299317
Validation loss decreased (0.184262 --> 0.182407).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 27 cost time: 0.847644567489624
Epoch: 27, Steps: 64 | Train Loss: 0.1424384 Vali Loss: 0.1817970 Test Loss: 0.2287270
Validation loss decreased (0.182407 --> 0.181797).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 28 cost time: 0.8733828067779541
Epoch: 28, Steps: 64 | Train Loss: 0.1417152 Vali Loss: 0.1853163 Test Loss: 0.2297758
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 29 cost time: 0.8663680553436279
Epoch: 29, Steps: 64 | Train Loss: 0.1417638 Vali Loss: 0.1838277 Test Loss: 0.2287210
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 30 cost time: 0.8677945137023926
Epoch: 30, Steps: 64 | Train Loss: 0.1420857 Vali Loss: 0.1812674 Test Loss: 0.2279379
Validation loss decreased (0.181797 --> 0.181267).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 31 cost time: 0.866002082824707
Epoch: 31, Steps: 64 | Train Loss: 0.1416664 Vali Loss: 0.1827732 Test Loss: 0.2285930
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 32 cost time: 0.855640172958374
Epoch: 32, Steps: 64 | Train Loss: 0.1408525 Vali Loss: 0.1820172 Test Loss: 0.2282476
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 33 cost time: 0.8523941040039062
Epoch: 33, Steps: 64 | Train Loss: 0.1403431 Vali Loss: 0.1815726 Test Loss: 0.2285134
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 34 cost time: 0.8564555644989014
Epoch: 34, Steps: 64 | Train Loss: 0.1405821 Vali Loss: 0.1812609 Test Loss: 0.2287867
Validation loss decreased (0.181267 --> 0.181261).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 35 cost time: 0.8844630718231201
Epoch: 35, Steps: 64 | Train Loss: 0.1405140 Vali Loss: 0.1814366 Test Loss: 0.2288113
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 36 cost time: 0.8747444152832031
Epoch: 36, Steps: 64 | Train Loss: 0.1394638 Vali Loss: 0.1806429 Test Loss: 0.2271745
Validation loss decreased (0.181261 --> 0.180643).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 37 cost time: 0.9007272720336914
Epoch: 37, Steps: 64 | Train Loss: 0.1401334 Vali Loss: 0.1817983 Test Loss: 0.2276634
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 38 cost time: 0.8986337184906006
Epoch: 38, Steps: 64 | Train Loss: 0.1399574 Vali Loss: 0.1796918 Test Loss: 0.2272044
Validation loss decreased (0.180643 --> 0.179692).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 39 cost time: 0.9003596305847168
Epoch: 39, Steps: 64 | Train Loss: 0.1395254 Vali Loss: 0.1815042 Test Loss: 0.2268555
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 40 cost time: 0.9043588638305664
Epoch: 40, Steps: 64 | Train Loss: 0.1395094 Vali Loss: 0.1788101 Test Loss: 0.2266006
Validation loss decreased (0.179692 --> 0.178810).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 41 cost time: 0.886406660079956
Epoch: 41, Steps: 64 | Train Loss: 0.1400858 Vali Loss: 0.1798533 Test Loss: 0.2264578
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 42 cost time: 0.8722014427185059
Epoch: 42, Steps: 64 | Train Loss: 0.1391940 Vali Loss: 0.1776709 Test Loss: 0.2263638
Validation loss decreased (0.178810 --> 0.177671).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 43 cost time: 0.8729984760284424
Epoch: 43, Steps: 64 | Train Loss: 0.1396591 Vali Loss: 0.1798670 Test Loss: 0.2271971
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 44 cost time: 0.8816282749176025
Epoch: 44, Steps: 64 | Train Loss: 0.1386688 Vali Loss: 0.1803251 Test Loss: 0.2277221
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 45 cost time: 0.8448944091796875
Epoch: 45, Steps: 64 | Train Loss: 0.1397104 Vali Loss: 0.1783687 Test Loss: 0.2270189
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 46 cost time: 0.8743917942047119
Epoch: 46, Steps: 64 | Train Loss: 0.1392041 Vali Loss: 0.1807576 Test Loss: 0.2275894
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 47 cost time: 0.8677084445953369
Epoch: 47, Steps: 64 | Train Loss: 0.1394339 Vali Loss: 0.1809663 Test Loss: 0.2280467
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 48 cost time: 0.846001148223877
Epoch: 48, Steps: 64 | Train Loss: 0.1393550 Vali Loss: 0.1782861 Test Loss: 0.2251746
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 49 cost time: 0.8486185073852539
Epoch: 49, Steps: 64 | Train Loss: 0.1383548 Vali Loss: 0.1811351 Test Loss: 0.2272390
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 50 cost time: 0.8514111042022705
Epoch: 50, Steps: 64 | Train Loss: 0.1396623 Vali Loss: 0.1782862 Test Loss: 0.2257448
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 51 cost time: 0.8479137420654297
Epoch: 51, Steps: 64 | Train Loss: 0.1393198 Vali Loss: 0.1801283 Test Loss: 0.2270560
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 52 cost time: 0.8357374668121338
Epoch: 52, Steps: 64 | Train Loss: 0.1391450 Vali Loss: 0.1799762 Test Loss: 0.2255685
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 53 cost time: 0.8450016975402832
Epoch: 53, Steps: 64 | Train Loss: 0.1390298 Vali Loss: 0.1778456 Test Loss: 0.2264795
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 54 cost time: 0.8516325950622559
Epoch: 54, Steps: 64 | Train Loss: 0.1390312 Vali Loss: 0.1783784 Test Loss: 0.2273957
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 55 cost time: 0.8691418170928955
Epoch: 55, Steps: 64 | Train Loss: 0.1386915 Vali Loss: 0.1812294 Test Loss: 0.2272490
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 56 cost time: 0.885368824005127
Epoch: 56, Steps: 64 | Train Loss: 0.1392241 Vali Loss: 0.1791537 Test Loss: 0.2260068
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 57 cost time: 0.8933191299438477
Epoch: 57, Steps: 64 | Train Loss: 0.1397782 Vali Loss: 0.1776680 Test Loss: 0.2265333
Validation loss decreased (0.177671 --> 0.177668).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 58 cost time: 0.9037747383117676
Epoch: 58, Steps: 64 | Train Loss: 0.1387440 Vali Loss: 0.1793632 Test Loss: 0.2263139
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 59 cost time: 0.8919999599456787
Epoch: 59, Steps: 64 | Train Loss: 0.1387217 Vali Loss: 0.1808127 Test Loss: 0.2263143
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 60 cost time: 0.8772666454315186
Epoch: 60, Steps: 64 | Train Loss: 0.1383792 Vali Loss: 0.1783068 Test Loss: 0.2261511
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22653332352638245, mae:0.3351430594921112, rse:0.24121272563934326
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.04870176315307617 GB
Epoch: 1 cost time: 2.3484153747558594
Epoch: 1, Steps: 64 | Train Loss: 0.9020656 Vali Loss: 2.3728116 Test Loss: 3.7323933
Validation loss decreased (inf --> 2.372812).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 2 cost time: 0.9974334239959717
Epoch: 2, Steps: 64 | Train Loss: 0.6292277 Vali Loss: 0.9589788 Test Loss: 1.4224236
Validation loss decreased (2.372812 --> 0.958979).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 3 cost time: 0.9683778285980225
Epoch: 3, Steps: 64 | Train Loss: 0.3297263 Vali Loss: 0.5089350 Test Loss: 0.6996258
Validation loss decreased (0.958979 --> 0.508935).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 4 cost time: 0.9633660316467285
Epoch: 4, Steps: 64 | Train Loss: 0.2083975 Vali Loss: 0.3121361 Test Loss: 0.4036841
Validation loss decreased (0.508935 --> 0.312136).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 5 cost time: 0.9459547996520996
Epoch: 5, Steps: 64 | Train Loss: 0.1652999 Vali Loss: 0.2417350 Test Loss: 0.3028007
Validation loss decreased (0.312136 --> 0.241735).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 6 cost time: 0.9453589916229248
Epoch: 6, Steps: 64 | Train Loss: 0.1507764 Vali Loss: 0.2163609 Test Loss: 0.2683089
Validation loss decreased (0.241735 --> 0.216361).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 7 cost time: 0.9367632865905762
Epoch: 7, Steps: 64 | Train Loss: 0.1443800 Vali Loss: 0.2073719 Test Loss: 0.2574902
Validation loss decreased (0.216361 --> 0.207372).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 8 cost time: 0.940640926361084
Epoch: 8, Steps: 64 | Train Loss: 0.1400085 Vali Loss: 0.2011348 Test Loss: 0.2491644
Validation loss decreased (0.207372 --> 0.201135).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 9 cost time: 0.9746530055999756
Epoch: 9, Steps: 64 | Train Loss: 0.1368208 Vali Loss: 0.1953672 Test Loss: 0.2412202
Validation loss decreased (0.201135 --> 0.195367).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 10 cost time: 0.9976317882537842
Epoch: 10, Steps: 64 | Train Loss: 0.1341898 Vali Loss: 0.1927944 Test Loss: 0.2420096
Validation loss decreased (0.195367 --> 0.192794).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 11 cost time: 0.9946110248565674
Epoch: 11, Steps: 64 | Train Loss: 0.1320195 Vali Loss: 0.1932342 Test Loss: 0.2405060
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 12 cost time: 1.0024285316467285
Epoch: 12, Steps: 64 | Train Loss: 0.1305578 Vali Loss: 0.1898980 Test Loss: 0.2375380
Validation loss decreased (0.192794 --> 0.189898).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 13 cost time: 0.9946432113647461
Epoch: 13, Steps: 64 | Train Loss: 0.1291292 Vali Loss: 0.1874233 Test Loss: 0.2356282
Validation loss decreased (0.189898 --> 0.187423).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 14 cost time: 0.9693443775177002
Epoch: 14, Steps: 64 | Train Loss: 0.1281235 Vali Loss: 0.1886228 Test Loss: 0.2364474
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 15 cost time: 0.9733929634094238
Epoch: 15, Steps: 64 | Train Loss: 0.1270913 Vali Loss: 0.1850250 Test Loss: 0.2348451
Validation loss decreased (0.187423 --> 0.185025).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 16 cost time: 0.9683468341827393
Epoch: 16, Steps: 64 | Train Loss: 0.1258658 Vali Loss: 0.1843475 Test Loss: 0.2343318
Validation loss decreased (0.185025 --> 0.184348).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 17 cost time: 0.9743740558624268
Epoch: 17, Steps: 64 | Train Loss: 0.1258510 Vali Loss: 0.1844769 Test Loss: 0.2333759
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 18 cost time: 0.9954698085784912
Epoch: 18, Steps: 64 | Train Loss: 0.1244081 Vali Loss: 0.1831147 Test Loss: 0.2333977
Validation loss decreased (0.184348 --> 0.183115).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 19 cost time: 0.9907324314117432
Epoch: 19, Steps: 64 | Train Loss: 0.1241461 Vali Loss: 0.1827249 Test Loss: 0.2328450
Validation loss decreased (0.183115 --> 0.182725).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 20 cost time: 0.9748609066009521
Epoch: 20, Steps: 64 | Train Loss: 0.1240379 Vali Loss: 0.1830420 Test Loss: 0.2328763
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 21 cost time: 0.96700119972229
Epoch: 21, Steps: 64 | Train Loss: 0.1238717 Vali Loss: 0.1807710 Test Loss: 0.2319732
Validation loss decreased (0.182725 --> 0.180771).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 22 cost time: 0.9606397151947021
Epoch: 22, Steps: 64 | Train Loss: 0.1227078 Vali Loss: 0.1800741 Test Loss: 0.2315144
Validation loss decreased (0.180771 --> 0.180074).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 23 cost time: 0.9486351013183594
Epoch: 23, Steps: 64 | Train Loss: 0.1226896 Vali Loss: 0.1795872 Test Loss: 0.2317433
Validation loss decreased (0.180074 --> 0.179587).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 24 cost time: 0.9393672943115234
Epoch: 24, Steps: 64 | Train Loss: 0.1227437 Vali Loss: 0.1804633 Test Loss: 0.2311937
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 25 cost time: 0.9493396282196045
Epoch: 25, Steps: 64 | Train Loss: 0.1218777 Vali Loss: 0.1802427 Test Loss: 0.2312673
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 26 cost time: 0.9740049839019775
Epoch: 26, Steps: 64 | Train Loss: 0.1221711 Vali Loss: 0.1784708 Test Loss: 0.2314129
Validation loss decreased (0.179587 --> 0.178471).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 27 cost time: 0.9673638343811035
Epoch: 27, Steps: 64 | Train Loss: 0.1213597 Vali Loss: 0.1793292 Test Loss: 0.2312600
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 28 cost time: 0.9633893966674805
Epoch: 28, Steps: 64 | Train Loss: 0.1216427 Vali Loss: 0.1795809 Test Loss: 0.2327985
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 29 cost time: 0.9703657627105713
Epoch: 29, Steps: 64 | Train Loss: 0.1221454 Vali Loss: 0.1794171 Test Loss: 0.2312166
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 30 cost time: 0.9641454219818115
Epoch: 30, Steps: 64 | Train Loss: 0.1214286 Vali Loss: 0.1784110 Test Loss: 0.2311864
Validation loss decreased (0.178471 --> 0.178411).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 31 cost time: 0.9730019569396973
Epoch: 31, Steps: 64 | Train Loss: 0.1212541 Vali Loss: 0.1793214 Test Loss: 0.2316271
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 32 cost time: 0.972604513168335
Epoch: 32, Steps: 64 | Train Loss: 0.1213164 Vali Loss: 0.1788833 Test Loss: 0.2312827
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 33 cost time: 0.9796342849731445
Epoch: 33, Steps: 64 | Train Loss: 0.1215114 Vali Loss: 0.1790322 Test Loss: 0.2307527
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 34 cost time: 0.9983351230621338
Epoch: 34, Steps: 64 | Train Loss: 0.1212227 Vali Loss: 0.1787376 Test Loss: 0.2316579
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 35 cost time: 1.0028047561645508
Epoch: 35, Steps: 64 | Train Loss: 0.1209312 Vali Loss: 0.1797947 Test Loss: 0.2314763
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 36 cost time: 0.9913973808288574
Epoch: 36, Steps: 64 | Train Loss: 0.1207814 Vali Loss: 0.1787411 Test Loss: 0.2315617
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 37 cost time: 0.9973776340484619
Epoch: 37, Steps: 64 | Train Loss: 0.1203046 Vali Loss: 0.1784296 Test Loss: 0.2308979
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 38 cost time: 0.9870693683624268
Epoch: 38, Steps: 64 | Train Loss: 0.1208468 Vali Loss: 0.1787181 Test Loss: 0.2308037
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 39 cost time: 0.9524970054626465
Epoch: 39, Steps: 64 | Train Loss: 0.1205093 Vali Loss: 0.1790049 Test Loss: 0.2324861
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 40 cost time: 0.9367556571960449
Epoch: 40, Steps: 64 | Train Loss: 0.1206112 Vali Loss: 0.1795326 Test Loss: 0.2319899
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 41 cost time: 0.9407405853271484
Epoch: 41, Steps: 64 | Train Loss: 0.1206894 Vali Loss: 0.1775948 Test Loss: 0.2316754
Validation loss decreased (0.178411 --> 0.177595).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 42 cost time: 0.9704399108886719
Epoch: 42, Steps: 64 | Train Loss: 0.1201660 Vali Loss: 0.1770006 Test Loss: 0.2311541
Validation loss decreased (0.177595 --> 0.177001).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 43 cost time: 0.950636625289917
Epoch: 43, Steps: 64 | Train Loss: 0.1201788 Vali Loss: 0.1764987 Test Loss: 0.2317214
Validation loss decreased (0.177001 --> 0.176499).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 44 cost time: 0.9646282196044922
Epoch: 44, Steps: 64 | Train Loss: 0.1207366 Vali Loss: 0.1770089 Test Loss: 0.2314213
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 45 cost time: 0.9844088554382324
Epoch: 45, Steps: 64 | Train Loss: 0.1200646 Vali Loss: 0.1792380 Test Loss: 0.2317621
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 46 cost time: 0.9548170566558838
Epoch: 46, Steps: 64 | Train Loss: 0.1199916 Vali Loss: 0.1798573 Test Loss: 0.2322620
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 47 cost time: 0.9563767910003662
Epoch: 47, Steps: 64 | Train Loss: 0.1201649 Vali Loss: 0.1795022 Test Loss: 0.2317068
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 48 cost time: 0.9564287662506104
Epoch: 48, Steps: 64 | Train Loss: 0.1204340 Vali Loss: 0.1787390 Test Loss: 0.2312192
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 49 cost time: 0.9664115905761719
Epoch: 49, Steps: 64 | Train Loss: 0.1196738 Vali Loss: 0.1799260 Test Loss: 0.2319175
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 50 cost time: 0.9784016609191895
Epoch: 50, Steps: 64 | Train Loss: 0.1198166 Vali Loss: 0.1792134 Test Loss: 0.2317507
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 51 cost time: 0.9957172870635986
Epoch: 51, Steps: 64 | Train Loss: 0.1205147 Vali Loss: 0.1782939 Test Loss: 0.2308739
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 52 cost time: 0.9859998226165771
Epoch: 52, Steps: 64 | Train Loss: 0.1196406 Vali Loss: 0.1764646 Test Loss: 0.2305721
Validation loss decreased (0.176499 --> 0.176465).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 53 cost time: 0.9904384613037109
Epoch: 53, Steps: 64 | Train Loss: 0.1201050 Vali Loss: 0.1760693 Test Loss: 0.2305822
Validation loss decreased (0.176465 --> 0.176069).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 54 cost time: 0.9895780086517334
Epoch: 54, Steps: 64 | Train Loss: 0.1193610 Vali Loss: 0.1764378 Test Loss: 0.2311926
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 55 cost time: 0.9736363887786865
Epoch: 55, Steps: 64 | Train Loss: 0.1197332 Vali Loss: 0.1804323 Test Loss: 0.2321095
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 56 cost time: 0.9703841209411621
Epoch: 56, Steps: 64 | Train Loss: 0.1198411 Vali Loss: 0.1784265 Test Loss: 0.2307548
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 57 cost time: 0.9733881950378418
Epoch: 57, Steps: 64 | Train Loss: 0.1199715 Vali Loss: 0.1784484 Test Loss: 0.2315886
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 58 cost time: 0.9700660705566406
Epoch: 58, Steps: 64 | Train Loss: 0.1196664 Vali Loss: 0.1790173 Test Loss: 0.2317972
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 59 cost time: 0.9673805236816406
Epoch: 59, Steps: 64 | Train Loss: 0.1199950 Vali Loss: 0.1779571 Test Loss: 0.2309040
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 60 cost time: 0.9664363861083984
Epoch: 60, Steps: 64 | Train Loss: 0.1197486 Vali Loss: 0.1782817 Test Loss: 0.2310435
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23058226704597473, mae:0.34744545817375183, rse:0.2433588206768036
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.04926586151123047 GB
Epoch: 1 cost time: 2.325965166091919
Epoch: 1, Steps: 64 | Train Loss: 0.8983819 Vali Loss: 2.3667438 Test Loss: 3.7739100
Validation loss decreased (inf --> 2.366744).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 2 cost time: 0.9488792419433594
Epoch: 2, Steps: 64 | Train Loss: 0.6202728 Vali Loss: 0.9640082 Test Loss: 1.4383090
Validation loss decreased (2.366744 --> 0.964008).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 3 cost time: 0.953345537185669
Epoch: 3, Steps: 64 | Train Loss: 0.3214812 Vali Loss: 0.4866044 Test Loss: 0.6738413
Validation loss decreased (0.964008 --> 0.486604).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 4 cost time: 0.9549987316131592
Epoch: 4, Steps: 64 | Train Loss: 0.2012741 Vali Loss: 0.2797602 Test Loss: 0.3566005
Validation loss decreased (0.486604 --> 0.279760).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 5 cost time: 0.9456260204315186
Epoch: 5, Steps: 64 | Train Loss: 0.1603130 Vali Loss: 0.2128961 Test Loss: 0.2644207
Validation loss decreased (0.279760 --> 0.212896).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 6 cost time: 0.8984458446502686
Epoch: 6, Steps: 64 | Train Loss: 0.1476771 Vali Loss: 0.2024631 Test Loss: 0.2515647
Validation loss decreased (0.212896 --> 0.202463).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 7 cost time: 0.8980624675750732
Epoch: 7, Steps: 64 | Train Loss: 0.1416950 Vali Loss: 0.1964416 Test Loss: 0.2388000
Validation loss decreased (0.202463 --> 0.196442).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 8 cost time: 0.9043712615966797
Epoch: 8, Steps: 64 | Train Loss: 0.1380468 Vali Loss: 0.1880204 Test Loss: 0.2347381
Validation loss decreased (0.196442 --> 0.188020).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 9 cost time: 0.9023692607879639
Epoch: 9, Steps: 64 | Train Loss: 0.1348817 Vali Loss: 0.1854928 Test Loss: 0.2291565
Validation loss decreased (0.188020 --> 0.185493).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 10 cost time: 0.9317443370819092
Epoch: 10, Steps: 64 | Train Loss: 0.1332478 Vali Loss: 0.1837218 Test Loss: 0.2285646
Validation loss decreased (0.185493 --> 0.183722).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 11 cost time: 0.9448347091674805
Epoch: 11, Steps: 64 | Train Loss: 0.1309004 Vali Loss: 0.1814353 Test Loss: 0.2288915
Validation loss decreased (0.183722 --> 0.181435).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 12 cost time: 0.9680013656616211
Epoch: 12, Steps: 64 | Train Loss: 0.1298987 Vali Loss: 0.1796266 Test Loss: 0.2277054
Validation loss decreased (0.181435 --> 0.179627).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 13 cost time: 0.9576377868652344
Epoch: 13, Steps: 64 | Train Loss: 0.1283757 Vali Loss: 0.1810495 Test Loss: 0.2299692
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 14 cost time: 0.9274773597717285
Epoch: 14, Steps: 64 | Train Loss: 0.1271868 Vali Loss: 0.1809648 Test Loss: 0.2291282
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 15 cost time: 0.9343628883361816
Epoch: 15, Steps: 64 | Train Loss: 0.1267047 Vali Loss: 0.1776492 Test Loss: 0.2266147
Validation loss decreased (0.179627 --> 0.177649).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 16 cost time: 0.9341793060302734
Epoch: 16, Steps: 64 | Train Loss: 0.1257606 Vali Loss: 0.1766300 Test Loss: 0.2264384
Validation loss decreased (0.177649 --> 0.176630).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 17 cost time: 0.9348657131195068
Epoch: 17, Steps: 64 | Train Loss: 0.1246335 Vali Loss: 0.1757013 Test Loss: 0.2266098
Validation loss decreased (0.176630 --> 0.175701).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 18 cost time: 0.948723554611206
Epoch: 18, Steps: 64 | Train Loss: 0.1239549 Vali Loss: 0.1781965 Test Loss: 0.2290691
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 19 cost time: 0.9487903118133545
Epoch: 19, Steps: 64 | Train Loss: 0.1238629 Vali Loss: 0.1775597 Test Loss: 0.2298996
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 20 cost time: 0.9554448127746582
Epoch: 20, Steps: 64 | Train Loss: 0.1235229 Vali Loss: 0.1781339 Test Loss: 0.2291845
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 21 cost time: 0.9586505889892578
Epoch: 21, Steps: 64 | Train Loss: 0.1233541 Vali Loss: 0.1794563 Test Loss: 0.2287583
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 22 cost time: 0.9346358776092529
Epoch: 22, Steps: 64 | Train Loss: 0.1224975 Vali Loss: 0.1772105 Test Loss: 0.2297226
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 23 cost time: 0.8983399868011475
Epoch: 23, Steps: 64 | Train Loss: 0.1223756 Vali Loss: 0.1771371 Test Loss: 0.2289349
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 24 cost time: 0.9034068584442139
Epoch: 24, Steps: 64 | Train Loss: 0.1219695 Vali Loss: 0.1759729 Test Loss: 0.2293108
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 25 cost time: 0.9124281406402588
Epoch: 25, Steps: 64 | Train Loss: 0.1215848 Vali Loss: 0.1738815 Test Loss: 0.2275438
Validation loss decreased (0.175701 --> 0.173882).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 26 cost time: 0.903843879699707
Epoch: 26, Steps: 64 | Train Loss: 0.1218693 Vali Loss: 0.1755687 Test Loss: 0.2285383
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 27 cost time: 0.9189989566802979
Epoch: 27, Steps: 64 | Train Loss: 0.1215392 Vali Loss: 0.1767960 Test Loss: 0.2283888
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 28 cost time: 0.9260354042053223
Epoch: 28, Steps: 64 | Train Loss: 0.1215455 Vali Loss: 0.1759978 Test Loss: 0.2293247
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 29 cost time: 0.9346392154693604
Epoch: 29, Steps: 64 | Train Loss: 0.1207373 Vali Loss: 0.1749993 Test Loss: 0.2290581
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 30 cost time: 0.9314675331115723
Epoch: 30, Steps: 64 | Train Loss: 0.1209422 Vali Loss: 0.1745251 Test Loss: 0.2291231
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 31 cost time: 0.9103977680206299
Epoch: 31, Steps: 64 | Train Loss: 0.1209379 Vali Loss: 0.1770951 Test Loss: 0.2294836
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 32 cost time: 0.936119794845581
Epoch: 32, Steps: 64 | Train Loss: 0.1205600 Vali Loss: 0.1778276 Test Loss: 0.2291363
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 33 cost time: 0.9314255714416504
Epoch: 33, Steps: 64 | Train Loss: 0.1201892 Vali Loss: 0.1754788 Test Loss: 0.2293910
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 34 cost time: 0.92873215675354
Epoch: 34, Steps: 64 | Train Loss: 0.1204670 Vali Loss: 0.1762901 Test Loss: 0.2293168
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 35 cost time: 0.9509994983673096
Epoch: 35, Steps: 64 | Train Loss: 0.1205444 Vali Loss: 0.1769011 Test Loss: 0.2303462
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 36 cost time: 0.969641923904419
Epoch: 36, Steps: 64 | Train Loss: 0.1202105 Vali Loss: 0.1764933 Test Loss: 0.2290762
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 37 cost time: 0.9626400470733643
Epoch: 37, Steps: 64 | Train Loss: 0.1202058 Vali Loss: 0.1753531 Test Loss: 0.2289716
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 38 cost time: 0.9543266296386719
Epoch: 38, Steps: 64 | Train Loss: 0.1194012 Vali Loss: 0.1770131 Test Loss: 0.2301972
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 39 cost time: 0.954418420791626
Epoch: 39, Steps: 64 | Train Loss: 0.1199006 Vali Loss: 0.1764030 Test Loss: 0.2299554
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 40 cost time: 0.9261620044708252
Epoch: 40, Steps: 64 | Train Loss: 0.1198997 Vali Loss: 0.1776586 Test Loss: 0.2300797
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 41 cost time: 0.9278297424316406
Epoch: 41, Steps: 64 | Train Loss: 0.1196960 Vali Loss: 0.1749363 Test Loss: 0.2285625
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 42 cost time: 0.9004998207092285
Epoch: 42, Steps: 64 | Train Loss: 0.1197350 Vali Loss: 0.1757663 Test Loss: 0.2290927
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 43 cost time: 0.899646520614624
Epoch: 43, Steps: 64 | Train Loss: 0.1196438 Vali Loss: 0.1749040 Test Loss: 0.2295041
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 44 cost time: 0.9276425838470459
Epoch: 44, Steps: 64 | Train Loss: 0.1196483 Vali Loss: 0.1759210 Test Loss: 0.2293003
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 45 cost time: 0.9267659187316895
Epoch: 45, Steps: 64 | Train Loss: 0.1201421 Vali Loss: 0.1771081 Test Loss: 0.2306244
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 46 cost time: 0.9344272613525391
Epoch: 46, Steps: 64 | Train Loss: 0.1193218 Vali Loss: 0.1741795 Test Loss: 0.2294946
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 47 cost time: 0.931450605392456
Epoch: 47, Steps: 64 | Train Loss: 0.1198569 Vali Loss: 0.1752944 Test Loss: 0.2292426
EarlyStopping counter: 22 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 48 cost time: 0.9083454608917236
Epoch: 48, Steps: 64 | Train Loss: 0.1197212 Vali Loss: 0.1768031 Test Loss: 0.2294006
EarlyStopping counter: 23 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 49 cost time: 0.9197981357574463
Epoch: 49, Steps: 64 | Train Loss: 0.1191567 Vali Loss: 0.1748794 Test Loss: 0.2290784
EarlyStopping counter: 24 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 50 cost time: 0.9099996089935303
Epoch: 50, Steps: 64 | Train Loss: 0.1195794 Vali Loss: 0.1750314 Test Loss: 0.2290134
EarlyStopping counter: 25 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 51 cost time: 0.9096384048461914
Epoch: 51, Steps: 64 | Train Loss: 0.1197033 Vali Loss: 0.1749414 Test Loss: 0.2295876
EarlyStopping counter: 26 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 52 cost time: 0.9442033767700195
Epoch: 52, Steps: 64 | Train Loss: 0.1192124 Vali Loss: 0.1758227 Test Loss: 0.2289922
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 53 cost time: 0.9653966426849365
Epoch: 53, Steps: 64 | Train Loss: 0.1197555 Vali Loss: 0.1780606 Test Loss: 0.2299450
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 54 cost time: 0.9749894142150879
Epoch: 54, Steps: 64 | Train Loss: 0.1194998 Vali Loss: 0.1768783 Test Loss: 0.2293456
EarlyStopping counter: 29 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 55 cost time: 0.9504191875457764
Epoch: 55, Steps: 64 | Train Loss: 0.1196973 Vali Loss: 0.1752996 Test Loss: 0.2302310
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 56 cost time: 0.9473764896392822
Epoch: 56, Steps: 64 | Train Loss: 0.1194523 Vali Loss: 0.1762372 Test Loss: 0.2293954
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 57 cost time: 0.9277791976928711
Epoch: 57, Steps: 64 | Train Loss: 0.1196316 Vali Loss: 0.1742413 Test Loss: 0.2287586
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 58 cost time: 0.937370777130127
Epoch: 58, Steps: 64 | Train Loss: 0.1193902 Vali Loss: 0.1756088 Test Loss: 0.2293326
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 59 cost time: 0.9339995384216309
Epoch: 59, Steps: 64 | Train Loss: 0.1193409 Vali Loss: 0.1746952 Test Loss: 0.2296066
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 60 cost time: 0.9406414031982422
Epoch: 60, Steps: 64 | Train Loss: 0.1193569 Vali Loss: 0.1749591 Test Loss: 0.2297693
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22754384577274323, mae:0.3440340459346771, rse:0.24175012111663818
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045186519622802734 GB
Epoch: 1 cost time: 2.2586493492126465
Epoch: 1, Steps: 64 | Train Loss: 1.1442836 Vali Loss: 2.6922593 Test Loss: 4.2989569
Validation loss decreased (inf --> 2.692259).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 2 cost time: 0.9123766422271729
Epoch: 2, Steps: 64 | Train Loss: 0.8438999 Vali Loss: 1.2057127 Test Loss: 1.8380533
Validation loss decreased (2.692259 --> 1.205713).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 3 cost time: 0.9127821922302246
Epoch: 3, Steps: 64 | Train Loss: 0.4462051 Vali Loss: 0.4774352 Test Loss: 0.6291793
Validation loss decreased (1.205713 --> 0.477435).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 4 cost time: 0.9085290431976318
Epoch: 4, Steps: 64 | Train Loss: 0.2711257 Vali Loss: 0.3064336 Test Loss: 0.3719189
Validation loss decreased (0.477435 --> 0.306434).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 5 cost time: 0.9128687381744385
Epoch: 5, Steps: 64 | Train Loss: 0.2190893 Vali Loss: 0.2513301 Test Loss: 0.3071264
Validation loss decreased (0.306434 --> 0.251330).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 6 cost time: 0.8899977207183838
Epoch: 6, Steps: 64 | Train Loss: 0.1952386 Vali Loss: 0.2228461 Test Loss: 0.2775089
Validation loss decreased (0.251330 --> 0.222846).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 7 cost time: 0.8976664543151855
Epoch: 7, Steps: 64 | Train Loss: 0.1820432 Vali Loss: 0.2074366 Test Loss: 0.2611403
Validation loss decreased (0.222846 --> 0.207437).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 8 cost time: 0.8913619518280029
Epoch: 8, Steps: 64 | Train Loss: 0.1735418 Vali Loss: 0.2024894 Test Loss: 0.2547749
Validation loss decreased (0.207437 --> 0.202489).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 9 cost time: 0.8903427124023438
Epoch: 9, Steps: 64 | Train Loss: 0.1664964 Vali Loss: 0.1982741 Test Loss: 0.2509584
Validation loss decreased (0.202489 --> 0.198274).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 10 cost time: 0.9193680286407471
Epoch: 10, Steps: 64 | Train Loss: 0.1627620 Vali Loss: 0.1932321 Test Loss: 0.2464509
Validation loss decreased (0.198274 --> 0.193232).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 11 cost time: 0.9408252239227295
Epoch: 11, Steps: 64 | Train Loss: 0.1586870 Vali Loss: 0.1930538 Test Loss: 0.2451496
Validation loss decreased (0.193232 --> 0.193054).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 12 cost time: 0.934999942779541
Epoch: 12, Steps: 64 | Train Loss: 0.1547204 Vali Loss: 0.1867265 Test Loss: 0.2422806
Validation loss decreased (0.193054 --> 0.186726).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 13 cost time: 0.9349994659423828
Epoch: 13, Steps: 64 | Train Loss: 0.1530411 Vali Loss: 0.1856679 Test Loss: 0.2394867
Validation loss decreased (0.186726 --> 0.185668).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 14 cost time: 0.9466559886932373
Epoch: 14, Steps: 64 | Train Loss: 0.1502536 Vali Loss: 0.1849179 Test Loss: 0.2398169
Validation loss decreased (0.185668 --> 0.184918).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 15 cost time: 0.9163975715637207
Epoch: 15, Steps: 64 | Train Loss: 0.1481924 Vali Loss: 0.1850811 Test Loss: 0.2392719
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 16 cost time: 0.9219627380371094
Epoch: 16, Steps: 64 | Train Loss: 0.1470527 Vali Loss: 0.1819151 Test Loss: 0.2367536
Validation loss decreased (0.184918 --> 0.181915).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 17 cost time: 0.9193761348724365
Epoch: 17, Steps: 64 | Train Loss: 0.1452590 Vali Loss: 0.1807566 Test Loss: 0.2353698
Validation loss decreased (0.181915 --> 0.180757).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 18 cost time: 0.9127414226531982
Epoch: 18, Steps: 64 | Train Loss: 0.1444368 Vali Loss: 0.1787511 Test Loss: 0.2365066
Validation loss decreased (0.180757 --> 0.178751).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 19 cost time: 0.9287471771240234
Epoch: 19, Steps: 64 | Train Loss: 0.1427362 Vali Loss: 0.1811476 Test Loss: 0.2388305
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 20 cost time: 0.9253931045532227
Epoch: 20, Steps: 64 | Train Loss: 0.1432132 Vali Loss: 0.1782130 Test Loss: 0.2348321
Validation loss decreased (0.178751 --> 0.178213).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 21 cost time: 0.9136388301849365
Epoch: 21, Steps: 64 | Train Loss: 0.1424929 Vali Loss: 0.1787862 Test Loss: 0.2322801
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 22 cost time: 0.905360221862793
Epoch: 22, Steps: 64 | Train Loss: 0.1405453 Vali Loss: 0.1776663 Test Loss: 0.2344808
Validation loss decreased (0.178213 --> 0.177666).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 23 cost time: 0.9089787006378174
Epoch: 23, Steps: 64 | Train Loss: 0.1408288 Vali Loss: 0.1797939 Test Loss: 0.2350429
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 24 cost time: 0.9025225639343262
Epoch: 24, Steps: 64 | Train Loss: 0.1396221 Vali Loss: 0.1760831 Test Loss: 0.2330861
Validation loss decreased (0.177666 --> 0.176083).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 25 cost time: 0.8957455158233643
Epoch: 25, Steps: 64 | Train Loss: 0.1388189 Vali Loss: 0.1760564 Test Loss: 0.2324696
Validation loss decreased (0.176083 --> 0.176056).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 26 cost time: 0.8940002918243408
Epoch: 26, Steps: 64 | Train Loss: 0.1388608 Vali Loss: 0.1775695 Test Loss: 0.2335680
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 27 cost time: 0.903630256652832
Epoch: 27, Steps: 64 | Train Loss: 0.1380792 Vali Loss: 0.1755436 Test Loss: 0.2332898
Validation loss decreased (0.176056 --> 0.175544).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 28 cost time: 0.9169597625732422
Epoch: 28, Steps: 64 | Train Loss: 0.1378986 Vali Loss: 0.1762596 Test Loss: 0.2333469
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 29 cost time: 0.9100279808044434
Epoch: 29, Steps: 64 | Train Loss: 0.1367878 Vali Loss: 0.1777454 Test Loss: 0.2345159
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 30 cost time: 0.9214205741882324
Epoch: 30, Steps: 64 | Train Loss: 0.1361951 Vali Loss: 0.1748585 Test Loss: 0.2332227
Validation loss decreased (0.175544 --> 0.174858).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 31 cost time: 0.9353594779968262
Epoch: 31, Steps: 64 | Train Loss: 0.1364776 Vali Loss: 0.1743110 Test Loss: 0.2307136
Validation loss decreased (0.174858 --> 0.174311).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 32 cost time: 0.9307341575622559
Epoch: 32, Steps: 64 | Train Loss: 0.1362316 Vali Loss: 0.1760098 Test Loss: 0.2320120
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 33 cost time: 0.9254257678985596
Epoch: 33, Steps: 64 | Train Loss: 0.1363541 Vali Loss: 0.1722029 Test Loss: 0.2316258
Validation loss decreased (0.174311 --> 0.172203).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 34 cost time: 0.9176468849182129
Epoch: 34, Steps: 64 | Train Loss: 0.1353271 Vali Loss: 0.1748025 Test Loss: 0.2314133
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 35 cost time: 0.9283781051635742
Epoch: 35, Steps: 64 | Train Loss: 0.1354982 Vali Loss: 0.1726023 Test Loss: 0.2306574
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 36 cost time: 0.9163668155670166
Epoch: 36, Steps: 64 | Train Loss: 0.1354614 Vali Loss: 0.1715354 Test Loss: 0.2296161
Validation loss decreased (0.172203 --> 0.171535).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 37 cost time: 0.9394001960754395
Epoch: 37, Steps: 64 | Train Loss: 0.1360120 Vali Loss: 0.1734117 Test Loss: 0.2307611
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 38 cost time: 0.9393723011016846
Epoch: 38, Steps: 64 | Train Loss: 0.1356796 Vali Loss: 0.1743399 Test Loss: 0.2317754
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 39 cost time: 0.9357452392578125
Epoch: 39, Steps: 64 | Train Loss: 0.1346498 Vali Loss: 0.1745302 Test Loss: 0.2324142
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 40 cost time: 0.918999433517456
Epoch: 40, Steps: 64 | Train Loss: 0.1352687 Vali Loss: 0.1734272 Test Loss: 0.2308313
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 41 cost time: 0.8996491432189941
Epoch: 41, Steps: 64 | Train Loss: 0.1348537 Vali Loss: 0.1728887 Test Loss: 0.2311828
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 42 cost time: 0.9012582302093506
Epoch: 42, Steps: 64 | Train Loss: 0.1349806 Vali Loss: 0.1710996 Test Loss: 0.2314890
Validation loss decreased (0.171535 --> 0.171100).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 43 cost time: 0.8933749198913574
Epoch: 43, Steps: 64 | Train Loss: 0.1346963 Vali Loss: 0.1741759 Test Loss: 0.2317974
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 44 cost time: 0.9004073143005371
Epoch: 44, Steps: 64 | Train Loss: 0.1345005 Vali Loss: 0.1709938 Test Loss: 0.2296898
Validation loss decreased (0.171100 --> 0.170994).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 45 cost time: 0.907726526260376
Epoch: 45, Steps: 64 | Train Loss: 0.1346998 Vali Loss: 0.1716344 Test Loss: 0.2295066
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 46 cost time: 0.908402681350708
Epoch: 46, Steps: 64 | Train Loss: 0.1344617 Vali Loss: 0.1723123 Test Loss: 0.2297651
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 47 cost time: 0.9086360931396484
Epoch: 47, Steps: 64 | Train Loss: 0.1342823 Vali Loss: 0.1724862 Test Loss: 0.2303990
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 48 cost time: 0.9054341316223145
Epoch: 48, Steps: 64 | Train Loss: 0.1337331 Vali Loss: 0.1724706 Test Loss: 0.2304069
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 49 cost time: 0.9323720932006836
Epoch: 49, Steps: 64 | Train Loss: 0.1341877 Vali Loss: 0.1727546 Test Loss: 0.2297369
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 50 cost time: 0.9164285659790039
Epoch: 50, Steps: 64 | Train Loss: 0.1345296 Vali Loss: 0.1749381 Test Loss: 0.2333768
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 51 cost time: 0.9214174747467041
Epoch: 51, Steps: 64 | Train Loss: 0.1348693 Vali Loss: 0.1724968 Test Loss: 0.2307613
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 52 cost time: 0.9218366146087646
Epoch: 52, Steps: 64 | Train Loss: 0.1336105 Vali Loss: 0.1714754 Test Loss: 0.2306232
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 53 cost time: 0.9359996318817139
Epoch: 53, Steps: 64 | Train Loss: 0.1340087 Vali Loss: 0.1717835 Test Loss: 0.2294134
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 54 cost time: 0.9296472072601318
Epoch: 54, Steps: 64 | Train Loss: 0.1342211 Vali Loss: 0.1736685 Test Loss: 0.2317865
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 55 cost time: 0.9432575702667236
Epoch: 55, Steps: 64 | Train Loss: 0.1339340 Vali Loss: 0.1719113 Test Loss: 0.2295385
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 56 cost time: 0.9486122131347656
Epoch: 56, Steps: 64 | Train Loss: 0.1342040 Vali Loss: 0.1723181 Test Loss: 0.2288348
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 57 cost time: 0.9284095764160156
Epoch: 57, Steps: 64 | Train Loss: 0.1341831 Vali Loss: 0.1705757 Test Loss: 0.2297601
Validation loss decreased (0.170994 --> 0.170576).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 58 cost time: 0.9333763122558594
Epoch: 58, Steps: 64 | Train Loss: 0.1335769 Vali Loss: 0.1731904 Test Loss: 0.2317950
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 59 cost time: 0.9293737411499023
Epoch: 59, Steps: 64 | Train Loss: 0.1338997 Vali Loss: 0.1724139 Test Loss: 0.2295888
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 60 cost time: 0.8976414203643799
Epoch: 60, Steps: 64 | Train Loss: 0.1340987 Vali Loss: 0.1734299 Test Loss: 0.2302317
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22976011037826538, mae:0.33642515540122986, rse:0.24292457103729248
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.04661846160888672 GB
Epoch: 1 cost time: 2.356236696243286
Epoch: 1, Steps: 64 | Train Loss: 0.8765663 Vali Loss: 2.2518528 Test Loss: 3.5399690
Validation loss decreased (inf --> 2.251853).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 2 cost time: 0.957618236541748
Epoch: 2, Steps: 64 | Train Loss: 0.5656337 Vali Loss: 0.7038512 Test Loss: 0.9924313
Validation loss decreased (2.251853 --> 0.703851).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 3 cost time: 0.9514458179473877
Epoch: 3, Steps: 64 | Train Loss: 0.2238255 Vali Loss: 0.2340025 Test Loss: 0.2813182
Validation loss decreased (0.703851 --> 0.234002).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 4 cost time: 0.9414734840393066
Epoch: 4, Steps: 64 | Train Loss: 0.1498729 Vali Loss: 0.1887692 Test Loss: 0.2358119
Validation loss decreased (0.234002 --> 0.188769).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 5 cost time: 0.9363818168640137
Epoch: 5, Steps: 64 | Train Loss: 0.1382046 Vali Loss: 0.1795175 Test Loss: 0.2306479
Validation loss decreased (0.188769 --> 0.179518).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 6 cost time: 0.9304554462432861
Epoch: 6, Steps: 64 | Train Loss: 0.1313057 Vali Loss: 0.1813805 Test Loss: 0.2315212
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 7 cost time: 0.9237754344940186
Epoch: 7, Steps: 64 | Train Loss: 0.1275700 Vali Loss: 0.1787103 Test Loss: 0.2298675
Validation loss decreased (0.179518 --> 0.178710).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 8 cost time: 0.9261271953582764
Epoch: 8, Steps: 64 | Train Loss: 0.1239493 Vali Loss: 0.1759111 Test Loss: 0.2286730
Validation loss decreased (0.178710 --> 0.175911).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 9 cost time: 0.9349935054779053
Epoch: 9, Steps: 64 | Train Loss: 0.1222022 Vali Loss: 0.1702815 Test Loss: 0.2271647
Validation loss decreased (0.175911 --> 0.170282).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 10 cost time: 0.9576263427734375
Epoch: 10, Steps: 64 | Train Loss: 0.1197714 Vali Loss: 0.1706504 Test Loss: 0.2262555
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 11 cost time: 0.9753625392913818
Epoch: 11, Steps: 64 | Train Loss: 0.1179968 Vali Loss: 0.1682737 Test Loss: 0.2247571
Validation loss decreased (0.170282 --> 0.168274).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 12 cost time: 0.9810559749603271
Epoch: 12, Steps: 64 | Train Loss: 0.1175468 Vali Loss: 0.1692012 Test Loss: 0.2252075
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 13 cost time: 0.9783744812011719
Epoch: 13, Steps: 64 | Train Loss: 0.1161064 Vali Loss: 0.1692992 Test Loss: 0.2255692
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 14 cost time: 0.9534187316894531
Epoch: 14, Steps: 64 | Train Loss: 0.1158110 Vali Loss: 0.1655640 Test Loss: 0.2250643
Validation loss decreased (0.168274 --> 0.165564).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 15 cost time: 0.9593689441680908
Epoch: 15, Steps: 64 | Train Loss: 0.1145935 Vali Loss: 0.1670307 Test Loss: 0.2238494
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 16 cost time: 0.9593737125396729
Epoch: 16, Steps: 64 | Train Loss: 0.1132622 Vali Loss: 0.1636587 Test Loss: 0.2237674
Validation loss decreased (0.165564 --> 0.163659).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 17 cost time: 0.9427406787872314
Epoch: 17, Steps: 64 | Train Loss: 0.1126486 Vali Loss: 0.1633515 Test Loss: 0.2234696
Validation loss decreased (0.163659 --> 0.163352).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 18 cost time: 0.9614322185516357
Epoch: 18, Steps: 64 | Train Loss: 0.1120904 Vali Loss: 0.1639123 Test Loss: 0.2232620
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 19 cost time: 0.9806301593780518
Epoch: 19, Steps: 64 | Train Loss: 0.1117738 Vali Loss: 0.1646920 Test Loss: 0.2242777
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 20 cost time: 0.9552075862884521
Epoch: 20, Steps: 64 | Train Loss: 0.1113655 Vali Loss: 0.1624317 Test Loss: 0.2233904
Validation loss decreased (0.163352 --> 0.162432).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 21 cost time: 0.9553782939910889
Epoch: 21, Steps: 64 | Train Loss: 0.1110410 Vali Loss: 0.1618322 Test Loss: 0.2240501
Validation loss decreased (0.162432 --> 0.161832).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 22 cost time: 0.9443902969360352
Epoch: 22, Steps: 64 | Train Loss: 0.1104583 Vali Loss: 0.1619788 Test Loss: 0.2228632
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 23 cost time: 0.9394440650939941
Epoch: 23, Steps: 64 | Train Loss: 0.1104854 Vali Loss: 0.1613530 Test Loss: 0.2230028
Validation loss decreased (0.161832 --> 0.161353).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 24 cost time: 0.9403762817382812
Epoch: 24, Steps: 64 | Train Loss: 0.1103019 Vali Loss: 0.1625881 Test Loss: 0.2240521
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 25 cost time: 0.9404783248901367
Epoch: 25, Steps: 64 | Train Loss: 0.1095437 Vali Loss: 0.1608748 Test Loss: 0.2224542
Validation loss decreased (0.161353 --> 0.160875).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 26 cost time: 0.9399995803833008
Epoch: 26, Steps: 64 | Train Loss: 0.1093657 Vali Loss: 0.1603647 Test Loss: 0.2223080
Validation loss decreased (0.160875 --> 0.160365).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 27 cost time: 0.9486336708068848
Epoch: 27, Steps: 64 | Train Loss: 0.1094074 Vali Loss: 0.1605704 Test Loss: 0.2235747
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 28 cost time: 0.9506471157073975
Epoch: 28, Steps: 64 | Train Loss: 0.1089668 Vali Loss: 0.1598584 Test Loss: 0.2233782
Validation loss decreased (0.160365 --> 0.159858).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 29 cost time: 0.9722175598144531
Epoch: 29, Steps: 64 | Train Loss: 0.1087865 Vali Loss: 0.1592898 Test Loss: 0.2235548
Validation loss decreased (0.159858 --> 0.159290).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 30 cost time: 0.9794180393218994
Epoch: 30, Steps: 64 | Train Loss: 0.1085320 Vali Loss: 0.1599891 Test Loss: 0.2228793
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 31 cost time: 0.9561305046081543
Epoch: 31, Steps: 64 | Train Loss: 0.1093736 Vali Loss: 0.1587802 Test Loss: 0.2223816
Validation loss decreased (0.159290 --> 0.158780).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 32 cost time: 0.9584395885467529
Epoch: 32, Steps: 64 | Train Loss: 0.1089049 Vali Loss: 0.1600634 Test Loss: 0.2241304
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 33 cost time: 0.9683482646942139
Epoch: 33, Steps: 64 | Train Loss: 0.1089387 Vali Loss: 0.1583552 Test Loss: 0.2228108
Validation loss decreased (0.158780 --> 0.158355).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 34 cost time: 0.9584014415740967
Epoch: 34, Steps: 64 | Train Loss: 0.1086732 Vali Loss: 0.1611073 Test Loss: 0.2240182
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 35 cost time: 0.9690001010894775
Epoch: 35, Steps: 64 | Train Loss: 0.1085039 Vali Loss: 0.1567694 Test Loss: 0.2227175
Validation loss decreased (0.158355 --> 0.156769).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 36 cost time: 0.9750015735626221
Epoch: 36, Steps: 64 | Train Loss: 0.1085620 Vali Loss: 0.1598324 Test Loss: 0.2241332
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 37 cost time: 0.9766216278076172
Epoch: 37, Steps: 64 | Train Loss: 0.1083359 Vali Loss: 0.1584276 Test Loss: 0.2228789
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 38 cost time: 0.9809143543243408
Epoch: 38, Steps: 64 | Train Loss: 0.1083739 Vali Loss: 0.1598679 Test Loss: 0.2231832
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 39 cost time: 0.9553859233856201
Epoch: 39, Steps: 64 | Train Loss: 0.1078473 Vali Loss: 0.1576505 Test Loss: 0.2232690
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 40 cost time: 0.936633825302124
Epoch: 40, Steps: 64 | Train Loss: 0.1082007 Vali Loss: 0.1595470 Test Loss: 0.2235243
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 41 cost time: 0.9264140129089355
Epoch: 41, Steps: 64 | Train Loss: 0.1079509 Vali Loss: 0.1588734 Test Loss: 0.2235414
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 42 cost time: 0.9149444103240967
Epoch: 42, Steps: 64 | Train Loss: 0.1080977 Vali Loss: 0.1597801 Test Loss: 0.2237637
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 43 cost time: 0.9230015277862549
Epoch: 43, Steps: 64 | Train Loss: 0.1079727 Vali Loss: 0.1584035 Test Loss: 0.2228528
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 44 cost time: 0.9419996738433838
Epoch: 44, Steps: 64 | Train Loss: 0.1079179 Vali Loss: 0.1588124 Test Loss: 0.2224926
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 45 cost time: 0.933640718460083
Epoch: 45, Steps: 64 | Train Loss: 0.1078551 Vali Loss: 0.1589451 Test Loss: 0.2228412
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 46 cost time: 0.9393644332885742
Epoch: 46, Steps: 64 | Train Loss: 0.1076731 Vali Loss: 0.1579179 Test Loss: 0.2228874
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 47 cost time: 0.9450998306274414
Epoch: 47, Steps: 64 | Train Loss: 0.1078079 Vali Loss: 0.1586479 Test Loss: 0.2225283
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 48 cost time: 0.9379622936248779
Epoch: 48, Steps: 64 | Train Loss: 0.1080201 Vali Loss: 0.1601269 Test Loss: 0.2226568
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 49 cost time: 0.9544174671173096
Epoch: 49, Steps: 64 | Train Loss: 0.1073531 Vali Loss: 0.1597694 Test Loss: 0.2234262
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 50 cost time: 0.9628586769104004
Epoch: 50, Steps: 64 | Train Loss: 0.1073462 Vali Loss: 0.1594598 Test Loss: 0.2243206
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 51 cost time: 0.9553787708282471
Epoch: 51, Steps: 64 | Train Loss: 0.1074843 Vali Loss: 0.1583442 Test Loss: 0.2231373
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 52 cost time: 0.9616255760192871
Epoch: 52, Steps: 64 | Train Loss: 0.1080489 Vali Loss: 0.1596799 Test Loss: 0.2236615
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 53 cost time: 0.9766125679016113
Epoch: 53, Steps: 64 | Train Loss: 0.1078276 Vali Loss: 0.1588605 Test Loss: 0.2224051
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 54 cost time: 0.9123575687408447
Epoch: 54, Steps: 64 | Train Loss: 0.1076988 Vali Loss: 0.1599291 Test Loss: 0.2234562
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 55 cost time: 0.9690783023834229
Epoch: 55, Steps: 64 | Train Loss: 0.1077846 Vali Loss: 0.1588406 Test Loss: 0.2226007
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 56 cost time: 0.9614238739013672
Epoch: 56, Steps: 64 | Train Loss: 0.1073422 Vali Loss: 0.1587788 Test Loss: 0.2220537
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 57 cost time: 0.9453732967376709
Epoch: 57, Steps: 64 | Train Loss: 0.1074892 Vali Loss: 0.1573106 Test Loss: 0.2229016
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 58 cost time: 0.9287190437316895
Epoch: 58, Steps: 64 | Train Loss: 0.1076300 Vali Loss: 0.1581199 Test Loss: 0.2235341
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 59 cost time: 0.9157991409301758
Epoch: 59, Steps: 64 | Train Loss: 0.1077161 Vali Loss: 0.1573356 Test Loss: 0.2233542
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 60 cost time: 0.9149982929229736
Epoch: 60, Steps: 64 | Train Loss: 0.1078290 Vali Loss: 0.1597332 Test Loss: 0.2245376
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2227175235748291, mae:0.32550498843193054, rse:0.2391725480556488
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04773855209350586 GB
Epoch: 1 cost time: 2.343484401702881
Epoch: 1, Steps: 64 | Train Loss: 1.0361460 Vali Loss: 2.8186269 Test Loss: 4.4921079
Validation loss decreased (inf --> 2.818627).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 2 cost time: 0.9552712440490723
Epoch: 2, Steps: 64 | Train Loss: 0.7528724 Vali Loss: 1.2690805 Test Loss: 1.9082329
Validation loss decreased (2.818627 --> 1.269081).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 3 cost time: 0.9618942737579346
Epoch: 3, Steps: 64 | Train Loss: 0.2936365 Vali Loss: 0.2662181 Test Loss: 0.2871758
Validation loss decreased (1.269081 --> 0.266218).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 4 cost time: 0.9737024307250977
Epoch: 4, Steps: 64 | Train Loss: 0.1420767 Vali Loss: 0.1886674 Test Loss: 0.2342296
Validation loss decreased (0.266218 --> 0.188667).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 5 cost time: 0.9615471363067627
Epoch: 5, Steps: 64 | Train Loss: 0.1302973 Vali Loss: 0.1850190 Test Loss: 0.2331217
Validation loss decreased (0.188667 --> 0.185019).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 6 cost time: 0.928016185760498
Epoch: 6, Steps: 64 | Train Loss: 0.1244093 Vali Loss: 0.1787562 Test Loss: 0.2320411
Validation loss decreased (0.185019 --> 0.178756).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 7 cost time: 0.9477119445800781
Epoch: 7, Steps: 64 | Train Loss: 0.1220468 Vali Loss: 0.1780530 Test Loss: 0.2309928
Validation loss decreased (0.178756 --> 0.178053).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 8 cost time: 0.933103084564209
Epoch: 8, Steps: 64 | Train Loss: 0.1195831 Vali Loss: 0.1765086 Test Loss: 0.2305034
Validation loss decreased (0.178053 --> 0.176509).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 9 cost time: 0.9336156845092773
Epoch: 9, Steps: 64 | Train Loss: 0.1176688 Vali Loss: 0.1737528 Test Loss: 0.2297845
Validation loss decreased (0.176509 --> 0.173753).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 10 cost time: 0.9901778697967529
Epoch: 10, Steps: 64 | Train Loss: 0.1163302 Vali Loss: 0.1712666 Test Loss: 0.2297454
Validation loss decreased (0.173753 --> 0.171267).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 11 cost time: 0.9843075275421143
Epoch: 11, Steps: 64 | Train Loss: 0.1151866 Vali Loss: 0.1715131 Test Loss: 0.2299400
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 12 cost time: 0.9910988807678223
Epoch: 12, Steps: 64 | Train Loss: 0.1139715 Vali Loss: 0.1719905 Test Loss: 0.2310065
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 13 cost time: 0.9887368679046631
Epoch: 13, Steps: 64 | Train Loss: 0.1132815 Vali Loss: 0.1687368 Test Loss: 0.2292693
Validation loss decreased (0.171267 --> 0.168737).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 14 cost time: 0.9914212226867676
Epoch: 14, Steps: 64 | Train Loss: 0.1123472 Vali Loss: 0.1680712 Test Loss: 0.2293247
Validation loss decreased (0.168737 --> 0.168071).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 15 cost time: 1.0146775245666504
Epoch: 15, Steps: 64 | Train Loss: 0.1120129 Vali Loss: 0.1662852 Test Loss: 0.2282018
Validation loss decreased (0.168071 --> 0.166285).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 16 cost time: 1.0122411251068115
Epoch: 16, Steps: 64 | Train Loss: 0.1111891 Vali Loss: 0.1673976 Test Loss: 0.2292034
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 17 cost time: 1.0346581935882568
Epoch: 17, Steps: 64 | Train Loss: 0.1108937 Vali Loss: 0.1669329 Test Loss: 0.2290992
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 18 cost time: 1.0690925121307373
Epoch: 18, Steps: 64 | Train Loss: 0.1104671 Vali Loss: 0.1659648 Test Loss: 0.2284791
Validation loss decreased (0.166285 --> 0.165965).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 19 cost time: 1.003000259399414
Epoch: 19, Steps: 64 | Train Loss: 0.1098618 Vali Loss: 0.1670041 Test Loss: 0.2290121
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 20 cost time: 0.9478878974914551
Epoch: 20, Steps: 64 | Train Loss: 0.1095206 Vali Loss: 0.1647890 Test Loss: 0.2294669
Validation loss decreased (0.165965 --> 0.164789).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 21 cost time: 0.9589533805847168
Epoch: 21, Steps: 64 | Train Loss: 0.1092069 Vali Loss: 0.1661516 Test Loss: 0.2290555
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 22 cost time: 1.1046600341796875
Epoch: 22, Steps: 64 | Train Loss: 0.1096944 Vali Loss: 0.1637369 Test Loss: 0.2281238
Validation loss decreased (0.164789 --> 0.163737).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 23 cost time: 1.0696980953216553
Epoch: 23, Steps: 64 | Train Loss: 0.1090938 Vali Loss: 0.1636976 Test Loss: 0.2283057
Validation loss decreased (0.163737 --> 0.163698).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 24 cost time: 1.0779788494110107
Epoch: 24, Steps: 64 | Train Loss: 0.1088064 Vali Loss: 0.1645089 Test Loss: 0.2290540
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 25 cost time: 1.081334114074707
Epoch: 25, Steps: 64 | Train Loss: 0.1088600 Vali Loss: 0.1635781 Test Loss: 0.2280695
Validation loss decreased (0.163698 --> 0.163578).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 26 cost time: 1.1086692810058594
Epoch: 26, Steps: 64 | Train Loss: 0.1083684 Vali Loss: 0.1633651 Test Loss: 0.2281096
Validation loss decreased (0.163578 --> 0.163365).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 27 cost time: 1.0639007091522217
Epoch: 27, Steps: 64 | Train Loss: 0.1081283 Vali Loss: 0.1638194 Test Loss: 0.2279545
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 28 cost time: 1.093125820159912
Epoch: 28, Steps: 64 | Train Loss: 0.1083357 Vali Loss: 0.1625791 Test Loss: 0.2285340
Validation loss decreased (0.163365 --> 0.162579).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 29 cost time: 1.0969998836517334
Epoch: 29, Steps: 64 | Train Loss: 0.1077976 Vali Loss: 0.1632820 Test Loss: 0.2292638
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 30 cost time: 1.0694596767425537
Epoch: 30, Steps: 64 | Train Loss: 0.1082175 Vali Loss: 0.1623931 Test Loss: 0.2278226
Validation loss decreased (0.162579 --> 0.162393).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 31 cost time: 1.0350885391235352
Epoch: 31, Steps: 64 | Train Loss: 0.1078449 Vali Loss: 0.1622372 Test Loss: 0.2280838
Validation loss decreased (0.162393 --> 0.162237).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 32 cost time: 1.0059993267059326
Epoch: 32, Steps: 64 | Train Loss: 0.1072809 Vali Loss: 0.1625776 Test Loss: 0.2285306
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 33 cost time: 1.013000726699829
Epoch: 33, Steps: 64 | Train Loss: 0.1075554 Vali Loss: 0.1607906 Test Loss: 0.2289529
Validation loss decreased (0.162237 --> 0.160791).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 34 cost time: 1.0099997520446777
Epoch: 34, Steps: 64 | Train Loss: 0.1078154 Vali Loss: 0.1625362 Test Loss: 0.2287364
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 35 cost time: 1.0040020942687988
Epoch: 35, Steps: 64 | Train Loss: 0.1075267 Vali Loss: 0.1605805 Test Loss: 0.2277121
Validation loss decreased (0.160791 --> 0.160581).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 36 cost time: 1.0089986324310303
Epoch: 36, Steps: 64 | Train Loss: 0.1070871 Vali Loss: 0.1615488 Test Loss: 0.2279389
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 37 cost time: 0.9679994583129883
Epoch: 37, Steps: 64 | Train Loss: 0.1071458 Vali Loss: 0.1617410 Test Loss: 0.2282443
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 38 cost time: 0.9600002765655518
Epoch: 38, Steps: 64 | Train Loss: 0.1068201 Vali Loss: 0.1623425 Test Loss: 0.2286011
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 39 cost time: 0.9889993667602539
Epoch: 39, Steps: 64 | Train Loss: 0.1074398 Vali Loss: 0.1611179 Test Loss: 0.2285356
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 40 cost time: 0.9530012607574463
Epoch: 40, Steps: 64 | Train Loss: 0.1070761 Vali Loss: 0.1610517 Test Loss: 0.2279933
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 41 cost time: 0.9800026416778564
Epoch: 41, Steps: 64 | Train Loss: 0.1071971 Vali Loss: 0.1612107 Test Loss: 0.2281455
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 42 cost time: 1.025996208190918
Epoch: 42, Steps: 64 | Train Loss: 0.1072746 Vali Loss: 0.1617751 Test Loss: 0.2289750
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 43 cost time: 0.9749982357025146
Epoch: 43, Steps: 64 | Train Loss: 0.1070956 Vali Loss: 0.1623397 Test Loss: 0.2288035
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 44 cost time: 0.9810001850128174
Epoch: 44, Steps: 64 | Train Loss: 0.1070786 Vali Loss: 0.1617249 Test Loss: 0.2285536
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 45 cost time: 0.9760017395019531
Epoch: 45, Steps: 64 | Train Loss: 0.1065411 Vali Loss: 0.1611067 Test Loss: 0.2288590
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 46 cost time: 1.000999927520752
Epoch: 46, Steps: 64 | Train Loss: 0.1069512 Vali Loss: 0.1640827 Test Loss: 0.2291435
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 47 cost time: 1.0050005912780762
Epoch: 47, Steps: 64 | Train Loss: 0.1067904 Vali Loss: 0.1609178 Test Loss: 0.2283270
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 48 cost time: 1.0120012760162354
Epoch: 48, Steps: 64 | Train Loss: 0.1071838 Vali Loss: 0.1614829 Test Loss: 0.2290186
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 49 cost time: 1.0046062469482422
Epoch: 49, Steps: 64 | Train Loss: 0.1068073 Vali Loss: 0.1619750 Test Loss: 0.2284275
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 50 cost time: 0.9890000820159912
Epoch: 50, Steps: 64 | Train Loss: 0.1066415 Vali Loss: 0.1605941 Test Loss: 0.2283609
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 51 cost time: 1.0139997005462646
Epoch: 51, Steps: 64 | Train Loss: 0.1069188 Vali Loss: 0.1611724 Test Loss: 0.2279519
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 52 cost time: 0.9759988784790039
Epoch: 52, Steps: 64 | Train Loss: 0.1069088 Vali Loss: 0.1626193 Test Loss: 0.2289005
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 53 cost time: 0.9809989929199219
Epoch: 53, Steps: 64 | Train Loss: 0.1072035 Vali Loss: 0.1614312 Test Loss: 0.2286168
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 54 cost time: 1.0000011920928955
Epoch: 54, Steps: 64 | Train Loss: 0.1070995 Vali Loss: 0.1627857 Test Loss: 0.2289098
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 55 cost time: 1.0229988098144531
Epoch: 55, Steps: 64 | Train Loss: 0.1067643 Vali Loss: 0.1615384 Test Loss: 0.2275942
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 56 cost time: 0.9489996433258057
Epoch: 56, Steps: 64 | Train Loss: 0.1070599 Vali Loss: 0.1625892 Test Loss: 0.2282152
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 57 cost time: 0.9679982662200928
Epoch: 57, Steps: 64 | Train Loss: 0.1067730 Vali Loss: 0.1618591 Test Loss: 0.2285025
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 58 cost time: 0.9920012950897217
Epoch: 58, Steps: 64 | Train Loss: 0.1067942 Vali Loss: 0.1621195 Test Loss: 0.2288937
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 59 cost time: 1.0410006046295166
Epoch: 59, Steps: 64 | Train Loss: 0.1068943 Vali Loss: 0.1624367 Test Loss: 0.2281660
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 60 cost time: 0.9909987449645996
Epoch: 60, Steps: 64 | Train Loss: 0.1065467 Vali Loss: 0.1607089 Test Loss: 0.2282942
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22771205008029938, mae:0.3394756317138672, rse:0.2418394535779953
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.045348167419433594 GB
Epoch: 1 cost time: 2.3409993648529053
Epoch: 1, Steps: 64 | Train Loss: 1.0820241 Vali Loss: 2.5192533 Test Loss: 3.9692812
Validation loss decreased (inf --> 2.519253).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 2 cost time: 0.9610011577606201
Epoch: 2, Steps: 64 | Train Loss: 0.7316678 Vali Loss: 0.7882177 Test Loss: 1.1267245
Validation loss decreased (2.519253 --> 0.788218).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 3 cost time: 0.9090008735656738
Epoch: 3, Steps: 64 | Train Loss: 0.3430685 Vali Loss: 0.3347413 Test Loss: 0.3842254
Validation loss decreased (0.788218 --> 0.334741).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 4 cost time: 0.9029998779296875
Epoch: 4, Steps: 64 | Train Loss: 0.2327486 Vali Loss: 0.2547708 Test Loss: 0.2936544
Validation loss decreased (0.334741 --> 0.254771).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 5 cost time: 0.9250011444091797
Epoch: 5, Steps: 64 | Train Loss: 0.1961345 Vali Loss: 0.2127636 Test Loss: 0.2589145
Validation loss decreased (0.254771 --> 0.212764).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 6 cost time: 0.9269993305206299
Epoch: 6, Steps: 64 | Train Loss: 0.1819255 Vali Loss: 0.2020371 Test Loss: 0.2460024
Validation loss decreased (0.212764 --> 0.202037).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 7 cost time: 0.9099981784820557
Epoch: 7, Steps: 64 | Train Loss: 0.1719139 Vali Loss: 0.1911297 Test Loss: 0.2392442
Validation loss decreased (0.202037 --> 0.191130).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 8 cost time: 0.8989982604980469
Epoch: 8, Steps: 64 | Train Loss: 0.1634190 Vali Loss: 0.1832531 Test Loss: 0.2343810
Validation loss decreased (0.191130 --> 0.183253).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 9 cost time: 0.9369997978210449
Epoch: 9, Steps: 64 | Train Loss: 0.1586607 Vali Loss: 0.1778490 Test Loss: 0.2310872
Validation loss decreased (0.183253 --> 0.177849).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 10 cost time: 0.94700026512146
Epoch: 10, Steps: 64 | Train Loss: 0.1543997 Vali Loss: 0.1768148 Test Loss: 0.2320550
Validation loss decreased (0.177849 --> 0.176815).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 11 cost time: 0.9800000190734863
Epoch: 11, Steps: 64 | Train Loss: 0.1505701 Vali Loss: 0.1739782 Test Loss: 0.2288487
Validation loss decreased (0.176815 --> 0.173978).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 12 cost time: 0.9850025177001953
Epoch: 12, Steps: 64 | Train Loss: 0.1480767 Vali Loss: 0.1731927 Test Loss: 0.2282800
Validation loss decreased (0.173978 --> 0.173193).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 13 cost time: 0.9930012226104736
Epoch: 13, Steps: 64 | Train Loss: 0.1455800 Vali Loss: 0.1709307 Test Loss: 0.2281758
Validation loss decreased (0.173193 --> 0.170931).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 14 cost time: 0.9740006923675537
Epoch: 14, Steps: 64 | Train Loss: 0.1438631 Vali Loss: 0.1695215 Test Loss: 0.2280683
Validation loss decreased (0.170931 --> 0.169521).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 15 cost time: 0.9840006828308105
Epoch: 15, Steps: 64 | Train Loss: 0.1410817 Vali Loss: 0.1691790 Test Loss: 0.2270452
Validation loss decreased (0.169521 --> 0.169179).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 16 cost time: 0.9729993343353271
Epoch: 16, Steps: 64 | Train Loss: 0.1404278 Vali Loss: 0.1689403 Test Loss: 0.2264042
Validation loss decreased (0.169179 --> 0.168940).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 17 cost time: 0.9230008125305176
Epoch: 17, Steps: 64 | Train Loss: 0.1387332 Vali Loss: 0.1671978 Test Loss: 0.2274786
Validation loss decreased (0.168940 --> 0.167198).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 18 cost time: 0.941619873046875
Epoch: 18, Steps: 64 | Train Loss: 0.1381877 Vali Loss: 0.1675602 Test Loss: 0.2284294
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 19 cost time: 0.9116692543029785
Epoch: 19, Steps: 64 | Train Loss: 0.1372400 Vali Loss: 0.1666101 Test Loss: 0.2273200
Validation loss decreased (0.167198 --> 0.166610).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 20 cost time: 0.9423809051513672
Epoch: 20, Steps: 64 | Train Loss: 0.1362128 Vali Loss: 0.1656143 Test Loss: 0.2275274
Validation loss decreased (0.166610 --> 0.165614).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 21 cost time: 0.9159162044525146
Epoch: 21, Steps: 64 | Train Loss: 0.1348119 Vali Loss: 0.1636520 Test Loss: 0.2254321
Validation loss decreased (0.165614 --> 0.163652).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 22 cost time: 0.9167742729187012
Epoch: 22, Steps: 64 | Train Loss: 0.1348863 Vali Loss: 0.1621061 Test Loss: 0.2254480
Validation loss decreased (0.163652 --> 0.162106).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 23 cost time: 0.8958299160003662
Epoch: 23, Steps: 64 | Train Loss: 0.1341916 Vali Loss: 0.1655829 Test Loss: 0.2260235
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 24 cost time: 0.8819980621337891
Epoch: 24, Steps: 64 | Train Loss: 0.1340944 Vali Loss: 0.1637328 Test Loss: 0.2266245
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 25 cost time: 0.9082136154174805
Epoch: 25, Steps: 64 | Train Loss: 0.1338718 Vali Loss: 0.1624755 Test Loss: 0.2251209
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 26 cost time: 0.8993997573852539
Epoch: 26, Steps: 64 | Train Loss: 0.1332156 Vali Loss: 0.1634675 Test Loss: 0.2264424
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 27 cost time: 0.9041786193847656
Epoch: 27, Steps: 64 | Train Loss: 0.1321210 Vali Loss: 0.1647742 Test Loss: 0.2258446
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 28 cost time: 0.9154577255249023
Epoch: 28, Steps: 64 | Train Loss: 0.1327481 Vali Loss: 0.1655378 Test Loss: 0.2262754
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 29 cost time: 0.9007742404937744
Epoch: 29, Steps: 64 | Train Loss: 0.1317932 Vali Loss: 0.1630485 Test Loss: 0.2255257
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 30 cost time: 0.9156255722045898
Epoch: 30, Steps: 64 | Train Loss: 0.1319111 Vali Loss: 0.1645691 Test Loss: 0.2292689
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 31 cost time: 0.9076297283172607
Epoch: 31, Steps: 64 | Train Loss: 0.1315380 Vali Loss: 0.1634601 Test Loss: 0.2252398
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 32 cost time: 0.9113750457763672
Epoch: 32, Steps: 64 | Train Loss: 0.1307504 Vali Loss: 0.1616069 Test Loss: 0.2271292
Validation loss decreased (0.162106 --> 0.161607).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 33 cost time: 0.9218289852142334
Epoch: 33, Steps: 64 | Train Loss: 0.1306101 Vali Loss: 0.1616758 Test Loss: 0.2248322
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 34 cost time: 0.9155621528625488
Epoch: 34, Steps: 64 | Train Loss: 0.1306924 Vali Loss: 0.1628518 Test Loss: 0.2265413
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 35 cost time: 0.9117422103881836
Epoch: 35, Steps: 64 | Train Loss: 0.1301911 Vali Loss: 0.1624019 Test Loss: 0.2269698
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 36 cost time: 0.9295628070831299
Epoch: 36, Steps: 64 | Train Loss: 0.1300076 Vali Loss: 0.1627241 Test Loss: 0.2258628
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 37 cost time: 0.9126324653625488
Epoch: 37, Steps: 64 | Train Loss: 0.1309069 Vali Loss: 0.1612679 Test Loss: 0.2255272
Validation loss decreased (0.161607 --> 0.161268).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 38 cost time: 0.9290924072265625
Epoch: 38, Steps: 64 | Train Loss: 0.1292432 Vali Loss: 0.1619733 Test Loss: 0.2252888
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 39 cost time: 0.9913754463195801
Epoch: 39, Steps: 64 | Train Loss: 0.1306910 Vali Loss: 0.1628509 Test Loss: 0.2262312
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 40 cost time: 0.9231390953063965
Epoch: 40, Steps: 64 | Train Loss: 0.1304683 Vali Loss: 0.1619498 Test Loss: 0.2251443
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 41 cost time: 0.9040029048919678
Epoch: 41, Steps: 64 | Train Loss: 0.1292939 Vali Loss: 0.1622781 Test Loss: 0.2262595
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 42 cost time: 0.8926095962524414
Epoch: 42, Steps: 64 | Train Loss: 0.1294504 Vali Loss: 0.1626057 Test Loss: 0.2266107
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 43 cost time: 0.9129996299743652
Epoch: 43, Steps: 64 | Train Loss: 0.1294145 Vali Loss: 0.1617975 Test Loss: 0.2252816
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 44 cost time: 0.9216687679290771
Epoch: 44, Steps: 64 | Train Loss: 0.1294284 Vali Loss: 0.1609804 Test Loss: 0.2270075
Validation loss decreased (0.161268 --> 0.160980).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 45 cost time: 0.9060201644897461
Epoch: 45, Steps: 64 | Train Loss: 0.1293971 Vali Loss: 0.1624252 Test Loss: 0.2252897
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 46 cost time: 0.9104564189910889
Epoch: 46, Steps: 64 | Train Loss: 0.1297565 Vali Loss: 0.1611849 Test Loss: 0.2255755
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 47 cost time: 0.8957006931304932
Epoch: 47, Steps: 64 | Train Loss: 0.1297063 Vali Loss: 0.1642196 Test Loss: 0.2283763
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 48 cost time: 0.8923835754394531
Epoch: 48, Steps: 64 | Train Loss: 0.1290287 Vali Loss: 0.1625663 Test Loss: 0.2248237
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 49 cost time: 0.9143800735473633
Epoch: 49, Steps: 64 | Train Loss: 0.1288888 Vali Loss: 0.1614200 Test Loss: 0.2264097
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 50 cost time: 0.9100003242492676
Epoch: 50, Steps: 64 | Train Loss: 0.1290615 Vali Loss: 0.1619092 Test Loss: 0.2264199
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 51 cost time: 0.9167706966400146
Epoch: 51, Steps: 64 | Train Loss: 0.1295739 Vali Loss: 0.1609274 Test Loss: 0.2257291
Validation loss decreased (0.160980 --> 0.160927).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 52 cost time: 0.9140045642852783
Epoch: 52, Steps: 64 | Train Loss: 0.1290140 Vali Loss: 0.1618980 Test Loss: 0.2272164
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 53 cost time: 0.9115724563598633
Epoch: 53, Steps: 64 | Train Loss: 0.1291940 Vali Loss: 0.1619579 Test Loss: 0.2269176
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 54 cost time: 0.9243862628936768
Epoch: 54, Steps: 64 | Train Loss: 0.1294569 Vali Loss: 0.1621831 Test Loss: 0.2255428
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 55 cost time: 0.9143807888031006
Epoch: 55, Steps: 64 | Train Loss: 0.1294905 Vali Loss: 0.1623071 Test Loss: 0.2255659
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 56 cost time: 0.9108099937438965
Epoch: 56, Steps: 64 | Train Loss: 0.1285624 Vali Loss: 0.1621827 Test Loss: 0.2253204
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 57 cost time: 0.9219989776611328
Epoch: 57, Steps: 64 | Train Loss: 0.1283942 Vali Loss: 0.1627215 Test Loss: 0.2257031
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 58 cost time: 0.9056248664855957
Epoch: 58, Steps: 64 | Train Loss: 0.1276334 Vali Loss: 0.1619144 Test Loss: 0.2268660
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 59 cost time: 0.9074690341949463
Epoch: 59, Steps: 64 | Train Loss: 0.1288921 Vali Loss: 0.1603655 Test Loss: 0.2246726
Validation loss decreased (0.160927 --> 0.160366).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 60 cost time: 0.9064254760742188
Epoch: 60, Steps: 64 | Train Loss: 0.1289919 Vali Loss: 0.1628730 Test Loss: 0.2267652
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2246725857257843, mae:0.3268386721611023, rse:0.24022002518177032
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04678010940551758 GB
Epoch: 1 cost time: 2.2907235622406006
Epoch: 1, Steps: 64 | Train Loss: 0.9466518 Vali Loss: 2.4508305 Test Loss: 3.9151523
Validation loss decreased (inf --> 2.450830).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 2 cost time: 0.9448158740997314
Epoch: 2, Steps: 64 | Train Loss: 0.5915372 Vali Loss: 0.7080772 Test Loss: 0.9759978
Validation loss decreased (2.450830 --> 0.708077).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 3 cost time: 0.9537534713745117
Epoch: 3, Steps: 64 | Train Loss: 0.2308819 Vali Loss: 0.2790852 Test Loss: 0.3033407
Validation loss decreased (0.708077 --> 0.279085).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 4 cost time: 0.9550018310546875
Epoch: 4, Steps: 64 | Train Loss: 0.1507620 Vali Loss: 0.2056901 Test Loss: 0.2360366
Validation loss decreased (0.279085 --> 0.205690).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 5 cost time: 0.9321672916412354
Epoch: 5, Steps: 64 | Train Loss: 0.1364148 Vali Loss: 0.1850857 Test Loss: 0.2261845
Validation loss decreased (0.205690 --> 0.185086).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 6 cost time: 0.9426264762878418
Epoch: 6, Steps: 64 | Train Loss: 0.1309250 Vali Loss: 0.1773981 Test Loss: 0.2227856
Validation loss decreased (0.185086 --> 0.177398).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 7 cost time: 0.9404237270355225
Epoch: 7, Steps: 64 | Train Loss: 0.1269183 Vali Loss: 0.1770428 Test Loss: 0.2230717
Validation loss decreased (0.177398 --> 0.177043).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 8 cost time: 0.940516471862793
Epoch: 8, Steps: 64 | Train Loss: 0.1235586 Vali Loss: 0.1728656 Test Loss: 0.2200466
Validation loss decreased (0.177043 --> 0.172866).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 9 cost time: 0.939070463180542
Epoch: 9, Steps: 64 | Train Loss: 0.1214679 Vali Loss: 0.1692391 Test Loss: 0.2199305
Validation loss decreased (0.172866 --> 0.169239).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 10 cost time: 0.9424111843109131
Epoch: 10, Steps: 64 | Train Loss: 0.1200413 Vali Loss: 0.1663762 Test Loss: 0.2190929
Validation loss decreased (0.169239 --> 0.166376).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 11 cost time: 0.951740026473999
Epoch: 11, Steps: 64 | Train Loss: 0.1183931 Vali Loss: 0.1682542 Test Loss: 0.2190756
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 12 cost time: 0.9477362632751465
Epoch: 12, Steps: 64 | Train Loss: 0.1171491 Vali Loss: 0.1652677 Test Loss: 0.2183498
Validation loss decreased (0.166376 --> 0.165268).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 13 cost time: 0.9504761695861816
Epoch: 13, Steps: 64 | Train Loss: 0.1162726 Vali Loss: 0.1650960 Test Loss: 0.2190539
Validation loss decreased (0.165268 --> 0.165096).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 14 cost time: 0.9496502876281738
Epoch: 14, Steps: 64 | Train Loss: 0.1150837 Vali Loss: 0.1655649 Test Loss: 0.2191101
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 15 cost time: 0.9404382705688477
Epoch: 15, Steps: 64 | Train Loss: 0.1145415 Vali Loss: 0.1640715 Test Loss: 0.2181049
Validation loss decreased (0.165096 --> 0.164072).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 16 cost time: 0.9284090995788574
Epoch: 16, Steps: 64 | Train Loss: 0.1134935 Vali Loss: 0.1637252 Test Loss: 0.2198244
Validation loss decreased (0.164072 --> 0.163725).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 17 cost time: 0.93300461769104
Epoch: 17, Steps: 64 | Train Loss: 0.1135710 Vali Loss: 0.1618435 Test Loss: 0.2178231
Validation loss decreased (0.163725 --> 0.161843).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 18 cost time: 0.9433395862579346
Epoch: 18, Steps: 64 | Train Loss: 0.1127085 Vali Loss: 0.1621793 Test Loss: 0.2185470
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 19 cost time: 0.9367470741271973
Epoch: 19, Steps: 64 | Train Loss: 0.1127642 Vali Loss: 0.1628984 Test Loss: 0.2186830
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 20 cost time: 0.9335947036743164
Epoch: 20, Steps: 64 | Train Loss: 0.1119953 Vali Loss: 0.1627146 Test Loss: 0.2202485
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 21 cost time: 0.9429998397827148
Epoch: 21, Steps: 64 | Train Loss: 0.1120235 Vali Loss: 0.1628658 Test Loss: 0.2200255
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 22 cost time: 0.9356338977813721
Epoch: 22, Steps: 64 | Train Loss: 0.1113699 Vali Loss: 0.1617072 Test Loss: 0.2191497
Validation loss decreased (0.161843 --> 0.161707).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 23 cost time: 0.9344120025634766
Epoch: 23, Steps: 64 | Train Loss: 0.1112170 Vali Loss: 0.1618108 Test Loss: 0.2206612
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 24 cost time: 0.9342508316040039
Epoch: 24, Steps: 64 | Train Loss: 0.1112768 Vali Loss: 0.1612840 Test Loss: 0.2195351
Validation loss decreased (0.161707 --> 0.161284).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 25 cost time: 0.9382288455963135
Epoch: 25, Steps: 64 | Train Loss: 0.1107873 Vali Loss: 0.1603602 Test Loss: 0.2201900
Validation loss decreased (0.161284 --> 0.160360).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 26 cost time: 0.9330687522888184
Epoch: 26, Steps: 64 | Train Loss: 0.1102696 Vali Loss: 0.1604661 Test Loss: 0.2198963
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 27 cost time: 0.9324295520782471
Epoch: 27, Steps: 64 | Train Loss: 0.1106537 Vali Loss: 0.1606348 Test Loss: 0.2194175
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 28 cost time: 0.9439337253570557
Epoch: 28, Steps: 64 | Train Loss: 0.1100675 Vali Loss: 0.1589366 Test Loss: 0.2189434
Validation loss decreased (0.160360 --> 0.158937).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 29 cost time: 0.9406063556671143
Epoch: 29, Steps: 64 | Train Loss: 0.1094524 Vali Loss: 0.1586647 Test Loss: 0.2180871
Validation loss decreased (0.158937 --> 0.158665).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 30 cost time: 0.9342446327209473
Epoch: 30, Steps: 64 | Train Loss: 0.1099241 Vali Loss: 0.1608743 Test Loss: 0.2194406
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 31 cost time: 0.9363374710083008
Epoch: 31, Steps: 64 | Train Loss: 0.1099091 Vali Loss: 0.1605841 Test Loss: 0.2198422
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 32 cost time: 0.9468882083892822
Epoch: 32, Steps: 64 | Train Loss: 0.1094859 Vali Loss: 0.1616007 Test Loss: 0.2193252
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 33 cost time: 0.9539761543273926
Epoch: 33, Steps: 64 | Train Loss: 0.1093810 Vali Loss: 0.1604980 Test Loss: 0.2186635
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 34 cost time: 0.9494447708129883
Epoch: 34, Steps: 64 | Train Loss: 0.1092050 Vali Loss: 0.1589167 Test Loss: 0.2192231
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 35 cost time: 0.9578206539154053
Epoch: 35, Steps: 64 | Train Loss: 0.1090951 Vali Loss: 0.1605057 Test Loss: 0.2190715
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 36 cost time: 0.9579999446868896
Epoch: 36, Steps: 64 | Train Loss: 0.1090314 Vali Loss: 0.1597744 Test Loss: 0.2198910
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 37 cost time: 0.9629998207092285
Epoch: 37, Steps: 64 | Train Loss: 0.1088713 Vali Loss: 0.1589196 Test Loss: 0.2197788
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 38 cost time: 0.9704897403717041
Epoch: 38, Steps: 64 | Train Loss: 0.1087585 Vali Loss: 0.1601496 Test Loss: 0.2204180
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 39 cost time: 0.9573566913604736
Epoch: 39, Steps: 64 | Train Loss: 0.1089735 Vali Loss: 0.1571079 Test Loss: 0.2200089
Validation loss decreased (0.158665 --> 0.157108).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 40 cost time: 0.9573242664337158
Epoch: 40, Steps: 64 | Train Loss: 0.1089848 Vali Loss: 0.1580359 Test Loss: 0.2197827
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 41 cost time: 0.947502613067627
Epoch: 41, Steps: 64 | Train Loss: 0.1088074 Vali Loss: 0.1583523 Test Loss: 0.2191402
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 42 cost time: 0.939063549041748
Epoch: 42, Steps: 64 | Train Loss: 0.1087419 Vali Loss: 0.1602259 Test Loss: 0.2195847
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 43 cost time: 0.9484620094299316
Epoch: 43, Steps: 64 | Train Loss: 0.1084810 Vali Loss: 0.1596629 Test Loss: 0.2197889
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 44 cost time: 0.9481747150421143
Epoch: 44, Steps: 64 | Train Loss: 0.1087430 Vali Loss: 0.1599597 Test Loss: 0.2183179
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 45 cost time: 0.9510002136230469
Epoch: 45, Steps: 64 | Train Loss: 0.1085281 Vali Loss: 0.1577623 Test Loss: 0.2200809
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 46 cost time: 0.9227745532989502
Epoch: 46, Steps: 64 | Train Loss: 0.1089371 Vali Loss: 0.1569808 Test Loss: 0.2180120
Validation loss decreased (0.157108 --> 0.156981).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 47 cost time: 0.9356155395507812
Epoch: 47, Steps: 64 | Train Loss: 0.1087291 Vali Loss: 0.1593245 Test Loss: 0.2192398
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 48 cost time: 0.9363644123077393
Epoch: 48, Steps: 64 | Train Loss: 0.1085105 Vali Loss: 0.1571792 Test Loss: 0.2193386
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 49 cost time: 0.9065456390380859
Epoch: 49, Steps: 64 | Train Loss: 0.1081152 Vali Loss: 0.1598808 Test Loss: 0.2201156
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 50 cost time: 0.9309630393981934
Epoch: 50, Steps: 64 | Train Loss: 0.1087626 Vali Loss: 0.1579943 Test Loss: 0.2198711
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 51 cost time: 0.9364705085754395
Epoch: 51, Steps: 64 | Train Loss: 0.1090088 Vali Loss: 0.1602909 Test Loss: 0.2199052
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 52 cost time: 0.9529306888580322
Epoch: 52, Steps: 64 | Train Loss: 0.1084819 Vali Loss: 0.1585317 Test Loss: 0.2199116
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 53 cost time: 0.9496164321899414
Epoch: 53, Steps: 64 | Train Loss: 0.1080733 Vali Loss: 0.1580168 Test Loss: 0.2184726
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 54 cost time: 0.9586069583892822
Epoch: 54, Steps: 64 | Train Loss: 0.1087388 Vali Loss: 0.1599192 Test Loss: 0.2187082
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 55 cost time: 0.9587438106536865
Epoch: 55, Steps: 64 | Train Loss: 0.1084341 Vali Loss: 0.1588687 Test Loss: 0.2187362
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 56 cost time: 0.9654347896575928
Epoch: 56, Steps: 64 | Train Loss: 0.1082567 Vali Loss: 0.1581467 Test Loss: 0.2181998
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 57 cost time: 0.9563970565795898
Epoch: 57, Steps: 64 | Train Loss: 0.1086933 Vali Loss: 0.1584491 Test Loss: 0.2181068
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 58 cost time: 0.9533562660217285
Epoch: 58, Steps: 64 | Train Loss: 0.1083961 Vali Loss: 0.1570158 Test Loss: 0.2191028
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 59 cost time: 0.9583523273468018
Epoch: 59, Steps: 64 | Train Loss: 0.1082806 Vali Loss: 0.1586744 Test Loss: 0.2185547
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 60 cost time: 0.945763349533081
Epoch: 60, Steps: 64 | Train Loss: 0.1086047 Vali Loss: 0.1598479 Test Loss: 0.2192165
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.21801194548606873, mae:0.31704142689704895, rse:0.23663245141506195
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04790019989013672 GB
Epoch: 1 cost time: 2.314206123352051
Epoch: 1, Steps: 64 | Train Loss: 0.8744355 Vali Loss: 2.3540585 Test Loss: 3.7529650
Validation loss decreased (inf --> 2.354059).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 2 cost time: 0.9676077365875244
Epoch: 2, Steps: 64 | Train Loss: 0.5892887 Vali Loss: 0.7191713 Test Loss: 1.0276104
Validation loss decreased (2.354059 --> 0.719171).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 3 cost time: 0.9666218757629395
Epoch: 3, Steps: 64 | Train Loss: 0.2089799 Vali Loss: 0.2280261 Test Loss: 0.2562491
Validation loss decreased (0.719171 --> 0.228026).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 4 cost time: 0.9648404121398926
Epoch: 4, Steps: 64 | Train Loss: 0.1351493 Vali Loss: 0.1893891 Test Loss: 0.2353347
Validation loss decreased (0.228026 --> 0.189389).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 5 cost time: 0.9754593372344971
Epoch: 5, Steps: 64 | Train Loss: 0.1258355 Vali Loss: 0.1786418 Test Loss: 0.2242192
Validation loss decreased (0.189389 --> 0.178642).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 6 cost time: 0.9636194705963135
Epoch: 6, Steps: 64 | Train Loss: 0.1208546 Vali Loss: 0.1722522 Test Loss: 0.2232148
Validation loss decreased (0.178642 --> 0.172252).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 7 cost time: 0.9644351005554199
Epoch: 7, Steps: 64 | Train Loss: 0.1182110 Vali Loss: 0.1714887 Test Loss: 0.2224216
Validation loss decreased (0.172252 --> 0.171489).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 8 cost time: 0.9743862152099609
Epoch: 8, Steps: 64 | Train Loss: 0.1158753 Vali Loss: 0.1672712 Test Loss: 0.2213131
Validation loss decreased (0.171489 --> 0.167271).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 9 cost time: 0.9562675952911377
Epoch: 9, Steps: 64 | Train Loss: 0.1141707 Vali Loss: 0.1669935 Test Loss: 0.2211290
Validation loss decreased (0.167271 --> 0.166994).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 10 cost time: 0.97884202003479
Epoch: 10, Steps: 64 | Train Loss: 0.1122841 Vali Loss: 0.1634822 Test Loss: 0.2205392
Validation loss decreased (0.166994 --> 0.163482).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 11 cost time: 0.9768168926239014
Epoch: 11, Steps: 64 | Train Loss: 0.1116734 Vali Loss: 0.1645450 Test Loss: 0.2210381
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 12 cost time: 0.998002290725708
Epoch: 12, Steps: 64 | Train Loss: 0.1111323 Vali Loss: 0.1622899 Test Loss: 0.2212414
Validation loss decreased (0.163482 --> 0.162290).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 13 cost time: 0.9776461124420166
Epoch: 13, Steps: 64 | Train Loss: 0.1102372 Vali Loss: 0.1619622 Test Loss: 0.2207254
Validation loss decreased (0.162290 --> 0.161962).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 14 cost time: 0.9776337146759033
Epoch: 14, Steps: 64 | Train Loss: 0.1092932 Vali Loss: 0.1604737 Test Loss: 0.2214120
Validation loss decreased (0.161962 --> 0.160474).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 15 cost time: 0.9853920936584473
Epoch: 15, Steps: 64 | Train Loss: 0.1090141 Vali Loss: 0.1614563 Test Loss: 0.2221326
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 16 cost time: 0.9643704891204834
Epoch: 16, Steps: 64 | Train Loss: 0.1087024 Vali Loss: 0.1592766 Test Loss: 0.2204965
Validation loss decreased (0.160474 --> 0.159277).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 17 cost time: 0.9647707939147949
Epoch: 17, Steps: 64 | Train Loss: 0.1081266 Vali Loss: 0.1598418 Test Loss: 0.2196863
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 18 cost time: 0.9654347896575928
Epoch: 18, Steps: 64 | Train Loss: 0.1072641 Vali Loss: 0.1602901 Test Loss: 0.2206096
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 19 cost time: 0.9810342788696289
Epoch: 19, Steps: 64 | Train Loss: 0.1072372 Vali Loss: 0.1586197 Test Loss: 0.2214630
Validation loss decreased (0.159277 --> 0.158620).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 20 cost time: 0.9716672897338867
Epoch: 20, Steps: 64 | Train Loss: 0.1074212 Vali Loss: 0.1586458 Test Loss: 0.2227319
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 21 cost time: 0.967822790145874
Epoch: 21, Steps: 64 | Train Loss: 0.1068890 Vali Loss: 0.1580830 Test Loss: 0.2208255
Validation loss decreased (0.158620 --> 0.158083).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 22 cost time: 0.9672763347625732
Epoch: 22, Steps: 64 | Train Loss: 0.1065657 Vali Loss: 0.1582385 Test Loss: 0.2218060
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 23 cost time: 0.9625139236450195
Epoch: 23, Steps: 64 | Train Loss: 0.1064547 Vali Loss: 0.1585394 Test Loss: 0.2207366
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 24 cost time: 0.9596431255340576
Epoch: 24, Steps: 64 | Train Loss: 0.1067325 Vali Loss: 0.1569898 Test Loss: 0.2205765
Validation loss decreased (0.158083 --> 0.156990).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 25 cost time: 0.9631600379943848
Epoch: 25, Steps: 64 | Train Loss: 0.1062620 Vali Loss: 0.1570418 Test Loss: 0.2203883
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 26 cost time: 0.9593555927276611
Epoch: 26, Steps: 64 | Train Loss: 0.1058372 Vali Loss: 0.1568765 Test Loss: 0.2224819
Validation loss decreased (0.156990 --> 0.156877).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 27 cost time: 0.9693493843078613
Epoch: 27, Steps: 64 | Train Loss: 0.1059836 Vali Loss: 0.1571552 Test Loss: 0.2207924
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 28 cost time: 0.9603848457336426
Epoch: 28, Steps: 64 | Train Loss: 0.1055668 Vali Loss: 0.1571601 Test Loss: 0.2218561
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 29 cost time: 0.9617831707000732
Epoch: 29, Steps: 64 | Train Loss: 0.1047166 Vali Loss: 0.1558932 Test Loss: 0.2215358
Validation loss decreased (0.156877 --> 0.155893).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 30 cost time: 0.9703373908996582
Epoch: 30, Steps: 64 | Train Loss: 0.1056969 Vali Loss: 0.1565438 Test Loss: 0.2203373
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 31 cost time: 0.9667942523956299
Epoch: 31, Steps: 64 | Train Loss: 0.1049901 Vali Loss: 0.1569442 Test Loss: 0.2217485
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 32 cost time: 0.9749999046325684
Epoch: 32, Steps: 64 | Train Loss: 0.1056049 Vali Loss: 0.1552022 Test Loss: 0.2205779
Validation loss decreased (0.155893 --> 0.155202).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 33 cost time: 0.9646544456481934
Epoch: 33, Steps: 64 | Train Loss: 0.1054299 Vali Loss: 0.1561354 Test Loss: 0.2224272
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 34 cost time: 0.9637370109558105
Epoch: 34, Steps: 64 | Train Loss: 0.1048346 Vali Loss: 0.1549952 Test Loss: 0.2208974
Validation loss decreased (0.155202 --> 0.154995).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 35 cost time: 0.9784266948699951
Epoch: 35, Steps: 64 | Train Loss: 0.1047268 Vali Loss: 0.1563445 Test Loss: 0.2209360
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 36 cost time: 0.9700453281402588
Epoch: 36, Steps: 64 | Train Loss: 0.1049087 Vali Loss: 0.1573017 Test Loss: 0.2218177
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 37 cost time: 0.9683911800384521
Epoch: 37, Steps: 64 | Train Loss: 0.1047984 Vali Loss: 0.1567720 Test Loss: 0.2215992
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 38 cost time: 0.9637563228607178
Epoch: 38, Steps: 64 | Train Loss: 0.1048124 Vali Loss: 0.1548498 Test Loss: 0.2207852
Validation loss decreased (0.154995 --> 0.154850).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 39 cost time: 0.9543757438659668
Epoch: 39, Steps: 64 | Train Loss: 0.1050678 Vali Loss: 0.1556924 Test Loss: 0.2215218
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 40 cost time: 0.9523828029632568
Epoch: 40, Steps: 64 | Train Loss: 0.1042356 Vali Loss: 0.1558525 Test Loss: 0.2213904
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 41 cost time: 0.9580023288726807
Epoch: 41, Steps: 64 | Train Loss: 0.1046497 Vali Loss: 0.1561427 Test Loss: 0.2204133
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 42 cost time: 0.9423458576202393
Epoch: 42, Steps: 64 | Train Loss: 0.1047923 Vali Loss: 0.1559425 Test Loss: 0.2220997
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 43 cost time: 0.9546282291412354
Epoch: 43, Steps: 64 | Train Loss: 0.1044477 Vali Loss: 0.1545492 Test Loss: 0.2216056
Validation loss decreased (0.154850 --> 0.154549).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 44 cost time: 0.9683756828308105
Epoch: 44, Steps: 64 | Train Loss: 0.1039915 Vali Loss: 0.1542552 Test Loss: 0.2225243
Validation loss decreased (0.154549 --> 0.154255).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 45 cost time: 0.9755189418792725
Epoch: 45, Steps: 64 | Train Loss: 0.1048983 Vali Loss: 0.1538770 Test Loss: 0.2207702
Validation loss decreased (0.154255 --> 0.153877).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 46 cost time: 0.9491939544677734
Epoch: 46, Steps: 64 | Train Loss: 0.1048534 Vali Loss: 0.1544455 Test Loss: 0.2214815
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 47 cost time: 0.9630405902862549
Epoch: 47, Steps: 64 | Train Loss: 0.1049701 Vali Loss: 0.1540274 Test Loss: 0.2215209
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 48 cost time: 0.9614598751068115
Epoch: 48, Steps: 64 | Train Loss: 0.1042665 Vali Loss: 0.1552078 Test Loss: 0.2209698
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 49 cost time: 0.9747247695922852
Epoch: 49, Steps: 64 | Train Loss: 0.1039193 Vali Loss: 0.1557006 Test Loss: 0.2216737
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 50 cost time: 0.9599997997283936
Epoch: 50, Steps: 64 | Train Loss: 0.1045330 Vali Loss: 0.1560507 Test Loss: 0.2220024
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 51 cost time: 0.9642188549041748
Epoch: 51, Steps: 64 | Train Loss: 0.1045001 Vali Loss: 0.1551102 Test Loss: 0.2228211
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 52 cost time: 0.9757874011993408
Epoch: 52, Steps: 64 | Train Loss: 0.1048953 Vali Loss: 0.1551574 Test Loss: 0.2220230
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 53 cost time: 0.9623861312866211
Epoch: 53, Steps: 64 | Train Loss: 0.1050710 Vali Loss: 0.1550375 Test Loss: 0.2221442
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 54 cost time: 0.9674787521362305
Epoch: 54, Steps: 64 | Train Loss: 0.1045231 Vali Loss: 0.1553206 Test Loss: 0.2221895
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 55 cost time: 0.9770879745483398
Epoch: 55, Steps: 64 | Train Loss: 0.1045901 Vali Loss: 0.1546438 Test Loss: 0.2219627
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 56 cost time: 0.9643926620483398
Epoch: 56, Steps: 64 | Train Loss: 0.1048198 Vali Loss: 0.1551756 Test Loss: 0.2205047
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 57 cost time: 0.9603781700134277
Epoch: 57, Steps: 64 | Train Loss: 0.1045601 Vali Loss: 0.1537714 Test Loss: 0.2206038
Validation loss decreased (0.153877 --> 0.153771).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 58 cost time: 0.9637324810028076
Epoch: 58, Steps: 64 | Train Loss: 0.1043614 Vali Loss: 0.1538209 Test Loss: 0.2212524
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 59 cost time: 0.9638576507568359
Epoch: 59, Steps: 64 | Train Loss: 0.1041985 Vali Loss: 0.1555622 Test Loss: 0.2214719
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 60 cost time: 0.9555778503417969
Epoch: 60, Steps: 64 | Train Loss: 0.1045848 Vali Loss: 0.1560137 Test Loss: 0.2210256
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22060386836528778, mae:0.3201536536216736, rse:0.2380349338054657
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.045510292053222656 GB
Epoch: 1 cost time: 2.260218381881714
Epoch: 1, Steps: 64 | Train Loss: 1.1861962 Vali Loss: 2.8168616 Test Loss: 4.5251966
Validation loss decreased (inf --> 2.816862).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 2 cost time: 0.9324321746826172
Epoch: 2, Steps: 64 | Train Loss: 0.7842282 Vali Loss: 0.9363209 Test Loss: 1.4098238
Validation loss decreased (2.816862 --> 0.936321).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 3 cost time: 0.9224538803100586
Epoch: 3, Steps: 64 | Train Loss: 0.3852819 Vali Loss: 0.4579548 Test Loss: 0.6080917
Validation loss decreased (0.936321 --> 0.457955).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 4 cost time: 0.9214198589324951
Epoch: 4, Steps: 64 | Train Loss: 0.2522426 Vali Loss: 0.2880207 Test Loss: 0.3591369
Validation loss decreased (0.457955 --> 0.288021).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 5 cost time: 0.9269685745239258
Epoch: 5, Steps: 64 | Train Loss: 0.2027924 Vali Loss: 0.2283548 Test Loss: 0.2754700
Validation loss decreased (0.288021 --> 0.228355).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 6 cost time: 0.9077320098876953
Epoch: 6, Steps: 64 | Train Loss: 0.1811705 Vali Loss: 0.2069660 Test Loss: 0.2483950
Validation loss decreased (0.228355 --> 0.206966).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 7 cost time: 0.9190001487731934
Epoch: 7, Steps: 64 | Train Loss: 0.1700336 Vali Loss: 0.1947611 Test Loss: 0.2372599
Validation loss decreased (0.206966 --> 0.194761).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 8 cost time: 0.9076206684112549
Epoch: 8, Steps: 64 | Train Loss: 0.1628162 Vali Loss: 0.1876294 Test Loss: 0.2302261
Validation loss decreased (0.194761 --> 0.187629).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 9 cost time: 0.9275212287902832
Epoch: 9, Steps: 64 | Train Loss: 0.1582417 Vali Loss: 0.1848804 Test Loss: 0.2272801
Validation loss decreased (0.187629 --> 0.184880).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 10 cost time: 0.9224684238433838
Epoch: 10, Steps: 64 | Train Loss: 0.1538227 Vali Loss: 0.1807631 Test Loss: 0.2243978
Validation loss decreased (0.184880 --> 0.180763).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 11 cost time: 0.9261844158172607
Epoch: 11, Steps: 64 | Train Loss: 0.1500795 Vali Loss: 0.1764194 Test Loss: 0.2230601
Validation loss decreased (0.180763 --> 0.176419).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 12 cost time: 0.921422004699707
Epoch: 12, Steps: 64 | Train Loss: 0.1477896 Vali Loss: 0.1774003 Test Loss: 0.2223526
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 13 cost time: 0.9273977279663086
Epoch: 13, Steps: 64 | Train Loss: 0.1460901 Vali Loss: 0.1747627 Test Loss: 0.2216118
Validation loss decreased (0.176419 --> 0.174763).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 14 cost time: 0.9199986457824707
Epoch: 14, Steps: 64 | Train Loss: 0.1435510 Vali Loss: 0.1721740 Test Loss: 0.2203287
Validation loss decreased (0.174763 --> 0.172174).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 15 cost time: 0.9220013618469238
Epoch: 15, Steps: 64 | Train Loss: 0.1425093 Vali Loss: 0.1732956 Test Loss: 0.2210019
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 16 cost time: 0.9326047897338867
Epoch: 16, Steps: 64 | Train Loss: 0.1410300 Vali Loss: 0.1713276 Test Loss: 0.2205788
Validation loss decreased (0.172174 --> 0.171328).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 17 cost time: 0.9212629795074463
Epoch: 17, Steps: 64 | Train Loss: 0.1403568 Vali Loss: 0.1701158 Test Loss: 0.2207233
Validation loss decreased (0.171328 --> 0.170116).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 18 cost time: 0.9074387550354004
Epoch: 18, Steps: 64 | Train Loss: 0.1385152 Vali Loss: 0.1706974 Test Loss: 0.2216688
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 19 cost time: 0.9154255390167236
Epoch: 19, Steps: 64 | Train Loss: 0.1377487 Vali Loss: 0.1687973 Test Loss: 0.2203125
Validation loss decreased (0.170116 --> 0.168797).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 20 cost time: 0.9137523174285889
Epoch: 20, Steps: 64 | Train Loss: 0.1370850 Vali Loss: 0.1686732 Test Loss: 0.2200488
Validation loss decreased (0.168797 --> 0.168673).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 21 cost time: 0.9089996814727783
Epoch: 21, Steps: 64 | Train Loss: 0.1366528 Vali Loss: 0.1687421 Test Loss: 0.2202958
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 22 cost time: 0.911632776260376
Epoch: 22, Steps: 64 | Train Loss: 0.1362313 Vali Loss: 0.1671088 Test Loss: 0.2193890
Validation loss decreased (0.168673 --> 0.167109).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 23 cost time: 0.9056267738342285
Epoch: 23, Steps: 64 | Train Loss: 0.1349916 Vali Loss: 0.1688381 Test Loss: 0.2205924
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 24 cost time: 0.9074177742004395
Epoch: 24, Steps: 64 | Train Loss: 0.1352881 Vali Loss: 0.1682323 Test Loss: 0.2199324
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 25 cost time: 0.913419246673584
Epoch: 25, Steps: 64 | Train Loss: 0.1344432 Vali Loss: 0.1680716 Test Loss: 0.2210350
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 26 cost time: 0.9090251922607422
Epoch: 26, Steps: 64 | Train Loss: 0.1343078 Vali Loss: 0.1666645 Test Loss: 0.2194858
Validation loss decreased (0.167109 --> 0.166664).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 27 cost time: 0.8957874774932861
Epoch: 27, Steps: 64 | Train Loss: 0.1341282 Vali Loss: 0.1672226 Test Loss: 0.2197824
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 28 cost time: 0.9120001792907715
Epoch: 28, Steps: 64 | Train Loss: 0.1335036 Vali Loss: 0.1670325 Test Loss: 0.2192481
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 29 cost time: 0.9206271171569824
Epoch: 29, Steps: 64 | Train Loss: 0.1323888 Vali Loss: 0.1662810 Test Loss: 0.2200815
Validation loss decreased (0.166664 --> 0.166281).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 30 cost time: 0.9152092933654785
Epoch: 30, Steps: 64 | Train Loss: 0.1325565 Vali Loss: 0.1661688 Test Loss: 0.2197981
Validation loss decreased (0.166281 --> 0.166169).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 31 cost time: 0.8973674774169922
Epoch: 31, Steps: 64 | Train Loss: 0.1329988 Vali Loss: 0.1668903 Test Loss: 0.2192791
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 32 cost time: 0.9113774299621582
Epoch: 32, Steps: 64 | Train Loss: 0.1327011 Vali Loss: 0.1657504 Test Loss: 0.2198821
Validation loss decreased (0.166169 --> 0.165750).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 33 cost time: 0.9024002552032471
Epoch: 33, Steps: 64 | Train Loss: 0.1315647 Vali Loss: 0.1664110 Test Loss: 0.2188414
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 34 cost time: 0.9157454967498779
Epoch: 34, Steps: 64 | Train Loss: 0.1322287 Vali Loss: 0.1644505 Test Loss: 0.2195647
Validation loss decreased (0.165750 --> 0.164450).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 35 cost time: 0.906609296798706
Epoch: 35, Steps: 64 | Train Loss: 0.1311197 Vali Loss: 0.1638805 Test Loss: 0.2195694
Validation loss decreased (0.164450 --> 0.163880).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 36 cost time: 0.9056122303009033
Epoch: 36, Steps: 64 | Train Loss: 0.1313795 Vali Loss: 0.1659771 Test Loss: 0.2188334
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 37 cost time: 0.9283878803253174
Epoch: 37, Steps: 64 | Train Loss: 0.1316994 Vali Loss: 0.1653422 Test Loss: 0.2194517
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 38 cost time: 0.9114205837249756
Epoch: 38, Steps: 64 | Train Loss: 0.1312073 Vali Loss: 0.1680623 Test Loss: 0.2198882
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 39 cost time: 0.913377046585083
Epoch: 39, Steps: 64 | Train Loss: 0.1307697 Vali Loss: 0.1657774 Test Loss: 0.2194545
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 40 cost time: 0.913377046585083
Epoch: 40, Steps: 64 | Train Loss: 0.1315080 Vali Loss: 0.1653856 Test Loss: 0.2191382
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 41 cost time: 0.9117336273193359
Epoch: 41, Steps: 64 | Train Loss: 0.1314670 Vali Loss: 0.1654214 Test Loss: 0.2192006
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 42 cost time: 0.9104187488555908
Epoch: 42, Steps: 64 | Train Loss: 0.1314766 Vali Loss: 0.1649809 Test Loss: 0.2193731
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 43 cost time: 0.9080078601837158
Epoch: 43, Steps: 64 | Train Loss: 0.1306261 Vali Loss: 0.1671273 Test Loss: 0.2195500
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 44 cost time: 0.9133472442626953
Epoch: 44, Steps: 64 | Train Loss: 0.1308522 Vali Loss: 0.1651550 Test Loss: 0.2185982
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 45 cost time: 0.9064064025878906
Epoch: 45, Steps: 64 | Train Loss: 0.1305682 Vali Loss: 0.1658377 Test Loss: 0.2200396
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 46 cost time: 0.906381368637085
Epoch: 46, Steps: 64 | Train Loss: 0.1310808 Vali Loss: 0.1629911 Test Loss: 0.2185948
Validation loss decreased (0.163880 --> 0.162991).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 47 cost time: 0.9088020324707031
Epoch: 47, Steps: 64 | Train Loss: 0.1306658 Vali Loss: 0.1654943 Test Loss: 0.2191980
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 48 cost time: 0.9086403846740723
Epoch: 48, Steps: 64 | Train Loss: 0.1302574 Vali Loss: 0.1654239 Test Loss: 0.2190396
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 49 cost time: 0.9130010604858398
Epoch: 49, Steps: 64 | Train Loss: 0.1296998 Vali Loss: 0.1655048 Test Loss: 0.2191705
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 50 cost time: 0.907630205154419
Epoch: 50, Steps: 64 | Train Loss: 0.1304917 Vali Loss: 0.1655814 Test Loss: 0.2190469
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 51 cost time: 0.9074769020080566
Epoch: 51, Steps: 64 | Train Loss: 0.1303217 Vali Loss: 0.1648514 Test Loss: 0.2197686
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 52 cost time: 0.9063458442687988
Epoch: 52, Steps: 64 | Train Loss: 0.1298897 Vali Loss: 0.1666116 Test Loss: 0.2200814
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 53 cost time: 0.9272422790527344
Epoch: 53, Steps: 64 | Train Loss: 0.1309121 Vali Loss: 0.1648609 Test Loss: 0.2189219
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 54 cost time: 0.9278593063354492
Epoch: 54, Steps: 64 | Train Loss: 0.1302902 Vali Loss: 0.1638799 Test Loss: 0.2190473
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 55 cost time: 0.932999849319458
Epoch: 55, Steps: 64 | Train Loss: 0.1303375 Vali Loss: 0.1663599 Test Loss: 0.2195640
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 56 cost time: 0.9220612049102783
Epoch: 56, Steps: 64 | Train Loss: 0.1301322 Vali Loss: 0.1656111 Test Loss: 0.2193252
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 57 cost time: 0.9223885536193848
Epoch: 57, Steps: 64 | Train Loss: 0.1297363 Vali Loss: 0.1651768 Test Loss: 0.2187456
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 58 cost time: 0.9358687400817871
Epoch: 58, Steps: 64 | Train Loss: 0.1300160 Vali Loss: 0.1662937 Test Loss: 0.2200634
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 59 cost time: 0.9224433898925781
Epoch: 59, Steps: 64 | Train Loss: 0.1304226 Vali Loss: 0.1658030 Test Loss: 0.2196467
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 60 cost time: 0.9144105911254883
Epoch: 60, Steps: 64 | Train Loss: 0.1301096 Vali Loss: 0.1654971 Test Loss: 0.2190553
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.21859480440616608, mae:0.31988784670829773, rse:0.23694854974746704
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04694223403930664 GB
Epoch: 1 cost time: 2.2959494590759277
Epoch: 1, Steps: 64 | Train Loss: 0.9875808 Vali Loss: 2.5553551 Test Loss: 4.0798278
Validation loss decreased (inf --> 2.555355).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 2 cost time: 0.8556547164916992
Epoch: 2, Steps: 64 | Train Loss: 0.5900490 Vali Loss: 0.6052902 Test Loss: 0.8448793
Validation loss decreased (2.555355 --> 0.605290).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 3 cost time: 0.8866329193115234
Epoch: 3, Steps: 64 | Train Loss: 0.2022971 Vali Loss: 0.2139417 Test Loss: 0.2508386
Validation loss decreased (0.605290 --> 0.213942).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 4 cost time: 0.8882794380187988
Epoch: 4, Steps: 64 | Train Loss: 0.1447652 Vali Loss: 0.1875333 Test Loss: 0.2347765
Validation loss decreased (0.213942 --> 0.187533).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 5 cost time: 0.8933990001678467
Epoch: 5, Steps: 64 | Train Loss: 0.1342583 Vali Loss: 0.1821477 Test Loss: 0.2319770
Validation loss decreased (0.187533 --> 0.182148).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 6 cost time: 0.8734030723571777
Epoch: 6, Steps: 64 | Train Loss: 0.1281067 Vali Loss: 0.1763223 Test Loss: 0.2293872
Validation loss decreased (0.182148 --> 0.176322).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 7 cost time: 0.8827328681945801
Epoch: 7, Steps: 64 | Train Loss: 0.1244955 Vali Loss: 0.1715464 Test Loss: 0.2264929
Validation loss decreased (0.176322 --> 0.171546).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 8 cost time: 0.8819999694824219
Epoch: 8, Steps: 64 | Train Loss: 0.1216302 Vali Loss: 0.1707542 Test Loss: 0.2255649
Validation loss decreased (0.171546 --> 0.170754).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 9 cost time: 0.8806257247924805
Epoch: 9, Steps: 64 | Train Loss: 0.1194259 Vali Loss: 0.1688480 Test Loss: 0.2257940
Validation loss decreased (0.170754 --> 0.168848).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 10 cost time: 0.8854146003723145
Epoch: 10, Steps: 64 | Train Loss: 0.1180191 Vali Loss: 0.1692334 Test Loss: 0.2246355
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 11 cost time: 0.8844523429870605
Epoch: 11, Steps: 64 | Train Loss: 0.1163147 Vali Loss: 0.1654300 Test Loss: 0.2237193
Validation loss decreased (0.168848 --> 0.165430).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 12 cost time: 0.8993830680847168
Epoch: 12, Steps: 64 | Train Loss: 0.1146292 Vali Loss: 0.1640805 Test Loss: 0.2224674
Validation loss decreased (0.165430 --> 0.164081).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 13 cost time: 0.9127724170684814
Epoch: 13, Steps: 64 | Train Loss: 0.1142205 Vali Loss: 0.1636651 Test Loss: 0.2224907
Validation loss decreased (0.164081 --> 0.163665).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 14 cost time: 0.8819999694824219
Epoch: 14, Steps: 64 | Train Loss: 0.1127631 Vali Loss: 0.1629908 Test Loss: 0.2225930
Validation loss decreased (0.163665 --> 0.162991).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 15 cost time: 0.8843691349029541
Epoch: 15, Steps: 64 | Train Loss: 0.1126604 Vali Loss: 0.1647720 Test Loss: 0.2251447
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 16 cost time: 0.8944334983825684
Epoch: 16, Steps: 64 | Train Loss: 0.1117567 Vali Loss: 0.1617491 Test Loss: 0.2230241
Validation loss decreased (0.162991 --> 0.161749).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 17 cost time: 0.8849489688873291
Epoch: 17, Steps: 64 | Train Loss: 0.1114728 Vali Loss: 0.1620292 Test Loss: 0.2222075
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 18 cost time: 0.8753747940063477
Epoch: 18, Steps: 64 | Train Loss: 0.1113178 Vali Loss: 0.1611164 Test Loss: 0.2232387
Validation loss decreased (0.161749 --> 0.161116).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 19 cost time: 0.8827614784240723
Epoch: 19, Steps: 64 | Train Loss: 0.1107208 Vali Loss: 0.1610271 Test Loss: 0.2228763
Validation loss decreased (0.161116 --> 0.161027).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 20 cost time: 0.8923892974853516
Epoch: 20, Steps: 64 | Train Loss: 0.1098904 Vali Loss: 0.1600303 Test Loss: 0.2220209
Validation loss decreased (0.161027 --> 0.160030).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 21 cost time: 0.8948473930358887
Epoch: 21, Steps: 64 | Train Loss: 0.1099138 Vali Loss: 0.1622973 Test Loss: 0.2244309
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 22 cost time: 0.8804194927215576
Epoch: 22, Steps: 64 | Train Loss: 0.1094585 Vali Loss: 0.1603149 Test Loss: 0.2223730
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 23 cost time: 0.8864254951477051
Epoch: 23, Steps: 64 | Train Loss: 0.1094240 Vali Loss: 0.1587307 Test Loss: 0.2232877
Validation loss decreased (0.160030 --> 0.158731).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 24 cost time: 0.8588354587554932
Epoch: 24, Steps: 64 | Train Loss: 0.1095125 Vali Loss: 0.1584184 Test Loss: 0.2229488
Validation loss decreased (0.158731 --> 0.158418).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 25 cost time: 0.8877456188201904
Epoch: 25, Steps: 64 | Train Loss: 0.1092629 Vali Loss: 0.1586592 Test Loss: 0.2231509
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 26 cost time: 0.8849983215332031
Epoch: 26, Steps: 64 | Train Loss: 0.1089317 Vali Loss: 0.1579631 Test Loss: 0.2242299
Validation loss decreased (0.158418 --> 0.157963).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 27 cost time: 0.8836147785186768
Epoch: 27, Steps: 64 | Train Loss: 0.1084313 Vali Loss: 0.1583616 Test Loss: 0.2223337
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 28 cost time: 0.8813862800598145
Epoch: 28, Steps: 64 | Train Loss: 0.1078970 Vali Loss: 0.1579103 Test Loss: 0.2218554
Validation loss decreased (0.157963 --> 0.157910).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 29 cost time: 0.8831233978271484
Epoch: 29, Steps: 64 | Train Loss: 0.1084618 Vali Loss: 0.1582853 Test Loss: 0.2226853
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 30 cost time: 0.8883650302886963
Epoch: 30, Steps: 64 | Train Loss: 0.1081593 Vali Loss: 0.1600182 Test Loss: 0.2239552
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 31 cost time: 0.8867411613464355
Epoch: 31, Steps: 64 | Train Loss: 0.1081732 Vali Loss: 0.1579137 Test Loss: 0.2229141
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 32 cost time: 0.883002519607544
Epoch: 32, Steps: 64 | Train Loss: 0.1077392 Vali Loss: 0.1586966 Test Loss: 0.2225269
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 33 cost time: 0.8840005397796631
Epoch: 33, Steps: 64 | Train Loss: 0.1078304 Vali Loss: 0.1583306 Test Loss: 0.2230680
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 34 cost time: 0.8923726081848145
Epoch: 34, Steps: 64 | Train Loss: 0.1075895 Vali Loss: 0.1575822 Test Loss: 0.2233946
Validation loss decreased (0.157910 --> 0.157582).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 35 cost time: 0.8852052688598633
Epoch: 35, Steps: 64 | Train Loss: 0.1075994 Vali Loss: 0.1576015 Test Loss: 0.2221565
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 36 cost time: 0.8853929042816162
Epoch: 36, Steps: 64 | Train Loss: 0.1075158 Vali Loss: 0.1592083 Test Loss: 0.2230652
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 37 cost time: 0.8829998970031738
Epoch: 37, Steps: 64 | Train Loss: 0.1072372 Vali Loss: 0.1583902 Test Loss: 0.2219512
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 38 cost time: 0.8834354877471924
Epoch: 38, Steps: 64 | Train Loss: 0.1075676 Vali Loss: 0.1571549 Test Loss: 0.2212385
Validation loss decreased (0.157582 --> 0.157155).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 39 cost time: 0.8826203346252441
Epoch: 39, Steps: 64 | Train Loss: 0.1073612 Vali Loss: 0.1577118 Test Loss: 0.2241324
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 40 cost time: 0.8815362453460693
Epoch: 40, Steps: 64 | Train Loss: 0.1074291 Vali Loss: 0.1564006 Test Loss: 0.2221545
Validation loss decreased (0.157155 --> 0.156401).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 41 cost time: 0.8994061946868896
Epoch: 41, Steps: 64 | Train Loss: 0.1069041 Vali Loss: 0.1603713 Test Loss: 0.2246495
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 42 cost time: 0.8838448524475098
Epoch: 42, Steps: 64 | Train Loss: 0.1073314 Vali Loss: 0.1583069 Test Loss: 0.2223755
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 43 cost time: 0.8810007572174072
Epoch: 43, Steps: 64 | Train Loss: 0.1073201 Vali Loss: 0.1595935 Test Loss: 0.2253235
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 44 cost time: 0.8790006637573242
Epoch: 44, Steps: 64 | Train Loss: 0.1070797 Vali Loss: 0.1584531 Test Loss: 0.2220454
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 45 cost time: 0.8714396953582764
Epoch: 45, Steps: 64 | Train Loss: 0.1074251 Vali Loss: 0.1580072 Test Loss: 0.2246361
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 46 cost time: 0.886793851852417
Epoch: 46, Steps: 64 | Train Loss: 0.1068738 Vali Loss: 0.1599932 Test Loss: 0.2237835
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 47 cost time: 0.8854310512542725
Epoch: 47, Steps: 64 | Train Loss: 0.1070776 Vali Loss: 0.1581638 Test Loss: 0.2248465
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 48 cost time: 0.8858935832977295
Epoch: 48, Steps: 64 | Train Loss: 0.1068826 Vali Loss: 0.1579924 Test Loss: 0.2250423
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 49 cost time: 0.8799998760223389
Epoch: 49, Steps: 64 | Train Loss: 0.1067721 Vali Loss: 0.1553995 Test Loss: 0.2217607
Validation loss decreased (0.156401 --> 0.155400).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 50 cost time: 0.9164917469024658
Epoch: 50, Steps: 64 | Train Loss: 0.1069509 Vali Loss: 0.1580073 Test Loss: 0.2221154
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 51 cost time: 0.8835406303405762
Epoch: 51, Steps: 64 | Train Loss: 0.1071412 Vali Loss: 0.1580961 Test Loss: 0.2231389
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 52 cost time: 0.8705356121063232
Epoch: 52, Steps: 64 | Train Loss: 0.1069276 Vali Loss: 0.1572405 Test Loss: 0.2226519
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 53 cost time: 0.8823719024658203
Epoch: 53, Steps: 64 | Train Loss: 0.1065613 Vali Loss: 0.1579225 Test Loss: 0.2225524
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 54 cost time: 0.8867640495300293
Epoch: 54, Steps: 64 | Train Loss: 0.1064734 Vali Loss: 0.1573122 Test Loss: 0.2224673
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 55 cost time: 0.8825716972351074
Epoch: 55, Steps: 64 | Train Loss: 0.1069258 Vali Loss: 0.1579531 Test Loss: 0.2237877
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 56 cost time: 0.9002599716186523
Epoch: 56, Steps: 64 | Train Loss: 0.1066787 Vali Loss: 0.1592971 Test Loss: 0.2227198
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 57 cost time: 0.8883874416351318
Epoch: 57, Steps: 64 | Train Loss: 0.1073345 Vali Loss: 0.1588507 Test Loss: 0.2225531
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 58 cost time: 0.8834600448608398
Epoch: 58, Steps: 64 | Train Loss: 0.1071583 Vali Loss: 0.1562115 Test Loss: 0.2232110
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 59 cost time: 0.901808500289917
Epoch: 59, Steps: 64 | Train Loss: 0.1065063 Vali Loss: 0.1568981 Test Loss: 0.2223382
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 60 cost time: 0.8818926811218262
Epoch: 60, Steps: 64 | Train Loss: 0.1065616 Vali Loss: 0.1564640 Test Loss: 0.2230328
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22176073491573334, mae:0.32523229718208313, rse:0.23865826427936554
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.04806232452392578 GB
Epoch: 1 cost time: 2.3098556995391846
Epoch: 1, Steps: 64 | Train Loss: 0.9209016 Vali Loss: 2.4649608 Test Loss: 3.9633601
Validation loss decreased (inf --> 2.464961).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 2 cost time: 0.9746112823486328
Epoch: 2, Steps: 64 | Train Loss: 0.6537580 Vali Loss: 0.9197344 Test Loss: 1.3777851
Validation loss decreased (2.464961 --> 0.919734).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 3 cost time: 0.9689023494720459
Epoch: 3, Steps: 64 | Train Loss: 0.2323485 Vali Loss: 0.2242319 Test Loss: 0.2612754
Validation loss decreased (0.919734 --> 0.224232).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 4 cost time: 0.9723911285400391
Epoch: 4, Steps: 64 | Train Loss: 0.1354212 Vali Loss: 0.1797466 Test Loss: 0.2398016
Validation loss decreased (0.224232 --> 0.179747).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 5 cost time: 0.97589111328125
Epoch: 5, Steps: 64 | Train Loss: 0.1243348 Vali Loss: 0.1698877 Test Loss: 0.2231169
Validation loss decreased (0.179747 --> 0.169888).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 6 cost time: 0.9713690280914307
Epoch: 6, Steps: 64 | Train Loss: 0.1191221 Vali Loss: 0.1656051 Test Loss: 0.2210503
Validation loss decreased (0.169888 --> 0.165605).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 7 cost time: 0.9723803997039795
Epoch: 7, Steps: 64 | Train Loss: 0.1169010 Vali Loss: 0.1622923 Test Loss: 0.2199116
Validation loss decreased (0.165605 --> 0.162292).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 8 cost time: 0.9714710712432861
Epoch: 8, Steps: 64 | Train Loss: 0.1144789 Vali Loss: 0.1607483 Test Loss: 0.2206757
Validation loss decreased (0.162292 --> 0.160748).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 9 cost time: 0.974388837814331
Epoch: 9, Steps: 64 | Train Loss: 0.1126680 Vali Loss: 0.1616072 Test Loss: 0.2197754
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 10 cost time: 0.97279953956604
Epoch: 10, Steps: 64 | Train Loss: 0.1113284 Vali Loss: 0.1595596 Test Loss: 0.2209406
Validation loss decreased (0.160748 --> 0.159560).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 11 cost time: 0.9754352569580078
Epoch: 11, Steps: 64 | Train Loss: 0.1099582 Vali Loss: 0.1594239 Test Loss: 0.2203977
Validation loss decreased (0.159560 --> 0.159424).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 12 cost time: 0.9804377555847168
Epoch: 12, Steps: 64 | Train Loss: 0.1088995 Vali Loss: 0.1567961 Test Loss: 0.2192729
Validation loss decreased (0.159424 --> 0.156796).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 13 cost time: 0.9683942794799805
Epoch: 13, Steps: 64 | Train Loss: 0.1080367 Vali Loss: 0.1577748 Test Loss: 0.2195715
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 14 cost time: 0.9686219692230225
Epoch: 14, Steps: 64 | Train Loss: 0.1077397 Vali Loss: 0.1549974 Test Loss: 0.2195426
Validation loss decreased (0.156796 --> 0.154997).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 15 cost time: 0.9885303974151611
Epoch: 15, Steps: 64 | Train Loss: 0.1070994 Vali Loss: 0.1549025 Test Loss: 0.2198959
Validation loss decreased (0.154997 --> 0.154903).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 16 cost time: 0.9861538410186768
Epoch: 16, Steps: 64 | Train Loss: 0.1061207 Vali Loss: 0.1552975 Test Loss: 0.2200030
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 17 cost time: 0.9827072620391846
Epoch: 17, Steps: 64 | Train Loss: 0.1060600 Vali Loss: 0.1531610 Test Loss: 0.2195742
Validation loss decreased (0.154903 --> 0.153161).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 18 cost time: 0.9883620738983154
Epoch: 18, Steps: 64 | Train Loss: 0.1053184 Vali Loss: 0.1531246 Test Loss: 0.2211054
Validation loss decreased (0.153161 --> 0.153125).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 19 cost time: 0.9987232685089111
Epoch: 19, Steps: 64 | Train Loss: 0.1050568 Vali Loss: 0.1513836 Test Loss: 0.2207139
Validation loss decreased (0.153125 --> 0.151384).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 20 cost time: 0.987391471862793
Epoch: 20, Steps: 64 | Train Loss: 0.1049808 Vali Loss: 0.1529631 Test Loss: 0.2201145
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 21 cost time: 0.9864029884338379
Epoch: 21, Steps: 64 | Train Loss: 0.1038592 Vali Loss: 0.1503566 Test Loss: 0.2213862
Validation loss decreased (0.151384 --> 0.150357).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 22 cost time: 0.9927339553833008
Epoch: 22, Steps: 64 | Train Loss: 0.1043061 Vali Loss: 0.1521601 Test Loss: 0.2206444
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 23 cost time: 1.026700496673584
Epoch: 23, Steps: 64 | Train Loss: 0.1039474 Vali Loss: 0.1511261 Test Loss: 0.2209790
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 24 cost time: 0.980804443359375
Epoch: 24, Steps: 64 | Train Loss: 0.1038927 Vali Loss: 0.1527674 Test Loss: 0.2214909
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 25 cost time: 0.9843778610229492
Epoch: 25, Steps: 64 | Train Loss: 0.1037851 Vali Loss: 0.1516739 Test Loss: 0.2209106
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 26 cost time: 0.9835362434387207
Epoch: 26, Steps: 64 | Train Loss: 0.1032000 Vali Loss: 0.1511587 Test Loss: 0.2213594
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 27 cost time: 0.989142656326294
Epoch: 27, Steps: 64 | Train Loss: 0.1032346 Vali Loss: 0.1520950 Test Loss: 0.2212702
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 28 cost time: 0.9892346858978271
Epoch: 28, Steps: 64 | Train Loss: 0.1031208 Vali Loss: 0.1507625 Test Loss: 0.2217144
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 29 cost time: 1.0129518508911133
Epoch: 29, Steps: 64 | Train Loss: 0.1030833 Vali Loss: 0.1510686 Test Loss: 0.2220723
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 30 cost time: 0.9893617630004883
Epoch: 30, Steps: 64 | Train Loss: 0.1028968 Vali Loss: 0.1521170 Test Loss: 0.2219199
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 31 cost time: 0.9803564548492432
Epoch: 31, Steps: 64 | Train Loss: 0.1026546 Vali Loss: 0.1500230 Test Loss: 0.2219551
Validation loss decreased (0.150357 --> 0.150023).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 32 cost time: 0.9930930137634277
Epoch: 32, Steps: 64 | Train Loss: 0.1029203 Vali Loss: 0.1487703 Test Loss: 0.2211752
Validation loss decreased (0.150023 --> 0.148770).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 33 cost time: 0.983400821685791
Epoch: 33, Steps: 64 | Train Loss: 0.1027194 Vali Loss: 0.1508108 Test Loss: 0.2213763
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 34 cost time: 0.9647371768951416
Epoch: 34, Steps: 64 | Train Loss: 0.1027391 Vali Loss: 0.1494714 Test Loss: 0.2223852
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 35 cost time: 0.9837572574615479
Epoch: 35, Steps: 64 | Train Loss: 0.1028669 Vali Loss: 0.1507381 Test Loss: 0.2218577
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 36 cost time: 0.970038890838623
Epoch: 36, Steps: 64 | Train Loss: 0.1023414 Vali Loss: 0.1506487 Test Loss: 0.2221346
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 37 cost time: 0.9730353355407715
Epoch: 37, Steps: 64 | Train Loss: 0.1027993 Vali Loss: 0.1512715 Test Loss: 0.2218226
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 38 cost time: 0.9686145782470703
Epoch: 38, Steps: 64 | Train Loss: 0.1021198 Vali Loss: 0.1493043 Test Loss: 0.2218765
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 39 cost time: 0.9806113243103027
Epoch: 39, Steps: 64 | Train Loss: 0.1019771 Vali Loss: 0.1496204 Test Loss: 0.2219261
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 40 cost time: 0.9703555107116699
Epoch: 40, Steps: 64 | Train Loss: 0.1022962 Vali Loss: 0.1508344 Test Loss: 0.2220760
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 41 cost time: 0.9662222862243652
Epoch: 41, Steps: 64 | Train Loss: 0.1022206 Vali Loss: 0.1506147 Test Loss: 0.2215127
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 42 cost time: 0.9582474231719971
Epoch: 42, Steps: 64 | Train Loss: 0.1022626 Vali Loss: 0.1501042 Test Loss: 0.2225182
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 43 cost time: 0.9753620624542236
Epoch: 43, Steps: 64 | Train Loss: 0.1022200 Vali Loss: 0.1489725 Test Loss: 0.2220944
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 44 cost time: 0.9707250595092773
Epoch: 44, Steps: 64 | Train Loss: 0.1022159 Vali Loss: 0.1508652 Test Loss: 0.2223447
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 45 cost time: 0.9788355827331543
Epoch: 45, Steps: 64 | Train Loss: 0.1021500 Vali Loss: 0.1498983 Test Loss: 0.2222335
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 46 cost time: 0.9740006923675537
Epoch: 46, Steps: 64 | Train Loss: 0.1026039 Vali Loss: 0.1489710 Test Loss: 0.2218833
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 47 cost time: 0.971625566482544
Epoch: 47, Steps: 64 | Train Loss: 0.1023629 Vali Loss: 0.1502773 Test Loss: 0.2223060
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 48 cost time: 0.9676055908203125
Epoch: 48, Steps: 64 | Train Loss: 0.1020768 Vali Loss: 0.1507579 Test Loss: 0.2220808
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 49 cost time: 0.9814643859863281
Epoch: 49, Steps: 64 | Train Loss: 0.1018435 Vali Loss: 0.1489613 Test Loss: 0.2224429
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 50 cost time: 0.9633760452270508
Epoch: 50, Steps: 64 | Train Loss: 0.1022193 Vali Loss: 0.1490037 Test Loss: 0.2216634
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 51 cost time: 0.9693810939788818
Epoch: 51, Steps: 64 | Train Loss: 0.1024560 Vali Loss: 0.1485100 Test Loss: 0.2219225
Validation loss decreased (0.148770 --> 0.148510).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 52 cost time: 0.9884581565856934
Epoch: 52, Steps: 64 | Train Loss: 0.1021287 Vali Loss: 0.1491736 Test Loss: 0.2228221
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 53 cost time: 0.971393346786499
Epoch: 53, Steps: 64 | Train Loss: 0.1018808 Vali Loss: 0.1510937 Test Loss: 0.2229564
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 54 cost time: 0.9698238372802734
Epoch: 54, Steps: 64 | Train Loss: 0.1017024 Vali Loss: 0.1474372 Test Loss: 0.2220933
Validation loss decreased (0.148510 --> 0.147437).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 55 cost time: 0.9778850078582764
Epoch: 55, Steps: 64 | Train Loss: 0.1016869 Vali Loss: 0.1501819 Test Loss: 0.2222055
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 56 cost time: 0.9790000915527344
Epoch: 56, Steps: 64 | Train Loss: 0.1022428 Vali Loss: 0.1496530 Test Loss: 0.2222701
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 57 cost time: 0.9723978042602539
Epoch: 57, Steps: 64 | Train Loss: 0.1022534 Vali Loss: 0.1483238 Test Loss: 0.2226938
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 58 cost time: 0.9692621231079102
Epoch: 58, Steps: 64 | Train Loss: 0.1024588 Vali Loss: 0.1502841 Test Loss: 0.2219226
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 59 cost time: 0.9633822441101074
Epoch: 59, Steps: 64 | Train Loss: 0.1017994 Vali Loss: 0.1485924 Test Loss: 0.2220951
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 60 cost time: 0.9673688411712646
Epoch: 60, Steps: 64 | Train Loss: 0.1019190 Vali Loss: 0.1506830 Test Loss: 0.2229068
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22209328413009644, mae:0.3252931535243988, rse:0.2388371378183365
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.045671939849853516 GB
Epoch: 1 cost time: 2.2640888690948486
Epoch: 1, Steps: 64 | Train Loss: 0.7274429 Vali Loss: 1.5298573 Test Loss: 2.2942379
Validation loss decreased (inf --> 1.529857).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 2 cost time: 0.9440631866455078
Epoch: 2, Steps: 64 | Train Loss: 0.4972570 Vali Loss: 0.5217616 Test Loss: 0.7019168
Validation loss decreased (1.529857 --> 0.521762).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 3 cost time: 1.0286827087402344
Epoch: 3, Steps: 64 | Train Loss: 0.2729513 Vali Loss: 0.2696686 Test Loss: 0.3252056
Validation loss decreased (0.521762 --> 0.269669).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 4 cost time: 0.9350879192352295
Epoch: 4, Steps: 64 | Train Loss: 0.1992947 Vali Loss: 0.2036411 Test Loss: 0.2475365
Validation loss decreased (0.269669 --> 0.203641).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 5 cost time: 0.9447104930877686
Epoch: 5, Steps: 64 | Train Loss: 0.1762851 Vali Loss: 0.1784790 Test Loss: 0.2293176
Validation loss decreased (0.203641 --> 0.178479).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 6 cost time: 0.9319989681243896
Epoch: 6, Steps: 64 | Train Loss: 0.1655954 Vali Loss: 0.1785268 Test Loss: 0.2275534
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 7 cost time: 0.9269449710845947
Epoch: 7, Steps: 64 | Train Loss: 0.1568884 Vali Loss: 0.1756138 Test Loss: 0.2264363
Validation loss decreased (0.178479 --> 0.175614).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 8 cost time: 0.9286098480224609
Epoch: 8, Steps: 64 | Train Loss: 0.1515270 Vali Loss: 0.1742789 Test Loss: 0.2282958
Validation loss decreased (0.175614 --> 0.174279).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 9 cost time: 0.9243392944335938
Epoch: 9, Steps: 64 | Train Loss: 0.1467427 Vali Loss: 0.1731971 Test Loss: 0.2254976
Validation loss decreased (0.174279 --> 0.173197).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 10 cost time: 0.9283187389373779
Epoch: 10, Steps: 64 | Train Loss: 0.1438155 Vali Loss: 0.1691512 Test Loss: 0.2242158
Validation loss decreased (0.173197 --> 0.169151).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 11 cost time: 0.9373350143432617
Epoch: 11, Steps: 64 | Train Loss: 0.1419287 Vali Loss: 0.1711143 Test Loss: 0.2260778
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 12 cost time: 0.9453163146972656
Epoch: 12, Steps: 64 | Train Loss: 0.1393553 Vali Loss: 0.1674287 Test Loss: 0.2228757
Validation loss decreased (0.169151 --> 0.167429).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 13 cost time: 0.9347894191741943
Epoch: 13, Steps: 64 | Train Loss: 0.1370799 Vali Loss: 0.1685076 Test Loss: 0.2226906
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 14 cost time: 0.9349987506866455
Epoch: 14, Steps: 64 | Train Loss: 0.1366904 Vali Loss: 0.1715335 Test Loss: 0.2253670
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 15 cost time: 0.9300186634063721
Epoch: 15, Steps: 64 | Train Loss: 0.1342854 Vali Loss: 0.1659692 Test Loss: 0.2228561
Validation loss decreased (0.167429 --> 0.165969).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 16 cost time: 0.9295952320098877
Epoch: 16, Steps: 64 | Train Loss: 0.1321896 Vali Loss: 0.1657495 Test Loss: 0.2235007
Validation loss decreased (0.165969 --> 0.165750).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 17 cost time: 0.9273970127105713
Epoch: 17, Steps: 64 | Train Loss: 0.1327529 Vali Loss: 0.1665765 Test Loss: 0.2231608
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 18 cost time: 0.9230208396911621
Epoch: 18, Steps: 64 | Train Loss: 0.1311870 Vali Loss: 0.1655066 Test Loss: 0.2231829
Validation loss decreased (0.165750 --> 0.165507).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 19 cost time: 0.94036865234375
Epoch: 19, Steps: 64 | Train Loss: 0.1303420 Vali Loss: 0.1639233 Test Loss: 0.2219587
Validation loss decreased (0.165507 --> 0.163923).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 20 cost time: 0.9259860515594482
Epoch: 20, Steps: 64 | Train Loss: 0.1291559 Vali Loss: 0.1652064 Test Loss: 0.2221968
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 21 cost time: 0.9264049530029297
Epoch: 21, Steps: 64 | Train Loss: 0.1288740 Vali Loss: 0.1662898 Test Loss: 0.2222606
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 22 cost time: 0.9360001087188721
Epoch: 22, Steps: 64 | Train Loss: 0.1282706 Vali Loss: 0.1649812 Test Loss: 0.2229978
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 23 cost time: 0.9276316165924072
Epoch: 23, Steps: 64 | Train Loss: 0.1278399 Vali Loss: 0.1644105 Test Loss: 0.2233618
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 24 cost time: 0.9258546829223633
Epoch: 24, Steps: 64 | Train Loss: 0.1274835 Vali Loss: 0.1642028 Test Loss: 0.2224364
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 25 cost time: 0.9203882217407227
Epoch: 25, Steps: 64 | Train Loss: 0.1268812 Vali Loss: 0.1655455 Test Loss: 0.2232808
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 26 cost time: 0.9244446754455566
Epoch: 26, Steps: 64 | Train Loss: 0.1266007 Vali Loss: 0.1648118 Test Loss: 0.2228356
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 27 cost time: 0.9273810386657715
Epoch: 27, Steps: 64 | Train Loss: 0.1262851 Vali Loss: 0.1630940 Test Loss: 0.2221393
Validation loss decreased (0.163923 --> 0.163094).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 28 cost time: 0.9298286437988281
Epoch: 28, Steps: 64 | Train Loss: 0.1259263 Vali Loss: 0.1644378 Test Loss: 0.2237088
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 29 cost time: 0.9366374015808105
Epoch: 29, Steps: 64 | Train Loss: 0.1258779 Vali Loss: 0.1634698 Test Loss: 0.2228907
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 30 cost time: 0.9220001697540283
Epoch: 30, Steps: 64 | Train Loss: 0.1255773 Vali Loss: 0.1634748 Test Loss: 0.2215709
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 31 cost time: 0.9256315231323242
Epoch: 31, Steps: 64 | Train Loss: 0.1255101 Vali Loss: 0.1644638 Test Loss: 0.2224533
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 32 cost time: 0.919414758682251
Epoch: 32, Steps: 64 | Train Loss: 0.1250664 Vali Loss: 0.1628750 Test Loss: 0.2224783
Validation loss decreased (0.163094 --> 0.162875).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 33 cost time: 0.937028169631958
Epoch: 33, Steps: 64 | Train Loss: 0.1250484 Vali Loss: 0.1641191 Test Loss: 0.2221693
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 34 cost time: 0.9214391708374023
Epoch: 34, Steps: 64 | Train Loss: 0.1251884 Vali Loss: 0.1642185 Test Loss: 0.2225395
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 35 cost time: 0.9237627983093262
Epoch: 35, Steps: 64 | Train Loss: 0.1247716 Vali Loss: 0.1634465 Test Loss: 0.2217591
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 36 cost time: 0.9387760162353516
Epoch: 36, Steps: 64 | Train Loss: 0.1243509 Vali Loss: 0.1623116 Test Loss: 0.2224358
Validation loss decreased (0.162875 --> 0.162312).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 37 cost time: 0.9283528327941895
Epoch: 37, Steps: 64 | Train Loss: 0.1239819 Vali Loss: 0.1620332 Test Loss: 0.2215356
Validation loss decreased (0.162312 --> 0.162033).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 38 cost time: 0.9256336688995361
Epoch: 38, Steps: 64 | Train Loss: 0.1241732 Vali Loss: 0.1603857 Test Loss: 0.2210900
Validation loss decreased (0.162033 --> 0.160386).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 39 cost time: 0.9273600578308105
Epoch: 39, Steps: 64 | Train Loss: 0.1248881 Vali Loss: 0.1641111 Test Loss: 0.2223287
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 40 cost time: 0.9383347034454346
Epoch: 40, Steps: 64 | Train Loss: 0.1246658 Vali Loss: 0.1632470 Test Loss: 0.2221068
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 41 cost time: 0.9269721508026123
Epoch: 41, Steps: 64 | Train Loss: 0.1246638 Vali Loss: 0.1623238 Test Loss: 0.2217539
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 42 cost time: 0.9233996868133545
Epoch: 42, Steps: 64 | Train Loss: 0.1241434 Vali Loss: 0.1629425 Test Loss: 0.2214833
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 43 cost time: 0.9277462959289551
Epoch: 43, Steps: 64 | Train Loss: 0.1237754 Vali Loss: 0.1613287 Test Loss: 0.2212554
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 44 cost time: 0.9210000038146973
Epoch: 44, Steps: 64 | Train Loss: 0.1238918 Vali Loss: 0.1621894 Test Loss: 0.2211779
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 45 cost time: 0.9266178607940674
Epoch: 45, Steps: 64 | Train Loss: 0.1239499 Vali Loss: 0.1622678 Test Loss: 0.2215205
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 46 cost time: 0.9296259880065918
Epoch: 46, Steps: 64 | Train Loss: 0.1236560 Vali Loss: 0.1634238 Test Loss: 0.2220547
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 47 cost time: 0.9134101867675781
Epoch: 47, Steps: 64 | Train Loss: 0.1241887 Vali Loss: 0.1613601 Test Loss: 0.2224030
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 48 cost time: 0.9119813442230225
Epoch: 48, Steps: 64 | Train Loss: 0.1238759 Vali Loss: 0.1629293 Test Loss: 0.2219501
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 49 cost time: 0.9233784675598145
Epoch: 49, Steps: 64 | Train Loss: 0.1233904 Vali Loss: 0.1626934 Test Loss: 0.2222409
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 50 cost time: 0.9160773754119873
Epoch: 50, Steps: 64 | Train Loss: 0.1239039 Vali Loss: 0.1629715 Test Loss: 0.2224971
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 51 cost time: 0.9249982833862305
Epoch: 51, Steps: 64 | Train Loss: 0.1241173 Vali Loss: 0.1629710 Test Loss: 0.2211605
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 52 cost time: 0.9340009689331055
Epoch: 52, Steps: 64 | Train Loss: 0.1237734 Vali Loss: 0.1625630 Test Loss: 0.2215878
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 53 cost time: 0.9246134757995605
Epoch: 53, Steps: 64 | Train Loss: 0.1238041 Vali Loss: 0.1632720 Test Loss: 0.2213751
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 54 cost time: 0.926002025604248
Epoch: 54, Steps: 64 | Train Loss: 0.1231308 Vali Loss: 0.1638562 Test Loss: 0.2233999
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 55 cost time: 0.9284236431121826
Epoch: 55, Steps: 64 | Train Loss: 0.1236497 Vali Loss: 0.1628038 Test Loss: 0.2214989
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 56 cost time: 0.9313929080963135
Epoch: 56, Steps: 64 | Train Loss: 0.1235613 Vali Loss: 0.1609093 Test Loss: 0.2226007
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 57 cost time: 0.9769196510314941
Epoch: 57, Steps: 64 | Train Loss: 0.1231588 Vali Loss: 0.1618142 Test Loss: 0.2214205
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 58 cost time: 0.9233744144439697
Epoch: 58, Steps: 64 | Train Loss: 0.1230064 Vali Loss: 0.1629302 Test Loss: 0.2222582
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 59 cost time: 0.9207310676574707
Epoch: 59, Steps: 64 | Train Loss: 0.1230559 Vali Loss: 0.1613914 Test Loss: 0.2216629
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 60 cost time: 0.9340014457702637
Epoch: 60, Steps: 64 | Train Loss: 0.1232551 Vali Loss: 0.1632734 Test Loss: 0.2221657
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22109004855155945, mae:0.32865995168685913, rse:0.23829707503318787
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.0471038818359375 GB
Epoch: 1 cost time: 2.3844799995422363
Epoch: 1, Steps: 64 | Train Loss: 1.0036483 Vali Loss: 2.5659382 Test Loss: 4.1063452
Validation loss decreased (inf --> 2.565938).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 2 cost time: 1.0196146965026855
Epoch: 2, Steps: 64 | Train Loss: 0.5926642 Vali Loss: 0.6387083 Test Loss: 0.8596084
Validation loss decreased (2.565938 --> 0.638708).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 3 cost time: 0.9489636421203613
Epoch: 3, Steps: 64 | Train Loss: 0.2206054 Vali Loss: 0.2551254 Test Loss: 0.2768473
Validation loss decreased (0.638708 --> 0.255125).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 4 cost time: 0.9367761611938477
Epoch: 4, Steps: 64 | Train Loss: 0.1533996 Vali Loss: 0.2032440 Test Loss: 0.2402092
Validation loss decreased (0.255125 --> 0.203244).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 5 cost time: 0.9493908882141113
Epoch: 5, Steps: 64 | Train Loss: 0.1397629 Vali Loss: 0.1878192 Test Loss: 0.2304854
Validation loss decreased (0.203244 --> 0.187819).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 6 cost time: 0.9365038871765137
Epoch: 6, Steps: 64 | Train Loss: 0.1332092 Vali Loss: 0.1784488 Test Loss: 0.2264416
Validation loss decreased (0.187819 --> 0.178449).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 7 cost time: 0.9533164501190186
Epoch: 7, Steps: 64 | Train Loss: 0.1285770 Vali Loss: 0.1764733 Test Loss: 0.2260406
Validation loss decreased (0.178449 --> 0.176473).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 8 cost time: 0.945805549621582
Epoch: 8, Steps: 64 | Train Loss: 0.1250706 Vali Loss: 0.1723226 Test Loss: 0.2247473
Validation loss decreased (0.176473 --> 0.172323).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 9 cost time: 0.9397165775299072
Epoch: 9, Steps: 64 | Train Loss: 0.1224911 Vali Loss: 0.1692261 Test Loss: 0.2228436
Validation loss decreased (0.172323 --> 0.169226).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 10 cost time: 0.9690001010894775
Epoch: 10, Steps: 64 | Train Loss: 0.1202376 Vali Loss: 0.1675400 Test Loss: 0.2221471
Validation loss decreased (0.169226 --> 0.167540).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 11 cost time: 0.9476504325866699
Epoch: 11, Steps: 64 | Train Loss: 0.1192299 Vali Loss: 0.1669468 Test Loss: 0.2212139
Validation loss decreased (0.167540 --> 0.166947).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 12 cost time: 0.951613187789917
Epoch: 12, Steps: 64 | Train Loss: 0.1179629 Vali Loss: 0.1657582 Test Loss: 0.2213102
Validation loss decreased (0.166947 --> 0.165758).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 13 cost time: 0.9483580589294434
Epoch: 13, Steps: 64 | Train Loss: 0.1173361 Vali Loss: 0.1659235 Test Loss: 0.2219119
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 14 cost time: 0.9568111896514893
Epoch: 14, Steps: 64 | Train Loss: 0.1156774 Vali Loss: 0.1633457 Test Loss: 0.2201262
Validation loss decreased (0.165758 --> 0.163346).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 15 cost time: 0.9427855014801025
Epoch: 15, Steps: 64 | Train Loss: 0.1148230 Vali Loss: 0.1653117 Test Loss: 0.2203301
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 16 cost time: 0.9423446655273438
Epoch: 16, Steps: 64 | Train Loss: 0.1146258 Vali Loss: 0.1641129 Test Loss: 0.2205268
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 17 cost time: 0.9550771713256836
Epoch: 17, Steps: 64 | Train Loss: 0.1137908 Vali Loss: 0.1635512 Test Loss: 0.2200929
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 18 cost time: 0.9447920322418213
Epoch: 18, Steps: 64 | Train Loss: 0.1133136 Vali Loss: 0.1610583 Test Loss: 0.2196181
Validation loss decreased (0.163346 --> 0.161058).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 19 cost time: 0.9539999961853027
Epoch: 19, Steps: 64 | Train Loss: 0.1127214 Vali Loss: 0.1618898 Test Loss: 0.2204200
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 20 cost time: 0.9606204032897949
Epoch: 20, Steps: 64 | Train Loss: 0.1126748 Vali Loss: 0.1619060 Test Loss: 0.2203650
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 21 cost time: 0.9198987483978271
Epoch: 21, Steps: 64 | Train Loss: 0.1126493 Vali Loss: 0.1613675 Test Loss: 0.2194074
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 22 cost time: 0.9436070919036865
Epoch: 22, Steps: 64 | Train Loss: 0.1119331 Vali Loss: 0.1607773 Test Loss: 0.2191114
Validation loss decreased (0.161058 --> 0.160777).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 23 cost time: 0.9443638324737549
Epoch: 23, Steps: 64 | Train Loss: 0.1115108 Vali Loss: 0.1598237 Test Loss: 0.2204735
Validation loss decreased (0.160777 --> 0.159824).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 24 cost time: 0.925987720489502
Epoch: 24, Steps: 64 | Train Loss: 0.1114107 Vali Loss: 0.1595555 Test Loss: 0.2186117
Validation loss decreased (0.159824 --> 0.159556).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 25 cost time: 0.9333925247192383
Epoch: 25, Steps: 64 | Train Loss: 0.1114086 Vali Loss: 0.1614177 Test Loss: 0.2191807
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 26 cost time: 0.9427826404571533
Epoch: 26, Steps: 64 | Train Loss: 0.1108666 Vali Loss: 0.1606429 Test Loss: 0.2193566
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 27 cost time: 0.960803747177124
Epoch: 27, Steps: 64 | Train Loss: 0.1107126 Vali Loss: 0.1613519 Test Loss: 0.2197588
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 28 cost time: 0.9570200443267822
Epoch: 28, Steps: 64 | Train Loss: 0.1106711 Vali Loss: 0.1591364 Test Loss: 0.2186940
Validation loss decreased (0.159556 --> 0.159136).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 29 cost time: 0.9556193351745605
Epoch: 29, Steps: 64 | Train Loss: 0.1106339 Vali Loss: 0.1615941 Test Loss: 0.2195309
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 30 cost time: 0.953366756439209
Epoch: 30, Steps: 64 | Train Loss: 0.1105370 Vali Loss: 0.1609091 Test Loss: 0.2188600
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 31 cost time: 0.9453747272491455
Epoch: 31, Steps: 64 | Train Loss: 0.1102182 Vali Loss: 0.1603818 Test Loss: 0.2189753
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 32 cost time: 0.9434447288513184
Epoch: 32, Steps: 64 | Train Loss: 0.1104646 Vali Loss: 0.1593568 Test Loss: 0.2194163
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 33 cost time: 0.9454593658447266
Epoch: 33, Steps: 64 | Train Loss: 0.1105075 Vali Loss: 0.1594413 Test Loss: 0.2197214
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 34 cost time: 0.9563744068145752
Epoch: 34, Steps: 64 | Train Loss: 0.1099676 Vali Loss: 0.1604587 Test Loss: 0.2188558
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 35 cost time: 0.9457454681396484
Epoch: 35, Steps: 64 | Train Loss: 0.1099182 Vali Loss: 0.1596049 Test Loss: 0.2191096
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 36 cost time: 0.9523961544036865
Epoch: 36, Steps: 64 | Train Loss: 0.1098377 Vali Loss: 0.1589788 Test Loss: 0.2192772
Validation loss decreased (0.159136 --> 0.158979).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 37 cost time: 0.9622366428375244
Epoch: 37, Steps: 64 | Train Loss: 0.1098014 Vali Loss: 0.1589723 Test Loss: 0.2187351
Validation loss decreased (0.158979 --> 0.158972).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 38 cost time: 1.0306084156036377
Epoch: 38, Steps: 64 | Train Loss: 0.1095785 Vali Loss: 0.1597979 Test Loss: 0.2202595
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 39 cost time: 0.9726161956787109
Epoch: 39, Steps: 64 | Train Loss: 0.1097830 Vali Loss: 0.1595245 Test Loss: 0.2185733
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 40 cost time: 0.9458065032958984
Epoch: 40, Steps: 64 | Train Loss: 0.1097813 Vali Loss: 0.1592515 Test Loss: 0.2187879
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 41 cost time: 0.9403543472290039
Epoch: 41, Steps: 64 | Train Loss: 0.1093082 Vali Loss: 0.1585481 Test Loss: 0.2189903
Validation loss decreased (0.158972 --> 0.158548).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 42 cost time: 0.9483418464660645
Epoch: 42, Steps: 64 | Train Loss: 0.1092552 Vali Loss: 0.1607500 Test Loss: 0.2197688
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 43 cost time: 0.9439575672149658
Epoch: 43, Steps: 64 | Train Loss: 0.1095226 Vali Loss: 0.1582187 Test Loss: 0.2185839
Validation loss decreased (0.158548 --> 0.158219).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 44 cost time: 0.9488062858581543
Epoch: 44, Steps: 64 | Train Loss: 0.1093725 Vali Loss: 0.1595018 Test Loss: 0.2193347
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 45 cost time: 1.0320484638214111
Epoch: 45, Steps: 64 | Train Loss: 0.1095552 Vali Loss: 0.1577460 Test Loss: 0.2195181
Validation loss decreased (0.158219 --> 0.157746).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 46 cost time: 0.945502758026123
Epoch: 46, Steps: 64 | Train Loss: 0.1092436 Vali Loss: 0.1594315 Test Loss: 0.2188946
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 47 cost time: 0.9648540019989014
Epoch: 47, Steps: 64 | Train Loss: 0.1090514 Vali Loss: 0.1588716 Test Loss: 0.2192434
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 48 cost time: 0.9473876953125
Epoch: 48, Steps: 64 | Train Loss: 0.1100158 Vali Loss: 0.1587963 Test Loss: 0.2193366
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 49 cost time: 0.9474239349365234
Epoch: 49, Steps: 64 | Train Loss: 0.1090597 Vali Loss: 0.1583000 Test Loss: 0.2199965
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 50 cost time: 0.9433276653289795
Epoch: 50, Steps: 64 | Train Loss: 0.1091275 Vali Loss: 0.1593837 Test Loss: 0.2185697
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 51 cost time: 0.9514162540435791
Epoch: 51, Steps: 64 | Train Loss: 0.1094766 Vali Loss: 0.1595614 Test Loss: 0.2193521
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 52 cost time: 0.954409122467041
Epoch: 52, Steps: 64 | Train Loss: 0.1092388 Vali Loss: 0.1604080 Test Loss: 0.2208928
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 53 cost time: 0.9530048370361328
Epoch: 53, Steps: 64 | Train Loss: 0.1096577 Vali Loss: 0.1574793 Test Loss: 0.2190752
Validation loss decreased (0.157746 --> 0.157479).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 54 cost time: 0.9637801647186279
Epoch: 54, Steps: 64 | Train Loss: 0.1090241 Vali Loss: 0.1571874 Test Loss: 0.2190864
Validation loss decreased (0.157479 --> 0.157187).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 55 cost time: 0.9500000476837158
Epoch: 55, Steps: 64 | Train Loss: 0.1092644 Vali Loss: 0.1590295 Test Loss: 0.2196166
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 56 cost time: 0.9519991874694824
Epoch: 56, Steps: 64 | Train Loss: 0.1088476 Vali Loss: 0.1572825 Test Loss: 0.2187417
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 57 cost time: 0.9536247253417969
Epoch: 57, Steps: 64 | Train Loss: 0.1094165 Vali Loss: 0.1594965 Test Loss: 0.2192785
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 58 cost time: 0.9453516006469727
Epoch: 58, Steps: 64 | Train Loss: 0.1091228 Vali Loss: 0.1583610 Test Loss: 0.2184438
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 59 cost time: 0.9448862075805664
Epoch: 59, Steps: 64 | Train Loss: 0.1092542 Vali Loss: 0.1593786 Test Loss: 0.2196102
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 60 cost time: 0.9473552703857422
Epoch: 60, Steps: 64 | Train Loss: 0.1094267 Vali Loss: 0.1595511 Test Loss: 0.2204355
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.21908646821975708, mae:0.32248952984809875, rse:0.2372148633003235
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.04822397232055664 GB
Epoch: 1 cost time: 2.30924916267395
Epoch: 1, Steps: 64 | Train Loss: 0.9800413 Vali Loss: 2.6501837 Test Loss: 4.2659144
Validation loss decreased (inf --> 2.650184).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 2 cost time: 0.9773838520050049
Epoch: 2, Steps: 64 | Train Loss: 0.6710503 Vali Loss: 0.9388638 Test Loss: 1.4047918
Validation loss decreased (2.650184 --> 0.938864).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 3 cost time: 0.9743473529815674
Epoch: 3, Steps: 64 | Train Loss: 0.2428289 Vali Loss: 0.2417769 Test Loss: 0.2808354
Validation loss decreased (0.938864 --> 0.241777).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 4 cost time: 0.9849982261657715
Epoch: 4, Steps: 64 | Train Loss: 0.1330033 Vali Loss: 0.1850045 Test Loss: 0.2335972
Validation loss decreased (0.241777 --> 0.185005).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 5 cost time: 0.9750001430511475
Epoch: 5, Steps: 64 | Train Loss: 0.1235643 Vali Loss: 0.1771091 Test Loss: 0.2234430
Validation loss decreased (0.185005 --> 0.177109).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 6 cost time: 0.969618558883667
Epoch: 6, Steps: 64 | Train Loss: 0.1191704 Vali Loss: 0.1690378 Test Loss: 0.2202462
Validation loss decreased (0.177109 --> 0.169038).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 7 cost time: 0.9796223640441895
Epoch: 7, Steps: 64 | Train Loss: 0.1158324 Vali Loss: 0.1703619 Test Loss: 0.2219985
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 8 cost time: 0.9812226295471191
Epoch: 8, Steps: 64 | Train Loss: 0.1141931 Vali Loss: 0.1656715 Test Loss: 0.2197711
Validation loss decreased (0.169038 --> 0.165672).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 9 cost time: 0.9942972660064697
Epoch: 9, Steps: 64 | Train Loss: 0.1124085 Vali Loss: 0.1666035 Test Loss: 0.2196285
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 10 cost time: 1.0039565563201904
Epoch: 10, Steps: 64 | Train Loss: 0.1114174 Vali Loss: 0.1645318 Test Loss: 0.2187632
Validation loss decreased (0.165672 --> 0.164532).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 11 cost time: 0.9994041919708252
Epoch: 11, Steps: 64 | Train Loss: 0.1108977 Vali Loss: 0.1631774 Test Loss: 0.2196365
Validation loss decreased (0.164532 --> 0.163177).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 12 cost time: 1.0023314952850342
Epoch: 12, Steps: 64 | Train Loss: 0.1096870 Vali Loss: 0.1655767 Test Loss: 0.2203511
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 13 cost time: 0.9974002838134766
Epoch: 13, Steps: 64 | Train Loss: 0.1090726 Vali Loss: 0.1627763 Test Loss: 0.2193928
Validation loss decreased (0.163177 --> 0.162776).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 14 cost time: 1.0019447803497314
Epoch: 14, Steps: 64 | Train Loss: 0.1087823 Vali Loss: 0.1619705 Test Loss: 0.2203620
Validation loss decreased (0.162776 --> 0.161971).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 15 cost time: 0.9842538833618164
Epoch: 15, Steps: 64 | Train Loss: 0.1082531 Vali Loss: 0.1610397 Test Loss: 0.2188582
Validation loss decreased (0.161971 --> 0.161040).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 16 cost time: 0.9757916927337646
Epoch: 16, Steps: 64 | Train Loss: 0.1077512 Vali Loss: 0.1610851 Test Loss: 0.2187683
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 17 cost time: 0.9880003929138184
Epoch: 17, Steps: 64 | Train Loss: 0.1071597 Vali Loss: 0.1610745 Test Loss: 0.2198665
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 18 cost time: 0.9776275157928467
Epoch: 18, Steps: 64 | Train Loss: 0.1069436 Vali Loss: 0.1617527 Test Loss: 0.2198365
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 19 cost time: 0.9826138019561768
Epoch: 19, Steps: 64 | Train Loss: 0.1065766 Vali Loss: 0.1599995 Test Loss: 0.2198587
Validation loss decreased (0.161040 --> 0.160000).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 20 cost time: 0.9833660125732422
Epoch: 20, Steps: 64 | Train Loss: 0.1060233 Vali Loss: 0.1597463 Test Loss: 0.2206173
Validation loss decreased (0.160000 --> 0.159746).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 21 cost time: 0.9754936695098877
Epoch: 21, Steps: 64 | Train Loss: 0.1062413 Vali Loss: 0.1590318 Test Loss: 0.2201860
Validation loss decreased (0.159746 --> 0.159032).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 22 cost time: 0.9850499629974365
Epoch: 22, Steps: 64 | Train Loss: 0.1057516 Vali Loss: 0.1583601 Test Loss: 0.2206968
Validation loss decreased (0.159032 --> 0.158360).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 23 cost time: 0.9727804660797119
Epoch: 23, Steps: 64 | Train Loss: 0.1062927 Vali Loss: 0.1603009 Test Loss: 0.2210430
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 24 cost time: 0.9453787803649902
Epoch: 24, Steps: 64 | Train Loss: 0.1057308 Vali Loss: 0.1592673 Test Loss: 0.2198320
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 25 cost time: 0.9604387283325195
Epoch: 25, Steps: 64 | Train Loss: 0.1051728 Vali Loss: 0.1574098 Test Loss: 0.2208294
Validation loss decreased (0.158360 --> 0.157410).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 26 cost time: 0.9703879356384277
Epoch: 26, Steps: 64 | Train Loss: 0.1050266 Vali Loss: 0.1569555 Test Loss: 0.2201878
Validation loss decreased (0.157410 --> 0.156955).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 27 cost time: 0.9820306301116943
Epoch: 27, Steps: 64 | Train Loss: 0.1051374 Vali Loss: 0.1572819 Test Loss: 0.2216955
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 28 cost time: 0.9729974269866943
Epoch: 28, Steps: 64 | Train Loss: 0.1053082 Vali Loss: 0.1584434 Test Loss: 0.2204258
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 29 cost time: 0.9760000705718994
Epoch: 29, Steps: 64 | Train Loss: 0.1044853 Vali Loss: 0.1597127 Test Loss: 0.2203447
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 30 cost time: 0.9916255474090576
Epoch: 30, Steps: 64 | Train Loss: 0.1050470 Vali Loss: 0.1566141 Test Loss: 0.2198253
Validation loss decreased (0.156955 --> 0.156614).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 31 cost time: 0.9706106185913086
Epoch: 31, Steps: 64 | Train Loss: 0.1049178 Vali Loss: 0.1570725 Test Loss: 0.2211278
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 32 cost time: 0.9708676338195801
Epoch: 32, Steps: 64 | Train Loss: 0.1049151 Vali Loss: 0.1582702 Test Loss: 0.2218575
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 33 cost time: 0.9775009155273438
Epoch: 33, Steps: 64 | Train Loss: 0.1047993 Vali Loss: 0.1580915 Test Loss: 0.2202540
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 34 cost time: 0.9759862422943115
Epoch: 34, Steps: 64 | Train Loss: 0.1048379 Vali Loss: 0.1584883 Test Loss: 0.2212020
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 35 cost time: 0.9813332557678223
Epoch: 35, Steps: 64 | Train Loss: 0.1043619 Vali Loss: 0.1581548 Test Loss: 0.2206363
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 36 cost time: 0.9823920726776123
Epoch: 36, Steps: 64 | Train Loss: 0.1042959 Vali Loss: 0.1575226 Test Loss: 0.2196848
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 37 cost time: 0.9978172779083252
Epoch: 37, Steps: 64 | Train Loss: 0.1041918 Vali Loss: 0.1540428 Test Loss: 0.2197546
Validation loss decreased (0.156614 --> 0.154043).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 38 cost time: 0.9821202754974365
Epoch: 38, Steps: 64 | Train Loss: 0.1044919 Vali Loss: 0.1580425 Test Loss: 0.2214340
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 39 cost time: 0.9727516174316406
Epoch: 39, Steps: 64 | Train Loss: 0.1045851 Vali Loss: 0.1570477 Test Loss: 0.2206623
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 40 cost time: 0.9630002975463867
Epoch: 40, Steps: 64 | Train Loss: 0.1046071 Vali Loss: 0.1578956 Test Loss: 0.2202300
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 41 cost time: 0.971625566482544
Epoch: 41, Steps: 64 | Train Loss: 0.1040429 Vali Loss: 0.1580413 Test Loss: 0.2203832
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 42 cost time: 0.9694044589996338
Epoch: 42, Steps: 64 | Train Loss: 0.1041942 Vali Loss: 0.1570604 Test Loss: 0.2201890
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 43 cost time: 0.9793460369110107
Epoch: 43, Steps: 64 | Train Loss: 0.1041484 Vali Loss: 0.1557487 Test Loss: 0.2199045
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 44 cost time: 0.9741816520690918
Epoch: 44, Steps: 64 | Train Loss: 0.1040440 Vali Loss: 0.1576690 Test Loss: 0.2212367
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 45 cost time: 0.9724428653717041
Epoch: 45, Steps: 64 | Train Loss: 0.1041281 Vali Loss: 0.1576860 Test Loss: 0.2209807
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 46 cost time: 0.9740090370178223
Epoch: 46, Steps: 64 | Train Loss: 0.1044689 Vali Loss: 0.1560958 Test Loss: 0.2203369
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 47 cost time: 0.9837980270385742
Epoch: 47, Steps: 64 | Train Loss: 0.1040143 Vali Loss: 0.1561521 Test Loss: 0.2199870
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 48 cost time: 0.9718153476715088
Epoch: 48, Steps: 64 | Train Loss: 0.1043947 Vali Loss: 0.1563941 Test Loss: 0.2207063
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 49 cost time: 0.9717636108398438
Epoch: 49, Steps: 64 | Train Loss: 0.1038080 Vali Loss: 0.1556475 Test Loss: 0.2204344
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 50 cost time: 0.9859805107116699
Epoch: 50, Steps: 64 | Train Loss: 0.1040671 Vali Loss: 0.1550763 Test Loss: 0.2209041
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 51 cost time: 0.9716153144836426
Epoch: 51, Steps: 64 | Train Loss: 0.1041610 Vali Loss: 0.1574846 Test Loss: 0.2203506
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 52 cost time: 0.9736254215240479
Epoch: 52, Steps: 64 | Train Loss: 0.1036757 Vali Loss: 0.1590411 Test Loss: 0.2207247
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 53 cost time: 0.9883644580841064
Epoch: 53, Steps: 64 | Train Loss: 0.1039458 Vali Loss: 0.1566382 Test Loss: 0.2204454
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 54 cost time: 0.9790270328521729
Epoch: 54, Steps: 64 | Train Loss: 0.1043587 Vali Loss: 0.1563889 Test Loss: 0.2204603
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 55 cost time: 0.973379373550415
Epoch: 55, Steps: 64 | Train Loss: 0.1037302 Vali Loss: 0.1560895 Test Loss: 0.2197839
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 56 cost time: 0.9703798294067383
Epoch: 56, Steps: 64 | Train Loss: 0.1041386 Vali Loss: 0.1570024 Test Loss: 0.2213593
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 57 cost time: 0.9733963012695312
Epoch: 57, Steps: 64 | Train Loss: 0.1039440 Vali Loss: 0.1579309 Test Loss: 0.2205459
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 58 cost time: 0.9729654788970947
Epoch: 58, Steps: 64 | Train Loss: 0.1040579 Vali Loss: 0.1542121 Test Loss: 0.2202920
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 59 cost time: 0.9687814712524414
Epoch: 59, Steps: 64 | Train Loss: 0.1041379 Vali Loss: 0.1572361 Test Loss: 0.2211243
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 60 cost time: 0.9887337684631348
Epoch: 60, Steps: 64 | Train Loss: 0.1041275 Vali Loss: 0.1567148 Test Loss: 0.2212722
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.21975459158420563, mae:0.323665052652359, rse:0.23757630586624146
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04583406448364258 GB
Epoch: 1 cost time: 2.3011374473571777
Epoch: 1, Steps: 64 | Train Loss: 1.2684999 Vali Loss: 3.1030011 Test Loss: 4.7422881
Validation loss decreased (inf --> 3.103001).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 2 cost time: 0.927619457244873
Epoch: 2, Steps: 64 | Train Loss: 0.7189981 Vali Loss: 0.7610750 Test Loss: 1.0471368
Validation loss decreased (3.103001 --> 0.761075).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 3 cost time: 0.9429783821105957
Epoch: 3, Steps: 64 | Train Loss: 0.3285465 Vali Loss: 0.4065258 Test Loss: 0.4965365
Validation loss decreased (0.761075 --> 0.406526).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 4 cost time: 0.929863691329956
Epoch: 4, Steps: 64 | Train Loss: 0.2300239 Vali Loss: 0.2853847 Test Loss: 0.3312956
Validation loss decreased (0.406526 --> 0.285385).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 5 cost time: 0.9293866157531738
Epoch: 5, Steps: 64 | Train Loss: 0.1924561 Vali Loss: 0.2349618 Test Loss: 0.2776302
Validation loss decreased (0.285385 --> 0.234962).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 6 cost time: 0.9233953952789307
Epoch: 6, Steps: 64 | Train Loss: 0.1763512 Vali Loss: 0.2129567 Test Loss: 0.2516524
Validation loss decreased (0.234962 --> 0.212957).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 7 cost time: 0.9267575740814209
Epoch: 7, Steps: 64 | Train Loss: 0.1651514 Vali Loss: 0.2019638 Test Loss: 0.2385810
Validation loss decreased (0.212957 --> 0.201964).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 8 cost time: 0.9258067607879639
Epoch: 8, Steps: 64 | Train Loss: 0.1594029 Vali Loss: 0.1943395 Test Loss: 0.2310373
Validation loss decreased (0.201964 --> 0.194340).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 9 cost time: 0.9239997863769531
Epoch: 9, Steps: 64 | Train Loss: 0.1547020 Vali Loss: 0.1882689 Test Loss: 0.2310830
Validation loss decreased (0.194340 --> 0.188269).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 10 cost time: 0.9446108341217041
Epoch: 10, Steps: 64 | Train Loss: 0.1505416 Vali Loss: 0.1867758 Test Loss: 0.2265951
Validation loss decreased (0.188269 --> 0.186776).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 11 cost time: 0.924248456954956
Epoch: 11, Steps: 64 | Train Loss: 0.1475312 Vali Loss: 0.1841619 Test Loss: 0.2257154
Validation loss decreased (0.186776 --> 0.184162).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 12 cost time: 0.9323887825012207
Epoch: 12, Steps: 64 | Train Loss: 0.1455006 Vali Loss: 0.1812384 Test Loss: 0.2233776
Validation loss decreased (0.184162 --> 0.181238).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 13 cost time: 0.9323830604553223
Epoch: 13, Steps: 64 | Train Loss: 0.1425880 Vali Loss: 0.1775601 Test Loss: 0.2220486
Validation loss decreased (0.181238 --> 0.177560).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 14 cost time: 0.9238653182983398
Epoch: 14, Steps: 64 | Train Loss: 0.1411724 Vali Loss: 0.1772233 Test Loss: 0.2226032
Validation loss decreased (0.177560 --> 0.177223).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 15 cost time: 0.9223341941833496
Epoch: 15, Steps: 64 | Train Loss: 0.1398498 Vali Loss: 0.1762939 Test Loss: 0.2213211
Validation loss decreased (0.177223 --> 0.176294).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 16 cost time: 0.9194140434265137
Epoch: 16, Steps: 64 | Train Loss: 0.1382302 Vali Loss: 0.1746647 Test Loss: 0.2200860
Validation loss decreased (0.176294 --> 0.174665).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 17 cost time: 0.9330000877380371
Epoch: 17, Steps: 64 | Train Loss: 0.1373906 Vali Loss: 0.1754240 Test Loss: 0.2202161
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 18 cost time: 0.9230051040649414
Epoch: 18, Steps: 64 | Train Loss: 0.1357486 Vali Loss: 0.1734137 Test Loss: 0.2194572
Validation loss decreased (0.174665 --> 0.173414).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 19 cost time: 0.9323310852050781
Epoch: 19, Steps: 64 | Train Loss: 0.1359472 Vali Loss: 0.1751139 Test Loss: 0.2207049
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 20 cost time: 0.9333784580230713
Epoch: 20, Steps: 64 | Train Loss: 0.1353845 Vali Loss: 0.1732347 Test Loss: 0.2194417
Validation loss decreased (0.173414 --> 0.173235).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 21 cost time: 0.9303915500640869
Epoch: 21, Steps: 64 | Train Loss: 0.1334492 Vali Loss: 0.1717649 Test Loss: 0.2191540
Validation loss decreased (0.173235 --> 0.171765).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 22 cost time: 0.9233593940734863
Epoch: 22, Steps: 64 | Train Loss: 0.1337337 Vali Loss: 0.1721164 Test Loss: 0.2191917
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 23 cost time: 0.9253816604614258
Epoch: 23, Steps: 64 | Train Loss: 0.1325551 Vali Loss: 0.1730264 Test Loss: 0.2192893
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 24 cost time: 0.9093618392944336
Epoch: 24, Steps: 64 | Train Loss: 0.1325892 Vali Loss: 0.1717845 Test Loss: 0.2194387
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 25 cost time: 0.916337251663208
Epoch: 25, Steps: 64 | Train Loss: 0.1314365 Vali Loss: 0.1703904 Test Loss: 0.2184497
Validation loss decreased (0.171765 --> 0.170390).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 26 cost time: 0.9226162433624268
Epoch: 26, Steps: 64 | Train Loss: 0.1315910 Vali Loss: 0.1706233 Test Loss: 0.2196468
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 27 cost time: 0.9295156002044678
Epoch: 27, Steps: 64 | Train Loss: 0.1312800 Vali Loss: 0.1707459 Test Loss: 0.2179398
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 28 cost time: 0.924964189529419
Epoch: 28, Steps: 64 | Train Loss: 0.1312643 Vali Loss: 0.1687091 Test Loss: 0.2181430
Validation loss decreased (0.170390 --> 0.168709).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 29 cost time: 0.9304168224334717
Epoch: 29, Steps: 64 | Train Loss: 0.1301644 Vali Loss: 0.1710477 Test Loss: 0.2192623
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 30 cost time: 0.9273934364318848
Epoch: 30, Steps: 64 | Train Loss: 0.1300038 Vali Loss: 0.1687997 Test Loss: 0.2187267
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 31 cost time: 0.9218051433563232
Epoch: 31, Steps: 64 | Train Loss: 0.1297432 Vali Loss: 0.1696900 Test Loss: 0.2184099
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 32 cost time: 0.9227306842803955
Epoch: 32, Steps: 64 | Train Loss: 0.1298283 Vali Loss: 0.1705854 Test Loss: 0.2185111
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 33 cost time: 0.9186172485351562
Epoch: 33, Steps: 64 | Train Loss: 0.1289693 Vali Loss: 0.1689296 Test Loss: 0.2177691
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 34 cost time: 0.9303319454193115
Epoch: 34, Steps: 64 | Train Loss: 0.1295338 Vali Loss: 0.1689500 Test Loss: 0.2182934
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 35 cost time: 0.9713926315307617
Epoch: 35, Steps: 64 | Train Loss: 0.1299284 Vali Loss: 0.1689431 Test Loss: 0.2181185
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 36 cost time: 0.939349889755249
Epoch: 36, Steps: 64 | Train Loss: 0.1294736 Vali Loss: 0.1674644 Test Loss: 0.2183876
Validation loss decreased (0.168709 --> 0.167464).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 37 cost time: 0.9229946136474609
Epoch: 37, Steps: 64 | Train Loss: 0.1298921 Vali Loss: 0.1685065 Test Loss: 0.2179012
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 38 cost time: 0.9303429126739502
Epoch: 38, Steps: 64 | Train Loss: 0.1289732 Vali Loss: 0.1682735 Test Loss: 0.2183062
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 39 cost time: 0.9247386455535889
Epoch: 39, Steps: 64 | Train Loss: 0.1282034 Vali Loss: 0.1696950 Test Loss: 0.2180103
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 40 cost time: 0.9229984283447266
Epoch: 40, Steps: 64 | Train Loss: 0.1286000 Vali Loss: 0.1700116 Test Loss: 0.2183747
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 41 cost time: 0.9380574226379395
Epoch: 41, Steps: 64 | Train Loss: 0.1286757 Vali Loss: 0.1678354 Test Loss: 0.2184887
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 42 cost time: 0.9223620891571045
Epoch: 42, Steps: 64 | Train Loss: 0.1282269 Vali Loss: 0.1690212 Test Loss: 0.2183860
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 43 cost time: 0.9193587303161621
Epoch: 43, Steps: 64 | Train Loss: 0.1289804 Vali Loss: 0.1677105 Test Loss: 0.2177320
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 44 cost time: 0.923358678817749
Epoch: 44, Steps: 64 | Train Loss: 0.1283521 Vali Loss: 0.1670421 Test Loss: 0.2192912
Validation loss decreased (0.167464 --> 0.167042).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 45 cost time: 0.911283016204834
Epoch: 45, Steps: 64 | Train Loss: 0.1276811 Vali Loss: 0.1689132 Test Loss: 0.2191465
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 46 cost time: 0.9007360935211182
Epoch: 46, Steps: 64 | Train Loss: 0.1286772 Vali Loss: 0.1680116 Test Loss: 0.2186449
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 47 cost time: 0.929999589920044
Epoch: 47, Steps: 64 | Train Loss: 0.1283999 Vali Loss: 0.1683809 Test Loss: 0.2183537
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 48 cost time: 0.9230000972747803
Epoch: 48, Steps: 64 | Train Loss: 0.1277518 Vali Loss: 0.1667129 Test Loss: 0.2178951
Validation loss decreased (0.167042 --> 0.166713).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 49 cost time: 0.9213864803314209
Epoch: 49, Steps: 64 | Train Loss: 0.1283397 Vali Loss: 0.1668268 Test Loss: 0.2182651
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 50 cost time: 0.9213621616363525
Epoch: 50, Steps: 64 | Train Loss: 0.1280596 Vali Loss: 0.1687438 Test Loss: 0.2177903
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 51 cost time: 0.9303524494171143
Epoch: 51, Steps: 64 | Train Loss: 0.1283120 Vali Loss: 0.1672395 Test Loss: 0.2175901
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 52 cost time: 0.9281847476959229
Epoch: 52, Steps: 64 | Train Loss: 0.1281217 Vali Loss: 0.1676554 Test Loss: 0.2174525
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 53 cost time: 0.9214277267456055
Epoch: 53, Steps: 64 | Train Loss: 0.1282754 Vali Loss: 0.1688508 Test Loss: 0.2178726
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 54 cost time: 0.9264044761657715
Epoch: 54, Steps: 64 | Train Loss: 0.1286278 Vali Loss: 0.1672124 Test Loss: 0.2173014
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 55 cost time: 0.94100022315979
Epoch: 55, Steps: 64 | Train Loss: 0.1276618 Vali Loss: 0.1682110 Test Loss: 0.2183272
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 56 cost time: 0.9276261329650879
Epoch: 56, Steps: 64 | Train Loss: 0.1282210 Vali Loss: 0.1699869 Test Loss: 0.2189737
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 57 cost time: 0.9276371002197266
Epoch: 57, Steps: 64 | Train Loss: 0.1279840 Vali Loss: 0.1683637 Test Loss: 0.2181971
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 58 cost time: 0.9364762306213379
Epoch: 58, Steps: 64 | Train Loss: 0.1282369 Vali Loss: 0.1679771 Test Loss: 0.2178033
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 59 cost time: 0.9204089641571045
Epoch: 59, Steps: 64 | Train Loss: 0.1279019 Vali Loss: 0.1687416 Test Loss: 0.2177517
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 60 cost time: 0.9233524799346924
Epoch: 60, Steps: 64 | Train Loss: 0.1287944 Vali Loss: 0.1675901 Test Loss: 0.2179724
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.21789507567882538, mae:0.31809088587760925, rse:0.23656901717185974
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.04726600646972656 GB
Epoch: 1 cost time: 2.333991289138794
Epoch: 1, Steps: 64 | Train Loss: 0.9400310 Vali Loss: 2.4359362 Test Loss: 3.8790770
Validation loss decreased (inf --> 2.435936).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 2 cost time: 0.9489264488220215
Epoch: 2, Steps: 64 | Train Loss: 0.5511764 Vali Loss: 0.5516724 Test Loss: 0.7660140
Validation loss decreased (2.435936 --> 0.551672).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 3 cost time: 0.9614095687866211
Epoch: 3, Steps: 64 | Train Loss: 0.1902679 Vali Loss: 0.2152591 Test Loss: 0.2438683
Validation loss decreased (0.551672 --> 0.215259).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 4 cost time: 0.9559996128082275
Epoch: 4, Steps: 64 | Train Loss: 0.1403736 Vali Loss: 0.1842831 Test Loss: 0.2297943
Validation loss decreased (0.215259 --> 0.184283).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 5 cost time: 0.9496204853057861
Epoch: 5, Steps: 64 | Train Loss: 0.1299731 Vali Loss: 0.1819240 Test Loss: 0.2240066
Validation loss decreased (0.184283 --> 0.181924).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 6 cost time: 0.9523699283599854
Epoch: 6, Steps: 64 | Train Loss: 0.1249089 Vali Loss: 0.1750618 Test Loss: 0.2228951
Validation loss decreased (0.181924 --> 0.175062).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 7 cost time: 0.9514045715332031
Epoch: 7, Steps: 64 | Train Loss: 0.1213221 Vali Loss: 0.1727075 Test Loss: 0.2195059
Validation loss decreased (0.175062 --> 0.172707).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 8 cost time: 0.9565408229827881
Epoch: 8, Steps: 64 | Train Loss: 0.1188228 Vali Loss: 0.1698370 Test Loss: 0.2195793
Validation loss decreased (0.172707 --> 0.169837).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 9 cost time: 0.9443967342376709
Epoch: 9, Steps: 64 | Train Loss: 0.1162659 Vali Loss: 0.1687897 Test Loss: 0.2189195
Validation loss decreased (0.169837 --> 0.168790).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 10 cost time: 0.9653458595275879
Epoch: 10, Steps: 64 | Train Loss: 0.1147487 Vali Loss: 0.1679912 Test Loss: 0.2215532
Validation loss decreased (0.168790 --> 0.167991).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 11 cost time: 0.9628696441650391
Epoch: 11, Steps: 64 | Train Loss: 0.1129634 Vali Loss: 0.1623925 Test Loss: 0.2204171
Validation loss decreased (0.167991 --> 0.162392).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 12 cost time: 0.9647490978240967
Epoch: 12, Steps: 64 | Train Loss: 0.1119429 Vali Loss: 0.1638903 Test Loss: 0.2206526
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 13 cost time: 0.9600019454956055
Epoch: 13, Steps: 64 | Train Loss: 0.1108356 Vali Loss: 0.1630723 Test Loss: 0.2202748
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 14 cost time: 0.9529991149902344
Epoch: 14, Steps: 64 | Train Loss: 0.1098597 Vali Loss: 0.1611371 Test Loss: 0.2207941
Validation loss decreased (0.162392 --> 0.161137).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 15 cost time: 0.9646246433258057
Epoch: 15, Steps: 64 | Train Loss: 0.1091230 Vali Loss: 0.1615589 Test Loss: 0.2201249
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 16 cost time: 0.9542455673217773
Epoch: 16, Steps: 64 | Train Loss: 0.1088508 Vali Loss: 0.1621013 Test Loss: 0.2205630
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 17 cost time: 0.9473905563354492
Epoch: 17, Steps: 64 | Train Loss: 0.1084354 Vali Loss: 0.1586889 Test Loss: 0.2197476
Validation loss decreased (0.161137 --> 0.158689).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 18 cost time: 0.9664201736450195
Epoch: 18, Steps: 64 | Train Loss: 0.1074803 Vali Loss: 0.1589165 Test Loss: 0.2207077
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 19 cost time: 0.9633963108062744
Epoch: 19, Steps: 64 | Train Loss: 0.1072062 Vali Loss: 0.1595772 Test Loss: 0.2212005
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 20 cost time: 0.9540259838104248
Epoch: 20, Steps: 64 | Train Loss: 0.1066264 Vali Loss: 0.1566740 Test Loss: 0.2209698
Validation loss decreased (0.158689 --> 0.156674).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 21 cost time: 0.9627223014831543
Epoch: 21, Steps: 64 | Train Loss: 0.1065923 Vali Loss: 0.1567657 Test Loss: 0.2212210
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 22 cost time: 0.9460597038269043
Epoch: 22, Steps: 64 | Train Loss: 0.1059026 Vali Loss: 0.1566529 Test Loss: 0.2217336
Validation loss decreased (0.156674 --> 0.156653).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 23 cost time: 0.9280025959014893
Epoch: 23, Steps: 64 | Train Loss: 0.1050672 Vali Loss: 0.1565223 Test Loss: 0.2209326
Validation loss decreased (0.156653 --> 0.156522).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 24 cost time: 0.9436116218566895
Epoch: 24, Steps: 64 | Train Loss: 0.1053928 Vali Loss: 0.1562548 Test Loss: 0.2221138
Validation loss decreased (0.156522 --> 0.156255).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 25 cost time: 0.9673736095428467
Epoch: 25, Steps: 64 | Train Loss: 0.1050894 Vali Loss: 0.1573898 Test Loss: 0.2217668
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 26 cost time: 0.9554004669189453
Epoch: 26, Steps: 64 | Train Loss: 0.1045652 Vali Loss: 0.1547987 Test Loss: 0.2202939
Validation loss decreased (0.156255 --> 0.154799).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 27 cost time: 0.9543638229370117
Epoch: 27, Steps: 64 | Train Loss: 0.1049738 Vali Loss: 0.1541502 Test Loss: 0.2226388
Validation loss decreased (0.154799 --> 0.154150).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 28 cost time: 0.9709343910217285
Epoch: 28, Steps: 64 | Train Loss: 0.1042734 Vali Loss: 0.1556899 Test Loss: 0.2205443
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 29 cost time: 0.9643898010253906
Epoch: 29, Steps: 64 | Train Loss: 0.1039445 Vali Loss: 0.1553082 Test Loss: 0.2235658
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 30 cost time: 0.9543325901031494
Epoch: 30, Steps: 64 | Train Loss: 0.1039133 Vali Loss: 0.1556049 Test Loss: 0.2225911
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 31 cost time: 0.9577488899230957
Epoch: 31, Steps: 64 | Train Loss: 0.1042141 Vali Loss: 0.1555848 Test Loss: 0.2232496
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 32 cost time: 0.966864824295044
Epoch: 32, Steps: 64 | Train Loss: 0.1038498 Vali Loss: 0.1562782 Test Loss: 0.2214279
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 33 cost time: 0.947655439376831
Epoch: 33, Steps: 64 | Train Loss: 0.1040551 Vali Loss: 0.1551820 Test Loss: 0.2232302
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 34 cost time: 0.9496238231658936
Epoch: 34, Steps: 64 | Train Loss: 0.1034664 Vali Loss: 0.1549256 Test Loss: 0.2225106
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 35 cost time: 0.9744820594787598
Epoch: 35, Steps: 64 | Train Loss: 0.1037267 Vali Loss: 0.1546469 Test Loss: 0.2222916
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 36 cost time: 0.9560608863830566
Epoch: 36, Steps: 64 | Train Loss: 0.1033013 Vali Loss: 0.1529504 Test Loss: 0.2218132
Validation loss decreased (0.154150 --> 0.152950).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 37 cost time: 0.9624021053314209
Epoch: 37, Steps: 64 | Train Loss: 0.1039015 Vali Loss: 0.1553642 Test Loss: 0.2228440
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 38 cost time: 0.9653375148773193
Epoch: 38, Steps: 64 | Train Loss: 0.1032632 Vali Loss: 0.1536366 Test Loss: 0.2228841
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 39 cost time: 0.9530367851257324
Epoch: 39, Steps: 64 | Train Loss: 0.1033032 Vali Loss: 0.1543593 Test Loss: 0.2221102
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 40 cost time: 0.9537203311920166
Epoch: 40, Steps: 64 | Train Loss: 0.1029884 Vali Loss: 0.1546175 Test Loss: 0.2219462
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 41 cost time: 0.9509999752044678
Epoch: 41, Steps: 64 | Train Loss: 0.1033139 Vali Loss: 0.1538054 Test Loss: 0.2220020
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 42 cost time: 0.9340007305145264
Epoch: 42, Steps: 64 | Train Loss: 0.1029959 Vali Loss: 0.1541516 Test Loss: 0.2222668
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 43 cost time: 0.9546303749084473
Epoch: 43, Steps: 64 | Train Loss: 0.1022929 Vali Loss: 0.1542025 Test Loss: 0.2226672
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 44 cost time: 0.9581131935119629
Epoch: 44, Steps: 64 | Train Loss: 0.1031698 Vali Loss: 0.1539121 Test Loss: 0.2213701
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 45 cost time: 0.9663472175598145
Epoch: 45, Steps: 64 | Train Loss: 0.1030312 Vali Loss: 0.1528256 Test Loss: 0.2216034
Validation loss decreased (0.152950 --> 0.152826).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 46 cost time: 0.9563860893249512
Epoch: 46, Steps: 64 | Train Loss: 0.1033690 Vali Loss: 0.1535679 Test Loss: 0.2209672
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 47 cost time: 0.956352710723877
Epoch: 47, Steps: 64 | Train Loss: 0.1030689 Vali Loss: 0.1543756 Test Loss: 0.2228416
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 48 cost time: 0.9513230323791504
Epoch: 48, Steps: 64 | Train Loss: 0.1031548 Vali Loss: 0.1539909 Test Loss: 0.2218667
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 49 cost time: 0.9233095645904541
Epoch: 49, Steps: 64 | Train Loss: 0.1030478 Vali Loss: 0.1535148 Test Loss: 0.2220720
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 50 cost time: 0.9651808738708496
Epoch: 50, Steps: 64 | Train Loss: 0.1031420 Vali Loss: 0.1547255 Test Loss: 0.2221885
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 51 cost time: 0.9760274887084961
Epoch: 51, Steps: 64 | Train Loss: 0.1028964 Vali Loss: 0.1527852 Test Loss: 0.2214400
Validation loss decreased (0.152826 --> 0.152785).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 52 cost time: 0.991591215133667
Epoch: 52, Steps: 64 | Train Loss: 0.1031207 Vali Loss: 0.1544208 Test Loss: 0.2220850
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 53 cost time: 0.995603084564209
Epoch: 53, Steps: 64 | Train Loss: 0.1029445 Vali Loss: 0.1532916 Test Loss: 0.2209807
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 54 cost time: 0.9572234153747559
Epoch: 54, Steps: 64 | Train Loss: 0.1028947 Vali Loss: 0.1536239 Test Loss: 0.2224077
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 55 cost time: 0.9947509765625
Epoch: 55, Steps: 64 | Train Loss: 0.1027868 Vali Loss: 0.1543191 Test Loss: 0.2218164
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 56 cost time: 0.9655375480651855
Epoch: 56, Steps: 64 | Train Loss: 0.1032086 Vali Loss: 0.1547671 Test Loss: 0.2220981
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 57 cost time: 0.9585239887237549
Epoch: 57, Steps: 64 | Train Loss: 0.1027069 Vali Loss: 0.1543924 Test Loss: 0.2231485
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 58 cost time: 0.973423957824707
Epoch: 58, Steps: 64 | Train Loss: 0.1027826 Vali Loss: 0.1541355 Test Loss: 0.2222498
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 59 cost time: 0.9596774578094482
Epoch: 59, Steps: 64 | Train Loss: 0.1024845 Vali Loss: 0.1532300 Test Loss: 0.2216533
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 60 cost time: 0.9718079566955566
Epoch: 60, Steps: 64 | Train Loss: 0.1034721 Vali Loss: 0.1539414 Test Loss: 0.2228059
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22144003212451935, mae:0.32406505942344666, rse:0.23848561942577362
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.0483860969543457 GB
Epoch: 1 cost time: 2.4372646808624268
Epoch: 1, Steps: 64 | Train Loss: 0.8026887 Vali Loss: 2.1368082 Test Loss: 3.3806353
Validation loss decreased (inf --> 2.136808).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 2 cost time: 0.9798460006713867
Epoch: 2, Steps: 64 | Train Loss: 0.4801725 Vali Loss: 0.4484087 Test Loss: 0.5589345
Validation loss decreased (2.136808 --> 0.448409).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 3 cost time: 0.9960007667541504
Epoch: 3, Steps: 64 | Train Loss: 0.1654573 Vali Loss: 0.2130076 Test Loss: 0.2285786
Validation loss decreased (0.448409 --> 0.213008).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 4 cost time: 0.9846000671386719
Epoch: 4, Steps: 64 | Train Loss: 0.1319615 Vali Loss: 0.1840933 Test Loss: 0.2201363
Validation loss decreased (0.213008 --> 0.184093).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 5 cost time: 0.9910054206848145
Epoch: 5, Steps: 64 | Train Loss: 0.1242086 Vali Loss: 0.1797581 Test Loss: 0.2180460
Validation loss decreased (0.184093 --> 0.179758).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 6 cost time: 0.981360912322998
Epoch: 6, Steps: 64 | Train Loss: 0.1202157 Vali Loss: 0.1740259 Test Loss: 0.2188129
Validation loss decreased (0.179758 --> 0.174026).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 7 cost time: 0.9794125556945801
Epoch: 7, Steps: 64 | Train Loss: 0.1171356 Vali Loss: 0.1688451 Test Loss: 0.2182465
Validation loss decreased (0.174026 --> 0.168845).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 8 cost time: 0.9794089794158936
Epoch: 8, Steps: 64 | Train Loss: 0.1155780 Vali Loss: 0.1660701 Test Loss: 0.2169998
Validation loss decreased (0.168845 --> 0.166070).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 9 cost time: 0.9788227081298828
Epoch: 9, Steps: 64 | Train Loss: 0.1139150 Vali Loss: 0.1675465 Test Loss: 0.2172011
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 10 cost time: 0.9893507957458496
Epoch: 10, Steps: 64 | Train Loss: 0.1122693 Vali Loss: 0.1627533 Test Loss: 0.2155509
Validation loss decreased (0.166070 --> 0.162753).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 11 cost time: 1.0023329257965088
Epoch: 11, Steps: 64 | Train Loss: 0.1113753 Vali Loss: 0.1617233 Test Loss: 0.2157172
Validation loss decreased (0.162753 --> 0.161723).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 12 cost time: 0.9913244247436523
Epoch: 12, Steps: 64 | Train Loss: 0.1103777 Vali Loss: 0.1612618 Test Loss: 0.2162599
Validation loss decreased (0.161723 --> 0.161262).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 13 cost time: 0.9903841018676758
Epoch: 13, Steps: 64 | Train Loss: 0.1096529 Vali Loss: 0.1596516 Test Loss: 0.2160348
Validation loss decreased (0.161262 --> 0.159652).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 14 cost time: 0.9787404537200928
Epoch: 14, Steps: 64 | Train Loss: 0.1088892 Vali Loss: 0.1586465 Test Loss: 0.2170997
Validation loss decreased (0.159652 --> 0.158646).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 15 cost time: 0.9827320575714111
Epoch: 15, Steps: 64 | Train Loss: 0.1082736 Vali Loss: 0.1575102 Test Loss: 0.2158983
Validation loss decreased (0.158646 --> 0.157510).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 16 cost time: 0.9923586845397949
Epoch: 16, Steps: 64 | Train Loss: 0.1074533 Vali Loss: 0.1586169 Test Loss: 0.2176152
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 17 cost time: 0.9847691059112549
Epoch: 17, Steps: 64 | Train Loss: 0.1071853 Vali Loss: 0.1577674 Test Loss: 0.2174070
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 18 cost time: 1.0099809169769287
Epoch: 18, Steps: 64 | Train Loss: 0.1070174 Vali Loss: 0.1573373 Test Loss: 0.2170784
Validation loss decreased (0.157510 --> 0.157337).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 19 cost time: 1.0025901794433594
Epoch: 19, Steps: 64 | Train Loss: 0.1070409 Vali Loss: 0.1576480 Test Loss: 0.2170337
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 20 cost time: 1.0053911209106445
Epoch: 20, Steps: 64 | Train Loss: 0.1064579 Vali Loss: 0.1540567 Test Loss: 0.2166730
Validation loss decreased (0.157337 --> 0.154057).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 21 cost time: 0.9943909645080566
Epoch: 21, Steps: 64 | Train Loss: 0.1057618 Vali Loss: 0.1569301 Test Loss: 0.2172202
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 22 cost time: 0.9854035377502441
Epoch: 22, Steps: 64 | Train Loss: 0.1054462 Vali Loss: 0.1540354 Test Loss: 0.2166756
Validation loss decreased (0.154057 --> 0.154035).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 23 cost time: 0.9973514080047607
Epoch: 23, Steps: 64 | Train Loss: 0.1054241 Vali Loss: 0.1540513 Test Loss: 0.2176725
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 24 cost time: 0.988349437713623
Epoch: 24, Steps: 64 | Train Loss: 0.1057376 Vali Loss: 0.1531282 Test Loss: 0.2171296
Validation loss decreased (0.154035 --> 0.153128).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 25 cost time: 0.9933962821960449
Epoch: 25, Steps: 64 | Train Loss: 0.1050963 Vali Loss: 0.1545587 Test Loss: 0.2172532
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 26 cost time: 0.9993042945861816
Epoch: 26, Steps: 64 | Train Loss: 0.1051956 Vali Loss: 0.1541139 Test Loss: 0.2184917
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 27 cost time: 1.0103623867034912
Epoch: 27, Steps: 64 | Train Loss: 0.1049792 Vali Loss: 0.1533435 Test Loss: 0.2168873
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 28 cost time: 1.0028629302978516
Epoch: 28, Steps: 64 | Train Loss: 0.1047708 Vali Loss: 0.1527149 Test Loss: 0.2169769
Validation loss decreased (0.153128 --> 0.152715).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 29 cost time: 1.0017411708831787
Epoch: 29, Steps: 64 | Train Loss: 0.1047429 Vali Loss: 0.1526763 Test Loss: 0.2168938
Validation loss decreased (0.152715 --> 0.152676).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 30 cost time: 0.9987144470214844
Epoch: 30, Steps: 64 | Train Loss: 0.1046903 Vali Loss: 0.1535866 Test Loss: 0.2169739
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 31 cost time: 0.9775872230529785
Epoch: 31, Steps: 64 | Train Loss: 0.1046567 Vali Loss: 0.1535718 Test Loss: 0.2173828
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 32 cost time: 0.9736168384552002
Epoch: 32, Steps: 64 | Train Loss: 0.1041469 Vali Loss: 0.1516821 Test Loss: 0.2167073
Validation loss decreased (0.152676 --> 0.151682).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 33 cost time: 0.9749810695648193
Epoch: 33, Steps: 64 | Train Loss: 0.1041726 Vali Loss: 0.1527821 Test Loss: 0.2178970
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 34 cost time: 0.9854676723480225
Epoch: 34, Steps: 64 | Train Loss: 0.1039997 Vali Loss: 0.1539354 Test Loss: 0.2179108
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 35 cost time: 0.987921953201294
Epoch: 35, Steps: 64 | Train Loss: 0.1037962 Vali Loss: 0.1516493 Test Loss: 0.2173644
Validation loss decreased (0.151682 --> 0.151649).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 36 cost time: 0.9823691844940186
Epoch: 36, Steps: 64 | Train Loss: 0.1040254 Vali Loss: 0.1542299 Test Loss: 0.2171302
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 37 cost time: 0.989391565322876
Epoch: 37, Steps: 64 | Train Loss: 0.1040002 Vali Loss: 0.1527865 Test Loss: 0.2179317
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 38 cost time: 0.976384162902832
Epoch: 38, Steps: 64 | Train Loss: 0.1041834 Vali Loss: 0.1537933 Test Loss: 0.2176796
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 39 cost time: 0.9703655242919922
Epoch: 39, Steps: 64 | Train Loss: 0.1037131 Vali Loss: 0.1526304 Test Loss: 0.2170776
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 40 cost time: 0.9897193908691406
Epoch: 40, Steps: 64 | Train Loss: 0.1034582 Vali Loss: 0.1528223 Test Loss: 0.2175236
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 41 cost time: 0.9727826118469238
Epoch: 41, Steps: 64 | Train Loss: 0.1039855 Vali Loss: 0.1508202 Test Loss: 0.2172443
Validation loss decreased (0.151649 --> 0.150820).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 42 cost time: 0.9720001220703125
Epoch: 42, Steps: 64 | Train Loss: 0.1036389 Vali Loss: 0.1527398 Test Loss: 0.2177695
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 43 cost time: 0.9796433448791504
Epoch: 43, Steps: 64 | Train Loss: 0.1034100 Vali Loss: 0.1519748 Test Loss: 0.2177556
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 44 cost time: 0.98557448387146
Epoch: 44, Steps: 64 | Train Loss: 0.1031921 Vali Loss: 0.1534283 Test Loss: 0.2173866
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 45 cost time: 0.9747922420501709
Epoch: 45, Steps: 64 | Train Loss: 0.1038080 Vali Loss: 0.1514780 Test Loss: 0.2170401
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 46 cost time: 0.9813361167907715
Epoch: 46, Steps: 64 | Train Loss: 0.1033063 Vali Loss: 0.1531050 Test Loss: 0.2179763
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 47 cost time: 0.9614248275756836
Epoch: 47, Steps: 64 | Train Loss: 0.1029302 Vali Loss: 0.1527244 Test Loss: 0.2176503
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 48 cost time: 0.9733998775482178
Epoch: 48, Steps: 64 | Train Loss: 0.1034348 Vali Loss: 0.1515844 Test Loss: 0.2176931
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 49 cost time: 0.9724273681640625
Epoch: 49, Steps: 64 | Train Loss: 0.1030343 Vali Loss: 0.1535520 Test Loss: 0.2171277
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 50 cost time: 0.984342098236084
Epoch: 50, Steps: 64 | Train Loss: 0.1036156 Vali Loss: 0.1530346 Test Loss: 0.2194899
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 51 cost time: 0.9737505912780762
Epoch: 51, Steps: 64 | Train Loss: 0.1034535 Vali Loss: 0.1508345 Test Loss: 0.2170603
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 52 cost time: 0.9791808128356934
Epoch: 52, Steps: 64 | Train Loss: 0.1032152 Vali Loss: 0.1495741 Test Loss: 0.2175644
Validation loss decreased (0.150820 --> 0.149574).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 53 cost time: 0.9739999771118164
Epoch: 53, Steps: 64 | Train Loss: 0.1035179 Vali Loss: 0.1520616 Test Loss: 0.2181878
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 54 cost time: 0.9876275062561035
Epoch: 54, Steps: 64 | Train Loss: 0.1037289 Vali Loss: 0.1506964 Test Loss: 0.2174521
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 55 cost time: 0.9756278991699219
Epoch: 55, Steps: 64 | Train Loss: 0.1037894 Vali Loss: 0.1501654 Test Loss: 0.2167578
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 56 cost time: 0.9733994007110596
Epoch: 56, Steps: 64 | Train Loss: 0.1032662 Vali Loss: 0.1507307 Test Loss: 0.2172682
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 57 cost time: 0.9833660125732422
Epoch: 57, Steps: 64 | Train Loss: 0.1031253 Vali Loss: 0.1527871 Test Loss: 0.2184862
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 58 cost time: 0.9739880561828613
Epoch: 58, Steps: 64 | Train Loss: 0.1033292 Vali Loss: 0.1522275 Test Loss: 0.2171310
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 59 cost time: 0.9713864326477051
Epoch: 59, Steps: 64 | Train Loss: 0.1034351 Vali Loss: 0.1520291 Test Loss: 0.2172748
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 60 cost time: 0.9844026565551758
Epoch: 60, Steps: 64 | Train Loss: 0.1035585 Vali Loss: 0.1522669 Test Loss: 0.2181453
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.21756434440612793, mae:0.31335440278053284, rse:0.2363893985748291
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049146175384521484 GB
Epoch: 1 cost time: 2.2770676612854004
Epoch: 1, Steps: 64 | Train Loss: 1.5392811 Vali Loss: 3.7592010 Test Loss: 6.1893349
Validation loss decreased (inf --> 3.759201).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 2 cost time: 0.8964378833770752
Epoch: 2, Steps: 64 | Train Loss: 1.0492084 Vali Loss: 1.3462808 Test Loss: 2.1294329
Validation loss decreased (3.759201 --> 1.346281).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 3 cost time: 0.8914930820465088
Epoch: 3, Steps: 64 | Train Loss: 0.4680848 Vali Loss: 0.5221083 Test Loss: 0.7186160
Validation loss decreased (1.346281 --> 0.522108).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 4 cost time: 0.8966143131256104
Epoch: 4, Steps: 64 | Train Loss: 0.2794992 Vali Loss: 0.3291577 Test Loss: 0.4258225
Validation loss decreased (0.522108 --> 0.329158).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 5 cost time: 0.8913938999176025
Epoch: 5, Steps: 64 | Train Loss: 0.2202913 Vali Loss: 0.2605488 Test Loss: 0.3369571
Validation loss decreased (0.329158 --> 0.260549).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 6 cost time: 0.8937346935272217
Epoch: 6, Steps: 64 | Train Loss: 0.1965094 Vali Loss: 0.2267898 Test Loss: 0.2936373
Validation loss decreased (0.260549 --> 0.226790).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 7 cost time: 0.896049976348877
Epoch: 7, Steps: 64 | Train Loss: 0.1831578 Vali Loss: 0.2084900 Test Loss: 0.2685299
Validation loss decreased (0.226790 --> 0.208490).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 8 cost time: 0.8887529373168945
Epoch: 8, Steps: 64 | Train Loss: 0.1739298 Vali Loss: 0.1972182 Test Loss: 0.2574832
Validation loss decreased (0.208490 --> 0.197218).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 9 cost time: 0.8920001983642578
Epoch: 9, Steps: 64 | Train Loss: 0.1689891 Vali Loss: 0.1908420 Test Loss: 0.2513568
Validation loss decreased (0.197218 --> 0.190842).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 10 cost time: 0.8926451206207275
Epoch: 10, Steps: 64 | Train Loss: 0.1644602 Vali Loss: 0.1876762 Test Loss: 0.2459562
Validation loss decreased (0.190842 --> 0.187676).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 11 cost time: 0.9106082916259766
Epoch: 11, Steps: 64 | Train Loss: 0.1604299 Vali Loss: 0.1843326 Test Loss: 0.2425629
Validation loss decreased (0.187676 --> 0.184333).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 12 cost time: 0.9018990993499756
Epoch: 12, Steps: 64 | Train Loss: 0.1578969 Vali Loss: 0.1824407 Test Loss: 0.2406770
Validation loss decreased (0.184333 --> 0.182441).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 13 cost time: 0.895392894744873
Epoch: 13, Steps: 64 | Train Loss: 0.1551022 Vali Loss: 0.1822472 Test Loss: 0.2395033
Validation loss decreased (0.182441 --> 0.182247).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 14 cost time: 0.9032142162322998
Epoch: 14, Steps: 64 | Train Loss: 0.1535604 Vali Loss: 0.1787989 Test Loss: 0.2389737
Validation loss decreased (0.182247 --> 0.178799).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 15 cost time: 0.8919999599456787
Epoch: 15, Steps: 64 | Train Loss: 0.1521138 Vali Loss: 0.1768127 Test Loss: 0.2372352
Validation loss decreased (0.178799 --> 0.176813).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 16 cost time: 0.8902273178100586
Epoch: 16, Steps: 64 | Train Loss: 0.1503980 Vali Loss: 0.1784933 Test Loss: 0.2374700
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 17 cost time: 0.8914237022399902
Epoch: 17, Steps: 64 | Train Loss: 0.1500457 Vali Loss: 0.1758229 Test Loss: 0.2365488
Validation loss decreased (0.176813 --> 0.175823).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 18 cost time: 0.9054827690124512
Epoch: 18, Steps: 64 | Train Loss: 0.1475541 Vali Loss: 0.1749029 Test Loss: 0.2350900
Validation loss decreased (0.175823 --> 0.174903).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 19 cost time: 0.8924572467803955
Epoch: 19, Steps: 64 | Train Loss: 0.1461597 Vali Loss: 0.1735601 Test Loss: 0.2335737
Validation loss decreased (0.174903 --> 0.173560).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 20 cost time: 0.8947618007659912
Epoch: 20, Steps: 64 | Train Loss: 0.1455145 Vali Loss: 0.1732965 Test Loss: 0.2350482
Validation loss decreased (0.173560 --> 0.173297).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 21 cost time: 0.8919999599456787
Epoch: 21, Steps: 64 | Train Loss: 0.1448877 Vali Loss: 0.1726576 Test Loss: 0.2334757
Validation loss decreased (0.173297 --> 0.172658).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 22 cost time: 0.8897335529327393
Epoch: 22, Steps: 64 | Train Loss: 0.1442234 Vali Loss: 0.1738263 Test Loss: 0.2350071
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 23 cost time: 0.8896162509918213
Epoch: 23, Steps: 64 | Train Loss: 0.1432887 Vali Loss: 0.1720269 Test Loss: 0.2340903
Validation loss decreased (0.172658 --> 0.172027).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 24 cost time: 0.8894319534301758
Epoch: 24, Steps: 64 | Train Loss: 0.1431125 Vali Loss: 0.1733102 Test Loss: 0.2340864
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 25 cost time: 0.8870463371276855
Epoch: 25, Steps: 64 | Train Loss: 0.1420288 Vali Loss: 0.1711195 Test Loss: 0.2330804
Validation loss decreased (0.172027 --> 0.171120).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 26 cost time: 0.8927745819091797
Epoch: 26, Steps: 64 | Train Loss: 0.1419490 Vali Loss: 0.1703606 Test Loss: 0.2332583
Validation loss decreased (0.171120 --> 0.170361).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 27 cost time: 0.8939998149871826
Epoch: 27, Steps: 64 | Train Loss: 0.1410814 Vali Loss: 0.1712202 Test Loss: 0.2331897
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 28 cost time: 0.8896195888519287
Epoch: 28, Steps: 64 | Train Loss: 0.1413714 Vali Loss: 0.1718553 Test Loss: 0.2339563
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 29 cost time: 0.886110782623291
Epoch: 29, Steps: 64 | Train Loss: 0.1408014 Vali Loss: 0.1711995 Test Loss: 0.2339474
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 30 cost time: 0.8818943500518799
Epoch: 30, Steps: 64 | Train Loss: 0.1401911 Vali Loss: 0.1690692 Test Loss: 0.2324566
Validation loss decreased (0.170361 --> 0.169069).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 31 cost time: 0.8923449516296387
Epoch: 31, Steps: 64 | Train Loss: 0.1411130 Vali Loss: 0.1717949 Test Loss: 0.2336997
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 32 cost time: 0.9167215824127197
Epoch: 32, Steps: 64 | Train Loss: 0.1399934 Vali Loss: 0.1689858 Test Loss: 0.2320384
Validation loss decreased (0.169069 --> 0.168986).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 33 cost time: 0.9677581787109375
Epoch: 33, Steps: 64 | Train Loss: 0.1395519 Vali Loss: 0.1720379 Test Loss: 0.2322845
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 34 cost time: 0.9636251926422119
Epoch: 34, Steps: 64 | Train Loss: 0.1391247 Vali Loss: 0.1696703 Test Loss: 0.2323600
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 35 cost time: 0.9676289558410645
Epoch: 35, Steps: 64 | Train Loss: 0.1393721 Vali Loss: 0.1694420 Test Loss: 0.2312362
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 36 cost time: 0.9132049083709717
Epoch: 36, Steps: 64 | Train Loss: 0.1391321 Vali Loss: 0.1688586 Test Loss: 0.2320820
Validation loss decreased (0.168986 --> 0.168859).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 37 cost time: 0.8894174098968506
Epoch: 37, Steps: 64 | Train Loss: 0.1390897 Vali Loss: 0.1703321 Test Loss: 0.2325489
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 38 cost time: 0.8960402011871338
Epoch: 38, Steps: 64 | Train Loss: 0.1390872 Vali Loss: 0.1689849 Test Loss: 0.2319080
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 39 cost time: 0.9097020626068115
Epoch: 39, Steps: 64 | Train Loss: 0.1389220 Vali Loss: 0.1696895 Test Loss: 0.2311223
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 40 cost time: 0.8920001983642578
Epoch: 40, Steps: 64 | Train Loss: 0.1391233 Vali Loss: 0.1682680 Test Loss: 0.2318757
Validation loss decreased (0.168859 --> 0.168268).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 41 cost time: 0.8936254978179932
Epoch: 41, Steps: 64 | Train Loss: 0.1387597 Vali Loss: 0.1695555 Test Loss: 0.2335562
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 42 cost time: 0.8977968692779541
Epoch: 42, Steps: 64 | Train Loss: 0.1387809 Vali Loss: 0.1693312 Test Loss: 0.2319992
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 43 cost time: 0.8979747295379639
Epoch: 43, Steps: 64 | Train Loss: 0.1380367 Vali Loss: 0.1672803 Test Loss: 0.2326092
Validation loss decreased (0.168268 --> 0.167280).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 44 cost time: 0.8934943675994873
Epoch: 44, Steps: 64 | Train Loss: 0.1379635 Vali Loss: 0.1699927 Test Loss: 0.2323037
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 45 cost time: 0.8907215595245361
Epoch: 45, Steps: 64 | Train Loss: 0.1378987 Vali Loss: 0.1695524 Test Loss: 0.2324280
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 46 cost time: 0.8910024166107178
Epoch: 46, Steps: 64 | Train Loss: 0.1385946 Vali Loss: 0.1690604 Test Loss: 0.2313128
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 47 cost time: 0.8936278820037842
Epoch: 47, Steps: 64 | Train Loss: 0.1387203 Vali Loss: 0.1701028 Test Loss: 0.2314529
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 48 cost time: 0.8973433971405029
Epoch: 48, Steps: 64 | Train Loss: 0.1379977 Vali Loss: 0.1669752 Test Loss: 0.2315176
Validation loss decreased (0.167280 --> 0.166975).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 49 cost time: 0.8953704833984375
Epoch: 49, Steps: 64 | Train Loss: 0.1378675 Vali Loss: 0.1694527 Test Loss: 0.2317673
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 50 cost time: 0.8993880748748779
Epoch: 50, Steps: 64 | Train Loss: 0.1375508 Vali Loss: 0.1688050 Test Loss: 0.2313837
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 51 cost time: 0.8951761722564697
Epoch: 51, Steps: 64 | Train Loss: 0.1380653 Vali Loss: 0.1677554 Test Loss: 0.2315441
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 52 cost time: 0.8879997730255127
Epoch: 52, Steps: 64 | Train Loss: 0.1377685 Vali Loss: 0.1681471 Test Loss: 0.2323624
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 53 cost time: 0.8916308879852295
Epoch: 53, Steps: 64 | Train Loss: 0.1385374 Vali Loss: 0.1678024 Test Loss: 0.2311273
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 54 cost time: 0.9144103527069092
Epoch: 54, Steps: 64 | Train Loss: 0.1380905 Vali Loss: 0.1689370 Test Loss: 0.2319948
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 55 cost time: 0.8948357105255127
Epoch: 55, Steps: 64 | Train Loss: 0.1373549 Vali Loss: 0.1698936 Test Loss: 0.2324041
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 56 cost time: 0.8883330821990967
Epoch: 56, Steps: 64 | Train Loss: 0.1379504 Vali Loss: 0.1689871 Test Loss: 0.2316171
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 57 cost time: 0.9057331085205078
Epoch: 57, Steps: 64 | Train Loss: 0.1376353 Vali Loss: 0.1691742 Test Loss: 0.2319685
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 58 cost time: 0.9010002613067627
Epoch: 58, Steps: 64 | Train Loss: 0.1380728 Vali Loss: 0.1679990 Test Loss: 0.2317635
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 59 cost time: 0.8956131935119629
Epoch: 59, Steps: 64 | Train Loss: 0.1377493 Vali Loss: 0.1680695 Test Loss: 0.2319025
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 60 cost time: 0.8984112739562988
Epoch: 60, Steps: 64 | Train Loss: 0.1375582 Vali Loss: 0.1696447 Test Loss: 0.2319225
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23151756823062897, mae:0.3441033363342285, rse:0.24385188519954681
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.05057811737060547 GB
Epoch: 1 cost time: 2.26727557182312
Epoch: 1, Steps: 64 | Train Loss: 0.8757121 Vali Loss: 2.2764482 Test Loss: 3.5835392
Validation loss decreased (inf --> 2.276448).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 2 cost time: 0.9310398101806641
Epoch: 2, Steps: 64 | Train Loss: 0.5617249 Vali Loss: 0.6820318 Test Loss: 0.9310738
Validation loss decreased (2.276448 --> 0.682032).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 3 cost time: 0.9320683479309082
Epoch: 3, Steps: 64 | Train Loss: 0.2120674 Vali Loss: 0.2235150 Test Loss: 0.2578175
Validation loss decreased (0.682032 --> 0.223515).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 4 cost time: 0.9340002536773682
Epoch: 4, Steps: 64 | Train Loss: 0.1440793 Vali Loss: 0.1840046 Test Loss: 0.2344697
Validation loss decreased (0.223515 --> 0.184005).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 5 cost time: 0.9181792736053467
Epoch: 5, Steps: 64 | Train Loss: 0.1335387 Vali Loss: 0.1793804 Test Loss: 0.2337537
Validation loss decreased (0.184005 --> 0.179380).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 6 cost time: 0.9244885444641113
Epoch: 6, Steps: 64 | Train Loss: 0.1283112 Vali Loss: 0.1773184 Test Loss: 0.2321406
Validation loss decreased (0.179380 --> 0.177318).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 7 cost time: 0.9248232841491699
Epoch: 7, Steps: 64 | Train Loss: 0.1244675 Vali Loss: 0.1722808 Test Loss: 0.2301563
Validation loss decreased (0.177318 --> 0.172281).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 8 cost time: 0.9343383312225342
Epoch: 8, Steps: 64 | Train Loss: 0.1224469 Vali Loss: 0.1688472 Test Loss: 0.2294985
Validation loss decreased (0.172281 --> 0.168847).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 9 cost time: 0.9254245758056641
Epoch: 9, Steps: 64 | Train Loss: 0.1200155 Vali Loss: 0.1665291 Test Loss: 0.2285945
Validation loss decreased (0.168847 --> 0.166529).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 10 cost time: 0.9294683933258057
Epoch: 10, Steps: 64 | Train Loss: 0.1185079 Vali Loss: 0.1658004 Test Loss: 0.2282371
Validation loss decreased (0.166529 --> 0.165800).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 11 cost time: 0.9357717037200928
Epoch: 11, Steps: 64 | Train Loss: 0.1174962 Vali Loss: 0.1655453 Test Loss: 0.2278674
Validation loss decreased (0.165800 --> 0.165545).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 12 cost time: 0.9309999942779541
Epoch: 12, Steps: 64 | Train Loss: 0.1159202 Vali Loss: 0.1640179 Test Loss: 0.2273251
Validation loss decreased (0.165545 --> 0.164018).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 13 cost time: 0.9266281127929688
Epoch: 13, Steps: 64 | Train Loss: 0.1151732 Vali Loss: 0.1644230 Test Loss: 0.2284144
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 14 cost time: 0.9283559322357178
Epoch: 14, Steps: 64 | Train Loss: 0.1148830 Vali Loss: 0.1603785 Test Loss: 0.2267717
Validation loss decreased (0.164018 --> 0.160379).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 15 cost time: 0.9435319900512695
Epoch: 15, Steps: 64 | Train Loss: 0.1136624 Vali Loss: 0.1624755 Test Loss: 0.2280556
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 16 cost time: 0.944340705871582
Epoch: 16, Steps: 64 | Train Loss: 0.1130699 Vali Loss: 0.1621797 Test Loss: 0.2284099
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 17 cost time: 0.941478967666626
Epoch: 17, Steps: 64 | Train Loss: 0.1126152 Vali Loss: 0.1613171 Test Loss: 0.2278853
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 18 cost time: 0.9493036270141602
Epoch: 18, Steps: 64 | Train Loss: 0.1121692 Vali Loss: 0.1600276 Test Loss: 0.2270716
Validation loss decreased (0.160379 --> 0.160028).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 19 cost time: 0.9283661842346191
Epoch: 19, Steps: 64 | Train Loss: 0.1121300 Vali Loss: 0.1594878 Test Loss: 0.2267636
Validation loss decreased (0.160028 --> 0.159488).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 20 cost time: 0.929612398147583
Epoch: 20, Steps: 64 | Train Loss: 0.1117987 Vali Loss: 0.1582024 Test Loss: 0.2266139
Validation loss decreased (0.159488 --> 0.158202).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 21 cost time: 0.9246177673339844
Epoch: 21, Steps: 64 | Train Loss: 0.1110293 Vali Loss: 0.1595983 Test Loss: 0.2266867
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 22 cost time: 0.9150445461273193
Epoch: 22, Steps: 64 | Train Loss: 0.1109694 Vali Loss: 0.1600366 Test Loss: 0.2270646
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 23 cost time: 0.920480489730835
Epoch: 23, Steps: 64 | Train Loss: 0.1103199 Vali Loss: 0.1591548 Test Loss: 0.2270591
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 24 cost time: 0.9213581085205078
Epoch: 24, Steps: 64 | Train Loss: 0.1110892 Vali Loss: 0.1585702 Test Loss: 0.2268003
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 25 cost time: 0.9207258224487305
Epoch: 25, Steps: 64 | Train Loss: 0.1106073 Vali Loss: 0.1580495 Test Loss: 0.2264270
Validation loss decreased (0.158202 --> 0.158049).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 26 cost time: 0.9190001487731934
Epoch: 26, Steps: 64 | Train Loss: 0.1100863 Vali Loss: 0.1575563 Test Loss: 0.2264734
Validation loss decreased (0.158049 --> 0.157556).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 27 cost time: 0.9236245155334473
Epoch: 27, Steps: 64 | Train Loss: 0.1097529 Vali Loss: 0.1588149 Test Loss: 0.2266178
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 28 cost time: 0.91961669921875
Epoch: 28, Steps: 64 | Train Loss: 0.1098266 Vali Loss: 0.1573007 Test Loss: 0.2267684
Validation loss decreased (0.157556 --> 0.157301).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 29 cost time: 0.8972680568695068
Epoch: 29, Steps: 64 | Train Loss: 0.1097514 Vali Loss: 0.1587586 Test Loss: 0.2261564
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 30 cost time: 0.9321320056915283
Epoch: 30, Steps: 64 | Train Loss: 0.1100864 Vali Loss: 0.1581465 Test Loss: 0.2263700
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 31 cost time: 0.9334053993225098
Epoch: 31, Steps: 64 | Train Loss: 0.1090626 Vali Loss: 0.1578416 Test Loss: 0.2264210
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 32 cost time: 0.9441549777984619
Epoch: 32, Steps: 64 | Train Loss: 0.1092625 Vali Loss: 0.1552389 Test Loss: 0.2265774
Validation loss decreased (0.157301 --> 0.155239).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 33 cost time: 0.9260001182556152
Epoch: 33, Steps: 64 | Train Loss: 0.1097479 Vali Loss: 0.1581066 Test Loss: 0.2263664
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 34 cost time: 0.9246196746826172
Epoch: 34, Steps: 64 | Train Loss: 0.1092337 Vali Loss: 0.1574810 Test Loss: 0.2263670
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 35 cost time: 0.9264016151428223
Epoch: 35, Steps: 64 | Train Loss: 0.1093615 Vali Loss: 0.1555775 Test Loss: 0.2262553
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 36 cost time: 0.9320595264434814
Epoch: 36, Steps: 64 | Train Loss: 0.1090317 Vali Loss: 0.1580177 Test Loss: 0.2261588
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 37 cost time: 0.9243831634521484
Epoch: 37, Steps: 64 | Train Loss: 0.1092343 Vali Loss: 0.1575608 Test Loss: 0.2265960
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 38 cost time: 0.9263434410095215
Epoch: 38, Steps: 64 | Train Loss: 0.1089924 Vali Loss: 0.1572063 Test Loss: 0.2261350
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 39 cost time: 0.9407274723052979
Epoch: 39, Steps: 64 | Train Loss: 0.1089857 Vali Loss: 0.1574879 Test Loss: 0.2261118
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 40 cost time: 0.9307847023010254
Epoch: 40, Steps: 64 | Train Loss: 0.1092969 Vali Loss: 0.1569817 Test Loss: 0.2259143
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 41 cost time: 0.930628776550293
Epoch: 41, Steps: 64 | Train Loss: 0.1090859 Vali Loss: 0.1577997 Test Loss: 0.2266818
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 42 cost time: 0.925621747970581
Epoch: 42, Steps: 64 | Train Loss: 0.1089981 Vali Loss: 0.1592690 Test Loss: 0.2267079
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 43 cost time: 0.9123616218566895
Epoch: 43, Steps: 64 | Train Loss: 0.1080274 Vali Loss: 0.1565108 Test Loss: 0.2262005
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 44 cost time: 0.928328275680542
Epoch: 44, Steps: 64 | Train Loss: 0.1087782 Vali Loss: 0.1587251 Test Loss: 0.2266037
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 45 cost time: 0.9270126819610596
Epoch: 45, Steps: 64 | Train Loss: 0.1084695 Vali Loss: 0.1571954 Test Loss: 0.2263992
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 46 cost time: 0.9327223300933838
Epoch: 46, Steps: 64 | Train Loss: 0.1088591 Vali Loss: 0.1576749 Test Loss: 0.2261716
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 47 cost time: 0.9310002326965332
Epoch: 47, Steps: 64 | Train Loss: 0.1082894 Vali Loss: 0.1579960 Test Loss: 0.2265211
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 48 cost time: 0.9276289939880371
Epoch: 48, Steps: 64 | Train Loss: 0.1083774 Vali Loss: 0.1575480 Test Loss: 0.2266418
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 49 cost time: 0.9319548606872559
Epoch: 49, Steps: 64 | Train Loss: 0.1084554 Vali Loss: 0.1546620 Test Loss: 0.2258345
Validation loss decreased (0.155239 --> 0.154662).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 50 cost time: 0.9343657493591309
Epoch: 50, Steps: 64 | Train Loss: 0.1082997 Vali Loss: 0.1566537 Test Loss: 0.2261889
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 51 cost time: 0.9253535270690918
Epoch: 51, Steps: 64 | Train Loss: 0.1087342 Vali Loss: 0.1580898 Test Loss: 0.2261387
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 52 cost time: 0.9243431091308594
Epoch: 52, Steps: 64 | Train Loss: 0.1082377 Vali Loss: 0.1580339 Test Loss: 0.2261102
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 53 cost time: 0.9437534809112549
Epoch: 53, Steps: 64 | Train Loss: 0.1087176 Vali Loss: 0.1568590 Test Loss: 0.2262499
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 54 cost time: 0.943000078201294
Epoch: 54, Steps: 64 | Train Loss: 0.1086753 Vali Loss: 0.1571262 Test Loss: 0.2259406
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 55 cost time: 0.9360015392303467
Epoch: 55, Steps: 64 | Train Loss: 0.1084643 Vali Loss: 0.1574082 Test Loss: 0.2263049
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 56 cost time: 0.9331066608428955
Epoch: 56, Steps: 64 | Train Loss: 0.1081223 Vali Loss: 0.1556508 Test Loss: 0.2263487
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 57 cost time: 0.9297690391540527
Epoch: 57, Steps: 64 | Train Loss: 0.1085293 Vali Loss: 0.1578806 Test Loss: 0.2263691
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 58 cost time: 0.9379808902740479
Epoch: 58, Steps: 64 | Train Loss: 0.1084203 Vali Loss: 0.1543561 Test Loss: 0.2259973
Validation loss decreased (0.154662 --> 0.154356).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 59 cost time: 0.9513900279998779
Epoch: 59, Steps: 64 | Train Loss: 0.1087237 Vali Loss: 0.1569957 Test Loss: 0.2260021
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 60 cost time: 0.9343581199645996
Epoch: 60, Steps: 64 | Train Loss: 0.1084699 Vali Loss: 0.1570428 Test Loss: 0.2263842
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22599735856056213, mae:0.33498960733413696, rse:0.24092718958854675
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05169820785522461 GB
Epoch: 1 cost time: 2.2966341972351074
Epoch: 1, Steps: 64 | Train Loss: 0.9066685 Vali Loss: 2.4472604 Test Loss: 3.9150815
Validation loss decreased (inf --> 2.447260).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 2 cost time: 0.9570915699005127
Epoch: 2, Steps: 64 | Train Loss: 0.6296463 Vali Loss: 0.9087657 Test Loss: 1.3315579
Validation loss decreased (2.447260 --> 0.908766).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 3 cost time: 0.9666082859039307
Epoch: 3, Steps: 64 | Train Loss: 0.2389087 Vali Loss: 0.2404733 Test Loss: 0.2790338
Validation loss decreased (0.908766 --> 0.240473).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 4 cost time: 0.9596052169799805
Epoch: 4, Steps: 64 | Train Loss: 0.1423047 Vali Loss: 0.1938336 Test Loss: 0.2450578
Validation loss decreased (0.240473 --> 0.193834).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 5 cost time: 0.9623830318450928
Epoch: 5, Steps: 64 | Train Loss: 0.1298152 Vali Loss: 0.1833617 Test Loss: 0.2334666
Validation loss decreased (0.193834 --> 0.183362).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 6 cost time: 0.9580905437469482
Epoch: 6, Steps: 64 | Train Loss: 0.1246940 Vali Loss: 0.1768698 Test Loss: 0.2328488
Validation loss decreased (0.183362 --> 0.176870).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 7 cost time: 0.9500806331634521
Epoch: 7, Steps: 64 | Train Loss: 0.1205971 Vali Loss: 0.1744378 Test Loss: 0.2299448
Validation loss decreased (0.176870 --> 0.174438).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 8 cost time: 0.959374189376831
Epoch: 8, Steps: 64 | Train Loss: 0.1183122 Vali Loss: 0.1709222 Test Loss: 0.2275976
Validation loss decreased (0.174438 --> 0.170922).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 9 cost time: 0.9553670883178711
Epoch: 9, Steps: 64 | Train Loss: 0.1156892 Vali Loss: 0.1684044 Test Loss: 0.2261381
Validation loss decreased (0.170922 --> 0.168404).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 10 cost time: 0.967731237411499
Epoch: 10, Steps: 64 | Train Loss: 0.1143876 Vali Loss: 0.1690732 Test Loss: 0.2280402
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 11 cost time: 0.957366943359375
Epoch: 11, Steps: 64 | Train Loss: 0.1128670 Vali Loss: 0.1658202 Test Loss: 0.2266311
Validation loss decreased (0.168404 --> 0.165820).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 12 cost time: 0.9599997997283936
Epoch: 12, Steps: 64 | Train Loss: 0.1117757 Vali Loss: 0.1641419 Test Loss: 0.2263048
Validation loss decreased (0.165820 --> 0.164142).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 13 cost time: 0.9696297645568848
Epoch: 13, Steps: 64 | Train Loss: 0.1109448 Vali Loss: 0.1625680 Test Loss: 0.2264462
Validation loss decreased (0.164142 --> 0.162568).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 14 cost time: 0.9543354511260986
Epoch: 14, Steps: 64 | Train Loss: 0.1098341 Vali Loss: 0.1617922 Test Loss: 0.2253340
Validation loss decreased (0.162568 --> 0.161792).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 15 cost time: 0.9541735649108887
Epoch: 15, Steps: 64 | Train Loss: 0.1105368 Vali Loss: 0.1640784 Test Loss: 0.2269191
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 16 cost time: 0.9596807956695557
Epoch: 16, Steps: 64 | Train Loss: 0.1096532 Vali Loss: 0.1609977 Test Loss: 0.2260229
Validation loss decreased (0.161792 --> 0.160998).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 17 cost time: 0.9704034328460693
Epoch: 17, Steps: 64 | Train Loss: 0.1084475 Vali Loss: 0.1582160 Test Loss: 0.2256103
Validation loss decreased (0.160998 --> 0.158216).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 18 cost time: 0.9723660945892334
Epoch: 18, Steps: 64 | Train Loss: 0.1083173 Vali Loss: 0.1589184 Test Loss: 0.2255715
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 19 cost time: 0.9687530994415283
Epoch: 19, Steps: 64 | Train Loss: 0.1075694 Vali Loss: 0.1592085 Test Loss: 0.2255024
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 20 cost time: 0.9716730117797852
Epoch: 20, Steps: 64 | Train Loss: 0.1077396 Vali Loss: 0.1588379 Test Loss: 0.2253812
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 21 cost time: 0.9550001621246338
Epoch: 21, Steps: 64 | Train Loss: 0.1074363 Vali Loss: 0.1573635 Test Loss: 0.2255521
Validation loss decreased (0.158216 --> 0.157363).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 22 cost time: 0.9566216468811035
Epoch: 22, Steps: 64 | Train Loss: 0.1073344 Vali Loss: 0.1576290 Test Loss: 0.2254068
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 23 cost time: 0.9544777870178223
Epoch: 23, Steps: 64 | Train Loss: 0.1068521 Vali Loss: 0.1581437 Test Loss: 0.2253994
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 24 cost time: 0.9482541084289551
Epoch: 24, Steps: 64 | Train Loss: 0.1065975 Vali Loss: 0.1567326 Test Loss: 0.2253636
Validation loss decreased (0.157363 --> 0.156733).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 25 cost time: 0.9423577785491943
Epoch: 25, Steps: 64 | Train Loss: 0.1067024 Vali Loss: 0.1560110 Test Loss: 0.2253546
Validation loss decreased (0.156733 --> 0.156011).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 26 cost time: 0.9464271068572998
Epoch: 26, Steps: 64 | Train Loss: 0.1061120 Vali Loss: 0.1568577 Test Loss: 0.2247772
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 27 cost time: 0.9467480182647705
Epoch: 27, Steps: 64 | Train Loss: 0.1063134 Vali Loss: 0.1569626 Test Loss: 0.2254895
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 28 cost time: 0.9521677494049072
Epoch: 28, Steps: 64 | Train Loss: 0.1063132 Vali Loss: 0.1558966 Test Loss: 0.2255388
Validation loss decreased (0.156011 --> 0.155897).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 29 cost time: 0.9500002861022949
Epoch: 29, Steps: 64 | Train Loss: 0.1062670 Vali Loss: 0.1572419 Test Loss: 0.2255994
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 30 cost time: 0.9666318893432617
Epoch: 30, Steps: 64 | Train Loss: 0.1059145 Vali Loss: 0.1571540 Test Loss: 0.2253374
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 31 cost time: 0.9515895843505859
Epoch: 31, Steps: 64 | Train Loss: 0.1058825 Vali Loss: 0.1558849 Test Loss: 0.2254079
Validation loss decreased (0.155897 --> 0.155885).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 32 cost time: 0.9489827156066895
Epoch: 32, Steps: 64 | Train Loss: 0.1062618 Vali Loss: 0.1561976 Test Loss: 0.2256793
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 33 cost time: 0.9527738094329834
Epoch: 33, Steps: 64 | Train Loss: 0.1053434 Vali Loss: 0.1568229 Test Loss: 0.2261944
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 34 cost time: 0.965503454208374
Epoch: 34, Steps: 64 | Train Loss: 0.1051137 Vali Loss: 0.1536820 Test Loss: 0.2253172
Validation loss decreased (0.155885 --> 0.153682).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 35 cost time: 0.9483306407928467
Epoch: 35, Steps: 64 | Train Loss: 0.1055186 Vali Loss: 0.1549740 Test Loss: 0.2255026
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 36 cost time: 0.947415828704834
Epoch: 36, Steps: 64 | Train Loss: 0.1054995 Vali Loss: 0.1564412 Test Loss: 0.2251161
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 37 cost time: 0.9659998416900635
Epoch: 37, Steps: 64 | Train Loss: 0.1053145 Vali Loss: 0.1553145 Test Loss: 0.2251447
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 38 cost time: 0.9446351528167725
Epoch: 38, Steps: 64 | Train Loss: 0.1049612 Vali Loss: 0.1531778 Test Loss: 0.2252550
Validation loss decreased (0.153682 --> 0.153178).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 39 cost time: 0.9436216354370117
Epoch: 39, Steps: 64 | Train Loss: 0.1050352 Vali Loss: 0.1549063 Test Loss: 0.2256494
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 40 cost time: 0.9592232704162598
Epoch: 40, Steps: 64 | Train Loss: 0.1054672 Vali Loss: 0.1562135 Test Loss: 0.2255815
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 41 cost time: 0.943709135055542
Epoch: 41, Steps: 64 | Train Loss: 0.1055766 Vali Loss: 0.1556485 Test Loss: 0.2254955
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 42 cost time: 0.9473624229431152
Epoch: 42, Steps: 64 | Train Loss: 0.1055406 Vali Loss: 0.1546100 Test Loss: 0.2256778
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 43 cost time: 0.9433712959289551
Epoch: 43, Steps: 64 | Train Loss: 0.1047040 Vali Loss: 0.1549326 Test Loss: 0.2247811
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 44 cost time: 0.9363136291503906
Epoch: 44, Steps: 64 | Train Loss: 0.1052124 Vali Loss: 0.1553925 Test Loss: 0.2252403
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 45 cost time: 0.9444289207458496
Epoch: 45, Steps: 64 | Train Loss: 0.1052313 Vali Loss: 0.1552980 Test Loss: 0.2256429
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 46 cost time: 0.9476282596588135
Epoch: 46, Steps: 64 | Train Loss: 0.1049559 Vali Loss: 0.1552130 Test Loss: 0.2254376
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 47 cost time: 0.9544224739074707
Epoch: 47, Steps: 64 | Train Loss: 0.1050223 Vali Loss: 0.1548666 Test Loss: 0.2251769
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 48 cost time: 0.9522125720977783
Epoch: 48, Steps: 64 | Train Loss: 0.1051844 Vali Loss: 0.1547780 Test Loss: 0.2252492
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 49 cost time: 0.949002742767334
Epoch: 49, Steps: 64 | Train Loss: 0.1045634 Vali Loss: 0.1579002 Test Loss: 0.2256387
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 50 cost time: 0.9474234580993652
Epoch: 50, Steps: 64 | Train Loss: 0.1050573 Vali Loss: 0.1553621 Test Loss: 0.2254131
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 51 cost time: 0.9593384265899658
Epoch: 51, Steps: 64 | Train Loss: 0.1048299 Vali Loss: 0.1555732 Test Loss: 0.2257987
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 52 cost time: 0.9437384605407715
Epoch: 52, Steps: 64 | Train Loss: 0.1051352 Vali Loss: 0.1545617 Test Loss: 0.2247927
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 53 cost time: 0.9457812309265137
Epoch: 53, Steps: 64 | Train Loss: 0.1049605 Vali Loss: 0.1564136 Test Loss: 0.2256156
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 54 cost time: 0.9596068859100342
Epoch: 54, Steps: 64 | Train Loss: 0.1049729 Vali Loss: 0.1553955 Test Loss: 0.2248774
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 55 cost time: 0.9463763236999512
Epoch: 55, Steps: 64 | Train Loss: 0.1055367 Vali Loss: 0.1544245 Test Loss: 0.2252371
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 56 cost time: 0.949394941329956
Epoch: 56, Steps: 64 | Train Loss: 0.1052090 Vali Loss: 0.1547413 Test Loss: 0.2248588
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 57 cost time: 0.9445288181304932
Epoch: 57, Steps: 64 | Train Loss: 0.1050785 Vali Loss: 0.1562128 Test Loss: 0.2254072
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 58 cost time: 0.9412641525268555
Epoch: 58, Steps: 64 | Train Loss: 0.1046727 Vali Loss: 0.1550685 Test Loss: 0.2254841
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 59 cost time: 0.9443511962890625
Epoch: 59, Steps: 64 | Train Loss: 0.1053479 Vali Loss: 0.1551758 Test Loss: 0.2248666
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 60 cost time: 0.9457254409790039
Epoch: 60, Steps: 64 | Train Loss: 0.1048636 Vali Loss: 0.1545947 Test Loss: 0.2249910
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22525502741336823, mae:0.335252046585083, rse:0.24053117632865906
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.049307823181152344 GB
Epoch: 1 cost time: 2.1935222148895264
Epoch: 1, Steps: 64 | Train Loss: 1.0775890 Vali Loss: 2.5161407 Test Loss: 3.9876876
Validation loss decreased (inf --> 2.516141).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 2 cost time: 0.9186234474182129
Epoch: 2, Steps: 64 | Train Loss: 0.7411081 Vali Loss: 0.9601166 Test Loss: 1.3988966
Validation loss decreased (2.516141 --> 0.960117).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 3 cost time: 0.8473043441772461
Epoch: 3, Steps: 64 | Train Loss: 0.3914639 Vali Loss: 0.4333741 Test Loss: 0.5361910
Validation loss decreased (0.960117 --> 0.433374).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 4 cost time: 0.8483405113220215
Epoch: 4, Steps: 64 | Train Loss: 0.2451285 Vali Loss: 0.2903828 Test Loss: 0.3201102
Validation loss decreased (0.433374 --> 0.290383).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 5 cost time: 0.8365869522094727
Epoch: 5, Steps: 64 | Train Loss: 0.2002460 Vali Loss: 0.2454338 Test Loss: 0.2730118
Validation loss decreased (0.290383 --> 0.245434).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 6 cost time: 0.8369998931884766
Epoch: 6, Steps: 64 | Train Loss: 0.1803004 Vali Loss: 0.2174148 Test Loss: 0.2524886
Validation loss decreased (0.245434 --> 0.217415).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 7 cost time: 0.8414502143859863
Epoch: 7, Steps: 64 | Train Loss: 0.1702089 Vali Loss: 0.2014554 Test Loss: 0.2395238
Validation loss decreased (0.217415 --> 0.201455).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 8 cost time: 0.8413655757904053
Epoch: 8, Steps: 64 | Train Loss: 0.1613779 Vali Loss: 0.1916574 Test Loss: 0.2328702
Validation loss decreased (0.201455 --> 0.191657).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 9 cost time: 0.8294129371643066
Epoch: 9, Steps: 64 | Train Loss: 0.1579672 Vali Loss: 0.1849140 Test Loss: 0.2274674
Validation loss decreased (0.191657 --> 0.184914).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 10 cost time: 0.8358044624328613
Epoch: 10, Steps: 64 | Train Loss: 0.1530122 Vali Loss: 0.1832578 Test Loss: 0.2268203
Validation loss decreased (0.184914 --> 0.183258).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 11 cost time: 0.8390002250671387
Epoch: 11, Steps: 64 | Train Loss: 0.1496271 Vali Loss: 0.1800842 Test Loss: 0.2249397
Validation loss decreased (0.183258 --> 0.180084).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 12 cost time: 0.856008768081665
Epoch: 12, Steps: 64 | Train Loss: 0.1472392 Vali Loss: 0.1787906 Test Loss: 0.2234797
Validation loss decreased (0.180084 --> 0.178791).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 13 cost time: 0.8383679389953613
Epoch: 13, Steps: 64 | Train Loss: 0.1447303 Vali Loss: 0.1773293 Test Loss: 0.2232697
Validation loss decreased (0.178791 --> 0.177329).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 14 cost time: 0.8415138721466064
Epoch: 14, Steps: 64 | Train Loss: 0.1428762 Vali Loss: 0.1728495 Test Loss: 0.2219891
Validation loss decreased (0.177329 --> 0.172849).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 15 cost time: 0.8397257328033447
Epoch: 15, Steps: 64 | Train Loss: 0.1407710 Vali Loss: 0.1718721 Test Loss: 0.2216197
Validation loss decreased (0.172849 --> 0.171872).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 16 cost time: 0.8500025272369385
Epoch: 16, Steps: 64 | Train Loss: 0.1392221 Vali Loss: 0.1734275 Test Loss: 0.2213708
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 17 cost time: 0.8406326770782471
Epoch: 17, Steps: 64 | Train Loss: 0.1382276 Vali Loss: 0.1738078 Test Loss: 0.2213390
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 18 cost time: 0.8363878726959229
Epoch: 18, Steps: 64 | Train Loss: 0.1369319 Vali Loss: 0.1719724 Test Loss: 0.2207235
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 19 cost time: 0.8417379856109619
Epoch: 19, Steps: 64 | Train Loss: 0.1362150 Vali Loss: 0.1694016 Test Loss: 0.2202951
Validation loss decreased (0.171872 --> 0.169402).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 20 cost time: 0.8550002574920654
Epoch: 20, Steps: 64 | Train Loss: 0.1354828 Vali Loss: 0.1717983 Test Loss: 0.2207266
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 21 cost time: 0.8433377742767334
Epoch: 21, Steps: 64 | Train Loss: 0.1345914 Vali Loss: 0.1695900 Test Loss: 0.2204572
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 22 cost time: 0.8454923629760742
Epoch: 22, Steps: 64 | Train Loss: 0.1332751 Vali Loss: 0.1701347 Test Loss: 0.2202053
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 23 cost time: 0.8423898220062256
Epoch: 23, Steps: 64 | Train Loss: 0.1327611 Vali Loss: 0.1692167 Test Loss: 0.2201665
Validation loss decreased (0.169402 --> 0.169217).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 24 cost time: 0.8347363471984863
Epoch: 24, Steps: 64 | Train Loss: 0.1332999 Vali Loss: 0.1693674 Test Loss: 0.2202760
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 25 cost time: 0.8231899738311768
Epoch: 25, Steps: 64 | Train Loss: 0.1324762 Vali Loss: 0.1675456 Test Loss: 0.2201668
Validation loss decreased (0.169217 --> 0.167546).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 26 cost time: 0.8380017280578613
Epoch: 26, Steps: 64 | Train Loss: 0.1322836 Vali Loss: 0.1668606 Test Loss: 0.2206625
Validation loss decreased (0.167546 --> 0.166861).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 27 cost time: 0.8353650569915771
Epoch: 27, Steps: 64 | Train Loss: 0.1313379 Vali Loss: 0.1677685 Test Loss: 0.2199227
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 28 cost time: 0.823359489440918
Epoch: 28, Steps: 64 | Train Loss: 0.1314758 Vali Loss: 0.1695080 Test Loss: 0.2208348
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 29 cost time: 0.8360016345977783
Epoch: 29, Steps: 64 | Train Loss: 0.1306968 Vali Loss: 0.1665453 Test Loss: 0.2191916
Validation loss decreased (0.166861 --> 0.166545).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 30 cost time: 0.8396151065826416
Epoch: 30, Steps: 64 | Train Loss: 0.1307475 Vali Loss: 0.1665391 Test Loss: 0.2197016
Validation loss decreased (0.166545 --> 0.166539).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 31 cost time: 0.8543965816497803
Epoch: 31, Steps: 64 | Train Loss: 0.1304456 Vali Loss: 0.1660898 Test Loss: 0.2192303
Validation loss decreased (0.166539 --> 0.166090).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 32 cost time: 0.8393957614898682
Epoch: 32, Steps: 64 | Train Loss: 0.1298184 Vali Loss: 0.1683710 Test Loss: 0.2197328
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 33 cost time: 0.8377246856689453
Epoch: 33, Steps: 64 | Train Loss: 0.1298187 Vali Loss: 0.1667345 Test Loss: 0.2199109
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 34 cost time: 0.8400003910064697
Epoch: 34, Steps: 64 | Train Loss: 0.1293846 Vali Loss: 0.1679818 Test Loss: 0.2198992
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 35 cost time: 0.8493280410766602
Epoch: 35, Steps: 64 | Train Loss: 0.1290027 Vali Loss: 0.1664375 Test Loss: 0.2191234
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 36 cost time: 0.8383548259735107
Epoch: 36, Steps: 64 | Train Loss: 0.1288322 Vali Loss: 0.1668654 Test Loss: 0.2191577
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 37 cost time: 0.839362621307373
Epoch: 37, Steps: 64 | Train Loss: 0.1291439 Vali Loss: 0.1655256 Test Loss: 0.2196320
Validation loss decreased (0.166090 --> 0.165526).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 38 cost time: 0.8407301902770996
Epoch: 38, Steps: 64 | Train Loss: 0.1290381 Vali Loss: 0.1663359 Test Loss: 0.2198940
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 39 cost time: 0.8510000705718994
Epoch: 39, Steps: 64 | Train Loss: 0.1291038 Vali Loss: 0.1664892 Test Loss: 0.2197398
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 40 cost time: 0.8456921577453613
Epoch: 40, Steps: 64 | Train Loss: 0.1288700 Vali Loss: 0.1676793 Test Loss: 0.2194987
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 41 cost time: 0.8434371948242188
Epoch: 41, Steps: 64 | Train Loss: 0.1296731 Vali Loss: 0.1674056 Test Loss: 0.2197387
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 42 cost time: 0.8454389572143555
Epoch: 42, Steps: 64 | Train Loss: 0.1292253 Vali Loss: 0.1669993 Test Loss: 0.2199105
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 43 cost time: 0.8533792495727539
Epoch: 43, Steps: 64 | Train Loss: 0.1289307 Vali Loss: 0.1663606 Test Loss: 0.2190035
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 44 cost time: 0.8406190872192383
Epoch: 44, Steps: 64 | Train Loss: 0.1284133 Vali Loss: 0.1670329 Test Loss: 0.2197899
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 45 cost time: 0.8433606624603271
Epoch: 45, Steps: 64 | Train Loss: 0.1285013 Vali Loss: 0.1657814 Test Loss: 0.2196323
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 46 cost time: 0.8404226303100586
Epoch: 46, Steps: 64 | Train Loss: 0.1281433 Vali Loss: 0.1669013 Test Loss: 0.2190091
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 47 cost time: 0.8147397041320801
Epoch: 47, Steps: 64 | Train Loss: 0.1285812 Vali Loss: 0.1652600 Test Loss: 0.2198941
Validation loss decreased (0.165526 --> 0.165260).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 48 cost time: 0.8389997482299805
Epoch: 48, Steps: 64 | Train Loss: 0.1278598 Vali Loss: 0.1673340 Test Loss: 0.2198218
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 49 cost time: 0.840611457824707
Epoch: 49, Steps: 64 | Train Loss: 0.1282139 Vali Loss: 0.1662257 Test Loss: 0.2199320
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 50 cost time: 0.8539986610412598
Epoch: 50, Steps: 64 | Train Loss: 0.1279042 Vali Loss: 0.1659488 Test Loss: 0.2191893
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 51 cost time: 0.9203789234161377
Epoch: 51, Steps: 64 | Train Loss: 0.1277366 Vali Loss: 0.1670363 Test Loss: 0.2194006
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 52 cost time: 0.9194128513336182
Epoch: 52, Steps: 64 | Train Loss: 0.1274539 Vali Loss: 0.1668742 Test Loss: 0.2193416
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 53 cost time: 0.8759996891021729
Epoch: 53, Steps: 64 | Train Loss: 0.1280869 Vali Loss: 0.1666284 Test Loss: 0.2190709
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 54 cost time: 0.8394434452056885
Epoch: 54, Steps: 64 | Train Loss: 0.1281531 Vali Loss: 0.1650156 Test Loss: 0.2190421
Validation loss decreased (0.165260 --> 0.165016).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 55 cost time: 0.842381477355957
Epoch: 55, Steps: 64 | Train Loss: 0.1276821 Vali Loss: 0.1659755 Test Loss: 0.2193978
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 56 cost time: 0.8403685092926025
Epoch: 56, Steps: 64 | Train Loss: 0.1278784 Vali Loss: 0.1655762 Test Loss: 0.2190962
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 57 cost time: 0.8417606353759766
Epoch: 57, Steps: 64 | Train Loss: 0.1283542 Vali Loss: 0.1673168 Test Loss: 0.2199033
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 58 cost time: 0.8513693809509277
Epoch: 58, Steps: 64 | Train Loss: 0.1268985 Vali Loss: 0.1658565 Test Loss: 0.2190794
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 59 cost time: 0.842623233795166
Epoch: 59, Steps: 64 | Train Loss: 0.1273762 Vali Loss: 0.1661196 Test Loss: 0.2193545
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 60 cost time: 0.8415157794952393
Epoch: 60, Steps: 64 | Train Loss: 0.1278148 Vali Loss: 0.1658360 Test Loss: 0.2190518
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.219042107462883, mae:0.3222547769546509, rse:0.2371908575296402
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05073976516723633 GB
Epoch: 1 cost time: 2.3667938709259033
Epoch: 1, Steps: 64 | Train Loss: 0.9539598 Vali Loss: 2.4647248 Test Loss: 3.9140749
Validation loss decreased (inf --> 2.464725).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 2 cost time: 0.941340446472168
Epoch: 2, Steps: 64 | Train Loss: 0.5637946 Vali Loss: 0.5596300 Test Loss: 0.7596363
Validation loss decreased (2.464725 --> 0.559630).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 3 cost time: 0.9423434734344482
Epoch: 3, Steps: 64 | Train Loss: 0.2033892 Vali Loss: 0.2435432 Test Loss: 0.2625941
Validation loss decreased (0.559630 --> 0.243543).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 4 cost time: 0.9361441135406494
Epoch: 4, Steps: 64 | Train Loss: 0.1474327 Vali Loss: 0.1946078 Test Loss: 0.2325489
Validation loss decreased (0.243543 --> 0.194608).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 5 cost time: 0.9376571178436279
Epoch: 5, Steps: 64 | Train Loss: 0.1357006 Vali Loss: 0.1830263 Test Loss: 0.2267079
Validation loss decreased (0.194608 --> 0.183026).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 6 cost time: 0.931605339050293
Epoch: 6, Steps: 64 | Train Loss: 0.1298833 Vali Loss: 0.1764039 Test Loss: 0.2234842
Validation loss decreased (0.183026 --> 0.176404).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 7 cost time: 0.9293551445007324
Epoch: 7, Steps: 64 | Train Loss: 0.1256926 Vali Loss: 0.1711281 Test Loss: 0.2213065
Validation loss decreased (0.176404 --> 0.171128).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 8 cost time: 0.941317081451416
Epoch: 8, Steps: 64 | Train Loss: 0.1230193 Vali Loss: 0.1689232 Test Loss: 0.2207884
Validation loss decreased (0.171128 --> 0.168923).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 9 cost time: 0.9303326606750488
Epoch: 9, Steps: 64 | Train Loss: 0.1201160 Vali Loss: 0.1665413 Test Loss: 0.2188757
Validation loss decreased (0.168923 --> 0.166541).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 10 cost time: 1.0196428298950195
Epoch: 10, Steps: 64 | Train Loss: 0.1190408 Vali Loss: 0.1661938 Test Loss: 0.2190289
Validation loss decreased (0.166541 --> 0.166194).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 11 cost time: 0.9814178943634033
Epoch: 11, Steps: 64 | Train Loss: 0.1168003 Vali Loss: 0.1650276 Test Loss: 0.2189884
Validation loss decreased (0.166194 --> 0.165028).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 12 cost time: 0.9623773097991943
Epoch: 12, Steps: 64 | Train Loss: 0.1164488 Vali Loss: 0.1621327 Test Loss: 0.2174768
Validation loss decreased (0.165028 --> 0.162133).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 13 cost time: 0.9683592319488525
Epoch: 13, Steps: 64 | Train Loss: 0.1150417 Vali Loss: 0.1618350 Test Loss: 0.2176529
Validation loss decreased (0.162133 --> 0.161835).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 14 cost time: 0.9329996109008789
Epoch: 14, Steps: 64 | Train Loss: 0.1138942 Vali Loss: 0.1624532 Test Loss: 0.2180995
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 15 cost time: 0.94364333152771
Epoch: 15, Steps: 64 | Train Loss: 0.1135114 Vali Loss: 0.1615864 Test Loss: 0.2190589
Validation loss decreased (0.161835 --> 0.161586).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 16 cost time: 0.9303100109100342
Epoch: 16, Steps: 64 | Train Loss: 0.1127929 Vali Loss: 0.1596237 Test Loss: 0.2189636
Validation loss decreased (0.161586 --> 0.159624).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 17 cost time: 0.9312424659729004
Epoch: 17, Steps: 64 | Train Loss: 0.1123996 Vali Loss: 0.1600587 Test Loss: 0.2172349
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 18 cost time: 0.9423937797546387
Epoch: 18, Steps: 64 | Train Loss: 0.1115922 Vali Loss: 0.1604479 Test Loss: 0.2181971
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 19 cost time: 0.9463815689086914
Epoch: 19, Steps: 64 | Train Loss: 0.1114059 Vali Loss: 0.1592336 Test Loss: 0.2181428
Validation loss decreased (0.159624 --> 0.159234).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 20 cost time: 0.9357850551605225
Epoch: 20, Steps: 64 | Train Loss: 0.1112267 Vali Loss: 0.1563326 Test Loss: 0.2183559
Validation loss decreased (0.159234 --> 0.156333).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 21 cost time: 0.9397537708282471
Epoch: 21, Steps: 64 | Train Loss: 0.1101418 Vali Loss: 0.1571058 Test Loss: 0.2190475
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 22 cost time: 0.9279999732971191
Epoch: 22, Steps: 64 | Train Loss: 0.1095521 Vali Loss: 0.1576802 Test Loss: 0.2178193
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 23 cost time: 0.9316275119781494
Epoch: 23, Steps: 64 | Train Loss: 0.1094745 Vali Loss: 0.1584886 Test Loss: 0.2186927
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 24 cost time: 0.9310257434844971
Epoch: 24, Steps: 64 | Train Loss: 0.1095783 Vali Loss: 0.1579413 Test Loss: 0.2180207
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 25 cost time: 0.9392421245574951
Epoch: 25, Steps: 64 | Train Loss: 0.1089554 Vali Loss: 0.1563269 Test Loss: 0.2180124
Validation loss decreased (0.156333 --> 0.156327).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 26 cost time: 1.0154225826263428
Epoch: 26, Steps: 64 | Train Loss: 0.1084856 Vali Loss: 0.1560366 Test Loss: 0.2181757
Validation loss decreased (0.156327 --> 0.156037).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 27 cost time: 1.0193724632263184
Epoch: 27, Steps: 64 | Train Loss: 0.1087483 Vali Loss: 0.1567956 Test Loss: 0.2179631
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 28 cost time: 0.940422534942627
Epoch: 28, Steps: 64 | Train Loss: 0.1086667 Vali Loss: 0.1569671 Test Loss: 0.2180308
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 29 cost time: 0.9030437469482422
Epoch: 29, Steps: 64 | Train Loss: 0.1079991 Vali Loss: 0.1559608 Test Loss: 0.2181798
Validation loss decreased (0.156037 --> 0.155961).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 30 cost time: 0.9487559795379639
Epoch: 30, Steps: 64 | Train Loss: 0.1081775 Vali Loss: 0.1554676 Test Loss: 0.2180066
Validation loss decreased (0.155961 --> 0.155468).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 31 cost time: 0.9450011253356934
Epoch: 31, Steps: 64 | Train Loss: 0.1079806 Vali Loss: 0.1552681 Test Loss: 0.2183245
Validation loss decreased (0.155468 --> 0.155268).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 32 cost time: 0.9516274929046631
Epoch: 32, Steps: 64 | Train Loss: 0.1077104 Vali Loss: 0.1563949 Test Loss: 0.2188326
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 33 cost time: 0.9403436183929443
Epoch: 33, Steps: 64 | Train Loss: 0.1083081 Vali Loss: 0.1560172 Test Loss: 0.2183214
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 34 cost time: 0.942420244216919
Epoch: 34, Steps: 64 | Train Loss: 0.1079800 Vali Loss: 0.1578651 Test Loss: 0.2183188
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 35 cost time: 0.9543440341949463
Epoch: 35, Steps: 64 | Train Loss: 0.1072052 Vali Loss: 0.1545047 Test Loss: 0.2176367
Validation loss decreased (0.155268 --> 0.154505).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 36 cost time: 0.9444746971130371
Epoch: 36, Steps: 64 | Train Loss: 0.1074069 Vali Loss: 0.1553282 Test Loss: 0.2185460
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 37 cost time: 0.944983959197998
Epoch: 37, Steps: 64 | Train Loss: 0.1072862 Vali Loss: 0.1549868 Test Loss: 0.2184045
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 38 cost time: 0.9477071762084961
Epoch: 38, Steps: 64 | Train Loss: 0.1075183 Vali Loss: 0.1541093 Test Loss: 0.2183065
Validation loss decreased (0.154505 --> 0.154109).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 39 cost time: 0.9620010852813721
Epoch: 39, Steps: 64 | Train Loss: 0.1076265 Vali Loss: 0.1553046 Test Loss: 0.2178636
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 40 cost time: 0.9446134567260742
Epoch: 40, Steps: 64 | Train Loss: 0.1075811 Vali Loss: 0.1561417 Test Loss: 0.2189132
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 41 cost time: 0.9468288421630859
Epoch: 41, Steps: 64 | Train Loss: 0.1075067 Vali Loss: 0.1557785 Test Loss: 0.2183685
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 42 cost time: 0.9418597221374512
Epoch: 42, Steps: 64 | Train Loss: 0.1063345 Vali Loss: 0.1561761 Test Loss: 0.2178937
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 43 cost time: 0.935004472732544
Epoch: 43, Steps: 64 | Train Loss: 0.1068670 Vali Loss: 0.1537812 Test Loss: 0.2183079
Validation loss decreased (0.154109 --> 0.153781).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 44 cost time: 0.9333782196044922
Epoch: 44, Steps: 64 | Train Loss: 0.1068225 Vali Loss: 0.1551529 Test Loss: 0.2190114
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 45 cost time: 0.933743953704834
Epoch: 45, Steps: 64 | Train Loss: 0.1068799 Vali Loss: 0.1546479 Test Loss: 0.2188728
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 46 cost time: 0.91483473777771
Epoch: 46, Steps: 64 | Train Loss: 0.1071510 Vali Loss: 0.1553043 Test Loss: 0.2189005
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 47 cost time: 0.9215340614318848
Epoch: 47, Steps: 64 | Train Loss: 0.1068956 Vali Loss: 0.1554318 Test Loss: 0.2180631
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 48 cost time: 0.9565989971160889
Epoch: 48, Steps: 64 | Train Loss: 0.1068135 Vali Loss: 0.1550755 Test Loss: 0.2185569
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 49 cost time: 0.9623284339904785
Epoch: 49, Steps: 64 | Train Loss: 0.1069785 Vali Loss: 0.1560201 Test Loss: 0.2192616
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 50 cost time: 0.9543476104736328
Epoch: 50, Steps: 64 | Train Loss: 0.1064142 Vali Loss: 0.1540511 Test Loss: 0.2179791
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 51 cost time: 0.9523327350616455
Epoch: 51, Steps: 64 | Train Loss: 0.1073321 Vali Loss: 0.1524149 Test Loss: 0.2179879
Validation loss decreased (0.153781 --> 0.152415).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 52 cost time: 0.9586954116821289
Epoch: 52, Steps: 64 | Train Loss: 0.1064780 Vali Loss: 0.1555939 Test Loss: 0.2180197
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 53 cost time: 0.9464223384857178
Epoch: 53, Steps: 64 | Train Loss: 0.1069107 Vali Loss: 0.1531472 Test Loss: 0.2179873
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 54 cost time: 0.9580671787261963
Epoch: 54, Steps: 64 | Train Loss: 0.1072558 Vali Loss: 0.1533559 Test Loss: 0.2182060
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 55 cost time: 0.9610002040863037
Epoch: 55, Steps: 64 | Train Loss: 0.1067960 Vali Loss: 0.1542689 Test Loss: 0.2178611
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 56 cost time: 0.9671902656555176
Epoch: 56, Steps: 64 | Train Loss: 0.1069035 Vali Loss: 0.1550978 Test Loss: 0.2193678
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 57 cost time: 0.9605977535247803
Epoch: 57, Steps: 64 | Train Loss: 0.1065320 Vali Loss: 0.1552106 Test Loss: 0.2184932
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 58 cost time: 0.9546270370483398
Epoch: 58, Steps: 64 | Train Loss: 0.1070375 Vali Loss: 0.1538556 Test Loss: 0.2183024
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 59 cost time: 0.9593987464904785
Epoch: 59, Steps: 64 | Train Loss: 0.1068506 Vali Loss: 0.1542953 Test Loss: 0.2183813
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 60 cost time: 0.9516844749450684
Epoch: 60, Steps: 64 | Train Loss: 0.1070753 Vali Loss: 0.1552540 Test Loss: 0.2186749
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.21798789501190186, mae:0.3209563195705414, rse:0.23661938309669495
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05185985565185547 GB
Epoch: 1 cost time: 2.3385326862335205
Epoch: 1, Steps: 64 | Train Loss: 0.8518752 Vali Loss: 2.2622170 Test Loss: 3.6129184
Validation loss decreased (inf --> 2.262217).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 2 cost time: 0.979388952255249
Epoch: 2, Steps: 64 | Train Loss: 0.5174404 Vali Loss: 0.5081772 Test Loss: 0.6948468
Validation loss decreased (2.262217 --> 0.508177).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 3 cost time: 0.9330976009368896
Epoch: 3, Steps: 64 | Train Loss: 0.1749269 Vali Loss: 0.2084529 Test Loss: 0.2387094
Validation loss decreased (0.508177 --> 0.208453).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 4 cost time: 0.9730002880096436
Epoch: 4, Steps: 64 | Train Loss: 0.1351870 Vali Loss: 0.1864043 Test Loss: 0.2348516
Validation loss decreased (0.208453 --> 0.186404).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 5 cost time: 0.9769995212554932
Epoch: 5, Steps: 64 | Train Loss: 0.1267201 Vali Loss: 0.1809829 Test Loss: 0.2275129
Validation loss decreased (0.186404 --> 0.180983).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 6 cost time: 0.9664158821105957
Epoch: 6, Steps: 64 | Train Loss: 0.1223574 Vali Loss: 0.1762823 Test Loss: 0.2241639
Validation loss decreased (0.180983 --> 0.176282).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 7 cost time: 0.971930742263794
Epoch: 7, Steps: 64 | Train Loss: 0.1200132 Vali Loss: 0.1699771 Test Loss: 0.2226675
Validation loss decreased (0.176282 --> 0.169977).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 8 cost time: 0.9713425636291504
Epoch: 8, Steps: 64 | Train Loss: 0.1172475 Vali Loss: 0.1684990 Test Loss: 0.2220532
Validation loss decreased (0.169977 --> 0.168499).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 9 cost time: 0.9653639793395996
Epoch: 9, Steps: 64 | Train Loss: 0.1159064 Vali Loss: 0.1673737 Test Loss: 0.2211506
Validation loss decreased (0.168499 --> 0.167374).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 10 cost time: 0.9860725402832031
Epoch: 10, Steps: 64 | Train Loss: 0.1148234 Vali Loss: 0.1628080 Test Loss: 0.2195112
Validation loss decreased (0.167374 --> 0.162808).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 11 cost time: 0.9763362407684326
Epoch: 11, Steps: 64 | Train Loss: 0.1135464 Vali Loss: 0.1638674 Test Loss: 0.2208858
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 12 cost time: 0.9893829822540283
Epoch: 12, Steps: 64 | Train Loss: 0.1126983 Vali Loss: 0.1636430 Test Loss: 0.2199617
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 13 cost time: 1.0244653224945068
Epoch: 13, Steps: 64 | Train Loss: 0.1117660 Vali Loss: 0.1610869 Test Loss: 0.2194413
Validation loss decreased (0.162808 --> 0.161087).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 14 cost time: 0.9697902202606201
Epoch: 14, Steps: 64 | Train Loss: 0.1109710 Vali Loss: 0.1616866 Test Loss: 0.2192271
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 15 cost time: 0.9730517864227295
Epoch: 15, Steps: 64 | Train Loss: 0.1103121 Vali Loss: 0.1605445 Test Loss: 0.2203227
Validation loss decreased (0.161087 --> 0.160545).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 16 cost time: 0.9830000400543213
Epoch: 16, Steps: 64 | Train Loss: 0.1096107 Vali Loss: 0.1577511 Test Loss: 0.2187954
Validation loss decreased (0.160545 --> 0.157751).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 17 cost time: 0.9694101810455322
Epoch: 17, Steps: 64 | Train Loss: 0.1095046 Vali Loss: 0.1591858 Test Loss: 0.2189370
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 18 cost time: 0.9736003875732422
Epoch: 18, Steps: 64 | Train Loss: 0.1085063 Vali Loss: 0.1579788 Test Loss: 0.2185590
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 19 cost time: 0.9711225032806396
Epoch: 19, Steps: 64 | Train Loss: 0.1084776 Vali Loss: 0.1573075 Test Loss: 0.2184730
Validation loss decreased (0.157751 --> 0.157308).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 20 cost time: 0.9753270149230957
Epoch: 20, Steps: 64 | Train Loss: 0.1076932 Vali Loss: 0.1564514 Test Loss: 0.2178972
Validation loss decreased (0.157308 --> 0.156451).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 21 cost time: 0.977292537689209
Epoch: 21, Steps: 64 | Train Loss: 0.1081022 Vali Loss: 0.1570780 Test Loss: 0.2188977
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 22 cost time: 0.984825849533081
Epoch: 22, Steps: 64 | Train Loss: 0.1072137 Vali Loss: 0.1553899 Test Loss: 0.2183954
Validation loss decreased (0.156451 --> 0.155390).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 23 cost time: 0.969398021697998
Epoch: 23, Steps: 64 | Train Loss: 0.1073647 Vali Loss: 0.1553672 Test Loss: 0.2191641
Validation loss decreased (0.155390 --> 0.155367).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 24 cost time: 0.9823973178863525
Epoch: 24, Steps: 64 | Train Loss: 0.1070152 Vali Loss: 0.1551497 Test Loss: 0.2186316
Validation loss decreased (0.155367 --> 0.155150).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 25 cost time: 0.973759651184082
Epoch: 25, Steps: 64 | Train Loss: 0.1065739 Vali Loss: 0.1561318 Test Loss: 0.2194137
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 26 cost time: 0.9579994678497314
Epoch: 26, Steps: 64 | Train Loss: 0.1062094 Vali Loss: 0.1555960 Test Loss: 0.2193309
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 27 cost time: 0.9763188362121582
Epoch: 27, Steps: 64 | Train Loss: 0.1066790 Vali Loss: 0.1544104 Test Loss: 0.2195361
Validation loss decreased (0.155150 --> 0.154410).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 28 cost time: 0.9725980758666992
Epoch: 28, Steps: 64 | Train Loss: 0.1065442 Vali Loss: 0.1551247 Test Loss: 0.2189332
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 29 cost time: 0.9873380661010742
Epoch: 29, Steps: 64 | Train Loss: 0.1062188 Vali Loss: 0.1536968 Test Loss: 0.2188625
Validation loss decreased (0.154410 --> 0.153697).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 30 cost time: 0.9773430824279785
Epoch: 30, Steps: 64 | Train Loss: 0.1061241 Vali Loss: 0.1542203 Test Loss: 0.2191704
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 31 cost time: 0.9746932983398438
Epoch: 31, Steps: 64 | Train Loss: 0.1063473 Vali Loss: 0.1548365 Test Loss: 0.2182399
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 32 cost time: 0.9833204746246338
Epoch: 32, Steps: 64 | Train Loss: 0.1061316 Vali Loss: 0.1555065 Test Loss: 0.2195868
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 33 cost time: 1.0463402271270752
Epoch: 33, Steps: 64 | Train Loss: 0.1059123 Vali Loss: 0.1542124 Test Loss: 0.2185377
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 34 cost time: 1.0483877658843994
Epoch: 34, Steps: 64 | Train Loss: 0.1058439 Vali Loss: 0.1544026 Test Loss: 0.2190537
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 35 cost time: 1.0433697700500488
Epoch: 35, Steps: 64 | Train Loss: 0.1058600 Vali Loss: 0.1528051 Test Loss: 0.2189566
Validation loss decreased (0.153697 --> 0.152805).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 36 cost time: 0.9773859977722168
Epoch: 36, Steps: 64 | Train Loss: 0.1054716 Vali Loss: 0.1536421 Test Loss: 0.2194618
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 37 cost time: 0.9807260036468506
Epoch: 37, Steps: 64 | Train Loss: 0.1053294 Vali Loss: 0.1540124 Test Loss: 0.2192274
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 38 cost time: 0.9756996631622314
Epoch: 38, Steps: 64 | Train Loss: 0.1056750 Vali Loss: 0.1532099 Test Loss: 0.2204178
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 39 cost time: 0.9613347053527832
Epoch: 39, Steps: 64 | Train Loss: 0.1055424 Vali Loss: 0.1530358 Test Loss: 0.2192897
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 40 cost time: 0.9716064929962158
Epoch: 40, Steps: 64 | Train Loss: 0.1055967 Vali Loss: 0.1523450 Test Loss: 0.2198416
Validation loss decreased (0.152805 --> 0.152345).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 41 cost time: 0.9763872623443604
Epoch: 41, Steps: 64 | Train Loss: 0.1054717 Vali Loss: 0.1536496 Test Loss: 0.2200896
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 42 cost time: 0.9673302173614502
Epoch: 42, Steps: 64 | Train Loss: 0.1052969 Vali Loss: 0.1534138 Test Loss: 0.2189823
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 43 cost time: 0.9750251770019531
Epoch: 43, Steps: 64 | Train Loss: 0.1049463 Vali Loss: 0.1522121 Test Loss: 0.2192702
Validation loss decreased (0.152345 --> 0.152212).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 44 cost time: 0.9823110103607178
Epoch: 44, Steps: 64 | Train Loss: 0.1056512 Vali Loss: 0.1525184 Test Loss: 0.2190674
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 45 cost time: 0.9793267250061035
Epoch: 45, Steps: 64 | Train Loss: 0.1056095 Vali Loss: 0.1528477 Test Loss: 0.2189126
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 46 cost time: 0.9340145587921143
Epoch: 46, Steps: 64 | Train Loss: 0.1054216 Vali Loss: 0.1519378 Test Loss: 0.2189171
Validation loss decreased (0.152212 --> 0.151938).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 47 cost time: 0.9767138957977295
Epoch: 47, Steps: 64 | Train Loss: 0.1053668 Vali Loss: 0.1534719 Test Loss: 0.2191788
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 48 cost time: 0.9767007827758789
Epoch: 48, Steps: 64 | Train Loss: 0.1049806 Vali Loss: 0.1512088 Test Loss: 0.2186463
Validation loss decreased (0.151938 --> 0.151209).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 49 cost time: 0.9730002880096436
Epoch: 49, Steps: 64 | Train Loss: 0.1050174 Vali Loss: 0.1524966 Test Loss: 0.2186613
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 50 cost time: 0.97540283203125
Epoch: 50, Steps: 64 | Train Loss: 0.1050346 Vali Loss: 0.1530747 Test Loss: 0.2192223
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 51 cost time: 0.9713165760040283
Epoch: 51, Steps: 64 | Train Loss: 0.1052523 Vali Loss: 0.1519838 Test Loss: 0.2186261
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 52 cost time: 0.9812040328979492
Epoch: 52, Steps: 64 | Train Loss: 0.1052290 Vali Loss: 0.1528397 Test Loss: 0.2193354
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 53 cost time: 0.9793102741241455
Epoch: 53, Steps: 64 | Train Loss: 0.1048472 Vali Loss: 0.1534631 Test Loss: 0.2188762
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 54 cost time: 0.9813287258148193
Epoch: 54, Steps: 64 | Train Loss: 0.1050789 Vali Loss: 0.1512407 Test Loss: 0.2188221
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 55 cost time: 0.9884059429168701
Epoch: 55, Steps: 64 | Train Loss: 0.1053319 Vali Loss: 0.1520069 Test Loss: 0.2190416
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 56 cost time: 0.9729495048522949
Epoch: 56, Steps: 64 | Train Loss: 0.1052380 Vali Loss: 0.1521449 Test Loss: 0.2189956
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 57 cost time: 0.970757007598877
Epoch: 57, Steps: 64 | Train Loss: 0.1052546 Vali Loss: 0.1531933 Test Loss: 0.2187018
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 58 cost time: 0.9697036743164062
Epoch: 58, Steps: 64 | Train Loss: 0.1053305 Vali Loss: 0.1525610 Test Loss: 0.2188272
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 59 cost time: 0.9600005149841309
Epoch: 59, Steps: 64 | Train Loss: 0.1051846 Vali Loss: 0.1523397 Test Loss: 0.2191965
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 60 cost time: 0.973607063293457
Epoch: 60, Steps: 64 | Train Loss: 0.1052181 Vali Loss: 0.1521539 Test Loss: 0.2195847
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.21864627301692963, mae:0.31651735305786133, rse:0.23697644472122192
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.049469947814941406 GB
Epoch: 1 cost time: 2.287590503692627
Epoch: 1, Steps: 64 | Train Loss: 1.3154406 Vali Loss: 3.1962683 Test Loss: 5.1004505
Validation loss decreased (inf --> 3.196268).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 2 cost time: 0.9222323894500732
Epoch: 2, Steps: 64 | Train Loss: 0.8201211 Vali Loss: 0.9004264 Test Loss: 1.3289701
Validation loss decreased (3.196268 --> 0.900426).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 3 cost time: 0.9103381633758545
Epoch: 3, Steps: 64 | Train Loss: 0.3686058 Vali Loss: 0.4696482 Test Loss: 0.6100793
Validation loss decreased (0.900426 --> 0.469648).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 4 cost time: 0.9174633026123047
Epoch: 4, Steps: 64 | Train Loss: 0.2487545 Vali Loss: 0.3326683 Test Loss: 0.4156103
Validation loss decreased (0.469648 --> 0.332668).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 5 cost time: 0.9151468276977539
Epoch: 5, Steps: 64 | Train Loss: 0.1988212 Vali Loss: 0.2644775 Test Loss: 0.3173884
Validation loss decreased (0.332668 --> 0.264478).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 6 cost time: 0.9130003452301025
Epoch: 6, Steps: 64 | Train Loss: 0.1773842 Vali Loss: 0.2248543 Test Loss: 0.2670824
Validation loss decreased (0.264478 --> 0.224854).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 7 cost time: 0.9099998474121094
Epoch: 7, Steps: 64 | Train Loss: 0.1663779 Vali Loss: 0.2073673 Test Loss: 0.2487164
Validation loss decreased (0.224854 --> 0.207367).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 8 cost time: 0.905627965927124
Epoch: 8, Steps: 64 | Train Loss: 0.1582574 Vali Loss: 0.1946894 Test Loss: 0.2369464
Validation loss decreased (0.207367 --> 0.194689).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 9 cost time: 0.9186830520629883
Epoch: 9, Steps: 64 | Train Loss: 0.1529293 Vali Loss: 0.1899623 Test Loss: 0.2321334
Validation loss decreased (0.194689 --> 0.189962).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 10 cost time: 0.904393196105957
Epoch: 10, Steps: 64 | Train Loss: 0.1492449 Vali Loss: 0.1835540 Test Loss: 0.2291205
Validation loss decreased (0.189962 --> 0.183554).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 11 cost time: 0.916475772857666
Epoch: 11, Steps: 64 | Train Loss: 0.1460055 Vali Loss: 0.1777571 Test Loss: 0.2268206
Validation loss decreased (0.183554 --> 0.177757).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 12 cost time: 0.9227128028869629
Epoch: 12, Steps: 64 | Train Loss: 0.1438335 Vali Loss: 0.1792753 Test Loss: 0.2252119
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 13 cost time: 0.9177494049072266
Epoch: 13, Steps: 64 | Train Loss: 0.1415952 Vali Loss: 0.1769055 Test Loss: 0.2250945
Validation loss decreased (0.177757 --> 0.176906).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 14 cost time: 0.9169971942901611
Epoch: 14, Steps: 64 | Train Loss: 0.1396647 Vali Loss: 0.1741928 Test Loss: 0.2216699
Validation loss decreased (0.176906 --> 0.174193).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 15 cost time: 0.9086174964904785
Epoch: 15, Steps: 64 | Train Loss: 0.1374798 Vali Loss: 0.1725233 Test Loss: 0.2232203
Validation loss decreased (0.174193 --> 0.172523).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 16 cost time: 0.9284095764160156
Epoch: 16, Steps: 64 | Train Loss: 0.1363918 Vali Loss: 0.1729867 Test Loss: 0.2237929
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 17 cost time: 0.9117345809936523
Epoch: 17, Steps: 64 | Train Loss: 0.1344085 Vali Loss: 0.1717910 Test Loss: 0.2222963
Validation loss decreased (0.172523 --> 0.171791).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 18 cost time: 0.9097199440002441
Epoch: 18, Steps: 64 | Train Loss: 0.1347635 Vali Loss: 0.1722239 Test Loss: 0.2243797
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 19 cost time: 0.9237713813781738
Epoch: 19, Steps: 64 | Train Loss: 0.1331542 Vali Loss: 0.1698235 Test Loss: 0.2225236
Validation loss decreased (0.171791 --> 0.169823).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 20 cost time: 0.9199991226196289
Epoch: 20, Steps: 64 | Train Loss: 0.1313660 Vali Loss: 0.1692388 Test Loss: 0.2226325
Validation loss decreased (0.169823 --> 0.169239).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 21 cost time: 0.9189996719360352
Epoch: 21, Steps: 64 | Train Loss: 0.1317050 Vali Loss: 0.1700726 Test Loss: 0.2227135
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 22 cost time: 0.9139809608459473
Epoch: 22, Steps: 64 | Train Loss: 0.1312941 Vali Loss: 0.1674972 Test Loss: 0.2215404
Validation loss decreased (0.169239 --> 0.167497).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 23 cost time: 0.9103348255157471
Epoch: 23, Steps: 64 | Train Loss: 0.1301871 Vali Loss: 0.1690902 Test Loss: 0.2231438
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 24 cost time: 0.9123420715332031
Epoch: 24, Steps: 64 | Train Loss: 0.1299336 Vali Loss: 0.1688788 Test Loss: 0.2219110
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 25 cost time: 0.9063444137573242
Epoch: 25, Steps: 64 | Train Loss: 0.1290200 Vali Loss: 0.1665646 Test Loss: 0.2225116
Validation loss decreased (0.167497 --> 0.166565).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 26 cost time: 0.9147517681121826
Epoch: 26, Steps: 64 | Train Loss: 0.1288485 Vali Loss: 0.1668428 Test Loss: 0.2211529
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 27 cost time: 0.9049978256225586
Epoch: 27, Steps: 64 | Train Loss: 0.1288962 Vali Loss: 0.1685709 Test Loss: 0.2217458
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 28 cost time: 0.9086377620697021
Epoch: 28, Steps: 64 | Train Loss: 0.1280013 Vali Loss: 0.1667551 Test Loss: 0.2217020
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 29 cost time: 0.915402889251709
Epoch: 29, Steps: 64 | Train Loss: 0.1279317 Vali Loss: 0.1654134 Test Loss: 0.2213402
Validation loss decreased (0.166565 --> 0.165413).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 30 cost time: 0.9153783321380615
Epoch: 30, Steps: 64 | Train Loss: 0.1273260 Vali Loss: 0.1649640 Test Loss: 0.2215062
Validation loss decreased (0.165413 --> 0.164964).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 31 cost time: 0.9149651527404785
Epoch: 31, Steps: 64 | Train Loss: 0.1273398 Vali Loss: 0.1670484 Test Loss: 0.2214690
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 32 cost time: 0.9183473587036133
Epoch: 32, Steps: 64 | Train Loss: 0.1270966 Vali Loss: 0.1664719 Test Loss: 0.2216170
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 33 cost time: 0.9167327880859375
Epoch: 33, Steps: 64 | Train Loss: 0.1267625 Vali Loss: 0.1656516 Test Loss: 0.2230106
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 34 cost time: 0.9100000858306885
Epoch: 34, Steps: 64 | Train Loss: 0.1268101 Vali Loss: 0.1645468 Test Loss: 0.2214926
Validation loss decreased (0.164964 --> 0.164547).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 35 cost time: 0.9110183715820312
Epoch: 35, Steps: 64 | Train Loss: 0.1264810 Vali Loss: 0.1670644 Test Loss: 0.2226660
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 36 cost time: 0.9073395729064941
Epoch: 36, Steps: 64 | Train Loss: 0.1266340 Vali Loss: 0.1664993 Test Loss: 0.2227946
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 37 cost time: 0.9273602962493896
Epoch: 37, Steps: 64 | Train Loss: 0.1265140 Vali Loss: 0.1650925 Test Loss: 0.2215366
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 38 cost time: 0.9163608551025391
Epoch: 38, Steps: 64 | Train Loss: 0.1260428 Vali Loss: 0.1659508 Test Loss: 0.2211027
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 39 cost time: 0.9133613109588623
Epoch: 39, Steps: 64 | Train Loss: 0.1256554 Vali Loss: 0.1663418 Test Loss: 0.2233517
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 40 cost time: 0.9157602787017822
Epoch: 40, Steps: 64 | Train Loss: 0.1261644 Vali Loss: 0.1647876 Test Loss: 0.2213594
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 41 cost time: 0.9149999618530273
Epoch: 41, Steps: 64 | Train Loss: 0.1260191 Vali Loss: 0.1651007 Test Loss: 0.2218663
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 42 cost time: 0.9126160144805908
Epoch: 42, Steps: 64 | Train Loss: 0.1252033 Vali Loss: 0.1648745 Test Loss: 0.2214676
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 43 cost time: 0.9113891124725342
Epoch: 43, Steps: 64 | Train Loss: 0.1260699 Vali Loss: 0.1651100 Test Loss: 0.2216269
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 44 cost time: 0.8989815711975098
Epoch: 44, Steps: 64 | Train Loss: 0.1261444 Vali Loss: 0.1652954 Test Loss: 0.2232276
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 45 cost time: 0.9083571434020996
Epoch: 45, Steps: 64 | Train Loss: 0.1253240 Vali Loss: 0.1656332 Test Loss: 0.2221856
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 46 cost time: 0.913745641708374
Epoch: 46, Steps: 64 | Train Loss: 0.1256847 Vali Loss: 0.1644915 Test Loss: 0.2225461
Validation loss decreased (0.164547 --> 0.164491).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 47 cost time: 0.9129993915557861
Epoch: 47, Steps: 64 | Train Loss: 0.1251782 Vali Loss: 0.1637413 Test Loss: 0.2216213
Validation loss decreased (0.164491 --> 0.163741).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 48 cost time: 0.9148478507995605
Epoch: 48, Steps: 64 | Train Loss: 0.1250605 Vali Loss: 0.1651621 Test Loss: 0.2212763
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 49 cost time: 0.9166185855865479
Epoch: 49, Steps: 64 | Train Loss: 0.1251785 Vali Loss: 0.1668488 Test Loss: 0.2234295
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 50 cost time: 0.9133613109588623
Epoch: 50, Steps: 64 | Train Loss: 0.1252722 Vali Loss: 0.1652715 Test Loss: 0.2220836
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 51 cost time: 0.8955035209655762
Epoch: 51, Steps: 64 | Train Loss: 0.1250723 Vali Loss: 0.1665348 Test Loss: 0.2229678
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 52 cost time: 0.909332275390625
Epoch: 52, Steps: 64 | Train Loss: 0.1254070 Vali Loss: 0.1658526 Test Loss: 0.2226397
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 53 cost time: 0.9137933254241943
Epoch: 53, Steps: 64 | Train Loss: 0.1251026 Vali Loss: 0.1619911 Test Loss: 0.2208591
Validation loss decreased (0.163741 --> 0.161991).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 54 cost time: 0.9066112041473389
Epoch: 54, Steps: 64 | Train Loss: 0.1254291 Vali Loss: 0.1650141 Test Loss: 0.2209659
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 55 cost time: 0.9206111431121826
Epoch: 55, Steps: 64 | Train Loss: 0.1246040 Vali Loss: 0.1641535 Test Loss: 0.2225491
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 56 cost time: 0.9173281192779541
Epoch: 56, Steps: 64 | Train Loss: 0.1251400 Vali Loss: 0.1665028 Test Loss: 0.2217341
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 57 cost time: 0.9159855842590332
Epoch: 57, Steps: 64 | Train Loss: 0.1255676 Vali Loss: 0.1651646 Test Loss: 0.2218290
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 58 cost time: 0.9224255084991455
Epoch: 58, Steps: 64 | Train Loss: 0.1259039 Vali Loss: 0.1638650 Test Loss: 0.2210438
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 59 cost time: 0.9104278087615967
Epoch: 59, Steps: 64 | Train Loss: 0.1251428 Vali Loss: 0.1649763 Test Loss: 0.2219412
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 60 cost time: 0.9157426357269287
Epoch: 60, Steps: 64 | Train Loss: 0.1251125 Vali Loss: 0.1645090 Test Loss: 0.2228936
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2208591252565384, mae:0.32054466009140015, rse:0.23817260563373566
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05090188980102539 GB
Epoch: 1 cost time: 2.299532413482666
Epoch: 1, Steps: 64 | Train Loss: 0.8868200 Vali Loss: 2.2865300 Test Loss: 3.5831463
Validation loss decreased (inf --> 2.286530).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 2 cost time: 0.9286086559295654
Epoch: 2, Steps: 64 | Train Loss: 0.5366303 Vali Loss: 0.5600877 Test Loss: 0.7830467
Validation loss decreased (2.286530 --> 0.560088).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 3 cost time: 0.8883340358734131
Epoch: 3, Steps: 64 | Train Loss: 0.1980873 Vali Loss: 0.2117841 Test Loss: 0.2484647
Validation loss decreased (0.560088 --> 0.211784).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 4 cost time: 0.8913395404815674
Epoch: 4, Steps: 64 | Train Loss: 0.1400854 Vali Loss: 0.1822278 Test Loss: 0.2246272
Validation loss decreased (0.211784 --> 0.182228).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 5 cost time: 0.8820235729217529
Epoch: 5, Steps: 64 | Train Loss: 0.1304243 Vali Loss: 0.1745004 Test Loss: 0.2226003
Validation loss decreased (0.182228 --> 0.174500).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 6 cost time: 0.8743081092834473
Epoch: 6, Steps: 64 | Train Loss: 0.1254053 Vali Loss: 0.1707301 Test Loss: 0.2214399
Validation loss decreased (0.174500 --> 0.170730).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 7 cost time: 0.875
Epoch: 7, Steps: 64 | Train Loss: 0.1209158 Vali Loss: 0.1688267 Test Loss: 0.2220749
Validation loss decreased (0.170730 --> 0.168827).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 8 cost time: 0.8769998550415039
Epoch: 8, Steps: 64 | Train Loss: 0.1184494 Vali Loss: 0.1648812 Test Loss: 0.2198693
Validation loss decreased (0.168827 --> 0.164881).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 9 cost time: 0.845348596572876
Epoch: 9, Steps: 64 | Train Loss: 0.1168741 Vali Loss: 0.1622299 Test Loss: 0.2197802
Validation loss decreased (0.164881 --> 0.162230).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 10 cost time: 0.8801281452178955
Epoch: 10, Steps: 64 | Train Loss: 0.1151167 Vali Loss: 0.1604597 Test Loss: 0.2206870
Validation loss decreased (0.162230 --> 0.160460).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 11 cost time: 0.8864405155181885
Epoch: 11, Steps: 64 | Train Loss: 0.1133836 Vali Loss: 0.1584425 Test Loss: 0.2203837
Validation loss decreased (0.160460 --> 0.158443).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 12 cost time: 0.8997306823730469
Epoch: 12, Steps: 64 | Train Loss: 0.1125290 Vali Loss: 0.1569602 Test Loss: 0.2206048
Validation loss decreased (0.158443 --> 0.156960).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 13 cost time: 0.8859999179840088
Epoch: 13, Steps: 64 | Train Loss: 0.1119980 Vali Loss: 0.1581857 Test Loss: 0.2196508
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 14 cost time: 0.8866312503814697
Epoch: 14, Steps: 64 | Train Loss: 0.1105940 Vali Loss: 0.1560027 Test Loss: 0.2202519
Validation loss decreased (0.156960 --> 0.156003).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 15 cost time: 0.874394416809082
Epoch: 15, Steps: 64 | Train Loss: 0.1100561 Vali Loss: 0.1567201 Test Loss: 0.2205899
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 16 cost time: 0.8863325119018555
Epoch: 16, Steps: 64 | Train Loss: 0.1093817 Vali Loss: 0.1548351 Test Loss: 0.2197964
Validation loss decreased (0.156003 --> 0.154835).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 17 cost time: 0.8753461837768555
Epoch: 17, Steps: 64 | Train Loss: 0.1087495 Vali Loss: 0.1544026 Test Loss: 0.2204559
Validation loss decreased (0.154835 --> 0.154403).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 18 cost time: 0.8787388801574707
Epoch: 18, Steps: 64 | Train Loss: 0.1082249 Vali Loss: 0.1540638 Test Loss: 0.2206547
Validation loss decreased (0.154403 --> 0.154064).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 19 cost time: 0.8776922225952148
Epoch: 19, Steps: 64 | Train Loss: 0.1079806 Vali Loss: 0.1526202 Test Loss: 0.2208539
Validation loss decreased (0.154064 --> 0.152620).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 20 cost time: 0.8886222839355469
Epoch: 20, Steps: 64 | Train Loss: 0.1075240 Vali Loss: 0.1544232 Test Loss: 0.2215810
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 21 cost time: 0.8843421936035156
Epoch: 21, Steps: 64 | Train Loss: 0.1070533 Vali Loss: 0.1525427 Test Loss: 0.2221317
Validation loss decreased (0.152620 --> 0.152543).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 22 cost time: 0.8844316005706787
Epoch: 22, Steps: 64 | Train Loss: 0.1067728 Vali Loss: 0.1522275 Test Loss: 0.2200945
Validation loss decreased (0.152543 --> 0.152227).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 23 cost time: 0.8919832706451416
Epoch: 23, Steps: 64 | Train Loss: 0.1064071 Vali Loss: 0.1525127 Test Loss: 0.2219803
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 24 cost time: 0.8640832901000977
Epoch: 24, Steps: 64 | Train Loss: 0.1066790 Vali Loss: 0.1520445 Test Loss: 0.2217259
Validation loss decreased (0.152227 --> 0.152044).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 25 cost time: 0.8730018138885498
Epoch: 25, Steps: 64 | Train Loss: 0.1064530 Vali Loss: 0.1523398 Test Loss: 0.2221088
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 26 cost time: 0.8766043186187744
Epoch: 26, Steps: 64 | Train Loss: 0.1059212 Vali Loss: 0.1513616 Test Loss: 0.2213204
Validation loss decreased (0.152044 --> 0.151362).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 27 cost time: 0.8783540725708008
Epoch: 27, Steps: 64 | Train Loss: 0.1058120 Vali Loss: 0.1500249 Test Loss: 0.2221004
Validation loss decreased (0.151362 --> 0.150025).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 28 cost time: 0.8753697872161865
Epoch: 28, Steps: 64 | Train Loss: 0.1056994 Vali Loss: 0.1512073 Test Loss: 0.2228072
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 29 cost time: 0.8827304840087891
Epoch: 29, Steps: 64 | Train Loss: 0.1055794 Vali Loss: 0.1524954 Test Loss: 0.2216881
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 30 cost time: 0.8929998874664307
Epoch: 30, Steps: 64 | Train Loss: 0.1052389 Vali Loss: 0.1519310 Test Loss: 0.2214513
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 31 cost time: 0.8876197338104248
Epoch: 31, Steps: 64 | Train Loss: 0.1053055 Vali Loss: 0.1521149 Test Loss: 0.2222202
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 32 cost time: 0.8843991756439209
Epoch: 32, Steps: 64 | Train Loss: 0.1052501 Vali Loss: 0.1519168 Test Loss: 0.2225951
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 33 cost time: 0.8782234191894531
Epoch: 33, Steps: 64 | Train Loss: 0.1048075 Vali Loss: 0.1489698 Test Loss: 0.2213063
Validation loss decreased (0.150025 --> 0.148970).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 34 cost time: 0.892326831817627
Epoch: 34, Steps: 64 | Train Loss: 0.1051415 Vali Loss: 0.1502221 Test Loss: 0.2225366
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 35 cost time: 0.8767859935760498
Epoch: 35, Steps: 64 | Train Loss: 0.1049040 Vali Loss: 0.1503659 Test Loss: 0.2214189
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 36 cost time: 0.8779997825622559
Epoch: 36, Steps: 64 | Train Loss: 0.1049517 Vali Loss: 0.1521419 Test Loss: 0.2218731
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 37 cost time: 0.8759934902191162
Epoch: 37, Steps: 64 | Train Loss: 0.1043794 Vali Loss: 0.1498493 Test Loss: 0.2224729
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 38 cost time: 0.9030342102050781
Epoch: 38, Steps: 64 | Train Loss: 0.1048446 Vali Loss: 0.1500248 Test Loss: 0.2216168
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 39 cost time: 0.8863692283630371
Epoch: 39, Steps: 64 | Train Loss: 0.1048688 Vali Loss: 0.1504411 Test Loss: 0.2215388
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 40 cost time: 0.8864114284515381
Epoch: 40, Steps: 64 | Train Loss: 0.1049611 Vali Loss: 0.1503755 Test Loss: 0.2222290
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 41 cost time: 0.8947265148162842
Epoch: 41, Steps: 64 | Train Loss: 0.1046404 Vali Loss: 0.1498524 Test Loss: 0.2223310
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 42 cost time: 0.886620044708252
Epoch: 42, Steps: 64 | Train Loss: 0.1044922 Vali Loss: 0.1488095 Test Loss: 0.2215363
Validation loss decreased (0.148970 --> 0.148809).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 43 cost time: 0.874617338180542
Epoch: 43, Steps: 64 | Train Loss: 0.1048067 Vali Loss: 0.1501599 Test Loss: 0.2219331
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 44 cost time: 0.8803555965423584
Epoch: 44, Steps: 64 | Train Loss: 0.1042516 Vali Loss: 0.1482410 Test Loss: 0.2222173
Validation loss decreased (0.148809 --> 0.148241).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 45 cost time: 0.8803443908691406
Epoch: 45, Steps: 64 | Train Loss: 0.1046119 Vali Loss: 0.1506985 Test Loss: 0.2216451
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 46 cost time: 0.8747403621673584
Epoch: 46, Steps: 64 | Train Loss: 0.1041507 Vali Loss: 0.1506165 Test Loss: 0.2228884
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 47 cost time: 0.8809998035430908
Epoch: 47, Steps: 64 | Train Loss: 0.1044576 Vali Loss: 0.1510741 Test Loss: 0.2222070
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 48 cost time: 0.8846237659454346
Epoch: 48, Steps: 64 | Train Loss: 0.1048055 Vali Loss: 0.1501854 Test Loss: 0.2214256
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 49 cost time: 0.8578653335571289
Epoch: 49, Steps: 64 | Train Loss: 0.1044652 Vali Loss: 0.1506765 Test Loss: 0.2225642
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 50 cost time: 0.8817696571350098
Epoch: 50, Steps: 64 | Train Loss: 0.1043249 Vali Loss: 0.1502977 Test Loss: 0.2218460
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 51 cost time: 0.8898601531982422
Epoch: 51, Steps: 64 | Train Loss: 0.1048197 Vali Loss: 0.1504748 Test Loss: 0.2235874
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 52 cost time: 0.885465145111084
Epoch: 52, Steps: 64 | Train Loss: 0.1038034 Vali Loss: 0.1516939 Test Loss: 0.2230615
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 53 cost time: 0.8492908477783203
Epoch: 53, Steps: 64 | Train Loss: 0.1046517 Vali Loss: 0.1527792 Test Loss: 0.2240682
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 54 cost time: 0.8796148300170898
Epoch: 54, Steps: 64 | Train Loss: 0.1045026 Vali Loss: 0.1510378 Test Loss: 0.2220248
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 55 cost time: 0.8781538009643555
Epoch: 55, Steps: 64 | Train Loss: 0.1045237 Vali Loss: 0.1500212 Test Loss: 0.2223477
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 56 cost time: 0.9013557434082031
Epoch: 56, Steps: 64 | Train Loss: 0.1045831 Vali Loss: 0.1491189 Test Loss: 0.2214657
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 57 cost time: 0.8877718448638916
Epoch: 57, Steps: 64 | Train Loss: 0.1047654 Vali Loss: 0.1497715 Test Loss: 0.2218550
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 58 cost time: 0.8859996795654297
Epoch: 58, Steps: 64 | Train Loss: 0.1038070 Vali Loss: 0.1501368 Test Loss: 0.2221458
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 59 cost time: 0.8866276741027832
Epoch: 59, Steps: 64 | Train Loss: 0.1038203 Vali Loss: 0.1507876 Test Loss: 0.2216689
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 60 cost time: 0.8846876621246338
Epoch: 60, Steps: 64 | Train Loss: 0.1047083 Vali Loss: 0.1494341 Test Loss: 0.2221703
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22221730649471283, mae:0.3237994611263275, rse:0.23890382051467896
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05202198028564453 GB
Epoch: 1 cost time: 2.3683438301086426
Epoch: 1, Steps: 64 | Train Loss: 0.9265104 Vali Loss: 2.5040867 Test Loss: 3.9772639
Validation loss decreased (inf --> 2.504087).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 2 cost time: 0.9983503818511963
Epoch: 2, Steps: 64 | Train Loss: 0.6102579 Vali Loss: 0.7043543 Test Loss: 0.9849336
Validation loss decreased (2.504087 --> 0.704354).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 3 cost time: 0.9141910076141357
Epoch: 3, Steps: 64 | Train Loss: 0.2057066 Vali Loss: 0.2142124 Test Loss: 0.2391679
Validation loss decreased (0.704354 --> 0.214212).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 4 cost time: 0.9004614353179932
Epoch: 4, Steps: 64 | Train Loss: 0.1349721 Vali Loss: 0.1862267 Test Loss: 0.2326204
Validation loss decreased (0.214212 --> 0.186227).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 5 cost time: 0.9063541889190674
Epoch: 5, Steps: 64 | Train Loss: 0.1262919 Vali Loss: 0.1782316 Test Loss: 0.2233811
Validation loss decreased (0.186227 --> 0.178232).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 6 cost time: 0.9110002517700195
Epoch: 6, Steps: 64 | Train Loss: 0.1217128 Vali Loss: 0.1764403 Test Loss: 0.2240970
Validation loss decreased (0.178232 --> 0.176440).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 7 cost time: 0.8946216106414795
Epoch: 7, Steps: 64 | Train Loss: 0.1183623 Vali Loss: 0.1687634 Test Loss: 0.2212199
Validation loss decreased (0.176440 --> 0.168763).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 8 cost time: 0.8973908424377441
Epoch: 8, Steps: 64 | Train Loss: 0.1152863 Vali Loss: 0.1662736 Test Loss: 0.2210602
Validation loss decreased (0.168763 --> 0.166274).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 9 cost time: 0.9003968238830566
Epoch: 9, Steps: 64 | Train Loss: 0.1133586 Vali Loss: 0.1655274 Test Loss: 0.2219592
Validation loss decreased (0.166274 --> 0.165527).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 10 cost time: 0.9003777503967285
Epoch: 10, Steps: 64 | Train Loss: 0.1122421 Vali Loss: 0.1644347 Test Loss: 0.2217565
Validation loss decreased (0.165527 --> 0.164435).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 11 cost time: 0.9853765964508057
Epoch: 11, Steps: 64 | Train Loss: 0.1111317 Vali Loss: 0.1614372 Test Loss: 0.2201860
Validation loss decreased (0.164435 --> 0.161437).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 12 cost time: 0.9717748165130615
Epoch: 12, Steps: 64 | Train Loss: 0.1101493 Vali Loss: 0.1605456 Test Loss: 0.2204241
Validation loss decreased (0.161437 --> 0.160546).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 13 cost time: 0.9156181812286377
Epoch: 13, Steps: 64 | Train Loss: 0.1088226 Vali Loss: 0.1600420 Test Loss: 0.2209395
Validation loss decreased (0.160546 --> 0.160042).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 14 cost time: 0.9019937515258789
Epoch: 14, Steps: 64 | Train Loss: 0.1082868 Vali Loss: 0.1571260 Test Loss: 0.2216171
Validation loss decreased (0.160042 --> 0.157126).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 15 cost time: 0.8953752517700195
Epoch: 15, Steps: 64 | Train Loss: 0.1076571 Vali Loss: 0.1553882 Test Loss: 0.2219900
Validation loss decreased (0.157126 --> 0.155388).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 16 cost time: 0.8963398933410645
Epoch: 16, Steps: 64 | Train Loss: 0.1067788 Vali Loss: 0.1561264 Test Loss: 0.2217613
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 17 cost time: 0.9054086208343506
Epoch: 17, Steps: 64 | Train Loss: 0.1059124 Vali Loss: 0.1551077 Test Loss: 0.2219473
Validation loss decreased (0.155388 --> 0.155108).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 18 cost time: 0.9013698101043701
Epoch: 18, Steps: 64 | Train Loss: 0.1059511 Vali Loss: 0.1560538 Test Loss: 0.2220134
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 19 cost time: 0.900364875793457
Epoch: 19, Steps: 64 | Train Loss: 0.1050116 Vali Loss: 0.1525743 Test Loss: 0.2224363
Validation loss decreased (0.155108 --> 0.152574).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 20 cost time: 0.9014050960540771
Epoch: 20, Steps: 64 | Train Loss: 0.1052744 Vali Loss: 0.1536660 Test Loss: 0.2224687
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 21 cost time: 0.896613597869873
Epoch: 21, Steps: 64 | Train Loss: 0.1049576 Vali Loss: 0.1530925 Test Loss: 0.2221746
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 22 cost time: 0.8923707008361816
Epoch: 22, Steps: 64 | Train Loss: 0.1047028 Vali Loss: 0.1548925 Test Loss: 0.2221432
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 23 cost time: 0.8993971347808838
Epoch: 23, Steps: 64 | Train Loss: 0.1045155 Vali Loss: 0.1527916 Test Loss: 0.2222306
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 24 cost time: 0.9023513793945312
Epoch: 24, Steps: 64 | Train Loss: 0.1040371 Vali Loss: 0.1532770 Test Loss: 0.2220803
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 25 cost time: 0.8937115669250488
Epoch: 25, Steps: 64 | Train Loss: 0.1035676 Vali Loss: 0.1524885 Test Loss: 0.2218575
Validation loss decreased (0.152574 --> 0.152488).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 26 cost time: 0.8949997425079346
Epoch: 26, Steps: 64 | Train Loss: 0.1037289 Vali Loss: 0.1502837 Test Loss: 0.2221055
Validation loss decreased (0.152488 --> 0.150284).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 27 cost time: 0.8933396339416504
Epoch: 27, Steps: 64 | Train Loss: 0.1033750 Vali Loss: 0.1527859 Test Loss: 0.2223393
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 28 cost time: 0.8863260746002197
Epoch: 28, Steps: 64 | Train Loss: 0.1033860 Vali Loss: 0.1528452 Test Loss: 0.2223849
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 29 cost time: 0.9023587703704834
Epoch: 29, Steps: 64 | Train Loss: 0.1033827 Vali Loss: 0.1503503 Test Loss: 0.2225935
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 30 cost time: 0.8994195461273193
Epoch: 30, Steps: 64 | Train Loss: 0.1027636 Vali Loss: 0.1506152 Test Loss: 0.2225114
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 31 cost time: 0.9067666530609131
Epoch: 31, Steps: 64 | Train Loss: 0.1028813 Vali Loss: 0.1504660 Test Loss: 0.2223976
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 32 cost time: 0.9021511077880859
Epoch: 32, Steps: 64 | Train Loss: 0.1029570 Vali Loss: 0.1493451 Test Loss: 0.2223464
Validation loss decreased (0.150284 --> 0.149345).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 33 cost time: 0.8986198902130127
Epoch: 33, Steps: 64 | Train Loss: 0.1025437 Vali Loss: 0.1524181 Test Loss: 0.2227944
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 34 cost time: 0.9004113674163818
Epoch: 34, Steps: 64 | Train Loss: 0.1022790 Vali Loss: 0.1506884 Test Loss: 0.2226401
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 35 cost time: 0.9104385375976562
Epoch: 35, Steps: 64 | Train Loss: 0.1030622 Vali Loss: 0.1519536 Test Loss: 0.2225047
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 36 cost time: 0.895395040512085
Epoch: 36, Steps: 64 | Train Loss: 0.1026068 Vali Loss: 0.1514628 Test Loss: 0.2223741
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 37 cost time: 0.8957333564758301
Epoch: 37, Steps: 64 | Train Loss: 0.1021421 Vali Loss: 0.1502303 Test Loss: 0.2225835
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 38 cost time: 0.9070003032684326
Epoch: 38, Steps: 64 | Train Loss: 0.1022610 Vali Loss: 0.1516084 Test Loss: 0.2224712
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 39 cost time: 0.902620792388916
Epoch: 39, Steps: 64 | Train Loss: 0.1018483 Vali Loss: 0.1506845 Test Loss: 0.2227838
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 40 cost time: 0.9313361644744873
Epoch: 40, Steps: 64 | Train Loss: 0.1019809 Vali Loss: 0.1502232 Test Loss: 0.2228258
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 41 cost time: 0.9415502548217773
Epoch: 41, Steps: 64 | Train Loss: 0.1019629 Vali Loss: 0.1502881 Test Loss: 0.2225305
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 42 cost time: 0.9104785919189453
Epoch: 42, Steps: 64 | Train Loss: 0.1018775 Vali Loss: 0.1506584 Test Loss: 0.2226541
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 43 cost time: 0.8989999294281006
Epoch: 43, Steps: 64 | Train Loss: 0.1025343 Vali Loss: 0.1503299 Test Loss: 0.2229555
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 44 cost time: 0.8966200351715088
Epoch: 44, Steps: 64 | Train Loss: 0.1020716 Vali Loss: 0.1513084 Test Loss: 0.2226398
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 45 cost time: 0.9059998989105225
Epoch: 45, Steps: 64 | Train Loss: 0.1020284 Vali Loss: 0.1511286 Test Loss: 0.2225866
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 46 cost time: 0.8952317237854004
Epoch: 46, Steps: 64 | Train Loss: 0.1019660 Vali Loss: 0.1516334 Test Loss: 0.2226287
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 47 cost time: 0.8993048667907715
Epoch: 47, Steps: 64 | Train Loss: 0.1018070 Vali Loss: 0.1506702 Test Loss: 0.2224406
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 48 cost time: 0.9027674198150635
Epoch: 48, Steps: 64 | Train Loss: 0.1017088 Vali Loss: 0.1496391 Test Loss: 0.2226747
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 49 cost time: 0.8919963836669922
Epoch: 49, Steps: 64 | Train Loss: 0.1020748 Vali Loss: 0.1518279 Test Loss: 0.2228581
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 50 cost time: 0.9007613658905029
Epoch: 50, Steps: 64 | Train Loss: 0.1018353 Vali Loss: 0.1506066 Test Loss: 0.2224528
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 51 cost time: 0.8956212997436523
Epoch: 51, Steps: 64 | Train Loss: 0.1022113 Vali Loss: 0.1491626 Test Loss: 0.2227150
Validation loss decreased (0.149345 --> 0.149163).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 52 cost time: 0.8924024105072021
Epoch: 52, Steps: 64 | Train Loss: 0.1022274 Vali Loss: 0.1507437 Test Loss: 0.2225969
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 53 cost time: 0.90041184425354
Epoch: 53, Steps: 64 | Train Loss: 0.1021344 Vali Loss: 0.1485855 Test Loss: 0.2226167
Validation loss decreased (0.149163 --> 0.148586).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 54 cost time: 0.9010617733001709
Epoch: 54, Steps: 64 | Train Loss: 0.1020739 Vali Loss: 0.1507856 Test Loss: 0.2225330
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 55 cost time: 0.8991785049438477
Epoch: 55, Steps: 64 | Train Loss: 0.1021061 Vali Loss: 0.1494895 Test Loss: 0.2225064
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 56 cost time: 0.9140002727508545
Epoch: 56, Steps: 64 | Train Loss: 0.1019827 Vali Loss: 0.1492237 Test Loss: 0.2227474
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 57 cost time: 0.9039995670318604
Epoch: 57, Steps: 64 | Train Loss: 0.1018206 Vali Loss: 0.1502901 Test Loss: 0.2229153
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 58 cost time: 0.9036195278167725
Epoch: 58, Steps: 64 | Train Loss: 0.1016730 Vali Loss: 0.1500417 Test Loss: 0.2226299
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 59 cost time: 0.9027907848358154
Epoch: 59, Steps: 64 | Train Loss: 0.1014526 Vali Loss: 0.1504675 Test Loss: 0.2223729
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 60 cost time: 0.9173758029937744
Epoch: 60, Steps: 64 | Train Loss: 0.1013616 Vali Loss: 0.1501791 Test Loss: 0.2227900
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2226167470216751, mae:0.3261539340019226, rse:0.23911842703819275
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.049631595611572266 GB
Epoch: 1 cost time: 2.2555861473083496
Epoch: 1, Steps: 64 | Train Loss: 0.8414682 Vali Loss: 1.8431504 Test Loss: 2.9132395
Validation loss decreased (inf --> 1.843150).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 2 cost time: 0.9181623458862305
Epoch: 2, Steps: 64 | Train Loss: 0.4853015 Vali Loss: 0.4153312 Test Loss: 0.5665971
Validation loss decreased (1.843150 --> 0.415331).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 3 cost time: 0.9259984493255615
Epoch: 3, Steps: 64 | Train Loss: 0.2449643 Vali Loss: 0.2460590 Test Loss: 0.3034078
Validation loss decreased (0.415331 --> 0.246059).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 4 cost time: 0.9210760593414307
Epoch: 4, Steps: 64 | Train Loss: 0.1863867 Vali Loss: 0.2027059 Test Loss: 0.2450281
Validation loss decreased (0.246059 --> 0.202706).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 5 cost time: 0.923473596572876
Epoch: 5, Steps: 64 | Train Loss: 0.1650795 Vali Loss: 0.1880464 Test Loss: 0.2348938
Validation loss decreased (0.202706 --> 0.188046).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 6 cost time: 0.9182062149047852
Epoch: 6, Steps: 64 | Train Loss: 0.1568540 Vali Loss: 0.1822800 Test Loss: 0.2282606
Validation loss decreased (0.188046 --> 0.182280).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 7 cost time: 0.9094083309173584
Epoch: 7, Steps: 64 | Train Loss: 0.1497701 Vali Loss: 0.1789919 Test Loss: 0.2271028
Validation loss decreased (0.182280 --> 0.178992).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 8 cost time: 0.91835618019104
Epoch: 8, Steps: 64 | Train Loss: 0.1447011 Vali Loss: 0.1749985 Test Loss: 0.2246023
Validation loss decreased (0.178992 --> 0.174998).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 9 cost time: 0.9131784439086914
Epoch: 9, Steps: 64 | Train Loss: 0.1408945 Vali Loss: 0.1737125 Test Loss: 0.2252523
Validation loss decreased (0.174998 --> 0.173712).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 10 cost time: 0.929999828338623
Epoch: 10, Steps: 64 | Train Loss: 0.1378059 Vali Loss: 0.1730890 Test Loss: 0.2249539
Validation loss decreased (0.173712 --> 0.173089).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 11 cost time: 0.9230003356933594
Epoch: 11, Steps: 64 | Train Loss: 0.1358782 Vali Loss: 0.1715351 Test Loss: 0.2242447
Validation loss decreased (0.173089 --> 0.171535).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 12 cost time: 0.9236278533935547
Epoch: 12, Steps: 64 | Train Loss: 0.1354755 Vali Loss: 0.1689599 Test Loss: 0.2231162
Validation loss decreased (0.171535 --> 0.168960).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 13 cost time: 0.926398515701294
Epoch: 13, Steps: 64 | Train Loss: 0.1327308 Vali Loss: 0.1710507 Test Loss: 0.2252351
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 14 cost time: 0.925361156463623
Epoch: 14, Steps: 64 | Train Loss: 0.1309963 Vali Loss: 0.1689844 Test Loss: 0.2243002
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 15 cost time: 0.91335129737854
Epoch: 15, Steps: 64 | Train Loss: 0.1289836 Vali Loss: 0.1671342 Test Loss: 0.2222912
Validation loss decreased (0.168960 --> 0.167134).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 16 cost time: 0.9173781871795654
Epoch: 16, Steps: 64 | Train Loss: 0.1291802 Vali Loss: 0.1689582 Test Loss: 0.2234977
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 17 cost time: 0.930274248123169
Epoch: 17, Steps: 64 | Train Loss: 0.1289216 Vali Loss: 0.1662713 Test Loss: 0.2225091
Validation loss decreased (0.167134 --> 0.166271).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 18 cost time: 0.9149997234344482
Epoch: 18, Steps: 64 | Train Loss: 0.1270477 Vali Loss: 0.1664164 Test Loss: 0.2236109
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 19 cost time: 0.9256119728088379
Epoch: 19, Steps: 64 | Train Loss: 0.1262061 Vali Loss: 0.1664154 Test Loss: 0.2223760
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 20 cost time: 0.9260873794555664
Epoch: 20, Steps: 64 | Train Loss: 0.1253542 Vali Loss: 0.1658897 Test Loss: 0.2243811
Validation loss decreased (0.166271 --> 0.165890).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 21 cost time: 1.0004446506500244
Epoch: 21, Steps: 64 | Train Loss: 0.1242172 Vali Loss: 0.1655770 Test Loss: 0.2221721
Validation loss decreased (0.165890 --> 0.165577).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 22 cost time: 0.998438835144043
Epoch: 22, Steps: 64 | Train Loss: 0.1248361 Vali Loss: 0.1651848 Test Loss: 0.2229723
Validation loss decreased (0.165577 --> 0.165185).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 23 cost time: 0.9394075870513916
Epoch: 23, Steps: 64 | Train Loss: 0.1240302 Vali Loss: 0.1642785 Test Loss: 0.2233011
Validation loss decreased (0.165185 --> 0.164278).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 24 cost time: 0.9197723865509033
Epoch: 24, Steps: 64 | Train Loss: 0.1248425 Vali Loss: 0.1637792 Test Loss: 0.2214105
Validation loss decreased (0.164278 --> 0.163779).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 25 cost time: 0.915726900100708
Epoch: 25, Steps: 64 | Train Loss: 0.1237449 Vali Loss: 0.1641542 Test Loss: 0.2218907
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 26 cost time: 0.9150006771087646
Epoch: 26, Steps: 64 | Train Loss: 0.1226289 Vali Loss: 0.1647296 Test Loss: 0.2219600
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 27 cost time: 0.9166266918182373
Epoch: 27, Steps: 64 | Train Loss: 0.1226529 Vali Loss: 0.1639097 Test Loss: 0.2227518
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 28 cost time: 0.9243323802947998
Epoch: 28, Steps: 64 | Train Loss: 0.1228247 Vali Loss: 0.1633616 Test Loss: 0.2219758
Validation loss decreased (0.163779 --> 0.163362).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 29 cost time: 0.9213676452636719
Epoch: 29, Steps: 64 | Train Loss: 0.1225160 Vali Loss: 0.1635530 Test Loss: 0.2222415
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 30 cost time: 0.9210221767425537
Epoch: 30, Steps: 64 | Train Loss: 0.1223883 Vali Loss: 0.1609790 Test Loss: 0.2227215
Validation loss decreased (0.163362 --> 0.160979).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 31 cost time: 0.9176836013793945
Epoch: 31, Steps: 64 | Train Loss: 0.1220460 Vali Loss: 0.1638784 Test Loss: 0.2223897
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 32 cost time: 0.9148151874542236
Epoch: 32, Steps: 64 | Train Loss: 0.1218935 Vali Loss: 0.1642540 Test Loss: 0.2217200
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 33 cost time: 0.9160006046295166
Epoch: 33, Steps: 64 | Train Loss: 0.1216807 Vali Loss: 0.1641283 Test Loss: 0.2218582
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 34 cost time: 0.9290015697479248
Epoch: 34, Steps: 64 | Train Loss: 0.1213460 Vali Loss: 0.1641328 Test Loss: 0.2223160
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 35 cost time: 0.9196228981018066
Epoch: 35, Steps: 64 | Train Loss: 0.1216563 Vali Loss: 0.1625198 Test Loss: 0.2218250
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 36 cost time: 0.9163837432861328
Epoch: 36, Steps: 64 | Train Loss: 0.1209279 Vali Loss: 0.1615083 Test Loss: 0.2211758
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 37 cost time: 0.9213509559631348
Epoch: 37, Steps: 64 | Train Loss: 0.1206753 Vali Loss: 0.1624641 Test Loss: 0.2226282
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 38 cost time: 0.9304232597351074
Epoch: 38, Steps: 64 | Train Loss: 0.1210125 Vali Loss: 0.1616296 Test Loss: 0.2213343
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 39 cost time: 0.928025484085083
Epoch: 39, Steps: 64 | Train Loss: 0.1210056 Vali Loss: 0.1630733 Test Loss: 0.2221235
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 40 cost time: 0.9228231906890869
Epoch: 40, Steps: 64 | Train Loss: 0.1207010 Vali Loss: 0.1623053 Test Loss: 0.2218679
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 41 cost time: 0.9113204479217529
Epoch: 41, Steps: 64 | Train Loss: 0.1206966 Vali Loss: 0.1622363 Test Loss: 0.2221242
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 42 cost time: 0.923595666885376
Epoch: 42, Steps: 64 | Train Loss: 0.1209456 Vali Loss: 0.1621531 Test Loss: 0.2225326
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 43 cost time: 0.9357507228851318
Epoch: 43, Steps: 64 | Train Loss: 0.1208645 Vali Loss: 0.1621048 Test Loss: 0.2227547
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 44 cost time: 0.9333279132843018
Epoch: 44, Steps: 64 | Train Loss: 0.1201369 Vali Loss: 0.1627987 Test Loss: 0.2216768
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 45 cost time: 0.9223423004150391
Epoch: 45, Steps: 64 | Train Loss: 0.1203952 Vali Loss: 0.1627693 Test Loss: 0.2214676
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 46 cost time: 0.9393415451049805
Epoch: 46, Steps: 64 | Train Loss: 0.1208673 Vali Loss: 0.1598381 Test Loss: 0.2208172
Validation loss decreased (0.160979 --> 0.159838).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 47 cost time: 0.9427449703216553
Epoch: 47, Steps: 64 | Train Loss: 0.1206830 Vali Loss: 0.1610447 Test Loss: 0.2213944
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 48 cost time: 0.9275121688842773
Epoch: 48, Steps: 64 | Train Loss: 0.1205268 Vali Loss: 0.1619395 Test Loss: 0.2228137
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 49 cost time: 0.9880001544952393
Epoch: 49, Steps: 64 | Train Loss: 0.1205519 Vali Loss: 0.1621968 Test Loss: 0.2228123
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 50 cost time: 0.9196178913116455
Epoch: 50, Steps: 64 | Train Loss: 0.1203037 Vali Loss: 0.1608751 Test Loss: 0.2214949
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 51 cost time: 0.92836594581604
Epoch: 51, Steps: 64 | Train Loss: 0.1191812 Vali Loss: 0.1618892 Test Loss: 0.2222144
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 52 cost time: 0.9220073223114014
Epoch: 52, Steps: 64 | Train Loss: 0.1204588 Vali Loss: 0.1614823 Test Loss: 0.2211708
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 53 cost time: 0.9153687953948975
Epoch: 53, Steps: 64 | Train Loss: 0.1204560 Vali Loss: 0.1620849 Test Loss: 0.2221148
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 54 cost time: 0.9173576831817627
Epoch: 54, Steps: 64 | Train Loss: 0.1199453 Vali Loss: 0.1614872 Test Loss: 0.2220730
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 55 cost time: 0.9347193241119385
Epoch: 55, Steps: 64 | Train Loss: 0.1206472 Vali Loss: 0.1630319 Test Loss: 0.2228988
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 56 cost time: 0.9234218597412109
Epoch: 56, Steps: 64 | Train Loss: 0.1199625 Vali Loss: 0.1622838 Test Loss: 0.2218883
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 57 cost time: 0.9196226596832275
Epoch: 57, Steps: 64 | Train Loss: 0.1203232 Vali Loss: 0.1625381 Test Loss: 0.2222147
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 58 cost time: 0.9364645481109619
Epoch: 58, Steps: 64 | Train Loss: 0.1201391 Vali Loss: 0.1638663 Test Loss: 0.2226445
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 59 cost time: 0.920539379119873
Epoch: 59, Steps: 64 | Train Loss: 0.1201139 Vali Loss: 0.1628556 Test Loss: 0.2225431
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 60 cost time: 0.9094886779785156
Epoch: 60, Steps: 64 | Train Loss: 0.1193145 Vali Loss: 0.1620893 Test Loss: 0.2218397
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2208171933889389, mae:0.32566067576408386, rse:0.2381500005722046
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05106353759765625 GB
Epoch: 1 cost time: 2.2264113426208496
Epoch: 1, Steps: 64 | Train Loss: 0.9503798 Vali Loss: 2.4407177 Test Loss: 3.8145010
Validation loss decreased (inf --> 2.440718).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 2 cost time: 0.8806231021881104
Epoch: 2, Steps: 64 | Train Loss: 0.5612343 Vali Loss: 0.5978848 Test Loss: 0.7983037
Validation loss decreased (2.440718 --> 0.597885).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 3 cost time: 0.8836362361907959
Epoch: 3, Steps: 64 | Train Loss: 0.2083026 Vali Loss: 0.2370107 Test Loss: 0.2786752
Validation loss decreased (0.597885 --> 0.237011).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 4 cost time: 0.8793563842773438
Epoch: 4, Steps: 64 | Train Loss: 0.1406687 Vali Loss: 0.1735241 Test Loss: 0.2204346
Validation loss decreased (0.237011 --> 0.173524).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 5 cost time: 0.8827359676361084
Epoch: 5, Steps: 64 | Train Loss: 0.1278786 Vali Loss: 0.1684340 Test Loss: 0.2174496
Validation loss decreased (0.173524 --> 0.168434).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 6 cost time: 0.8783509731292725
Epoch: 6, Steps: 64 | Train Loss: 0.1229228 Vali Loss: 0.1650485 Test Loss: 0.2184051
Validation loss decreased (0.168434 --> 0.165048).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 7 cost time: 0.8811261653900146
Epoch: 7, Steps: 64 | Train Loss: 0.1194508 Vali Loss: 0.1632169 Test Loss: 0.2191327
Validation loss decreased (0.165048 --> 0.163217).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 8 cost time: 0.8789997100830078
Epoch: 8, Steps: 64 | Train Loss: 0.1172743 Vali Loss: 0.1632028 Test Loss: 0.2183928
Validation loss decreased (0.163217 --> 0.163203).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 9 cost time: 0.8806283473968506
Epoch: 9, Steps: 64 | Train Loss: 0.1154423 Vali Loss: 0.1608631 Test Loss: 0.2190574
Validation loss decreased (0.163203 --> 0.160863).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 10 cost time: 0.8814096450805664
Epoch: 10, Steps: 64 | Train Loss: 0.1141653 Vali Loss: 0.1622255 Test Loss: 0.2207351
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 11 cost time: 0.8813786506652832
Epoch: 11, Steps: 64 | Train Loss: 0.1129869 Vali Loss: 0.1606179 Test Loss: 0.2199228
Validation loss decreased (0.160863 --> 0.160618).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 12 cost time: 0.8764102458953857
Epoch: 12, Steps: 64 | Train Loss: 0.1120612 Vali Loss: 0.1597455 Test Loss: 0.2202150
Validation loss decreased (0.160618 --> 0.159745).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 13 cost time: 0.9007606506347656
Epoch: 13, Steps: 64 | Train Loss: 0.1115522 Vali Loss: 0.1583832 Test Loss: 0.2198642
Validation loss decreased (0.159745 --> 0.158383).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 14 cost time: 0.8787481784820557
Epoch: 14, Steps: 64 | Train Loss: 0.1103978 Vali Loss: 0.1566643 Test Loss: 0.2202915
Validation loss decreased (0.158383 --> 0.156664).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 15 cost time: 0.8756170272827148
Epoch: 15, Steps: 64 | Train Loss: 0.1100242 Vali Loss: 0.1585191 Test Loss: 0.2207142
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 16 cost time: 0.8823366165161133
Epoch: 16, Steps: 64 | Train Loss: 0.1098043 Vali Loss: 0.1573784 Test Loss: 0.2213222
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 17 cost time: 0.8793764114379883
Epoch: 17, Steps: 64 | Train Loss: 0.1090422 Vali Loss: 0.1584994 Test Loss: 0.2207895
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 18 cost time: 0.8834831714630127
Epoch: 18, Steps: 64 | Train Loss: 0.1081101 Vali Loss: 0.1572928 Test Loss: 0.2203970
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 19 cost time: 0.8812575340270996
Epoch: 19, Steps: 64 | Train Loss: 0.1080173 Vali Loss: 0.1555893 Test Loss: 0.2205595
Validation loss decreased (0.156664 --> 0.155589).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 20 cost time: 0.9019997119903564
Epoch: 20, Steps: 64 | Train Loss: 0.1073434 Vali Loss: 0.1540413 Test Loss: 0.2203268
Validation loss decreased (0.155589 --> 0.154041).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 21 cost time: 0.8786149024963379
Epoch: 21, Steps: 64 | Train Loss: 0.1076968 Vali Loss: 0.1554263 Test Loss: 0.2206473
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 22 cost time: 0.8783566951751709
Epoch: 22, Steps: 64 | Train Loss: 0.1070233 Vali Loss: 0.1564346 Test Loss: 0.2215414
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 23 cost time: 0.8811252117156982
Epoch: 23, Steps: 64 | Train Loss: 0.1067009 Vali Loss: 0.1542585 Test Loss: 0.2221012
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 24 cost time: 0.8400039672851562
Epoch: 24, Steps: 64 | Train Loss: 0.1060931 Vali Loss: 0.1569362 Test Loss: 0.2209523
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 25 cost time: 0.8349981307983398
Epoch: 25, Steps: 64 | Train Loss: 0.1063727 Vali Loss: 0.1551104 Test Loss: 0.2201342
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 26 cost time: 0.8680007457733154
Epoch: 26, Steps: 64 | Train Loss: 0.1067310 Vali Loss: 0.1556126 Test Loss: 0.2211603
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 27 cost time: 0.8764572143554688
Epoch: 27, Steps: 64 | Train Loss: 0.1055623 Vali Loss: 0.1542460 Test Loss: 0.2214949
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 28 cost time: 0.8793277740478516
Epoch: 28, Steps: 64 | Train Loss: 0.1054282 Vali Loss: 0.1544615 Test Loss: 0.2211039
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 29 cost time: 0.8803977966308594
Epoch: 29, Steps: 64 | Train Loss: 0.1054402 Vali Loss: 0.1548693 Test Loss: 0.2217644
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 30 cost time: 0.8827295303344727
Epoch: 30, Steps: 64 | Train Loss: 0.1052340 Vali Loss: 0.1552921 Test Loss: 0.2219116
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 31 cost time: 0.8751969337463379
Epoch: 31, Steps: 64 | Train Loss: 0.1052185 Vali Loss: 0.1548181 Test Loss: 0.2213105
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 32 cost time: 0.9660232067108154
Epoch: 32, Steps: 64 | Train Loss: 0.1051914 Vali Loss: 0.1530494 Test Loss: 0.2210416
Validation loss decreased (0.154041 --> 0.153049).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 33 cost time: 0.9643867015838623
Epoch: 33, Steps: 64 | Train Loss: 0.1049736 Vali Loss: 0.1552881 Test Loss: 0.2217767
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 34 cost time: 0.9253804683685303
Epoch: 34, Steps: 64 | Train Loss: 0.1050101 Vali Loss: 0.1523291 Test Loss: 0.2209999
Validation loss decreased (0.153049 --> 0.152329).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 35 cost time: 0.8793580532073975
Epoch: 35, Steps: 64 | Train Loss: 0.1055084 Vali Loss: 0.1525023 Test Loss: 0.2211759
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 36 cost time: 0.8794281482696533
Epoch: 36, Steps: 64 | Train Loss: 0.1047936 Vali Loss: 0.1540240 Test Loss: 0.2227021
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 37 cost time: 0.8824095726013184
Epoch: 37, Steps: 64 | Train Loss: 0.1046414 Vali Loss: 0.1545400 Test Loss: 0.2206710
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 38 cost time: 0.8959996700286865
Epoch: 38, Steps: 64 | Train Loss: 0.1049323 Vali Loss: 0.1554553 Test Loss: 0.2223146
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 39 cost time: 0.8796324729919434
Epoch: 39, Steps: 64 | Train Loss: 0.1043702 Vali Loss: 0.1531770 Test Loss: 0.2211303
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 40 cost time: 0.8874194622039795
Epoch: 40, Steps: 64 | Train Loss: 0.1046217 Vali Loss: 0.1547874 Test Loss: 0.2212119
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 41 cost time: 0.8854339122772217
Epoch: 41, Steps: 64 | Train Loss: 0.1046482 Vali Loss: 0.1546343 Test Loss: 0.2219395
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 42 cost time: 0.8824491500854492
Epoch: 42, Steps: 64 | Train Loss: 0.1046468 Vali Loss: 0.1523098 Test Loss: 0.2216033
Validation loss decreased (0.152329 --> 0.152310).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 43 cost time: 0.8917324542999268
Epoch: 43, Steps: 64 | Train Loss: 0.1040783 Vali Loss: 0.1516396 Test Loss: 0.2206400
Validation loss decreased (0.152310 --> 0.151640).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 44 cost time: 0.880000114440918
Epoch: 44, Steps: 64 | Train Loss: 0.1049504 Vali Loss: 0.1534047 Test Loss: 0.2215217
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 45 cost time: 0.8786087036132812
Epoch: 45, Steps: 64 | Train Loss: 0.1048556 Vali Loss: 0.1533587 Test Loss: 0.2214938
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 46 cost time: 0.8673887252807617
Epoch: 46, Steps: 64 | Train Loss: 0.1044011 Vali Loss: 0.1522878 Test Loss: 0.2211318
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 47 cost time: 0.885432243347168
Epoch: 47, Steps: 64 | Train Loss: 0.1043953 Vali Loss: 0.1536934 Test Loss: 0.2213146
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 48 cost time: 0.8808164596557617
Epoch: 48, Steps: 64 | Train Loss: 0.1043034 Vali Loss: 0.1542954 Test Loss: 0.2222398
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 49 cost time: 0.8690009117126465
Epoch: 49, Steps: 64 | Train Loss: 0.1045875 Vali Loss: 0.1522652 Test Loss: 0.2226050
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 50 cost time: 0.882382869720459
Epoch: 50, Steps: 64 | Train Loss: 0.1046189 Vali Loss: 0.1523313 Test Loss: 0.2210852
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 51 cost time: 0.887423038482666
Epoch: 51, Steps: 64 | Train Loss: 0.1048458 Vali Loss: 0.1521249 Test Loss: 0.2215412
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 52 cost time: 0.8883767127990723
Epoch: 52, Steps: 64 | Train Loss: 0.1046591 Vali Loss: 0.1520489 Test Loss: 0.2207329
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 53 cost time: 0.8527815341949463
Epoch: 53, Steps: 64 | Train Loss: 0.1041878 Vali Loss: 0.1532305 Test Loss: 0.2208622
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 54 cost time: 0.848463773727417
Epoch: 54, Steps: 64 | Train Loss: 0.1045588 Vali Loss: 0.1529281 Test Loss: 0.2220121
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 55 cost time: 0.8670012950897217
Epoch: 55, Steps: 64 | Train Loss: 0.1047009 Vali Loss: 0.1549165 Test Loss: 0.2216284
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 56 cost time: 0.8966207504272461
Epoch: 56, Steps: 64 | Train Loss: 0.1041556 Vali Loss: 0.1536372 Test Loss: 0.2211376
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 57 cost time: 0.884540319442749
Epoch: 57, Steps: 64 | Train Loss: 0.1043935 Vali Loss: 0.1528296 Test Loss: 0.2219680
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 58 cost time: 0.8833541870117188
Epoch: 58, Steps: 64 | Train Loss: 0.1046351 Vali Loss: 0.1539187 Test Loss: 0.2216323
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 59 cost time: 0.8847663402557373
Epoch: 59, Steps: 64 | Train Loss: 0.1044950 Vali Loss: 0.1548499 Test Loss: 0.2201568
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 60 cost time: 0.8969998359680176
Epoch: 60, Steps: 64 | Train Loss: 0.1044557 Vali Loss: 0.1533070 Test Loss: 0.2213714
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22064001858234406, mae:0.3220042288303375, rse:0.23805443942546844
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.05218362808227539 GB
Epoch: 1 cost time: 2.4295871257781982
Epoch: 1, Steps: 64 | Train Loss: 0.8525401 Vali Loss: 2.2702613 Test Loss: 3.6006768
Validation loss decreased (inf --> 2.270261).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 2 cost time: 0.9826188087463379
Epoch: 2, Steps: 64 | Train Loss: 0.5395447 Vali Loss: 0.5768046 Test Loss: 0.7865878
Validation loss decreased (2.270261 --> 0.576805).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 3 cost time: 0.9834105968475342
Epoch: 3, Steps: 64 | Train Loss: 0.1858095 Vali Loss: 0.2030420 Test Loss: 0.2611784
Validation loss decreased (0.576805 --> 0.203042).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 4 cost time: 0.9868354797363281
Epoch: 4, Steps: 64 | Train Loss: 0.1360315 Vali Loss: 0.1852243 Test Loss: 0.2450136
Validation loss decreased (0.203042 --> 0.185224).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 5 cost time: 0.9889786243438721
Epoch: 5, Steps: 64 | Train Loss: 0.1252293 Vali Loss: 0.1746547 Test Loss: 0.2345730
Validation loss decreased (0.185224 --> 0.174655).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 6 cost time: 0.9843654632568359
Epoch: 6, Steps: 64 | Train Loss: 0.1197519 Vali Loss: 0.1716682 Test Loss: 0.2337173
Validation loss decreased (0.174655 --> 0.171668).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 7 cost time: 0.9773516654968262
Epoch: 7, Steps: 64 | Train Loss: 0.1169400 Vali Loss: 0.1685226 Test Loss: 0.2273131
Validation loss decreased (0.171668 --> 0.168523).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 8 cost time: 0.9754257202148438
Epoch: 8, Steps: 64 | Train Loss: 0.1149807 Vali Loss: 0.1646842 Test Loss: 0.2267362
Validation loss decreased (0.168523 --> 0.164684).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 9 cost time: 0.9817519187927246
Epoch: 9, Steps: 64 | Train Loss: 0.1126577 Vali Loss: 0.1644177 Test Loss: 0.2296824
Validation loss decreased (0.164684 --> 0.164418).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 10 cost time: 0.9868209362030029
Epoch: 10, Steps: 64 | Train Loss: 0.1117264 Vali Loss: 0.1612264 Test Loss: 0.2273513
Validation loss decreased (0.164418 --> 0.161226).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 11 cost time: 0.9847569465637207
Epoch: 11, Steps: 64 | Train Loss: 0.1105692 Vali Loss: 0.1621527 Test Loss: 0.2262405
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 12 cost time: 0.9844033718109131
Epoch: 12, Steps: 64 | Train Loss: 0.1101028 Vali Loss: 0.1620172 Test Loss: 0.2281332
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 13 cost time: 0.9980003833770752
Epoch: 13, Steps: 64 | Train Loss: 0.1092824 Vali Loss: 0.1610425 Test Loss: 0.2265765
Validation loss decreased (0.161226 --> 0.161043).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 14 cost time: 0.9786171913146973
Epoch: 14, Steps: 64 | Train Loss: 0.1080254 Vali Loss: 0.1567261 Test Loss: 0.2247340
Validation loss decreased (0.161043 --> 0.156726).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 15 cost time: 0.9806277751922607
Epoch: 15, Steps: 64 | Train Loss: 0.1075975 Vali Loss: 0.1602828 Test Loss: 0.2273196
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 16 cost time: 0.9898130893707275
Epoch: 16, Steps: 64 | Train Loss: 0.1073974 Vali Loss: 0.1580088 Test Loss: 0.2260749
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 17 cost time: 0.9954361915588379
Epoch: 17, Steps: 64 | Train Loss: 0.1072452 Vali Loss: 0.1584582 Test Loss: 0.2252737
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 18 cost time: 1.0013248920440674
Epoch: 18, Steps: 64 | Train Loss: 0.1064055 Vali Loss: 0.1572237 Test Loss: 0.2258031
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 19 cost time: 1.009312391281128
Epoch: 19, Steps: 64 | Train Loss: 0.1065506 Vali Loss: 0.1583230 Test Loss: 0.2259805
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 20 cost time: 0.9680314064025879
Epoch: 20, Steps: 64 | Train Loss: 0.1062563 Vali Loss: 0.1586452 Test Loss: 0.2269640
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 21 cost time: 1.007326602935791
Epoch: 21, Steps: 64 | Train Loss: 0.1057136 Vali Loss: 0.1550039 Test Loss: 0.2259873
Validation loss decreased (0.156726 --> 0.155004).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 22 cost time: 0.9983627796173096
Epoch: 22, Steps: 64 | Train Loss: 0.1055161 Vali Loss: 0.1579997 Test Loss: 0.2269438
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 23 cost time: 0.9604339599609375
Epoch: 23, Steps: 64 | Train Loss: 0.1053518 Vali Loss: 0.1574371 Test Loss: 0.2269881
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 24 cost time: 0.9733426570892334
Epoch: 24, Steps: 64 | Train Loss: 0.1047170 Vali Loss: 0.1553305 Test Loss: 0.2261517
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 25 cost time: 0.9789998531341553
Epoch: 25, Steps: 64 | Train Loss: 0.1045739 Vali Loss: 0.1553180 Test Loss: 0.2256127
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 26 cost time: 0.9748086929321289
Epoch: 26, Steps: 64 | Train Loss: 0.1046865 Vali Loss: 0.1556062 Test Loss: 0.2272078
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 27 cost time: 0.9826147556304932
Epoch: 27, Steps: 64 | Train Loss: 0.1048873 Vali Loss: 0.1549852 Test Loss: 0.2252590
Validation loss decreased (0.155004 --> 0.154985).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 28 cost time: 0.9860923290252686
Epoch: 28, Steps: 64 | Train Loss: 0.1044278 Vali Loss: 0.1557940 Test Loss: 0.2263956
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 29 cost time: 0.9983315467834473
Epoch: 29, Steps: 64 | Train Loss: 0.1038111 Vali Loss: 0.1541314 Test Loss: 0.2259252
Validation loss decreased (0.154985 --> 0.154131).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 30 cost time: 0.9843387603759766
Epoch: 30, Steps: 64 | Train Loss: 0.1033575 Vali Loss: 0.1545732 Test Loss: 0.2270060
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 31 cost time: 0.9753997325897217
Epoch: 31, Steps: 64 | Train Loss: 0.1037463 Vali Loss: 0.1538116 Test Loss: 0.2250551
Validation loss decreased (0.154131 --> 0.153812).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 32 cost time: 0.9943647384643555
Epoch: 32, Steps: 64 | Train Loss: 0.1037581 Vali Loss: 0.1552590 Test Loss: 0.2260687
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 33 cost time: 0.9763448238372803
Epoch: 33, Steps: 64 | Train Loss: 0.1036182 Vali Loss: 0.1545154 Test Loss: 0.2270208
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 34 cost time: 0.9747483730316162
Epoch: 34, Steps: 64 | Train Loss: 0.1034983 Vali Loss: 0.1546226 Test Loss: 0.2262206
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 35 cost time: 0.9827682971954346
Epoch: 35, Steps: 64 | Train Loss: 0.1037745 Vali Loss: 0.1538055 Test Loss: 0.2268107
Validation loss decreased (0.153812 --> 0.153805).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 36 cost time: 1.000746250152588
Epoch: 36, Steps: 64 | Train Loss: 0.1033377 Vali Loss: 0.1546368 Test Loss: 0.2280529
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 37 cost time: 0.9859988689422607
Epoch: 37, Steps: 64 | Train Loss: 0.1038259 Vali Loss: 0.1546567 Test Loss: 0.2252187
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 38 cost time: 0.9836196899414062
Epoch: 38, Steps: 64 | Train Loss: 0.1031249 Vali Loss: 0.1537445 Test Loss: 0.2258954
Validation loss decreased (0.153805 --> 0.153744).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 39 cost time: 0.9726145267486572
Epoch: 39, Steps: 64 | Train Loss: 0.1037046 Vali Loss: 0.1537310 Test Loss: 0.2257287
Validation loss decreased (0.153744 --> 0.153731).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 40 cost time: 0.9761064052581787
Epoch: 40, Steps: 64 | Train Loss: 0.1037099 Vali Loss: 0.1521025 Test Loss: 0.2251045
Validation loss decreased (0.153731 --> 0.152102).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 41 cost time: 0.9713587760925293
Epoch: 41, Steps: 64 | Train Loss: 0.1034484 Vali Loss: 0.1555990 Test Loss: 0.2274736
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 42 cost time: 0.9763965606689453
Epoch: 42, Steps: 64 | Train Loss: 0.1028967 Vali Loss: 0.1547986 Test Loss: 0.2255996
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 43 cost time: 0.9793412685394287
Epoch: 43, Steps: 64 | Train Loss: 0.1030908 Vali Loss: 0.1545147 Test Loss: 0.2261217
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 44 cost time: 0.9814009666442871
Epoch: 44, Steps: 64 | Train Loss: 0.1029115 Vali Loss: 0.1518278 Test Loss: 0.2258488
Validation loss decreased (0.152102 --> 0.151828).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 45 cost time: 0.9824268817901611
Epoch: 45, Steps: 64 | Train Loss: 0.1032457 Vali Loss: 0.1513118 Test Loss: 0.2258505
Validation loss decreased (0.151828 --> 0.151312).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 46 cost time: 0.9757969379425049
Epoch: 46, Steps: 64 | Train Loss: 0.1030229 Vali Loss: 0.1529096 Test Loss: 0.2275024
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 47 cost time: 0.9867599010467529
Epoch: 47, Steps: 64 | Train Loss: 0.1031608 Vali Loss: 0.1547371 Test Loss: 0.2281600
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 48 cost time: 0.9797329902648926
Epoch: 48, Steps: 64 | Train Loss: 0.1030157 Vali Loss: 0.1534330 Test Loss: 0.2251252
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 49 cost time: 0.9936246871948242
Epoch: 49, Steps: 64 | Train Loss: 0.1028062 Vali Loss: 0.1522616 Test Loss: 0.2266045
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 50 cost time: 0.9750704765319824
Epoch: 50, Steps: 64 | Train Loss: 0.1028976 Vali Loss: 0.1540975 Test Loss: 0.2257544
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 51 cost time: 0.9763607978820801
Epoch: 51, Steps: 64 | Train Loss: 0.1030310 Vali Loss: 0.1531997 Test Loss: 0.2251848
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 52 cost time: 0.9901371002197266
Epoch: 52, Steps: 64 | Train Loss: 0.1031572 Vali Loss: 0.1523564 Test Loss: 0.2254943
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 53 cost time: 0.9844343662261963
Epoch: 53, Steps: 64 | Train Loss: 0.1028187 Vali Loss: 0.1529537 Test Loss: 0.2266774
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 54 cost time: 0.9883677959442139
Epoch: 54, Steps: 64 | Train Loss: 0.1032189 Vali Loss: 0.1534099 Test Loss: 0.2270644
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 55 cost time: 0.9984526634216309
Epoch: 55, Steps: 64 | Train Loss: 0.1029726 Vali Loss: 0.1536764 Test Loss: 0.2271963
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 56 cost time: 0.9773402214050293
Epoch: 56, Steps: 64 | Train Loss: 0.1028952 Vali Loss: 0.1537073 Test Loss: 0.2258658
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 57 cost time: 0.9777779579162598
Epoch: 57, Steps: 64 | Train Loss: 0.1027937 Vali Loss: 0.1539490 Test Loss: 0.2260502
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 58 cost time: 0.9777681827545166
Epoch: 58, Steps: 64 | Train Loss: 0.1030103 Vali Loss: 0.1522009 Test Loss: 0.2268153
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 59 cost time: 0.9670000076293945
Epoch: 59, Steps: 64 | Train Loss: 0.1032031 Vali Loss: 0.1530350 Test Loss: 0.2257262
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 60 cost time: 0.983623743057251
Epoch: 60, Steps: 64 | Train Loss: 0.1026558 Vali Loss: 0.1529897 Test Loss: 0.2273033
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.225850448012352, mae:0.3288328945636749, rse:0.2408488690853119
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.04979372024536133 GB
Epoch: 1 cost time: 2.25569486618042
Epoch: 1, Steps: 64 | Train Loss: 1.3332178 Vali Loss: 3.2067342 Test Loss: 5.0012755
Validation loss decreased (inf --> 3.206734).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 2 cost time: 0.9443678855895996
Epoch: 2, Steps: 64 | Train Loss: 0.7767051 Vali Loss: 0.8586988 Test Loss: 1.2206601
Validation loss decreased (3.206734 --> 0.858699).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 3 cost time: 0.9334843158721924
Epoch: 3, Steps: 64 | Train Loss: 0.3708730 Vali Loss: 0.4533826 Test Loss: 0.6029417
Validation loss decreased (0.858699 --> 0.453383).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 4 cost time: 0.9313571453094482
Epoch: 4, Steps: 64 | Train Loss: 0.2388391 Vali Loss: 0.2650658 Test Loss: 0.3195896
Validation loss decreased (0.453383 --> 0.265066).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 5 cost time: 0.9353642463684082
Epoch: 5, Steps: 64 | Train Loss: 0.1876787 Vali Loss: 0.2170578 Test Loss: 0.2597783
Validation loss decreased (0.265066 --> 0.217058).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 6 cost time: 0.9284086227416992
Epoch: 6, Steps: 64 | Train Loss: 0.1705274 Vali Loss: 0.1986342 Test Loss: 0.2443451
Validation loss decreased (0.217058 --> 0.198634).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 7 cost time: 0.931999683380127
Epoch: 7, Steps: 64 | Train Loss: 0.1611170 Vali Loss: 0.1871216 Test Loss: 0.2363150
Validation loss decreased (0.198634 --> 0.187122).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 8 cost time: 0.9318311214447021
Epoch: 8, Steps: 64 | Train Loss: 0.1548246 Vali Loss: 0.1824215 Test Loss: 0.2315760
Validation loss decreased (0.187122 --> 0.182422).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 9 cost time: 0.9201829433441162
Epoch: 9, Steps: 64 | Train Loss: 0.1496271 Vali Loss: 0.1779497 Test Loss: 0.2303113
Validation loss decreased (0.182422 --> 0.177950).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 10 cost time: 0.9353406429290771
Epoch: 10, Steps: 64 | Train Loss: 0.1471264 Vali Loss: 0.1737083 Test Loss: 0.2264487
Validation loss decreased (0.177950 --> 0.173708).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 11 cost time: 0.9369699954986572
Epoch: 11, Steps: 64 | Train Loss: 0.1443277 Vali Loss: 0.1716496 Test Loss: 0.2272577
Validation loss decreased (0.173708 --> 0.171650).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 12 cost time: 0.9469907283782959
Epoch: 12, Steps: 64 | Train Loss: 0.1412788 Vali Loss: 0.1692865 Test Loss: 0.2250338
Validation loss decreased (0.171650 --> 0.169287).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 13 cost time: 0.9974966049194336
Epoch: 13, Steps: 64 | Train Loss: 0.1401326 Vali Loss: 0.1695404 Test Loss: 0.2249471
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 14 cost time: 0.9237732887268066
Epoch: 14, Steps: 64 | Train Loss: 0.1381366 Vali Loss: 0.1682360 Test Loss: 0.2240746
Validation loss decreased (0.169287 --> 0.168236).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 15 cost time: 0.9298241138458252
Epoch: 15, Steps: 64 | Train Loss: 0.1377716 Vali Loss: 0.1682685 Test Loss: 0.2236228
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 16 cost time: 0.9329993724822998
Epoch: 16, Steps: 64 | Train Loss: 0.1360073 Vali Loss: 0.1676345 Test Loss: 0.2239824
Validation loss decreased (0.168236 --> 0.167635).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 17 cost time: 0.934736967086792
Epoch: 17, Steps: 64 | Train Loss: 0.1348959 Vali Loss: 0.1650283 Test Loss: 0.2237909
Validation loss decreased (0.167635 --> 0.165028).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 18 cost time: 0.9705519676208496
Epoch: 18, Steps: 64 | Train Loss: 0.1340400 Vali Loss: 0.1653781 Test Loss: 0.2241666
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 19 cost time: 0.9662356376647949
Epoch: 19, Steps: 64 | Train Loss: 0.1324197 Vali Loss: 0.1650360 Test Loss: 0.2235699
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 20 cost time: 0.9362647533416748
Epoch: 20, Steps: 64 | Train Loss: 0.1320141 Vali Loss: 0.1648616 Test Loss: 0.2240886
Validation loss decreased (0.165028 --> 0.164862).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 21 cost time: 0.9325535297393799
Epoch: 21, Steps: 64 | Train Loss: 0.1315370 Vali Loss: 0.1627491 Test Loss: 0.2230093
Validation loss decreased (0.164862 --> 0.162749).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 22 cost time: 0.9454464912414551
Epoch: 22, Steps: 64 | Train Loss: 0.1308403 Vali Loss: 0.1628540 Test Loss: 0.2230788
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 23 cost time: 0.9216024875640869
Epoch: 23, Steps: 64 | Train Loss: 0.1314297 Vali Loss: 0.1635072 Test Loss: 0.2234247
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 24 cost time: 0.9277498722076416
Epoch: 24, Steps: 64 | Train Loss: 0.1303652 Vali Loss: 0.1632555 Test Loss: 0.2238542
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 25 cost time: 0.9269998073577881
Epoch: 25, Steps: 64 | Train Loss: 0.1296862 Vali Loss: 0.1640685 Test Loss: 0.2228019
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 26 cost time: 0.9335281848907471
Epoch: 26, Steps: 64 | Train Loss: 0.1294613 Vali Loss: 0.1630290 Test Loss: 0.2236968
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 27 cost time: 0.9343791007995605
Epoch: 27, Steps: 64 | Train Loss: 0.1289347 Vali Loss: 0.1629640 Test Loss: 0.2227812
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 28 cost time: 0.9353945255279541
Epoch: 28, Steps: 64 | Train Loss: 0.1293340 Vali Loss: 0.1634995 Test Loss: 0.2229974
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 29 cost time: 0.9333808422088623
Epoch: 29, Steps: 64 | Train Loss: 0.1284333 Vali Loss: 0.1609330 Test Loss: 0.2228535
Validation loss decreased (0.162749 --> 0.160933).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 30 cost time: 0.9304070472717285
Epoch: 30, Steps: 64 | Train Loss: 0.1276580 Vali Loss: 0.1615112 Test Loss: 0.2231206
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 31 cost time: 0.9334378242492676
Epoch: 31, Steps: 64 | Train Loss: 0.1277679 Vali Loss: 0.1612886 Test Loss: 0.2227876
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 32 cost time: 0.9300003051757812
Epoch: 32, Steps: 64 | Train Loss: 0.1270951 Vali Loss: 0.1621306 Test Loss: 0.2219824
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 33 cost time: 0.9379997253417969
Epoch: 33, Steps: 64 | Train Loss: 0.1273428 Vali Loss: 0.1617370 Test Loss: 0.2237643
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 34 cost time: 0.924614667892456
Epoch: 34, Steps: 64 | Train Loss: 0.1278497 Vali Loss: 0.1615323 Test Loss: 0.2230454
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 35 cost time: 0.9263672828674316
Epoch: 35, Steps: 64 | Train Loss: 0.1273183 Vali Loss: 0.1619856 Test Loss: 0.2220482
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 36 cost time: 0.9483668804168701
Epoch: 36, Steps: 64 | Train Loss: 0.1271112 Vali Loss: 0.1590578 Test Loss: 0.2227967
Validation loss decreased (0.160933 --> 0.159058).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 37 cost time: 0.9343507289886475
Epoch: 37, Steps: 64 | Train Loss: 0.1268892 Vali Loss: 0.1611695 Test Loss: 0.2233609
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 38 cost time: 0.9324443340301514
Epoch: 38, Steps: 64 | Train Loss: 0.1270432 Vali Loss: 0.1611241 Test Loss: 0.2227681
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 39 cost time: 0.9311423301696777
Epoch: 39, Steps: 64 | Train Loss: 0.1268952 Vali Loss: 0.1605890 Test Loss: 0.2224633
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 40 cost time: 0.9280002117156982
Epoch: 40, Steps: 64 | Train Loss: 0.1261363 Vali Loss: 0.1611433 Test Loss: 0.2219951
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 41 cost time: 0.9296157360076904
Epoch: 41, Steps: 64 | Train Loss: 0.1262164 Vali Loss: 0.1604874 Test Loss: 0.2223303
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 42 cost time: 0.9286181926727295
Epoch: 42, Steps: 64 | Train Loss: 0.1265251 Vali Loss: 0.1599990 Test Loss: 0.2229277
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 43 cost time: 0.9317770004272461
Epoch: 43, Steps: 64 | Train Loss: 0.1257854 Vali Loss: 0.1606205 Test Loss: 0.2225318
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 44 cost time: 0.9295709133148193
Epoch: 44, Steps: 64 | Train Loss: 0.1265327 Vali Loss: 0.1594531 Test Loss: 0.2229593
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 45 cost time: 0.9283442497253418
Epoch: 45, Steps: 64 | Train Loss: 0.1257898 Vali Loss: 0.1600751 Test Loss: 0.2227995
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 46 cost time: 0.9413533210754395
Epoch: 46, Steps: 64 | Train Loss: 0.1257706 Vali Loss: 0.1598800 Test Loss: 0.2240898
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 47 cost time: 0.9347505569458008
Epoch: 47, Steps: 64 | Train Loss: 0.1265806 Vali Loss: 0.1606849 Test Loss: 0.2228084
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 48 cost time: 0.9320006370544434
Epoch: 48, Steps: 64 | Train Loss: 0.1253551 Vali Loss: 0.1620407 Test Loss: 0.2228401
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 49 cost time: 0.9296512603759766
Epoch: 49, Steps: 64 | Train Loss: 0.1259930 Vali Loss: 0.1605872 Test Loss: 0.2228372
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 50 cost time: 0.9273769855499268
Epoch: 50, Steps: 64 | Train Loss: 0.1263230 Vali Loss: 0.1614585 Test Loss: 0.2228853
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 51 cost time: 0.9264366626739502
Epoch: 51, Steps: 64 | Train Loss: 0.1257995 Vali Loss: 0.1609110 Test Loss: 0.2223808
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 52 cost time: 0.926487922668457
Epoch: 52, Steps: 64 | Train Loss: 0.1262263 Vali Loss: 0.1598578 Test Loss: 0.2225285
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 53 cost time: 0.9513306617736816
Epoch: 53, Steps: 64 | Train Loss: 0.1262209 Vali Loss: 0.1609697 Test Loss: 0.2223948
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 54 cost time: 0.9314627647399902
Epoch: 54, Steps: 64 | Train Loss: 0.1266510 Vali Loss: 0.1590577 Test Loss: 0.2223559
Validation loss decreased (0.159058 --> 0.159058).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 55 cost time: 0.9307727813720703
Epoch: 55, Steps: 64 | Train Loss: 0.1263430 Vali Loss: 0.1591063 Test Loss: 0.2226554
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 56 cost time: 0.9324047565460205
Epoch: 56, Steps: 64 | Train Loss: 0.1261984 Vali Loss: 0.1613408 Test Loss: 0.2229409
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 57 cost time: 0.9556279182434082
Epoch: 57, Steps: 64 | Train Loss: 0.1264069 Vali Loss: 0.1601703 Test Loss: 0.2222880
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 58 cost time: 0.9556097984313965
Epoch: 58, Steps: 64 | Train Loss: 0.1253813 Vali Loss: 0.1599936 Test Loss: 0.2222186
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 59 cost time: 0.9845972061157227
Epoch: 59, Steps: 64 | Train Loss: 0.1257010 Vali Loss: 0.1620717 Test Loss: 0.2232060
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 60 cost time: 0.9484994411468506
Epoch: 60, Steps: 64 | Train Loss: 0.1254891 Vali Loss: 0.1620793 Test Loss: 0.2226417
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22235584259033203, mae:0.32764261960983276, rse:0.23897826671600342
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05122566223144531 GB
Epoch: 1 cost time: 2.339906930923462
Epoch: 1, Steps: 64 | Train Loss: 1.0929706 Vali Loss: 2.8106623 Test Loss: 4.5453386
Validation loss decreased (inf --> 2.810662).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 2 cost time: 0.9707016944885254
Epoch: 2, Steps: 64 | Train Loss: 0.5554341 Vali Loss: 0.4620224 Test Loss: 0.6291475
Validation loss decreased (2.810662 --> 0.462022).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 3 cost time: 0.9805130958557129
Epoch: 3, Steps: 64 | Train Loss: 0.1825882 Vali Loss: 0.2161886 Test Loss: 0.2520016
Validation loss decreased (0.462022 --> 0.216189).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 4 cost time: 0.9717884063720703
Epoch: 4, Steps: 64 | Train Loss: 0.1409535 Vali Loss: 0.1897465 Test Loss: 0.2329684
Validation loss decreased (0.216189 --> 0.189747).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 5 cost time: 0.9289999008178711
Epoch: 5, Steps: 64 | Train Loss: 0.1333645 Vali Loss: 0.1863418 Test Loss: 0.2286512
Validation loss decreased (0.189747 --> 0.186342).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 6 cost time: 0.9504039287567139
Epoch: 6, Steps: 64 | Train Loss: 0.1290752 Vali Loss: 0.1804029 Test Loss: 0.2255428
Validation loss decreased (0.186342 --> 0.180403).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 7 cost time: 0.9466183185577393
Epoch: 7, Steps: 64 | Train Loss: 0.1257252 Vali Loss: 0.1755694 Test Loss: 0.2230797
Validation loss decreased (0.180403 --> 0.175569).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 8 cost time: 0.9499988555908203
Epoch: 8, Steps: 64 | Train Loss: 0.1225095 Vali Loss: 0.1742546 Test Loss: 0.2212098
Validation loss decreased (0.175569 --> 0.174255).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 9 cost time: 0.9473536014556885
Epoch: 9, Steps: 64 | Train Loss: 0.1208981 Vali Loss: 0.1704398 Test Loss: 0.2208410
Validation loss decreased (0.174255 --> 0.170440).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 10 cost time: 0.9681909084320068
Epoch: 10, Steps: 64 | Train Loss: 0.1192657 Vali Loss: 0.1687122 Test Loss: 0.2208877
Validation loss decreased (0.170440 --> 0.168712).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 11 cost time: 0.9603691101074219
Epoch: 11, Steps: 64 | Train Loss: 0.1176684 Vali Loss: 0.1674482 Test Loss: 0.2195066
Validation loss decreased (0.168712 --> 0.167448).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 12 cost time: 0.9624242782592773
Epoch: 12, Steps: 64 | Train Loss: 0.1167763 Vali Loss: 0.1657198 Test Loss: 0.2188374
Validation loss decreased (0.167448 --> 0.165720).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 13 cost time: 0.9803447723388672
Epoch: 13, Steps: 64 | Train Loss: 0.1160655 Vali Loss: 0.1649353 Test Loss: 0.2188076
Validation loss decreased (0.165720 --> 0.164935).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 14 cost time: 0.9577255249023438
Epoch: 14, Steps: 64 | Train Loss: 0.1148215 Vali Loss: 0.1642872 Test Loss: 0.2179749
Validation loss decreased (0.164935 --> 0.164287).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 15 cost time: 0.9578726291656494
Epoch: 15, Steps: 64 | Train Loss: 0.1138018 Vali Loss: 0.1638603 Test Loss: 0.2181362
Validation loss decreased (0.164287 --> 0.163860).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 16 cost time: 0.9570000171661377
Epoch: 16, Steps: 64 | Train Loss: 0.1130502 Vali Loss: 0.1633999 Test Loss: 0.2188874
Validation loss decreased (0.163860 --> 0.163400).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 17 cost time: 0.9549546241760254
Epoch: 17, Steps: 64 | Train Loss: 0.1127421 Vali Loss: 0.1609384 Test Loss: 0.2179637
Validation loss decreased (0.163400 --> 0.160938).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 18 cost time: 0.9626731872558594
Epoch: 18, Steps: 64 | Train Loss: 0.1120251 Vali Loss: 0.1596882 Test Loss: 0.2167872
Validation loss decreased (0.160938 --> 0.159688).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 19 cost time: 0.9602322578430176
Epoch: 19, Steps: 64 | Train Loss: 0.1115649 Vali Loss: 0.1614902 Test Loss: 0.2179426
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 20 cost time: 0.9573178291320801
Epoch: 20, Steps: 64 | Train Loss: 0.1116021 Vali Loss: 0.1572125 Test Loss: 0.2168664
Validation loss decreased (0.159688 --> 0.157213).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 21 cost time: 0.9644443988800049
Epoch: 21, Steps: 64 | Train Loss: 0.1110404 Vali Loss: 0.1601707 Test Loss: 0.2171076
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 22 cost time: 0.9804568290710449
Epoch: 22, Steps: 64 | Train Loss: 0.1104878 Vali Loss: 0.1591738 Test Loss: 0.2168895
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 23 cost time: 0.9674417972564697
Epoch: 23, Steps: 64 | Train Loss: 0.1103066 Vali Loss: 0.1599297 Test Loss: 0.2178969
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 24 cost time: 0.9507582187652588
Epoch: 24, Steps: 64 | Train Loss: 0.1100772 Vali Loss: 0.1607324 Test Loss: 0.2173706
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 25 cost time: 0.9605419635772705
Epoch: 25, Steps: 64 | Train Loss: 0.1098581 Vali Loss: 0.1601145 Test Loss: 0.2192367
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 26 cost time: 0.9618330001831055
Epoch: 26, Steps: 64 | Train Loss: 0.1094575 Vali Loss: 0.1582204 Test Loss: 0.2173498
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 27 cost time: 0.9546093940734863
Epoch: 27, Steps: 64 | Train Loss: 0.1092884 Vali Loss: 0.1579808 Test Loss: 0.2167128
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 28 cost time: 0.9653925895690918
Epoch: 28, Steps: 64 | Train Loss: 0.1089744 Vali Loss: 0.1586172 Test Loss: 0.2175256
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 29 cost time: 0.9683282375335693
Epoch: 29, Steps: 64 | Train Loss: 0.1090618 Vali Loss: 0.1573141 Test Loss: 0.2178475
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 30 cost time: 0.9848549365997314
Epoch: 30, Steps: 64 | Train Loss: 0.1091584 Vali Loss: 0.1577907 Test Loss: 0.2173995
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 31 cost time: 0.9550044536590576
Epoch: 31, Steps: 64 | Train Loss: 0.1091905 Vali Loss: 0.1583408 Test Loss: 0.2181102
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 32 cost time: 0.9500179290771484
Epoch: 32, Steps: 64 | Train Loss: 0.1085745 Vali Loss: 0.1556959 Test Loss: 0.2175462
Validation loss decreased (0.157213 --> 0.155696).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 33 cost time: 0.962367057800293
Epoch: 33, Steps: 64 | Train Loss: 0.1086163 Vali Loss: 0.1566651 Test Loss: 0.2175716
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 34 cost time: 0.9543609619140625
Epoch: 34, Steps: 64 | Train Loss: 0.1084145 Vali Loss: 0.1573964 Test Loss: 0.2183800
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 35 cost time: 0.9623904228210449
Epoch: 35, Steps: 64 | Train Loss: 0.1082920 Vali Loss: 0.1565466 Test Loss: 0.2179855
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 36 cost time: 0.9650001525878906
Epoch: 36, Steps: 64 | Train Loss: 0.1081979 Vali Loss: 0.1561182 Test Loss: 0.2175142
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 37 cost time: 0.9626245498657227
Epoch: 37, Steps: 64 | Train Loss: 0.1082826 Vali Loss: 0.1587404 Test Loss: 0.2182645
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 38 cost time: 0.9644510746002197
Epoch: 38, Steps: 64 | Train Loss: 0.1082030 Vali Loss: 0.1550635 Test Loss: 0.2178528
Validation loss decreased (0.155696 --> 0.155064).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 39 cost time: 0.9593827724456787
Epoch: 39, Steps: 64 | Train Loss: 0.1082700 Vali Loss: 0.1557245 Test Loss: 0.2173883
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 40 cost time: 0.9643397331237793
Epoch: 40, Steps: 64 | Train Loss: 0.1078637 Vali Loss: 0.1549020 Test Loss: 0.2184146
Validation loss decreased (0.155064 --> 0.154902).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 41 cost time: 0.9553642272949219
Epoch: 41, Steps: 64 | Train Loss: 0.1074365 Vali Loss: 0.1574704 Test Loss: 0.2179431
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 42 cost time: 0.9534475803375244
Epoch: 42, Steps: 64 | Train Loss: 0.1082301 Vali Loss: 0.1560088 Test Loss: 0.2175574
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 43 cost time: 0.958853006362915
Epoch: 43, Steps: 64 | Train Loss: 0.1081486 Vali Loss: 0.1559815 Test Loss: 0.2175753
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 44 cost time: 0.9514398574829102
Epoch: 44, Steps: 64 | Train Loss: 0.1079157 Vali Loss: 0.1557327 Test Loss: 0.2179077
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 45 cost time: 0.9596836566925049
Epoch: 45, Steps: 64 | Train Loss: 0.1078884 Vali Loss: 0.1572315 Test Loss: 0.2186994
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 46 cost time: 0.956230640411377
Epoch: 46, Steps: 64 | Train Loss: 0.1077762 Vali Loss: 0.1546153 Test Loss: 0.2183656
Validation loss decreased (0.154902 --> 0.154615).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 47 cost time: 0.9549801349639893
Epoch: 47, Steps: 64 | Train Loss: 0.1074765 Vali Loss: 0.1573022 Test Loss: 0.2166535
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 48 cost time: 0.9593460559844971
Epoch: 48, Steps: 64 | Train Loss: 0.1077061 Vali Loss: 0.1546716 Test Loss: 0.2182421
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 49 cost time: 0.9613282680511475
Epoch: 49, Steps: 64 | Train Loss: 0.1072165 Vali Loss: 0.1536197 Test Loss: 0.2179566
Validation loss decreased (0.154615 --> 0.153620).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 50 cost time: 0.9759819507598877
Epoch: 50, Steps: 64 | Train Loss: 0.1077923 Vali Loss: 0.1545620 Test Loss: 0.2170594
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 51 cost time: 0.9764065742492676
Epoch: 51, Steps: 64 | Train Loss: 0.1077956 Vali Loss: 0.1568950 Test Loss: 0.2185511
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 52 cost time: 0.9783101081848145
Epoch: 52, Steps: 64 | Train Loss: 0.1077217 Vali Loss: 0.1567295 Test Loss: 0.2182148
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 53 cost time: 0.9838416576385498
Epoch: 53, Steps: 64 | Train Loss: 0.1077892 Vali Loss: 0.1576947 Test Loss: 0.2176755
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 54 cost time: 0.9847748279571533
Epoch: 54, Steps: 64 | Train Loss: 0.1076410 Vali Loss: 0.1548022 Test Loss: 0.2178448
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 55 cost time: 0.9877307415008545
Epoch: 55, Steps: 64 | Train Loss: 0.1075758 Vali Loss: 0.1539680 Test Loss: 0.2168136
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 56 cost time: 0.9785981178283691
Epoch: 56, Steps: 64 | Train Loss: 0.1074350 Vali Loss: 0.1543331 Test Loss: 0.2169442
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 57 cost time: 0.9545071125030518
Epoch: 57, Steps: 64 | Train Loss: 0.1073274 Vali Loss: 0.1549607 Test Loss: 0.2183718
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 58 cost time: 0.9532191753387451
Epoch: 58, Steps: 64 | Train Loss: 0.1077209 Vali Loss: 0.1553909 Test Loss: 0.2164500
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 59 cost time: 0.9504306316375732
Epoch: 59, Steps: 64 | Train Loss: 0.1077486 Vali Loss: 0.1545298 Test Loss: 0.2178188
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 60 cost time: 0.9616460800170898
Epoch: 60, Steps: 64 | Train Loss: 0.1076017 Vali Loss: 0.1552391 Test Loss: 0.2173097
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2179565578699112, mae:0.3145214319229126, rse:0.23660238087177277
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05234575271606445 GB
Epoch: 1 cost time: 2.334127426147461
Epoch: 1, Steps: 64 | Train Loss: 0.8725942 Vali Loss: 2.3224227 Test Loss: 3.7147515
Validation loss decreased (inf --> 2.322423).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 2 cost time: 0.9919867515563965
Epoch: 2, Steps: 64 | Train Loss: 0.5266736 Vali Loss: 0.5432265 Test Loss: 0.7238384
Validation loss decreased (2.322423 --> 0.543227).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 3 cost time: 0.9854342937469482
Epoch: 3, Steps: 64 | Train Loss: 0.1797193 Vali Loss: 0.2254915 Test Loss: 0.2459671
Validation loss decreased (0.543227 --> 0.225491).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 4 cost time: 0.9864227771759033
Epoch: 4, Steps: 64 | Train Loss: 0.1322181 Vali Loss: 0.1888414 Test Loss: 0.2238893
Validation loss decreased (0.225491 --> 0.188841).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 5 cost time: 0.9917609691619873
Epoch: 5, Steps: 64 | Train Loss: 0.1238123 Vali Loss: 0.1814302 Test Loss: 0.2225374
Validation loss decreased (0.188841 --> 0.181430).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 6 cost time: 0.9860000610351562
Epoch: 6, Steps: 64 | Train Loss: 0.1197884 Vali Loss: 0.1735235 Test Loss: 0.2170743
Validation loss decreased (0.181430 --> 0.173523).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 7 cost time: 0.9750010967254639
Epoch: 7, Steps: 64 | Train Loss: 0.1169659 Vali Loss: 0.1699146 Test Loss: 0.2189893
Validation loss decreased (0.173523 --> 0.169915).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 8 cost time: 0.9749956130981445
Epoch: 8, Steps: 64 | Train Loss: 0.1143442 Vali Loss: 0.1665480 Test Loss: 0.2186493
Validation loss decreased (0.169915 --> 0.166548).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 9 cost time: 0.9746284484863281
Epoch: 9, Steps: 64 | Train Loss: 0.1124942 Vali Loss: 0.1602428 Test Loss: 0.2166001
Validation loss decreased (0.166548 --> 0.160243).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 10 cost time: 0.9943838119506836
Epoch: 10, Steps: 64 | Train Loss: 0.1109600 Vali Loss: 0.1629300 Test Loss: 0.2182830
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 11 cost time: 0.9853873252868652
Epoch: 11, Steps: 64 | Train Loss: 0.1099849 Vali Loss: 0.1606044 Test Loss: 0.2182444
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 12 cost time: 0.9875242710113525
Epoch: 12, Steps: 64 | Train Loss: 0.1083601 Vali Loss: 0.1559243 Test Loss: 0.2173014
Validation loss decreased (0.160243 --> 0.155924).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 13 cost time: 1.005009651184082
Epoch: 13, Steps: 64 | Train Loss: 0.1075173 Vali Loss: 0.1563191 Test Loss: 0.2195498
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 14 cost time: 0.9783902168273926
Epoch: 14, Steps: 64 | Train Loss: 0.1062881 Vali Loss: 0.1561275 Test Loss: 0.2195282
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 15 cost time: 0.9783933162689209
Epoch: 15, Steps: 64 | Train Loss: 0.1056783 Vali Loss: 0.1534795 Test Loss: 0.2186640
Validation loss decreased (0.155924 --> 0.153480).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 16 cost time: 0.9803268909454346
Epoch: 16, Steps: 64 | Train Loss: 0.1047035 Vali Loss: 0.1527875 Test Loss: 0.2186893
Validation loss decreased (0.153480 --> 0.152788).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 17 cost time: 0.9910032749176025
Epoch: 17, Steps: 64 | Train Loss: 0.1044354 Vali Loss: 0.1541680 Test Loss: 0.2206782
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 18 cost time: 0.9904453754425049
Epoch: 18, Steps: 64 | Train Loss: 0.1034968 Vali Loss: 0.1537490 Test Loss: 0.2214147
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 19 cost time: 0.9930014610290527
Epoch: 19, Steps: 64 | Train Loss: 0.1034642 Vali Loss: 0.1529025 Test Loss: 0.2216552
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 20 cost time: 0.9672026634216309
Epoch: 20, Steps: 64 | Train Loss: 0.1033507 Vali Loss: 0.1504549 Test Loss: 0.2201146
Validation loss decreased (0.152788 --> 0.150455).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 21 cost time: 1.0674049854278564
Epoch: 21, Steps: 64 | Train Loss: 0.1022848 Vali Loss: 0.1510489 Test Loss: 0.2213985
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 22 cost time: 1.0656235218048096
Epoch: 22, Steps: 64 | Train Loss: 0.1021150 Vali Loss: 0.1516728 Test Loss: 0.2214897
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 23 cost time: 0.9607088565826416
Epoch: 23, Steps: 64 | Train Loss: 0.1020754 Vali Loss: 0.1503654 Test Loss: 0.2220320
Validation loss decreased (0.150455 --> 0.150365).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 24 cost time: 0.965390682220459
Epoch: 24, Steps: 64 | Train Loss: 0.1015995 Vali Loss: 0.1505092 Test Loss: 0.2224648
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 25 cost time: 0.9773974418640137
Epoch: 25, Steps: 64 | Train Loss: 0.1013708 Vali Loss: 0.1511473 Test Loss: 0.2229654
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 26 cost time: 0.9770634174346924
Epoch: 26, Steps: 64 | Train Loss: 0.1013678 Vali Loss: 0.1504972 Test Loss: 0.2234286
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 27 cost time: 0.986365556716919
Epoch: 27, Steps: 64 | Train Loss: 0.1012359 Vali Loss: 0.1493726 Test Loss: 0.2219570
Validation loss decreased (0.150365 --> 0.149373).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 28 cost time: 0.9853849411010742
Epoch: 28, Steps: 64 | Train Loss: 0.1006678 Vali Loss: 0.1479766 Test Loss: 0.2220880
Validation loss decreased (0.149373 --> 0.147977).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 29 cost time: 1.0113811492919922
Epoch: 29, Steps: 64 | Train Loss: 0.1003899 Vali Loss: 0.1493160 Test Loss: 0.2232036
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 30 cost time: 0.9823427200317383
Epoch: 30, Steps: 64 | Train Loss: 0.1007498 Vali Loss: 0.1483434 Test Loss: 0.2224453
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 31 cost time: 0.9828214645385742
Epoch: 31, Steps: 64 | Train Loss: 0.1012583 Vali Loss: 0.1466150 Test Loss: 0.2226014
Validation loss decreased (0.147977 --> 0.146615).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 32 cost time: 0.9917314052581787
Epoch: 32, Steps: 64 | Train Loss: 0.1004698 Vali Loss: 0.1488301 Test Loss: 0.2225496
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 33 cost time: 0.9814121723175049
Epoch: 33, Steps: 64 | Train Loss: 0.1004394 Vali Loss: 0.1504036 Test Loss: 0.2242570
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 34 cost time: 0.9876296520233154
Epoch: 34, Steps: 64 | Train Loss: 0.1002142 Vali Loss: 0.1506429 Test Loss: 0.2223186
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 35 cost time: 0.985619068145752
Epoch: 35, Steps: 64 | Train Loss: 0.1002797 Vali Loss: 0.1485930 Test Loss: 0.2243367
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 36 cost time: 0.993462324142456
Epoch: 36, Steps: 64 | Train Loss: 0.1005850 Vali Loss: 0.1484692 Test Loss: 0.2229850
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 37 cost time: 0.9857742786407471
Epoch: 37, Steps: 64 | Train Loss: 0.1000525 Vali Loss: 0.1491966 Test Loss: 0.2240006
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 38 cost time: 0.982367992401123
Epoch: 38, Steps: 64 | Train Loss: 0.1003396 Vali Loss: 0.1489910 Test Loss: 0.2234797
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 39 cost time: 0.9783871173858643
Epoch: 39, Steps: 64 | Train Loss: 0.1003124 Vali Loss: 0.1501920 Test Loss: 0.2237757
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 40 cost time: 0.9794332981109619
Epoch: 40, Steps: 64 | Train Loss: 0.1001345 Vali Loss: 0.1471036 Test Loss: 0.2231829
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 41 cost time: 0.9780478477478027
Epoch: 41, Steps: 64 | Train Loss: 0.1003422 Vali Loss: 0.1475979 Test Loss: 0.2235011
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 42 cost time: 0.9783220291137695
Epoch: 42, Steps: 64 | Train Loss: 0.1003942 Vali Loss: 0.1488928 Test Loss: 0.2223410
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 43 cost time: 0.9867308139801025
Epoch: 43, Steps: 64 | Train Loss: 0.0996285 Vali Loss: 0.1489148 Test Loss: 0.2235818
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 44 cost time: 0.9858250617980957
Epoch: 44, Steps: 64 | Train Loss: 0.1000987 Vali Loss: 0.1487646 Test Loss: 0.2233249
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 45 cost time: 0.9963479042053223
Epoch: 45, Steps: 64 | Train Loss: 0.0996691 Vali Loss: 0.1483161 Test Loss: 0.2237036
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 46 cost time: 0.9886219501495361
Epoch: 46, Steps: 64 | Train Loss: 0.1002856 Vali Loss: 0.1506398 Test Loss: 0.2239406
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 47 cost time: 0.9776098728179932
Epoch: 47, Steps: 64 | Train Loss: 0.0997636 Vali Loss: 0.1471419 Test Loss: 0.2220937
EarlyStopping counter: 16 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 48 cost time: 0.978421688079834
Epoch: 48, Steps: 64 | Train Loss: 0.1001192 Vali Loss: 0.1470584 Test Loss: 0.2237947
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 49 cost time: 0.9877903461456299
Epoch: 49, Steps: 64 | Train Loss: 0.0998024 Vali Loss: 0.1477789 Test Loss: 0.2222890
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 50 cost time: 0.9773385524749756
Epoch: 50, Steps: 64 | Train Loss: 0.1001084 Vali Loss: 0.1484763 Test Loss: 0.2235911
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 51 cost time: 0.9803733825683594
Epoch: 51, Steps: 64 | Train Loss: 0.0998657 Vali Loss: 0.1471547 Test Loss: 0.2225813
EarlyStopping counter: 20 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 52 cost time: 0.995431661605835
Epoch: 52, Steps: 64 | Train Loss: 0.1001054 Vali Loss: 0.1464303 Test Loss: 0.2223391
Validation loss decreased (0.146615 --> 0.146430).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 53 cost time: 0.9903697967529297
Epoch: 53, Steps: 64 | Train Loss: 0.0997743 Vali Loss: 0.1465022 Test Loss: 0.2229514
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 54 cost time: 0.9823555946350098
Epoch: 54, Steps: 64 | Train Loss: 0.0999786 Vali Loss: 0.1482730 Test Loss: 0.2238434
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 55 cost time: 0.9877188205718994
Epoch: 55, Steps: 64 | Train Loss: 0.0995974 Vali Loss: 0.1484670 Test Loss: 0.2228315
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 56 cost time: 0.9779999256134033
Epoch: 56, Steps: 64 | Train Loss: 0.1001091 Vali Loss: 0.1488265 Test Loss: 0.2236399
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 57 cost time: 0.9807684421539307
Epoch: 57, Steps: 64 | Train Loss: 0.0996743 Vali Loss: 0.1468140 Test Loss: 0.2231678
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 58 cost time: 0.9836139678955078
Epoch: 58, Steps: 64 | Train Loss: 0.0996434 Vali Loss: 0.1475054 Test Loss: 0.2234643
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 59 cost time: 0.9792571067810059
Epoch: 59, Steps: 64 | Train Loss: 0.1002553 Vali Loss: 0.1494932 Test Loss: 0.2240107
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 60 cost time: 0.9894931316375732
Epoch: 60, Steps: 64 | Train Loss: 0.0994845 Vali Loss: 0.1479115 Test Loss: 0.2221663
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22233909368515015, mae:0.3225407004356384, rse:0.23896928131580353
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.057065486907958984 GB
Epoch: 1 cost time: 2.3477976322174072
Epoch: 1, Steps: 64 | Train Loss: 0.9205211 Vali Loss: 2.0584354 Test Loss: 3.1591985
Validation loss decreased (inf --> 2.058435).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 2 cost time: 0.9269740581512451
Epoch: 2, Steps: 64 | Train Loss: 0.5218662 Vali Loss: 0.4259235 Test Loss: 0.5626138
Validation loss decreased (2.058435 --> 0.425924).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 3 cost time: 0.9023175239562988
Epoch: 3, Steps: 64 | Train Loss: 0.2434323 Vali Loss: 0.2431798 Test Loss: 0.2957925
Validation loss decreased (0.425924 --> 0.243180).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 4 cost time: 0.9037203788757324
Epoch: 4, Steps: 64 | Train Loss: 0.1930134 Vali Loss: 0.2037722 Test Loss: 0.2594618
Validation loss decreased (0.243180 --> 0.203772).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 5 cost time: 0.9114389419555664
Epoch: 5, Steps: 64 | Train Loss: 0.1756626 Vali Loss: 0.1912508 Test Loss: 0.2495293
Validation loss decreased (0.203772 --> 0.191251).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 6 cost time: 0.8993487358093262
Epoch: 6, Steps: 64 | Train Loss: 0.1656918 Vali Loss: 0.1865566 Test Loss: 0.2434740
Validation loss decreased (0.191251 --> 0.186557).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 7 cost time: 0.8996047973632812
Epoch: 7, Steps: 64 | Train Loss: 0.1582897 Vali Loss: 0.1820972 Test Loss: 0.2384008
Validation loss decreased (0.186557 --> 0.182097).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 8 cost time: 0.9003770351409912
Epoch: 8, Steps: 64 | Train Loss: 0.1533770 Vali Loss: 0.1797860 Test Loss: 0.2368716
Validation loss decreased (0.182097 --> 0.179786).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 9 cost time: 0.9092960357666016
Epoch: 9, Steps: 64 | Train Loss: 0.1496940 Vali Loss: 0.1738761 Test Loss: 0.2314989
Validation loss decreased (0.179786 --> 0.173876).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 10 cost time: 0.905336856842041
Epoch: 10, Steps: 64 | Train Loss: 0.1450827 Vali Loss: 0.1743295 Test Loss: 0.2312574
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 11 cost time: 0.9040303230285645
Epoch: 11, Steps: 64 | Train Loss: 0.1426180 Vali Loss: 0.1717322 Test Loss: 0.2300671
Validation loss decreased (0.173876 --> 0.171732).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 12 cost time: 0.9179990291595459
Epoch: 12, Steps: 64 | Train Loss: 0.1405236 Vali Loss: 0.1692509 Test Loss: 0.2286844
Validation loss decreased (0.171732 --> 0.169251).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 13 cost time: 0.9036107063293457
Epoch: 13, Steps: 64 | Train Loss: 0.1384345 Vali Loss: 0.1684546 Test Loss: 0.2282227
Validation loss decreased (0.169251 --> 0.168455).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 14 cost time: 0.9019570350646973
Epoch: 14, Steps: 64 | Train Loss: 0.1372781 Vali Loss: 0.1665649 Test Loss: 0.2264659
Validation loss decreased (0.168455 --> 0.166565).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 15 cost time: 0.8983662128448486
Epoch: 15, Steps: 64 | Train Loss: 0.1354927 Vali Loss: 0.1657441 Test Loss: 0.2266471
Validation loss decreased (0.166565 --> 0.165744).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 16 cost time: 0.9173741340637207
Epoch: 16, Steps: 64 | Train Loss: 0.1339729 Vali Loss: 0.1641676 Test Loss: 0.2236570
Validation loss decreased (0.165744 --> 0.164168).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 17 cost time: 0.9037337303161621
Epoch: 17, Steps: 64 | Train Loss: 0.1336010 Vali Loss: 0.1617027 Test Loss: 0.2230363
Validation loss decreased (0.164168 --> 0.161703).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 18 cost time: 0.9029998779296875
Epoch: 18, Steps: 64 | Train Loss: 0.1320856 Vali Loss: 0.1630948 Test Loss: 0.2255363
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 19 cost time: 0.9050204753875732
Epoch: 19, Steps: 64 | Train Loss: 0.1312115 Vali Loss: 0.1615746 Test Loss: 0.2230962
Validation loss decreased (0.161703 --> 0.161575).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 20 cost time: 0.909623384475708
Epoch: 20, Steps: 64 | Train Loss: 0.1306396 Vali Loss: 0.1618407 Test Loss: 0.2238196
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 21 cost time: 0.9053654670715332
Epoch: 21, Steps: 64 | Train Loss: 0.1301103 Vali Loss: 0.1613114 Test Loss: 0.2236339
Validation loss decreased (0.161575 --> 0.161311).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 22 cost time: 0.9081294536590576
Epoch: 22, Steps: 64 | Train Loss: 0.1297973 Vali Loss: 0.1628125 Test Loss: 0.2238975
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 23 cost time: 0.9046797752380371
Epoch: 23, Steps: 64 | Train Loss: 0.1294483 Vali Loss: 0.1584603 Test Loss: 0.2229290
Validation loss decreased (0.161311 --> 0.158460).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 24 cost time: 0.8946323394775391
Epoch: 24, Steps: 64 | Train Loss: 0.1284109 Vali Loss: 0.1588779 Test Loss: 0.2222976
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 25 cost time: 0.8940000534057617
Epoch: 25, Steps: 64 | Train Loss: 0.1282644 Vali Loss: 0.1610491 Test Loss: 0.2239597
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 26 cost time: 0.8963527679443359
Epoch: 26, Steps: 64 | Train Loss: 0.1276684 Vali Loss: 0.1597555 Test Loss: 0.2237404
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 27 cost time: 0.8974001407623291
Epoch: 27, Steps: 64 | Train Loss: 0.1277578 Vali Loss: 0.1598964 Test Loss: 0.2218013
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 28 cost time: 0.8979573249816895
Epoch: 28, Steps: 64 | Train Loss: 0.1272406 Vali Loss: 0.1597095 Test Loss: 0.2239381
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 29 cost time: 0.8918018341064453
Epoch: 29, Steps: 64 | Train Loss: 0.1261746 Vali Loss: 0.1596171 Test Loss: 0.2227137
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 30 cost time: 0.9030003547668457
Epoch: 30, Steps: 64 | Train Loss: 0.1259137 Vali Loss: 0.1579077 Test Loss: 0.2233881
Validation loss decreased (0.158460 --> 0.157908).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 31 cost time: 0.9560019969940186
Epoch: 31, Steps: 64 | Train Loss: 0.1263717 Vali Loss: 0.1586812 Test Loss: 0.2235934
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 32 cost time: 0.8996255397796631
Epoch: 32, Steps: 64 | Train Loss: 0.1261886 Vali Loss: 0.1586845 Test Loss: 0.2222163
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 33 cost time: 0.8942551612854004
Epoch: 33, Steps: 64 | Train Loss: 0.1257746 Vali Loss: 0.1586735 Test Loss: 0.2219073
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 34 cost time: 0.9113755226135254
Epoch: 34, Steps: 64 | Train Loss: 0.1255374 Vali Loss: 0.1582185 Test Loss: 0.2227244
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 35 cost time: 0.8943641185760498
Epoch: 35, Steps: 64 | Train Loss: 0.1257343 Vali Loss: 0.1604088 Test Loss: 0.2239341
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 36 cost time: 0.8937222957611084
Epoch: 36, Steps: 64 | Train Loss: 0.1258336 Vali Loss: 0.1565097 Test Loss: 0.2204955
Validation loss decreased (0.157908 --> 0.156510).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 37 cost time: 0.9063782691955566
Epoch: 37, Steps: 64 | Train Loss: 0.1252736 Vali Loss: 0.1588732 Test Loss: 0.2237031
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 38 cost time: 0.8966164588928223
Epoch: 38, Steps: 64 | Train Loss: 0.1250102 Vali Loss: 0.1581334 Test Loss: 0.2228996
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 39 cost time: 0.903162956237793
Epoch: 39, Steps: 64 | Train Loss: 0.1250977 Vali Loss: 0.1580607 Test Loss: 0.2226645
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 40 cost time: 0.8984107971191406
Epoch: 40, Steps: 64 | Train Loss: 0.1248552 Vali Loss: 0.1577706 Test Loss: 0.2231548
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 41 cost time: 0.9094457626342773
Epoch: 41, Steps: 64 | Train Loss: 0.1250376 Vali Loss: 0.1563586 Test Loss: 0.2220013
Validation loss decreased (0.156510 --> 0.156359).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 42 cost time: 0.8957128524780273
Epoch: 42, Steps: 64 | Train Loss: 0.1249476 Vali Loss: 0.1569606 Test Loss: 0.2217806
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 43 cost time: 0.8900017738342285
Epoch: 43, Steps: 64 | Train Loss: 0.1249202 Vali Loss: 0.1556034 Test Loss: 0.2216709
Validation loss decreased (0.156359 --> 0.155603).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 44 cost time: 0.8956315517425537
Epoch: 44, Steps: 64 | Train Loss: 0.1247365 Vali Loss: 0.1559094 Test Loss: 0.2231882
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 45 cost time: 0.8953883647918701
Epoch: 45, Steps: 64 | Train Loss: 0.1247627 Vali Loss: 0.1584444 Test Loss: 0.2221995
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 46 cost time: 0.8953194618225098
Epoch: 46, Steps: 64 | Train Loss: 0.1250422 Vali Loss: 0.1571661 Test Loss: 0.2229144
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 47 cost time: 0.8973414897918701
Epoch: 47, Steps: 64 | Train Loss: 0.1249012 Vali Loss: 0.1562068 Test Loss: 0.2222836
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 48 cost time: 0.9058663845062256
Epoch: 48, Steps: 64 | Train Loss: 0.1243355 Vali Loss: 0.1568290 Test Loss: 0.2213299
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 49 cost time: 0.9010002613067627
Epoch: 49, Steps: 64 | Train Loss: 0.1250285 Vali Loss: 0.1566954 Test Loss: 0.2229384
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 50 cost time: 0.8973824977874756
Epoch: 50, Steps: 64 | Train Loss: 0.1244480 Vali Loss: 0.1580310 Test Loss: 0.2233734
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 51 cost time: 0.8952145576477051
Epoch: 51, Steps: 64 | Train Loss: 0.1244334 Vali Loss: 0.1573917 Test Loss: 0.2223224
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 52 cost time: 0.9113454818725586
Epoch: 52, Steps: 64 | Train Loss: 0.1248445 Vali Loss: 0.1562964 Test Loss: 0.2219023
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 53 cost time: 0.8963744640350342
Epoch: 53, Steps: 64 | Train Loss: 0.1236513 Vali Loss: 0.1574196 Test Loss: 0.2219590
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 54 cost time: 0.8937807083129883
Epoch: 54, Steps: 64 | Train Loss: 0.1245405 Vali Loss: 0.1578794 Test Loss: 0.2225553
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 55 cost time: 0.9066343307495117
Epoch: 55, Steps: 64 | Train Loss: 0.1245807 Vali Loss: 0.1584105 Test Loss: 0.2222241
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 56 cost time: 0.896641731262207
Epoch: 56, Steps: 64 | Train Loss: 0.1237562 Vali Loss: 0.1562277 Test Loss: 0.2226494
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 57 cost time: 0.8993926048278809
Epoch: 57, Steps: 64 | Train Loss: 0.1236692 Vali Loss: 0.1559074 Test Loss: 0.2223035
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 58 cost time: 0.8963267803192139
Epoch: 58, Steps: 64 | Train Loss: 0.1240794 Vali Loss: 0.1580661 Test Loss: 0.2229808
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 59 cost time: 0.9113879203796387
Epoch: 59, Steps: 64 | Train Loss: 0.1240005 Vali Loss: 0.1570603 Test Loss: 0.2225637
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 60 cost time: 0.896763801574707
Epoch: 60, Steps: 64 | Train Loss: 0.1238446 Vali Loss: 0.1561735 Test Loss: 0.2208406
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22167091071605682, mae:0.31712308526039124, rse:0.2386099100112915
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.05849742889404297 GB
Epoch: 1 cost time: 2.3418591022491455
Epoch: 1, Steps: 64 | Train Loss: 1.0204597 Vali Loss: 2.5988765 Test Loss: 4.1056213
Validation loss decreased (inf --> 2.598876).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 2 cost time: 0.9382376670837402
Epoch: 2, Steps: 64 | Train Loss: 0.6214135 Vali Loss: 0.6481969 Test Loss: 0.9285249
Validation loss decreased (2.598876 --> 0.648197).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 3 cost time: 0.9305987358093262
Epoch: 3, Steps: 64 | Train Loss: 0.2209165 Vali Loss: 0.2111103 Test Loss: 0.2565585
Validation loss decreased (0.648197 --> 0.211110).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 4 cost time: 0.9337832927703857
Epoch: 4, Steps: 64 | Train Loss: 0.1504313 Vali Loss: 0.1841757 Test Loss: 0.2326057
Validation loss decreased (0.211110 --> 0.184176).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 5 cost time: 0.9313638210296631
Epoch: 5, Steps: 64 | Train Loss: 0.1392641 Vali Loss: 0.1773464 Test Loss: 0.2294997
Validation loss decreased (0.184176 --> 0.177346).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 6 cost time: 0.9013760089874268
Epoch: 6, Steps: 64 | Train Loss: 0.1328955 Vali Loss: 0.1729182 Test Loss: 0.2272387
Validation loss decreased (0.177346 --> 0.172918).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 7 cost time: 1.0118002891540527
Epoch: 7, Steps: 64 | Train Loss: 0.1284789 Vali Loss: 0.1701690 Test Loss: 0.2251074
Validation loss decreased (0.172918 --> 0.170169).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 8 cost time: 0.9254863262176514
Epoch: 8, Steps: 64 | Train Loss: 0.1250810 Vali Loss: 0.1653358 Test Loss: 0.2252273
Validation loss decreased (0.170169 --> 0.165336).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 9 cost time: 0.9199995994567871
Epoch: 9, Steps: 64 | Train Loss: 0.1231661 Vali Loss: 0.1668201 Test Loss: 0.2242311
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 10 cost time: 0.9279999732971191
Epoch: 10, Steps: 64 | Train Loss: 0.1208759 Vali Loss: 0.1650040 Test Loss: 0.2247542
Validation loss decreased (0.165336 --> 0.165004).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 11 cost time: 0.9359376430511475
Epoch: 11, Steps: 64 | Train Loss: 0.1189605 Vali Loss: 0.1638534 Test Loss: 0.2243287
Validation loss decreased (0.165004 --> 0.163853).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 12 cost time: 0.9320287704467773
Epoch: 12, Steps: 64 | Train Loss: 0.1183106 Vali Loss: 0.1624625 Test Loss: 0.2246918
Validation loss decreased (0.163853 --> 0.162463).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 13 cost time: 0.9350845813751221
Epoch: 13, Steps: 64 | Train Loss: 0.1159317 Vali Loss: 0.1617124 Test Loss: 0.2253931
Validation loss decreased (0.162463 --> 0.161712).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 14 cost time: 0.9313759803771973
Epoch: 14, Steps: 64 | Train Loss: 0.1161353 Vali Loss: 0.1615939 Test Loss: 0.2250384
Validation loss decreased (0.161712 --> 0.161594).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 15 cost time: 0.9252700805664062
Epoch: 15, Steps: 64 | Train Loss: 0.1151605 Vali Loss: 0.1572682 Test Loss: 0.2242756
Validation loss decreased (0.161594 --> 0.157268).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 16 cost time: 0.94100022315979
Epoch: 16, Steps: 64 | Train Loss: 0.1140671 Vali Loss: 0.1611083 Test Loss: 0.2247789
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 17 cost time: 0.9240231513977051
Epoch: 17, Steps: 64 | Train Loss: 0.1139240 Vali Loss: 0.1591846 Test Loss: 0.2244703
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 18 cost time: 0.9243719577789307
Epoch: 18, Steps: 64 | Train Loss: 0.1132145 Vali Loss: 0.1576020 Test Loss: 0.2245353
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 19 cost time: 0.9244356155395508
Epoch: 19, Steps: 64 | Train Loss: 0.1128760 Vali Loss: 0.1572789 Test Loss: 0.2249306
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 20 cost time: 0.9333744049072266
Epoch: 20, Steps: 64 | Train Loss: 0.1124174 Vali Loss: 0.1576059 Test Loss: 0.2252486
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 21 cost time: 0.9273796081542969
Epoch: 21, Steps: 64 | Train Loss: 0.1117422 Vali Loss: 0.1555215 Test Loss: 0.2252356
Validation loss decreased (0.157268 --> 0.155521).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 22 cost time: 0.9287378787994385
Epoch: 22, Steps: 64 | Train Loss: 0.1119642 Vali Loss: 0.1546807 Test Loss: 0.2247273
Validation loss decreased (0.155521 --> 0.154681).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 23 cost time: 0.9407801628112793
Epoch: 23, Steps: 64 | Train Loss: 0.1110539 Vali Loss: 0.1550086 Test Loss: 0.2250727
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 24 cost time: 0.9239997863769531
Epoch: 24, Steps: 64 | Train Loss: 0.1102277 Vali Loss: 0.1545479 Test Loss: 0.2249442
Validation loss decreased (0.154681 --> 0.154548).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 25 cost time: 0.9260718822479248
Epoch: 25, Steps: 64 | Train Loss: 0.1110206 Vali Loss: 0.1552050 Test Loss: 0.2252535
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 26 cost time: 0.9234199523925781
Epoch: 26, Steps: 64 | Train Loss: 0.1106404 Vali Loss: 0.1540750 Test Loss: 0.2246500
Validation loss decreased (0.154548 --> 0.154075).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 27 cost time: 0.9233324527740479
Epoch: 27, Steps: 64 | Train Loss: 0.1104030 Vali Loss: 0.1550071 Test Loss: 0.2252759
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 28 cost time: 0.9304027557373047
Epoch: 28, Steps: 64 | Train Loss: 0.1099945 Vali Loss: 0.1551057 Test Loss: 0.2254058
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 29 cost time: 0.9273622035980225
Epoch: 29, Steps: 64 | Train Loss: 0.1094097 Vali Loss: 0.1549115 Test Loss: 0.2255524
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 30 cost time: 0.9437172412872314
Epoch: 30, Steps: 64 | Train Loss: 0.1098545 Vali Loss: 0.1537527 Test Loss: 0.2252360
Validation loss decreased (0.154075 --> 0.153753).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 31 cost time: 0.9270000457763672
Epoch: 31, Steps: 64 | Train Loss: 0.1096678 Vali Loss: 0.1547706 Test Loss: 0.2252057
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 32 cost time: 0.9366145133972168
Epoch: 32, Steps: 64 | Train Loss: 0.1098098 Vali Loss: 0.1551739 Test Loss: 0.2249332
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 33 cost time: 0.9384305477142334
Epoch: 33, Steps: 64 | Train Loss: 0.1090673 Vali Loss: 0.1554396 Test Loss: 0.2253626
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 34 cost time: 1.004077672958374
Epoch: 34, Steps: 64 | Train Loss: 0.1096989 Vali Loss: 0.1536584 Test Loss: 0.2250306
Validation loss decreased (0.153753 --> 0.153658).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 35 cost time: 0.9715540409088135
Epoch: 35, Steps: 64 | Train Loss: 0.1089897 Vali Loss: 0.1543759 Test Loss: 0.2247642
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 36 cost time: 0.9256191253662109
Epoch: 36, Steps: 64 | Train Loss: 0.1089862 Vali Loss: 0.1551088 Test Loss: 0.2245526
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 37 cost time: 0.9407732486724854
Epoch: 37, Steps: 64 | Train Loss: 0.1088357 Vali Loss: 0.1547349 Test Loss: 0.2248954
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 38 cost time: 0.9298141002655029
Epoch: 38, Steps: 64 | Train Loss: 0.1094337 Vali Loss: 0.1552206 Test Loss: 0.2250654
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 39 cost time: 0.930617094039917
Epoch: 39, Steps: 64 | Train Loss: 0.1089186 Vali Loss: 0.1549695 Test Loss: 0.2250311
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 40 cost time: 0.9386184215545654
Epoch: 40, Steps: 64 | Train Loss: 0.1091994 Vali Loss: 0.1548886 Test Loss: 0.2254491
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 41 cost time: 0.9273648262023926
Epoch: 41, Steps: 64 | Train Loss: 0.1091004 Vali Loss: 0.1551408 Test Loss: 0.2252254
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 42 cost time: 0.9264886379241943
Epoch: 42, Steps: 64 | Train Loss: 0.1089927 Vali Loss: 0.1545509 Test Loss: 0.2252933
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 43 cost time: 0.924102783203125
Epoch: 43, Steps: 64 | Train Loss: 0.1090777 Vali Loss: 0.1554773 Test Loss: 0.2252471
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 44 cost time: 0.9260334968566895
Epoch: 44, Steps: 64 | Train Loss: 0.1082793 Vali Loss: 0.1526460 Test Loss: 0.2250479
Validation loss decreased (0.153658 --> 0.152646).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 45 cost time: 0.9247229099273682
Epoch: 45, Steps: 64 | Train Loss: 0.1081944 Vali Loss: 0.1536472 Test Loss: 0.2252746
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 46 cost time: 0.9259989261627197
Epoch: 46, Steps: 64 | Train Loss: 0.1084361 Vali Loss: 0.1536280 Test Loss: 0.2250450
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 47 cost time: 0.9350669384002686
Epoch: 47, Steps: 64 | Train Loss: 0.1081446 Vali Loss: 0.1541593 Test Loss: 0.2250710
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 48 cost time: 0.9293806552886963
Epoch: 48, Steps: 64 | Train Loss: 0.1085103 Vali Loss: 0.1526722 Test Loss: 0.2251471
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 49 cost time: 0.9284284114837646
Epoch: 49, Steps: 64 | Train Loss: 0.1083170 Vali Loss: 0.1542097 Test Loss: 0.2252457
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 50 cost time: 0.9313864707946777
Epoch: 50, Steps: 64 | Train Loss: 0.1084796 Vali Loss: 0.1535577 Test Loss: 0.2247069
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 51 cost time: 0.9403576850891113
Epoch: 51, Steps: 64 | Train Loss: 0.1081708 Vali Loss: 0.1536868 Test Loss: 0.2250938
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 52 cost time: 0.9253628253936768
Epoch: 52, Steps: 64 | Train Loss: 0.1088184 Vali Loss: 0.1542532 Test Loss: 0.2252391
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 53 cost time: 0.9255368709564209
Epoch: 53, Steps: 64 | Train Loss: 0.1078235 Vali Loss: 0.1537132 Test Loss: 0.2247755
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 54 cost time: 0.9366035461425781
Epoch: 54, Steps: 64 | Train Loss: 0.1085684 Vali Loss: 0.1548920 Test Loss: 0.2250964
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 55 cost time: 0.9364333152770996
Epoch: 55, Steps: 64 | Train Loss: 0.1093450 Vali Loss: 0.1538304 Test Loss: 0.2250116
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 56 cost time: 0.9343914985656738
Epoch: 56, Steps: 64 | Train Loss: 0.1080384 Vali Loss: 0.1524002 Test Loss: 0.2250289
Validation loss decreased (0.152646 --> 0.152400).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 57 cost time: 0.9303581714630127
Epoch: 57, Steps: 64 | Train Loss: 0.1084609 Vali Loss: 0.1530172 Test Loss: 0.2248321
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 58 cost time: 0.9453439712524414
Epoch: 58, Steps: 64 | Train Loss: 0.1083986 Vali Loss: 0.1536431 Test Loss: 0.2250243
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 59 cost time: 0.9284160137176514
Epoch: 59, Steps: 64 | Train Loss: 0.1082063 Vali Loss: 0.1551382 Test Loss: 0.2249378
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 60 cost time: 0.9314017295837402
Epoch: 60, Steps: 64 | Train Loss: 0.1079057 Vali Loss: 0.1533222 Test Loss: 0.2248615
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22502893209457397, mae:0.3332976996898651, rse:0.2404104322195053
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.05961751937866211 GB
Epoch: 1 cost time: 2.3715286254882812
Epoch: 1, Steps: 64 | Train Loss: 0.9964244 Vali Loss: 2.6648767 Test Loss: 4.2788649
Validation loss decreased (inf --> 2.664877).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 2 cost time: 0.959357738494873
Epoch: 2, Steps: 64 | Train Loss: 0.6590000 Vali Loss: 0.8388162 Test Loss: 1.2140361
Validation loss decreased (2.664877 --> 0.838816).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 3 cost time: 0.9594767093658447
Epoch: 3, Steps: 64 | Train Loss: 0.2276232 Vali Loss: 0.2209860 Test Loss: 0.2595164
Validation loss decreased (0.838816 --> 0.220986).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 4 cost time: 0.9594833850860596
Epoch: 4, Steps: 64 | Train Loss: 0.1405369 Vali Loss: 0.1867475 Test Loss: 0.2437686
Validation loss decreased (0.220986 --> 0.186747).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 5 cost time: 1.0390663146972656
Epoch: 5, Steps: 64 | Train Loss: 0.1303711 Vali Loss: 0.1804572 Test Loss: 0.2304812
Validation loss decreased (0.186747 --> 0.180457).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 6 cost time: 1.036449909210205
Epoch: 6, Steps: 64 | Train Loss: 0.1252385 Vali Loss: 0.1746528 Test Loss: 0.2269855
Validation loss decreased (0.180457 --> 0.174653).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 7 cost time: 1.0323712825775146
Epoch: 7, Steps: 64 | Train Loss: 0.1214508 Vali Loss: 0.1693014 Test Loss: 0.2257329
Validation loss decreased (0.174653 --> 0.169301).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 8 cost time: 0.9543704986572266
Epoch: 8, Steps: 64 | Train Loss: 0.1191123 Vali Loss: 0.1690813 Test Loss: 0.2248438
Validation loss decreased (0.169301 --> 0.169081).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 9 cost time: 0.9527068138122559
Epoch: 9, Steps: 64 | Train Loss: 0.1170210 Vali Loss: 0.1658848 Test Loss: 0.2240217
Validation loss decreased (0.169081 --> 0.165885).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 10 cost time: 0.9557478427886963
Epoch: 10, Steps: 64 | Train Loss: 0.1155575 Vali Loss: 0.1643728 Test Loss: 0.2253595
Validation loss decreased (0.165885 --> 0.164373).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 11 cost time: 0.9670000076293945
Epoch: 11, Steps: 64 | Train Loss: 0.1138139 Vali Loss: 0.1610535 Test Loss: 0.2251830
Validation loss decreased (0.164373 --> 0.161053).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 12 cost time: 0.9606213569641113
Epoch: 12, Steps: 64 | Train Loss: 0.1128089 Vali Loss: 0.1618775 Test Loss: 0.2247094
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 13 cost time: 0.9640614986419678
Epoch: 13, Steps: 64 | Train Loss: 0.1120681 Vali Loss: 0.1603698 Test Loss: 0.2255350
Validation loss decreased (0.161053 --> 0.160370).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 14 cost time: 0.9606764316558838
Epoch: 14, Steps: 64 | Train Loss: 0.1114656 Vali Loss: 0.1590795 Test Loss: 0.2246371
Validation loss decreased (0.160370 --> 0.159079).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 15 cost time: 0.9513509273529053
Epoch: 15, Steps: 64 | Train Loss: 0.1103145 Vali Loss: 0.1589941 Test Loss: 0.2255289
Validation loss decreased (0.159079 --> 0.158994).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 16 cost time: 0.9513349533081055
Epoch: 16, Steps: 64 | Train Loss: 0.1097145 Vali Loss: 0.1579788 Test Loss: 0.2255961
Validation loss decreased (0.158994 --> 0.157979).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 17 cost time: 0.9533529281616211
Epoch: 17, Steps: 64 | Train Loss: 0.1092444 Vali Loss: 0.1578620 Test Loss: 0.2249094
Validation loss decreased (0.157979 --> 0.157862).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 18 cost time: 0.9742701053619385
Epoch: 18, Steps: 64 | Train Loss: 0.1090319 Vali Loss: 0.1569083 Test Loss: 0.2256117
Validation loss decreased (0.157862 --> 0.156908).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 19 cost time: 0.9567909240722656
Epoch: 19, Steps: 64 | Train Loss: 0.1083241 Vali Loss: 0.1569866 Test Loss: 0.2257650
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 20 cost time: 0.9559998512268066
Epoch: 20, Steps: 64 | Train Loss: 0.1086149 Vali Loss: 0.1572374 Test Loss: 0.2260103
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 21 cost time: 0.9699883460998535
Epoch: 21, Steps: 64 | Train Loss: 0.1077302 Vali Loss: 0.1545070 Test Loss: 0.2253650
Validation loss decreased (0.156908 --> 0.154507).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 22 cost time: 0.9546067714691162
Epoch: 22, Steps: 64 | Train Loss: 0.1074130 Vali Loss: 0.1560136 Test Loss: 0.2257564
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 23 cost time: 0.9520606994628906
Epoch: 23, Steps: 64 | Train Loss: 0.1074536 Vali Loss: 0.1547603 Test Loss: 0.2262735
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 24 cost time: 0.964418888092041
Epoch: 24, Steps: 64 | Train Loss: 0.1073795 Vali Loss: 0.1547348 Test Loss: 0.2260570
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 25 cost time: 0.9276683330535889
Epoch: 25, Steps: 64 | Train Loss: 0.1071067 Vali Loss: 0.1542254 Test Loss: 0.2258750
Validation loss decreased (0.154507 --> 0.154225).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 26 cost time: 0.9713621139526367
Epoch: 26, Steps: 64 | Train Loss: 0.1063592 Vali Loss: 0.1556739 Test Loss: 0.2260156
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 27 cost time: 0.9757504463195801
Epoch: 27, Steps: 64 | Train Loss: 0.1064425 Vali Loss: 0.1557867 Test Loss: 0.2260118
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 28 cost time: 0.9543447494506836
Epoch: 28, Steps: 64 | Train Loss: 0.1062568 Vali Loss: 0.1547375 Test Loss: 0.2258445
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 29 cost time: 0.9589977264404297
Epoch: 29, Steps: 64 | Train Loss: 0.1058713 Vali Loss: 0.1548914 Test Loss: 0.2261701
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 30 cost time: 0.9566254615783691
Epoch: 30, Steps: 64 | Train Loss: 0.1063043 Vali Loss: 0.1546783 Test Loss: 0.2262251
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 31 cost time: 0.9683389663696289
Epoch: 31, Steps: 64 | Train Loss: 0.1061127 Vali Loss: 0.1544588 Test Loss: 0.2257701
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 32 cost time: 0.952383279800415
Epoch: 32, Steps: 64 | Train Loss: 0.1056720 Vali Loss: 0.1542834 Test Loss: 0.2259393
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 33 cost time: 0.9523429870605469
Epoch: 33, Steps: 64 | Train Loss: 0.1057713 Vali Loss: 0.1546326 Test Loss: 0.2262313
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 34 cost time: 0.9527909755706787
Epoch: 34, Steps: 64 | Train Loss: 0.1054311 Vali Loss: 0.1551007 Test Loss: 0.2260639
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 35 cost time: 0.9595286846160889
Epoch: 35, Steps: 64 | Train Loss: 0.1055527 Vali Loss: 0.1547098 Test Loss: 0.2264982
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 36 cost time: 0.9568226337432861
Epoch: 36, Steps: 64 | Train Loss: 0.1054134 Vali Loss: 0.1534843 Test Loss: 0.2258674
Validation loss decreased (0.154225 --> 0.153484).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 37 cost time: 0.9569997787475586
Epoch: 37, Steps: 64 | Train Loss: 0.1054547 Vali Loss: 0.1543429 Test Loss: 0.2259620
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 38 cost time: 0.9679548740386963
Epoch: 38, Steps: 64 | Train Loss: 0.1053312 Vali Loss: 0.1542659 Test Loss: 0.2264656
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 39 cost time: 0.9586191177368164
Epoch: 39, Steps: 64 | Train Loss: 0.1053899 Vali Loss: 0.1531931 Test Loss: 0.2265831
Validation loss decreased (0.153484 --> 0.153193).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 40 cost time: 0.9573853015899658
Epoch: 40, Steps: 64 | Train Loss: 0.1053802 Vali Loss: 0.1527119 Test Loss: 0.2261010
Validation loss decreased (0.153193 --> 0.152712).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 41 cost time: 0.9614264965057373
Epoch: 41, Steps: 64 | Train Loss: 0.1052570 Vali Loss: 0.1531388 Test Loss: 0.2266643
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 42 cost time: 0.9543640613555908
Epoch: 42, Steps: 64 | Train Loss: 0.1051512 Vali Loss: 0.1529804 Test Loss: 0.2262208
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 43 cost time: 0.9494106769561768
Epoch: 43, Steps: 64 | Train Loss: 0.1051637 Vali Loss: 0.1545285 Test Loss: 0.2262585
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 44 cost time: 0.951728105545044
Epoch: 44, Steps: 64 | Train Loss: 0.1047688 Vali Loss: 0.1547622 Test Loss: 0.2258237
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 45 cost time: 0.9552798271179199
Epoch: 45, Steps: 64 | Train Loss: 0.1054244 Vali Loss: 0.1533339 Test Loss: 0.2264851
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 46 cost time: 0.9904754161834717
Epoch: 46, Steps: 64 | Train Loss: 0.1048434 Vali Loss: 0.1541247 Test Loss: 0.2261541
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 47 cost time: 0.9715991020202637
Epoch: 47, Steps: 64 | Train Loss: 0.1052589 Vali Loss: 0.1534203 Test Loss: 0.2257898
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 48 cost time: 0.9896719455718994
Epoch: 48, Steps: 64 | Train Loss: 0.1050440 Vali Loss: 0.1534618 Test Loss: 0.2265504
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 49 cost time: 0.9793605804443359
Epoch: 49, Steps: 64 | Train Loss: 0.1054503 Vali Loss: 0.1533224 Test Loss: 0.2263222
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 50 cost time: 0.9786348342895508
Epoch: 50, Steps: 64 | Train Loss: 0.1046286 Vali Loss: 0.1524401 Test Loss: 0.2265883
Validation loss decreased (0.152712 --> 0.152440).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 51 cost time: 0.9913315773010254
Epoch: 51, Steps: 64 | Train Loss: 0.1045934 Vali Loss: 0.1542126 Test Loss: 0.2263161
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 52 cost time: 0.9745054244995117
Epoch: 52, Steps: 64 | Train Loss: 0.1049970 Vali Loss: 0.1539256 Test Loss: 0.2262190
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 53 cost time: 0.9693608283996582
Epoch: 53, Steps: 64 | Train Loss: 0.1049844 Vali Loss: 0.1548967 Test Loss: 0.2261813
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 54 cost time: 0.9597437381744385
Epoch: 54, Steps: 64 | Train Loss: 0.1045013 Vali Loss: 0.1536662 Test Loss: 0.2260787
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 55 cost time: 0.968825101852417
Epoch: 55, Steps: 64 | Train Loss: 0.1052089 Vali Loss: 0.1529038 Test Loss: 0.2267963
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 56 cost time: 0.9579999446868896
Epoch: 56, Steps: 64 | Train Loss: 0.1050582 Vali Loss: 0.1542163 Test Loss: 0.2263229
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 57 cost time: 0.9566152095794678
Epoch: 57, Steps: 64 | Train Loss: 0.1047701 Vali Loss: 0.1524030 Test Loss: 0.2261933
Validation loss decreased (0.152440 --> 0.152403).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 58 cost time: 0.9403631687164307
Epoch: 58, Steps: 64 | Train Loss: 0.1045940 Vali Loss: 0.1537372 Test Loss: 0.2262733
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 59 cost time: 0.9559969902038574
Epoch: 59, Steps: 64 | Train Loss: 0.1049704 Vali Loss: 0.1542265 Test Loss: 0.2262022
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 60 cost time: 0.954364538192749
Epoch: 60, Steps: 64 | Train Loss: 0.1053929 Vali Loss: 0.1537723 Test Loss: 0.2265438
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22619330883026123, mae:0.3350280821323395, rse:0.24103161692619324
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.057227134704589844 GB
Epoch: 1 cost time: 2.3353514671325684
Epoch: 1, Steps: 64 | Train Loss: 0.7580482 Vali Loss: 1.6534674 Test Loss: 2.5113947
Validation loss decreased (inf --> 1.653467).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 2 cost time: 0.9123899936676025
Epoch: 2, Steps: 64 | Train Loss: 0.4575401 Vali Loss: 0.3927999 Test Loss: 0.4943458
Validation loss decreased (1.653467 --> 0.392800).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 3 cost time: 0.9089999198913574
Epoch: 3, Steps: 64 | Train Loss: 0.2281012 Vali Loss: 0.2484368 Test Loss: 0.2973410
Validation loss decreased (0.392800 --> 0.248437).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 4 cost time: 0.908637523651123
Epoch: 4, Steps: 64 | Train Loss: 0.1771075 Vali Loss: 0.1997346 Test Loss: 0.2540429
Validation loss decreased (0.248437 --> 0.199735).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 5 cost time: 0.9146275520324707
Epoch: 5, Steps: 64 | Train Loss: 0.1582641 Vali Loss: 0.1802577 Test Loss: 0.2333527
Validation loss decreased (0.199735 --> 0.180258).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 6 cost time: 0.8914453983306885
Epoch: 6, Steps: 64 | Train Loss: 0.1494458 Vali Loss: 0.1749002 Test Loss: 0.2297301
Validation loss decreased (0.180258 --> 0.174900).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 7 cost time: 0.9124372005462646
Epoch: 7, Steps: 64 | Train Loss: 0.1426490 Vali Loss: 0.1707104 Test Loss: 0.2263346
Validation loss decreased (0.174900 --> 0.170710).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 8 cost time: 0.9064469337463379
Epoch: 8, Steps: 64 | Train Loss: 0.1382175 Vali Loss: 0.1668145 Test Loss: 0.2236692
Validation loss decreased (0.170710 --> 0.166815).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 9 cost time: 0.8711018562316895
Epoch: 9, Steps: 64 | Train Loss: 0.1348155 Vali Loss: 0.1660852 Test Loss: 0.2232933
Validation loss decreased (0.166815 --> 0.166085).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 10 cost time: 0.9279999732971191
Epoch: 10, Steps: 64 | Train Loss: 0.1330752 Vali Loss: 0.1648576 Test Loss: 0.2232880
Validation loss decreased (0.166085 --> 0.164858).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 11 cost time: 0.9335963726043701
Epoch: 11, Steps: 64 | Train Loss: 0.1301682 Vali Loss: 0.1644424 Test Loss: 0.2247268
Validation loss decreased (0.164858 --> 0.164442).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 12 cost time: 0.937598705291748
Epoch: 12, Steps: 64 | Train Loss: 0.1287413 Vali Loss: 0.1637466 Test Loss: 0.2232076
Validation loss decreased (0.164442 --> 0.163747).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 13 cost time: 0.9343700408935547
Epoch: 13, Steps: 64 | Train Loss: 0.1276967 Vali Loss: 0.1635634 Test Loss: 0.2238343
Validation loss decreased (0.163747 --> 0.163563).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 14 cost time: 0.9293396472930908
Epoch: 14, Steps: 64 | Train Loss: 0.1261171 Vali Loss: 0.1628488 Test Loss: 0.2241200
Validation loss decreased (0.163563 --> 0.162849).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 15 cost time: 0.9294528961181641
Epoch: 15, Steps: 64 | Train Loss: 0.1254437 Vali Loss: 0.1639818 Test Loss: 0.2255531
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 16 cost time: 0.9134974479675293
Epoch: 16, Steps: 64 | Train Loss: 0.1249368 Vali Loss: 0.1634104 Test Loss: 0.2241035
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 17 cost time: 0.9053235054016113
Epoch: 17, Steps: 64 | Train Loss: 0.1238538 Vali Loss: 0.1611076 Test Loss: 0.2233145
Validation loss decreased (0.162849 --> 0.161108).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 18 cost time: 0.9040000438690186
Epoch: 18, Steps: 64 | Train Loss: 0.1224733 Vali Loss: 0.1609585 Test Loss: 0.2239029
Validation loss decreased (0.161108 --> 0.160959).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 19 cost time: 0.9236268997192383
Epoch: 19, Steps: 64 | Train Loss: 0.1216234 Vali Loss: 0.1594250 Test Loss: 0.2231643
Validation loss decreased (0.160959 --> 0.159425).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 20 cost time: 0.9043788909912109
Epoch: 20, Steps: 64 | Train Loss: 0.1214703 Vali Loss: 0.1619003 Test Loss: 0.2251239
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 21 cost time: 0.9073646068572998
Epoch: 21, Steps: 64 | Train Loss: 0.1207964 Vali Loss: 0.1615365 Test Loss: 0.2232362
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 22 cost time: 0.9080791473388672
Epoch: 22, Steps: 64 | Train Loss: 0.1205954 Vali Loss: 0.1592929 Test Loss: 0.2221740
Validation loss decreased (0.159425 --> 0.159293).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 23 cost time: 0.9057555198669434
Epoch: 23, Steps: 64 | Train Loss: 0.1196965 Vali Loss: 0.1604477 Test Loss: 0.2236645
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 24 cost time: 0.9059982299804688
Epoch: 24, Steps: 64 | Train Loss: 0.1196158 Vali Loss: 0.1591239 Test Loss: 0.2228707
Validation loss decreased (0.159293 --> 0.159124).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 25 cost time: 0.9066431522369385
Epoch: 25, Steps: 64 | Train Loss: 0.1194864 Vali Loss: 0.1588023 Test Loss: 0.2230546
Validation loss decreased (0.159124 --> 0.158802).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 26 cost time: 0.9063782691955566
Epoch: 26, Steps: 64 | Train Loss: 0.1189955 Vali Loss: 0.1595048 Test Loss: 0.2230707
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 27 cost time: 0.9025754928588867
Epoch: 27, Steps: 64 | Train Loss: 0.1181270 Vali Loss: 0.1585361 Test Loss: 0.2226524
Validation loss decreased (0.158802 --> 0.158536).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 28 cost time: 0.913353443145752
Epoch: 28, Steps: 64 | Train Loss: 0.1186030 Vali Loss: 0.1587980 Test Loss: 0.2229404
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 29 cost time: 0.9107680320739746
Epoch: 29, Steps: 64 | Train Loss: 0.1184712 Vali Loss: 0.1584770 Test Loss: 0.2224081
Validation loss decreased (0.158536 --> 0.158477).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 30 cost time: 0.8949394226074219
Epoch: 30, Steps: 64 | Train Loss: 0.1179376 Vali Loss: 0.1590631 Test Loss: 0.2239182
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 31 cost time: 0.9090027809143066
Epoch: 31, Steps: 64 | Train Loss: 0.1184393 Vali Loss: 0.1598638 Test Loss: 0.2237547
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 32 cost time: 0.9046201705932617
Epoch: 32, Steps: 64 | Train Loss: 0.1174819 Vali Loss: 0.1589900 Test Loss: 0.2233393
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 33 cost time: 0.92037034034729
Epoch: 33, Steps: 64 | Train Loss: 0.1181970 Vali Loss: 0.1594919 Test Loss: 0.2231158
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 34 cost time: 0.907181978225708
Epoch: 34, Steps: 64 | Train Loss: 0.1177018 Vali Loss: 0.1594681 Test Loss: 0.2229418
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 35 cost time: 0.9014840126037598
Epoch: 35, Steps: 64 | Train Loss: 0.1178316 Vali Loss: 0.1582555 Test Loss: 0.2223222
Validation loss decreased (0.158477 --> 0.158255).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 36 cost time: 0.9097714424133301
Epoch: 36, Steps: 64 | Train Loss: 0.1171021 Vali Loss: 0.1587573 Test Loss: 0.2238599
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 37 cost time: 0.9129998683929443
Epoch: 37, Steps: 64 | Train Loss: 0.1169251 Vali Loss: 0.1575304 Test Loss: 0.2223417
Validation loss decreased (0.158255 --> 0.157530).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 38 cost time: 0.9076104164123535
Epoch: 38, Steps: 64 | Train Loss: 0.1165230 Vali Loss: 0.1589033 Test Loss: 0.2227323
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 39 cost time: 0.9093563556671143
Epoch: 39, Steps: 64 | Train Loss: 0.1170550 Vali Loss: 0.1582792 Test Loss: 0.2231918
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 40 cost time: 0.9209036827087402
Epoch: 40, Steps: 64 | Train Loss: 0.1170286 Vali Loss: 0.1578897 Test Loss: 0.2233606
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 41 cost time: 0.9085671901702881
Epoch: 41, Steps: 64 | Train Loss: 0.1170048 Vali Loss: 0.1580521 Test Loss: 0.2223503
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 42 cost time: 0.9033036231994629
Epoch: 42, Steps: 64 | Train Loss: 0.1170297 Vali Loss: 0.1573383 Test Loss: 0.2225323
Validation loss decreased (0.157530 --> 0.157338).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 43 cost time: 0.9050004482269287
Epoch: 43, Steps: 64 | Train Loss: 0.1170844 Vali Loss: 0.1581519 Test Loss: 0.2218273
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 44 cost time: 0.9096293449401855
Epoch: 44, Steps: 64 | Train Loss: 0.1168943 Vali Loss: 0.1580089 Test Loss: 0.2232384
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 45 cost time: 0.9096252918243408
Epoch: 45, Steps: 64 | Train Loss: 0.1168461 Vali Loss: 0.1580572 Test Loss: 0.2230040
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 46 cost time: 0.8993463516235352
Epoch: 46, Steps: 64 | Train Loss: 0.1166367 Vali Loss: 0.1565504 Test Loss: 0.2233745
Validation loss decreased (0.157338 --> 0.156550).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 47 cost time: 0.9143779277801514
Epoch: 47, Steps: 64 | Train Loss: 0.1164086 Vali Loss: 0.1582497 Test Loss: 0.2229150
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 48 cost time: 0.9060399532318115
Epoch: 48, Steps: 64 | Train Loss: 0.1166040 Vali Loss: 0.1567799 Test Loss: 0.2229264
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 49 cost time: 0.9059398174285889
Epoch: 49, Steps: 64 | Train Loss: 0.1160469 Vali Loss: 0.1576925 Test Loss: 0.2222743
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 50 cost time: 0.9040026664733887
Epoch: 50, Steps: 64 | Train Loss: 0.1167156 Vali Loss: 0.1567405 Test Loss: 0.2235755
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 51 cost time: 0.9076123237609863
Epoch: 51, Steps: 64 | Train Loss: 0.1159967 Vali Loss: 0.1589527 Test Loss: 0.2236027
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 52 cost time: 0.9041717052459717
Epoch: 52, Steps: 64 | Train Loss: 0.1167766 Vali Loss: 0.1571435 Test Loss: 0.2233224
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 53 cost time: 0.9043824672698975
Epoch: 53, Steps: 64 | Train Loss: 0.1167024 Vali Loss: 0.1578837 Test Loss: 0.2224249
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 54 cost time: 0.9148373603820801
Epoch: 54, Steps: 64 | Train Loss: 0.1164136 Vali Loss: 0.1569225 Test Loss: 0.2231759
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 55 cost time: 0.9048824310302734
Epoch: 55, Steps: 64 | Train Loss: 0.1168001 Vali Loss: 0.1570865 Test Loss: 0.2223993
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 56 cost time: 0.9130001068115234
Epoch: 56, Steps: 64 | Train Loss: 0.1164963 Vali Loss: 0.1583472 Test Loss: 0.2244029
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 57 cost time: 0.9126265048980713
Epoch: 57, Steps: 64 | Train Loss: 0.1161798 Vali Loss: 0.1558537 Test Loss: 0.2226271
Validation loss decreased (0.156550 --> 0.155854).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 58 cost time: 0.922327995300293
Epoch: 58, Steps: 64 | Train Loss: 0.1164774 Vali Loss: 0.1566710 Test Loss: 0.2228137
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 59 cost time: 0.9083631038665771
Epoch: 59, Steps: 64 | Train Loss: 0.1167091 Vali Loss: 0.1563958 Test Loss: 0.2228351
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 60 cost time: 0.9083998203277588
Epoch: 60, Steps: 64 | Train Loss: 0.1161522 Vali Loss: 0.1575949 Test Loss: 0.2240683
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22262710332870483, mae:0.3239383399486542, rse:0.23912400007247925
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.05865907669067383 GB
Epoch: 1 cost time: 2.3336782455444336
Epoch: 1, Steps: 64 | Train Loss: 1.1628936 Vali Loss: 3.0187931 Test Loss: 4.8406415
Validation loss decreased (inf --> 3.018793).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 2 cost time: 0.9193289279937744
Epoch: 2, Steps: 64 | Train Loss: 0.6678859 Vali Loss: 0.7532569 Test Loss: 1.0606084
Validation loss decreased (3.018793 --> 0.753257).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 3 cost time: 0.9408330917358398
Epoch: 3, Steps: 64 | Train Loss: 0.2426496 Vali Loss: 0.2782652 Test Loss: 0.3112042
Validation loss decreased (0.753257 --> 0.278265).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 4 cost time: 0.9426202774047852
Epoch: 4, Steps: 64 | Train Loss: 0.1549428 Vali Loss: 0.2038569 Test Loss: 0.2422162
Validation loss decreased (0.278265 --> 0.203857).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 5 cost time: 0.9288797378540039
Epoch: 5, Steps: 64 | Train Loss: 0.1397036 Vali Loss: 0.1831111 Test Loss: 0.2305752
Validation loss decreased (0.203857 --> 0.183111).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 6 cost time: 0.9299929141998291
Epoch: 6, Steps: 64 | Train Loss: 0.1317544 Vali Loss: 0.1774609 Test Loss: 0.2282450
Validation loss decreased (0.183111 --> 0.177461).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 7 cost time: 0.9293813705444336
Epoch: 7, Steps: 64 | Train Loss: 0.1272250 Vali Loss: 0.1713902 Test Loss: 0.2235250
Validation loss decreased (0.177461 --> 0.171390).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 8 cost time: 0.9363751411437988
Epoch: 8, Steps: 64 | Train Loss: 0.1244149 Vali Loss: 0.1667416 Test Loss: 0.2225230
Validation loss decreased (0.171390 --> 0.166742).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 9 cost time: 0.9283335208892822
Epoch: 9, Steps: 64 | Train Loss: 0.1215974 Vali Loss: 0.1644475 Test Loss: 0.2206826
Validation loss decreased (0.166742 --> 0.164448).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 10 cost time: 0.9373433589935303
Epoch: 10, Steps: 64 | Train Loss: 0.1187402 Vali Loss: 0.1610316 Test Loss: 0.2213738
Validation loss decreased (0.164448 --> 0.161032).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 11 cost time: 0.937999963760376
Epoch: 11, Steps: 64 | Train Loss: 0.1177251 Vali Loss: 0.1625108 Test Loss: 0.2208049
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 12 cost time: 0.9486773014068604
Epoch: 12, Steps: 64 | Train Loss: 0.1161618 Vali Loss: 0.1606787 Test Loss: 0.2224004
Validation loss decreased (0.161032 --> 0.160679).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 13 cost time: 0.9343712329864502
Epoch: 13, Steps: 64 | Train Loss: 0.1147177 Vali Loss: 0.1599911 Test Loss: 0.2186701
Validation loss decreased (0.160679 --> 0.159991).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 14 cost time: 0.9341487884521484
Epoch: 14, Steps: 64 | Train Loss: 0.1136424 Vali Loss: 0.1595214 Test Loss: 0.2208646
Validation loss decreased (0.159991 --> 0.159521).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 15 cost time: 0.9383621215820312
Epoch: 15, Steps: 64 | Train Loss: 0.1130531 Vali Loss: 0.1584525 Test Loss: 0.2190670
Validation loss decreased (0.159521 --> 0.158452).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 16 cost time: 0.9293255805969238
Epoch: 16, Steps: 64 | Train Loss: 0.1125371 Vali Loss: 0.1571514 Test Loss: 0.2192636
Validation loss decreased (0.158452 --> 0.157151).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 17 cost time: 0.9293303489685059
Epoch: 17, Steps: 64 | Train Loss: 0.1116751 Vali Loss: 0.1558998 Test Loss: 0.2183081
Validation loss decreased (0.157151 --> 0.155900).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 18 cost time: 0.9277331829071045
Epoch: 18, Steps: 64 | Train Loss: 0.1106902 Vali Loss: 0.1586075 Test Loss: 0.2213558
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 19 cost time: 0.9426250457763672
Epoch: 19, Steps: 64 | Train Loss: 0.1105629 Vali Loss: 0.1569185 Test Loss: 0.2208361
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 20 cost time: 0.9370419979095459
Epoch: 20, Steps: 64 | Train Loss: 0.1107145 Vali Loss: 0.1555097 Test Loss: 0.2191113
Validation loss decreased (0.155900 --> 0.155510).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 21 cost time: 0.936408519744873
Epoch: 21, Steps: 64 | Train Loss: 0.1100898 Vali Loss: 0.1551557 Test Loss: 0.2189898
Validation loss decreased (0.155510 --> 0.155156).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 22 cost time: 0.9344086647033691
Epoch: 22, Steps: 64 | Train Loss: 0.1095397 Vali Loss: 0.1549584 Test Loss: 0.2215126
Validation loss decreased (0.155156 --> 0.154958).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 23 cost time: 0.9039123058319092
Epoch: 23, Steps: 64 | Train Loss: 0.1091734 Vali Loss: 0.1559216 Test Loss: 0.2212207
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 24 cost time: 0.9343826770782471
Epoch: 24, Steps: 64 | Train Loss: 0.1086850 Vali Loss: 0.1536419 Test Loss: 0.2200533
Validation loss decreased (0.154958 --> 0.153642).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 25 cost time: 0.927772045135498
Epoch: 25, Steps: 64 | Train Loss: 0.1084127 Vali Loss: 0.1559225 Test Loss: 0.2210162
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 26 cost time: 0.9269998073577881
Epoch: 26, Steps: 64 | Train Loss: 0.1081349 Vali Loss: 0.1529317 Test Loss: 0.2200261
Validation loss decreased (0.153642 --> 0.152932).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 27 cost time: 0.929969310760498
Epoch: 27, Steps: 64 | Train Loss: 0.1082603 Vali Loss: 0.1536444 Test Loss: 0.2196847
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 28 cost time: 0.9346466064453125
Epoch: 28, Steps: 64 | Train Loss: 0.1079869 Vali Loss: 0.1527757 Test Loss: 0.2210081
Validation loss decreased (0.152932 --> 0.152776).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 29 cost time: 0.9303791522979736
Epoch: 29, Steps: 64 | Train Loss: 0.1074585 Vali Loss: 0.1539103 Test Loss: 0.2207449
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 30 cost time: 0.9293627738952637
Epoch: 30, Steps: 64 | Train Loss: 0.1077482 Vali Loss: 0.1541861 Test Loss: 0.2204127
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 31 cost time: 0.9383678436279297
Epoch: 31, Steps: 64 | Train Loss: 0.1073713 Vali Loss: 0.1531762 Test Loss: 0.2201014
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 32 cost time: 0.9373714923858643
Epoch: 32, Steps: 64 | Train Loss: 0.1075895 Vali Loss: 0.1540615 Test Loss: 0.2210244
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 33 cost time: 0.9327466487884521
Epoch: 33, Steps: 64 | Train Loss: 0.1071602 Vali Loss: 0.1530364 Test Loss: 0.2207133
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 34 cost time: 0.9290003776550293
Epoch: 34, Steps: 64 | Train Loss: 0.1076382 Vali Loss: 0.1526429 Test Loss: 0.2207167
Validation loss decreased (0.152776 --> 0.152643).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 35 cost time: 0.9266476631164551
Epoch: 35, Steps: 64 | Train Loss: 0.1072238 Vali Loss: 0.1538036 Test Loss: 0.2204615
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 36 cost time: 0.9396369457244873
Epoch: 36, Steps: 64 | Train Loss: 0.1068883 Vali Loss: 0.1527542 Test Loss: 0.2210564
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 37 cost time: 0.9353694915771484
Epoch: 37, Steps: 64 | Train Loss: 0.1063509 Vali Loss: 0.1530329 Test Loss: 0.2209562
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 38 cost time: 0.9363837242126465
Epoch: 38, Steps: 64 | Train Loss: 0.1066459 Vali Loss: 0.1535722 Test Loss: 0.2212157
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 39 cost time: 0.9467542171478271
Epoch: 39, Steps: 64 | Train Loss: 0.1062366 Vali Loss: 0.1530263 Test Loss: 0.2207322
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 40 cost time: 0.9372289180755615
Epoch: 40, Steps: 64 | Train Loss: 0.1066023 Vali Loss: 0.1528232 Test Loss: 0.2206706
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 41 cost time: 0.92799973487854
Epoch: 41, Steps: 64 | Train Loss: 0.1067832 Vali Loss: 0.1536620 Test Loss: 0.2207093
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 42 cost time: 0.9336180686950684
Epoch: 42, Steps: 64 | Train Loss: 0.1062780 Vali Loss: 0.1545412 Test Loss: 0.2217650
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 43 cost time: 0.9356420040130615
Epoch: 43, Steps: 64 | Train Loss: 0.1064227 Vali Loss: 0.1523194 Test Loss: 0.2210048
Validation loss decreased (0.152643 --> 0.152319).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 44 cost time: 0.932758092880249
Epoch: 44, Steps: 64 | Train Loss: 0.1064806 Vali Loss: 0.1526079 Test Loss: 0.2213740
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 45 cost time: 0.9297411441802979
Epoch: 45, Steps: 64 | Train Loss: 0.1061201 Vali Loss: 0.1536075 Test Loss: 0.2203634
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 46 cost time: 0.941319465637207
Epoch: 46, Steps: 64 | Train Loss: 0.1065700 Vali Loss: 0.1503405 Test Loss: 0.2202975
Validation loss decreased (0.152319 --> 0.150340).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 47 cost time: 0.9155011177062988
Epoch: 47, Steps: 64 | Train Loss: 0.1065590 Vali Loss: 0.1526330 Test Loss: 0.2211851
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 48 cost time: 0.9397563934326172
Epoch: 48, Steps: 64 | Train Loss: 0.1063256 Vali Loss: 0.1515531 Test Loss: 0.2219730
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 49 cost time: 0.937000036239624
Epoch: 49, Steps: 64 | Train Loss: 0.1062467 Vali Loss: 0.1530713 Test Loss: 0.2210867
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 50 cost time: 0.9416108131408691
Epoch: 50, Steps: 64 | Train Loss: 0.1065110 Vali Loss: 0.1512417 Test Loss: 0.2214453
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 51 cost time: 0.9333286285400391
Epoch: 51, Steps: 64 | Train Loss: 0.1062588 Vali Loss: 0.1530613 Test Loss: 0.2212634
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 52 cost time: 0.9323573112487793
Epoch: 52, Steps: 64 | Train Loss: 0.1061282 Vali Loss: 0.1539380 Test Loss: 0.2218077
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 53 cost time: 0.9549293518066406
Epoch: 53, Steps: 64 | Train Loss: 0.1063364 Vali Loss: 0.1534731 Test Loss: 0.2206753
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 54 cost time: 0.9334578514099121
Epoch: 54, Steps: 64 | Train Loss: 0.1060352 Vali Loss: 0.1525655 Test Loss: 0.2219702
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 55 cost time: 0.9397625923156738
Epoch: 55, Steps: 64 | Train Loss: 0.1062489 Vali Loss: 0.1525959 Test Loss: 0.2202188
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 56 cost time: 0.9329991340637207
Epoch: 56, Steps: 64 | Train Loss: 0.1063322 Vali Loss: 0.1545107 Test Loss: 0.2211332
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 57 cost time: 0.933387041091919
Epoch: 57, Steps: 64 | Train Loss: 0.1059074 Vali Loss: 0.1548081 Test Loss: 0.2211822
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 58 cost time: 0.9366116523742676
Epoch: 58, Steps: 64 | Train Loss: 0.1059455 Vali Loss: 0.1531465 Test Loss: 0.2211850
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 59 cost time: 0.9369778633117676
Epoch: 59, Steps: 64 | Train Loss: 0.1060679 Vali Loss: 0.1520768 Test Loss: 0.2210722
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 60 cost time: 0.9273815155029297
Epoch: 60, Steps: 64 | Train Loss: 0.1056085 Vali Loss: 0.1523801 Test Loss: 0.2218025
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2202974557876587, mae:0.32109102606773376, rse:0.23786957561969757
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.05977916717529297 GB
Epoch: 1 cost time: 2.418497085571289
Epoch: 1, Steps: 64 | Train Loss: 0.8822000 Vali Loss: 2.3659329 Test Loss: 3.7735615
Validation loss decreased (inf --> 2.365933).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 2 cost time: 1.059978723526001
Epoch: 2, Steps: 64 | Train Loss: 0.5519599 Vali Loss: 0.5866290 Test Loss: 0.7952348
Validation loss decreased (2.365933 --> 0.586629).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 3 cost time: 1.0285499095916748
Epoch: 3, Steps: 64 | Train Loss: 0.1833102 Vali Loss: 0.2006892 Test Loss: 0.2445975
Validation loss decreased (0.586629 --> 0.200689).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 4 cost time: 0.9769518375396729
Epoch: 4, Steps: 64 | Train Loss: 0.1262688 Vali Loss: 0.1732546 Test Loss: 0.2232940
Validation loss decreased (0.200689 --> 0.173255).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 5 cost time: 0.9733154773712158
Epoch: 5, Steps: 64 | Train Loss: 0.1192047 Vali Loss: 0.1678718 Test Loss: 0.2227951
Validation loss decreased (0.173255 --> 0.167872).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 6 cost time: 0.9754135608673096
Epoch: 6, Steps: 64 | Train Loss: 0.1158157 Vali Loss: 0.1643932 Test Loss: 0.2212995
Validation loss decreased (0.167872 --> 0.164393).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 7 cost time: 1.0177292823791504
Epoch: 7, Steps: 64 | Train Loss: 0.1130914 Vali Loss: 0.1622823 Test Loss: 0.2210916
Validation loss decreased (0.164393 --> 0.162282).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 8 cost time: 0.9719998836517334
Epoch: 8, Steps: 64 | Train Loss: 0.1117302 Vali Loss: 0.1599219 Test Loss: 0.2219615
Validation loss decreased (0.162282 --> 0.159922).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 9 cost time: 0.9746053218841553
Epoch: 9, Steps: 64 | Train Loss: 0.1104139 Vali Loss: 0.1595426 Test Loss: 0.2214749
Validation loss decreased (0.159922 --> 0.159543).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 10 cost time: 0.97821044921875
Epoch: 10, Steps: 64 | Train Loss: 0.1091409 Vali Loss: 0.1597601 Test Loss: 0.2225089
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 11 cost time: 0.9823851585388184
Epoch: 11, Steps: 64 | Train Loss: 0.1082199 Vali Loss: 0.1577507 Test Loss: 0.2215743
Validation loss decreased (0.159543 --> 0.157751).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 12 cost time: 0.9783718585968018
Epoch: 12, Steps: 64 | Train Loss: 0.1074095 Vali Loss: 0.1543946 Test Loss: 0.2217146
Validation loss decreased (0.157751 --> 0.154395).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 13 cost time: 0.9933948516845703
Epoch: 13, Steps: 64 | Train Loss: 0.1065027 Vali Loss: 0.1567530 Test Loss: 0.2217524
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 14 cost time: 0.9752998352050781
Epoch: 14, Steps: 64 | Train Loss: 0.1063605 Vali Loss: 0.1574674 Test Loss: 0.2220191
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 15 cost time: 0.9765980243682861
Epoch: 15, Steps: 64 | Train Loss: 0.1056867 Vali Loss: 0.1557315 Test Loss: 0.2220303
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 16 cost time: 0.9898009300231934
Epoch: 16, Steps: 64 | Train Loss: 0.1049691 Vali Loss: 0.1525777 Test Loss: 0.2212344
Validation loss decreased (0.154395 --> 0.152578).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 17 cost time: 0.9763844013214111
Epoch: 17, Steps: 64 | Train Loss: 0.1042826 Vali Loss: 0.1528850 Test Loss: 0.2213215
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 18 cost time: 0.9711604118347168
Epoch: 18, Steps: 64 | Train Loss: 0.1043563 Vali Loss: 0.1545593 Test Loss: 0.2219273
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 19 cost time: 0.9720008373260498
Epoch: 19, Steps: 64 | Train Loss: 0.1037418 Vali Loss: 0.1536763 Test Loss: 0.2221564
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 20 cost time: 0.9505937099456787
Epoch: 20, Steps: 64 | Train Loss: 0.1033530 Vali Loss: 0.1534653 Test Loss: 0.2228260
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 21 cost time: 0.9702234268188477
Epoch: 21, Steps: 64 | Train Loss: 0.1036602 Vali Loss: 0.1526131 Test Loss: 0.2220538
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 22 cost time: 0.9893488883972168
Epoch: 22, Steps: 64 | Train Loss: 0.1031381 Vali Loss: 0.1513191 Test Loss: 0.2223347
Validation loss decreased (0.152578 --> 0.151319).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 23 cost time: 0.9636878967285156
Epoch: 23, Steps: 64 | Train Loss: 0.1028277 Vali Loss: 0.1508392 Test Loss: 0.2223615
Validation loss decreased (0.151319 --> 0.150839).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 24 cost time: 0.9653599262237549
Epoch: 24, Steps: 64 | Train Loss: 0.1029300 Vali Loss: 0.1516761 Test Loss: 0.2221153
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 25 cost time: 0.9673714637756348
Epoch: 25, Steps: 64 | Train Loss: 0.1022512 Vali Loss: 0.1501649 Test Loss: 0.2232658
Validation loss decreased (0.150839 --> 0.150165).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 26 cost time: 0.9527218341827393
Epoch: 26, Steps: 64 | Train Loss: 0.1024310 Vali Loss: 0.1506659 Test Loss: 0.2221677
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 27 cost time: 0.9694774150848389
Epoch: 27, Steps: 64 | Train Loss: 0.1020591 Vali Loss: 0.1509384 Test Loss: 0.2226466
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 28 cost time: 0.9690001010894775
Epoch: 28, Steps: 64 | Train Loss: 0.1024808 Vali Loss: 0.1501827 Test Loss: 0.2220804
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 29 cost time: 0.9686272144317627
Epoch: 29, Steps: 64 | Train Loss: 0.1015334 Vali Loss: 0.1521670 Test Loss: 0.2230247
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 30 cost time: 0.9730010032653809
Epoch: 30, Steps: 64 | Train Loss: 0.1015593 Vali Loss: 0.1506336 Test Loss: 0.2225194
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 31 cost time: 0.9673898220062256
Epoch: 31, Steps: 64 | Train Loss: 0.1015203 Vali Loss: 0.1513359 Test Loss: 0.2223297
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 32 cost time: 0.9623620510101318
Epoch: 32, Steps: 64 | Train Loss: 0.1018616 Vali Loss: 0.1505355 Test Loss: 0.2227632
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 33 cost time: 0.9724106788635254
Epoch: 33, Steps: 64 | Train Loss: 0.1014512 Vali Loss: 0.1496450 Test Loss: 0.2225841
Validation loss decreased (0.150165 --> 0.149645).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 34 cost time: 0.984896183013916
Epoch: 34, Steps: 64 | Train Loss: 0.1016627 Vali Loss: 0.1522487 Test Loss: 0.2233918
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 35 cost time: 0.9863753318786621
Epoch: 35, Steps: 64 | Train Loss: 0.1016075 Vali Loss: 0.1512012 Test Loss: 0.2226585
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 36 cost time: 0.9973428249359131
Epoch: 36, Steps: 64 | Train Loss: 0.1016037 Vali Loss: 0.1506606 Test Loss: 0.2227782
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 37 cost time: 0.9927160739898682
Epoch: 37, Steps: 64 | Train Loss: 0.1012354 Vali Loss: 0.1497389 Test Loss: 0.2228621
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 38 cost time: 0.9856832027435303
Epoch: 38, Steps: 64 | Train Loss: 0.1014365 Vali Loss: 0.1505114 Test Loss: 0.2224995
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 39 cost time: 0.9950003623962402
Epoch: 39, Steps: 64 | Train Loss: 0.1013868 Vali Loss: 0.1499263 Test Loss: 0.2226442
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 40 cost time: 0.9846000671386719
Epoch: 40, Steps: 64 | Train Loss: 0.1015677 Vali Loss: 0.1503064 Test Loss: 0.2226161
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 41 cost time: 0.9862978458404541
Epoch: 41, Steps: 64 | Train Loss: 0.1013384 Vali Loss: 0.1489193 Test Loss: 0.2224118
Validation loss decreased (0.149645 --> 0.148919).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 42 cost time: 0.9850695133209229
Epoch: 42, Steps: 64 | Train Loss: 0.1014436 Vali Loss: 0.1488991 Test Loss: 0.2226178
Validation loss decreased (0.148919 --> 0.148899).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 43 cost time: 0.9745721817016602
Epoch: 43, Steps: 64 | Train Loss: 0.1012433 Vali Loss: 0.1499200 Test Loss: 0.2226845
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 44 cost time: 0.9663622379302979
Epoch: 44, Steps: 64 | Train Loss: 0.1009012 Vali Loss: 0.1500429 Test Loss: 0.2230653
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 45 cost time: 0.970433235168457
Epoch: 45, Steps: 64 | Train Loss: 0.1012271 Vali Loss: 0.1490632 Test Loss: 0.2224342
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 46 cost time: 0.9723401069641113
Epoch: 46, Steps: 64 | Train Loss: 0.1011612 Vali Loss: 0.1490999 Test Loss: 0.2229066
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 47 cost time: 0.9677548408508301
Epoch: 47, Steps: 64 | Train Loss: 0.1014391 Vali Loss: 0.1500840 Test Loss: 0.2228733
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 48 cost time: 0.9657766819000244
Epoch: 48, Steps: 64 | Train Loss: 0.1010538 Vali Loss: 0.1506065 Test Loss: 0.2233057
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 49 cost time: 0.9740011692047119
Epoch: 49, Steps: 64 | Train Loss: 0.1011051 Vali Loss: 0.1491149 Test Loss: 0.2236453
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 50 cost time: 0.9811172485351562
Epoch: 50, Steps: 64 | Train Loss: 0.1011025 Vali Loss: 0.1506408 Test Loss: 0.2226817
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 51 cost time: 0.9865949153900146
Epoch: 51, Steps: 64 | Train Loss: 0.1010159 Vali Loss: 0.1486647 Test Loss: 0.2226401
Validation loss decreased (0.148899 --> 0.148665).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 52 cost time: 0.9863779544830322
Epoch: 52, Steps: 64 | Train Loss: 0.1014429 Vali Loss: 0.1498971 Test Loss: 0.2243026
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 53 cost time: 0.9923064708709717
Epoch: 53, Steps: 64 | Train Loss: 0.1006966 Vali Loss: 0.1494687 Test Loss: 0.2229033
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 54 cost time: 0.9853627681732178
Epoch: 54, Steps: 64 | Train Loss: 0.1014670 Vali Loss: 0.1483489 Test Loss: 0.2230102
Validation loss decreased (0.148665 --> 0.148349).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 55 cost time: 0.9889829158782959
Epoch: 55, Steps: 64 | Train Loss: 0.1009150 Vali Loss: 0.1524946 Test Loss: 0.2232497
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 56 cost time: 0.9817643165588379
Epoch: 56, Steps: 64 | Train Loss: 0.1008990 Vali Loss: 0.1502300 Test Loss: 0.2235118
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 57 cost time: 0.9470417499542236
Epoch: 57, Steps: 64 | Train Loss: 0.1014005 Vali Loss: 0.1483506 Test Loss: 0.2226914
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 58 cost time: 0.9658081531524658
Epoch: 58, Steps: 64 | Train Loss: 0.1012358 Vali Loss: 0.1487757 Test Loss: 0.2228293
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 59 cost time: 0.9689853191375732
Epoch: 59, Steps: 64 | Train Loss: 0.1009214 Vali Loss: 0.1503501 Test Loss: 0.2230928
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 60 cost time: 0.9636309146881104
Epoch: 60, Steps: 64 | Train Loss: 0.1007874 Vali Loss: 0.1471954 Test Loss: 0.2223834
Validation loss decreased (0.148349 --> 0.147195).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22238343954086304, mae:0.32524558901786804, rse:0.2389930933713913
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.057389259338378906 GB
Epoch: 1 cost time: 2.2433550357818604
Epoch: 1, Steps: 64 | Train Loss: 1.1862015 Vali Loss: 2.6372395 Test Loss: 4.2500138
Validation loss decreased (inf --> 2.637239).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 2 cost time: 0.9193696975708008
Epoch: 2, Steps: 64 | Train Loss: 0.6062521 Vali Loss: 0.4331032 Test Loss: 0.5735304
Validation loss decreased (2.637239 --> 0.433103).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 3 cost time: 0.9157114028930664
Epoch: 3, Steps: 64 | Train Loss: 0.2526031 Vali Loss: 0.2416586 Test Loss: 0.2731312
Validation loss decreased (0.433103 --> 0.241659).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 4 cost time: 0.9156591892242432
Epoch: 4, Steps: 64 | Train Loss: 0.1977111 Vali Loss: 0.2030800 Test Loss: 0.2407399
Validation loss decreased (0.241659 --> 0.203080).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 5 cost time: 0.9158267974853516
Epoch: 5, Steps: 64 | Train Loss: 0.1781189 Vali Loss: 0.1932257 Test Loss: 0.2308779
Validation loss decreased (0.203080 --> 0.193226).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 6 cost time: 0.916449785232544
Epoch: 6, Steps: 64 | Train Loss: 0.1667037 Vali Loss: 0.1842814 Test Loss: 0.2283092
Validation loss decreased (0.193226 --> 0.184281).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 7 cost time: 0.9129998683929443
Epoch: 7, Steps: 64 | Train Loss: 0.1595806 Vali Loss: 0.1791155 Test Loss: 0.2268922
Validation loss decreased (0.184281 --> 0.179116).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 8 cost time: 0.9150087833404541
Epoch: 8, Steps: 64 | Train Loss: 0.1530613 Vali Loss: 0.1746702 Test Loss: 0.2258384
Validation loss decreased (0.179116 --> 0.174670).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 9 cost time: 0.9144043922424316
Epoch: 9, Steps: 64 | Train Loss: 0.1484282 Vali Loss: 0.1726158 Test Loss: 0.2248588
Validation loss decreased (0.174670 --> 0.172616).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 10 cost time: 0.9144134521484375
Epoch: 10, Steps: 64 | Train Loss: 0.1444360 Vali Loss: 0.1692148 Test Loss: 0.2241929
Validation loss decreased (0.172616 --> 0.169215).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 11 cost time: 0.9193503856658936
Epoch: 11, Steps: 64 | Train Loss: 0.1422981 Vali Loss: 0.1659842 Test Loss: 0.2237137
Validation loss decreased (0.169215 --> 0.165984).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 12 cost time: 0.9177474975585938
Epoch: 12, Steps: 64 | Train Loss: 0.1394766 Vali Loss: 0.1659416 Test Loss: 0.2252709
Validation loss decreased (0.165984 --> 0.165942).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 13 cost time: 0.9329996109008789
Epoch: 13, Steps: 64 | Train Loss: 0.1377661 Vali Loss: 0.1651273 Test Loss: 0.2235557
Validation loss decreased (0.165942 --> 0.165127).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 14 cost time: 0.9169995784759521
Epoch: 14, Steps: 64 | Train Loss: 0.1361547 Vali Loss: 0.1643008 Test Loss: 0.2245194
Validation loss decreased (0.165127 --> 0.164301).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 15 cost time: 0.9146325588226318
Epoch: 15, Steps: 64 | Train Loss: 0.1347067 Vali Loss: 0.1642441 Test Loss: 0.2249738
Validation loss decreased (0.164301 --> 0.164244).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 16 cost time: 0.9163739681243896
Epoch: 16, Steps: 64 | Train Loss: 0.1330693 Vali Loss: 0.1631671 Test Loss: 0.2252630
Validation loss decreased (0.164244 --> 0.163167).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 17 cost time: 0.9351575374603271
Epoch: 17, Steps: 64 | Train Loss: 0.1322512 Vali Loss: 0.1625139 Test Loss: 0.2231266
Validation loss decreased (0.163167 --> 0.162514).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 18 cost time: 0.9284226894378662
Epoch: 18, Steps: 64 | Train Loss: 0.1314234 Vali Loss: 0.1626407 Test Loss: 0.2231901
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 19 cost time: 0.9343066215515137
Epoch: 19, Steps: 64 | Train Loss: 0.1307974 Vali Loss: 0.1626724 Test Loss: 0.2241529
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 20 cost time: 0.9497370719909668
Epoch: 20, Steps: 64 | Train Loss: 0.1297905 Vali Loss: 0.1612117 Test Loss: 0.2239898
Validation loss decreased (0.162514 --> 0.161212).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 21 cost time: 0.9366014003753662
Epoch: 21, Steps: 64 | Train Loss: 0.1292091 Vali Loss: 0.1615467 Test Loss: 0.2238220
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 22 cost time: 0.9375951290130615
Epoch: 22, Steps: 64 | Train Loss: 0.1281349 Vali Loss: 0.1591357 Test Loss: 0.2236081
Validation loss decreased (0.161212 --> 0.159136).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 23 cost time: 0.9363257884979248
Epoch: 23, Steps: 64 | Train Loss: 0.1274748 Vali Loss: 0.1604195 Test Loss: 0.2235581
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 24 cost time: 0.9223446846008301
Epoch: 24, Steps: 64 | Train Loss: 0.1278012 Vali Loss: 0.1613285 Test Loss: 0.2237515
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 25 cost time: 0.9293029308319092
Epoch: 25, Steps: 64 | Train Loss: 0.1269315 Vali Loss: 0.1610316 Test Loss: 0.2242548
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 26 cost time: 0.9329071044921875
Epoch: 26, Steps: 64 | Train Loss: 0.1272175 Vali Loss: 0.1604572 Test Loss: 0.2234434
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 27 cost time: 0.9241712093353271
Epoch: 27, Steps: 64 | Train Loss: 0.1263054 Vali Loss: 0.1597947 Test Loss: 0.2232268
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 28 cost time: 0.9179997444152832
Epoch: 28, Steps: 64 | Train Loss: 0.1258855 Vali Loss: 0.1583409 Test Loss: 0.2241019
Validation loss decreased (0.159136 --> 0.158341).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 29 cost time: 0.9229981899261475
Epoch: 29, Steps: 64 | Train Loss: 0.1256768 Vali Loss: 0.1586688 Test Loss: 0.2238515
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 30 cost time: 0.9206292629241943
Epoch: 30, Steps: 64 | Train Loss: 0.1254333 Vali Loss: 0.1591778 Test Loss: 0.2239520
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 31 cost time: 0.9157216548919678
Epoch: 31, Steps: 64 | Train Loss: 0.1253377 Vali Loss: 0.1596836 Test Loss: 0.2246089
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 32 cost time: 0.9213418960571289
Epoch: 32, Steps: 64 | Train Loss: 0.1247965 Vali Loss: 0.1605784 Test Loss: 0.2238420
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 33 cost time: 0.9163877964019775
Epoch: 33, Steps: 64 | Train Loss: 0.1244280 Vali Loss: 0.1599133 Test Loss: 0.2245661
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 34 cost time: 0.9247725009918213
Epoch: 34, Steps: 64 | Train Loss: 0.1243149 Vali Loss: 0.1585665 Test Loss: 0.2249578
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 35 cost time: 0.9159989356994629
Epoch: 35, Steps: 64 | Train Loss: 0.1239956 Vali Loss: 0.1599319 Test Loss: 0.2245824
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 36 cost time: 0.9099998474121094
Epoch: 36, Steps: 64 | Train Loss: 0.1237206 Vali Loss: 0.1572655 Test Loss: 0.2237966
Validation loss decreased (0.158341 --> 0.157265).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 37 cost time: 0.9206197261810303
Epoch: 37, Steps: 64 | Train Loss: 0.1233981 Vali Loss: 0.1585613 Test Loss: 0.2228509
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 38 cost time: 0.9990267753601074
Epoch: 38, Steps: 64 | Train Loss: 0.1238177 Vali Loss: 0.1595549 Test Loss: 0.2242369
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 39 cost time: 0.9178009033203125
Epoch: 39, Steps: 64 | Train Loss: 0.1237096 Vali Loss: 0.1592020 Test Loss: 0.2242056
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 40 cost time: 0.9183118343353271
Epoch: 40, Steps: 64 | Train Loss: 0.1239612 Vali Loss: 0.1592706 Test Loss: 0.2236906
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 41 cost time: 0.9113461971282959
Epoch: 41, Steps: 64 | Train Loss: 0.1230984 Vali Loss: 0.1600673 Test Loss: 0.2239875
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 42 cost time: 0.9147224426269531
Epoch: 42, Steps: 64 | Train Loss: 0.1237971 Vali Loss: 0.1593795 Test Loss: 0.2231123
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 43 cost time: 0.913327693939209
Epoch: 43, Steps: 64 | Train Loss: 0.1235749 Vali Loss: 0.1593530 Test Loss: 0.2233374
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 44 cost time: 0.9246222972869873
Epoch: 44, Steps: 64 | Train Loss: 0.1232654 Vali Loss: 0.1590132 Test Loss: 0.2230935
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 45 cost time: 0.9104197025299072
Epoch: 45, Steps: 64 | Train Loss: 0.1233421 Vali Loss: 0.1582940 Test Loss: 0.2243135
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 46 cost time: 0.9210429191589355
Epoch: 46, Steps: 64 | Train Loss: 0.1230778 Vali Loss: 0.1593080 Test Loss: 0.2238023
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 47 cost time: 0.920393705368042
Epoch: 47, Steps: 64 | Train Loss: 0.1230385 Vali Loss: 0.1563609 Test Loss: 0.2237584
Validation loss decreased (0.157265 --> 0.156361).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 48 cost time: 0.9313609600067139
Epoch: 48, Steps: 64 | Train Loss: 0.1231198 Vali Loss: 0.1579466 Test Loss: 0.2239142
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 49 cost time: 0.9158074855804443
Epoch: 49, Steps: 64 | Train Loss: 0.1227569 Vali Loss: 0.1588794 Test Loss: 0.2238381
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 50 cost time: 0.915999174118042
Epoch: 50, Steps: 64 | Train Loss: 0.1226736 Vali Loss: 0.1584869 Test Loss: 0.2240821
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 51 cost time: 0.9223196506500244
Epoch: 51, Steps: 64 | Train Loss: 0.1231592 Vali Loss: 0.1597130 Test Loss: 0.2241820
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 52 cost time: 0.9166882038116455
Epoch: 52, Steps: 64 | Train Loss: 0.1228296 Vali Loss: 0.1598514 Test Loss: 0.2233500
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 53 cost time: 0.9103925228118896
Epoch: 53, Steps: 64 | Train Loss: 0.1229827 Vali Loss: 0.1584917 Test Loss: 0.2232464
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 54 cost time: 0.9083547592163086
Epoch: 54, Steps: 64 | Train Loss: 0.1227155 Vali Loss: 0.1585483 Test Loss: 0.2237884
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 55 cost time: 0.932722806930542
Epoch: 55, Steps: 64 | Train Loss: 0.1224456 Vali Loss: 0.1574597 Test Loss: 0.2236551
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 56 cost time: 0.9173891544342041
Epoch: 56, Steps: 64 | Train Loss: 0.1226279 Vali Loss: 0.1576602 Test Loss: 0.2227352
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 57 cost time: 0.9189999103546143
Epoch: 57, Steps: 64 | Train Loss: 0.1225186 Vali Loss: 0.1582364 Test Loss: 0.2239725
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 58 cost time: 0.9256134033203125
Epoch: 58, Steps: 64 | Train Loss: 0.1225489 Vali Loss: 0.1577958 Test Loss: 0.2235012
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 59 cost time: 0.914496898651123
Epoch: 59, Steps: 64 | Train Loss: 0.1223071 Vali Loss: 0.1590255 Test Loss: 0.2245948
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 60 cost time: 0.9103195667266846
Epoch: 60, Steps: 64 | Train Loss: 0.1224248 Vali Loss: 0.1571290 Test Loss: 0.2241751
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22375833988189697, mae:0.3289777636528015, rse:0.23973074555397034
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.05882120132446289 GB
Epoch: 1 cost time: 2.2897918224334717
Epoch: 1, Steps: 64 | Train Loss: 0.9564117 Vali Loss: 2.4659047 Test Loss: 3.9066122
Validation loss decreased (inf --> 2.465905).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 2 cost time: 0.8969254493713379
Epoch: 2, Steps: 64 | Train Loss: 0.5442524 Vali Loss: 0.5448124 Test Loss: 0.6932316
Validation loss decreased (2.465905 --> 0.544812).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 3 cost time: 0.8668971061706543
Epoch: 3, Steps: 64 | Train Loss: 0.1934015 Vali Loss: 0.2197549 Test Loss: 0.2399390
Validation loss decreased (0.544812 --> 0.219755).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 4 cost time: 0.8886106014251709
Epoch: 4, Steps: 64 | Train Loss: 0.1404894 Vali Loss: 0.1853317 Test Loss: 0.2230303
Validation loss decreased (0.219755 --> 0.185332).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 5 cost time: 0.8877401351928711
Epoch: 5, Steps: 64 | Train Loss: 0.1307879 Vali Loss: 0.1740823 Test Loss: 0.2202180
Validation loss decreased (0.185332 --> 0.174082).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 6 cost time: 0.8523974418640137
Epoch: 6, Steps: 64 | Train Loss: 0.1262358 Vali Loss: 0.1675159 Test Loss: 0.2189849
Validation loss decreased (0.174082 --> 0.167516).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 7 cost time: 0.8814494609832764
Epoch: 7, Steps: 64 | Train Loss: 0.1220256 Vali Loss: 0.1645634 Test Loss: 0.2193047
Validation loss decreased (0.167516 --> 0.164563).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 8 cost time: 0.8827221393585205
Epoch: 8, Steps: 64 | Train Loss: 0.1191115 Vali Loss: 0.1633889 Test Loss: 0.2184982
Validation loss decreased (0.164563 --> 0.163389).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 9 cost time: 0.891000509262085
Epoch: 9, Steps: 64 | Train Loss: 0.1174945 Vali Loss: 0.1630947 Test Loss: 0.2184203
Validation loss decreased (0.163389 --> 0.163095).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 10 cost time: 0.8856143951416016
Epoch: 10, Steps: 64 | Train Loss: 0.1158887 Vali Loss: 0.1605836 Test Loss: 0.2184294
Validation loss decreased (0.163095 --> 0.160584).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 11 cost time: 0.8843364715576172
Epoch: 11, Steps: 64 | Train Loss: 0.1143232 Vali Loss: 0.1583327 Test Loss: 0.2182546
Validation loss decreased (0.160584 --> 0.158333).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 12 cost time: 0.8923823833465576
Epoch: 12, Steps: 64 | Train Loss: 0.1130118 Vali Loss: 0.1591342 Test Loss: 0.2205264
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 13 cost time: 0.9053459167480469
Epoch: 13, Steps: 64 | Train Loss: 0.1120645 Vali Loss: 0.1569929 Test Loss: 0.2196900
Validation loss decreased (0.158333 --> 0.156993).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 14 cost time: 0.8900842666625977
Epoch: 14, Steps: 64 | Train Loss: 0.1115641 Vali Loss: 0.1586053 Test Loss: 0.2205567
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 15 cost time: 0.8809995651245117
Epoch: 15, Steps: 64 | Train Loss: 0.1106575 Vali Loss: 0.1566491 Test Loss: 0.2200755
Validation loss decreased (0.156993 --> 0.156649).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 16 cost time: 0.8936138153076172
Epoch: 16, Steps: 64 | Train Loss: 0.1099535 Vali Loss: 0.1564881 Test Loss: 0.2201766
Validation loss decreased (0.156649 --> 0.156488).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 17 cost time: 0.8832070827484131
Epoch: 17, Steps: 64 | Train Loss: 0.1097790 Vali Loss: 0.1547521 Test Loss: 0.2204836
Validation loss decreased (0.156488 --> 0.154752).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 18 cost time: 0.8764312267303467
Epoch: 18, Steps: 64 | Train Loss: 0.1085006 Vali Loss: 0.1542707 Test Loss: 0.2209543
Validation loss decreased (0.154752 --> 0.154271).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 19 cost time: 0.880119800567627
Epoch: 19, Steps: 64 | Train Loss: 0.1081416 Vali Loss: 0.1545319 Test Loss: 0.2210465
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 20 cost time: 0.8957240581512451
Epoch: 20, Steps: 64 | Train Loss: 0.1078643 Vali Loss: 0.1553891 Test Loss: 0.2215223
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 21 cost time: 0.883000373840332
Epoch: 21, Steps: 64 | Train Loss: 0.1076228 Vali Loss: 0.1555884 Test Loss: 0.2216085
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 22 cost time: 0.883612871170044
Epoch: 22, Steps: 64 | Train Loss: 0.1072409 Vali Loss: 0.1544737 Test Loss: 0.2215383
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 23 cost time: 0.8853452205657959
Epoch: 23, Steps: 64 | Train Loss: 0.1068380 Vali Loss: 0.1521281 Test Loss: 0.2213633
Validation loss decreased (0.154271 --> 0.152128).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 24 cost time: 0.8679344654083252
Epoch: 24, Steps: 64 | Train Loss: 0.1064522 Vali Loss: 0.1555276 Test Loss: 0.2217542
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 25 cost time: 0.8814072608947754
Epoch: 25, Steps: 64 | Train Loss: 0.1059422 Vali Loss: 0.1513783 Test Loss: 0.2216723
Validation loss decreased (0.152128 --> 0.151378).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 26 cost time: 0.8839998245239258
Epoch: 26, Steps: 64 | Train Loss: 0.1057149 Vali Loss: 0.1520099 Test Loss: 0.2213526
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 27 cost time: 0.8878209590911865
Epoch: 27, Steps: 64 | Train Loss: 0.1063931 Vali Loss: 0.1532839 Test Loss: 0.2214635
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 28 cost time: 0.8457105159759521
Epoch: 28, Steps: 64 | Train Loss: 0.1052779 Vali Loss: 0.1524563 Test Loss: 0.2215068
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 29 cost time: 0.8833370208740234
Epoch: 29, Steps: 64 | Train Loss: 0.1052894 Vali Loss: 0.1519323 Test Loss: 0.2217383
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 30 cost time: 0.884340763092041
Epoch: 30, Steps: 64 | Train Loss: 0.1052428 Vali Loss: 0.1527928 Test Loss: 0.2217770
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 31 cost time: 0.876755952835083
Epoch: 31, Steps: 64 | Train Loss: 0.1052975 Vali Loss: 0.1510630 Test Loss: 0.2229725
Validation loss decreased (0.151378 --> 0.151063).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 32 cost time: 0.8854291439056396
Epoch: 32, Steps: 64 | Train Loss: 0.1052845 Vali Loss: 0.1528512 Test Loss: 0.2221668
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 33 cost time: 0.882610559463501
Epoch: 33, Steps: 64 | Train Loss: 0.1048602 Vali Loss: 0.1542023 Test Loss: 0.2230065
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 34 cost time: 0.8847560882568359
Epoch: 34, Steps: 64 | Train Loss: 0.1049276 Vali Loss: 0.1515477 Test Loss: 0.2217200
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 35 cost time: 0.8829555511474609
Epoch: 35, Steps: 64 | Train Loss: 0.1047320 Vali Loss: 0.1516564 Test Loss: 0.2213449
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 36 cost time: 0.8787796497344971
Epoch: 36, Steps: 64 | Train Loss: 0.1047681 Vali Loss: 0.1525188 Test Loss: 0.2217924
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 37 cost time: 0.885350227355957
Epoch: 37, Steps: 64 | Train Loss: 0.1049860 Vali Loss: 0.1516035 Test Loss: 0.2215616
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 38 cost time: 0.8989999294281006
Epoch: 38, Steps: 64 | Train Loss: 0.1043761 Vali Loss: 0.1530475 Test Loss: 0.2226885
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 39 cost time: 0.8916118144989014
Epoch: 39, Steps: 64 | Train Loss: 0.1045473 Vali Loss: 0.1519380 Test Loss: 0.2217652
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 40 cost time: 0.892411470413208
Epoch: 40, Steps: 64 | Train Loss: 0.1046226 Vali Loss: 0.1525462 Test Loss: 0.2223400
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 41 cost time: 0.89005446434021
Epoch: 41, Steps: 64 | Train Loss: 0.1044983 Vali Loss: 0.1508520 Test Loss: 0.2223029
Validation loss decreased (0.151063 --> 0.150852).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 42 cost time: 0.8963577747344971
Epoch: 42, Steps: 64 | Train Loss: 0.1041238 Vali Loss: 0.1525448 Test Loss: 0.2222885
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 43 cost time: 0.8788204193115234
Epoch: 43, Steps: 64 | Train Loss: 0.1039451 Vali Loss: 0.1522449 Test Loss: 0.2223685
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 44 cost time: 0.880000114440918
Epoch: 44, Steps: 64 | Train Loss: 0.1039076 Vali Loss: 0.1520174 Test Loss: 0.2223098
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 45 cost time: 0.8947124481201172
Epoch: 45, Steps: 64 | Train Loss: 0.1044470 Vali Loss: 0.1521209 Test Loss: 0.2229930
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 46 cost time: 0.8813626766204834
Epoch: 46, Steps: 64 | Train Loss: 0.1048072 Vali Loss: 0.1519875 Test Loss: 0.2224795
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 47 cost time: 0.885331392288208
Epoch: 47, Steps: 64 | Train Loss: 0.1045554 Vali Loss: 0.1524016 Test Loss: 0.2224651
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 48 cost time: 0.8847267627716064
Epoch: 48, Steps: 64 | Train Loss: 0.1039460 Vali Loss: 0.1487841 Test Loss: 0.2229038
Validation loss decreased (0.150852 --> 0.148784).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 49 cost time: 0.8858091831207275
Epoch: 49, Steps: 64 | Train Loss: 0.1044803 Vali Loss: 0.1511228 Test Loss: 0.2219934
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 50 cost time: 0.8592269420623779
Epoch: 50, Steps: 64 | Train Loss: 0.1046174 Vali Loss: 0.1513435 Test Loss: 0.2227005
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 51 cost time: 0.8623316287994385
Epoch: 51, Steps: 64 | Train Loss: 0.1044613 Vali Loss: 0.1515707 Test Loss: 0.2220231
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 52 cost time: 0.8704028129577637
Epoch: 52, Steps: 64 | Train Loss: 0.1042676 Vali Loss: 0.1520602 Test Loss: 0.2221673
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 53 cost time: 0.8683915138244629
Epoch: 53, Steps: 64 | Train Loss: 0.1040713 Vali Loss: 0.1523980 Test Loss: 0.2222272
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 54 cost time: 0.8763427734375
Epoch: 54, Steps: 64 | Train Loss: 0.1040921 Vali Loss: 0.1507725 Test Loss: 0.2218220
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 55 cost time: 0.8889999389648438
Epoch: 55, Steps: 64 | Train Loss: 0.1043257 Vali Loss: 0.1505678 Test Loss: 0.2216046
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 56 cost time: 0.895374059677124
Epoch: 56, Steps: 64 | Train Loss: 0.1043043 Vali Loss: 0.1513656 Test Loss: 0.2227496
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 57 cost time: 0.8873579502105713
Epoch: 57, Steps: 64 | Train Loss: 0.1037504 Vali Loss: 0.1518349 Test Loss: 0.2219742
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 58 cost time: 0.8843450546264648
Epoch: 58, Steps: 64 | Train Loss: 0.1039464 Vali Loss: 0.1532511 Test Loss: 0.2223335
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 59 cost time: 0.8852577209472656
Epoch: 59, Steps: 64 | Train Loss: 0.1045184 Vali Loss: 0.1512892 Test Loss: 0.2223985
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 60 cost time: 0.8989992141723633
Epoch: 60, Steps: 64 | Train Loss: 0.1040001 Vali Loss: 0.1525191 Test Loss: 0.2222757
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2229037880897522, mae:0.32735350728034973, rse:0.23927253484725952
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.05994129180908203 GB
Epoch: 1 cost time: 2.401811361312866
Epoch: 1, Steps: 64 | Train Loss: 0.8531694 Vali Loss: 2.3047073 Test Loss: 3.6467488
Validation loss decreased (inf --> 2.304707).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 2 cost time: 0.9816093444824219
Epoch: 2, Steps: 64 | Train Loss: 0.5257653 Vali Loss: 0.4826884 Test Loss: 0.6627896
Validation loss decreased (2.304707 --> 0.482688).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 3 cost time: 0.982720136642456
Epoch: 3, Steps: 64 | Train Loss: 0.1648301 Vali Loss: 0.2062517 Test Loss: 0.2581799
Validation loss decreased (0.482688 --> 0.206252).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 4 cost time: 0.9702455997467041
Epoch: 4, Steps: 64 | Train Loss: 0.1294489 Vali Loss: 0.1836326 Test Loss: 0.2361563
Validation loss decreased (0.206252 --> 0.183633).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 5 cost time: 0.9732353687286377
Epoch: 5, Steps: 64 | Train Loss: 0.1210800 Vali Loss: 0.1735459 Test Loss: 0.2269136
Validation loss decreased (0.183633 --> 0.173546).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 6 cost time: 0.9683506488800049
Epoch: 6, Steps: 64 | Train Loss: 0.1165923 Vali Loss: 0.1704054 Test Loss: 0.2244063
Validation loss decreased (0.173546 --> 0.170405).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 7 cost time: 0.9703717231750488
Epoch: 7, Steps: 64 | Train Loss: 0.1143630 Vali Loss: 0.1638562 Test Loss: 0.2226647
Validation loss decreased (0.170405 --> 0.163856).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 8 cost time: 0.9690694808959961
Epoch: 8, Steps: 64 | Train Loss: 0.1124676 Vali Loss: 0.1670819 Test Loss: 0.2206597
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 9 cost time: 0.9713296890258789
Epoch: 9, Steps: 64 | Train Loss: 0.1105399 Vali Loss: 0.1627970 Test Loss: 0.2223224
Validation loss decreased (0.163856 --> 0.162797).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 10 cost time: 0.9827430248260498
Epoch: 10, Steps: 64 | Train Loss: 0.1093126 Vali Loss: 0.1627028 Test Loss: 0.2231154
Validation loss decreased (0.162797 --> 0.162703).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 11 cost time: 0.9747664928436279
Epoch: 11, Steps: 64 | Train Loss: 0.1080731 Vali Loss: 0.1593463 Test Loss: 0.2235847
Validation loss decreased (0.162703 --> 0.159346).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 12 cost time: 0.9696297645568848
Epoch: 12, Steps: 64 | Train Loss: 0.1066526 Vali Loss: 0.1564650 Test Loss: 0.2235264
Validation loss decreased (0.159346 --> 0.156465).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 13 cost time: 0.9816253185272217
Epoch: 13, Steps: 64 | Train Loss: 0.1057949 Vali Loss: 0.1593816 Test Loss: 0.2226445
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 14 cost time: 0.9666152000427246
Epoch: 14, Steps: 64 | Train Loss: 0.1053114 Vali Loss: 0.1556278 Test Loss: 0.2232689
Validation loss decreased (0.156465 --> 0.155628).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 15 cost time: 0.968369722366333
Epoch: 15, Steps: 64 | Train Loss: 0.1052033 Vali Loss: 0.1555286 Test Loss: 0.2235042
Validation loss decreased (0.155628 --> 0.155529).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 16 cost time: 0.9838616847991943
Epoch: 16, Steps: 64 | Train Loss: 0.1042354 Vali Loss: 0.1541839 Test Loss: 0.2253809
Validation loss decreased (0.155529 --> 0.154184).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 17 cost time: 0.9673738479614258
Epoch: 17, Steps: 64 | Train Loss: 0.1036406 Vali Loss: 0.1545309 Test Loss: 0.2255080
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 18 cost time: 0.9693522453308105
Epoch: 18, Steps: 64 | Train Loss: 0.1036959 Vali Loss: 0.1543752 Test Loss: 0.2247299
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 19 cost time: 0.9713754653930664
Epoch: 19, Steps: 64 | Train Loss: 0.1027294 Vali Loss: 0.1518005 Test Loss: 0.2247581
Validation loss decreased (0.154184 --> 0.151801).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 20 cost time: 0.9687695503234863
Epoch: 20, Steps: 64 | Train Loss: 0.1027261 Vali Loss: 0.1534086 Test Loss: 0.2255350
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 21 cost time: 0.974764347076416
Epoch: 21, Steps: 64 | Train Loss: 0.1022986 Vali Loss: 0.1524910 Test Loss: 0.2264777
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 22 cost time: 0.9679999351501465
Epoch: 22, Steps: 64 | Train Loss: 0.1018496 Vali Loss: 0.1517026 Test Loss: 0.2244824
Validation loss decreased (0.151801 --> 0.151703).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 23 cost time: 0.9732048511505127
Epoch: 23, Steps: 64 | Train Loss: 0.1023335 Vali Loss: 0.1515111 Test Loss: 0.2256523
Validation loss decreased (0.151703 --> 0.151511).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 24 cost time: 0.9684231281280518
Epoch: 24, Steps: 64 | Train Loss: 0.1018289 Vali Loss: 0.1505240 Test Loss: 0.2261722
Validation loss decreased (0.151511 --> 0.150524).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 25 cost time: 0.9674196243286133
Epoch: 25, Steps: 64 | Train Loss: 0.1016663 Vali Loss: 0.1504370 Test Loss: 0.2251738
Validation loss decreased (0.150524 --> 0.150437).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 26 cost time: 0.9764158725738525
Epoch: 26, Steps: 64 | Train Loss: 0.1014280 Vali Loss: 0.1502464 Test Loss: 0.2259748
Validation loss decreased (0.150437 --> 0.150246).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 27 cost time: 0.9728560447692871
Epoch: 27, Steps: 64 | Train Loss: 0.1012552 Vali Loss: 0.1501776 Test Loss: 0.2253151
Validation loss decreased (0.150246 --> 0.150178).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 28 cost time: 0.9695661067962646
Epoch: 28, Steps: 64 | Train Loss: 0.1009018 Vali Loss: 0.1501232 Test Loss: 0.2257410
Validation loss decreased (0.150178 --> 0.150123).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 29 cost time: 0.9724080562591553
Epoch: 29, Steps: 64 | Train Loss: 0.1006404 Vali Loss: 0.1494472 Test Loss: 0.2250843
Validation loss decreased (0.150123 --> 0.149447).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 30 cost time: 0.978412389755249
Epoch: 30, Steps: 64 | Train Loss: 0.1006150 Vali Loss: 0.1502373 Test Loss: 0.2262579
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 31 cost time: 0.967768669128418
Epoch: 31, Steps: 64 | Train Loss: 0.1008251 Vali Loss: 0.1503230 Test Loss: 0.2269825
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 32 cost time: 0.9717309474945068
Epoch: 32, Steps: 64 | Train Loss: 0.1003205 Vali Loss: 0.1498643 Test Loss: 0.2267855
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 33 cost time: 0.984999418258667
Epoch: 33, Steps: 64 | Train Loss: 0.1000506 Vali Loss: 0.1497120 Test Loss: 0.2262105
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 34 cost time: 0.9696097373962402
Epoch: 34, Steps: 64 | Train Loss: 0.1001062 Vali Loss: 0.1498545 Test Loss: 0.2277196
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 35 cost time: 0.9643547534942627
Epoch: 35, Steps: 64 | Train Loss: 0.1001256 Vali Loss: 0.1504197 Test Loss: 0.2274724
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 36 cost time: 0.9794373512268066
Epoch: 36, Steps: 64 | Train Loss: 0.1001099 Vali Loss: 0.1486358 Test Loss: 0.2265016
Validation loss decreased (0.149447 --> 0.148636).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 37 cost time: 0.9709429740905762
Epoch: 37, Steps: 64 | Train Loss: 0.0998455 Vali Loss: 0.1498656 Test Loss: 0.2275453
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 38 cost time: 0.9723813533782959
Epoch: 38, Steps: 64 | Train Loss: 0.1004818 Vali Loss: 0.1489923 Test Loss: 0.2269418
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 39 cost time: 0.9704082012176514
Epoch: 39, Steps: 64 | Train Loss: 0.0997121 Vali Loss: 0.1486910 Test Loss: 0.2267210
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 40 cost time: 0.9390110969543457
Epoch: 40, Steps: 64 | Train Loss: 0.0998356 Vali Loss: 0.1477076 Test Loss: 0.2265452
Validation loss decreased (0.148636 --> 0.147708).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 41 cost time: 0.9613995552062988
Epoch: 41, Steps: 64 | Train Loss: 0.1001784 Vali Loss: 0.1492271 Test Loss: 0.2272532
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 42 cost time: 0.9639999866485596
Epoch: 42, Steps: 64 | Train Loss: 0.1000073 Vali Loss: 0.1502321 Test Loss: 0.2263704
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 43 cost time: 0.9550013542175293
Epoch: 43, Steps: 64 | Train Loss: 0.0998775 Vali Loss: 0.1495032 Test Loss: 0.2274489
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 44 cost time: 0.9706213474273682
Epoch: 44, Steps: 64 | Train Loss: 0.0993578 Vali Loss: 0.1497048 Test Loss: 0.2266733
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 45 cost time: 0.9703361988067627
Epoch: 45, Steps: 64 | Train Loss: 0.1000528 Vali Loss: 0.1467294 Test Loss: 0.2265231
Validation loss decreased (0.147708 --> 0.146729).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 46 cost time: 0.9784247875213623
Epoch: 46, Steps: 64 | Train Loss: 0.0994972 Vali Loss: 0.1481632 Test Loss: 0.2269583
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 47 cost time: 0.9489657878875732
Epoch: 47, Steps: 64 | Train Loss: 0.0998528 Vali Loss: 0.1473359 Test Loss: 0.2271867
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 48 cost time: 0.9883334636688232
Epoch: 48, Steps: 64 | Train Loss: 0.0996482 Vali Loss: 0.1476991 Test Loss: 0.2263502
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 49 cost time: 0.9917988777160645
Epoch: 49, Steps: 64 | Train Loss: 0.0996410 Vali Loss: 0.1482984 Test Loss: 0.2262650
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 50 cost time: 0.9858376979827881
Epoch: 50, Steps: 64 | Train Loss: 0.0996770 Vali Loss: 0.1465026 Test Loss: 0.2261141
Validation loss decreased (0.146729 --> 0.146503).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 51 cost time: 0.9657249450683594
Epoch: 51, Steps: 64 | Train Loss: 0.1001828 Vali Loss: 0.1479820 Test Loss: 0.2272185
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 52 cost time: 0.9738099575042725
Epoch: 52, Steps: 64 | Train Loss: 0.1001464 Vali Loss: 0.1483664 Test Loss: 0.2264038
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 53 cost time: 0.9833955764770508
Epoch: 53, Steps: 64 | Train Loss: 0.0995148 Vali Loss: 0.1469728 Test Loss: 0.2260998
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 54 cost time: 0.9706153869628906
Epoch: 54, Steps: 64 | Train Loss: 0.0995367 Vali Loss: 0.1485135 Test Loss: 0.2263712
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 55 cost time: 0.9706277847290039
Epoch: 55, Steps: 64 | Train Loss: 0.0994278 Vali Loss: 0.1482371 Test Loss: 0.2269345
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 56 cost time: 0.9843912124633789
Epoch: 56, Steps: 64 | Train Loss: 0.0999486 Vali Loss: 0.1472778 Test Loss: 0.2265265
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 57 cost time: 0.9683363437652588
Epoch: 57, Steps: 64 | Train Loss: 0.0996861 Vali Loss: 0.1483484 Test Loss: 0.2275909
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 58 cost time: 0.9673886299133301
Epoch: 58, Steps: 64 | Train Loss: 0.0998925 Vali Loss: 0.1488122 Test Loss: 0.2267214
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 59 cost time: 0.9714274406433105
Epoch: 59, Steps: 64 | Train Loss: 0.0999462 Vali Loss: 0.1469488 Test Loss: 0.2271726
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 60 cost time: 0.9653542041778564
Epoch: 60, Steps: 64 | Train Loss: 0.0993978 Vali Loss: 0.1478948 Test Loss: 0.2263339
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22611410915851593, mae:0.3296113610267639, rse:0.24098941683769226
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.057550907135009766 GB
Epoch: 1 cost time: 2.2799463272094727
Epoch: 1, Steps: 64 | Train Loss: 0.9944615 Vali Loss: 2.2447419 Test Loss: 3.6194615
Validation loss decreased (inf --> 2.244742).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 2 cost time: 0.8684637546539307
Epoch: 2, Steps: 64 | Train Loss: 0.4837481 Vali Loss: 0.2777391 Test Loss: 0.3465813
Validation loss decreased (2.244742 --> 0.277739).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 3 cost time: 0.857107400894165
Epoch: 3, Steps: 64 | Train Loss: 0.2063887 Vali Loss: 0.2044049 Test Loss: 0.2482523
Validation loss decreased (0.277739 --> 0.204405).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 4 cost time: 0.8652372360229492
Epoch: 4, Steps: 64 | Train Loss: 0.1753115 Vali Loss: 0.1875655 Test Loss: 0.2352893
Validation loss decreased (0.204405 --> 0.187565).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 5 cost time: 0.867387056350708
Epoch: 5, Steps: 64 | Train Loss: 0.1613849 Vali Loss: 0.1827251 Test Loss: 0.2305665
Validation loss decreased (0.187565 --> 0.182725).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 6 cost time: 0.8593542575836182
Epoch: 6, Steps: 64 | Train Loss: 0.1523095 Vali Loss: 0.1798509 Test Loss: 0.2251256
Validation loss decreased (0.182725 --> 0.179851).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 7 cost time: 0.8660001754760742
Epoch: 7, Steps: 64 | Train Loss: 0.1452674 Vali Loss: 0.1746577 Test Loss: 0.2224559
Validation loss decreased (0.179851 --> 0.174658).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 8 cost time: 0.8636159896850586
Epoch: 8, Steps: 64 | Train Loss: 0.1415406 Vali Loss: 0.1721475 Test Loss: 0.2213718
Validation loss decreased (0.174658 --> 0.172147).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 9 cost time: 0.8639698028564453
Epoch: 9, Steps: 64 | Train Loss: 0.1382720 Vali Loss: 0.1709134 Test Loss: 0.2208341
Validation loss decreased (0.172147 --> 0.170913).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 10 cost time: 0.876734733581543
Epoch: 10, Steps: 64 | Train Loss: 0.1355496 Vali Loss: 0.1717071 Test Loss: 0.2204636
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 11 cost time: 0.8689839839935303
Epoch: 11, Steps: 64 | Train Loss: 0.1337498 Vali Loss: 0.1657511 Test Loss: 0.2191366
Validation loss decreased (0.170913 --> 0.165751).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 12 cost time: 0.8637716770172119
Epoch: 12, Steps: 64 | Train Loss: 0.1317331 Vali Loss: 0.1661800 Test Loss: 0.2195546
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 13 cost time: 0.8630473613739014
Epoch: 13, Steps: 64 | Train Loss: 0.1304598 Vali Loss: 0.1676983 Test Loss: 0.2198334
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 14 cost time: 0.8876137733459473
Epoch: 14, Steps: 64 | Train Loss: 0.1289624 Vali Loss: 0.1643889 Test Loss: 0.2185067
Validation loss decreased (0.165751 --> 0.164389).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 15 cost time: 0.8690848350524902
Epoch: 15, Steps: 64 | Train Loss: 0.1285608 Vali Loss: 0.1655399 Test Loss: 0.2178702
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 16 cost time: 0.8613560199737549
Epoch: 16, Steps: 64 | Train Loss: 0.1274313 Vali Loss: 0.1632928 Test Loss: 0.2176820
Validation loss decreased (0.164389 --> 0.163293).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 17 cost time: 0.861375093460083
Epoch: 17, Steps: 64 | Train Loss: 0.1266542 Vali Loss: 0.1644199 Test Loss: 0.2176944
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 18 cost time: 0.874000072479248
Epoch: 18, Steps: 64 | Train Loss: 0.1256803 Vali Loss: 0.1629645 Test Loss: 0.2183696
Validation loss decreased (0.163293 --> 0.162964).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 19 cost time: 0.8586173057556152
Epoch: 19, Steps: 64 | Train Loss: 0.1255100 Vali Loss: 0.1641328 Test Loss: 0.2185676
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 20 cost time: 0.8703768253326416
Epoch: 20, Steps: 64 | Train Loss: 0.1246354 Vali Loss: 0.1621209 Test Loss: 0.2179300
Validation loss decreased (0.162964 --> 0.162121).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 21 cost time: 0.8673427104949951
Epoch: 21, Steps: 64 | Train Loss: 0.1244214 Vali Loss: 0.1632516 Test Loss: 0.2182524
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 22 cost time: 0.9464459419250488
Epoch: 22, Steps: 64 | Train Loss: 0.1234573 Vali Loss: 0.1605513 Test Loss: 0.2179121
Validation loss decreased (0.162121 --> 0.160551).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 23 cost time: 0.8657317161560059
Epoch: 23, Steps: 64 | Train Loss: 0.1227886 Vali Loss: 0.1625036 Test Loss: 0.2176130
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 24 cost time: 0.8664529323577881
Epoch: 24, Steps: 64 | Train Loss: 0.1222700 Vali Loss: 0.1619430 Test Loss: 0.2174278
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 25 cost time: 0.8476307392120361
Epoch: 25, Steps: 64 | Train Loss: 0.1228973 Vali Loss: 0.1618154 Test Loss: 0.2178992
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 26 cost time: 0.8593552112579346
Epoch: 26, Steps: 64 | Train Loss: 0.1220232 Vali Loss: 0.1613291 Test Loss: 0.2166716
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 27 cost time: 0.8633475303649902
Epoch: 27, Steps: 64 | Train Loss: 0.1209782 Vali Loss: 0.1609947 Test Loss: 0.2170418
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 28 cost time: 0.8587489128112793
Epoch: 28, Steps: 64 | Train Loss: 0.1214966 Vali Loss: 0.1602134 Test Loss: 0.2175499
Validation loss decreased (0.160551 --> 0.160213).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 29 cost time: 0.8673923015594482
Epoch: 29, Steps: 64 | Train Loss: 0.1212417 Vali Loss: 0.1613685 Test Loss: 0.2168881
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 30 cost time: 0.8606276512145996
Epoch: 30, Steps: 64 | Train Loss: 0.1214350 Vali Loss: 0.1609490 Test Loss: 0.2181413
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 31 cost time: 0.8644318580627441
Epoch: 31, Steps: 64 | Train Loss: 0.1214692 Vali Loss: 0.1612279 Test Loss: 0.2175847
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 32 cost time: 0.868356466293335
Epoch: 32, Steps: 64 | Train Loss: 0.1208936 Vali Loss: 0.1605491 Test Loss: 0.2174468
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 33 cost time: 0.8617522716522217
Epoch: 33, Steps: 64 | Train Loss: 0.1203933 Vali Loss: 0.1606672 Test Loss: 0.2175773
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 34 cost time: 0.8610000610351562
Epoch: 34, Steps: 64 | Train Loss: 0.1204154 Vali Loss: 0.1605702 Test Loss: 0.2172301
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 35 cost time: 0.863610029220581
Epoch: 35, Steps: 64 | Train Loss: 0.1206932 Vali Loss: 0.1606252 Test Loss: 0.2177343
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 36 cost time: 0.8703789710998535
Epoch: 36, Steps: 64 | Train Loss: 0.1200090 Vali Loss: 0.1593888 Test Loss: 0.2171193
Validation loss decreased (0.160213 --> 0.159389).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 37 cost time: 0.8624532222747803
Epoch: 37, Steps: 64 | Train Loss: 0.1203623 Vali Loss: 0.1595019 Test Loss: 0.2173432
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 38 cost time: 0.8640050888061523
Epoch: 38, Steps: 64 | Train Loss: 0.1195016 Vali Loss: 0.1614395 Test Loss: 0.2176706
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 39 cost time: 0.8599998950958252
Epoch: 39, Steps: 64 | Train Loss: 0.1199206 Vali Loss: 0.1616911 Test Loss: 0.2168563
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 40 cost time: 0.8829991817474365
Epoch: 40, Steps: 64 | Train Loss: 0.1198529 Vali Loss: 0.1609820 Test Loss: 0.2179843
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 41 cost time: 0.872347354888916
Epoch: 41, Steps: 64 | Train Loss: 0.1193585 Vali Loss: 0.1608989 Test Loss: 0.2163689
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 42 cost time: 0.8609755039215088
Epoch: 42, Steps: 64 | Train Loss: 0.1198251 Vali Loss: 0.1616275 Test Loss: 0.2170417
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 43 cost time: 0.8644058704376221
Epoch: 43, Steps: 64 | Train Loss: 0.1195619 Vali Loss: 0.1590218 Test Loss: 0.2166711
Validation loss decreased (0.159389 --> 0.159022).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 44 cost time: 0.860724925994873
Epoch: 44, Steps: 64 | Train Loss: 0.1192247 Vali Loss: 0.1594998 Test Loss: 0.2166405
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 45 cost time: 0.862999677658081
Epoch: 45, Steps: 64 | Train Loss: 0.1196626 Vali Loss: 0.1619497 Test Loss: 0.2174537
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 46 cost time: 0.8616163730621338
Epoch: 46, Steps: 64 | Train Loss: 0.1197542 Vali Loss: 0.1614775 Test Loss: 0.2177627
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 47 cost time: 0.8630321025848389
Epoch: 47, Steps: 64 | Train Loss: 0.1198258 Vali Loss: 0.1597907 Test Loss: 0.2168168
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 48 cost time: 0.8663666248321533
Epoch: 48, Steps: 64 | Train Loss: 0.1194537 Vali Loss: 0.1601806 Test Loss: 0.2168661
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 49 cost time: 0.861762285232544
Epoch: 49, Steps: 64 | Train Loss: 0.1198713 Vali Loss: 0.1601882 Test Loss: 0.2174555
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 50 cost time: 0.8680000305175781
Epoch: 50, Steps: 64 | Train Loss: 0.1192600 Vali Loss: 0.1610525 Test Loss: 0.2179952
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 51 cost time: 0.85862135887146
Epoch: 51, Steps: 64 | Train Loss: 0.1190200 Vali Loss: 0.1602445 Test Loss: 0.2170735
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 52 cost time: 0.9446060657501221
Epoch: 52, Steps: 64 | Train Loss: 0.1193469 Vali Loss: 0.1601084 Test Loss: 0.2171137
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 53 cost time: 0.9483859539031982
Epoch: 53, Steps: 64 | Train Loss: 0.1190462 Vali Loss: 0.1592985 Test Loss: 0.2172584
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 54 cost time: 0.9570522308349609
Epoch: 54, Steps: 64 | Train Loss: 0.1190388 Vali Loss: 0.1605825 Test Loss: 0.2175799
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 55 cost time: 0.8517825603485107
Epoch: 55, Steps: 64 | Train Loss: 0.1188920 Vali Loss: 0.1594547 Test Loss: 0.2169553
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 56 cost time: 0.8634231090545654
Epoch: 56, Steps: 64 | Train Loss: 0.1191232 Vali Loss: 0.1617367 Test Loss: 0.2176617
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 57 cost time: 0.865617036819458
Epoch: 57, Steps: 64 | Train Loss: 0.1191139 Vali Loss: 0.1603452 Test Loss: 0.2168366
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 58 cost time: 0.8783740997314453
Epoch: 58, Steps: 64 | Train Loss: 0.1192016 Vali Loss: 0.1593902 Test Loss: 0.2169342
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 59 cost time: 0.8663845062255859
Epoch: 59, Steps: 64 | Train Loss: 0.1189064 Vali Loss: 0.1605699 Test Loss: 0.2172924
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 60 cost time: 0.8683419227600098
Epoch: 60, Steps: 64 | Train Loss: 0.1190589 Vali Loss: 0.1611288 Test Loss: 0.2174290
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.21667110919952393, mae:0.31934303045272827, rse:0.23590363562107086
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.05898284912109375 GB
Epoch: 1 cost time: 2.3839075565338135
Epoch: 1, Steps: 64 | Train Loss: 1.0729079 Vali Loss: 2.7370319 Test Loss: 4.3677559
Validation loss decreased (inf --> 2.737032).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 2 cost time: 0.9412593841552734
Epoch: 2, Steps: 64 | Train Loss: 0.5720143 Vali Loss: 0.5494422 Test Loss: 0.7127267
Validation loss decreased (2.737032 --> 0.549442).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 3 cost time: 0.9574143886566162
Epoch: 3, Steps: 64 | Train Loss: 0.1983409 Vali Loss: 0.2377481 Test Loss: 0.2717623
Validation loss decreased (0.549442 --> 0.237748).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 4 cost time: 0.958632230758667
Epoch: 4, Steps: 64 | Train Loss: 0.1425362 Vali Loss: 0.1843629 Test Loss: 0.2308967
Validation loss decreased (0.237748 --> 0.184363).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 5 cost time: 0.9533596038818359
Epoch: 5, Steps: 64 | Train Loss: 0.1323260 Vali Loss: 0.1765685 Test Loss: 0.2227555
Validation loss decreased (0.184363 --> 0.176568).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 6 cost time: 0.9522368907928467
Epoch: 6, Steps: 64 | Train Loss: 0.1271277 Vali Loss: 0.1702073 Test Loss: 0.2211986
Validation loss decreased (0.176568 --> 0.170207).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 7 cost time: 0.9533345699310303
Epoch: 7, Steps: 64 | Train Loss: 0.1233625 Vali Loss: 0.1669372 Test Loss: 0.2197929
Validation loss decreased (0.170207 --> 0.166937).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 8 cost time: 0.9553639888763428
Epoch: 8, Steps: 64 | Train Loss: 0.1207493 Vali Loss: 0.1651014 Test Loss: 0.2189049
Validation loss decreased (0.166937 --> 0.165101).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 9 cost time: 0.9542996883392334
Epoch: 9, Steps: 64 | Train Loss: 0.1185558 Vali Loss: 0.1624932 Test Loss: 0.2182543
Validation loss decreased (0.165101 --> 0.162493).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 10 cost time: 0.9613094329833984
Epoch: 10, Steps: 64 | Train Loss: 0.1166514 Vali Loss: 0.1600164 Test Loss: 0.2189972
Validation loss decreased (0.162493 --> 0.160016).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 11 cost time: 0.9557492733001709
Epoch: 11, Steps: 64 | Train Loss: 0.1148908 Vali Loss: 0.1597575 Test Loss: 0.2165057
Validation loss decreased (0.160016 --> 0.159757).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 12 cost time: 0.9597568511962891
Epoch: 12, Steps: 64 | Train Loss: 0.1140178 Vali Loss: 0.1591434 Test Loss: 0.2192034
Validation loss decreased (0.159757 --> 0.159143).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 13 cost time: 0.9607436656951904
Epoch: 13, Steps: 64 | Train Loss: 0.1128415 Vali Loss: 0.1598899 Test Loss: 0.2182263
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 14 cost time: 0.9546115398406982
Epoch: 14, Steps: 64 | Train Loss: 0.1125522 Vali Loss: 0.1571329 Test Loss: 0.2181442
Validation loss decreased (0.159143 --> 0.157133).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 15 cost time: 0.9643795490264893
Epoch: 15, Steps: 64 | Train Loss: 0.1112414 Vali Loss: 0.1582792 Test Loss: 0.2185153
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 16 cost time: 0.9565670490264893
Epoch: 16, Steps: 64 | Train Loss: 0.1109106 Vali Loss: 0.1567351 Test Loss: 0.2182667
Validation loss decreased (0.157133 --> 0.156735).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 17 cost time: 0.9453945159912109
Epoch: 17, Steps: 64 | Train Loss: 0.1105464 Vali Loss: 0.1557516 Test Loss: 0.2184199
Validation loss decreased (0.156735 --> 0.155752).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 18 cost time: 0.964996337890625
Epoch: 18, Steps: 64 | Train Loss: 0.1094270 Vali Loss: 0.1555793 Test Loss: 0.2189409
Validation loss decreased (0.155752 --> 0.155579).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 19 cost time: 0.9633474349975586
Epoch: 19, Steps: 64 | Train Loss: 0.1093396 Vali Loss: 0.1561640 Test Loss: 0.2187704
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 20 cost time: 0.9604132175445557
Epoch: 20, Steps: 64 | Train Loss: 0.1093265 Vali Loss: 0.1542441 Test Loss: 0.2197557
Validation loss decreased (0.155579 --> 0.154244).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 21 cost time: 0.9587206840515137
Epoch: 21, Steps: 64 | Train Loss: 0.1086310 Vali Loss: 0.1566756 Test Loss: 0.2193448
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 22 cost time: 0.9538207054138184
Epoch: 22, Steps: 64 | Train Loss: 0.1081956 Vali Loss: 0.1543295 Test Loss: 0.2188192
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 23 cost time: 0.9456207752227783
Epoch: 23, Steps: 64 | Train Loss: 0.1077018 Vali Loss: 0.1546309 Test Loss: 0.2189660
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 24 cost time: 0.9456233978271484
Epoch: 24, Steps: 64 | Train Loss: 0.1075864 Vali Loss: 0.1545558 Test Loss: 0.2191401
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 25 cost time: 0.9463307857513428
Epoch: 25, Steps: 64 | Train Loss: 0.1073710 Vali Loss: 0.1537892 Test Loss: 0.2182329
Validation loss decreased (0.154244 --> 0.153789).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 26 cost time: 1.0053505897521973
Epoch: 26, Steps: 64 | Train Loss: 0.1068646 Vali Loss: 0.1528270 Test Loss: 0.2190487
Validation loss decreased (0.153789 --> 0.152827).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 27 cost time: 0.9534018039703369
Epoch: 27, Steps: 64 | Train Loss: 0.1070161 Vali Loss: 0.1531915 Test Loss: 0.2206599
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 28 cost time: 0.9653708934783936
Epoch: 28, Steps: 64 | Train Loss: 0.1068792 Vali Loss: 0.1532834 Test Loss: 0.2197899
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 29 cost time: 0.9624111652374268
Epoch: 29, Steps: 64 | Train Loss: 0.1065881 Vali Loss: 0.1526055 Test Loss: 0.2201190
Validation loss decreased (0.152827 --> 0.152605).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 30 cost time: 0.9646914005279541
Epoch: 30, Steps: 64 | Train Loss: 0.1066866 Vali Loss: 0.1514941 Test Loss: 0.2198117
Validation loss decreased (0.152605 --> 0.151494).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 31 cost time: 0.9637234210968018
Epoch: 31, Steps: 64 | Train Loss: 0.1065904 Vali Loss: 0.1524869 Test Loss: 0.2198660
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 32 cost time: 0.953953742980957
Epoch: 32, Steps: 64 | Train Loss: 0.1061332 Vali Loss: 0.1523585 Test Loss: 0.2194229
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 33 cost time: 0.9526243209838867
Epoch: 33, Steps: 64 | Train Loss: 0.1064097 Vali Loss: 0.1519911 Test Loss: 0.2196167
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 34 cost time: 0.9539628028869629
Epoch: 34, Steps: 64 | Train Loss: 0.1059131 Vali Loss: 0.1522111 Test Loss: 0.2191671
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 35 cost time: 0.9743454456329346
Epoch: 35, Steps: 64 | Train Loss: 0.1059199 Vali Loss: 0.1524122 Test Loss: 0.2193521
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 36 cost time: 0.9594054222106934
Epoch: 36, Steps: 64 | Train Loss: 0.1062021 Vali Loss: 0.1524540 Test Loss: 0.2196637
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 37 cost time: 0.9633805751800537
Epoch: 37, Steps: 64 | Train Loss: 0.1058355 Vali Loss: 0.1520548 Test Loss: 0.2192621
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 38 cost time: 0.9683713912963867
Epoch: 38, Steps: 64 | Train Loss: 0.1059216 Vali Loss: 0.1506048 Test Loss: 0.2198870
Validation loss decreased (0.151494 --> 0.150605).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 39 cost time: 0.9563877582550049
Epoch: 39, Steps: 64 | Train Loss: 0.1058389 Vali Loss: 0.1516884 Test Loss: 0.2195106
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 40 cost time: 0.9507827758789062
Epoch: 40, Steps: 64 | Train Loss: 0.1059826 Vali Loss: 0.1519636 Test Loss: 0.2195777
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 41 cost time: 0.9509999752044678
Epoch: 41, Steps: 64 | Train Loss: 0.1055982 Vali Loss: 0.1518096 Test Loss: 0.2188519
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 42 cost time: 0.9533834457397461
Epoch: 42, Steps: 64 | Train Loss: 0.1055326 Vali Loss: 0.1535706 Test Loss: 0.2204285
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 43 cost time: 0.9526219367980957
Epoch: 43, Steps: 64 | Train Loss: 0.1055949 Vali Loss: 0.1518079 Test Loss: 0.2198082
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 44 cost time: 0.9543864727020264
Epoch: 44, Steps: 64 | Train Loss: 0.1056010 Vali Loss: 0.1512914 Test Loss: 0.2201118
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 45 cost time: 0.950070858001709
Epoch: 45, Steps: 64 | Train Loss: 0.1055358 Vali Loss: 0.1512283 Test Loss: 0.2188472
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 46 cost time: 0.957134485244751
Epoch: 46, Steps: 64 | Train Loss: 0.1049876 Vali Loss: 0.1514606 Test Loss: 0.2197563
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 47 cost time: 0.9604282379150391
Epoch: 47, Steps: 64 | Train Loss: 0.1057733 Vali Loss: 0.1503390 Test Loss: 0.2194626
Validation loss decreased (0.150605 --> 0.150339).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 48 cost time: 0.9573774337768555
Epoch: 48, Steps: 64 | Train Loss: 0.1053048 Vali Loss: 0.1522502 Test Loss: 0.2196930
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 49 cost time: 0.9197173118591309
Epoch: 49, Steps: 64 | Train Loss: 0.1053817 Vali Loss: 0.1497657 Test Loss: 0.2192674
Validation loss decreased (0.150339 --> 0.149766).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 50 cost time: 0.956279993057251
Epoch: 50, Steps: 64 | Train Loss: 0.1053020 Vali Loss: 0.1524111 Test Loss: 0.2190155
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 51 cost time: 0.958442211151123
Epoch: 51, Steps: 64 | Train Loss: 0.1054313 Vali Loss: 0.1504447 Test Loss: 0.2210263
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 52 cost time: 0.9696199893951416
Epoch: 52, Steps: 64 | Train Loss: 0.1053970 Vali Loss: 0.1505528 Test Loss: 0.2195216
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 53 cost time: 0.961451530456543
Epoch: 53, Steps: 64 | Train Loss: 0.1057841 Vali Loss: 0.1515199 Test Loss: 0.2188687
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 54 cost time: 0.9563648700714111
Epoch: 54, Steps: 64 | Train Loss: 0.1052690 Vali Loss: 0.1513093 Test Loss: 0.2191842
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 55 cost time: 0.9744207859039307
Epoch: 55, Steps: 64 | Train Loss: 0.1052844 Vali Loss: 0.1509457 Test Loss: 0.2197671
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 56 cost time: 0.9624099731445312
Epoch: 56, Steps: 64 | Train Loss: 0.1054789 Vali Loss: 0.1514216 Test Loss: 0.2196380
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 57 cost time: 0.9543697834014893
Epoch: 57, Steps: 64 | Train Loss: 0.1051441 Vali Loss: 0.1515659 Test Loss: 0.2197532
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 58 cost time: 0.9637985229492188
Epoch: 58, Steps: 64 | Train Loss: 0.1050922 Vali Loss: 0.1524454 Test Loss: 0.2200240
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 59 cost time: 0.956362247467041
Epoch: 59, Steps: 64 | Train Loss: 0.1056131 Vali Loss: 0.1502038 Test Loss: 0.2205714
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 60 cost time: 0.9570000171661377
Epoch: 60, Steps: 64 | Train Loss: 0.1051418 Vali Loss: 0.1499644 Test Loss: 0.2201267
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.21926742792129517, mae:0.3191973567008972, rse:0.23731280863285065
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.06010293960571289 GB
Epoch: 1 cost time: 2.3136954307556152
Epoch: 1, Steps: 64 | Train Loss: 0.8436849 Vali Loss: 2.2472420 Test Loss: 3.5832303
Validation loss decreased (inf --> 2.247242).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 2 cost time: 0.8994500637054443
Epoch: 2, Steps: 64 | Train Loss: 0.5010515 Vali Loss: 0.3934096 Test Loss: 0.5080692
Validation loss decreased (2.247242 --> 0.393410).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 3 cost time: 1.0024113655090332
Epoch: 3, Steps: 64 | Train Loss: 0.1547940 Vali Loss: 0.1737573 Test Loss: 0.2262377
Validation loss decreased (0.393410 --> 0.173757).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 4 cost time: 0.9891207218170166
Epoch: 4, Steps: 64 | Train Loss: 0.1263136 Vali Loss: 0.1772894 Test Loss: 0.2282792
EarlyStopping counter: 1 out of 100
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 5 cost time: 0.9089736938476562
Epoch: 5, Steps: 64 | Train Loss: 0.1199704 Vali Loss: 0.1652968 Test Loss: 0.2194614
Validation loss decreased (0.173757 --> 0.165297).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 6 cost time: 0.93133544921875
Epoch: 6, Steps: 64 | Train Loss: 0.1167149 Vali Loss: 0.1636493 Test Loss: 0.2211495
Validation loss decreased (0.165297 --> 0.163649).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 7 cost time: 0.9363434314727783
Epoch: 7, Steps: 64 | Train Loss: 0.1135036 Vali Loss: 0.1643072 Test Loss: 0.2192064
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 8 cost time: 0.9337553977966309
Epoch: 8, Steps: 64 | Train Loss: 0.1119762 Vali Loss: 0.1608202 Test Loss: 0.2187779
Validation loss decreased (0.163649 --> 0.160820).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 9 cost time: 0.9008266925811768
Epoch: 9, Steps: 64 | Train Loss: 0.1100719 Vali Loss: 0.1604909 Test Loss: 0.2190019
Validation loss decreased (0.160820 --> 0.160491).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 10 cost time: 0.9206273555755615
Epoch: 10, Steps: 64 | Train Loss: 0.1097972 Vali Loss: 0.1589275 Test Loss: 0.2192900
Validation loss decreased (0.160491 --> 0.158927).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 11 cost time: 0.9153501987457275
Epoch: 11, Steps: 64 | Train Loss: 0.1080915 Vali Loss: 0.1589656 Test Loss: 0.2208799
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 12 cost time: 0.9283721446990967
Epoch: 12, Steps: 64 | Train Loss: 0.1073629 Vali Loss: 0.1566313 Test Loss: 0.2203476
Validation loss decreased (0.158927 --> 0.156631).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 13 cost time: 0.9170231819152832
Epoch: 13, Steps: 64 | Train Loss: 0.1068120 Vali Loss: 0.1558879 Test Loss: 0.2210031
Validation loss decreased (0.156631 --> 0.155888).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 14 cost time: 0.9273748397827148
Epoch: 14, Steps: 64 | Train Loss: 0.1059963 Vali Loss: 0.1556971 Test Loss: 0.2214243
Validation loss decreased (0.155888 --> 0.155697).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 15 cost time: 0.9177758693695068
Epoch: 15, Steps: 64 | Train Loss: 0.1049165 Vali Loss: 0.1537788 Test Loss: 0.2209231
Validation loss decreased (0.155697 --> 0.153779).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 16 cost time: 0.9110000133514404
Epoch: 16, Steps: 64 | Train Loss: 0.1048422 Vali Loss: 0.1540937 Test Loss: 0.2209345
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 17 cost time: 0.9099974632263184
Epoch: 17, Steps: 64 | Train Loss: 0.1044297 Vali Loss: 0.1531625 Test Loss: 0.2216816
Validation loss decreased (0.153779 --> 0.153162).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 18 cost time: 0.9103333950042725
Epoch: 18, Steps: 64 | Train Loss: 0.1040967 Vali Loss: 0.1508023 Test Loss: 0.2213893
Validation loss decreased (0.153162 --> 0.150802).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 19 cost time: 0.9254224300384521
Epoch: 19, Steps: 64 | Train Loss: 0.1040940 Vali Loss: 0.1534596 Test Loss: 0.2222326
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 20 cost time: 0.919417142868042
Epoch: 20, Steps: 64 | Train Loss: 0.1038541 Vali Loss: 0.1516279 Test Loss: 0.2224567
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 21 cost time: 0.9133892059326172
Epoch: 21, Steps: 64 | Train Loss: 0.1032415 Vali Loss: 0.1525146 Test Loss: 0.2221806
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 22 cost time: 0.9267065525054932
Epoch: 22, Steps: 64 | Train Loss: 0.1029195 Vali Loss: 0.1505117 Test Loss: 0.2209325
Validation loss decreased (0.150802 --> 0.150512).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 23 cost time: 0.9150002002716064
Epoch: 23, Steps: 64 | Train Loss: 0.1026395 Vali Loss: 0.1508016 Test Loss: 0.2231883
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 24 cost time: 0.9046292304992676
Epoch: 24, Steps: 64 | Train Loss: 0.1026350 Vali Loss: 0.1514113 Test Loss: 0.2221641
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 25 cost time: 0.9073317050933838
Epoch: 25, Steps: 64 | Train Loss: 0.1020783 Vali Loss: 0.1524273 Test Loss: 0.2232966
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 26 cost time: 0.9103744029998779
Epoch: 26, Steps: 64 | Train Loss: 0.1019398 Vali Loss: 0.1493953 Test Loss: 0.2223850
Validation loss decreased (0.150512 --> 0.149395).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 27 cost time: 0.9053795337677002
Epoch: 27, Steps: 64 | Train Loss: 0.1018423 Vali Loss: 0.1487525 Test Loss: 0.2220430
Validation loss decreased (0.149395 --> 0.148752).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 28 cost time: 0.9173848628997803
Epoch: 28, Steps: 64 | Train Loss: 0.1015031 Vali Loss: 0.1502803 Test Loss: 0.2227110
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 29 cost time: 0.9248757362365723
Epoch: 29, Steps: 64 | Train Loss: 0.1012597 Vali Loss: 0.1495298 Test Loss: 0.2224021
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 30 cost time: 0.9133486747741699
Epoch: 30, Steps: 64 | Train Loss: 0.1014166 Vali Loss: 0.1498270 Test Loss: 0.2219835
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 31 cost time: 0.9156138896942139
Epoch: 31, Steps: 64 | Train Loss: 0.1015820 Vali Loss: 0.1482454 Test Loss: 0.2232846
Validation loss decreased (0.148752 --> 0.148245).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 32 cost time: 0.9123451709747314
Epoch: 32, Steps: 64 | Train Loss: 0.1015184 Vali Loss: 0.1500710 Test Loss: 0.2230228
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 33 cost time: 0.9254114627838135
Epoch: 33, Steps: 64 | Train Loss: 0.1012527 Vali Loss: 0.1492660 Test Loss: 0.2232072
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 34 cost time: 0.9094266891479492
Epoch: 34, Steps: 64 | Train Loss: 0.1014655 Vali Loss: 0.1478357 Test Loss: 0.2223330
Validation loss decreased (0.148245 --> 0.147836).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 35 cost time: 0.9133810997009277
Epoch: 35, Steps: 64 | Train Loss: 0.1012465 Vali Loss: 0.1480348 Test Loss: 0.2223870
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 36 cost time: 0.9144141674041748
Epoch: 36, Steps: 64 | Train Loss: 0.1012098 Vali Loss: 0.1470258 Test Loss: 0.2217666
Validation loss decreased (0.147836 --> 0.147026).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 37 cost time: 0.9180002212524414
Epoch: 37, Steps: 64 | Train Loss: 0.1007755 Vali Loss: 0.1468431 Test Loss: 0.2224780
Validation loss decreased (0.147026 --> 0.146843).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 38 cost time: 0.9244730472564697
Epoch: 38, Steps: 64 | Train Loss: 0.1007677 Vali Loss: 0.1474075 Test Loss: 0.2225666
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 39 cost time: 0.9213900566101074
Epoch: 39, Steps: 64 | Train Loss: 0.1005515 Vali Loss: 0.1471348 Test Loss: 0.2227980
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 40 cost time: 0.937863826751709
Epoch: 40, Steps: 64 | Train Loss: 0.1012358 Vali Loss: 0.1480133 Test Loss: 0.2229758
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 41 cost time: 0.9163913726806641
Epoch: 41, Steps: 64 | Train Loss: 0.1011138 Vali Loss: 0.1467007 Test Loss: 0.2224841
Validation loss decreased (0.146843 --> 0.146701).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 42 cost time: 0.9144394397735596
Epoch: 42, Steps: 64 | Train Loss: 0.1006599 Vali Loss: 0.1486859 Test Loss: 0.2228043
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 43 cost time: 0.927480936050415
Epoch: 43, Steps: 64 | Train Loss: 0.1008370 Vali Loss: 0.1489771 Test Loss: 0.2232670
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 44 cost time: 0.8809998035430908
Epoch: 44, Steps: 64 | Train Loss: 0.1008600 Vali Loss: 0.1455869 Test Loss: 0.2234039
Validation loss decreased (0.146701 --> 0.145587).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 45 cost time: 0.9196255207061768
Epoch: 45, Steps: 64 | Train Loss: 0.1007767 Vali Loss: 0.1465314 Test Loss: 0.2226139
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 46 cost time: 0.9163806438446045
Epoch: 46, Steps: 64 | Train Loss: 0.1005657 Vali Loss: 0.1475098 Test Loss: 0.2227567
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 47 cost time: 0.9273629188537598
Epoch: 47, Steps: 64 | Train Loss: 0.1009030 Vali Loss: 0.1470768 Test Loss: 0.2227059
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 48 cost time: 0.9143574237823486
Epoch: 48, Steps: 64 | Train Loss: 0.1008557 Vali Loss: 0.1484788 Test Loss: 0.2241368
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 49 cost time: 0.9013793468475342
Epoch: 49, Steps: 64 | Train Loss: 0.1005108 Vali Loss: 0.1488699 Test Loss: 0.2235146
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 50 cost time: 0.8979997634887695
Epoch: 50, Steps: 64 | Train Loss: 0.1011942 Vali Loss: 0.1458798 Test Loss: 0.2225851
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 51 cost time: 0.9007844924926758
Epoch: 51, Steps: 64 | Train Loss: 0.1007818 Vali Loss: 0.1468178 Test Loss: 0.2226047
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 52 cost time: 0.9146163463592529
Epoch: 52, Steps: 64 | Train Loss: 0.1008746 Vali Loss: 0.1464216 Test Loss: 0.2236108
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 53 cost time: 0.91400146484375
Epoch: 53, Steps: 64 | Train Loss: 0.1009862 Vali Loss: 0.1494198 Test Loss: 0.2230755
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 54 cost time: 0.9244050979614258
Epoch: 54, Steps: 64 | Train Loss: 0.1008028 Vali Loss: 0.1478536 Test Loss: 0.2231300
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 55 cost time: 0.9173619747161865
Epoch: 55, Steps: 64 | Train Loss: 0.1007142 Vali Loss: 0.1463379 Test Loss: 0.2229832
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 56 cost time: 0.9183497428894043
Epoch: 56, Steps: 64 | Train Loss: 0.1009785 Vali Loss: 0.1468041 Test Loss: 0.2230385
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 57 cost time: 0.9159998893737793
Epoch: 57, Steps: 64 | Train Loss: 0.1011889 Vali Loss: 0.1484018 Test Loss: 0.2230313
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 58 cost time: 0.9256315231323242
Epoch: 58, Steps: 64 | Train Loss: 0.1003996 Vali Loss: 0.1498916 Test Loss: 0.2238359
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 59 cost time: 0.9176127910614014
Epoch: 59, Steps: 64 | Train Loss: 0.1005434 Vali Loss: 0.1486973 Test Loss: 0.2232707
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 60 cost time: 0.9173626899719238
Epoch: 60, Steps: 64 | Train Loss: 0.1006167 Vali Loss: 0.1486859 Test Loss: 0.2240643
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2234039455652237, mae:0.32315319776535034, rse:0.23954084515571594
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05771303176879883 GB
Epoch: 1 cost time: 2.2668967247009277
Epoch: 1, Steps: 64 | Train Loss: 1.2457975 Vali Loss: 2.9071279 Test Loss: 4.6188288
Validation loss decreased (inf --> 2.907128).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 2 cost time: 0.9304101467132568
Epoch: 2, Steps: 64 | Train Loss: 0.5995339 Vali Loss: 0.3938971 Test Loss: 0.5089322
Validation loss decreased (2.907128 --> 0.393897).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 3 cost time: 0.9338316917419434
Epoch: 3, Steps: 64 | Train Loss: 0.2323658 Vali Loss: 0.2546774 Test Loss: 0.2962112
Validation loss decreased (0.393897 --> 0.254677).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 4 cost time: 0.9330003261566162
Epoch: 4, Steps: 64 | Train Loss: 0.1818850 Vali Loss: 0.2129937 Test Loss: 0.2534827
Validation loss decreased (0.254677 --> 0.212994).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 5 cost time: 1.021343469619751
Epoch: 5, Steps: 64 | Train Loss: 0.1635957 Vali Loss: 0.1925528 Test Loss: 0.2362829
Validation loss decreased (0.212994 --> 0.192553).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 6 cost time: 0.9566078186035156
Epoch: 6, Steps: 64 | Train Loss: 0.1534871 Vali Loss: 0.1843900 Test Loss: 0.2285506
Validation loss decreased (0.192553 --> 0.184390).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 7 cost time: 0.9276156425476074
Epoch: 7, Steps: 64 | Train Loss: 0.1471324 Vali Loss: 0.1778526 Test Loss: 0.2245515
Validation loss decreased (0.184390 --> 0.177853).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 8 cost time: 0.929511547088623
Epoch: 8, Steps: 64 | Train Loss: 0.1433316 Vali Loss: 0.1755280 Test Loss: 0.2223429
Validation loss decreased (0.177853 --> 0.175528).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 9 cost time: 0.9303803443908691
Epoch: 9, Steps: 64 | Train Loss: 0.1391102 Vali Loss: 0.1700230 Test Loss: 0.2198965
Validation loss decreased (0.175528 --> 0.170023).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 10 cost time: 0.9333600997924805
Epoch: 10, Steps: 64 | Train Loss: 0.1365016 Vali Loss: 0.1703508 Test Loss: 0.2205702
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 11 cost time: 0.9414355754852295
Epoch: 11, Steps: 64 | Train Loss: 0.1345597 Vali Loss: 0.1683476 Test Loss: 0.2194722
Validation loss decreased (0.170023 --> 0.168348).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 12 cost time: 0.9337325096130371
Epoch: 12, Steps: 64 | Train Loss: 0.1331409 Vali Loss: 0.1681399 Test Loss: 0.2202908
Validation loss decreased (0.168348 --> 0.168140).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 13 cost time: 0.9323534965515137
Epoch: 13, Steps: 64 | Train Loss: 0.1309139 Vali Loss: 0.1667639 Test Loss: 0.2207327
Validation loss decreased (0.168140 --> 0.166764).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 14 cost time: 0.9340002536773682
Epoch: 14, Steps: 64 | Train Loss: 0.1299360 Vali Loss: 0.1681890 Test Loss: 0.2212922
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 15 cost time: 0.9356174468994141
Epoch: 15, Steps: 64 | Train Loss: 0.1286525 Vali Loss: 0.1664092 Test Loss: 0.2195443
Validation loss decreased (0.166764 --> 0.166409).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 16 cost time: 0.9323694705963135
Epoch: 16, Steps: 64 | Train Loss: 0.1280519 Vali Loss: 0.1648437 Test Loss: 0.2184001
Validation loss decreased (0.166409 --> 0.164844).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 17 cost time: 0.9312880039215088
Epoch: 17, Steps: 64 | Train Loss: 0.1265293 Vali Loss: 0.1636652 Test Loss: 0.2186947
Validation loss decreased (0.164844 --> 0.163665).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 18 cost time: 0.9437620639801025
Epoch: 18, Steps: 64 | Train Loss: 0.1256651 Vali Loss: 0.1628026 Test Loss: 0.2196323
Validation loss decreased (0.163665 --> 0.162803).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 19 cost time: 0.9333744049072266
Epoch: 19, Steps: 64 | Train Loss: 0.1263013 Vali Loss: 0.1632522 Test Loss: 0.2181592
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 20 cost time: 0.9352326393127441
Epoch: 20, Steps: 64 | Train Loss: 0.1245645 Vali Loss: 0.1629336 Test Loss: 0.2187844
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 21 cost time: 0.9467446804046631
Epoch: 21, Steps: 64 | Train Loss: 0.1241203 Vali Loss: 0.1616805 Test Loss: 0.2192700
Validation loss decreased (0.162803 --> 0.161680).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 22 cost time: 0.9296350479125977
Epoch: 22, Steps: 64 | Train Loss: 0.1234663 Vali Loss: 0.1615086 Test Loss: 0.2183461
Validation loss decreased (0.161680 --> 0.161509).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 23 cost time: 0.9267189502716064
Epoch: 23, Steps: 64 | Train Loss: 0.1229985 Vali Loss: 0.1620917 Test Loss: 0.2183404
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 24 cost time: 0.9283695220947266
Epoch: 24, Steps: 64 | Train Loss: 0.1233078 Vali Loss: 0.1603202 Test Loss: 0.2190326
Validation loss decreased (0.161509 --> 0.160320).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 25 cost time: 0.9265832901000977
Epoch: 25, Steps: 64 | Train Loss: 0.1230102 Vali Loss: 0.1607498 Test Loss: 0.2175135
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 26 cost time: 0.9250233173370361
Epoch: 26, Steps: 64 | Train Loss: 0.1219490 Vali Loss: 0.1600601 Test Loss: 0.2180230
Validation loss decreased (0.160320 --> 0.160060).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 27 cost time: 0.9278602600097656
Epoch: 27, Steps: 64 | Train Loss: 0.1218600 Vali Loss: 0.1598921 Test Loss: 0.2189776
Validation loss decreased (0.160060 --> 0.159892).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 28 cost time: 0.9327268600463867
Epoch: 28, Steps: 64 | Train Loss: 0.1217446 Vali Loss: 0.1604677 Test Loss: 0.2186248
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 29 cost time: 0.9199984073638916
Epoch: 29, Steps: 64 | Train Loss: 0.1218220 Vali Loss: 0.1605258 Test Loss: 0.2181935
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 30 cost time: 0.9303643703460693
Epoch: 30, Steps: 64 | Train Loss: 0.1214023 Vali Loss: 0.1596223 Test Loss: 0.2177098
Validation loss decreased (0.159892 --> 0.159622).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 31 cost time: 0.9306075572967529
Epoch: 31, Steps: 64 | Train Loss: 0.1206652 Vali Loss: 0.1584991 Test Loss: 0.2180312
Validation loss decreased (0.159622 --> 0.158499).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 32 cost time: 0.9294087886810303
Epoch: 32, Steps: 64 | Train Loss: 0.1207595 Vali Loss: 0.1600857 Test Loss: 0.2184798
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 33 cost time: 0.9243230819702148
Epoch: 33, Steps: 64 | Train Loss: 0.1207592 Vali Loss: 0.1619586 Test Loss: 0.2198060
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 34 cost time: 0.9264059066772461
Epoch: 34, Steps: 64 | Train Loss: 0.1203309 Vali Loss: 0.1579379 Test Loss: 0.2178554
Validation loss decreased (0.158499 --> 0.157938).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 35 cost time: 0.9373729228973389
Epoch: 35, Steps: 64 | Train Loss: 0.1207208 Vali Loss: 0.1596430 Test Loss: 0.2188719
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 36 cost time: 0.9318249225616455
Epoch: 36, Steps: 64 | Train Loss: 0.1198310 Vali Loss: 0.1598576 Test Loss: 0.2189494
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 37 cost time: 0.9310002326965332
Epoch: 37, Steps: 64 | Train Loss: 0.1193663 Vali Loss: 0.1604740 Test Loss: 0.2193165
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 38 cost time: 0.9337852001190186
Epoch: 38, Steps: 64 | Train Loss: 0.1206498 Vali Loss: 0.1596081 Test Loss: 0.2185514
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 39 cost time: 0.9386181831359863
Epoch: 39, Steps: 64 | Train Loss: 0.1202569 Vali Loss: 0.1589747 Test Loss: 0.2174017
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 40 cost time: 0.9270071983337402
Epoch: 40, Steps: 64 | Train Loss: 0.1204321 Vali Loss: 0.1574865 Test Loss: 0.2183240
Validation loss decreased (0.157938 --> 0.157486).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 41 cost time: 0.9313662052154541
Epoch: 41, Steps: 64 | Train Loss: 0.1199713 Vali Loss: 0.1600886 Test Loss: 0.2199013
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 42 cost time: 0.9323639869689941
Epoch: 42, Steps: 64 | Train Loss: 0.1202295 Vali Loss: 0.1591011 Test Loss: 0.2178280
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 43 cost time: 0.9260337352752686
Epoch: 43, Steps: 64 | Train Loss: 0.1197131 Vali Loss: 0.1596432 Test Loss: 0.2200692
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 44 cost time: 0.9277455806732178
Epoch: 44, Steps: 64 | Train Loss: 0.1201644 Vali Loss: 0.1580923 Test Loss: 0.2173583
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 45 cost time: 0.9400002956390381
Epoch: 45, Steps: 64 | Train Loss: 0.1194764 Vali Loss: 0.1569154 Test Loss: 0.2192228
Validation loss decreased (0.157486 --> 0.156915).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 46 cost time: 0.9329996109008789
Epoch: 46, Steps: 64 | Train Loss: 0.1195387 Vali Loss: 0.1576026 Test Loss: 0.2196763
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 47 cost time: 0.929232120513916
Epoch: 47, Steps: 64 | Train Loss: 0.1190087 Vali Loss: 0.1595079 Test Loss: 0.2177952
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 48 cost time: 0.9384031295776367
Epoch: 48, Steps: 64 | Train Loss: 0.1196462 Vali Loss: 0.1598783 Test Loss: 0.2194618
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 49 cost time: 0.925328254699707
Epoch: 49, Steps: 64 | Train Loss: 0.1195502 Vali Loss: 0.1589332 Test Loss: 0.2194339
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 50 cost time: 0.929344654083252
Epoch: 50, Steps: 64 | Train Loss: 0.1193748 Vali Loss: 0.1600094 Test Loss: 0.2184747
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 51 cost time: 0.9290087223052979
Epoch: 51, Steps: 64 | Train Loss: 0.1201213 Vali Loss: 0.1581630 Test Loss: 0.2183484
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 52 cost time: 0.9404315948486328
Epoch: 52, Steps: 64 | Train Loss: 0.1194061 Vali Loss: 0.1588636 Test Loss: 0.2193449
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 53 cost time: 0.936396598815918
Epoch: 53, Steps: 64 | Train Loss: 0.1194407 Vali Loss: 0.1600546 Test Loss: 0.2188724
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 54 cost time: 0.9316556453704834
Epoch: 54, Steps: 64 | Train Loss: 0.1205214 Vali Loss: 0.1585522 Test Loss: 0.2198920
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 55 cost time: 0.941716194152832
Epoch: 55, Steps: 64 | Train Loss: 0.1192051 Vali Loss: 0.1587566 Test Loss: 0.2193568
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 56 cost time: 0.9383776187896729
Epoch: 56, Steps: 64 | Train Loss: 0.1190714 Vali Loss: 0.1583907 Test Loss: 0.2186164
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 57 cost time: 0.9324021339416504
Epoch: 57, Steps: 64 | Train Loss: 0.1192793 Vali Loss: 0.1584387 Test Loss: 0.2182055
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 58 cost time: 0.9334163665771484
Epoch: 58, Steps: 64 | Train Loss: 0.1189323 Vali Loss: 0.1576218 Test Loss: 0.2196878
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 59 cost time: 0.9387009143829346
Epoch: 59, Steps: 64 | Train Loss: 0.1200978 Vali Loss: 0.1593563 Test Loss: 0.2200669
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 60 cost time: 0.9237146377563477
Epoch: 60, Steps: 64 | Train Loss: 0.1192143 Vali Loss: 0.1567188 Test Loss: 0.2196592
Validation loss decreased (0.156915 --> 0.156719).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2196592539548874, mae:0.31991875171661377, rse:0.23752476274967194
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.05914497375488281 GB
Epoch: 1 cost time: 2.3090286254882812
Epoch: 1, Steps: 64 | Train Loss: 0.8076009 Vali Loss: 1.9637041 Test Loss: 3.1218541
Validation loss decreased (inf --> 1.963704).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 2 cost time: 0.928159236907959
Epoch: 2, Steps: 64 | Train Loss: 0.3702395 Vali Loss: 0.2350405 Test Loss: 0.2660400
Validation loss decreased (1.963704 --> 0.235040).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 3 cost time: 0.9563159942626953
Epoch: 3, Steps: 64 | Train Loss: 0.1512407 Vali Loss: 0.1831249 Test Loss: 0.2245366
Validation loss decreased (0.235040 --> 0.183125).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 4 cost time: 0.9631261825561523
Epoch: 4, Steps: 64 | Train Loss: 0.1358800 Vali Loss: 0.1773813 Test Loss: 0.2196798
Validation loss decreased (0.183125 --> 0.177381).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 5 cost time: 0.9629900455474854
Epoch: 5, Steps: 64 | Train Loss: 0.1285931 Vali Loss: 0.1744136 Test Loss: 0.2184479
Validation loss decreased (0.177381 --> 0.174414).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 6 cost time: 0.9393675327301025
Epoch: 6, Steps: 64 | Train Loss: 0.1246444 Vali Loss: 0.1704210 Test Loss: 0.2180624
Validation loss decreased (0.174414 --> 0.170421).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 7 cost time: 0.9643094539642334
Epoch: 7, Steps: 64 | Train Loss: 0.1208543 Vali Loss: 0.1662615 Test Loss: 0.2166199
Validation loss decreased (0.170421 --> 0.166262).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 8 cost time: 0.9594619274139404
Epoch: 8, Steps: 64 | Train Loss: 0.1189073 Vali Loss: 0.1653535 Test Loss: 0.2163192
Validation loss decreased (0.166262 --> 0.165353).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 9 cost time: 0.9618246555328369
Epoch: 9, Steps: 64 | Train Loss: 0.1167457 Vali Loss: 0.1645482 Test Loss: 0.2159801
Validation loss decreased (0.165353 --> 0.164548).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 10 cost time: 0.9646086692810059
Epoch: 10, Steps: 64 | Train Loss: 0.1149139 Vali Loss: 0.1633222 Test Loss: 0.2162646
Validation loss decreased (0.164548 --> 0.163322).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 11 cost time: 0.9640004634857178
Epoch: 11, Steps: 64 | Train Loss: 0.1139310 Vali Loss: 0.1619360 Test Loss: 0.2168370
Validation loss decreased (0.163322 --> 0.161936).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 12 cost time: 0.9606218338012695
Epoch: 12, Steps: 64 | Train Loss: 0.1127241 Vali Loss: 0.1594101 Test Loss: 0.2160193
Validation loss decreased (0.161936 --> 0.159410).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 13 cost time: 0.9616241455078125
Epoch: 13, Steps: 64 | Train Loss: 0.1120023 Vali Loss: 0.1597610 Test Loss: 0.2169397
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 14 cost time: 0.9553754329681396
Epoch: 14, Steps: 64 | Train Loss: 0.1111680 Vali Loss: 0.1586344 Test Loss: 0.2179145
Validation loss decreased (0.159410 --> 0.158634).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 15 cost time: 0.9508991241455078
Epoch: 15, Steps: 64 | Train Loss: 0.1106364 Vali Loss: 0.1570387 Test Loss: 0.2181964
Validation loss decreased (0.158634 --> 0.157039).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 16 cost time: 0.9694674015045166
Epoch: 16, Steps: 64 | Train Loss: 0.1095584 Vali Loss: 0.1575022 Test Loss: 0.2169246
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 17 cost time: 0.9500062465667725
Epoch: 17, Steps: 64 | Train Loss: 0.1094235 Vali Loss: 0.1571115 Test Loss: 0.2161842
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 18 cost time: 0.9603354930877686
Epoch: 18, Steps: 64 | Train Loss: 0.1092986 Vali Loss: 0.1582013 Test Loss: 0.2171386
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 19 cost time: 0.9817230701446533
Epoch: 19, Steps: 64 | Train Loss: 0.1090379 Vali Loss: 0.1541230 Test Loss: 0.2172287
Validation loss decreased (0.157039 --> 0.154123).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 20 cost time: 1.0477466583251953
Epoch: 20, Steps: 64 | Train Loss: 0.1081498 Vali Loss: 0.1569367 Test Loss: 0.2174772
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 21 cost time: 1.0465431213378906
Epoch: 21, Steps: 64 | Train Loss: 0.1077439 Vali Loss: 0.1539040 Test Loss: 0.2168985
Validation loss decreased (0.154123 --> 0.153904).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 22 cost time: 1.0167388916015625
Epoch: 22, Steps: 64 | Train Loss: 0.1078693 Vali Loss: 0.1556324 Test Loss: 0.2172581
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 23 cost time: 0.9500026702880859
Epoch: 23, Steps: 64 | Train Loss: 0.1075070 Vali Loss: 0.1562993 Test Loss: 0.2175517
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 24 cost time: 0.95162034034729
Epoch: 24, Steps: 64 | Train Loss: 0.1067080 Vali Loss: 0.1543690 Test Loss: 0.2179783
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 25 cost time: 0.9526352882385254
Epoch: 25, Steps: 64 | Train Loss: 0.1071035 Vali Loss: 0.1558966 Test Loss: 0.2171133
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 26 cost time: 0.93039870262146
Epoch: 26, Steps: 64 | Train Loss: 0.1064796 Vali Loss: 0.1537847 Test Loss: 0.2182443
Validation loss decreased (0.153904 --> 0.153785).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 27 cost time: 0.9633450508117676
Epoch: 27, Steps: 64 | Train Loss: 0.1064667 Vali Loss: 0.1563374 Test Loss: 0.2172516
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 28 cost time: 0.9613656997680664
Epoch: 28, Steps: 64 | Train Loss: 0.1060127 Vali Loss: 0.1531245 Test Loss: 0.2182613
Validation loss decreased (0.153785 --> 0.153125).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 29 cost time: 0.9475305080413818
Epoch: 29, Steps: 64 | Train Loss: 0.1059655 Vali Loss: 0.1555799 Test Loss: 0.2181021
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 30 cost time: 0.96433424949646
Epoch: 30, Steps: 64 | Train Loss: 0.1060568 Vali Loss: 0.1538521 Test Loss: 0.2172761
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 31 cost time: 0.9597845077514648
Epoch: 31, Steps: 64 | Train Loss: 0.1058658 Vali Loss: 0.1549173 Test Loss: 0.2187919
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 32 cost time: 0.9679973125457764
Epoch: 32, Steps: 64 | Train Loss: 0.1056267 Vali Loss: 0.1537948 Test Loss: 0.2176373
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 33 cost time: 0.9604015350341797
Epoch: 33, Steps: 64 | Train Loss: 0.1054887 Vali Loss: 0.1551800 Test Loss: 0.2176389
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 34 cost time: 0.9616234302520752
Epoch: 34, Steps: 64 | Train Loss: 0.1058969 Vali Loss: 0.1551752 Test Loss: 0.2189666
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 35 cost time: 0.96138596534729
Epoch: 35, Steps: 64 | Train Loss: 0.1054663 Vali Loss: 0.1541904 Test Loss: 0.2183107
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 36 cost time: 0.9663612842559814
Epoch: 36, Steps: 64 | Train Loss: 0.1055411 Vali Loss: 0.1536749 Test Loss: 0.2181829
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 37 cost time: 0.9723818302154541
Epoch: 37, Steps: 64 | Train Loss: 0.1050433 Vali Loss: 0.1524775 Test Loss: 0.2174600
Validation loss decreased (0.153125 --> 0.152478).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 38 cost time: 0.9613730907440186
Epoch: 38, Steps: 64 | Train Loss: 0.1058084 Vali Loss: 0.1535633 Test Loss: 0.2179723
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 39 cost time: 0.9755213260650635
Epoch: 39, Steps: 64 | Train Loss: 0.1051608 Vali Loss: 0.1529286 Test Loss: 0.2181359
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 40 cost time: 0.9523675441741943
Epoch: 40, Steps: 64 | Train Loss: 0.1050151 Vali Loss: 0.1536410 Test Loss: 0.2184208
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 41 cost time: 0.951805830001831
Epoch: 41, Steps: 64 | Train Loss: 0.1053725 Vali Loss: 0.1540468 Test Loss: 0.2177215
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 42 cost time: 0.9636232852935791
Epoch: 42, Steps: 64 | Train Loss: 0.1049663 Vali Loss: 0.1524987 Test Loss: 0.2175143
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 43 cost time: 0.9556152820587158
Epoch: 43, Steps: 64 | Train Loss: 0.1047053 Vali Loss: 0.1518042 Test Loss: 0.2183216
Validation loss decreased (0.152478 --> 0.151804).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 44 cost time: 0.9606070518493652
Epoch: 44, Steps: 64 | Train Loss: 0.1052593 Vali Loss: 0.1534316 Test Loss: 0.2183358
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 45 cost time: 0.9624161720275879
Epoch: 45, Steps: 64 | Train Loss: 0.1051475 Vali Loss: 0.1522368 Test Loss: 0.2181811
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 46 cost time: 0.9371333122253418
Epoch: 46, Steps: 64 | Train Loss: 0.1051721 Vali Loss: 0.1528575 Test Loss: 0.2188678
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 47 cost time: 0.9613668918609619
Epoch: 47, Steps: 64 | Train Loss: 0.1048383 Vali Loss: 0.1522840 Test Loss: 0.2177714
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 48 cost time: 0.9604520797729492
Epoch: 48, Steps: 64 | Train Loss: 0.1045775 Vali Loss: 0.1535888 Test Loss: 0.2178160
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 49 cost time: 0.9584283828735352
Epoch: 49, Steps: 64 | Train Loss: 0.1050526 Vali Loss: 0.1517740 Test Loss: 0.2179027
Validation loss decreased (0.151804 --> 0.151774).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 50 cost time: 0.9532241821289062
Epoch: 50, Steps: 64 | Train Loss: 0.1050730 Vali Loss: 0.1524254 Test Loss: 0.2176443
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 51 cost time: 0.9574358463287354
Epoch: 51, Steps: 64 | Train Loss: 0.1046343 Vali Loss: 0.1528666 Test Loss: 0.2189042
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 52 cost time: 0.9730000495910645
Epoch: 52, Steps: 64 | Train Loss: 0.1051231 Vali Loss: 0.1526926 Test Loss: 0.2176418
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 53 cost time: 0.9576296806335449
Epoch: 53, Steps: 64 | Train Loss: 0.1046826 Vali Loss: 0.1533792 Test Loss: 0.2184129
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 54 cost time: 0.9677941799163818
Epoch: 54, Steps: 64 | Train Loss: 0.1051545 Vali Loss: 0.1511842 Test Loss: 0.2176495
Validation loss decreased (0.151774 --> 0.151184).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 55 cost time: 0.9633049964904785
Epoch: 55, Steps: 64 | Train Loss: 0.1048216 Vali Loss: 0.1531554 Test Loss: 0.2183222
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 56 cost time: 0.9593830108642578
Epoch: 56, Steps: 64 | Train Loss: 0.1054222 Vali Loss: 0.1544179 Test Loss: 0.2176968
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 57 cost time: 0.964346170425415
Epoch: 57, Steps: 64 | Train Loss: 0.1048627 Vali Loss: 0.1529590 Test Loss: 0.2178752
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 58 cost time: 0.9563090801239014
Epoch: 58, Steps: 64 | Train Loss: 0.1048936 Vali Loss: 0.1532191 Test Loss: 0.2186813
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 59 cost time: 0.941922664642334
Epoch: 59, Steps: 64 | Train Loss: 0.1050970 Vali Loss: 0.1517232 Test Loss: 0.2181181
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 60 cost time: 0.9539272785186768
Epoch: 60, Steps: 64 | Train Loss: 0.1045584 Vali Loss: 0.1529375 Test Loss: 0.2178420
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.21764947474002838, mae:0.3163401484489441, rse:0.2364356368780136
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06026506423950195 GB
Epoch: 1 cost time: 2.4071717262268066
Epoch: 1, Steps: 64 | Train Loss: 0.9292071 Vali Loss: 2.4624803 Test Loss: 3.9449565
Validation loss decreased (inf --> 2.462480).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 2 cost time: 0.994999885559082
Epoch: 2, Steps: 64 | Train Loss: 0.5252354 Vali Loss: 0.4297153 Test Loss: 0.5723610
Validation loss decreased (2.462480 --> 0.429715).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 3 cost time: 0.9919874668121338
Epoch: 3, Steps: 64 | Train Loss: 0.1651208 Vali Loss: 0.2055014 Test Loss: 0.2475313
Validation loss decreased (0.429715 --> 0.205501).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 4 cost time: 0.9876585006713867
Epoch: 4, Steps: 64 | Train Loss: 0.1309197 Vali Loss: 0.1838963 Test Loss: 0.2341013
Validation loss decreased (0.205501 --> 0.183896).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 5 cost time: 0.995624303817749
Epoch: 5, Steps: 64 | Train Loss: 0.1225581 Vali Loss: 0.1744824 Test Loss: 0.2237228
Validation loss decreased (0.183896 --> 0.174482).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 6 cost time: 0.9817047119140625
Epoch: 6, Steps: 64 | Train Loss: 0.1186311 Vali Loss: 0.1698010 Test Loss: 0.2209566
Validation loss decreased (0.174482 --> 0.169801).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 7 cost time: 0.9873664379119873
Epoch: 7, Steps: 64 | Train Loss: 0.1148352 Vali Loss: 0.1636924 Test Loss: 0.2186643
Validation loss decreased (0.169801 --> 0.163692).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 8 cost time: 0.9884629249572754
Epoch: 8, Steps: 64 | Train Loss: 0.1134133 Vali Loss: 0.1596045 Test Loss: 0.2178990
Validation loss decreased (0.163692 --> 0.159604).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 9 cost time: 0.9792499542236328
Epoch: 9, Steps: 64 | Train Loss: 0.1112103 Vali Loss: 0.1624686 Test Loss: 0.2183869
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 10 cost time: 0.9943621158599854
Epoch: 10, Steps: 64 | Train Loss: 0.1105385 Vali Loss: 0.1579964 Test Loss: 0.2186750
Validation loss decreased (0.159604 --> 0.157996).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 11 cost time: 0.9966020584106445
Epoch: 11, Steps: 64 | Train Loss: 0.1085255 Vali Loss: 0.1572267 Test Loss: 0.2176792
Validation loss decreased (0.157996 --> 0.157227).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 12 cost time: 0.9963352680206299
Epoch: 12, Steps: 64 | Train Loss: 0.1078853 Vali Loss: 0.1571972 Test Loss: 0.2183862
Validation loss decreased (0.157227 --> 0.157197).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 13 cost time: 0.9911103248596191
Epoch: 13, Steps: 64 | Train Loss: 0.1066203 Vali Loss: 0.1556637 Test Loss: 0.2194402
Validation loss decreased (0.157197 --> 0.155664).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 14 cost time: 0.9887566566467285
Epoch: 14, Steps: 64 | Train Loss: 0.1064404 Vali Loss: 0.1547078 Test Loss: 0.2213074
Validation loss decreased (0.155664 --> 0.154708).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 15 cost time: 0.9949054718017578
Epoch: 15, Steps: 64 | Train Loss: 0.1052578 Vali Loss: 0.1529843 Test Loss: 0.2204086
Validation loss decreased (0.154708 --> 0.152984).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 16 cost time: 0.994163990020752
Epoch: 16, Steps: 64 | Train Loss: 0.1046606 Vali Loss: 0.1506452 Test Loss: 0.2201875
Validation loss decreased (0.152984 --> 0.150645).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 17 cost time: 0.9766216278076172
Epoch: 17, Steps: 64 | Train Loss: 0.1042416 Vali Loss: 0.1528035 Test Loss: 0.2206833
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 18 cost time: 1.0046300888061523
Epoch: 18, Steps: 64 | Train Loss: 0.1033982 Vali Loss: 0.1503087 Test Loss: 0.2201234
Validation loss decreased (0.150645 --> 0.150309).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 19 cost time: 1.0763700008392334
Epoch: 19, Steps: 64 | Train Loss: 0.1030648 Vali Loss: 0.1511817 Test Loss: 0.2213921
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 20 cost time: 1.0821363925933838
Epoch: 20, Steps: 64 | Train Loss: 0.1034471 Vali Loss: 0.1531345 Test Loss: 0.2217506
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 21 cost time: 1.0415339469909668
Epoch: 21, Steps: 64 | Train Loss: 0.1030448 Vali Loss: 0.1485911 Test Loss: 0.2225444
Validation loss decreased (0.150309 --> 0.148591).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 22 cost time: 0.9699544906616211
Epoch: 22, Steps: 64 | Train Loss: 0.1026595 Vali Loss: 0.1514938 Test Loss: 0.2220690
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 23 cost time: 0.9883894920349121
Epoch: 23, Steps: 64 | Train Loss: 0.1019634 Vali Loss: 0.1500814 Test Loss: 0.2217633
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 24 cost time: 0.9873595237731934
Epoch: 24, Steps: 64 | Train Loss: 0.1014625 Vali Loss: 0.1493396 Test Loss: 0.2221623
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 25 cost time: 0.9725732803344727
Epoch: 25, Steps: 64 | Train Loss: 0.1021327 Vali Loss: 0.1505858 Test Loss: 0.2223454
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 26 cost time: 0.9873762130737305
Epoch: 26, Steps: 64 | Train Loss: 0.1016375 Vali Loss: 0.1490794 Test Loss: 0.2221965
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 27 cost time: 0.9920663833618164
Epoch: 27, Steps: 64 | Train Loss: 0.1016476 Vali Loss: 0.1494342 Test Loss: 0.2220051
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 28 cost time: 0.9977269172668457
Epoch: 28, Steps: 64 | Train Loss: 0.1014407 Vali Loss: 0.1475938 Test Loss: 0.2221372
Validation loss decreased (0.148591 --> 0.147594).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 29 cost time: 0.9957201480865479
Epoch: 29, Steps: 64 | Train Loss: 0.1014288 Vali Loss: 0.1506430 Test Loss: 0.2222480
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 30 cost time: 0.9889998435974121
Epoch: 30, Steps: 64 | Train Loss: 0.1011606 Vali Loss: 0.1481037 Test Loss: 0.2222467
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 31 cost time: 0.9999992847442627
Epoch: 31, Steps: 64 | Train Loss: 0.1009250 Vali Loss: 0.1481734 Test Loss: 0.2226074
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 32 cost time: 0.9906275272369385
Epoch: 32, Steps: 64 | Train Loss: 0.1007543 Vali Loss: 0.1471400 Test Loss: 0.2228007
Validation loss decreased (0.147594 --> 0.147140).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 33 cost time: 0.9866104125976562
Epoch: 33, Steps: 64 | Train Loss: 0.1005754 Vali Loss: 0.1477456 Test Loss: 0.2230372
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 34 cost time: 0.9924273490905762
Epoch: 34, Steps: 64 | Train Loss: 0.1008013 Vali Loss: 0.1480722 Test Loss: 0.2222614
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 35 cost time: 1.074531078338623
Epoch: 35, Steps: 64 | Train Loss: 0.1005911 Vali Loss: 0.1474141 Test Loss: 0.2223214
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 36 cost time: 1.0203747749328613
Epoch: 36, Steps: 64 | Train Loss: 0.1003231 Vali Loss: 0.1476622 Test Loss: 0.2234283
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 37 cost time: 1.002506971359253
Epoch: 37, Steps: 64 | Train Loss: 0.1003983 Vali Loss: 0.1468164 Test Loss: 0.2225292
Validation loss decreased (0.147140 --> 0.146816).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 38 cost time: 0.9881136417388916
Epoch: 38, Steps: 64 | Train Loss: 0.1004138 Vali Loss: 0.1479781 Test Loss: 0.2231544
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 39 cost time: 0.9863865375518799
Epoch: 39, Steps: 64 | Train Loss: 0.1006314 Vali Loss: 0.1466423 Test Loss: 0.2227606
Validation loss decreased (0.146816 --> 0.146642).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 40 cost time: 0.9863698482513428
Epoch: 40, Steps: 64 | Train Loss: 0.1004571 Vali Loss: 0.1476281 Test Loss: 0.2234100
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 41 cost time: 0.9903378486633301
Epoch: 41, Steps: 64 | Train Loss: 0.1008005 Vali Loss: 0.1476543 Test Loss: 0.2226831
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 42 cost time: 0.9867537021636963
Epoch: 42, Steps: 64 | Train Loss: 0.1000097 Vali Loss: 0.1466779 Test Loss: 0.2236235
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 43 cost time: 0.9963738918304443
Epoch: 43, Steps: 64 | Train Loss: 0.0996776 Vali Loss: 0.1470875 Test Loss: 0.2236209
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 44 cost time: 0.9880001544952393
Epoch: 44, Steps: 64 | Train Loss: 0.1001298 Vali Loss: 0.1489416 Test Loss: 0.2236126
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 45 cost time: 1.0124008655548096
Epoch: 45, Steps: 64 | Train Loss: 0.0998589 Vali Loss: 0.1469953 Test Loss: 0.2238331
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 46 cost time: 1.014888048171997
Epoch: 46, Steps: 64 | Train Loss: 0.0999019 Vali Loss: 0.1470864 Test Loss: 0.2227444
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 47 cost time: 1.0126044750213623
Epoch: 47, Steps: 64 | Train Loss: 0.1000086 Vali Loss: 0.1469727 Test Loss: 0.2225765
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 48 cost time: 1.008603811264038
Epoch: 48, Steps: 64 | Train Loss: 0.1001812 Vali Loss: 0.1475749 Test Loss: 0.2228485
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 49 cost time: 1.0009946823120117
Epoch: 49, Steps: 64 | Train Loss: 0.1002116 Vali Loss: 0.1471771 Test Loss: 0.2236713
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 50 cost time: 1.0027520656585693
Epoch: 50, Steps: 64 | Train Loss: 0.1005837 Vali Loss: 0.1470139 Test Loss: 0.2227335
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 51 cost time: 0.9948379993438721
Epoch: 51, Steps: 64 | Train Loss: 0.1000788 Vali Loss: 0.1473216 Test Loss: 0.2233197
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 52 cost time: 0.9943628311157227
Epoch: 52, Steps: 64 | Train Loss: 0.0999114 Vali Loss: 0.1479657 Test Loss: 0.2230290
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 53 cost time: 0.99241042137146
Epoch: 53, Steps: 64 | Train Loss: 0.1000252 Vali Loss: 0.1475833 Test Loss: 0.2232670
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 54 cost time: 1.0084686279296875
Epoch: 54, Steps: 64 | Train Loss: 0.1002889 Vali Loss: 0.1461960 Test Loss: 0.2228822
Validation loss decreased (0.146642 --> 0.146196).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 55 cost time: 0.9945263862609863
Epoch: 55, Steps: 64 | Train Loss: 0.1002953 Vali Loss: 0.1470517 Test Loss: 0.2233547
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 56 cost time: 0.9864044189453125
Epoch: 56, Steps: 64 | Train Loss: 0.0997319 Vali Loss: 0.1480042 Test Loss: 0.2242731
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 57 cost time: 0.9867291450500488
Epoch: 57, Steps: 64 | Train Loss: 0.1006305 Vali Loss: 0.1468374 Test Loss: 0.2231753
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 58 cost time: 0.9854140281677246
Epoch: 58, Steps: 64 | Train Loss: 0.0996576 Vali Loss: 0.1467625 Test Loss: 0.2229296
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 59 cost time: 0.9860002994537354
Epoch: 59, Steps: 64 | Train Loss: 0.1002516 Vali Loss: 0.1459108 Test Loss: 0.2228574
Validation loss decreased (0.146196 --> 0.145911).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 60 cost time: 1.0106210708618164
Epoch: 60, Steps: 64 | Train Loss: 0.1000452 Vali Loss: 0.1465299 Test Loss: 0.2232271
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22285741567611694, mae:0.3221214711666107, rse:0.239247664809227
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.045563697814941406 GB
Epoch: 1 cost time: 2.2546911239624023
Epoch: 1, Steps: 64 | Train Loss: 0.9225307 Vali Loss: 2.3998246 Test Loss: 3.8176222
Validation loss decreased (inf --> 2.399825).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 2 cost time: 0.8432519435882568
Epoch: 2, Steps: 64 | Train Loss: 0.8153912 Vali Loss: 1.8551645 Test Loss: 2.9300935
Validation loss decreased (2.399825 --> 1.855165).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 3 cost time: 0.8474338054656982
Epoch: 3, Steps: 64 | Train Loss: 0.6478854 Vali Loss: 1.4188070 Test Loss: 2.2149427
Validation loss decreased (1.855165 --> 1.418807).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 4 cost time: 0.848740816116333
Epoch: 4, Steps: 64 | Train Loss: 0.5121534 Vali Loss: 1.0990952 Test Loss: 1.6998464
Validation loss decreased (1.418807 --> 1.099095).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 5 cost time: 0.8449997901916504
Epoch: 5, Steps: 64 | Train Loss: 0.4110299 Vali Loss: 0.8707038 Test Loss: 1.3334786
Validation loss decreased (1.099095 --> 0.870704).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 6 cost time: 0.8446183204650879
Epoch: 6, Steps: 64 | Train Loss: 0.3380808 Vali Loss: 0.6982920 Test Loss: 1.0602894
Validation loss decreased (0.870704 --> 0.698292).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 7 cost time: 0.8543305397033691
Epoch: 7, Steps: 64 | Train Loss: 0.2855552 Vali Loss: 0.5845531 Test Loss: 0.8689300
Validation loss decreased (0.698292 --> 0.584553).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 8 cost time: 0.840348482131958
Epoch: 8, Steps: 64 | Train Loss: 0.2482769 Vali Loss: 0.4892651 Test Loss: 0.7244218
Validation loss decreased (0.584553 --> 0.489265).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 9 cost time: 0.8460795879364014
Epoch: 9, Steps: 64 | Train Loss: 0.2211167 Vali Loss: 0.4303773 Test Loss: 0.6273757
Validation loss decreased (0.489265 --> 0.430377).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 10 cost time: 0.8440001010894775
Epoch: 10, Steps: 64 | Train Loss: 0.2014452 Vali Loss: 0.3824366 Test Loss: 0.5493751
Validation loss decreased (0.430377 --> 0.382437).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 11 cost time: 0.8596086502075195
Epoch: 11, Steps: 64 | Train Loss: 0.1873291 Vali Loss: 0.3454871 Test Loss: 0.4887872
Validation loss decreased (0.382437 --> 0.345487).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 12 cost time: 0.8434197902679443
Epoch: 12, Steps: 64 | Train Loss: 0.1766183 Vali Loss: 0.3206111 Test Loss: 0.4500805
Validation loss decreased (0.345487 --> 0.320611).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 13 cost time: 0.8454086780548096
Epoch: 13, Steps: 64 | Train Loss: 0.1683759 Vali Loss: 0.2988707 Test Loss: 0.4151341
Validation loss decreased (0.320611 --> 0.298871).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 14 cost time: 0.8457353115081787
Epoch: 14, Steps: 64 | Train Loss: 0.1619377 Vali Loss: 0.2828638 Test Loss: 0.3934293
Validation loss decreased (0.298871 --> 0.282864).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 15 cost time: 0.8580000400543213
Epoch: 15, Steps: 64 | Train Loss: 0.1555253 Vali Loss: 0.2695485 Test Loss: 0.3689418
Validation loss decreased (0.282864 --> 0.269549).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 16 cost time: 0.8456234931945801
Epoch: 16, Steps: 64 | Train Loss: 0.1521194 Vali Loss: 0.2626795 Test Loss: 0.3545096
Validation loss decreased (0.269549 --> 0.262680).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 17 cost time: 0.847468376159668
Epoch: 17, Steps: 64 | Train Loss: 0.1477505 Vali Loss: 0.2529045 Test Loss: 0.3414351
Validation loss decreased (0.262680 --> 0.252905).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 18 cost time: 0.8463776111602783
Epoch: 18, Steps: 64 | Train Loss: 0.1462460 Vali Loss: 0.2456024 Test Loss: 0.3297364
Validation loss decreased (0.252905 --> 0.245602).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 19 cost time: 0.8533656597137451
Epoch: 19, Steps: 64 | Train Loss: 0.1445557 Vali Loss: 0.2397788 Test Loss: 0.3228553
Validation loss decreased (0.245602 --> 0.239779).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 20 cost time: 0.8420000076293945
Epoch: 20, Steps: 64 | Train Loss: 0.1427735 Vali Loss: 0.2362793 Test Loss: 0.3157487
Validation loss decreased (0.239779 --> 0.236279).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 21 cost time: 0.8486320972442627
Epoch: 21, Steps: 64 | Train Loss: 0.1406957 Vali Loss: 0.2298206 Test Loss: 0.3053697
Validation loss decreased (0.236279 --> 0.229821).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 22 cost time: 0.8423941135406494
Epoch: 22, Steps: 64 | Train Loss: 0.1398622 Vali Loss: 0.2279204 Test Loss: 0.3038500
Validation loss decreased (0.229821 --> 0.227920).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 23 cost time: 0.8430333137512207
Epoch: 23, Steps: 64 | Train Loss: 0.1387143 Vali Loss: 0.2246915 Test Loss: 0.2960312
Validation loss decreased (0.227920 --> 0.224692).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 24 cost time: 0.8438205718994141
Epoch: 24, Steps: 64 | Train Loss: 0.1382305 Vali Loss: 0.2218253 Test Loss: 0.2936197
Validation loss decreased (0.224692 --> 0.221825).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 25 cost time: 0.8429996967315674
Epoch: 25, Steps: 64 | Train Loss: 0.1374123 Vali Loss: 0.2179957 Test Loss: 0.2891537
Validation loss decreased (0.221825 --> 0.217996).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 26 cost time: 0.8456439971923828
Epoch: 26, Steps: 64 | Train Loss: 0.1368535 Vali Loss: 0.2162661 Test Loss: 0.2868477
Validation loss decreased (0.217996 --> 0.216266).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 27 cost time: 0.8618321418762207
Epoch: 27, Steps: 64 | Train Loss: 0.1354696 Vali Loss: 0.2180417 Test Loss: 0.2854807
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 28 cost time: 0.8434662818908691
Epoch: 28, Steps: 64 | Train Loss: 0.1351784 Vali Loss: 0.2145388 Test Loss: 0.2813470
Validation loss decreased (0.216266 --> 0.214539).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 29 cost time: 0.8437721729278564
Epoch: 29, Steps: 64 | Train Loss: 0.1347990 Vali Loss: 0.2132798 Test Loss: 0.2801321
Validation loss decreased (0.214539 --> 0.213280).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 30 cost time: 0.8436295986175537
Epoch: 30, Steps: 64 | Train Loss: 0.1339338 Vali Loss: 0.2122454 Test Loss: 0.2786500
Validation loss decreased (0.213280 --> 0.212245).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 31 cost time: 0.8172123432159424
Epoch: 31, Steps: 64 | Train Loss: 0.1340067 Vali Loss: 0.2092927 Test Loss: 0.2774207
Validation loss decreased (0.212245 --> 0.209293).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 32 cost time: 0.8443939685821533
Epoch: 32, Steps: 64 | Train Loss: 0.1329061 Vali Loss: 0.2096119 Test Loss: 0.2749382
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 33 cost time: 0.8413407802581787
Epoch: 33, Steps: 64 | Train Loss: 0.1334599 Vali Loss: 0.2109070 Test Loss: 0.2731623
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 34 cost time: 0.8492779731750488
Epoch: 34, Steps: 64 | Train Loss: 0.1330335 Vali Loss: 0.2090077 Test Loss: 0.2746991
Validation loss decreased (0.209293 --> 0.209008).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 35 cost time: 0.8439996242523193
Epoch: 35, Steps: 64 | Train Loss: 0.1327177 Vali Loss: 0.2091806 Test Loss: 0.2731402
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 36 cost time: 0.8424272537231445
Epoch: 36, Steps: 64 | Train Loss: 0.1325245 Vali Loss: 0.2081781 Test Loss: 0.2727641
Validation loss decreased (0.209008 --> 0.208178).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 37 cost time: 0.8434019088745117
Epoch: 37, Steps: 64 | Train Loss: 0.1329837 Vali Loss: 0.2082263 Test Loss: 0.2714466
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 38 cost time: 0.8503570556640625
Epoch: 38, Steps: 64 | Train Loss: 0.1319252 Vali Loss: 0.2063492 Test Loss: 0.2690997
Validation loss decreased (0.208178 --> 0.206349).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 39 cost time: 0.8487217426300049
Epoch: 39, Steps: 64 | Train Loss: 0.1321768 Vali Loss: 0.2083246 Test Loss: 0.2695017
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 40 cost time: 0.844998836517334
Epoch: 40, Steps: 64 | Train Loss: 0.1322490 Vali Loss: 0.2065964 Test Loss: 0.2690538
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 41 cost time: 0.8569416999816895
Epoch: 41, Steps: 64 | Train Loss: 0.1318962 Vali Loss: 0.2051940 Test Loss: 0.2692829
Validation loss decreased (0.206349 --> 0.205194).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 42 cost time: 0.8483853340148926
Epoch: 42, Steps: 64 | Train Loss: 0.1321727 Vali Loss: 0.2047696 Test Loss: 0.2691266
Validation loss decreased (0.205194 --> 0.204770).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 43 cost time: 0.845346212387085
Epoch: 43, Steps: 64 | Train Loss: 0.1318600 Vali Loss: 0.2061548 Test Loss: 0.2687976
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 44 cost time: 0.8457589149475098
Epoch: 44, Steps: 64 | Train Loss: 0.1314268 Vali Loss: 0.2041865 Test Loss: 0.2676103
Validation loss decreased (0.204770 --> 0.204186).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 45 cost time: 0.8580021858215332
Epoch: 45, Steps: 64 | Train Loss: 0.1317889 Vali Loss: 0.2017864 Test Loss: 0.2673328
Validation loss decreased (0.204186 --> 0.201786).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 46 cost time: 0.8466129302978516
Epoch: 46, Steps: 64 | Train Loss: 0.1309060 Vali Loss: 0.2062969 Test Loss: 0.2676720
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 47 cost time: 0.8463258743286133
Epoch: 47, Steps: 64 | Train Loss: 0.1307529 Vali Loss: 0.2041882 Test Loss: 0.2673227
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 48 cost time: 0.8463380336761475
Epoch: 48, Steps: 64 | Train Loss: 0.1316135 Vali Loss: 0.2047645 Test Loss: 0.2673137
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 49 cost time: 0.8547775745391846
Epoch: 49, Steps: 64 | Train Loss: 0.1308697 Vali Loss: 0.2036900 Test Loss: 0.2661618
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 50 cost time: 0.8458049297332764
Epoch: 50, Steps: 64 | Train Loss: 0.1308773 Vali Loss: 0.2050541 Test Loss: 0.2673237
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 51 cost time: 0.8476212024688721
Epoch: 51, Steps: 64 | Train Loss: 0.1317896 Vali Loss: 0.2040714 Test Loss: 0.2657072
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 52 cost time: 0.8473401069641113
Epoch: 52, Steps: 64 | Train Loss: 0.1306930 Vali Loss: 0.2022172 Test Loss: 0.2649582
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 53 cost time: 0.8232355117797852
Epoch: 53, Steps: 64 | Train Loss: 0.1306445 Vali Loss: 0.2015005 Test Loss: 0.2641793
Validation loss decreased (0.201786 --> 0.201500).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 54 cost time: 0.8477632999420166
Epoch: 54, Steps: 64 | Train Loss: 0.1304731 Vali Loss: 0.2043577 Test Loss: 0.2656254
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 55 cost time: 0.8413324356079102
Epoch: 55, Steps: 64 | Train Loss: 0.1310589 Vali Loss: 0.2029374 Test Loss: 0.2645214
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 56 cost time: 0.8434844017028809
Epoch: 56, Steps: 64 | Train Loss: 0.1313943 Vali Loss: 0.2029425 Test Loss: 0.2658657
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 57 cost time: 0.8494760990142822
Epoch: 57, Steps: 64 | Train Loss: 0.1310855 Vali Loss: 0.2024253 Test Loss: 0.2655152
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 58 cost time: 0.8503572940826416
Epoch: 58, Steps: 64 | Train Loss: 0.1312534 Vali Loss: 0.2007639 Test Loss: 0.2647972
Validation loss decreased (0.201500 --> 0.200764).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 59 cost time: 0.849999189376831
Epoch: 59, Steps: 64 | Train Loss: 0.1303336 Vali Loss: 0.2034274 Test Loss: 0.2651725
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 60 cost time: 0.8569998741149902
Epoch: 60, Steps: 64 | Train Loss: 0.1304100 Vali Loss: 0.2009301 Test Loss: 0.2631961
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2647971510887146, mae:0.3816865086555481, rse:0.2607899010181427
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 1 cost time: 2.2453348636627197
Epoch: 1, Steps: 64 | Train Loss: 0.8903413 Vali Loss: 2.3867724 Test Loss: 3.8166595
Validation loss decreased (inf --> 2.386772).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 2 cost time: 0.8843543529510498
Epoch: 2, Steps: 64 | Train Loss: 0.5887526 Vali Loss: 0.7578458 Test Loss: 1.1996565
Validation loss decreased (2.386772 --> 0.757846).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 3 cost time: 0.8849697113037109
Epoch: 3, Steps: 64 | Train Loss: 0.2137488 Vali Loss: 0.2023080 Test Loss: 0.2632702
Validation loss decreased (0.757846 --> 0.202308).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 4 cost time: 0.8707079887390137
Epoch: 4, Steps: 64 | Train Loss: 0.1452688 Vali Loss: 0.1876306 Test Loss: 0.2361099
Validation loss decreased (0.202308 --> 0.187631).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 5 cost time: 0.8824012279510498
Epoch: 5, Steps: 64 | Train Loss: 0.1380381 Vali Loss: 0.1869897 Test Loss: 0.2376367
Validation loss decreased (0.187631 --> 0.186990).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 6 cost time: 0.8796303272247314
Epoch: 6, Steps: 64 | Train Loss: 0.1343351 Vali Loss: 0.1839936 Test Loss: 0.2353439
Validation loss decreased (0.186990 --> 0.183994).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 7 cost time: 0.8783664703369141
Epoch: 7, Steps: 64 | Train Loss: 0.1307199 Vali Loss: 0.1792684 Test Loss: 0.2335796
Validation loss decreased (0.183994 --> 0.179268).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 8 cost time: 0.8833580017089844
Epoch: 8, Steps: 64 | Train Loss: 0.1290802 Vali Loss: 0.1802376 Test Loss: 0.2318020
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 9 cost time: 0.8863964080810547
Epoch: 9, Steps: 64 | Train Loss: 0.1274460 Vali Loss: 0.1816467 Test Loss: 0.2336301
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 10 cost time: 0.882763147354126
Epoch: 10, Steps: 64 | Train Loss: 0.1262294 Vali Loss: 0.1774754 Test Loss: 0.2320778
Validation loss decreased (0.179268 --> 0.177475).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 11 cost time: 0.8920004367828369
Epoch: 11, Steps: 64 | Train Loss: 0.1239049 Vali Loss: 0.1755373 Test Loss: 0.2316435
Validation loss decreased (0.177475 --> 0.175537).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 12 cost time: 0.8819992542266846
Epoch: 12, Steps: 64 | Train Loss: 0.1243900 Vali Loss: 0.1770343 Test Loss: 0.2323763
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 13 cost time: 0.8804564476013184
Epoch: 13, Steps: 64 | Train Loss: 0.1225982 Vali Loss: 0.1759492 Test Loss: 0.2314981
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 14 cost time: 0.889965295791626
Epoch: 14, Steps: 64 | Train Loss: 0.1219005 Vali Loss: 0.1729269 Test Loss: 0.2315224
Validation loss decreased (0.175537 --> 0.172927).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 15 cost time: 0.8816089630126953
Epoch: 15, Steps: 64 | Train Loss: 0.1210821 Vali Loss: 0.1744048 Test Loss: 0.2321772
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 16 cost time: 0.8817412853240967
Epoch: 16, Steps: 64 | Train Loss: 0.1211500 Vali Loss: 0.1743628 Test Loss: 0.2315234
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 17 cost time: 0.8820004463195801
Epoch: 17, Steps: 64 | Train Loss: 0.1206498 Vali Loss: 0.1732255 Test Loss: 0.2318997
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 18 cost time: 0.8916134834289551
Epoch: 18, Steps: 64 | Train Loss: 0.1196352 Vali Loss: 0.1733116 Test Loss: 0.2328953
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 19 cost time: 0.8833403587341309
Epoch: 19, Steps: 64 | Train Loss: 0.1196975 Vali Loss: 0.1724941 Test Loss: 0.2318756
Validation loss decreased (0.172927 --> 0.172494).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 20 cost time: 0.8773946762084961
Epoch: 20, Steps: 64 | Train Loss: 0.1189516 Vali Loss: 0.1717035 Test Loss: 0.2329565
Validation loss decreased (0.172494 --> 0.171704).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 21 cost time: 0.881352424621582
Epoch: 21, Steps: 64 | Train Loss: 0.1182693 Vali Loss: 0.1729693 Test Loss: 0.2328488
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 22 cost time: 0.8852851390838623
Epoch: 22, Steps: 64 | Train Loss: 0.1181713 Vali Loss: 0.1733712 Test Loss: 0.2332750
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 23 cost time: 0.8840000629425049
Epoch: 23, Steps: 64 | Train Loss: 0.1186126 Vali Loss: 0.1719470 Test Loss: 0.2327092
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 24 cost time: 0.8806076049804688
Epoch: 24, Steps: 64 | Train Loss: 0.1180278 Vali Loss: 0.1720248 Test Loss: 0.2321426
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 25 cost time: 0.8904223442077637
Epoch: 25, Steps: 64 | Train Loss: 0.1175486 Vali Loss: 0.1695834 Test Loss: 0.2332855
Validation loss decreased (0.171704 --> 0.169583).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 26 cost time: 0.8804302215576172
Epoch: 26, Steps: 64 | Train Loss: 0.1172696 Vali Loss: 0.1716054 Test Loss: 0.2328504
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 27 cost time: 0.8857729434967041
Epoch: 27, Steps: 64 | Train Loss: 0.1174837 Vali Loss: 0.1717886 Test Loss: 0.2337848
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 28 cost time: 0.8837249279022217
Epoch: 28, Steps: 64 | Train Loss: 0.1167555 Vali Loss: 0.1705422 Test Loss: 0.2329712
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 29 cost time: 0.8809998035430908
Epoch: 29, Steps: 64 | Train Loss: 0.1173113 Vali Loss: 0.1714518 Test Loss: 0.2339684
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 30 cost time: 0.883622407913208
Epoch: 30, Steps: 64 | Train Loss: 0.1170779 Vali Loss: 0.1717236 Test Loss: 0.2338525
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 31 cost time: 0.8788571357727051
Epoch: 31, Steps: 64 | Train Loss: 0.1166197 Vali Loss: 0.1720079 Test Loss: 0.2348047
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 32 cost time: 0.890413761138916
Epoch: 32, Steps: 64 | Train Loss: 0.1158867 Vali Loss: 0.1704689 Test Loss: 0.2341755
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 33 cost time: 0.8793697357177734
Epoch: 33, Steps: 64 | Train Loss: 0.1167570 Vali Loss: 0.1707464 Test Loss: 0.2330385
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 34 cost time: 0.8828012943267822
Epoch: 34, Steps: 64 | Train Loss: 0.1164792 Vali Loss: 0.1726546 Test Loss: 0.2345856
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 35 cost time: 0.8819999694824219
Epoch: 35, Steps: 64 | Train Loss: 0.1166587 Vali Loss: 0.1730466 Test Loss: 0.2342065
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 36 cost time: 0.8936288356781006
Epoch: 36, Steps: 64 | Train Loss: 0.1162463 Vali Loss: 0.1714215 Test Loss: 0.2337861
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 37 cost time: 0.8823075294494629
Epoch: 37, Steps: 64 | Train Loss: 0.1165279 Vali Loss: 0.1717613 Test Loss: 0.2339565
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 38 cost time: 0.8823990821838379
Epoch: 38, Steps: 64 | Train Loss: 0.1163378 Vali Loss: 0.1724641 Test Loss: 0.2335829
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 39 cost time: 0.882422924041748
Epoch: 39, Steps: 64 | Train Loss: 0.1163702 Vali Loss: 0.1719601 Test Loss: 0.2336574
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 40 cost time: 0.8814301490783691
Epoch: 40, Steps: 64 | Train Loss: 0.1166136 Vali Loss: 0.1712335 Test Loss: 0.2338387
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 41 cost time: 0.8829998970031738
Epoch: 41, Steps: 64 | Train Loss: 0.1158784 Vali Loss: 0.1723479 Test Loss: 0.2341938
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 42 cost time: 0.8826272487640381
Epoch: 42, Steps: 64 | Train Loss: 0.1161454 Vali Loss: 0.1714739 Test Loss: 0.2332376
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 43 cost time: 0.8884158134460449
Epoch: 43, Steps: 64 | Train Loss: 0.1156813 Vali Loss: 0.1711242 Test Loss: 0.2337130
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 44 cost time: 0.8813817501068115
Epoch: 44, Steps: 64 | Train Loss: 0.1157696 Vali Loss: 0.1714059 Test Loss: 0.2342249
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 45 cost time: 0.8780148029327393
Epoch: 45, Steps: 64 | Train Loss: 0.1162191 Vali Loss: 0.1704713 Test Loss: 0.2336424
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 46 cost time: 0.8827590942382812
Epoch: 46, Steps: 64 | Train Loss: 0.1154769 Vali Loss: 0.1721232 Test Loss: 0.2335546
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 47 cost time: 0.8819994926452637
Epoch: 47, Steps: 64 | Train Loss: 0.1155903 Vali Loss: 0.1724684 Test Loss: 0.2344437
EarlyStopping counter: 22 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 48 cost time: 0.9446201324462891
Epoch: 48, Steps: 64 | Train Loss: 0.1160892 Vali Loss: 0.1717292 Test Loss: 0.2345106
EarlyStopping counter: 23 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 49 cost time: 0.8813908100128174
Epoch: 49, Steps: 64 | Train Loss: 0.1156706 Vali Loss: 0.1701573 Test Loss: 0.2347101
EarlyStopping counter: 24 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 50 cost time: 0.8913345336914062
Epoch: 50, Steps: 64 | Train Loss: 0.1154582 Vali Loss: 0.1709931 Test Loss: 0.2341928
EarlyStopping counter: 25 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 51 cost time: 0.8763887882232666
Epoch: 51, Steps: 64 | Train Loss: 0.1157669 Vali Loss: 0.1715081 Test Loss: 0.2336385
EarlyStopping counter: 26 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 52 cost time: 0.880734920501709
Epoch: 52, Steps: 64 | Train Loss: 0.1156996 Vali Loss: 0.1727954 Test Loss: 0.2345116
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 53 cost time: 0.8767919540405273
Epoch: 53, Steps: 64 | Train Loss: 0.1154818 Vali Loss: 0.1714679 Test Loss: 0.2345111
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 54 cost time: 0.8776202201843262
Epoch: 54, Steps: 64 | Train Loss: 0.1153140 Vali Loss: 0.1708382 Test Loss: 0.2338505
EarlyStopping counter: 29 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 55 cost time: 0.8833949565887451
Epoch: 55, Steps: 64 | Train Loss: 0.1156909 Vali Loss: 0.1709392 Test Loss: 0.2342537
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 56 cost time: 0.8823885917663574
Epoch: 56, Steps: 64 | Train Loss: 0.1157791 Vali Loss: 0.1714790 Test Loss: 0.2341735
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 57 cost time: 0.8853790760040283
Epoch: 57, Steps: 64 | Train Loss: 0.1151063 Vali Loss: 0.1713914 Test Loss: 0.2339168
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 58 cost time: 0.8850934505462646
Epoch: 58, Steps: 64 | Train Loss: 0.1157130 Vali Loss: 0.1709090 Test Loss: 0.2346391
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 59 cost time: 0.879000186920166
Epoch: 59, Steps: 64 | Train Loss: 0.1154406 Vali Loss: 0.1710117 Test Loss: 0.2346309
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 60 cost time: 0.8786194324493408
Epoch: 60, Steps: 64 | Train Loss: 0.1154746 Vali Loss: 0.1701612 Test Loss: 0.2342761
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23328551650047302, mae:0.35055941343307495, rse:0.24478118121623993
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05285072326660156 GB
Epoch: 1 cost time: 2.249659776687622
Epoch: 1, Steps: 64 | Train Loss: 0.8609189 Vali Loss: 2.3325024 Test Loss: 3.7159555
Validation loss decreased (inf --> 2.332502).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 2 cost time: 0.98404860496521
Epoch: 2, Steps: 64 | Train Loss: 0.4788295 Vali Loss: 0.2288691 Test Loss: 0.3226449
Validation loss decreased (2.332502 --> 0.228869).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 3 cost time: 0.9850804805755615
Epoch: 3, Steps: 64 | Train Loss: 0.1546764 Vali Loss: 0.2059648 Test Loss: 0.2550412
Validation loss decreased (0.228869 --> 0.205965).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 4 cost time: 0.9114437103271484
Epoch: 4, Steps: 64 | Train Loss: 0.1403747 Vali Loss: 0.1862769 Test Loss: 0.2318508
Validation loss decreased (0.205965 --> 0.186277).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 5 cost time: 0.9133365154266357
Epoch: 5, Steps: 64 | Train Loss: 0.1345250 Vali Loss: 0.1841248 Test Loss: 0.2329219
Validation loss decreased (0.186277 --> 0.184125).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 6 cost time: 0.9117426872253418
Epoch: 6, Steps: 64 | Train Loss: 0.1297961 Vali Loss: 0.1842123 Test Loss: 0.2342180
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 7 cost time: 0.9114110469818115
Epoch: 7, Steps: 64 | Train Loss: 0.1278322 Vali Loss: 0.1784615 Test Loss: 0.2317827
Validation loss decreased (0.184125 --> 0.178462).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 8 cost time: 0.9182376861572266
Epoch: 8, Steps: 64 | Train Loss: 0.1264863 Vali Loss: 0.1765892 Test Loss: 0.2299024
Validation loss decreased (0.178462 --> 0.176589).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 9 cost time: 0.9104318618774414
Epoch: 9, Steps: 64 | Train Loss: 0.1239111 Vali Loss: 0.1784648 Test Loss: 0.2293422
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 10 cost time: 0.9143574237823486
Epoch: 10, Steps: 64 | Train Loss: 0.1230006 Vali Loss: 0.1749265 Test Loss: 0.2291612
Validation loss decreased (0.176589 --> 0.174926).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 11 cost time: 0.9229810237884521
Epoch: 11, Steps: 64 | Train Loss: 0.1216464 Vali Loss: 0.1727483 Test Loss: 0.2297721
Validation loss decreased (0.174926 --> 0.172748).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 12 cost time: 0.9094116687774658
Epoch: 12, Steps: 64 | Train Loss: 0.1203653 Vali Loss: 0.1732121 Test Loss: 0.2305551
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 13 cost time: 0.9117205142974854
Epoch: 13, Steps: 64 | Train Loss: 0.1199928 Vali Loss: 0.1723448 Test Loss: 0.2303268
Validation loss decreased (0.172748 --> 0.172345).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 14 cost time: 0.9179356098175049
Epoch: 14, Steps: 64 | Train Loss: 0.1196424 Vali Loss: 0.1762311 Test Loss: 0.2323313
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 15 cost time: 0.9220027923583984
Epoch: 15, Steps: 64 | Train Loss: 0.1185420 Vali Loss: 0.1722174 Test Loss: 0.2300443
Validation loss decreased (0.172345 --> 0.172217).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 16 cost time: 0.9086141586303711
Epoch: 16, Steps: 64 | Train Loss: 0.1181821 Vali Loss: 0.1708030 Test Loss: 0.2298040
Validation loss decreased (0.172217 --> 0.170803).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 17 cost time: 0.910393476486206
Epoch: 17, Steps: 64 | Train Loss: 0.1183174 Vali Loss: 0.1728149 Test Loss: 0.2313937
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 18 cost time: 0.917456865310669
Epoch: 18, Steps: 64 | Train Loss: 0.1177534 Vali Loss: 0.1718751 Test Loss: 0.2314842
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 19 cost time: 0.912423849105835
Epoch: 19, Steps: 64 | Train Loss: 0.1171358 Vali Loss: 0.1710328 Test Loss: 0.2311653
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 20 cost time: 0.9141809940338135
Epoch: 20, Steps: 64 | Train Loss: 0.1166521 Vali Loss: 0.1727024 Test Loss: 0.2316508
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 21 cost time: 0.9140002727508545
Epoch: 21, Steps: 64 | Train Loss: 0.1161192 Vali Loss: 0.1710537 Test Loss: 0.2319382
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 22 cost time: 0.9148094654083252
Epoch: 22, Steps: 64 | Train Loss: 0.1159585 Vali Loss: 0.1714152 Test Loss: 0.2320023
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 23 cost time: 0.8996036052703857
Epoch: 23, Steps: 64 | Train Loss: 0.1160216 Vali Loss: 0.1717321 Test Loss: 0.2316146
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 24 cost time: 0.9342868328094482
Epoch: 24, Steps: 64 | Train Loss: 0.1156765 Vali Loss: 0.1727484 Test Loss: 0.2335255
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 25 cost time: 0.9324672222137451
Epoch: 25, Steps: 64 | Train Loss: 0.1148063 Vali Loss: 0.1729650 Test Loss: 0.2329666
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 26 cost time: 0.9041435718536377
Epoch: 26, Steps: 64 | Train Loss: 0.1147019 Vali Loss: 0.1700207 Test Loss: 0.2328422
Validation loss decreased (0.170803 --> 0.170021).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 27 cost time: 0.9133453369140625
Epoch: 27, Steps: 64 | Train Loss: 0.1148121 Vali Loss: 0.1706497 Test Loss: 0.2331902
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 28 cost time: 0.9153642654418945
Epoch: 28, Steps: 64 | Train Loss: 0.1147551 Vali Loss: 0.1709160 Test Loss: 0.2324037
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 29 cost time: 0.9100008010864258
Epoch: 29, Steps: 64 | Train Loss: 0.1143252 Vali Loss: 0.1691901 Test Loss: 0.2327811
Validation loss decreased (0.170021 --> 0.169190).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 30 cost time: 0.9146263599395752
Epoch: 30, Steps: 64 | Train Loss: 0.1147824 Vali Loss: 0.1707979 Test Loss: 0.2330424
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 31 cost time: 0.9133796691894531
Epoch: 31, Steps: 64 | Train Loss: 0.1149768 Vali Loss: 0.1727145 Test Loss: 0.2338523
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 32 cost time: 0.9093828201293945
Epoch: 32, Steps: 64 | Train Loss: 0.1143459 Vali Loss: 0.1703660 Test Loss: 0.2333397
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 33 cost time: 0.9113993644714355
Epoch: 33, Steps: 64 | Train Loss: 0.1141953 Vali Loss: 0.1690107 Test Loss: 0.2336530
Validation loss decreased (0.169190 --> 0.169011).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 34 cost time: 0.9123744964599609
Epoch: 34, Steps: 64 | Train Loss: 0.1134911 Vali Loss: 0.1693118 Test Loss: 0.2339839
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 35 cost time: 0.912733793258667
Epoch: 35, Steps: 64 | Train Loss: 0.1141347 Vali Loss: 0.1703740 Test Loss: 0.2336762
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 36 cost time: 0.9269998073577881
Epoch: 36, Steps: 64 | Train Loss: 0.1143290 Vali Loss: 0.1705241 Test Loss: 0.2329749
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 37 cost time: 0.9200165271759033
Epoch: 37, Steps: 64 | Train Loss: 0.1135942 Vali Loss: 0.1712685 Test Loss: 0.2342003
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 38 cost time: 0.9143383502960205
Epoch: 38, Steps: 64 | Train Loss: 0.1137918 Vali Loss: 0.1710072 Test Loss: 0.2341991
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 39 cost time: 0.9304535388946533
Epoch: 39, Steps: 64 | Train Loss: 0.1137882 Vali Loss: 0.1687668 Test Loss: 0.2330764
Validation loss decreased (0.169011 --> 0.168767).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 40 cost time: 0.9093914031982422
Epoch: 40, Steps: 64 | Train Loss: 0.1138928 Vali Loss: 0.1707028 Test Loss: 0.2342984
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 41 cost time: 0.907332181930542
Epoch: 41, Steps: 64 | Train Loss: 0.1139860 Vali Loss: 0.1689301 Test Loss: 0.2339702
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 42 cost time: 0.9087362289428711
Epoch: 42, Steps: 64 | Train Loss: 0.1140143 Vali Loss: 0.1698413 Test Loss: 0.2334459
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 43 cost time: 0.9140024185180664
Epoch: 43, Steps: 64 | Train Loss: 0.1142940 Vali Loss: 0.1710639 Test Loss: 0.2336735
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 44 cost time: 0.9090025424957275
Epoch: 44, Steps: 64 | Train Loss: 0.1138177 Vali Loss: 0.1712047 Test Loss: 0.2342257
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 45 cost time: 0.9093565940856934
Epoch: 45, Steps: 64 | Train Loss: 0.1144161 Vali Loss: 0.1698140 Test Loss: 0.2348787
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 46 cost time: 0.9193446636199951
Epoch: 46, Steps: 64 | Train Loss: 0.1136948 Vali Loss: 0.1701193 Test Loss: 0.2344211
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 47 cost time: 0.9144361019134521
Epoch: 47, Steps: 64 | Train Loss: 0.1140415 Vali Loss: 0.1709767 Test Loss: 0.2338251
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 48 cost time: 0.9113736152648926
Epoch: 48, Steps: 64 | Train Loss: 0.1136668 Vali Loss: 0.1705521 Test Loss: 0.2347566
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 49 cost time: 0.9097435474395752
Epoch: 49, Steps: 64 | Train Loss: 0.1139355 Vali Loss: 0.1705586 Test Loss: 0.2342335
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 50 cost time: 0.9116363525390625
Epoch: 50, Steps: 64 | Train Loss: 0.1133001 Vali Loss: 0.1704676 Test Loss: 0.2344233
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 51 cost time: 0.9089996814727783
Epoch: 51, Steps: 64 | Train Loss: 0.1138898 Vali Loss: 0.1695014 Test Loss: 0.2338051
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 52 cost time: 0.9126169681549072
Epoch: 52, Steps: 64 | Train Loss: 0.1139586 Vali Loss: 0.1700437 Test Loss: 0.2334797
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 53 cost time: 0.9103593826293945
Epoch: 53, Steps: 64 | Train Loss: 0.1141126 Vali Loss: 0.1704908 Test Loss: 0.2343694
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 54 cost time: 0.9143145084381104
Epoch: 54, Steps: 64 | Train Loss: 0.1137608 Vali Loss: 0.1706131 Test Loss: 0.2346193
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 55 cost time: 0.9154291152954102
Epoch: 55, Steps: 64 | Train Loss: 0.1139251 Vali Loss: 0.1697956 Test Loss: 0.2352503
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 56 cost time: 0.9108073711395264
Epoch: 56, Steps: 64 | Train Loss: 0.1131548 Vali Loss: 0.1695125 Test Loss: 0.2340567
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 57 cost time: 0.9129998683929443
Epoch: 57, Steps: 64 | Train Loss: 0.1138302 Vali Loss: 0.1708724 Test Loss: 0.2341956
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 58 cost time: 0.9124417304992676
Epoch: 58, Steps: 64 | Train Loss: 0.1134822 Vali Loss: 0.1702514 Test Loss: 0.2339243
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 59 cost time: 0.911618709564209
Epoch: 59, Steps: 64 | Train Loss: 0.1136375 Vali Loss: 0.1681523 Test Loss: 0.2337862
Validation loss decreased (0.168767 --> 0.168152).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 60 cost time: 0.9203834533691406
Epoch: 60, Steps: 64 | Train Loss: 0.1133614 Vali Loss: 0.1701139 Test Loss: 0.2340882
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23378624022006989, mae:0.35258594155311584, rse:0.24504373967647552
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04572486877441406 GB
Epoch: 1 cost time: 2.1941239833831787
Epoch: 1, Steps: 64 | Train Loss: 0.9287042 Vali Loss: 2.4171505 Test Loss: 3.8298213
Validation loss decreased (inf --> 2.417150).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 2 cost time: 0.8547511100769043
Epoch: 2, Steps: 64 | Train Loss: 0.7893498 Vali Loss: 1.7154894 Test Loss: 2.6842632
Validation loss decreased (2.417150 --> 1.715489).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 3 cost time: 0.8530001640319824
Epoch: 3, Steps: 64 | Train Loss: 0.6019936 Vali Loss: 1.2670472 Test Loss: 1.9434468
Validation loss decreased (1.715489 --> 1.267047).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 4 cost time: 0.8526239395141602
Epoch: 4, Steps: 64 | Train Loss: 0.4622826 Vali Loss: 0.9533029 Test Loss: 1.4295256
Validation loss decreased (1.267047 --> 0.953303).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 5 cost time: 0.8552286624908447
Epoch: 5, Steps: 64 | Train Loss: 0.3638892 Vali Loss: 0.7495916 Test Loss: 1.1098311
Validation loss decreased (0.953303 --> 0.749592).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 6 cost time: 0.8543517589569092
Epoch: 6, Steps: 64 | Train Loss: 0.2988035 Vali Loss: 0.6090626 Test Loss: 0.8912570
Validation loss decreased (0.749592 --> 0.609063).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 7 cost time: 0.8563559055328369
Epoch: 7, Steps: 64 | Train Loss: 0.2549423 Vali Loss: 0.5038190 Test Loss: 0.7328957
Validation loss decreased (0.609063 --> 0.503819).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 8 cost time: 0.8492112159729004
Epoch: 8, Steps: 64 | Train Loss: 0.2234810 Vali Loss: 0.4306881 Test Loss: 0.6176280
Validation loss decreased (0.503819 --> 0.430688).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 9 cost time: 0.8479998111724854
Epoch: 9, Steps: 64 | Train Loss: 0.2016367 Vali Loss: 0.3776096 Test Loss: 0.5366262
Validation loss decreased (0.430688 --> 0.377610).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 10 cost time: 0.8506321907043457
Epoch: 10, Steps: 64 | Train Loss: 0.1859072 Vali Loss: 0.3380441 Test Loss: 0.4756404
Validation loss decreased (0.377610 --> 0.338044).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 11 cost time: 0.8624675273895264
Epoch: 11, Steps: 64 | Train Loss: 0.1752447 Vali Loss: 0.3086223 Test Loss: 0.4305919
Validation loss decreased (0.338044 --> 0.308622).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 12 cost time: 0.9096658229827881
Epoch: 12, Steps: 64 | Train Loss: 0.1649060 Vali Loss: 0.2886880 Test Loss: 0.3995801
Validation loss decreased (0.308622 --> 0.288688).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 13 cost time: 0.855715274810791
Epoch: 13, Steps: 64 | Train Loss: 0.1580620 Vali Loss: 0.2727107 Test Loss: 0.3754143
Validation loss decreased (0.288688 --> 0.272711).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 14 cost time: 0.8519999980926514
Epoch: 14, Steps: 64 | Train Loss: 0.1535920 Vali Loss: 0.2583468 Test Loss: 0.3532287
Validation loss decreased (0.272711 --> 0.258347).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 15 cost time: 0.8596241474151611
Epoch: 15, Steps: 64 | Train Loss: 0.1492308 Vali Loss: 0.2473969 Test Loss: 0.3371091
Validation loss decreased (0.258347 --> 0.247397).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 16 cost time: 0.8533298969268799
Epoch: 16, Steps: 64 | Train Loss: 0.1460277 Vali Loss: 0.2390568 Test Loss: 0.3262937
Validation loss decreased (0.247397 --> 0.239057).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 17 cost time: 0.8483788967132568
Epoch: 17, Steps: 64 | Train Loss: 0.1435059 Vali Loss: 0.2316107 Test Loss: 0.3155836
Validation loss decreased (0.239057 --> 0.231611).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 18 cost time: 0.8634955883026123
Epoch: 18, Steps: 64 | Train Loss: 0.1411246 Vali Loss: 0.2247336 Test Loss: 0.3050755
Validation loss decreased (0.231611 --> 0.224734).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 19 cost time: 0.8519978523254395
Epoch: 19, Steps: 64 | Train Loss: 0.1394089 Vali Loss: 0.2196543 Test Loss: 0.2975238
Validation loss decreased (0.224734 --> 0.219654).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 20 cost time: 0.8500032424926758
Epoch: 20, Steps: 64 | Train Loss: 0.1379709 Vali Loss: 0.2157735 Test Loss: 0.2911808
Validation loss decreased (0.219654 --> 0.215773).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 21 cost time: 0.853400468826294
Epoch: 21, Steps: 64 | Train Loss: 0.1368500 Vali Loss: 0.2137088 Test Loss: 0.2883545
Validation loss decreased (0.215773 --> 0.213709).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 22 cost time: 0.871152400970459
Epoch: 22, Steps: 64 | Train Loss: 0.1354267 Vali Loss: 0.2110174 Test Loss: 0.2848634
Validation loss decreased (0.213709 --> 0.211017).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 23 cost time: 0.8543605804443359
Epoch: 23, Steps: 64 | Train Loss: 0.1356079 Vali Loss: 0.2075585 Test Loss: 0.2788225
Validation loss decreased (0.211017 --> 0.207558).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 24 cost time: 0.8478353023529053
Epoch: 24, Steps: 64 | Train Loss: 0.1341863 Vali Loss: 0.2064897 Test Loss: 0.2763422
Validation loss decreased (0.207558 --> 0.206490).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 25 cost time: 0.8510000705718994
Epoch: 25, Steps: 64 | Train Loss: 0.1337668 Vali Loss: 0.2036369 Test Loss: 0.2724277
Validation loss decreased (0.206490 --> 0.203637).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 26 cost time: 0.8539414405822754
Epoch: 26, Steps: 64 | Train Loss: 0.1323110 Vali Loss: 0.2018845 Test Loss: 0.2710645
Validation loss decreased (0.203637 --> 0.201884).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 27 cost time: 0.8483214378356934
Epoch: 27, Steps: 64 | Train Loss: 0.1321122 Vali Loss: 0.2023348 Test Loss: 0.2705301
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 28 cost time: 0.8483929634094238
Epoch: 28, Steps: 64 | Train Loss: 0.1319222 Vali Loss: 0.1997060 Test Loss: 0.2663612
Validation loss decreased (0.201884 --> 0.199706).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 29 cost time: 0.8557572364807129
Epoch: 29, Steps: 64 | Train Loss: 0.1315022 Vali Loss: 0.1963527 Test Loss: 0.2648421
Validation loss decreased (0.199706 --> 0.196353).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 30 cost time: 0.8459985256195068
Epoch: 30, Steps: 64 | Train Loss: 0.1305204 Vali Loss: 0.1966568 Test Loss: 0.2649581
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 31 cost time: 0.9196484088897705
Epoch: 31, Steps: 64 | Train Loss: 0.1308037 Vali Loss: 0.1969820 Test Loss: 0.2640553
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 32 cost time: 0.8513064384460449
Epoch: 32, Steps: 64 | Train Loss: 0.1306892 Vali Loss: 0.1961814 Test Loss: 0.2613088
Validation loss decreased (0.196353 --> 0.196181).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 33 cost time: 0.8574283123016357
Epoch: 33, Steps: 64 | Train Loss: 0.1302223 Vali Loss: 0.1946482 Test Loss: 0.2614227
Validation loss decreased (0.196181 --> 0.194648).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 34 cost time: 0.8473477363586426
Epoch: 34, Steps: 64 | Train Loss: 0.1294130 Vali Loss: 0.1950382 Test Loss: 0.2617894
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 35 cost time: 0.8523416519165039
Epoch: 35, Steps: 64 | Train Loss: 0.1300721 Vali Loss: 0.1941606 Test Loss: 0.2585093
Validation loss decreased (0.194648 --> 0.194161).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 36 cost time: 0.8550000190734863
Epoch: 36, Steps: 64 | Train Loss: 0.1279810 Vali Loss: 0.1930537 Test Loss: 0.2596173
Validation loss decreased (0.194161 --> 0.193054).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 37 cost time: 0.8564543724060059
Epoch: 37, Steps: 64 | Train Loss: 0.1290720 Vali Loss: 0.1948141 Test Loss: 0.2598702
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 38 cost time: 0.8514091968536377
Epoch: 38, Steps: 64 | Train Loss: 0.1291591 Vali Loss: 0.1934130 Test Loss: 0.2578779
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 39 cost time: 0.8523819446563721
Epoch: 39, Steps: 64 | Train Loss: 0.1292729 Vali Loss: 0.1925603 Test Loss: 0.2550072
Validation loss decreased (0.193054 --> 0.192560).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 40 cost time: 0.8530681133270264
Epoch: 40, Steps: 64 | Train Loss: 0.1283029 Vali Loss: 0.1911243 Test Loss: 0.2565981
Validation loss decreased (0.192560 --> 0.191124).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 41 cost time: 0.859999418258667
Epoch: 41, Steps: 64 | Train Loss: 0.1283312 Vali Loss: 0.1912162 Test Loss: 0.2558468
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 42 cost time: 0.8535444736480713
Epoch: 42, Steps: 64 | Train Loss: 0.1281605 Vali Loss: 0.1919185 Test Loss: 0.2566282
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 43 cost time: 0.8491508960723877
Epoch: 43, Steps: 64 | Train Loss: 0.1286137 Vali Loss: 0.1906628 Test Loss: 0.2532259
Validation loss decreased (0.191124 --> 0.190663).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 44 cost time: 0.8647449016571045
Epoch: 44, Steps: 64 | Train Loss: 0.1280377 Vali Loss: 0.1898136 Test Loss: 0.2565137
Validation loss decreased (0.190663 --> 0.189814).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 45 cost time: 0.8523218631744385
Epoch: 45, Steps: 64 | Train Loss: 0.1283495 Vali Loss: 0.1908582 Test Loss: 0.2561970
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 46 cost time: 0.8510005474090576
Epoch: 46, Steps: 64 | Train Loss: 0.1286653 Vali Loss: 0.1899228 Test Loss: 0.2567390
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 47 cost time: 0.8546147346496582
Epoch: 47, Steps: 64 | Train Loss: 0.1280650 Vali Loss: 0.1904549 Test Loss: 0.2545337
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 48 cost time: 0.8613736629486084
Epoch: 48, Steps: 64 | Train Loss: 0.1281889 Vali Loss: 0.1907504 Test Loss: 0.2557100
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 49 cost time: 0.8545756340026855
Epoch: 49, Steps: 64 | Train Loss: 0.1291475 Vali Loss: 0.1906535 Test Loss: 0.2536742
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 50 cost time: 0.851792573928833
Epoch: 50, Steps: 64 | Train Loss: 0.1280294 Vali Loss: 0.1910617 Test Loss: 0.2545429
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 51 cost time: 0.8530001640319824
Epoch: 51, Steps: 64 | Train Loss: 0.1279688 Vali Loss: 0.1917343 Test Loss: 0.2541520
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 52 cost time: 0.8576292991638184
Epoch: 52, Steps: 64 | Train Loss: 0.1280193 Vali Loss: 0.1903264 Test Loss: 0.2545170
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 53 cost time: 0.8551459312438965
Epoch: 53, Steps: 64 | Train Loss: 0.1273828 Vali Loss: 0.1898015 Test Loss: 0.2523124
Validation loss decreased (0.189814 --> 0.189801).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 54 cost time: 0.8503470420837402
Epoch: 54, Steps: 64 | Train Loss: 0.1282789 Vali Loss: 0.1906578 Test Loss: 0.2550643
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 55 cost time: 0.8607492446899414
Epoch: 55, Steps: 64 | Train Loss: 0.1275602 Vali Loss: 0.1894507 Test Loss: 0.2543208
Validation loss decreased (0.189801 --> 0.189451).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 56 cost time: 0.8408193588256836
Epoch: 56, Steps: 64 | Train Loss: 0.1279419 Vali Loss: 0.1904422 Test Loss: 0.2549420
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 57 cost time: 0.8506383895874023
Epoch: 57, Steps: 64 | Train Loss: 0.1274689 Vali Loss: 0.1882086 Test Loss: 0.2525128
Validation loss decreased (0.189451 --> 0.188209).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 58 cost time: 0.8544201850891113
Epoch: 58, Steps: 64 | Train Loss: 0.1277978 Vali Loss: 0.1904131 Test Loss: 0.2529984
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 59 cost time: 0.8604369163513184
Epoch: 59, Steps: 64 | Train Loss: 0.1281666 Vali Loss: 0.1903756 Test Loss: 0.2535262
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 60 cost time: 0.8537271022796631
Epoch: 60, Steps: 64 | Train Loss: 0.1274259 Vali Loss: 0.1897569 Test Loss: 0.2537026
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2525128424167633, mae:0.36699607968330383, rse:0.25466886162757874
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 1 cost time: 2.318488597869873
Epoch: 1, Steps: 64 | Train Loss: 0.8932693 Vali Loss: 2.3760762 Test Loss: 3.7891438
Validation loss decreased (inf --> 2.376076).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 2 cost time: 0.9486021995544434
Epoch: 2, Steps: 64 | Train Loss: 0.5817739 Vali Loss: 0.6497603 Test Loss: 0.9709230
Validation loss decreased (2.376076 --> 0.649760).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 3 cost time: 0.8774638175964355
Epoch: 3, Steps: 64 | Train Loss: 0.1924456 Vali Loss: 0.1967891 Test Loss: 0.2251259
Validation loss decreased (0.649760 --> 0.196789).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 4 cost time: 0.894871711730957
Epoch: 4, Steps: 64 | Train Loss: 0.1435012 Vali Loss: 0.1967840 Test Loss: 0.2334452
Validation loss decreased (0.196789 --> 0.196784).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 5 cost time: 0.8903696537017822
Epoch: 5, Steps: 64 | Train Loss: 0.1374765 Vali Loss: 0.1909584 Test Loss: 0.2357816
Validation loss decreased (0.196784 --> 0.190958).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 6 cost time: 0.8943593502044678
Epoch: 6, Steps: 64 | Train Loss: 0.1327354 Vali Loss: 0.1848677 Test Loss: 0.2289860
Validation loss decreased (0.190958 --> 0.184868).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 7 cost time: 0.8884203433990479
Epoch: 7, Steps: 64 | Train Loss: 0.1304425 Vali Loss: 0.1841571 Test Loss: 0.2318183
Validation loss decreased (0.184868 --> 0.184157).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 8 cost time: 0.8849997520446777
Epoch: 8, Steps: 64 | Train Loss: 0.1274645 Vali Loss: 0.1830507 Test Loss: 0.2295339
Validation loss decreased (0.184157 --> 0.183051).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 9 cost time: 0.8836266994476318
Epoch: 9, Steps: 64 | Train Loss: 0.1261763 Vali Loss: 0.1802369 Test Loss: 0.2285370
Validation loss decreased (0.183051 --> 0.180237).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 10 cost time: 0.9023880958557129
Epoch: 10, Steps: 64 | Train Loss: 0.1254141 Vali Loss: 0.1791548 Test Loss: 0.2285979
Validation loss decreased (0.180237 --> 0.179155).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 11 cost time: 0.8904268741607666
Epoch: 11, Steps: 64 | Train Loss: 0.1239090 Vali Loss: 0.1754891 Test Loss: 0.2269845
Validation loss decreased (0.179155 --> 0.175489).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 12 cost time: 0.890174150466919
Epoch: 12, Steps: 64 | Train Loss: 0.1226045 Vali Loss: 0.1783990 Test Loss: 0.2284186
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 13 cost time: 0.8924944400787354
Epoch: 13, Steps: 64 | Train Loss: 0.1217167 Vali Loss: 0.1739376 Test Loss: 0.2283651
Validation loss decreased (0.175489 --> 0.173938).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 14 cost time: 0.887732982635498
Epoch: 14, Steps: 64 | Train Loss: 0.1212429 Vali Loss: 0.1736571 Test Loss: 0.2270700
Validation loss decreased (0.173938 --> 0.173657).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 15 cost time: 0.8859996795654297
Epoch: 15, Steps: 64 | Train Loss: 0.1203371 Vali Loss: 0.1763943 Test Loss: 0.2286295
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 16 cost time: 0.8856179714202881
Epoch: 16, Steps: 64 | Train Loss: 0.1208362 Vali Loss: 0.1736684 Test Loss: 0.2277569
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 17 cost time: 0.894230842590332
Epoch: 17, Steps: 64 | Train Loss: 0.1196515 Vali Loss: 0.1741939 Test Loss: 0.2276988
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 18 cost time: 0.8864409923553467
Epoch: 18, Steps: 64 | Train Loss: 0.1187401 Vali Loss: 0.1716382 Test Loss: 0.2268685
Validation loss decreased (0.173657 --> 0.171638).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 19 cost time: 0.8894999027252197
Epoch: 19, Steps: 64 | Train Loss: 0.1186393 Vali Loss: 0.1713438 Test Loss: 0.2275342
Validation loss decreased (0.171638 --> 0.171344).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 20 cost time: 0.8978304862976074
Epoch: 20, Steps: 64 | Train Loss: 0.1181383 Vali Loss: 0.1744684 Test Loss: 0.2278669
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 21 cost time: 0.8874008655548096
Epoch: 21, Steps: 64 | Train Loss: 0.1185300 Vali Loss: 0.1751095 Test Loss: 0.2288533
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 22 cost time: 0.8856182098388672
Epoch: 22, Steps: 64 | Train Loss: 0.1173665 Vali Loss: 0.1730094 Test Loss: 0.2290685
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 23 cost time: 0.8833434581756592
Epoch: 23, Steps: 64 | Train Loss: 0.1180792 Vali Loss: 0.1730197 Test Loss: 0.2279126
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 24 cost time: 0.8824248313903809
Epoch: 24, Steps: 64 | Train Loss: 0.1173876 Vali Loss: 0.1716523 Test Loss: 0.2284322
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 25 cost time: 0.882500171661377
Epoch: 25, Steps: 64 | Train Loss: 0.1169000 Vali Loss: 0.1716789 Test Loss: 0.2280377
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 26 cost time: 0.8827149868011475
Epoch: 26, Steps: 64 | Train Loss: 0.1177343 Vali Loss: 0.1735252 Test Loss: 0.2282433
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 27 cost time: 0.8860001564025879
Epoch: 27, Steps: 64 | Train Loss: 0.1167091 Vali Loss: 0.1745940 Test Loss: 0.2284655
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 28 cost time: 0.879692792892456
Epoch: 28, Steps: 64 | Train Loss: 0.1164330 Vali Loss: 0.1742080 Test Loss: 0.2279878
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 29 cost time: 0.8843519687652588
Epoch: 29, Steps: 64 | Train Loss: 0.1166557 Vali Loss: 0.1728165 Test Loss: 0.2288945
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 30 cost time: 0.8873920440673828
Epoch: 30, Steps: 64 | Train Loss: 0.1168437 Vali Loss: 0.1725408 Test Loss: 0.2284034
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 31 cost time: 0.8923935890197754
Epoch: 31, Steps: 64 | Train Loss: 0.1162988 Vali Loss: 0.1729383 Test Loss: 0.2298782
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 32 cost time: 0.8859272003173828
Epoch: 32, Steps: 64 | Train Loss: 0.1159166 Vali Loss: 0.1714764 Test Loss: 0.2277117
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 33 cost time: 0.8850002288818359
Epoch: 33, Steps: 64 | Train Loss: 0.1161550 Vali Loss: 0.1725928 Test Loss: 0.2281121
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 34 cost time: 0.8873798847198486
Epoch: 34, Steps: 64 | Train Loss: 0.1158142 Vali Loss: 0.1726439 Test Loss: 0.2287551
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 35 cost time: 0.8983240127563477
Epoch: 35, Steps: 64 | Train Loss: 0.1163744 Vali Loss: 0.1715841 Test Loss: 0.2286145
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 36 cost time: 0.904364824295044
Epoch: 36, Steps: 64 | Train Loss: 0.1154457 Vali Loss: 0.1708243 Test Loss: 0.2279390
Validation loss decreased (0.171344 --> 0.170824).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 37 cost time: 0.9073312282562256
Epoch: 37, Steps: 64 | Train Loss: 0.1163210 Vali Loss: 0.1716142 Test Loss: 0.2288206
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 38 cost time: 0.9133384227752686
Epoch: 38, Steps: 64 | Train Loss: 0.1155676 Vali Loss: 0.1715560 Test Loss: 0.2282629
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 39 cost time: 0.9053199291229248
Epoch: 39, Steps: 64 | Train Loss: 0.1153989 Vali Loss: 0.1711352 Test Loss: 0.2293815
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 40 cost time: 0.9089996814727783
Epoch: 40, Steps: 64 | Train Loss: 0.1158749 Vali Loss: 0.1717297 Test Loss: 0.2287842
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 41 cost time: 0.9045977592468262
Epoch: 41, Steps: 64 | Train Loss: 0.1159500 Vali Loss: 0.1724539 Test Loss: 0.2290312
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 42 cost time: 0.8943665027618408
Epoch: 42, Steps: 64 | Train Loss: 0.1159945 Vali Loss: 0.1736383 Test Loss: 0.2295512
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 43 cost time: 0.8852624893188477
Epoch: 43, Steps: 64 | Train Loss: 0.1151449 Vali Loss: 0.1725492 Test Loss: 0.2286464
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 44 cost time: 0.8823914527893066
Epoch: 44, Steps: 64 | Train Loss: 0.1152537 Vali Loss: 0.1728645 Test Loss: 0.2288432
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 45 cost time: 0.8918523788452148
Epoch: 45, Steps: 64 | Train Loss: 0.1154779 Vali Loss: 0.1725272 Test Loss: 0.2292148
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 46 cost time: 0.8889999389648438
Epoch: 46, Steps: 64 | Train Loss: 0.1155500 Vali Loss: 0.1738573 Test Loss: 0.2300456
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 47 cost time: 0.8864250183105469
Epoch: 47, Steps: 64 | Train Loss: 0.1151648 Vali Loss: 0.1714573 Test Loss: 0.2293780
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 48 cost time: 0.8823866844177246
Epoch: 48, Steps: 64 | Train Loss: 0.1158739 Vali Loss: 0.1728289 Test Loss: 0.2299365
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 49 cost time: 0.8693556785583496
Epoch: 49, Steps: 64 | Train Loss: 0.1148103 Vali Loss: 0.1717537 Test Loss: 0.2276550
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 50 cost time: 0.9543712139129639
Epoch: 50, Steps: 64 | Train Loss: 0.1150903 Vali Loss: 0.1725068 Test Loss: 0.2298437
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 51 cost time: 0.9534769058227539
Epoch: 51, Steps: 64 | Train Loss: 0.1152317 Vali Loss: 0.1733615 Test Loss: 0.2300072
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 52 cost time: 0.9393417835235596
Epoch: 52, Steps: 64 | Train Loss: 0.1155209 Vali Loss: 0.1727221 Test Loss: 0.2294574
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 53 cost time: 0.8660001754760742
Epoch: 53, Steps: 64 | Train Loss: 0.1153975 Vali Loss: 0.1703521 Test Loss: 0.2284503
Validation loss decreased (0.170824 --> 0.170352).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 54 cost time: 0.8870820999145508
Epoch: 54, Steps: 64 | Train Loss: 0.1155730 Vali Loss: 0.1723848 Test Loss: 0.2301153
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 55 cost time: 0.8884179592132568
Epoch: 55, Steps: 64 | Train Loss: 0.1159574 Vali Loss: 0.1711037 Test Loss: 0.2294640
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 56 cost time: 0.8983652591705322
Epoch: 56, Steps: 64 | Train Loss: 0.1150995 Vali Loss: 0.1721554 Test Loss: 0.2302270
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 57 cost time: 0.8865282535552979
Epoch: 57, Steps: 64 | Train Loss: 0.1152073 Vali Loss: 0.1727279 Test Loss: 0.2297622
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 58 cost time: 0.8847525119781494
Epoch: 58, Steps: 64 | Train Loss: 0.1153090 Vali Loss: 0.1713782 Test Loss: 0.2295319
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 59 cost time: 0.8910007476806641
Epoch: 59, Steps: 64 | Train Loss: 0.1151202 Vali Loss: 0.1727258 Test Loss: 0.2300296
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 60 cost time: 0.8827707767486572
Epoch: 60, Steps: 64 | Train Loss: 0.1155603 Vali Loss: 0.1730117 Test Loss: 0.2291458
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22845037281513214, mae:0.3414831757545471, rse:0.24223119020462036
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05301189422607422 GB
Epoch: 1 cost time: 2.3310158252716064
Epoch: 1, Steps: 64 | Train Loss: 0.8724523 Vali Loss: 2.3629940 Test Loss: 3.7790172
Validation loss decreased (inf --> 2.362994).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 2 cost time: 0.9183311462402344
Epoch: 2, Steps: 64 | Train Loss: 0.4900019 Vali Loss: 0.2207313 Test Loss: 0.2567196
Validation loss decreased (2.362994 --> 0.220731).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 3 cost time: 0.9136242866516113
Epoch: 3, Steps: 64 | Train Loss: 0.1539726 Vali Loss: 0.2158823 Test Loss: 0.2575003
Validation loss decreased (0.220731 --> 0.215882).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 4 cost time: 0.9265446662902832
Epoch: 4, Steps: 64 | Train Loss: 0.1371326 Vali Loss: 0.1882652 Test Loss: 0.2261423
Validation loss decreased (0.215882 --> 0.188265).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 5 cost time: 0.916818380355835
Epoch: 5, Steps: 64 | Train Loss: 0.1324018 Vali Loss: 0.1869157 Test Loss: 0.2321878
Validation loss decreased (0.188265 --> 0.186916).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 6 cost time: 0.9177343845367432
Epoch: 6, Steps: 64 | Train Loss: 0.1294760 Vali Loss: 0.1803019 Test Loss: 0.2294628
Validation loss decreased (0.186916 --> 0.180302).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 7 cost time: 0.9169998168945312
Epoch: 7, Steps: 64 | Train Loss: 0.1269156 Vali Loss: 0.1806155 Test Loss: 0.2307728
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 8 cost time: 0.9176278114318848
Epoch: 8, Steps: 64 | Train Loss: 0.1247090 Vali Loss: 0.1754437 Test Loss: 0.2269806
Validation loss decreased (0.180302 --> 0.175444).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 9 cost time: 0.9154269695281982
Epoch: 9, Steps: 64 | Train Loss: 0.1233614 Vali Loss: 0.1757638 Test Loss: 0.2286544
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 10 cost time: 0.9160773754119873
Epoch: 10, Steps: 64 | Train Loss: 0.1228884 Vali Loss: 0.1756373 Test Loss: 0.2292632
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 11 cost time: 0.9143509864807129
Epoch: 11, Steps: 64 | Train Loss: 0.1217954 Vali Loss: 0.1778167 Test Loss: 0.2323698
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 12 cost time: 0.9154262542724609
Epoch: 12, Steps: 64 | Train Loss: 0.1211701 Vali Loss: 0.1757148 Test Loss: 0.2293750
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 13 cost time: 0.9294230937957764
Epoch: 13, Steps: 64 | Train Loss: 0.1207522 Vali Loss: 0.1752908 Test Loss: 0.2293964
Validation loss decreased (0.175444 --> 0.175291).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 14 cost time: 0.9162101745605469
Epoch: 14, Steps: 64 | Train Loss: 0.1194384 Vali Loss: 0.1742293 Test Loss: 0.2288817
Validation loss decreased (0.175291 --> 0.174229).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 15 cost time: 0.9149999618530273
Epoch: 15, Steps: 64 | Train Loss: 0.1195955 Vali Loss: 0.1755287 Test Loss: 0.2302192
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 16 cost time: 0.9156198501586914
Epoch: 16, Steps: 64 | Train Loss: 0.1185128 Vali Loss: 0.1726085 Test Loss: 0.2287902
Validation loss decreased (0.174229 --> 0.172609).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 17 cost time: 0.915424108505249
Epoch: 17, Steps: 64 | Train Loss: 0.1186901 Vali Loss: 0.1725191 Test Loss: 0.2302438
Validation loss decreased (0.172609 --> 0.172519).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 18 cost time: 0.9164073467254639
Epoch: 18, Steps: 64 | Train Loss: 0.1178126 Vali Loss: 0.1737931 Test Loss: 0.2309736
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 19 cost time: 0.9174602031707764
Epoch: 19, Steps: 64 | Train Loss: 0.1172645 Vali Loss: 0.1725122 Test Loss: 0.2287265
Validation loss decreased (0.172519 --> 0.172512).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 20 cost time: 0.9323818683624268
Epoch: 20, Steps: 64 | Train Loss: 0.1170876 Vali Loss: 0.1702446 Test Loss: 0.2289190
Validation loss decreased (0.172512 --> 0.170245).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 21 cost time: 0.9257388114929199
Epoch: 21, Steps: 64 | Train Loss: 0.1170068 Vali Loss: 0.1717578 Test Loss: 0.2304107
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 22 cost time: 0.9223988056182861
Epoch: 22, Steps: 64 | Train Loss: 0.1163841 Vali Loss: 0.1730849 Test Loss: 0.2316283
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 23 cost time: 0.9210007190704346
Epoch: 23, Steps: 64 | Train Loss: 0.1164980 Vali Loss: 0.1715161 Test Loss: 0.2299156
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 24 cost time: 0.896028995513916
Epoch: 24, Steps: 64 | Train Loss: 0.1162582 Vali Loss: 0.1717846 Test Loss: 0.2310003
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 25 cost time: 0.9103226661682129
Epoch: 25, Steps: 64 | Train Loss: 0.1163984 Vali Loss: 0.1716607 Test Loss: 0.2311730
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 26 cost time: 0.9120817184448242
Epoch: 26, Steps: 64 | Train Loss: 0.1160425 Vali Loss: 0.1714080 Test Loss: 0.2309519
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 27 cost time: 0.9053041934967041
Epoch: 27, Steps: 64 | Train Loss: 0.1159374 Vali Loss: 0.1711369 Test Loss: 0.2304518
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 28 cost time: 0.9158501625061035
Epoch: 28, Steps: 64 | Train Loss: 0.1158950 Vali Loss: 0.1715055 Test Loss: 0.2312020
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 29 cost time: 0.9151170253753662
Epoch: 29, Steps: 64 | Train Loss: 0.1151598 Vali Loss: 0.1712485 Test Loss: 0.2314530
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 30 cost time: 0.9259991645812988
Epoch: 30, Steps: 64 | Train Loss: 0.1151076 Vali Loss: 0.1716059 Test Loss: 0.2301843
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 31 cost time: 0.9029185771942139
Epoch: 31, Steps: 64 | Train Loss: 0.1157706 Vali Loss: 0.1706415 Test Loss: 0.2315402
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 32 cost time: 0.9233574867248535
Epoch: 32, Steps: 64 | Train Loss: 0.1151347 Vali Loss: 0.1710946 Test Loss: 0.2313786
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 33 cost time: 0.9139997959136963
Epoch: 33, Steps: 64 | Train Loss: 0.1148485 Vali Loss: 0.1716602 Test Loss: 0.2314119
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 34 cost time: 0.9220001697540283
Epoch: 34, Steps: 64 | Train Loss: 0.1150685 Vali Loss: 0.1720001 Test Loss: 0.2316600
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 35 cost time: 0.9179897308349609
Epoch: 35, Steps: 64 | Train Loss: 0.1151925 Vali Loss: 0.1713158 Test Loss: 0.2315551
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 36 cost time: 0.9139997959136963
Epoch: 36, Steps: 64 | Train Loss: 0.1150536 Vali Loss: 0.1706797 Test Loss: 0.2305916
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 37 cost time: 0.9286060333251953
Epoch: 37, Steps: 64 | Train Loss: 0.1150458 Vali Loss: 0.1701992 Test Loss: 0.2305911
Validation loss decreased (0.170245 --> 0.170199).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 38 cost time: 0.9166271686553955
Epoch: 38, Steps: 64 | Train Loss: 0.1150539 Vali Loss: 0.1713838 Test Loss: 0.2313416
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 39 cost time: 0.9147791862487793
Epoch: 39, Steps: 64 | Train Loss: 0.1145949 Vali Loss: 0.1707837 Test Loss: 0.2311811
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 40 cost time: 0.9130001068115234
Epoch: 40, Steps: 64 | Train Loss: 0.1149016 Vali Loss: 0.1682536 Test Loss: 0.2312579
Validation loss decreased (0.170199 --> 0.168254).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 41 cost time: 0.9265413284301758
Epoch: 41, Steps: 64 | Train Loss: 0.1148095 Vali Loss: 0.1705683 Test Loss: 0.2313652
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 42 cost time: 0.9109997749328613
Epoch: 42, Steps: 64 | Train Loss: 0.1145411 Vali Loss: 0.1703177 Test Loss: 0.2316289
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 43 cost time: 0.9079997539520264
Epoch: 43, Steps: 64 | Train Loss: 0.1143353 Vali Loss: 0.1705353 Test Loss: 0.2314517
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 44 cost time: 0.917625904083252
Epoch: 44, Steps: 64 | Train Loss: 0.1149224 Vali Loss: 0.1711407 Test Loss: 0.2313872
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 45 cost time: 0.9446210861206055
Epoch: 45, Steps: 64 | Train Loss: 0.1150618 Vali Loss: 0.1710559 Test Loss: 0.2321665
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 46 cost time: 0.9140529632568359
Epoch: 46, Steps: 64 | Train Loss: 0.1146248 Vali Loss: 0.1706173 Test Loss: 0.2318762
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 47 cost time: 0.9134130477905273
Epoch: 47, Steps: 64 | Train Loss: 0.1148376 Vali Loss: 0.1704060 Test Loss: 0.2314696
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 48 cost time: 0.8964128494262695
Epoch: 48, Steps: 64 | Train Loss: 0.1146018 Vali Loss: 0.1714151 Test Loss: 0.2315994
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 49 cost time: 0.9083819389343262
Epoch: 49, Steps: 64 | Train Loss: 0.1146410 Vali Loss: 0.1701573 Test Loss: 0.2318361
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 50 cost time: 0.910752534866333
Epoch: 50, Steps: 64 | Train Loss: 0.1148125 Vali Loss: 0.1704541 Test Loss: 0.2323738
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 51 cost time: 0.9127597808837891
Epoch: 51, Steps: 64 | Train Loss: 0.1139965 Vali Loss: 0.1697314 Test Loss: 0.2315971
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 52 cost time: 0.9143226146697998
Epoch: 52, Steps: 64 | Train Loss: 0.1147429 Vali Loss: 0.1693324 Test Loss: 0.2314442
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 53 cost time: 0.9116160869598389
Epoch: 53, Steps: 64 | Train Loss: 0.1148482 Vali Loss: 0.1695126 Test Loss: 0.2315290
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 54 cost time: 0.9123325347900391
Epoch: 54, Steps: 64 | Train Loss: 0.1141115 Vali Loss: 0.1693460 Test Loss: 0.2313059
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 55 cost time: 0.9195029735565186
Epoch: 55, Steps: 64 | Train Loss: 0.1143086 Vali Loss: 0.1703425 Test Loss: 0.2322344
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 56 cost time: 0.9132468700408936
Epoch: 56, Steps: 64 | Train Loss: 0.1141374 Vali Loss: 0.1711124 Test Loss: 0.2324107
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 57 cost time: 0.909407377243042
Epoch: 57, Steps: 64 | Train Loss: 0.1143854 Vali Loss: 0.1713103 Test Loss: 0.2310103
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 58 cost time: 0.9237301349639893
Epoch: 58, Steps: 64 | Train Loss: 0.1146197 Vali Loss: 0.1700451 Test Loss: 0.2314945
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 59 cost time: 0.9140000343322754
Epoch: 59, Steps: 64 | Train Loss: 0.1146168 Vali Loss: 0.1719616 Test Loss: 0.2317880
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 60 cost time: 0.912630558013916
Epoch: 60, Steps: 64 | Train Loss: 0.1145106 Vali Loss: 0.1699169 Test Loss: 0.2324320
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23125794529914856, mae:0.3473202586174011, rse:0.24371512234210968
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04588603973388672 GB
Epoch: 1 cost time: 2.227851390838623
Epoch: 1, Steps: 64 | Train Loss: 0.9257953 Vali Loss: 2.3895884 Test Loss: 3.8019505
Validation loss decreased (inf --> 2.389588).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 2 cost time: 0.8625814914703369
Epoch: 2, Steps: 64 | Train Loss: 0.7944244 Vali Loss: 1.7201133 Test Loss: 2.7007296
Validation loss decreased (2.389588 --> 1.720113).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 3 cost time: 0.8639950752258301
Epoch: 3, Steps: 64 | Train Loss: 0.6021354 Vali Loss: 1.2586844 Test Loss: 1.9277323
Validation loss decreased (1.720113 --> 1.258684).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 4 cost time: 0.862755298614502
Epoch: 4, Steps: 64 | Train Loss: 0.4591934 Vali Loss: 0.9463466 Test Loss: 1.4137827
Validation loss decreased (1.258684 --> 0.946347).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 5 cost time: 0.876000165939331
Epoch: 5, Steps: 64 | Train Loss: 0.3609975 Vali Loss: 0.7415385 Test Loss: 1.0851667
Validation loss decreased (0.946347 --> 0.741539).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 6 cost time: 0.8600313663482666
Epoch: 6, Steps: 64 | Train Loss: 0.2948569 Vali Loss: 0.6001220 Test Loss: 0.8577288
Validation loss decreased (0.741539 --> 0.600122).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 7 cost time: 0.8584175109863281
Epoch: 7, Steps: 64 | Train Loss: 0.2504329 Vali Loss: 0.5014190 Test Loss: 0.7028418
Validation loss decreased (0.600122 --> 0.501419).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 8 cost time: 0.8585326671600342
Epoch: 8, Steps: 64 | Train Loss: 0.2205645 Vali Loss: 0.4247546 Test Loss: 0.5862487
Validation loss decreased (0.501419 --> 0.424755).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 9 cost time: 0.8522586822509766
Epoch: 9, Steps: 64 | Train Loss: 0.1983377 Vali Loss: 0.3717730 Test Loss: 0.5044290
Validation loss decreased (0.424755 --> 0.371773).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 10 cost time: 0.8620693683624268
Epoch: 10, Steps: 64 | Train Loss: 0.1832591 Vali Loss: 0.3305493 Test Loss: 0.4458225
Validation loss decreased (0.371773 --> 0.330549).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 11 cost time: 0.8666207790374756
Epoch: 11, Steps: 64 | Train Loss: 0.1716194 Vali Loss: 0.2973438 Test Loss: 0.3953270
Validation loss decreased (0.330549 --> 0.297344).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 12 cost time: 0.8606221675872803
Epoch: 12, Steps: 64 | Train Loss: 0.1633972 Vali Loss: 0.2779128 Test Loss: 0.3686773
Validation loss decreased (0.297344 --> 0.277913).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 13 cost time: 0.8663861751556396
Epoch: 13, Steps: 64 | Train Loss: 0.1562700 Vali Loss: 0.2601167 Test Loss: 0.3424303
Validation loss decreased (0.277913 --> 0.260117).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 14 cost time: 0.8643832206726074
Epoch: 14, Steps: 64 | Train Loss: 0.1517615 Vali Loss: 0.2509129 Test Loss: 0.3256705
Validation loss decreased (0.260117 --> 0.250913).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 15 cost time: 0.8623824119567871
Epoch: 15, Steps: 64 | Train Loss: 0.1467529 Vali Loss: 0.2389235 Test Loss: 0.3095587
Validation loss decreased (0.250913 --> 0.238923).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 16 cost time: 0.8700001239776611
Epoch: 16, Steps: 64 | Train Loss: 0.1438842 Vali Loss: 0.2314937 Test Loss: 0.3000393
Validation loss decreased (0.238923 --> 0.231494).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 17 cost time: 0.8611161708831787
Epoch: 17, Steps: 64 | Train Loss: 0.1419027 Vali Loss: 0.2247579 Test Loss: 0.2905520
Validation loss decreased (0.231494 --> 0.224758).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 18 cost time: 0.8573546409606934
Epoch: 18, Steps: 64 | Train Loss: 0.1394899 Vali Loss: 0.2184478 Test Loss: 0.2830359
Validation loss decreased (0.224758 --> 0.218448).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 19 cost time: 0.8584954738616943
Epoch: 19, Steps: 64 | Train Loss: 0.1380267 Vali Loss: 0.2127528 Test Loss: 0.2750227
Validation loss decreased (0.218448 --> 0.212753).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 20 cost time: 0.8750019073486328
Epoch: 20, Steps: 64 | Train Loss: 0.1362857 Vali Loss: 0.2109336 Test Loss: 0.2734932
Validation loss decreased (0.212753 --> 0.210934).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 21 cost time: 0.8617796897888184
Epoch: 21, Steps: 64 | Train Loss: 0.1354491 Vali Loss: 0.2081582 Test Loss: 0.2684618
Validation loss decreased (0.210934 --> 0.208158).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 22 cost time: 0.872999906539917
Epoch: 22, Steps: 64 | Train Loss: 0.1348520 Vali Loss: 0.2049521 Test Loss: 0.2631854
Validation loss decreased (0.208158 --> 0.204952).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 23 cost time: 0.8750004768371582
Epoch: 23, Steps: 64 | Train Loss: 0.1327493 Vali Loss: 0.2032282 Test Loss: 0.2594160
Validation loss decreased (0.204952 --> 0.203228).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 24 cost time: 0.8320324420928955
Epoch: 24, Steps: 64 | Train Loss: 0.1332291 Vali Loss: 0.2000846 Test Loss: 0.2587861
Validation loss decreased (0.203228 --> 0.200085).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 25 cost time: 0.8603940010070801
Epoch: 25, Steps: 64 | Train Loss: 0.1321969 Vali Loss: 0.1994562 Test Loss: 0.2564325
Validation loss decreased (0.200085 --> 0.199456).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 26 cost time: 0.856809139251709
Epoch: 26, Steps: 64 | Train Loss: 0.1315687 Vali Loss: 0.1992722 Test Loss: 0.2549861
Validation loss decreased (0.199456 --> 0.199272).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 27 cost time: 0.8608348369598389
Epoch: 27, Steps: 64 | Train Loss: 0.1309623 Vali Loss: 0.1984496 Test Loss: 0.2559122
Validation loss decreased (0.199272 --> 0.198450).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 28 cost time: 0.8596348762512207
Epoch: 28, Steps: 64 | Train Loss: 0.1306939 Vali Loss: 0.1956694 Test Loss: 0.2525766
Validation loss decreased (0.198450 --> 0.195669).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 29 cost time: 0.8652482032775879
Epoch: 29, Steps: 64 | Train Loss: 0.1308482 Vali Loss: 0.1957164 Test Loss: 0.2512684
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 30 cost time: 0.8654866218566895
Epoch: 30, Steps: 64 | Train Loss: 0.1297994 Vali Loss: 0.1939398 Test Loss: 0.2481454
Validation loss decreased (0.195669 --> 0.193940).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 31 cost time: 0.8633933067321777
Epoch: 31, Steps: 64 | Train Loss: 0.1287257 Vali Loss: 0.1917660 Test Loss: 0.2484806
Validation loss decreased (0.193940 --> 0.191766).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 32 cost time: 0.890000581741333
Epoch: 32, Steps: 64 | Train Loss: 0.1293369 Vali Loss: 0.1908129 Test Loss: 0.2457078
Validation loss decreased (0.191766 --> 0.190813).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 33 cost time: 0.859400749206543
Epoch: 33, Steps: 64 | Train Loss: 0.1298129 Vali Loss: 0.1911594 Test Loss: 0.2448976
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 34 cost time: 0.8666291236877441
Epoch: 34, Steps: 64 | Train Loss: 0.1286247 Vali Loss: 0.1915513 Test Loss: 0.2454319
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 35 cost time: 0.8563597202301025
Epoch: 35, Steps: 64 | Train Loss: 0.1285763 Vali Loss: 0.1916688 Test Loss: 0.2442049
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 36 cost time: 0.8554019927978516
Epoch: 36, Steps: 64 | Train Loss: 0.1287926 Vali Loss: 0.1914107 Test Loss: 0.2453797
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 37 cost time: 0.8657810688018799
Epoch: 37, Steps: 64 | Train Loss: 0.1285636 Vali Loss: 0.1903002 Test Loss: 0.2446222
Validation loss decreased (0.190813 --> 0.190300).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 38 cost time: 0.871626615524292
Epoch: 38, Steps: 64 | Train Loss: 0.1281244 Vali Loss: 0.1908899 Test Loss: 0.2448220
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 39 cost time: 0.8656189441680908
Epoch: 39, Steps: 64 | Train Loss: 0.1279600 Vali Loss: 0.1905288 Test Loss: 0.2433666
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 40 cost time: 0.8594241142272949
Epoch: 40, Steps: 64 | Train Loss: 0.1285094 Vali Loss: 0.1901966 Test Loss: 0.2443588
Validation loss decreased (0.190300 --> 0.190197).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 41 cost time: 0.870347261428833
Epoch: 41, Steps: 64 | Train Loss: 0.1283245 Vali Loss: 0.1895039 Test Loss: 0.2431437
Validation loss decreased (0.190197 --> 0.189504).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 42 cost time: 0.8710737228393555
Epoch: 42, Steps: 64 | Train Loss: 0.1272602 Vali Loss: 0.1883646 Test Loss: 0.2426849
Validation loss decreased (0.189504 --> 0.188365).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 43 cost time: 0.86326003074646
Epoch: 43, Steps: 64 | Train Loss: 0.1276454 Vali Loss: 0.1883097 Test Loss: 0.2418939
Validation loss decreased (0.188365 --> 0.188310).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 44 cost time: 0.8600003719329834
Epoch: 44, Steps: 64 | Train Loss: 0.1285359 Vali Loss: 0.1894641 Test Loss: 0.2424241
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 45 cost time: 0.8676176071166992
Epoch: 45, Steps: 64 | Train Loss: 0.1273998 Vali Loss: 0.1878549 Test Loss: 0.2419184
Validation loss decreased (0.188310 --> 0.187855).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 46 cost time: 0.8616292476654053
Epoch: 46, Steps: 64 | Train Loss: 0.1271101 Vali Loss: 0.1884175 Test Loss: 0.2417650
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 47 cost time: 0.8616113662719727
Epoch: 47, Steps: 64 | Train Loss: 0.1279916 Vali Loss: 0.1886549 Test Loss: 0.2413653
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 48 cost time: 0.8648116588592529
Epoch: 48, Steps: 64 | Train Loss: 0.1276227 Vali Loss: 0.1871345 Test Loss: 0.2436285
Validation loss decreased (0.187855 --> 0.187135).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 49 cost time: 0.8759973049163818
Epoch: 49, Steps: 64 | Train Loss: 0.1271621 Vali Loss: 0.1878251 Test Loss: 0.2414240
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 50 cost time: 0.8950002193450928
Epoch: 50, Steps: 64 | Train Loss: 0.1274719 Vali Loss: 0.1882370 Test Loss: 0.2434167
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 51 cost time: 0.8570578098297119
Epoch: 51, Steps: 64 | Train Loss: 0.1269780 Vali Loss: 0.1875603 Test Loss: 0.2414436
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 52 cost time: 0.8543946743011475
Epoch: 52, Steps: 64 | Train Loss: 0.1271383 Vali Loss: 0.1877307 Test Loss: 0.2416219
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 53 cost time: 0.8651103973388672
Epoch: 53, Steps: 64 | Train Loss: 0.1273364 Vali Loss: 0.1880832 Test Loss: 0.2409170
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 54 cost time: 0.858734130859375
Epoch: 54, Steps: 64 | Train Loss: 0.1270342 Vali Loss: 0.1890696 Test Loss: 0.2416224
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 55 cost time: 0.8580002784729004
Epoch: 55, Steps: 64 | Train Loss: 0.1280297 Vali Loss: 0.1877847 Test Loss: 0.2406771
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 56 cost time: 0.8730497360229492
Epoch: 56, Steps: 64 | Train Loss: 0.1277504 Vali Loss: 0.1892366 Test Loss: 0.2415580
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 57 cost time: 0.8654568195343018
Epoch: 57, Steps: 64 | Train Loss: 0.1278491 Vali Loss: 0.1867919 Test Loss: 0.2406546
Validation loss decreased (0.187135 --> 0.186792).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 58 cost time: 0.8703899383544922
Epoch: 58, Steps: 64 | Train Loss: 0.1276212 Vali Loss: 0.1856965 Test Loss: 0.2394130
Validation loss decreased (0.186792 --> 0.185696).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 59 cost time: 0.8627057075500488
Epoch: 59, Steps: 64 | Train Loss: 0.1278179 Vali Loss: 0.1875816 Test Loss: 0.2406105
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 60 cost time: 0.8700015544891357
Epoch: 60, Steps: 64 | Train Loss: 0.1273975 Vali Loss: 0.1869945 Test Loss: 0.2411078
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23941297829151154, mae:0.3577810823917389, rse:0.24797505140304565
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 1 cost time: 2.2970335483551025
Epoch: 1, Steps: 64 | Train Loss: 0.8731466 Vali Loss: 2.3338101 Test Loss: 3.6899068
Validation loss decreased (inf --> 2.333810).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 2 cost time: 0.8940484523773193
Epoch: 2, Steps: 64 | Train Loss: 0.5828618 Vali Loss: 0.6465993 Test Loss: 0.9254044
Validation loss decreased (2.333810 --> 0.646599).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 3 cost time: 0.8963594436645508
Epoch: 3, Steps: 64 | Train Loss: 0.1976914 Vali Loss: 0.2077618 Test Loss: 0.2366043
Validation loss decreased (0.646599 --> 0.207762).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 4 cost time: 0.8942534923553467
Epoch: 4, Steps: 64 | Train Loss: 0.1467305 Vali Loss: 0.1968469 Test Loss: 0.2365591
Validation loss decreased (0.207762 --> 0.196847).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 5 cost time: 0.8944361209869385
Epoch: 5, Steps: 64 | Train Loss: 0.1381783 Vali Loss: 0.1883670 Test Loss: 0.2329294
Validation loss decreased (0.196847 --> 0.188367).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 6 cost time: 0.8922626972198486
Epoch: 6, Steps: 64 | Train Loss: 0.1338250 Vali Loss: 0.1821521 Test Loss: 0.2291675
Validation loss decreased (0.188367 --> 0.182152).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 7 cost time: 0.9020023345947266
Epoch: 7, Steps: 64 | Train Loss: 0.1316116 Vali Loss: 0.1826630 Test Loss: 0.2269613
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 8 cost time: 0.8939998149871826
Epoch: 8, Steps: 64 | Train Loss: 0.1282270 Vali Loss: 0.1772407 Test Loss: 0.2270869
Validation loss decreased (0.182152 --> 0.177241).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 9 cost time: 0.8970534801483154
Epoch: 9, Steps: 64 | Train Loss: 0.1270196 Vali Loss: 0.1744284 Test Loss: 0.2270941
Validation loss decreased (0.177241 --> 0.174428).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 10 cost time: 0.8983423709869385
Epoch: 10, Steps: 64 | Train Loss: 0.1252688 Vali Loss: 0.1735910 Test Loss: 0.2250054
Validation loss decreased (0.174428 --> 0.173591).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 11 cost time: 0.9009737968444824
Epoch: 11, Steps: 64 | Train Loss: 0.1243308 Vali Loss: 0.1737832 Test Loss: 0.2261496
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 12 cost time: 0.8993754386901855
Epoch: 12, Steps: 64 | Train Loss: 0.1235702 Vali Loss: 0.1745378 Test Loss: 0.2249462
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 13 cost time: 0.9017724990844727
Epoch: 13, Steps: 64 | Train Loss: 0.1221673 Vali Loss: 0.1720767 Test Loss: 0.2249185
Validation loss decreased (0.173591 --> 0.172077).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 14 cost time: 0.9109997749328613
Epoch: 14, Steps: 64 | Train Loss: 0.1213145 Vali Loss: 0.1721911 Test Loss: 0.2257142
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 15 cost time: 0.893054723739624
Epoch: 15, Steps: 64 | Train Loss: 0.1214238 Vali Loss: 0.1718261 Test Loss: 0.2261661
Validation loss decreased (0.172077 --> 0.171826).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 16 cost time: 0.8976273536682129
Epoch: 16, Steps: 64 | Train Loss: 0.1201746 Vali Loss: 0.1688069 Test Loss: 0.2252465
Validation loss decreased (0.171826 --> 0.168807).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 17 cost time: 0.8933122158050537
Epoch: 17, Steps: 64 | Train Loss: 0.1208682 Vali Loss: 0.1711339 Test Loss: 0.2263588
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 18 cost time: 0.8973610401153564
Epoch: 18, Steps: 64 | Train Loss: 0.1201567 Vali Loss: 0.1709655 Test Loss: 0.2258219
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 19 cost time: 0.8973360061645508
Epoch: 19, Steps: 64 | Train Loss: 0.1194080 Vali Loss: 0.1697533 Test Loss: 0.2263485
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 20 cost time: 0.8977947235107422
Epoch: 20, Steps: 64 | Train Loss: 0.1190523 Vali Loss: 0.1695519 Test Loss: 0.2257223
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 21 cost time: 0.916001558303833
Epoch: 21, Steps: 64 | Train Loss: 0.1184607 Vali Loss: 0.1684101 Test Loss: 0.2260286
Validation loss decreased (0.168807 --> 0.168410).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 22 cost time: 0.8949995040893555
Epoch: 22, Steps: 64 | Train Loss: 0.1187135 Vali Loss: 0.1682537 Test Loss: 0.2266258
Validation loss decreased (0.168410 --> 0.168254).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 23 cost time: 0.8903372287750244
Epoch: 23, Steps: 64 | Train Loss: 0.1179870 Vali Loss: 0.1672963 Test Loss: 0.2265266
Validation loss decreased (0.168254 --> 0.167296).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 24 cost time: 0.8921620845794678
Epoch: 24, Steps: 64 | Train Loss: 0.1176536 Vali Loss: 0.1691284 Test Loss: 0.2274227
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 25 cost time: 0.8914048671722412
Epoch: 25, Steps: 64 | Train Loss: 0.1180875 Vali Loss: 0.1699294 Test Loss: 0.2267547
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 26 cost time: 0.9003667831420898
Epoch: 26, Steps: 64 | Train Loss: 0.1175764 Vali Loss: 0.1679008 Test Loss: 0.2272010
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 27 cost time: 0.8860242366790771
Epoch: 27, Steps: 64 | Train Loss: 0.1174666 Vali Loss: 0.1690550 Test Loss: 0.2284831
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 28 cost time: 0.8943352699279785
Epoch: 28, Steps: 64 | Train Loss: 0.1173886 Vali Loss: 0.1673579 Test Loss: 0.2276741
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 29 cost time: 0.8966131210327148
Epoch: 29, Steps: 64 | Train Loss: 0.1172936 Vali Loss: 0.1672958 Test Loss: 0.2273003
Validation loss decreased (0.167296 --> 0.167296).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 30 cost time: 0.897449254989624
Epoch: 30, Steps: 64 | Train Loss: 0.1164912 Vali Loss: 0.1676307 Test Loss: 0.2283242
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 31 cost time: 0.8983900547027588
Epoch: 31, Steps: 64 | Train Loss: 0.1168976 Vali Loss: 0.1672661 Test Loss: 0.2280325
Validation loss decreased (0.167296 --> 0.167266).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 32 cost time: 0.8893430233001709
Epoch: 32, Steps: 64 | Train Loss: 0.1170703 Vali Loss: 0.1685856 Test Loss: 0.2278251
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 33 cost time: 0.8907346725463867
Epoch: 33, Steps: 64 | Train Loss: 0.1167739 Vali Loss: 0.1677108 Test Loss: 0.2285499
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 34 cost time: 0.8939990997314453
Epoch: 34, Steps: 64 | Train Loss: 0.1167011 Vali Loss: 0.1687229 Test Loss: 0.2281409
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 35 cost time: 0.9056153297424316
Epoch: 35, Steps: 64 | Train Loss: 0.1165790 Vali Loss: 0.1679263 Test Loss: 0.2280375
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 36 cost time: 0.9633340835571289
Epoch: 36, Steps: 64 | Train Loss: 0.1164359 Vali Loss: 0.1675473 Test Loss: 0.2281076
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 37 cost time: 0.9384143352508545
Epoch: 37, Steps: 64 | Train Loss: 0.1167990 Vali Loss: 0.1666722 Test Loss: 0.2285408
Validation loss decreased (0.167266 --> 0.166672).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 38 cost time: 0.9624292850494385
Epoch: 38, Steps: 64 | Train Loss: 0.1166903 Vali Loss: 0.1682411 Test Loss: 0.2278079
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 39 cost time: 0.9653768539428711
Epoch: 39, Steps: 64 | Train Loss: 0.1162975 Vali Loss: 0.1674209 Test Loss: 0.2279303
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 40 cost time: 0.973557710647583
Epoch: 40, Steps: 64 | Train Loss: 0.1164363 Vali Loss: 0.1675557 Test Loss: 0.2279036
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 41 cost time: 0.966968297958374
Epoch: 41, Steps: 64 | Train Loss: 0.1163671 Vali Loss: 0.1664530 Test Loss: 0.2285728
Validation loss decreased (0.166672 --> 0.166453).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 42 cost time: 0.908707857131958
Epoch: 42, Steps: 64 | Train Loss: 0.1164477 Vali Loss: 0.1675859 Test Loss: 0.2279898
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 43 cost time: 0.8980000019073486
Epoch: 43, Steps: 64 | Train Loss: 0.1163182 Vali Loss: 0.1685553 Test Loss: 0.2282649
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 44 cost time: 0.8960003852844238
Epoch: 44, Steps: 64 | Train Loss: 0.1166142 Vali Loss: 0.1659296 Test Loss: 0.2278589
Validation loss decreased (0.166453 --> 0.165930).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 45 cost time: 0.9030561447143555
Epoch: 45, Steps: 64 | Train Loss: 0.1166892 Vali Loss: 0.1677565 Test Loss: 0.2289355
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 46 cost time: 0.8993823528289795
Epoch: 46, Steps: 64 | Train Loss: 0.1162693 Vali Loss: 0.1675202 Test Loss: 0.2289201
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 47 cost time: 0.8973808288574219
Epoch: 47, Steps: 64 | Train Loss: 0.1162051 Vali Loss: 0.1668591 Test Loss: 0.2284824
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 48 cost time: 0.8993396759033203
Epoch: 48, Steps: 64 | Train Loss: 0.1161935 Vali Loss: 0.1679495 Test Loss: 0.2285113
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 49 cost time: 0.905766487121582
Epoch: 49, Steps: 64 | Train Loss: 0.1160637 Vali Loss: 0.1681485 Test Loss: 0.2285282
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 50 cost time: 0.8946282863616943
Epoch: 50, Steps: 64 | Train Loss: 0.1162952 Vali Loss: 0.1682066 Test Loss: 0.2285643
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 51 cost time: 0.898613691329956
Epoch: 51, Steps: 64 | Train Loss: 0.1165234 Vali Loss: 0.1681561 Test Loss: 0.2284056
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 52 cost time: 0.8964056968688965
Epoch: 52, Steps: 64 | Train Loss: 0.1156038 Vali Loss: 0.1672956 Test Loss: 0.2290118
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 53 cost time: 0.8927505016326904
Epoch: 53, Steps: 64 | Train Loss: 0.1161821 Vali Loss: 0.1678969 Test Loss: 0.2285713
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 54 cost time: 0.8979721069335938
Epoch: 54, Steps: 64 | Train Loss: 0.1154364 Vali Loss: 0.1684347 Test Loss: 0.2283885
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 55 cost time: 0.8953790664672852
Epoch: 55, Steps: 64 | Train Loss: 0.1163540 Vali Loss: 0.1685344 Test Loss: 0.2290051
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 56 cost time: 0.9097347259521484
Epoch: 56, Steps: 64 | Train Loss: 0.1155401 Vali Loss: 0.1678163 Test Loss: 0.2292060
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 57 cost time: 0.8940000534057617
Epoch: 57, Steps: 64 | Train Loss: 0.1158825 Vali Loss: 0.1677162 Test Loss: 0.2285229
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 58 cost time: 0.8950705528259277
Epoch: 58, Steps: 64 | Train Loss: 0.1159890 Vali Loss: 0.1670916 Test Loss: 0.2283895
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 59 cost time: 0.9012365341186523
Epoch: 59, Steps: 64 | Train Loss: 0.1160805 Vali Loss: 0.1666688 Test Loss: 0.2285547
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 60 cost time: 0.8953442573547363
Epoch: 60, Steps: 64 | Train Loss: 0.1157092 Vali Loss: 0.1663924 Test Loss: 0.2281567
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22785893082618713, mae:0.34301695227622986, rse:0.2419174462556839
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.053173065185546875 GB
Epoch: 1 cost time: 2.3290669918060303
Epoch: 1, Steps: 64 | Train Loss: 0.8639981 Vali Loss: 2.3410292 Test Loss: 3.7212477
Validation loss decreased (inf --> 2.341029).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 2 cost time: 0.9241483211517334
Epoch: 2, Steps: 64 | Train Loss: 0.4776534 Vali Loss: 0.2200199 Test Loss: 0.2376175
Validation loss decreased (2.341029 --> 0.220020).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 3 cost time: 0.9344625473022461
Epoch: 3, Steps: 64 | Train Loss: 0.1567695 Vali Loss: 0.2149898 Test Loss: 0.2627222
Validation loss decreased (0.220020 --> 0.214990).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 4 cost time: 0.9290003776550293
Epoch: 4, Steps: 64 | Train Loss: 0.1385787 Vali Loss: 0.1860834 Test Loss: 0.2250098
Validation loss decreased (0.214990 --> 0.186083).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 5 cost time: 0.930001974105835
Epoch: 5, Steps: 64 | Train Loss: 0.1336037 Vali Loss: 0.1840181 Test Loss: 0.2269014
Validation loss decreased (0.186083 --> 0.184018).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 6 cost time: 0.9256110191345215
Epoch: 6, Steps: 64 | Train Loss: 0.1288524 Vali Loss: 0.1816548 Test Loss: 0.2243059
Validation loss decreased (0.184018 --> 0.181655).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 7 cost time: 0.9273152351379395
Epoch: 7, Steps: 64 | Train Loss: 0.1269729 Vali Loss: 0.1754738 Test Loss: 0.2251404
Validation loss decreased (0.181655 --> 0.175474).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 8 cost time: 0.9253749847412109
Epoch: 8, Steps: 64 | Train Loss: 0.1252363 Vali Loss: 0.1764179 Test Loss: 0.2255990
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 9 cost time: 0.9254183769226074
Epoch: 9, Steps: 64 | Train Loss: 0.1238299 Vali Loss: 0.1775013 Test Loss: 0.2251475
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 10 cost time: 0.9313950538635254
Epoch: 10, Steps: 64 | Train Loss: 0.1224306 Vali Loss: 0.1752410 Test Loss: 0.2265126
Validation loss decreased (0.175474 --> 0.175241).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 11 cost time: 0.9263582229614258
Epoch: 11, Steps: 64 | Train Loss: 0.1216793 Vali Loss: 0.1726581 Test Loss: 0.2243283
Validation loss decreased (0.175241 --> 0.172658).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 12 cost time: 0.9327588081359863
Epoch: 12, Steps: 64 | Train Loss: 0.1206192 Vali Loss: 0.1718348 Test Loss: 0.2259173
Validation loss decreased (0.172658 --> 0.171835).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 13 cost time: 0.941002607345581
Epoch: 13, Steps: 64 | Train Loss: 0.1201906 Vali Loss: 0.1713280 Test Loss: 0.2249732
Validation loss decreased (0.171835 --> 0.171328).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 14 cost time: 0.9256250858306885
Epoch: 14, Steps: 64 | Train Loss: 0.1189669 Vali Loss: 0.1724541 Test Loss: 0.2268337
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 15 cost time: 0.9226193428039551
Epoch: 15, Steps: 64 | Train Loss: 0.1187915 Vali Loss: 0.1714711 Test Loss: 0.2265939
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 16 cost time: 0.932135820388794
Epoch: 16, Steps: 64 | Train Loss: 0.1182700 Vali Loss: 0.1712127 Test Loss: 0.2283647
Validation loss decreased (0.171328 --> 0.171213).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 17 cost time: 0.928342342376709
Epoch: 17, Steps: 64 | Train Loss: 0.1179008 Vali Loss: 0.1691227 Test Loss: 0.2281359
Validation loss decreased (0.171213 --> 0.169123).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 18 cost time: 0.9323668479919434
Epoch: 18, Steps: 64 | Train Loss: 0.1174294 Vali Loss: 0.1707081 Test Loss: 0.2288103
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 19 cost time: 0.92836594581604
Epoch: 19, Steps: 64 | Train Loss: 0.1168689 Vali Loss: 0.1692258 Test Loss: 0.2286576
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 20 cost time: 0.9347882270812988
Epoch: 20, Steps: 64 | Train Loss: 0.1165485 Vali Loss: 0.1718297 Test Loss: 0.2300202
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 21 cost time: 0.9276938438415527
Epoch: 21, Steps: 64 | Train Loss: 0.1165263 Vali Loss: 0.1711800 Test Loss: 0.2305869
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 22 cost time: 0.9220001697540283
Epoch: 22, Steps: 64 | Train Loss: 0.1160687 Vali Loss: 0.1696244 Test Loss: 0.2301621
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 23 cost time: 0.9366121292114258
Epoch: 23, Steps: 64 | Train Loss: 0.1165186 Vali Loss: 0.1719706 Test Loss: 0.2310423
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 24 cost time: 0.9233493804931641
Epoch: 24, Steps: 64 | Train Loss: 0.1157396 Vali Loss: 0.1706943 Test Loss: 0.2312389
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 25 cost time: 0.9242556095123291
Epoch: 25, Steps: 64 | Train Loss: 0.1150953 Vali Loss: 0.1708743 Test Loss: 0.2322809
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 26 cost time: 0.9273545742034912
Epoch: 26, Steps: 64 | Train Loss: 0.1153563 Vali Loss: 0.1694175 Test Loss: 0.2316020
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 27 cost time: 0.9243402481079102
Epoch: 27, Steps: 64 | Train Loss: 0.1151083 Vali Loss: 0.1693557 Test Loss: 0.2323289
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 28 cost time: 0.933373212814331
Epoch: 28, Steps: 64 | Train Loss: 0.1154851 Vali Loss: 0.1692486 Test Loss: 0.2329644
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 29 cost time: 0.9291813373565674
Epoch: 29, Steps: 64 | Train Loss: 0.1151348 Vali Loss: 0.1700921 Test Loss: 0.2324329
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 30 cost time: 0.9221007823944092
Epoch: 30, Steps: 64 | Train Loss: 0.1144388 Vali Loss: 0.1707345 Test Loss: 0.2335726
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 31 cost time: 1.000631332397461
Epoch: 31, Steps: 64 | Train Loss: 0.1147970 Vali Loss: 0.1704417 Test Loss: 0.2325683
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 32 cost time: 1.003610610961914
Epoch: 32, Steps: 64 | Train Loss: 0.1146252 Vali Loss: 0.1696233 Test Loss: 0.2336403
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 33 cost time: 0.9782404899597168
Epoch: 33, Steps: 64 | Train Loss: 0.1143282 Vali Loss: 0.1701311 Test Loss: 0.2335402
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 34 cost time: 0.9213621616363525
Epoch: 34, Steps: 64 | Train Loss: 0.1142579 Vali Loss: 0.1706777 Test Loss: 0.2341770
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 35 cost time: 0.9303724765777588
Epoch: 35, Steps: 64 | Train Loss: 0.1149843 Vali Loss: 0.1703079 Test Loss: 0.2339518
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 36 cost time: 0.9313647747039795
Epoch: 36, Steps: 64 | Train Loss: 0.1138756 Vali Loss: 0.1699591 Test Loss: 0.2341939
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 37 cost time: 0.9283583164215088
Epoch: 37, Steps: 64 | Train Loss: 0.1137866 Vali Loss: 0.1692965 Test Loss: 0.2343660
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 38 cost time: 0.9277880191802979
Epoch: 38, Steps: 64 | Train Loss: 0.1136694 Vali Loss: 0.1693520 Test Loss: 0.2338644
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 39 cost time: 0.9197213649749756
Epoch: 39, Steps: 64 | Train Loss: 0.1141722 Vali Loss: 0.1706267 Test Loss: 0.2337181
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 40 cost time: 0.9359993934631348
Epoch: 40, Steps: 64 | Train Loss: 0.1140846 Vali Loss: 0.1703252 Test Loss: 0.2346269
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 41 cost time: 0.9250509738922119
Epoch: 41, Steps: 64 | Train Loss: 0.1139346 Vali Loss: 0.1704678 Test Loss: 0.2350898
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 42 cost time: 0.9223747253417969
Epoch: 42, Steps: 64 | Train Loss: 0.1142711 Vali Loss: 0.1702894 Test Loss: 0.2343315
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 43 cost time: 0.9423902034759521
Epoch: 43, Steps: 64 | Train Loss: 0.1140706 Vali Loss: 0.1694684 Test Loss: 0.2343118
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 44 cost time: 1.0034456253051758
Epoch: 44, Steps: 64 | Train Loss: 0.1137701 Vali Loss: 0.1704062 Test Loss: 0.2342385
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 45 cost time: 1.0081787109375
Epoch: 45, Steps: 64 | Train Loss: 0.1141369 Vali Loss: 0.1684191 Test Loss: 0.2347271
Validation loss decreased (0.169123 --> 0.168419).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 46 cost time: 1.021500587463379
Epoch: 46, Steps: 64 | Train Loss: 0.1136366 Vali Loss: 0.1677938 Test Loss: 0.2356178
Validation loss decreased (0.168419 --> 0.167794).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 47 cost time: 0.9211082458496094
Epoch: 47, Steps: 64 | Train Loss: 0.1140127 Vali Loss: 0.1705236 Test Loss: 0.2348896
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 48 cost time: 0.9237380027770996
Epoch: 48, Steps: 64 | Train Loss: 0.1137645 Vali Loss: 0.1704719 Test Loss: 0.2349775
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 49 cost time: 0.9179925918579102
Epoch: 49, Steps: 64 | Train Loss: 0.1136694 Vali Loss: 0.1698796 Test Loss: 0.2343454
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 50 cost time: 0.9290001392364502
Epoch: 50, Steps: 64 | Train Loss: 0.1137368 Vali Loss: 0.1710503 Test Loss: 0.2350737
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 51 cost time: 0.92356276512146
Epoch: 51, Steps: 64 | Train Loss: 0.1137482 Vali Loss: 0.1695221 Test Loss: 0.2348525
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 52 cost time: 0.9263920783996582
Epoch: 52, Steps: 64 | Train Loss: 0.1138645 Vali Loss: 0.1685434 Test Loss: 0.2349270
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 53 cost time: 0.9323620796203613
Epoch: 53, Steps: 64 | Train Loss: 0.1134807 Vali Loss: 0.1713689 Test Loss: 0.2348974
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 54 cost time: 0.9349493980407715
Epoch: 54, Steps: 64 | Train Loss: 0.1139469 Vali Loss: 0.1700368 Test Loss: 0.2356793
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 55 cost time: 0.9263875484466553
Epoch: 55, Steps: 64 | Train Loss: 0.1135278 Vali Loss: 0.1708678 Test Loss: 0.2344244
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 56 cost time: 0.925706148147583
Epoch: 56, Steps: 64 | Train Loss: 0.1135216 Vali Loss: 0.1697124 Test Loss: 0.2350486
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 57 cost time: 0.9307267665863037
Epoch: 57, Steps: 64 | Train Loss: 0.1139766 Vali Loss: 0.1707430 Test Loss: 0.2348942
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 58 cost time: 0.9273834228515625
Epoch: 58, Steps: 64 | Train Loss: 0.1139672 Vali Loss: 0.1702444 Test Loss: 0.2350132
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 59 cost time: 0.9296116828918457
Epoch: 59, Steps: 64 | Train Loss: 0.1138307 Vali Loss: 0.1700040 Test Loss: 0.2348908
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 60 cost time: 0.9443483352661133
Epoch: 60, Steps: 64 | Train Loss: 0.1130507 Vali Loss: 0.1713567 Test Loss: 0.2355319
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2356177717447281, mae:0.3570030629634857, rse:0.246001735329628
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04604673385620117 GB
Epoch: 1 cost time: 2.204467296600342
Epoch: 1, Steps: 64 | Train Loss: 1.0356978 Vali Loss: 2.7286227 Test Loss: 4.4024954
Validation loss decreased (inf --> 2.728623).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 2 cost time: 0.8133888244628906
Epoch: 2, Steps: 64 | Train Loss: 0.8682112 Vali Loss: 1.8967028 Test Loss: 3.0164926
Validation loss decreased (2.728623 --> 1.896703).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 3 cost time: 0.8112900257110596
Epoch: 3, Steps: 64 | Train Loss: 0.6425604 Vali Loss: 1.3492825 Test Loss: 2.0939190
Validation loss decreased (1.896703 --> 1.349283).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 4 cost time: 0.8199999332427979
Epoch: 4, Steps: 64 | Train Loss: 0.4755077 Vali Loss: 0.9803935 Test Loss: 1.4866142
Validation loss decreased (1.349283 --> 0.980394).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 5 cost time: 0.8097853660583496
Epoch: 5, Steps: 64 | Train Loss: 0.3698282 Vali Loss: 0.7761480 Test Loss: 1.1567354
Validation loss decreased (0.980394 --> 0.776148).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 6 cost time: 0.8128151893615723
Epoch: 6, Steps: 64 | Train Loss: 0.3011871 Vali Loss: 0.6350699 Test Loss: 0.9290988
Validation loss decreased (0.776148 --> 0.635070).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 7 cost time: 0.8037581443786621
Epoch: 7, Steps: 64 | Train Loss: 0.2552920 Vali Loss: 0.5299226 Test Loss: 0.7652352
Validation loss decreased (0.635070 --> 0.529923).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 8 cost time: 0.7676308155059814
Epoch: 8, Steps: 64 | Train Loss: 0.2233900 Vali Loss: 0.4484310 Test Loss: 0.6421993
Validation loss decreased (0.529923 --> 0.448431).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 9 cost time: 0.8096027374267578
Epoch: 9, Steps: 64 | Train Loss: 0.2000653 Vali Loss: 0.3975994 Test Loss: 0.5597945
Validation loss decreased (0.448431 --> 0.397599).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 10 cost time: 0.8084161281585693
Epoch: 10, Steps: 64 | Train Loss: 0.1842271 Vali Loss: 0.3534725 Test Loss: 0.4949410
Validation loss decreased (0.397599 --> 0.353472).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 11 cost time: 0.8052630424499512
Epoch: 11, Steps: 64 | Train Loss: 0.1729557 Vali Loss: 0.3196692 Test Loss: 0.4384304
Validation loss decreased (0.353472 --> 0.319669).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 12 cost time: 0.8158013820648193
Epoch: 12, Steps: 64 | Train Loss: 0.1631884 Vali Loss: 0.3000393 Test Loss: 0.4102096
Validation loss decreased (0.319669 --> 0.300039).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 13 cost time: 0.8089995384216309
Epoch: 13, Steps: 64 | Train Loss: 0.1559824 Vali Loss: 0.2784411 Test Loss: 0.3757672
Validation loss decreased (0.300039 --> 0.278441).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 14 cost time: 0.8103840351104736
Epoch: 14, Steps: 64 | Train Loss: 0.1513129 Vali Loss: 0.2631339 Test Loss: 0.3543570
Validation loss decreased (0.278441 --> 0.263134).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 15 cost time: 0.820347785949707
Epoch: 15, Steps: 64 | Train Loss: 0.1467584 Vali Loss: 0.2537071 Test Loss: 0.3369641
Validation loss decreased (0.263134 --> 0.253707).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 16 cost time: 0.805701732635498
Epoch: 16, Steps: 64 | Train Loss: 0.1435120 Vali Loss: 0.2404054 Test Loss: 0.3232899
Validation loss decreased (0.253707 --> 0.240405).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 17 cost time: 0.8033525943756104
Epoch: 17, Steps: 64 | Train Loss: 0.1411825 Vali Loss: 0.2372717 Test Loss: 0.3126051
Validation loss decreased (0.240405 --> 0.237272).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 18 cost time: 0.8026199340820312
Epoch: 18, Steps: 64 | Train Loss: 0.1390773 Vali Loss: 0.2300995 Test Loss: 0.3034497
Validation loss decreased (0.237272 --> 0.230099).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 19 cost time: 0.8104338645935059
Epoch: 19, Steps: 64 | Train Loss: 0.1373848 Vali Loss: 0.2211836 Test Loss: 0.2926652
Validation loss decreased (0.230099 --> 0.221184).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 20 cost time: 0.8091418743133545
Epoch: 20, Steps: 64 | Train Loss: 0.1353711 Vali Loss: 0.2200915 Test Loss: 0.2872046
Validation loss decreased (0.221184 --> 0.220091).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 21 cost time: 0.806999921798706
Epoch: 21, Steps: 64 | Train Loss: 0.1349545 Vali Loss: 0.2174294 Test Loss: 0.2834587
Validation loss decreased (0.220091 --> 0.217429).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 22 cost time: 0.8030309677124023
Epoch: 22, Steps: 64 | Train Loss: 0.1334902 Vali Loss: 0.2142829 Test Loss: 0.2785647
Validation loss decreased (0.217429 --> 0.214283).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 23 cost time: 0.8243386745452881
Epoch: 23, Steps: 64 | Train Loss: 0.1330413 Vali Loss: 0.2107412 Test Loss: 0.2726583
Validation loss decreased (0.214283 --> 0.210741).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 24 cost time: 0.8354315757751465
Epoch: 24, Steps: 64 | Train Loss: 0.1324983 Vali Loss: 0.2104707 Test Loss: 0.2732899
Validation loss decreased (0.210741 --> 0.210471).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 25 cost time: 0.7996487617492676
Epoch: 25, Steps: 64 | Train Loss: 0.1314328 Vali Loss: 0.2069082 Test Loss: 0.2690290
Validation loss decreased (0.210471 --> 0.206908).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 26 cost time: 0.8030002117156982
Epoch: 26, Steps: 64 | Train Loss: 0.1308815 Vali Loss: 0.2062869 Test Loss: 0.2682727
Validation loss decreased (0.206908 --> 0.206287).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 27 cost time: 0.8036274909973145
Epoch: 27, Steps: 64 | Train Loss: 0.1305441 Vali Loss: 0.2047713 Test Loss: 0.2646586
Validation loss decreased (0.206287 --> 0.204771).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 28 cost time: 0.7993650436401367
Epoch: 28, Steps: 64 | Train Loss: 0.1296177 Vali Loss: 0.2037163 Test Loss: 0.2625490
Validation loss decreased (0.204771 --> 0.203716).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 29 cost time: 0.8037781715393066
Epoch: 29, Steps: 64 | Train Loss: 0.1301937 Vali Loss: 0.2036877 Test Loss: 0.2616129
Validation loss decreased (0.203716 --> 0.203688).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 30 cost time: 0.8080003261566162
Epoch: 30, Steps: 64 | Train Loss: 0.1290566 Vali Loss: 0.1997604 Test Loss: 0.2586408
Validation loss decreased (0.203688 --> 0.199760).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 31 cost time: 0.7999045848846436
Epoch: 31, Steps: 64 | Train Loss: 0.1291916 Vali Loss: 0.2006676 Test Loss: 0.2599353
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 32 cost time: 0.8064219951629639
Epoch: 32, Steps: 64 | Train Loss: 0.1285273 Vali Loss: 0.1995045 Test Loss: 0.2578011
Validation loss decreased (0.199760 --> 0.199504).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 33 cost time: 0.8083734512329102
Epoch: 33, Steps: 64 | Train Loss: 0.1281835 Vali Loss: 0.1998924 Test Loss: 0.2566330
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 34 cost time: 0.8025774955749512
Epoch: 34, Steps: 64 | Train Loss: 0.1287302 Vali Loss: 0.1980953 Test Loss: 0.2551873
Validation loss decreased (0.199504 --> 0.198095).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 35 cost time: 0.7979998588562012
Epoch: 35, Steps: 64 | Train Loss: 0.1286085 Vali Loss: 0.1991380 Test Loss: 0.2560708
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 36 cost time: 0.8018219470977783
Epoch: 36, Steps: 64 | Train Loss: 0.1283971 Vali Loss: 0.1976644 Test Loss: 0.2551561
Validation loss decreased (0.198095 --> 0.197664).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 37 cost time: 0.8033661842346191
Epoch: 37, Steps: 64 | Train Loss: 0.1274475 Vali Loss: 0.1981993 Test Loss: 0.2540907
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 38 cost time: 0.8047161102294922
Epoch: 38, Steps: 64 | Train Loss: 0.1279145 Vali Loss: 0.1969898 Test Loss: 0.2534974
Validation loss decreased (0.197664 --> 0.196990).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 39 cost time: 0.8230001926422119
Epoch: 39, Steps: 64 | Train Loss: 0.1271432 Vali Loss: 0.1947395 Test Loss: 0.2519328
Validation loss decreased (0.196990 --> 0.194739).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 40 cost time: 0.8096213340759277
Epoch: 40, Steps: 64 | Train Loss: 0.1275766 Vali Loss: 0.1955493 Test Loss: 0.2519325
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 41 cost time: 0.8154497146606445
Epoch: 41, Steps: 64 | Train Loss: 0.1273561 Vali Loss: 0.1936838 Test Loss: 0.2502702
Validation loss decreased (0.194739 --> 0.193684).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 42 cost time: 0.8093574047088623
Epoch: 42, Steps: 64 | Train Loss: 0.1273960 Vali Loss: 0.1956689 Test Loss: 0.2516249
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 43 cost time: 0.8080000877380371
Epoch: 43, Steps: 64 | Train Loss: 0.1265658 Vali Loss: 0.1961080 Test Loss: 0.2517794
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 44 cost time: 0.8016157150268555
Epoch: 44, Steps: 64 | Train Loss: 0.1274319 Vali Loss: 0.1938801 Test Loss: 0.2507688
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 45 cost time: 0.7983543872833252
Epoch: 45, Steps: 64 | Train Loss: 0.1265347 Vali Loss: 0.1950595 Test Loss: 0.2508605
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 46 cost time: 0.8017590045928955
Epoch: 46, Steps: 64 | Train Loss: 0.1270504 Vali Loss: 0.1940883 Test Loss: 0.2498029
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 47 cost time: 0.7990000247955322
Epoch: 47, Steps: 64 | Train Loss: 0.1269831 Vali Loss: 0.1930448 Test Loss: 0.2499703
Validation loss decreased (0.193684 --> 0.193045).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 48 cost time: 0.803999662399292
Epoch: 48, Steps: 64 | Train Loss: 0.1270830 Vali Loss: 0.1942141 Test Loss: 0.2507818
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 49 cost time: 0.8103818893432617
Epoch: 49, Steps: 64 | Train Loss: 0.1261396 Vali Loss: 0.1934071 Test Loss: 0.2488543
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 50 cost time: 0.8141849040985107
Epoch: 50, Steps: 64 | Train Loss: 0.1267160 Vali Loss: 0.1925249 Test Loss: 0.2509696
Validation loss decreased (0.193045 --> 0.192525).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 51 cost time: 0.8123764991760254
Epoch: 51, Steps: 64 | Train Loss: 0.1268507 Vali Loss: 0.1937982 Test Loss: 0.2490534
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 52 cost time: 0.8090002536773682
Epoch: 52, Steps: 64 | Train Loss: 0.1260305 Vali Loss: 0.1953834 Test Loss: 0.2490047
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 53 cost time: 0.8046166896820068
Epoch: 53, Steps: 64 | Train Loss: 0.1265844 Vali Loss: 0.1928466 Test Loss: 0.2485950
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 54 cost time: 0.807330846786499
Epoch: 54, Steps: 64 | Train Loss: 0.1263810 Vali Loss: 0.1927476 Test Loss: 0.2495421
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 55 cost time: 0.8017230033874512
Epoch: 55, Steps: 64 | Train Loss: 0.1263319 Vali Loss: 0.1928032 Test Loss: 0.2503716
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 56 cost time: 0.8030002117156982
Epoch: 56, Steps: 64 | Train Loss: 0.1261719 Vali Loss: 0.1933627 Test Loss: 0.2494948
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 57 cost time: 0.8036136627197266
Epoch: 57, Steps: 64 | Train Loss: 0.1265305 Vali Loss: 0.1946824 Test Loss: 0.2501633
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 58 cost time: 0.8144218921661377
Epoch: 58, Steps: 64 | Train Loss: 0.1270064 Vali Loss: 0.1935954 Test Loss: 0.2488828
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 59 cost time: 0.8054571151733398
Epoch: 59, Steps: 64 | Train Loss: 0.1265960 Vali Loss: 0.1926302 Test Loss: 0.2478954
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 60 cost time: 0.8053989410400391
Epoch: 60, Steps: 64 | Train Loss: 0.1269106 Vali Loss: 0.1923839 Test Loss: 0.2468536
Validation loss decreased (0.192525 --> 0.192384).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2468535155057907, mae:0.3612872362136841, rse:0.2517988979816437
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 1 cost time: 2.2699878215789795
Epoch: 1, Steps: 64 | Train Loss: 0.8511045 Vali Loss: 2.2975221 Test Loss: 3.6270647
Validation loss decreased (inf --> 2.297522).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 2 cost time: 0.9055378437042236
Epoch: 2, Steps: 64 | Train Loss: 0.5715901 Vali Loss: 0.6460264 Test Loss: 0.9410189
Validation loss decreased (2.297522 --> 0.646026).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 3 cost time: 0.9004590511322021
Epoch: 3, Steps: 64 | Train Loss: 0.2000978 Vali Loss: 0.2085618 Test Loss: 0.2316009
Validation loss decreased (0.646026 --> 0.208562).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 4 cost time: 0.9063541889190674
Epoch: 4, Steps: 64 | Train Loss: 0.1466074 Vali Loss: 0.1869539 Test Loss: 0.2257160
Validation loss decreased (0.208562 --> 0.186954).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 5 cost time: 0.9163615703582764
Epoch: 5, Steps: 64 | Train Loss: 0.1378622 Vali Loss: 0.1811939 Test Loss: 0.2236895
Validation loss decreased (0.186954 --> 0.181194).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 6 cost time: 0.894951581954956
Epoch: 6, Steps: 64 | Train Loss: 0.1334057 Vali Loss: 0.1764373 Test Loss: 0.2189309
Validation loss decreased (0.181194 --> 0.176437).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 7 cost time: 0.9209997653961182
Epoch: 7, Steps: 64 | Train Loss: 0.1304639 Vali Loss: 0.1734949 Test Loss: 0.2180982
Validation loss decreased (0.176437 --> 0.173495).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 8 cost time: 0.9169998168945312
Epoch: 8, Steps: 64 | Train Loss: 0.1277968 Vali Loss: 0.1729237 Test Loss: 0.2184143
Validation loss decreased (0.173495 --> 0.172924).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 9 cost time: 0.9235937595367432
Epoch: 9, Steps: 64 | Train Loss: 0.1261922 Vali Loss: 0.1680159 Test Loss: 0.2170303
Validation loss decreased (0.172924 --> 0.168016).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 10 cost time: 0.9273016452789307
Epoch: 10, Steps: 64 | Train Loss: 0.1241241 Vali Loss: 0.1694126 Test Loss: 0.2218350
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 11 cost time: 0.9262776374816895
Epoch: 11, Steps: 64 | Train Loss: 0.1231866 Vali Loss: 0.1687967 Test Loss: 0.2184440
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 12 cost time: 0.9313395023345947
Epoch: 12, Steps: 64 | Train Loss: 0.1217249 Vali Loss: 0.1681088 Test Loss: 0.2198624
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 13 cost time: 0.9251155853271484
Epoch: 13, Steps: 64 | Train Loss: 0.1203170 Vali Loss: 0.1675756 Test Loss: 0.2196052
Validation loss decreased (0.168016 --> 0.167576).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 14 cost time: 0.9204158782958984
Epoch: 14, Steps: 64 | Train Loss: 0.1198247 Vali Loss: 0.1659353 Test Loss: 0.2206575
Validation loss decreased (0.167576 --> 0.165935).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 15 cost time: 0.9197664260864258
Epoch: 15, Steps: 64 | Train Loss: 0.1194881 Vali Loss: 0.1662860 Test Loss: 0.2210435
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 16 cost time: 0.9130768775939941
Epoch: 16, Steps: 64 | Train Loss: 0.1184936 Vali Loss: 0.1647272 Test Loss: 0.2215802
Validation loss decreased (0.165935 --> 0.164727).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 17 cost time: 0.9125993251800537
Epoch: 17, Steps: 64 | Train Loss: 0.1174537 Vali Loss: 0.1646402 Test Loss: 0.2225586
Validation loss decreased (0.164727 --> 0.164640).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 18 cost time: 0.9253740310668945
Epoch: 18, Steps: 64 | Train Loss: 0.1178230 Vali Loss: 0.1664755 Test Loss: 0.2225896
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 19 cost time: 0.9303534030914307
Epoch: 19, Steps: 64 | Train Loss: 0.1172436 Vali Loss: 0.1648200 Test Loss: 0.2221407
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 20 cost time: 0.923112154006958
Epoch: 20, Steps: 64 | Train Loss: 0.1159791 Vali Loss: 0.1637449 Test Loss: 0.2227425
Validation loss decreased (0.164640 --> 0.163745).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 21 cost time: 0.921320915222168
Epoch: 21, Steps: 64 | Train Loss: 0.1166715 Vali Loss: 0.1664455 Test Loss: 0.2255704
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 22 cost time: 0.9520342350006104
Epoch: 22, Steps: 64 | Train Loss: 0.1159987 Vali Loss: 0.1632099 Test Loss: 0.2233976
Validation loss decreased (0.163745 --> 0.163210).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 23 cost time: 0.893735408782959
Epoch: 23, Steps: 64 | Train Loss: 0.1158792 Vali Loss: 0.1641486 Test Loss: 0.2238731
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 24 cost time: 0.8980014324188232
Epoch: 24, Steps: 64 | Train Loss: 0.1155508 Vali Loss: 0.1635339 Test Loss: 0.2240717
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 25 cost time: 0.8956289291381836
Epoch: 25, Steps: 64 | Train Loss: 0.1152365 Vali Loss: 0.1644529 Test Loss: 0.2248257
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 26 cost time: 0.8899860382080078
Epoch: 26, Steps: 64 | Train Loss: 0.1148943 Vali Loss: 0.1631140 Test Loss: 0.2251650
Validation loss decreased (0.163210 --> 0.163114).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 27 cost time: 0.9034383296966553
Epoch: 27, Steps: 64 | Train Loss: 0.1149372 Vali Loss: 0.1650539 Test Loss: 0.2248419
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 28 cost time: 0.9044549465179443
Epoch: 28, Steps: 64 | Train Loss: 0.1136445 Vali Loss: 0.1629537 Test Loss: 0.2252195
Validation loss decreased (0.163114 --> 0.162954).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 29 cost time: 0.9143555164337158
Epoch: 29, Steps: 64 | Train Loss: 0.1153368 Vali Loss: 0.1646723 Test Loss: 0.2251372
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 30 cost time: 0.9027526378631592
Epoch: 30, Steps: 64 | Train Loss: 0.1150809 Vali Loss: 0.1639338 Test Loss: 0.2249252
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 31 cost time: 0.8946218490600586
Epoch: 31, Steps: 64 | Train Loss: 0.1145003 Vali Loss: 0.1629125 Test Loss: 0.2254418
Validation loss decreased (0.162954 --> 0.162912).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 32 cost time: 0.8976175785064697
Epoch: 32, Steps: 64 | Train Loss: 0.1142306 Vali Loss: 0.1628572 Test Loss: 0.2252087
Validation loss decreased (0.162912 --> 0.162857).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 33 cost time: 0.9003915786743164
Epoch: 33, Steps: 64 | Train Loss: 0.1145256 Vali Loss: 0.1632165 Test Loss: 0.2246696
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 34 cost time: 0.8993198871612549
Epoch: 34, Steps: 64 | Train Loss: 0.1145036 Vali Loss: 0.1636205 Test Loss: 0.2253272
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 35 cost time: 0.9070196151733398
Epoch: 35, Steps: 64 | Train Loss: 0.1141658 Vali Loss: 0.1632614 Test Loss: 0.2257177
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 36 cost time: 0.9107227325439453
Epoch: 36, Steps: 64 | Train Loss: 0.1139128 Vali Loss: 0.1634366 Test Loss: 0.2254844
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 37 cost time: 0.9047744274139404
Epoch: 37, Steps: 64 | Train Loss: 0.1146016 Vali Loss: 0.1636411 Test Loss: 0.2261227
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 38 cost time: 0.9040000438690186
Epoch: 38, Steps: 64 | Train Loss: 0.1144911 Vali Loss: 0.1638662 Test Loss: 0.2259745
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 39 cost time: 0.9069967269897461
Epoch: 39, Steps: 64 | Train Loss: 0.1141135 Vali Loss: 0.1643696 Test Loss: 0.2259842
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 40 cost time: 0.91322922706604
Epoch: 40, Steps: 64 | Train Loss: 0.1139149 Vali Loss: 0.1637437 Test Loss: 0.2263025
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 41 cost time: 0.9163434505462646
Epoch: 41, Steps: 64 | Train Loss: 0.1137342 Vali Loss: 0.1606359 Test Loss: 0.2249682
Validation loss decreased (0.162857 --> 0.160636).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 42 cost time: 0.9173259735107422
Epoch: 42, Steps: 64 | Train Loss: 0.1141592 Vali Loss: 0.1622801 Test Loss: 0.2255952
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 43 cost time: 0.923905611038208
Epoch: 43, Steps: 64 | Train Loss: 0.1138782 Vali Loss: 0.1652734 Test Loss: 0.2265930
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 44 cost time: 0.9038152694702148
Epoch: 44, Steps: 64 | Train Loss: 0.1138890 Vali Loss: 0.1625109 Test Loss: 0.2264826
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 45 cost time: 0.9030001163482666
Epoch: 45, Steps: 64 | Train Loss: 0.1139077 Vali Loss: 0.1623241 Test Loss: 0.2261966
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 46 cost time: 0.9016375541687012
Epoch: 46, Steps: 64 | Train Loss: 0.1140173 Vali Loss: 0.1638873 Test Loss: 0.2267991
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 47 cost time: 0.896601676940918
Epoch: 47, Steps: 64 | Train Loss: 0.1134368 Vali Loss: 0.1632392 Test Loss: 0.2264158
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 48 cost time: 0.9019765853881836
Epoch: 48, Steps: 64 | Train Loss: 0.1139298 Vali Loss: 0.1639279 Test Loss: 0.2266991
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 49 cost time: 0.9012396335601807
Epoch: 49, Steps: 64 | Train Loss: 0.1137213 Vali Loss: 0.1636979 Test Loss: 0.2264665
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 50 cost time: 0.9063608646392822
Epoch: 50, Steps: 64 | Train Loss: 0.1139638 Vali Loss: 0.1623938 Test Loss: 0.2265493
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 51 cost time: 0.8974401950836182
Epoch: 51, Steps: 64 | Train Loss: 0.1139258 Vali Loss: 0.1638372 Test Loss: 0.2266817
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 52 cost time: 0.9054055213928223
Epoch: 52, Steps: 64 | Train Loss: 0.1134671 Vali Loss: 0.1635398 Test Loss: 0.2257448
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 53 cost time: 0.9000561237335205
Epoch: 53, Steps: 64 | Train Loss: 0.1135759 Vali Loss: 0.1635262 Test Loss: 0.2262234
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 54 cost time: 0.937126636505127
Epoch: 54, Steps: 64 | Train Loss: 0.1131451 Vali Loss: 0.1627007 Test Loss: 0.2258023
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 55 cost time: 0.8964006900787354
Epoch: 55, Steps: 64 | Train Loss: 0.1135972 Vali Loss: 0.1628040 Test Loss: 0.2264553
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 56 cost time: 0.9074368476867676
Epoch: 56, Steps: 64 | Train Loss: 0.1137352 Vali Loss: 0.1627891 Test Loss: 0.2261177
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 57 cost time: 0.9093496799468994
Epoch: 57, Steps: 64 | Train Loss: 0.1130523 Vali Loss: 0.1623911 Test Loss: 0.2263935
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 58 cost time: 0.9037611484527588
Epoch: 58, Steps: 64 | Train Loss: 0.1131923 Vali Loss: 0.1632480 Test Loss: 0.2256581
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 59 cost time: 0.8989996910095215
Epoch: 59, Steps: 64 | Train Loss: 0.1135437 Vali Loss: 0.1606803 Test Loss: 0.2262123
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 60 cost time: 0.9002745151519775
Epoch: 60, Steps: 64 | Train Loss: 0.1134505 Vali Loss: 0.1628030 Test Loss: 0.2260305
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22496818006038666, mae:0.33870744705200195, rse:0.2403779923915863
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05333375930786133 GB
Epoch: 1 cost time: 2.2639870643615723
Epoch: 1, Steps: 64 | Train Loss: 0.8901044 Vali Loss: 2.4187651 Test Loss: 3.8621430
Validation loss decreased (inf --> 2.418765).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 2 cost time: 0.9274060726165771
Epoch: 2, Steps: 64 | Train Loss: 0.4919883 Vali Loss: 0.2566473 Test Loss: 0.2766815
Validation loss decreased (2.418765 --> 0.256647).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 3 cost time: 0.9330706596374512
Epoch: 3, Steps: 64 | Train Loss: 0.1615480 Vali Loss: 0.2167826 Test Loss: 0.2595827
Validation loss decreased (0.256647 --> 0.216783).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 4 cost time: 0.9363577365875244
Epoch: 4, Steps: 64 | Train Loss: 0.1419086 Vali Loss: 0.1874132 Test Loss: 0.2264758
Validation loss decreased (0.216783 --> 0.187413).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 5 cost time: 0.9274144172668457
Epoch: 5, Steps: 64 | Train Loss: 0.1348147 Vali Loss: 0.1819928 Test Loss: 0.2259811
Validation loss decreased (0.187413 --> 0.181993).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 6 cost time: 0.9307858943939209
Epoch: 6, Steps: 64 | Train Loss: 0.1303265 Vali Loss: 0.1818116 Test Loss: 0.2246668
Validation loss decreased (0.181993 --> 0.181812).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 7 cost time: 0.9196264743804932
Epoch: 7, Steps: 64 | Train Loss: 0.1271765 Vali Loss: 0.1772010 Test Loss: 0.2208823
Validation loss decreased (0.181812 --> 0.177201).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 8 cost time: 0.91764235496521
Epoch: 8, Steps: 64 | Train Loss: 0.1255064 Vali Loss: 0.1746195 Test Loss: 0.2240365
Validation loss decreased (0.177201 --> 0.174620).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 9 cost time: 0.9243898391723633
Epoch: 9, Steps: 64 | Train Loss: 0.1245070 Vali Loss: 0.1733999 Test Loss: 0.2235306
Validation loss decreased (0.174620 --> 0.173400).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 10 cost time: 0.9294352531433105
Epoch: 10, Steps: 64 | Train Loss: 0.1229353 Vali Loss: 0.1766856 Test Loss: 0.2214969
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 11 cost time: 0.9383723735809326
Epoch: 11, Steps: 64 | Train Loss: 0.1216825 Vali Loss: 0.1714093 Test Loss: 0.2195798
Validation loss decreased (0.173400 --> 0.171409).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 12 cost time: 0.9284749031066895
Epoch: 12, Steps: 64 | Train Loss: 0.1206276 Vali Loss: 0.1735322 Test Loss: 0.2219745
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 13 cost time: 0.9283754825592041
Epoch: 13, Steps: 64 | Train Loss: 0.1195105 Vali Loss: 0.1707160 Test Loss: 0.2211996
Validation loss decreased (0.171409 --> 0.170716).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 14 cost time: 0.9388270378112793
Epoch: 14, Steps: 64 | Train Loss: 0.1195519 Vali Loss: 0.1696413 Test Loss: 0.2218152
Validation loss decreased (0.170716 --> 0.169641).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 15 cost time: 0.9244446754455566
Epoch: 15, Steps: 64 | Train Loss: 0.1183176 Vali Loss: 0.1689732 Test Loss: 0.2201609
Validation loss decreased (0.169641 --> 0.168973).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 16 cost time: 0.9272127151489258
Epoch: 16, Steps: 64 | Train Loss: 0.1178969 Vali Loss: 0.1681277 Test Loss: 0.2222272
Validation loss decreased (0.168973 --> 0.168128).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 17 cost time: 0.9246232509613037
Epoch: 17, Steps: 64 | Train Loss: 0.1171541 Vali Loss: 0.1690615 Test Loss: 0.2212586
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 18 cost time: 0.9554376602172852
Epoch: 18, Steps: 64 | Train Loss: 0.1171197 Vali Loss: 0.1694887 Test Loss: 0.2221626
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 19 cost time: 0.9573676586151123
Epoch: 19, Steps: 64 | Train Loss: 0.1172087 Vali Loss: 0.1677039 Test Loss: 0.2213449
Validation loss decreased (0.168128 --> 0.167704).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 20 cost time: 0.9303758144378662
Epoch: 20, Steps: 64 | Train Loss: 0.1167985 Vali Loss: 0.1683451 Test Loss: 0.2217973
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 21 cost time: 0.9394211769104004
Epoch: 21, Steps: 64 | Train Loss: 0.1170839 Vali Loss: 0.1683141 Test Loss: 0.2223772
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 22 cost time: 0.9174075126647949
Epoch: 22, Steps: 64 | Train Loss: 0.1162908 Vali Loss: 0.1673321 Test Loss: 0.2216505
Validation loss decreased (0.167704 --> 0.167332).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 23 cost time: 0.9188134670257568
Epoch: 23, Steps: 64 | Train Loss: 0.1160138 Vali Loss: 0.1674668 Test Loss: 0.2230999
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 24 cost time: 0.9206192493438721
Epoch: 24, Steps: 64 | Train Loss: 0.1158727 Vali Loss: 0.1669525 Test Loss: 0.2221728
Validation loss decreased (0.167332 --> 0.166952).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 25 cost time: 0.9166121482849121
Epoch: 25, Steps: 64 | Train Loss: 0.1158053 Vali Loss: 0.1671852 Test Loss: 0.2222482
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 26 cost time: 0.927609920501709
Epoch: 26, Steps: 64 | Train Loss: 0.1158621 Vali Loss: 0.1680600 Test Loss: 0.2223366
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 27 cost time: 0.929541826248169
Epoch: 27, Steps: 64 | Train Loss: 0.1154059 Vali Loss: 0.1675747 Test Loss: 0.2226824
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 28 cost time: 0.9227275848388672
Epoch: 28, Steps: 64 | Train Loss: 0.1152440 Vali Loss: 0.1679657 Test Loss: 0.2221262
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 29 cost time: 0.927340030670166
Epoch: 29, Steps: 64 | Train Loss: 0.1153888 Vali Loss: 0.1684544 Test Loss: 0.2231493
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 30 cost time: 0.9253747463226318
Epoch: 30, Steps: 64 | Train Loss: 0.1149285 Vali Loss: 0.1672713 Test Loss: 0.2225112
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 31 cost time: 0.9339613914489746
Epoch: 31, Steps: 64 | Train Loss: 0.1153189 Vali Loss: 0.1673335 Test Loss: 0.2227017
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 32 cost time: 0.9254000186920166
Epoch: 32, Steps: 64 | Train Loss: 0.1146595 Vali Loss: 0.1665132 Test Loss: 0.2220778
Validation loss decreased (0.166952 --> 0.166513).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 33 cost time: 0.9209997653961182
Epoch: 33, Steps: 64 | Train Loss: 0.1149757 Vali Loss: 0.1664492 Test Loss: 0.2223662
Validation loss decreased (0.166513 --> 0.166449).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 34 cost time: 0.9266164302825928
Epoch: 34, Steps: 64 | Train Loss: 0.1143190 Vali Loss: 0.1668754 Test Loss: 0.2234042
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 35 cost time: 0.9374034404754639
Epoch: 35, Steps: 64 | Train Loss: 0.1140779 Vali Loss: 0.1665286 Test Loss: 0.2234386
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 36 cost time: 0.932905912399292
Epoch: 36, Steps: 64 | Train Loss: 0.1149841 Vali Loss: 0.1666053 Test Loss: 0.2230247
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 37 cost time: 0.9293811321258545
Epoch: 37, Steps: 64 | Train Loss: 0.1143432 Vali Loss: 0.1661230 Test Loss: 0.2240598
Validation loss decreased (0.166449 --> 0.166123).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 38 cost time: 0.9384403228759766
Epoch: 38, Steps: 64 | Train Loss: 0.1144503 Vali Loss: 0.1658891 Test Loss: 0.2230710
Validation loss decreased (0.166123 --> 0.165889).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 39 cost time: 0.9187908172607422
Epoch: 39, Steps: 64 | Train Loss: 0.1152187 Vali Loss: 0.1670863 Test Loss: 0.2234980
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 40 cost time: 0.918720006942749
Epoch: 40, Steps: 64 | Train Loss: 0.1141246 Vali Loss: 0.1669386 Test Loss: 0.2231085
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 41 cost time: 0.9220004081726074
Epoch: 41, Steps: 64 | Train Loss: 0.1141760 Vali Loss: 0.1644334 Test Loss: 0.2233152
Validation loss decreased (0.165889 --> 0.164433).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 42 cost time: 0.919621467590332
Epoch: 42, Steps: 64 | Train Loss: 0.1145359 Vali Loss: 0.1655018 Test Loss: 0.2233677
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 43 cost time: 0.9363498687744141
Epoch: 43, Steps: 64 | Train Loss: 0.1141416 Vali Loss: 0.1676057 Test Loss: 0.2238892
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 44 cost time: 0.9272758960723877
Epoch: 44, Steps: 64 | Train Loss: 0.1141841 Vali Loss: 0.1669136 Test Loss: 0.2239999
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 45 cost time: 0.9171173572540283
Epoch: 45, Steps: 64 | Train Loss: 0.1141618 Vali Loss: 0.1659748 Test Loss: 0.2236653
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 46 cost time: 0.9313631057739258
Epoch: 46, Steps: 64 | Train Loss: 0.1147142 Vali Loss: 0.1671644 Test Loss: 0.2237638
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 47 cost time: 0.9283547401428223
Epoch: 47, Steps: 64 | Train Loss: 0.1142955 Vali Loss: 0.1660558 Test Loss: 0.2234269
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 48 cost time: 0.9437723159790039
Epoch: 48, Steps: 64 | Train Loss: 0.1140508 Vali Loss: 0.1670841 Test Loss: 0.2242430
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 49 cost time: 0.9243581295013428
Epoch: 49, Steps: 64 | Train Loss: 0.1140281 Vali Loss: 0.1643490 Test Loss: 0.2233026
Validation loss decreased (0.164433 --> 0.164349).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 50 cost time: 0.9286167621612549
Epoch: 50, Steps: 64 | Train Loss: 0.1142131 Vali Loss: 0.1666175 Test Loss: 0.2236723
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 51 cost time: 0.9276154041290283
Epoch: 51, Steps: 64 | Train Loss: 0.1142793 Vali Loss: 0.1669919 Test Loss: 0.2234464
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 52 cost time: 0.9416158199310303
Epoch: 52, Steps: 64 | Train Loss: 0.1142153 Vali Loss: 0.1662185 Test Loss: 0.2237844
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 53 cost time: 0.9273335933685303
Epoch: 53, Steps: 64 | Train Loss: 0.1137976 Vali Loss: 0.1660538 Test Loss: 0.2241480
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 54 cost time: 0.9264435768127441
Epoch: 54, Steps: 64 | Train Loss: 0.1139173 Vali Loss: 0.1677102 Test Loss: 0.2244809
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 55 cost time: 0.938356876373291
Epoch: 55, Steps: 64 | Train Loss: 0.1136302 Vali Loss: 0.1653529 Test Loss: 0.2239714
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 56 cost time: 0.9287409782409668
Epoch: 56, Steps: 64 | Train Loss: 0.1140035 Vali Loss: 0.1652796 Test Loss: 0.2240155
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 57 cost time: 0.9267425537109375
Epoch: 57, Steps: 64 | Train Loss: 0.1139489 Vali Loss: 0.1627191 Test Loss: 0.2241465
Validation loss decreased (0.164349 --> 0.162719).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 58 cost time: 0.9260001182556152
Epoch: 58, Steps: 64 | Train Loss: 0.1143076 Vali Loss: 0.1662938 Test Loss: 0.2238230
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 59 cost time: 0.9242687225341797
Epoch: 59, Steps: 64 | Train Loss: 0.1138716 Vali Loss: 0.1652001 Test Loss: 0.2241041
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 60 cost time: 0.9213578701019287
Epoch: 60, Steps: 64 | Train Loss: 0.1139794 Vali Loss: 0.1669770 Test Loss: 0.2239320
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2241465300321579, mae:0.33792534470558167, rse:0.2399386167526245
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.04620790481567383 GB
Epoch: 1 cost time: 2.161191701889038
Epoch: 1, Steps: 64 | Train Loss: 0.9220736 Vali Loss: 2.3618686 Test Loss: 3.7325828
Validation loss decreased (inf --> 2.361869).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 2 cost time: 0.8184633255004883
Epoch: 2, Steps: 64 | Train Loss: 0.7502704 Vali Loss: 1.5417147 Test Loss: 2.4146504
Validation loss decreased (2.361869 --> 1.541715).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 3 cost time: 0.842623233795166
Epoch: 3, Steps: 64 | Train Loss: 0.5522012 Vali Loss: 1.1459862 Test Loss: 1.7680238
Validation loss decreased (1.541715 --> 1.145986).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 4 cost time: 0.8210005760192871
Epoch: 4, Steps: 64 | Train Loss: 0.4249774 Vali Loss: 0.8660066 Test Loss: 1.3115203
Validation loss decreased (1.145986 --> 0.866007).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 5 cost time: 0.8274171352386475
Epoch: 5, Steps: 64 | Train Loss: 0.3396812 Vali Loss: 0.6774446 Test Loss: 1.0195566
Validation loss decreased (0.866007 --> 0.677445).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 6 cost time: 0.8163392543792725
Epoch: 6, Steps: 64 | Train Loss: 0.2800359 Vali Loss: 0.5518550 Test Loss: 0.8199239
Validation loss decreased (0.677445 --> 0.551855).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 7 cost time: 0.8154253959655762
Epoch: 7, Steps: 64 | Train Loss: 0.2395195 Vali Loss: 0.4649951 Test Loss: 0.6790439
Validation loss decreased (0.551855 --> 0.464995).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 8 cost time: 0.8156147003173828
Epoch: 8, Steps: 64 | Train Loss: 0.2119768 Vali Loss: 0.3957853 Test Loss: 0.5733010
Validation loss decreased (0.464995 --> 0.395785).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 9 cost time: 0.8166191577911377
Epoch: 9, Steps: 64 | Train Loss: 0.1910835 Vali Loss: 0.3409545 Test Loss: 0.4878277
Validation loss decreased (0.395785 --> 0.340955).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 10 cost time: 0.8038334846496582
Epoch: 10, Steps: 64 | Train Loss: 0.1762382 Vali Loss: 0.3120452 Test Loss: 0.4365456
Validation loss decreased (0.340955 --> 0.312045).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 11 cost time: 0.8213670253753662
Epoch: 11, Steps: 64 | Train Loss: 0.1659036 Vali Loss: 0.2787091 Test Loss: 0.3898518
Validation loss decreased (0.312045 --> 0.278709).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 12 cost time: 0.8128273487091064
Epoch: 12, Steps: 64 | Train Loss: 0.1577968 Vali Loss: 0.2627886 Test Loss: 0.3651539
Validation loss decreased (0.278709 --> 0.262789).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 13 cost time: 0.8273715972900391
Epoch: 13, Steps: 64 | Train Loss: 0.1517651 Vali Loss: 0.2457236 Test Loss: 0.3380353
Validation loss decreased (0.262789 --> 0.245724).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 14 cost time: 0.8246119022369385
Epoch: 14, Steps: 64 | Train Loss: 0.1474918 Vali Loss: 0.2346013 Test Loss: 0.3181387
Validation loss decreased (0.245724 --> 0.234601).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 15 cost time: 0.820497989654541
Epoch: 15, Steps: 64 | Train Loss: 0.1431804 Vali Loss: 0.2230692 Test Loss: 0.3008522
Validation loss decreased (0.234601 --> 0.223069).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 16 cost time: 0.8140544891357422
Epoch: 16, Steps: 64 | Train Loss: 0.1405900 Vali Loss: 0.2188634 Test Loss: 0.2923604
Validation loss decreased (0.223069 --> 0.218863).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 17 cost time: 0.8237559795379639
Epoch: 17, Steps: 64 | Train Loss: 0.1384092 Vali Loss: 0.2135792 Test Loss: 0.2849012
Validation loss decreased (0.218863 --> 0.213579).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 18 cost time: 0.8139944076538086
Epoch: 18, Steps: 64 | Train Loss: 0.1361329 Vali Loss: 0.2082375 Test Loss: 0.2766243
Validation loss decreased (0.213579 --> 0.208237).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 19 cost time: 0.8123269081115723
Epoch: 19, Steps: 64 | Train Loss: 0.1350206 Vali Loss: 0.2015550 Test Loss: 0.2682318
Validation loss decreased (0.208237 --> 0.201555).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 20 cost time: 0.8143863677978516
Epoch: 20, Steps: 64 | Train Loss: 0.1337807 Vali Loss: 0.1996635 Test Loss: 0.2644010
Validation loss decreased (0.201555 --> 0.199663).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 21 cost time: 0.8383891582489014
Epoch: 21, Steps: 64 | Train Loss: 0.1334654 Vali Loss: 0.1980084 Test Loss: 0.2622510
Validation loss decreased (0.199663 --> 0.198008).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 22 cost time: 0.8214187622070312
Epoch: 22, Steps: 64 | Train Loss: 0.1324331 Vali Loss: 0.1960716 Test Loss: 0.2586156
Validation loss decreased (0.198008 --> 0.196072).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 23 cost time: 0.8159999847412109
Epoch: 23, Steps: 64 | Train Loss: 0.1311620 Vali Loss: 0.1929009 Test Loss: 0.2545588
Validation loss decreased (0.196072 --> 0.192901).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 24 cost time: 0.8164374828338623
Epoch: 24, Steps: 64 | Train Loss: 0.1299866 Vali Loss: 0.1907287 Test Loss: 0.2531946
Validation loss decreased (0.192901 --> 0.190729).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 25 cost time: 0.8264002799987793
Epoch: 25, Steps: 64 | Train Loss: 0.1300652 Vali Loss: 0.1931892 Test Loss: 0.2518694
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 26 cost time: 0.8168110847473145
Epoch: 26, Steps: 64 | Train Loss: 0.1292108 Vali Loss: 0.1886208 Test Loss: 0.2486919
Validation loss decreased (0.190729 --> 0.188621).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 27 cost time: 0.8114140033721924
Epoch: 27, Steps: 64 | Train Loss: 0.1294463 Vali Loss: 0.1880468 Test Loss: 0.2487307
Validation loss decreased (0.188621 --> 0.188047).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 28 cost time: 0.8156390190124512
Epoch: 28, Steps: 64 | Train Loss: 0.1287975 Vali Loss: 0.1874667 Test Loss: 0.2469393
Validation loss decreased (0.188047 --> 0.187467).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 29 cost time: 0.810340404510498
Epoch: 29, Steps: 64 | Train Loss: 0.1286713 Vali Loss: 0.1871036 Test Loss: 0.2451276
Validation loss decreased (0.187467 --> 0.187104).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 30 cost time: 0.819329023361206
Epoch: 30, Steps: 64 | Train Loss: 0.1276704 Vali Loss: 0.1860849 Test Loss: 0.2437883
Validation loss decreased (0.187104 --> 0.186085).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 31 cost time: 0.8227484226226807
Epoch: 31, Steps: 64 | Train Loss: 0.1282223 Vali Loss: 0.1869624 Test Loss: 0.2455305
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 32 cost time: 0.8373353481292725
Epoch: 32, Steps: 64 | Train Loss: 0.1274867 Vali Loss: 0.1855298 Test Loss: 0.2417407
Validation loss decreased (0.186085 --> 0.185530).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 33 cost time: 0.8236165046691895
Epoch: 33, Steps: 64 | Train Loss: 0.1274071 Vali Loss: 0.1833971 Test Loss: 0.2427268
Validation loss decreased (0.185530 --> 0.183397).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 34 cost time: 0.8153669834136963
Epoch: 34, Steps: 64 | Train Loss: 0.1272350 Vali Loss: 0.1851300 Test Loss: 0.2418286
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 35 cost time: 0.8155019283294678
Epoch: 35, Steps: 64 | Train Loss: 0.1272188 Vali Loss: 0.1845516 Test Loss: 0.2428922
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 36 cost time: 0.8314502239227295
Epoch: 36, Steps: 64 | Train Loss: 0.1275297 Vali Loss: 0.1820545 Test Loss: 0.2400163
Validation loss decreased (0.183397 --> 0.182055).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 37 cost time: 0.8159997463226318
Epoch: 37, Steps: 64 | Train Loss: 0.1261529 Vali Loss: 0.1851617 Test Loss: 0.2396162
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 38 cost time: 0.8163959980010986
Epoch: 38, Steps: 64 | Train Loss: 0.1272956 Vali Loss: 0.1837602 Test Loss: 0.2401693
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 39 cost time: 0.818364143371582
Epoch: 39, Steps: 64 | Train Loss: 0.1266007 Vali Loss: 0.1839051 Test Loss: 0.2398399
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 40 cost time: 0.8317608833312988
Epoch: 40, Steps: 64 | Train Loss: 0.1261267 Vali Loss: 0.1831900 Test Loss: 0.2405990
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 41 cost time: 0.8194630146026611
Epoch: 41, Steps: 64 | Train Loss: 0.1262384 Vali Loss: 0.1821973 Test Loss: 0.2393873
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 42 cost time: 0.8176143169403076
Epoch: 42, Steps: 64 | Train Loss: 0.1266038 Vali Loss: 0.1813365 Test Loss: 0.2395201
Validation loss decreased (0.182055 --> 0.181336).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 43 cost time: 0.8163139820098877
Epoch: 43, Steps: 64 | Train Loss: 0.1264773 Vali Loss: 0.1827308 Test Loss: 0.2383780
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 44 cost time: 0.8294525146484375
Epoch: 44, Steps: 64 | Train Loss: 0.1264180 Vali Loss: 0.1820344 Test Loss: 0.2385028
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 45 cost time: 0.8177332878112793
Epoch: 45, Steps: 64 | Train Loss: 0.1260325 Vali Loss: 0.1826752 Test Loss: 0.2398111
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 46 cost time: 0.8183646202087402
Epoch: 46, Steps: 64 | Train Loss: 0.1253739 Vali Loss: 0.1817433 Test Loss: 0.2380239
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 47 cost time: 0.8194098472595215
Epoch: 47, Steps: 64 | Train Loss: 0.1265738 Vali Loss: 0.1804510 Test Loss: 0.2370350
Validation loss decreased (0.181336 --> 0.180451).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 48 cost time: 0.8293941020965576
Epoch: 48, Steps: 64 | Train Loss: 0.1266675 Vali Loss: 0.1825014 Test Loss: 0.2368779
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 49 cost time: 0.8193707466125488
Epoch: 49, Steps: 64 | Train Loss: 0.1257255 Vali Loss: 0.1792627 Test Loss: 0.2372457
Validation loss decreased (0.180451 --> 0.179263).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 50 cost time: 0.8159999847412109
Epoch: 50, Steps: 64 | Train Loss: 0.1254594 Vali Loss: 0.1819363 Test Loss: 0.2375441
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 51 cost time: 0.8196003437042236
Epoch: 51, Steps: 64 | Train Loss: 0.1260137 Vali Loss: 0.1808772 Test Loss: 0.2367187
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 52 cost time: 0.7792284488677979
Epoch: 52, Steps: 64 | Train Loss: 0.1257253 Vali Loss: 0.1800604 Test Loss: 0.2363547
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 53 cost time: 0.775414228439331
Epoch: 53, Steps: 64 | Train Loss: 0.1260494 Vali Loss: 0.1791622 Test Loss: 0.2367338
Validation loss decreased (0.179263 --> 0.179162).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 54 cost time: 0.7831308841705322
Epoch: 54, Steps: 64 | Train Loss: 0.1257092 Vali Loss: 0.1822999 Test Loss: 0.2377159
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 55 cost time: 0.7928693294525146
Epoch: 55, Steps: 64 | Train Loss: 0.1250426 Vali Loss: 0.1803271 Test Loss: 0.2377498
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 56 cost time: 0.7973740100860596
Epoch: 56, Steps: 64 | Train Loss: 0.1252592 Vali Loss: 0.1820801 Test Loss: 0.2368929
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 57 cost time: 0.8233695030212402
Epoch: 57, Steps: 64 | Train Loss: 0.1256379 Vali Loss: 0.1800733 Test Loss: 0.2368690
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 58 cost time: 0.8187432289123535
Epoch: 58, Steps: 64 | Train Loss: 0.1251942 Vali Loss: 0.1816728 Test Loss: 0.2379339
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 59 cost time: 0.8339998722076416
Epoch: 59, Steps: 64 | Train Loss: 0.1253269 Vali Loss: 0.1796160 Test Loss: 0.2375163
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 60 cost time: 0.8239631652832031
Epoch: 60, Steps: 64 | Train Loss: 0.1256329 Vali Loss: 0.1813313 Test Loss: 0.2359286
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23673385381698608, mae:0.35295504331588745, rse:0.24658368527889252
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 1 cost time: 2.2922871112823486
Epoch: 1, Steps: 64 | Train Loss: 0.8768958 Vali Loss: 2.3408666 Test Loss: 3.7164183
Validation loss decreased (inf --> 2.340867).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 2 cost time: 0.9130275249481201
Epoch: 2, Steps: 64 | Train Loss: 0.5403490 Vali Loss: 0.4624008 Test Loss: 0.6824931
Validation loss decreased (2.340867 --> 0.462401).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 3 cost time: 0.9112160205841064
Epoch: 3, Steps: 64 | Train Loss: 0.1723064 Vali Loss: 0.1851514 Test Loss: 0.2244543
Validation loss decreased (0.462401 --> 0.185151).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 4 cost time: 0.915747880935669
Epoch: 4, Steps: 64 | Train Loss: 0.1397349 Vali Loss: 0.1885947 Test Loss: 0.2320888
EarlyStopping counter: 1 out of 100
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 5 cost time: 0.9173421859741211
Epoch: 5, Steps: 64 | Train Loss: 0.1338922 Vali Loss: 0.1815167 Test Loss: 0.2257186
Validation loss decreased (0.185151 --> 0.181517).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 6 cost time: 0.9220008850097656
Epoch: 6, Steps: 64 | Train Loss: 0.1302717 Vali Loss: 0.1788659 Test Loss: 0.2254710
Validation loss decreased (0.181517 --> 0.178866).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 7 cost time: 0.9126408100128174
Epoch: 7, Steps: 64 | Train Loss: 0.1282370 Vali Loss: 0.1727339 Test Loss: 0.2223343
Validation loss decreased (0.178866 --> 0.172734).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 8 cost time: 0.9123842716217041
Epoch: 8, Steps: 64 | Train Loss: 0.1259512 Vali Loss: 0.1754553 Test Loss: 0.2222511
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 9 cost time: 0.9080257415771484
Epoch: 9, Steps: 64 | Train Loss: 0.1241094 Vali Loss: 0.1721073 Test Loss: 0.2218919
Validation loss decreased (0.172734 --> 0.172107).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 10 cost time: 0.9283533096313477
Epoch: 10, Steps: 64 | Train Loss: 0.1228007 Vali Loss: 0.1723098 Test Loss: 0.2206837
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 11 cost time: 0.9114420413970947
Epoch: 11, Steps: 64 | Train Loss: 0.1214721 Vali Loss: 0.1730373 Test Loss: 0.2210143
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 12 cost time: 0.9157099723815918
Epoch: 12, Steps: 64 | Train Loss: 0.1206133 Vali Loss: 0.1697228 Test Loss: 0.2208088
Validation loss decreased (0.172107 --> 0.169723).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 13 cost time: 0.9280002117156982
Epoch: 13, Steps: 64 | Train Loss: 0.1195313 Vali Loss: 0.1722895 Test Loss: 0.2201710
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 14 cost time: 0.9136285781860352
Epoch: 14, Steps: 64 | Train Loss: 0.1181838 Vali Loss: 0.1703572 Test Loss: 0.2202923
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 15 cost time: 0.9116201400756836
Epoch: 15, Steps: 64 | Train Loss: 0.1175908 Vali Loss: 0.1696137 Test Loss: 0.2209543
Validation loss decreased (0.169723 --> 0.169614).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 16 cost time: 0.9101250171661377
Epoch: 16, Steps: 64 | Train Loss: 0.1169293 Vali Loss: 0.1691181 Test Loss: 0.2212664
Validation loss decreased (0.169614 --> 0.169118).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 17 cost time: 0.9133522510528564
Epoch: 17, Steps: 64 | Train Loss: 0.1172301 Vali Loss: 0.1696697 Test Loss: 0.2210526
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 18 cost time: 0.9167811870574951
Epoch: 18, Steps: 64 | Train Loss: 0.1170546 Vali Loss: 0.1679632 Test Loss: 0.2206173
Validation loss decreased (0.169118 --> 0.167963).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 19 cost time: 0.9174199104309082
Epoch: 19, Steps: 64 | Train Loss: 0.1162293 Vali Loss: 0.1688605 Test Loss: 0.2205581
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 20 cost time: 0.928818941116333
Epoch: 20, Steps: 64 | Train Loss: 0.1154278 Vali Loss: 0.1685350 Test Loss: 0.2205625
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 21 cost time: 0.912999153137207
Epoch: 21, Steps: 64 | Train Loss: 0.1151552 Vali Loss: 0.1683205 Test Loss: 0.2223632
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 22 cost time: 0.9133305549621582
Epoch: 22, Steps: 64 | Train Loss: 0.1146216 Vali Loss: 0.1693768 Test Loss: 0.2216243
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 23 cost time: 0.9110109806060791
Epoch: 23, Steps: 64 | Train Loss: 0.1149395 Vali Loss: 0.1690830 Test Loss: 0.2215725
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 24 cost time: 0.9153892993927002
Epoch: 24, Steps: 64 | Train Loss: 0.1146228 Vali Loss: 0.1683822 Test Loss: 0.2223162
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 25 cost time: 0.9102091789245605
Epoch: 25, Steps: 64 | Train Loss: 0.1139419 Vali Loss: 0.1679562 Test Loss: 0.2214595
Validation loss decreased (0.167963 --> 0.167956).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 26 cost time: 0.9083614349365234
Epoch: 26, Steps: 64 | Train Loss: 0.1140471 Vali Loss: 0.1675965 Test Loss: 0.2226778
Validation loss decreased (0.167956 --> 0.167596).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 27 cost time: 0.913341760635376
Epoch: 27, Steps: 64 | Train Loss: 0.1142257 Vali Loss: 0.1696039 Test Loss: 0.2231602
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 28 cost time: 0.9118716716766357
Epoch: 28, Steps: 64 | Train Loss: 0.1138214 Vali Loss: 0.1675986 Test Loss: 0.2230316
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 29 cost time: 0.9119396209716797
Epoch: 29, Steps: 64 | Train Loss: 0.1137759 Vali Loss: 0.1689662 Test Loss: 0.2226421
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 30 cost time: 0.9233760833740234
Epoch: 30, Steps: 64 | Train Loss: 0.1135418 Vali Loss: 0.1685565 Test Loss: 0.2231065
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 31 cost time: 0.9033811092376709
Epoch: 31, Steps: 64 | Train Loss: 0.1134642 Vali Loss: 0.1675376 Test Loss: 0.2228970
Validation loss decreased (0.167596 --> 0.167538).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 32 cost time: 0.8993604183197021
Epoch: 32, Steps: 64 | Train Loss: 0.1128926 Vali Loss: 0.1673266 Test Loss: 0.2235360
Validation loss decreased (0.167538 --> 0.167327).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 33 cost time: 0.8973925113677979
Epoch: 33, Steps: 64 | Train Loss: 0.1129053 Vali Loss: 0.1684951 Test Loss: 0.2235495
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 34 cost time: 0.9083480834960938
Epoch: 34, Steps: 64 | Train Loss: 0.1129958 Vali Loss: 0.1662996 Test Loss: 0.2236309
Validation loss decreased (0.167327 --> 0.166300).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 35 cost time: 0.9181854724884033
Epoch: 35, Steps: 64 | Train Loss: 0.1129054 Vali Loss: 0.1668855 Test Loss: 0.2227896
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 36 cost time: 0.9160001277923584
Epoch: 36, Steps: 64 | Train Loss: 0.1130015 Vali Loss: 0.1685622 Test Loss: 0.2233911
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 37 cost time: 0.9159984588623047
Epoch: 37, Steps: 64 | Train Loss: 0.1127917 Vali Loss: 0.1697365 Test Loss: 0.2226549
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 38 cost time: 0.9146149158477783
Epoch: 38, Steps: 64 | Train Loss: 0.1130244 Vali Loss: 0.1665518 Test Loss: 0.2227824
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 39 cost time: 0.903346061706543
Epoch: 39, Steps: 64 | Train Loss: 0.1130340 Vali Loss: 0.1686992 Test Loss: 0.2227763
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 40 cost time: 0.9020488262176514
Epoch: 40, Steps: 64 | Train Loss: 0.1128028 Vali Loss: 0.1690313 Test Loss: 0.2233004
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 41 cost time: 0.9154911041259766
Epoch: 41, Steps: 64 | Train Loss: 0.1124420 Vali Loss: 0.1689161 Test Loss: 0.2229607
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 42 cost time: 0.8995676040649414
Epoch: 42, Steps: 64 | Train Loss: 0.1126661 Vali Loss: 0.1686062 Test Loss: 0.2234773
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 43 cost time: 0.9004428386688232
Epoch: 43, Steps: 64 | Train Loss: 0.1130455 Vali Loss: 0.1670549 Test Loss: 0.2234815
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 44 cost time: 0.9290001392364502
Epoch: 44, Steps: 64 | Train Loss: 0.1126337 Vali Loss: 0.1684169 Test Loss: 0.2233142
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 45 cost time: 0.9126203060150146
Epoch: 45, Steps: 64 | Train Loss: 0.1124076 Vali Loss: 0.1684644 Test Loss: 0.2231861
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 46 cost time: 0.9123430252075195
Epoch: 46, Steps: 64 | Train Loss: 0.1123247 Vali Loss: 0.1675483 Test Loss: 0.2231399
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 47 cost time: 0.9131665229797363
Epoch: 47, Steps: 64 | Train Loss: 0.1126509 Vali Loss: 0.1678304 Test Loss: 0.2234838
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 48 cost time: 0.878387451171875
Epoch: 48, Steps: 64 | Train Loss: 0.1125233 Vali Loss: 0.1670572 Test Loss: 0.2242550
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 49 cost time: 0.9053986072540283
Epoch: 49, Steps: 64 | Train Loss: 0.1120877 Vali Loss: 0.1672000 Test Loss: 0.2238795
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 50 cost time: 0.9047353267669678
Epoch: 50, Steps: 64 | Train Loss: 0.1120132 Vali Loss: 0.1687398 Test Loss: 0.2236443
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 51 cost time: 0.9019997119903564
Epoch: 51, Steps: 64 | Train Loss: 0.1130029 Vali Loss: 0.1685992 Test Loss: 0.2238997
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 52 cost time: 0.9136381149291992
Epoch: 52, Steps: 64 | Train Loss: 0.1123000 Vali Loss: 0.1694916 Test Loss: 0.2234111
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 53 cost time: 0.9126205444335938
Epoch: 53, Steps: 64 | Train Loss: 0.1126509 Vali Loss: 0.1683611 Test Loss: 0.2233165
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 54 cost time: 0.9133651256561279
Epoch: 54, Steps: 64 | Train Loss: 0.1121386 Vali Loss: 0.1681228 Test Loss: 0.2233725
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 55 cost time: 0.8942203521728516
Epoch: 55, Steps: 64 | Train Loss: 0.1118924 Vali Loss: 0.1670301 Test Loss: 0.2239217
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 56 cost time: 0.9130520820617676
Epoch: 56, Steps: 64 | Train Loss: 0.1123958 Vali Loss: 0.1676420 Test Loss: 0.2238626
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 57 cost time: 0.9088270664215088
Epoch: 57, Steps: 64 | Train Loss: 0.1123582 Vali Loss: 0.1685600 Test Loss: 0.2237762
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 58 cost time: 0.9149999618530273
Epoch: 58, Steps: 64 | Train Loss: 0.1123766 Vali Loss: 0.1667188 Test Loss: 0.2238407
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 59 cost time: 0.906611442565918
Epoch: 59, Steps: 64 | Train Loss: 0.1126952 Vali Loss: 0.1687236 Test Loss: 0.2241056
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 60 cost time: 0.9094576835632324
Epoch: 60, Steps: 64 | Train Loss: 0.1121268 Vali Loss: 0.1671268 Test Loss: 0.2230869
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2236308753490448, mae:0.3384360671043396, rse:0.23966245353221893
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.053494930267333984 GB
Epoch: 1 cost time: 2.2988522052764893
Epoch: 1, Steps: 64 | Train Loss: 0.8728162 Vali Loss: 2.3712347 Test Loss: 3.7963848
Validation loss decreased (inf --> 2.371235).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 2 cost time: 0.9498410224914551
Epoch: 2, Steps: 64 | Train Loss: 0.4751959 Vali Loss: 0.1938314 Test Loss: 0.2428745
Validation loss decreased (2.371235 --> 0.193831).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 3 cost time: 0.9553265571594238
Epoch: 3, Steps: 64 | Train Loss: 0.1515075 Vali Loss: 0.2112919 Test Loss: 0.2591528
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 4 cost time: 0.9553937911987305
Epoch: 4, Steps: 64 | Train Loss: 0.1360402 Vali Loss: 0.1791910 Test Loss: 0.2259560
Validation loss decreased (0.193831 --> 0.179191).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 5 cost time: 0.9540266990661621
Epoch: 5, Steps: 64 | Train Loss: 0.1315386 Vali Loss: 0.1800234 Test Loss: 0.2260524
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 6 cost time: 0.945305347442627
Epoch: 6, Steps: 64 | Train Loss: 0.1280598 Vali Loss: 0.1814147 Test Loss: 0.2282407
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 7 cost time: 0.9457924365997314
Epoch: 7, Steps: 64 | Train Loss: 0.1254139 Vali Loss: 0.1772034 Test Loss: 0.2262562
Validation loss decreased (0.179191 --> 0.177203).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 8 cost time: 0.9490010738372803
Epoch: 8, Steps: 64 | Train Loss: 0.1233793 Vali Loss: 0.1759501 Test Loss: 0.2260154
Validation loss decreased (0.177203 --> 0.175950).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 9 cost time: 0.9549334049224854
Epoch: 9, Steps: 64 | Train Loss: 0.1229692 Vali Loss: 0.1739232 Test Loss: 0.2258053
Validation loss decreased (0.175950 --> 0.173923).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 10 cost time: 0.9606020450592041
Epoch: 10, Steps: 64 | Train Loss: 0.1212455 Vali Loss: 0.1731392 Test Loss: 0.2253504
Validation loss decreased (0.173923 --> 0.173139).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 11 cost time: 0.9663751125335693
Epoch: 11, Steps: 64 | Train Loss: 0.1198063 Vali Loss: 0.1735412 Test Loss: 0.2253872
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 12 cost time: 0.961341381072998
Epoch: 12, Steps: 64 | Train Loss: 0.1186141 Vali Loss: 0.1755557 Test Loss: 0.2273749
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 13 cost time: 0.9559698104858398
Epoch: 13, Steps: 64 | Train Loss: 0.1187753 Vali Loss: 0.1718053 Test Loss: 0.2260319
Validation loss decreased (0.173139 --> 0.171805).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 14 cost time: 0.9484646320343018
Epoch: 14, Steps: 64 | Train Loss: 0.1178551 Vali Loss: 0.1725166 Test Loss: 0.2265407
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 15 cost time: 0.9437477588653564
Epoch: 15, Steps: 64 | Train Loss: 0.1167824 Vali Loss: 0.1706606 Test Loss: 0.2261640
Validation loss decreased (0.171805 --> 0.170661).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 16 cost time: 0.9394383430480957
Epoch: 16, Steps: 64 | Train Loss: 0.1165307 Vali Loss: 0.1706071 Test Loss: 0.2285739
Validation loss decreased (0.170661 --> 0.170607).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 17 cost time: 0.939842700958252
Epoch: 17, Steps: 64 | Train Loss: 0.1158599 Vali Loss: 0.1710320 Test Loss: 0.2275152
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 18 cost time: 0.9601085186004639
Epoch: 18, Steps: 64 | Train Loss: 0.1154889 Vali Loss: 0.1684379 Test Loss: 0.2282539
Validation loss decreased (0.170607 --> 0.168438).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 19 cost time: 0.9509997367858887
Epoch: 19, Steps: 64 | Train Loss: 0.1151851 Vali Loss: 0.1722027 Test Loss: 0.2302628
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 20 cost time: 0.945000171661377
Epoch: 20, Steps: 64 | Train Loss: 0.1142397 Vali Loss: 0.1711874 Test Loss: 0.2304299
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 21 cost time: 0.9539794921875
Epoch: 21, Steps: 64 | Train Loss: 0.1147468 Vali Loss: 0.1704618 Test Loss: 0.2310958
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 22 cost time: 0.9393863677978516
Epoch: 22, Steps: 64 | Train Loss: 0.1146077 Vali Loss: 0.1725192 Test Loss: 0.2305450
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 23 cost time: 0.9424278736114502
Epoch: 23, Steps: 64 | Train Loss: 0.1142943 Vali Loss: 0.1708109 Test Loss: 0.2302781
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 24 cost time: 0.9384002685546875
Epoch: 24, Steps: 64 | Train Loss: 0.1138137 Vali Loss: 0.1709149 Test Loss: 0.2316166
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 25 cost time: 0.9223856925964355
Epoch: 25, Steps: 64 | Train Loss: 0.1136914 Vali Loss: 0.1712810 Test Loss: 0.2313309
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 26 cost time: 0.9404020309448242
Epoch: 26, Steps: 64 | Train Loss: 0.1134443 Vali Loss: 0.1690693 Test Loss: 0.2311131
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 27 cost time: 0.9457194805145264
Epoch: 27, Steps: 64 | Train Loss: 0.1135874 Vali Loss: 0.1713528 Test Loss: 0.2329323
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 28 cost time: 0.9310002326965332
Epoch: 28, Steps: 64 | Train Loss: 0.1128998 Vali Loss: 0.1704659 Test Loss: 0.2317059
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 29 cost time: 1.0237321853637695
Epoch: 29, Steps: 64 | Train Loss: 0.1133596 Vali Loss: 0.1703100 Test Loss: 0.2326716
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 30 cost time: 0.9309999942779541
Epoch: 30, Steps: 64 | Train Loss: 0.1131596 Vali Loss: 0.1714516 Test Loss: 0.2317425
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 31 cost time: 0.933619499206543
Epoch: 31, Steps: 64 | Train Loss: 0.1133178 Vali Loss: 0.1708191 Test Loss: 0.2325499
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 32 cost time: 0.9383363723754883
Epoch: 32, Steps: 64 | Train Loss: 0.1124891 Vali Loss: 0.1704369 Test Loss: 0.2322340
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 33 cost time: 0.9423456192016602
Epoch: 33, Steps: 64 | Train Loss: 0.1127963 Vali Loss: 0.1702169 Test Loss: 0.2328360
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 34 cost time: 0.9483401775360107
Epoch: 34, Steps: 64 | Train Loss: 0.1131732 Vali Loss: 0.1721515 Test Loss: 0.2329090
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 35 cost time: 0.9493792057037354
Epoch: 35, Steps: 64 | Train Loss: 0.1129907 Vali Loss: 0.1716642 Test Loss: 0.2328763
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 36 cost time: 0.9464082717895508
Epoch: 36, Steps: 64 | Train Loss: 0.1119456 Vali Loss: 0.1731056 Test Loss: 0.2330383
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 37 cost time: 0.9437980651855469
Epoch: 37, Steps: 64 | Train Loss: 0.1126461 Vali Loss: 0.1708756 Test Loss: 0.2337506
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 38 cost time: 0.9474000930786133
Epoch: 38, Steps: 64 | Train Loss: 0.1123523 Vali Loss: 0.1719496 Test Loss: 0.2339668
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 39 cost time: 0.9320001602172852
Epoch: 39, Steps: 64 | Train Loss: 0.1126141 Vali Loss: 0.1706948 Test Loss: 0.2333734
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 40 cost time: 0.9336180686950684
Epoch: 40, Steps: 64 | Train Loss: 0.1126115 Vali Loss: 0.1701566 Test Loss: 0.2334536
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 41 cost time: 0.941612720489502
Epoch: 41, Steps: 64 | Train Loss: 0.1128921 Vali Loss: 0.1699892 Test Loss: 0.2330800
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 42 cost time: 0.9523262977600098
Epoch: 42, Steps: 64 | Train Loss: 0.1128493 Vali Loss: 0.1715710 Test Loss: 0.2333414
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 43 cost time: 0.9423649311065674
Epoch: 43, Steps: 64 | Train Loss: 0.1128279 Vali Loss: 0.1720617 Test Loss: 0.2333361
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 44 cost time: 0.9483513832092285
Epoch: 44, Steps: 64 | Train Loss: 0.1121338 Vali Loss: 0.1720245 Test Loss: 0.2338112
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 45 cost time: 0.9073741436004639
Epoch: 45, Steps: 64 | Train Loss: 0.1120965 Vali Loss: 0.1699513 Test Loss: 0.2342470
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 46 cost time: 0.912172794342041
Epoch: 46, Steps: 64 | Train Loss: 0.1122725 Vali Loss: 0.1686634 Test Loss: 0.2343023
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 47 cost time: 0.9387786388397217
Epoch: 47, Steps: 64 | Train Loss: 0.1121857 Vali Loss: 0.1714881 Test Loss: 0.2335257
EarlyStopping counter: 29 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 48 cost time: 0.9339995384216309
Epoch: 48, Steps: 64 | Train Loss: 0.1121841 Vali Loss: 0.1717557 Test Loss: 0.2345681
EarlyStopping counter: 30 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 49 cost time: 0.930626630783081
Epoch: 49, Steps: 64 | Train Loss: 0.1119483 Vali Loss: 0.1715139 Test Loss: 0.2342976
EarlyStopping counter: 31 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 50 cost time: 0.9480423927307129
Epoch: 50, Steps: 64 | Train Loss: 0.1125529 Vali Loss: 0.1722719 Test Loss: 0.2341569
EarlyStopping counter: 32 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 51 cost time: 0.9493703842163086
Epoch: 51, Steps: 64 | Train Loss: 0.1123256 Vali Loss: 0.1722052 Test Loss: 0.2342531
EarlyStopping counter: 33 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 52 cost time: 0.942439079284668
Epoch: 52, Steps: 64 | Train Loss: 0.1122400 Vali Loss: 0.1703480 Test Loss: 0.2345178
EarlyStopping counter: 34 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 53 cost time: 0.9434511661529541
Epoch: 53, Steps: 64 | Train Loss: 0.1122132 Vali Loss: 0.1708813 Test Loss: 0.2337282
EarlyStopping counter: 35 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 54 cost time: 0.9363958835601807
Epoch: 54, Steps: 64 | Train Loss: 0.1123920 Vali Loss: 0.1716283 Test Loss: 0.2346268
EarlyStopping counter: 36 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 55 cost time: 0.9413301944732666
Epoch: 55, Steps: 64 | Train Loss: 0.1123217 Vali Loss: 0.1720582 Test Loss: 0.2357594
EarlyStopping counter: 37 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 56 cost time: 0.9317538738250732
Epoch: 56, Steps: 64 | Train Loss: 0.1120311 Vali Loss: 0.1708862 Test Loss: 0.2344937
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 57 cost time: 0.9359991550445557
Epoch: 57, Steps: 64 | Train Loss: 0.1118267 Vali Loss: 0.1714765 Test Loss: 0.2334596
EarlyStopping counter: 39 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 58 cost time: 0.9606301784515381
Epoch: 58, Steps: 64 | Train Loss: 0.1119198 Vali Loss: 0.1688509 Test Loss: 0.2336089
EarlyStopping counter: 40 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 59 cost time: 0.9416172504425049
Epoch: 59, Steps: 64 | Train Loss: 0.1117432 Vali Loss: 0.1717810 Test Loss: 0.2342263
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 60 cost time: 0.9434030055999756
Epoch: 60, Steps: 64 | Train Loss: 0.1118250 Vali Loss: 0.1721142 Test Loss: 0.2342509
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22825390100479126, mae:0.3473992347717285, rse:0.24212700128555298
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.049500465393066406 GB
Epoch: 1 cost time: 2.171889066696167
Epoch: 1, Steps: 64 | Train Loss: 0.9438943 Vali Loss: 2.4072211 Test Loss: 3.8478389
Validation loss decreased (inf --> 2.407221).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 2 cost time: 0.8493728637695312
Epoch: 2, Steps: 64 | Train Loss: 0.8063648 Vali Loss: 1.7660978 Test Loss: 2.7906935
Validation loss decreased (2.407221 --> 1.766098).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 3 cost time: 0.8487658500671387
Epoch: 3, Steps: 64 | Train Loss: 0.6321358 Vali Loss: 1.3686165 Test Loss: 2.1213105
Validation loss decreased (1.766098 --> 1.368616).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 4 cost time: 0.8469998836517334
Epoch: 4, Steps: 64 | Train Loss: 0.5010342 Vali Loss: 1.0561517 Test Loss: 1.6179959
Validation loss decreased (1.368616 --> 1.056152).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 5 cost time: 0.8606226444244385
Epoch: 5, Steps: 64 | Train Loss: 0.4012261 Vali Loss: 0.8287936 Test Loss: 1.2554407
Validation loss decreased (1.056152 --> 0.828794).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 6 cost time: 0.8443844318389893
Epoch: 6, Steps: 64 | Train Loss: 0.3297100 Vali Loss: 0.6666387 Test Loss: 0.9960999
Validation loss decreased (0.828794 --> 0.666639).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 7 cost time: 0.8493647575378418
Epoch: 7, Steps: 64 | Train Loss: 0.2780215 Vali Loss: 0.5528804 Test Loss: 0.8184180
Validation loss decreased (0.666639 --> 0.552880).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 8 cost time: 0.847834587097168
Epoch: 8, Steps: 64 | Train Loss: 0.2420536 Vali Loss: 0.4671390 Test Loss: 0.6847731
Validation loss decreased (0.552880 --> 0.467139).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 9 cost time: 0.8400018215179443
Epoch: 9, Steps: 64 | Train Loss: 0.2167352 Vali Loss: 0.4147384 Test Loss: 0.6000165
Validation loss decreased (0.467139 --> 0.414738).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 10 cost time: 0.849623441696167
Epoch: 10, Steps: 64 | Train Loss: 0.1972582 Vali Loss: 0.3715521 Test Loss: 0.5288064
Validation loss decreased (0.414738 --> 0.371552).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 11 cost time: 0.8460233211517334
Epoch: 11, Steps: 64 | Train Loss: 0.1843629 Vali Loss: 0.3367700 Test Loss: 0.4761643
Validation loss decreased (0.371552 --> 0.336770).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 12 cost time: 0.8483917713165283
Epoch: 12, Steps: 64 | Train Loss: 0.1748625 Vali Loss: 0.3181528 Test Loss: 0.4428427
Validation loss decreased (0.336770 --> 0.318153).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 13 cost time: 0.8514676094055176
Epoch: 13, Steps: 64 | Train Loss: 0.1670102 Vali Loss: 0.2910756 Test Loss: 0.4053480
Validation loss decreased (0.318153 --> 0.291076).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 14 cost time: 0.8470001220703125
Epoch: 14, Steps: 64 | Train Loss: 0.1608330 Vali Loss: 0.2805490 Test Loss: 0.3859969
Validation loss decreased (0.291076 --> 0.280549).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 15 cost time: 0.8469893932342529
Epoch: 15, Steps: 64 | Train Loss: 0.1562131 Vali Loss: 0.2661224 Test Loss: 0.3668560
Validation loss decreased (0.280549 --> 0.266122).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 16 cost time: 0.8613736629486084
Epoch: 16, Steps: 64 | Train Loss: 0.1511374 Vali Loss: 0.2564596 Test Loss: 0.3507178
Validation loss decreased (0.266122 --> 0.256460).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 17 cost time: 0.8463952541351318
Epoch: 17, Steps: 64 | Train Loss: 0.1488160 Vali Loss: 0.2488732 Test Loss: 0.3383585
Validation loss decreased (0.256460 --> 0.248873).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 18 cost time: 0.8455429077148438
Epoch: 18, Steps: 64 | Train Loss: 0.1465891 Vali Loss: 0.2418368 Test Loss: 0.3270179
Validation loss decreased (0.248873 --> 0.241837).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 19 cost time: 0.8469996452331543
Epoch: 19, Steps: 64 | Train Loss: 0.1441550 Vali Loss: 0.2336514 Test Loss: 0.3160208
Validation loss decreased (0.241837 --> 0.233651).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 20 cost time: 0.8606386184692383
Epoch: 20, Steps: 64 | Train Loss: 0.1421901 Vali Loss: 0.2304593 Test Loss: 0.3092551
Validation loss decreased (0.233651 --> 0.230459).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 21 cost time: 0.8484039306640625
Epoch: 21, Steps: 64 | Train Loss: 0.1411859 Vali Loss: 0.2265531 Test Loss: 0.3054287
Validation loss decreased (0.230459 --> 0.226553).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 22 cost time: 0.8523495197296143
Epoch: 22, Steps: 64 | Train Loss: 0.1405642 Vali Loss: 0.2212554 Test Loss: 0.2987467
Validation loss decreased (0.226553 --> 0.221255).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 23 cost time: 0.8517415523529053
Epoch: 23, Steps: 64 | Train Loss: 0.1386363 Vali Loss: 0.2199069 Test Loss: 0.2970251
Validation loss decreased (0.221255 --> 0.219907).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 24 cost time: 0.835430383682251
Epoch: 24, Steps: 64 | Train Loss: 0.1373291 Vali Loss: 0.2198238 Test Loss: 0.2932076
Validation loss decreased (0.219907 --> 0.219824).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 25 cost time: 0.8336260318756104
Epoch: 25, Steps: 64 | Train Loss: 0.1360732 Vali Loss: 0.2189561 Test Loss: 0.2928053
Validation loss decreased (0.219824 --> 0.218956).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 26 cost time: 0.8452262878417969
Epoch: 26, Steps: 64 | Train Loss: 0.1358970 Vali Loss: 0.2140999 Test Loss: 0.2848988
Validation loss decreased (0.218956 --> 0.214100).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 27 cost time: 0.8491415977478027
Epoch: 27, Steps: 64 | Train Loss: 0.1354532 Vali Loss: 0.2134989 Test Loss: 0.2846309
Validation loss decreased (0.214100 --> 0.213499).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 28 cost time: 0.8207519054412842
Epoch: 28, Steps: 64 | Train Loss: 0.1346880 Vali Loss: 0.2103686 Test Loss: 0.2825927
Validation loss decreased (0.213499 --> 0.210369).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 29 cost time: 0.8503341674804688
Epoch: 29, Steps: 64 | Train Loss: 0.1341823 Vali Loss: 0.2094650 Test Loss: 0.2795436
Validation loss decreased (0.210369 --> 0.209465).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 30 cost time: 0.8470041751861572
Epoch: 30, Steps: 64 | Train Loss: 0.1338333 Vali Loss: 0.2081696 Test Loss: 0.2786745
Validation loss decreased (0.209465 --> 0.208170).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 31 cost time: 0.8493680953979492
Epoch: 31, Steps: 64 | Train Loss: 0.1340696 Vali Loss: 0.2068218 Test Loss: 0.2751681
Validation loss decreased (0.208170 --> 0.206822).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 32 cost time: 0.8353888988494873
Epoch: 32, Steps: 64 | Train Loss: 0.1333680 Vali Loss: 0.2070669 Test Loss: 0.2758798
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 33 cost time: 0.8941254615783691
Epoch: 33, Steps: 64 | Train Loss: 0.1334659 Vali Loss: 0.2042291 Test Loss: 0.2753924
Validation loss decreased (0.206822 --> 0.204229).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 34 cost time: 0.8459999561309814
Epoch: 34, Steps: 64 | Train Loss: 0.1325440 Vali Loss: 0.2042922 Test Loss: 0.2737019
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 35 cost time: 0.8533856868743896
Epoch: 35, Steps: 64 | Train Loss: 0.1325354 Vali Loss: 0.2052058 Test Loss: 0.2738311
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 36 cost time: 0.8423457145690918
Epoch: 36, Steps: 64 | Train Loss: 0.1322209 Vali Loss: 0.2038095 Test Loss: 0.2722868
Validation loss decreased (0.204229 --> 0.203810).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 37 cost time: 0.8474428653717041
Epoch: 37, Steps: 64 | Train Loss: 0.1309886 Vali Loss: 0.2028358 Test Loss: 0.2706624
Validation loss decreased (0.203810 --> 0.202836).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 38 cost time: 0.8513500690460205
Epoch: 38, Steps: 64 | Train Loss: 0.1312341 Vali Loss: 0.2044389 Test Loss: 0.2694599
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 39 cost time: 0.8579998016357422
Epoch: 39, Steps: 64 | Train Loss: 0.1316047 Vali Loss: 0.2022859 Test Loss: 0.2685420
Validation loss decreased (0.202836 --> 0.202286).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 40 cost time: 0.8496170043945312
Epoch: 40, Steps: 64 | Train Loss: 0.1311124 Vali Loss: 0.2028423 Test Loss: 0.2700580
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 41 cost time: 0.8504018783569336
Epoch: 41, Steps: 64 | Train Loss: 0.1316964 Vali Loss: 0.2017694 Test Loss: 0.2681520
Validation loss decreased (0.202286 --> 0.201769).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 42 cost time: 0.8544297218322754
Epoch: 42, Steps: 64 | Train Loss: 0.1304457 Vali Loss: 0.2013385 Test Loss: 0.2670584
Validation loss decreased (0.201769 --> 0.201339).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 43 cost time: 0.8479952812194824
Epoch: 43, Steps: 64 | Train Loss: 0.1316535 Vali Loss: 0.2020719 Test Loss: 0.2679890
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 44 cost time: 0.8439979553222656
Epoch: 44, Steps: 64 | Train Loss: 0.1311990 Vali Loss: 0.2010573 Test Loss: 0.2677051
Validation loss decreased (0.201339 --> 0.201057).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 45 cost time: 0.8486137390136719
Epoch: 45, Steps: 64 | Train Loss: 0.1310357 Vali Loss: 0.2006467 Test Loss: 0.2656483
Validation loss decreased (0.201057 --> 0.200647).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 46 cost time: 0.8543701171875
Epoch: 46, Steps: 64 | Train Loss: 0.1301128 Vali Loss: 0.2003664 Test Loss: 0.2659796
Validation loss decreased (0.200647 --> 0.200366).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 47 cost time: 0.8472411632537842
Epoch: 47, Steps: 64 | Train Loss: 0.1310762 Vali Loss: 0.2016428 Test Loss: 0.2671887
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 48 cost time: 0.8525698184967041
Epoch: 48, Steps: 64 | Train Loss: 0.1310048 Vali Loss: 0.1979260 Test Loss: 0.2650936
Validation loss decreased (0.200366 --> 0.197926).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 49 cost time: 0.8489997386932373
Epoch: 49, Steps: 64 | Train Loss: 0.1312994 Vali Loss: 0.1986634 Test Loss: 0.2659770
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 50 cost time: 0.8531286716461182
Epoch: 50, Steps: 64 | Train Loss: 0.1308997 Vali Loss: 0.2003059 Test Loss: 0.2672406
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 51 cost time: 0.8543872833251953
Epoch: 51, Steps: 64 | Train Loss: 0.1309012 Vali Loss: 0.1999588 Test Loss: 0.2648711
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 52 cost time: 0.8459703922271729
Epoch: 52, Steps: 64 | Train Loss: 0.1307109 Vali Loss: 0.1998773 Test Loss: 0.2662172
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 53 cost time: 0.845409631729126
Epoch: 53, Steps: 64 | Train Loss: 0.1304281 Vali Loss: 0.1984634 Test Loss: 0.2638392
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 54 cost time: 0.8459992408752441
Epoch: 54, Steps: 64 | Train Loss: 0.1308943 Vali Loss: 0.1998611 Test Loss: 0.2647366
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 55 cost time: 0.8486237525939941
Epoch: 55, Steps: 64 | Train Loss: 0.1309532 Vali Loss: 0.2003776 Test Loss: 0.2640077
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 56 cost time: 0.8451714515686035
Epoch: 56, Steps: 64 | Train Loss: 0.1302600 Vali Loss: 0.2011078 Test Loss: 0.2653462
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 57 cost time: 0.858426570892334
Epoch: 57, Steps: 64 | Train Loss: 0.1305309 Vali Loss: 0.1976656 Test Loss: 0.2640820
Validation loss decreased (0.197926 --> 0.197666).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 58 cost time: 0.8516635894775391
Epoch: 58, Steps: 64 | Train Loss: 0.1306272 Vali Loss: 0.1999293 Test Loss: 0.2651152
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 59 cost time: 0.8489999771118164
Epoch: 59, Steps: 64 | Train Loss: 0.1298185 Vali Loss: 0.1995639 Test Loss: 0.2639461
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 60 cost time: 0.8486282825469971
Epoch: 60, Steps: 64 | Train Loss: 0.1299810 Vali Loss: 0.2005088 Test Loss: 0.2658614
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2640819549560547, mae:0.3844168782234192, rse:0.2604374885559082
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 1 cost time: 2.2324070930480957
Epoch: 1, Steps: 64 | Train Loss: 0.9514534 Vali Loss: 2.5223839 Test Loss: 4.0344477
Validation loss decreased (inf --> 2.522384).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 2 cost time: 0.8897161483764648
Epoch: 2, Steps: 64 | Train Loss: 0.6195008 Vali Loss: 0.8140937 Test Loss: 1.2435637
Validation loss decreased (2.522384 --> 0.814094).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 3 cost time: 0.8863809108734131
Epoch: 3, Steps: 64 | Train Loss: 0.2268335 Vali Loss: 0.2268778 Test Loss: 0.2819073
Validation loss decreased (0.814094 --> 0.226878).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 4 cost time: 0.8857533931732178
Epoch: 4, Steps: 64 | Train Loss: 0.1502390 Vali Loss: 0.1942486 Test Loss: 0.2393464
Validation loss decreased (0.226878 --> 0.194249).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 5 cost time: 0.8816366195678711
Epoch: 5, Steps: 64 | Train Loss: 0.1410241 Vali Loss: 0.1927588 Test Loss: 0.2420790
Validation loss decreased (0.194249 --> 0.192759).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 6 cost time: 0.8646197319030762
Epoch: 6, Steps: 64 | Train Loss: 0.1367213 Vali Loss: 0.1887177 Test Loss: 0.2370451
Validation loss decreased (0.192759 --> 0.188718).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 7 cost time: 0.8853609561920166
Epoch: 7, Steps: 64 | Train Loss: 0.1329501 Vali Loss: 0.1842385 Test Loss: 0.2374840
Validation loss decreased (0.188718 --> 0.184238).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 8 cost time: 0.8912873268127441
Epoch: 8, Steps: 64 | Train Loss: 0.1304427 Vali Loss: 0.1845355 Test Loss: 0.2354697
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 9 cost time: 0.8863639831542969
Epoch: 9, Steps: 64 | Train Loss: 0.1279077 Vali Loss: 0.1816809 Test Loss: 0.2346491
Validation loss decreased (0.184238 --> 0.181681).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 10 cost time: 0.8855483531951904
Epoch: 10, Steps: 64 | Train Loss: 0.1271964 Vali Loss: 0.1820918 Test Loss: 0.2358294
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 11 cost time: 0.8879997730255127
Epoch: 11, Steps: 64 | Train Loss: 0.1247568 Vali Loss: 0.1808100 Test Loss: 0.2356844
Validation loss decreased (0.181681 --> 0.180810).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 12 cost time: 0.8980631828308105
Epoch: 12, Steps: 64 | Train Loss: 0.1234923 Vali Loss: 0.1819456 Test Loss: 0.2372380
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 13 cost time: 0.8853583335876465
Epoch: 13, Steps: 64 | Train Loss: 0.1225891 Vali Loss: 0.1759850 Test Loss: 0.2371882
Validation loss decreased (0.180810 --> 0.175985).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 14 cost time: 0.8889832496643066
Epoch: 14, Steps: 64 | Train Loss: 0.1222388 Vali Loss: 0.1766014 Test Loss: 0.2373216
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 15 cost time: 0.8833785057067871
Epoch: 15, Steps: 64 | Train Loss: 0.1210654 Vali Loss: 0.1760751 Test Loss: 0.2377495
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 16 cost time: 0.8839952945709229
Epoch: 16, Steps: 64 | Train Loss: 0.1204058 Vali Loss: 0.1752869 Test Loss: 0.2376392
Validation loss decreased (0.175985 --> 0.175287).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 17 cost time: 0.8806252479553223
Epoch: 17, Steps: 64 | Train Loss: 0.1190041 Vali Loss: 0.1766282 Test Loss: 0.2379459
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 18 cost time: 0.8816232681274414
Epoch: 18, Steps: 64 | Train Loss: 0.1192992 Vali Loss: 0.1768180 Test Loss: 0.2388912
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 19 cost time: 0.8923428058624268
Epoch: 19, Steps: 64 | Train Loss: 0.1183652 Vali Loss: 0.1750233 Test Loss: 0.2397918
Validation loss decreased (0.175287 --> 0.175023).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 20 cost time: 0.8863503932952881
Epoch: 20, Steps: 64 | Train Loss: 0.1186345 Vali Loss: 0.1760053 Test Loss: 0.2397458
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 21 cost time: 0.8814003467559814
Epoch: 21, Steps: 64 | Train Loss: 0.1176135 Vali Loss: 0.1768062 Test Loss: 0.2401439
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 22 cost time: 0.8916494846343994
Epoch: 22, Steps: 64 | Train Loss: 0.1165197 Vali Loss: 0.1753699 Test Loss: 0.2402329
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 23 cost time: 0.8753535747528076
Epoch: 23, Steps: 64 | Train Loss: 0.1172313 Vali Loss: 0.1748272 Test Loss: 0.2401169
Validation loss decreased (0.175023 --> 0.174827).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 24 cost time: 0.8836355209350586
Epoch: 24, Steps: 64 | Train Loss: 0.1170160 Vali Loss: 0.1764295 Test Loss: 0.2411890
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 25 cost time: 0.8872108459472656
Epoch: 25, Steps: 64 | Train Loss: 0.1164762 Vali Loss: 0.1758332 Test Loss: 0.2410069
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 26 cost time: 0.8864831924438477
Epoch: 26, Steps: 64 | Train Loss: 0.1158674 Vali Loss: 0.1748572 Test Loss: 0.2410083
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 27 cost time: 0.8853607177734375
Epoch: 27, Steps: 64 | Train Loss: 0.1157569 Vali Loss: 0.1733933 Test Loss: 0.2399253
Validation loss decreased (0.174827 --> 0.173393).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 28 cost time: 0.8867506980895996
Epoch: 28, Steps: 64 | Train Loss: 0.1154147 Vali Loss: 0.1736124 Test Loss: 0.2410087
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 29 cost time: 0.8839993476867676
Epoch: 29, Steps: 64 | Train Loss: 0.1161328 Vali Loss: 0.1750283 Test Loss: 0.2421040
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 30 cost time: 0.8846168518066406
Epoch: 30, Steps: 64 | Train Loss: 0.1152116 Vali Loss: 0.1734163 Test Loss: 0.2417394
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 31 cost time: 0.8834090232849121
Epoch: 31, Steps: 64 | Train Loss: 0.1150307 Vali Loss: 0.1726124 Test Loss: 0.2424810
Validation loss decreased (0.173393 --> 0.172612).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 32 cost time: 0.8844025135040283
Epoch: 32, Steps: 64 | Train Loss: 0.1152398 Vali Loss: 0.1733697 Test Loss: 0.2411122
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 33 cost time: 0.8923726081848145
Epoch: 33, Steps: 64 | Train Loss: 0.1156758 Vali Loss: 0.1748150 Test Loss: 0.2420938
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 34 cost time: 0.8767721652984619
Epoch: 34, Steps: 64 | Train Loss: 0.1153383 Vali Loss: 0.1746732 Test Loss: 0.2412643
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 35 cost time: 0.8838028907775879
Epoch: 35, Steps: 64 | Train Loss: 0.1155943 Vali Loss: 0.1746094 Test Loss: 0.2422520
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 36 cost time: 0.8806195259094238
Epoch: 36, Steps: 64 | Train Loss: 0.1148762 Vali Loss: 0.1736826 Test Loss: 0.2422828
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 37 cost time: 0.8964037895202637
Epoch: 37, Steps: 64 | Train Loss: 0.1145727 Vali Loss: 0.1754713 Test Loss: 0.2415721
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 38 cost time: 0.8873567581176758
Epoch: 38, Steps: 64 | Train Loss: 0.1149058 Vali Loss: 0.1753788 Test Loss: 0.2421822
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 39 cost time: 0.8863394260406494
Epoch: 39, Steps: 64 | Train Loss: 0.1144336 Vali Loss: 0.1756203 Test Loss: 0.2424774
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 40 cost time: 0.8860511779785156
Epoch: 40, Steps: 64 | Train Loss: 0.1145732 Vali Loss: 0.1748684 Test Loss: 0.2429871
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 41 cost time: 0.8829989433288574
Epoch: 41, Steps: 64 | Train Loss: 0.1149555 Vali Loss: 0.1740857 Test Loss: 0.2424296
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 42 cost time: 0.8856203556060791
Epoch: 42, Steps: 64 | Train Loss: 0.1149055 Vali Loss: 0.1760112 Test Loss: 0.2423923
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 43 cost time: 0.8843495845794678
Epoch: 43, Steps: 64 | Train Loss: 0.1146132 Vali Loss: 0.1728607 Test Loss: 0.2429217
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 44 cost time: 0.8978638648986816
Epoch: 44, Steps: 64 | Train Loss: 0.1146902 Vali Loss: 0.1743863 Test Loss: 0.2423675
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 45 cost time: 0.8834264278411865
Epoch: 45, Steps: 64 | Train Loss: 0.1139763 Vali Loss: 0.1730220 Test Loss: 0.2424320
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 46 cost time: 0.8867275714874268
Epoch: 46, Steps: 64 | Train Loss: 0.1145712 Vali Loss: 0.1729834 Test Loss: 0.2422808
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 47 cost time: 0.8900001049041748
Epoch: 47, Steps: 64 | Train Loss: 0.1147085 Vali Loss: 0.1734940 Test Loss: 0.2423663
EarlyStopping counter: 16 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 48 cost time: 0.8886160850524902
Epoch: 48, Steps: 64 | Train Loss: 0.1146474 Vali Loss: 0.1740514 Test Loss: 0.2432563
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 49 cost time: 0.8866217136383057
Epoch: 49, Steps: 64 | Train Loss: 0.1143731 Vali Loss: 0.1728696 Test Loss: 0.2433491
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 50 cost time: 0.8813521862030029
Epoch: 50, Steps: 64 | Train Loss: 0.1138900 Vali Loss: 0.1732170 Test Loss: 0.2428306
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 51 cost time: 0.891362190246582
Epoch: 51, Steps: 64 | Train Loss: 0.1143072 Vali Loss: 0.1746036 Test Loss: 0.2429279
EarlyStopping counter: 20 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 52 cost time: 0.8797955513000488
Epoch: 52, Steps: 64 | Train Loss: 0.1146002 Vali Loss: 0.1720673 Test Loss: 0.2437474
Validation loss decreased (0.172612 --> 0.172067).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 53 cost time: 0.876788854598999
Epoch: 53, Steps: 64 | Train Loss: 0.1144145 Vali Loss: 0.1736160 Test Loss: 0.2435456
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 54 cost time: 0.8876082897186279
Epoch: 54, Steps: 64 | Train Loss: 0.1144877 Vali Loss: 0.1750649 Test Loss: 0.2425513
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 55 cost time: 0.8835268020629883
Epoch: 55, Steps: 64 | Train Loss: 0.1144347 Vali Loss: 0.1752501 Test Loss: 0.2433511
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 56 cost time: 0.8863592147827148
Epoch: 56, Steps: 64 | Train Loss: 0.1144578 Vali Loss: 0.1742594 Test Loss: 0.2433384
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 57 cost time: 0.886357307434082
Epoch: 57, Steps: 64 | Train Loss: 0.1142626 Vali Loss: 0.1753192 Test Loss: 0.2426202
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 58 cost time: 0.8837370872497559
Epoch: 58, Steps: 64 | Train Loss: 0.1140537 Vali Loss: 0.1742980 Test Loss: 0.2428755
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 59 cost time: 0.8861212730407715
Epoch: 59, Steps: 64 | Train Loss: 0.1145612 Vali Loss: 0.1734943 Test Loss: 0.2428471
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 60 cost time: 0.8836138248443604
Epoch: 60, Steps: 64 | Train Loss: 0.1141369 Vali Loss: 0.1746062 Test Loss: 0.2431579
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.24374741315841675, mae:0.36640748381614685, rse:0.2502096891403198
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05678749084472656 GB
Epoch: 1 cost time: 2.2827975749969482
Epoch: 1, Steps: 64 | Train Loss: 0.8474264 Vali Loss: 2.2810333 Test Loss: 3.6233106
Validation loss decreased (inf --> 2.281033).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 2 cost time: 0.9343929290771484
Epoch: 2, Steps: 64 | Train Loss: 0.4504539 Vali Loss: 0.2228384 Test Loss: 0.2681443
Validation loss decreased (2.281033 --> 0.222838).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 3 cost time: 0.9302213191986084
Epoch: 3, Steps: 64 | Train Loss: 0.1590762 Vali Loss: 0.2140329 Test Loss: 0.2676575
Validation loss decreased (0.222838 --> 0.214033).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 4 cost time: 0.9233660697937012
Epoch: 4, Steps: 64 | Train Loss: 0.1418926 Vali Loss: 0.1917063 Test Loss: 0.2345887
Validation loss decreased (0.214033 --> 0.191706).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 5 cost time: 0.9283876419067383
Epoch: 5, Steps: 64 | Train Loss: 0.1349498 Vali Loss: 0.1894383 Test Loss: 0.2364165
Validation loss decreased (0.191706 --> 0.189438).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 6 cost time: 0.9166977405548096
Epoch: 6, Steps: 64 | Train Loss: 0.1306619 Vali Loss: 0.1839596 Test Loss: 0.2352480
Validation loss decreased (0.189438 --> 0.183960).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 7 cost time: 0.9254190921783447
Epoch: 7, Steps: 64 | Train Loss: 0.1280575 Vali Loss: 0.1801954 Test Loss: 0.2342476
Validation loss decreased (0.183960 --> 0.180195).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 8 cost time: 0.9225966930389404
Epoch: 8, Steps: 64 | Train Loss: 0.1251181 Vali Loss: 0.1798088 Test Loss: 0.2335825
Validation loss decreased (0.180195 --> 0.179809).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 9 cost time: 0.917003870010376
Epoch: 9, Steps: 64 | Train Loss: 0.1243319 Vali Loss: 0.1784555 Test Loss: 0.2349877
Validation loss decreased (0.179809 --> 0.178455).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 10 cost time: 0.9263780117034912
Epoch: 10, Steps: 64 | Train Loss: 0.1224989 Vali Loss: 0.1805034 Test Loss: 0.2347757
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 11 cost time: 0.9233605861663818
Epoch: 11, Steps: 64 | Train Loss: 0.1204315 Vali Loss: 0.1773479 Test Loss: 0.2361168
Validation loss decreased (0.178455 --> 0.177348).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 12 cost time: 0.9413187503814697
Epoch: 12, Steps: 64 | Train Loss: 0.1199911 Vali Loss: 0.1772007 Test Loss: 0.2389991
Validation loss decreased (0.177348 --> 0.177201).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 13 cost time: 0.9373414516448975
Epoch: 13, Steps: 64 | Train Loss: 0.1190224 Vali Loss: 0.1778440 Test Loss: 0.2398906
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 14 cost time: 0.9202165603637695
Epoch: 14, Steps: 64 | Train Loss: 0.1187312 Vali Loss: 0.1766876 Test Loss: 0.2383100
Validation loss decreased (0.177201 --> 0.176688).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 15 cost time: 0.9243731498718262
Epoch: 15, Steps: 64 | Train Loss: 0.1173583 Vali Loss: 0.1762809 Test Loss: 0.2391245
Validation loss decreased (0.176688 --> 0.176281).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 16 cost time: 0.9379744529724121
Epoch: 16, Steps: 64 | Train Loss: 0.1164369 Vali Loss: 0.1761430 Test Loss: 0.2386781
Validation loss decreased (0.176281 --> 0.176143).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 17 cost time: 0.9316079616546631
Epoch: 17, Steps: 64 | Train Loss: 0.1168353 Vali Loss: 0.1770539 Test Loss: 0.2417206
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 18 cost time: 0.9314501285552979
Epoch: 18, Steps: 64 | Train Loss: 0.1160050 Vali Loss: 0.1708802 Test Loss: 0.2413435
Validation loss decreased (0.176143 --> 0.170880).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 19 cost time: 0.9441189765930176
Epoch: 19, Steps: 64 | Train Loss: 0.1151553 Vali Loss: 0.1756991 Test Loss: 0.2421786
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 20 cost time: 0.9333124160766602
Epoch: 20, Steps: 64 | Train Loss: 0.1154172 Vali Loss: 0.1733704 Test Loss: 0.2417570
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 21 cost time: 0.9364290237426758
Epoch: 21, Steps: 64 | Train Loss: 0.1147849 Vali Loss: 0.1737413 Test Loss: 0.2408918
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 22 cost time: 0.932854175567627
Epoch: 22, Steps: 64 | Train Loss: 0.1145690 Vali Loss: 0.1733371 Test Loss: 0.2429052
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 23 cost time: 0.8959980010986328
Epoch: 23, Steps: 64 | Train Loss: 0.1136522 Vali Loss: 0.1765699 Test Loss: 0.2428256
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 24 cost time: 0.9296145439147949
Epoch: 24, Steps: 64 | Train Loss: 0.1145457 Vali Loss: 0.1736105 Test Loss: 0.2440080
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 25 cost time: 0.9325919151306152
Epoch: 25, Steps: 64 | Train Loss: 0.1140308 Vali Loss: 0.1751444 Test Loss: 0.2425387
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 26 cost time: 0.9173521995544434
Epoch: 26, Steps: 64 | Train Loss: 0.1142556 Vali Loss: 0.1755525 Test Loss: 0.2435438
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 27 cost time: 0.9343714714050293
Epoch: 27, Steps: 64 | Train Loss: 0.1137910 Vali Loss: 0.1735106 Test Loss: 0.2437155
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 28 cost time: 0.9434895515441895
Epoch: 28, Steps: 64 | Train Loss: 0.1134657 Vali Loss: 0.1737379 Test Loss: 0.2441141
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 29 cost time: 0.9433474540710449
Epoch: 29, Steps: 64 | Train Loss: 0.1128700 Vali Loss: 0.1747475 Test Loss: 0.2433162
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 30 cost time: 0.9297659397125244
Epoch: 30, Steps: 64 | Train Loss: 0.1132158 Vali Loss: 0.1744515 Test Loss: 0.2442080
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 31 cost time: 0.9340000152587891
Epoch: 31, Steps: 64 | Train Loss: 0.1132845 Vali Loss: 0.1735375 Test Loss: 0.2446573
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 32 cost time: 0.9324324131011963
Epoch: 32, Steps: 64 | Train Loss: 0.1128772 Vali Loss: 0.1740573 Test Loss: 0.2438659
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 33 cost time: 0.943608283996582
Epoch: 33, Steps: 64 | Train Loss: 0.1125178 Vali Loss: 0.1737927 Test Loss: 0.2449780
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 34 cost time: 0.9323949813842773
Epoch: 34, Steps: 64 | Train Loss: 0.1121850 Vali Loss: 0.1745583 Test Loss: 0.2443726
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 35 cost time: 0.9343206882476807
Epoch: 35, Steps: 64 | Train Loss: 0.1127856 Vali Loss: 0.1746433 Test Loss: 0.2448512
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 36 cost time: 0.9403011798858643
Epoch: 36, Steps: 64 | Train Loss: 0.1121808 Vali Loss: 0.1731910 Test Loss: 0.2461517
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 37 cost time: 0.9313890933990479
Epoch: 37, Steps: 64 | Train Loss: 0.1118946 Vali Loss: 0.1737953 Test Loss: 0.2445501
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 38 cost time: 0.9327056407928467
Epoch: 38, Steps: 64 | Train Loss: 0.1124721 Vali Loss: 0.1729529 Test Loss: 0.2445526
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 39 cost time: 0.931814432144165
Epoch: 39, Steps: 64 | Train Loss: 0.1119021 Vali Loss: 0.1729119 Test Loss: 0.2447954
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 40 cost time: 0.9293661117553711
Epoch: 40, Steps: 64 | Train Loss: 0.1118641 Vali Loss: 0.1747600 Test Loss: 0.2457041
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 41 cost time: 0.9356017112731934
Epoch: 41, Steps: 64 | Train Loss: 0.1124784 Vali Loss: 0.1727673 Test Loss: 0.2451440
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 42 cost time: 0.9323692321777344
Epoch: 42, Steps: 64 | Train Loss: 0.1121544 Vali Loss: 0.1738375 Test Loss: 0.2454176
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 43 cost time: 0.9183712005615234
Epoch: 43, Steps: 64 | Train Loss: 0.1119954 Vali Loss: 0.1730634 Test Loss: 0.2453241
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 44 cost time: 0.9384427070617676
Epoch: 44, Steps: 64 | Train Loss: 0.1122115 Vali Loss: 0.1758491 Test Loss: 0.2458210
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 45 cost time: 0.9313669204711914
Epoch: 45, Steps: 64 | Train Loss: 0.1119065 Vali Loss: 0.1746476 Test Loss: 0.2456816
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 46 cost time: 0.942368745803833
Epoch: 46, Steps: 64 | Train Loss: 0.1122067 Vali Loss: 0.1738381 Test Loss: 0.2453139
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 47 cost time: 0.9387505054473877
Epoch: 47, Steps: 64 | Train Loss: 0.1123235 Vali Loss: 0.1747043 Test Loss: 0.2457769
EarlyStopping counter: 29 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 48 cost time: 0.9310002326965332
Epoch: 48, Steps: 64 | Train Loss: 0.1124017 Vali Loss: 0.1740385 Test Loss: 0.2452983
EarlyStopping counter: 30 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 49 cost time: 0.9356021881103516
Epoch: 49, Steps: 64 | Train Loss: 0.1122873 Vali Loss: 0.1727244 Test Loss: 0.2454488
EarlyStopping counter: 31 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 50 cost time: 0.9213287830352783
Epoch: 50, Steps: 64 | Train Loss: 0.1119518 Vali Loss: 0.1749604 Test Loss: 0.2453904
EarlyStopping counter: 32 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 51 cost time: 0.930412769317627
Epoch: 51, Steps: 64 | Train Loss: 0.1125102 Vali Loss: 0.1745245 Test Loss: 0.2458833
EarlyStopping counter: 33 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 52 cost time: 0.9353554248809814
Epoch: 52, Steps: 64 | Train Loss: 0.1118361 Vali Loss: 0.1743496 Test Loss: 0.2456282
EarlyStopping counter: 34 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 53 cost time: 0.9486486911773682
Epoch: 53, Steps: 64 | Train Loss: 0.1112796 Vali Loss: 0.1735092 Test Loss: 0.2459923
EarlyStopping counter: 35 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 54 cost time: 0.9363269805908203
Epoch: 54, Steps: 64 | Train Loss: 0.1119938 Vali Loss: 0.1742949 Test Loss: 0.2456888
EarlyStopping counter: 36 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 55 cost time: 0.9407591819763184
Epoch: 55, Steps: 64 | Train Loss: 0.1125492 Vali Loss: 0.1768142 Test Loss: 0.2461874
EarlyStopping counter: 37 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 56 cost time: 0.929999589920044
Epoch: 56, Steps: 64 | Train Loss: 0.1117189 Vali Loss: 0.1730436 Test Loss: 0.2460783
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 57 cost time: 0.9329788684844971
Epoch: 57, Steps: 64 | Train Loss: 0.1118302 Vali Loss: 0.1730016 Test Loss: 0.2458489
EarlyStopping counter: 39 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 58 cost time: 0.9356026649475098
Epoch: 58, Steps: 64 | Train Loss: 0.1122096 Vali Loss: 0.1742475 Test Loss: 0.2461573
EarlyStopping counter: 40 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 59 cost time: 0.9293019771575928
Epoch: 59, Steps: 64 | Train Loss: 0.1121039 Vali Loss: 0.1737407 Test Loss: 0.2458605
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 60 cost time: 0.9463160037994385
Epoch: 60, Steps: 64 | Train Loss: 0.1116009 Vali Loss: 0.1735275 Test Loss: 0.2445931
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.24134355783462524, mae:0.3627782464027405, rse:0.2489728480577469
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04966163635253906 GB
Epoch: 1 cost time: 2.23360538482666
Epoch: 1, Steps: 64 | Train Loss: 0.9795782 Vali Loss: 2.5446849 Test Loss: 4.0266409
Validation loss decreased (inf --> 2.544685).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 2 cost time: 0.8723616600036621
Epoch: 2, Steps: 64 | Train Loss: 0.8508842 Vali Loss: 1.9032342 Test Loss: 2.9754357
Validation loss decreased (2.544685 --> 1.903234).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 3 cost time: 0.8734011650085449
Epoch: 3, Steps: 64 | Train Loss: 0.6524367 Vali Loss: 1.4123243 Test Loss: 2.1785498
Validation loss decreased (1.903234 --> 1.412324).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 4 cost time: 0.8364639282226562
Epoch: 4, Steps: 64 | Train Loss: 0.4995288 Vali Loss: 1.0504793 Test Loss: 1.5919214
Validation loss decreased (1.412324 --> 1.050479).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 5 cost time: 0.8554337024688721
Epoch: 5, Steps: 64 | Train Loss: 0.3932287 Vali Loss: 0.8220130 Test Loss: 1.2346652
Validation loss decreased (1.050479 --> 0.822013).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 6 cost time: 0.8473720550537109
Epoch: 6, Steps: 64 | Train Loss: 0.3209193 Vali Loss: 0.6616414 Test Loss: 0.9786648
Validation loss decreased (0.822013 --> 0.661641).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 7 cost time: 0.8540127277374268
Epoch: 7, Steps: 64 | Train Loss: 0.2698901 Vali Loss: 0.5495862 Test Loss: 0.8078591
Validation loss decreased (0.661641 --> 0.549586).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 8 cost time: 0.8460001945495605
Epoch: 8, Steps: 64 | Train Loss: 0.2348887 Vali Loss: 0.4610962 Test Loss: 0.6655061
Validation loss decreased (0.549586 --> 0.461096).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 9 cost time: 0.8470001220703125
Epoch: 9, Steps: 64 | Train Loss: 0.2108233 Vali Loss: 0.4019332 Test Loss: 0.5776382
Validation loss decreased (0.461096 --> 0.401933).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 10 cost time: 0.8523786067962646
Epoch: 10, Steps: 64 | Train Loss: 0.1927309 Vali Loss: 0.3576156 Test Loss: 0.5062955
Validation loss decreased (0.401933 --> 0.357616).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 11 cost time: 0.8585758209228516
Epoch: 11, Steps: 64 | Train Loss: 0.1786073 Vali Loss: 0.3208525 Test Loss: 0.4540035
Validation loss decreased (0.357616 --> 0.320853).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 12 cost time: 0.8523340225219727
Epoch: 12, Steps: 64 | Train Loss: 0.1691806 Vali Loss: 0.2975069 Test Loss: 0.4151140
Validation loss decreased (0.320853 --> 0.297507).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 13 cost time: 0.8587348461151123
Epoch: 13, Steps: 64 | Train Loss: 0.1626087 Vali Loss: 0.2795293 Test Loss: 0.3848685
Validation loss decreased (0.297507 --> 0.279529).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 14 cost time: 0.8539996147155762
Epoch: 14, Steps: 64 | Train Loss: 0.1564663 Vali Loss: 0.2629846 Test Loss: 0.3624944
Validation loss decreased (0.279529 --> 0.262985).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 15 cost time: 0.8476204872131348
Epoch: 15, Steps: 64 | Train Loss: 0.1518791 Vali Loss: 0.2508000 Test Loss: 0.3404033
Validation loss decreased (0.262985 --> 0.250800).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 16 cost time: 0.8512463569641113
Epoch: 16, Steps: 64 | Train Loss: 0.1486365 Vali Loss: 0.2404112 Test Loss: 0.3262871
Validation loss decreased (0.250800 --> 0.240411).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 17 cost time: 0.8533673286437988
Epoch: 17, Steps: 64 | Train Loss: 0.1457966 Vali Loss: 0.2358593 Test Loss: 0.3173739
Validation loss decreased (0.240411 --> 0.235859).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 18 cost time: 0.8578088283538818
Epoch: 18, Steps: 64 | Train Loss: 0.1429947 Vali Loss: 0.2293120 Test Loss: 0.3051678
Validation loss decreased (0.235859 --> 0.229312).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 19 cost time: 0.8539993762969971
Epoch: 19, Steps: 64 | Train Loss: 0.1414904 Vali Loss: 0.2252269 Test Loss: 0.2994081
Validation loss decreased (0.229312 --> 0.225227).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 20 cost time: 0.8520388603210449
Epoch: 20, Steps: 64 | Train Loss: 0.1393588 Vali Loss: 0.2174653 Test Loss: 0.2924453
Validation loss decreased (0.225227 --> 0.217465).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 21 cost time: 0.8543612957000732
Epoch: 21, Steps: 64 | Train Loss: 0.1384817 Vali Loss: 0.2167692 Test Loss: 0.2880976
Validation loss decreased (0.217465 --> 0.216769).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 22 cost time: 0.8664135932922363
Epoch: 22, Steps: 64 | Train Loss: 0.1371246 Vali Loss: 0.2094943 Test Loss: 0.2816167
Validation loss decreased (0.216769 --> 0.209494).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 23 cost time: 0.8558156490325928
Epoch: 23, Steps: 64 | Train Loss: 0.1365680 Vali Loss: 0.2095525 Test Loss: 0.2767660
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 24 cost time: 0.8500001430511475
Epoch: 24, Steps: 64 | Train Loss: 0.1358144 Vali Loss: 0.2089573 Test Loss: 0.2753160
Validation loss decreased (0.209494 --> 0.208957).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 25 cost time: 0.8532834053039551
Epoch: 25, Steps: 64 | Train Loss: 0.1349903 Vali Loss: 0.2071157 Test Loss: 0.2743043
Validation loss decreased (0.208957 --> 0.207116).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 26 cost time: 0.8546919822692871
Epoch: 26, Steps: 64 | Train Loss: 0.1330225 Vali Loss: 0.2050037 Test Loss: 0.2694881
Validation loss decreased (0.207116 --> 0.205004).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 27 cost time: 0.851351261138916
Epoch: 27, Steps: 64 | Train Loss: 0.1337247 Vali Loss: 0.2011312 Test Loss: 0.2653943
Validation loss decreased (0.205004 --> 0.201131).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 28 cost time: 0.8503830432891846
Epoch: 28, Steps: 64 | Train Loss: 0.1330309 Vali Loss: 0.2006419 Test Loss: 0.2655999
Validation loss decreased (0.201131 --> 0.200642).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 29 cost time: 0.8743994235992432
Epoch: 29, Steps: 64 | Train Loss: 0.1329992 Vali Loss: 0.1990995 Test Loss: 0.2619674
Validation loss decreased (0.200642 --> 0.199100).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 30 cost time: 0.8500247001647949
Epoch: 30, Steps: 64 | Train Loss: 0.1323748 Vali Loss: 0.1968388 Test Loss: 0.2612348
Validation loss decreased (0.199100 --> 0.196839).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 31 cost time: 0.853320837020874
Epoch: 31, Steps: 64 | Train Loss: 0.1326859 Vali Loss: 0.1981324 Test Loss: 0.2612598
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 32 cost time: 0.8536276817321777
Epoch: 32, Steps: 64 | Train Loss: 0.1317859 Vali Loss: 0.1956198 Test Loss: 0.2597746
Validation loss decreased (0.196839 --> 0.195620).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 33 cost time: 0.858412504196167
Epoch: 33, Steps: 64 | Train Loss: 0.1320276 Vali Loss: 0.1962987 Test Loss: 0.2585939
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 34 cost time: 0.8510639667510986
Epoch: 34, Steps: 64 | Train Loss: 0.1320526 Vali Loss: 0.1967141 Test Loss: 0.2586482
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 35 cost time: 0.8526191711425781
Epoch: 35, Steps: 64 | Train Loss: 0.1309722 Vali Loss: 0.1944111 Test Loss: 0.2572596
Validation loss decreased (0.195620 --> 0.194411).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 36 cost time: 0.854499340057373
Epoch: 36, Steps: 64 | Train Loss: 0.1308957 Vali Loss: 0.1935505 Test Loss: 0.2556165
Validation loss decreased (0.194411 --> 0.193550).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 37 cost time: 0.8633475303649902
Epoch: 37, Steps: 64 | Train Loss: 0.1312524 Vali Loss: 0.1954021 Test Loss: 0.2555278
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 38 cost time: 0.8564403057098389
Epoch: 38, Steps: 64 | Train Loss: 0.1304796 Vali Loss: 0.1941482 Test Loss: 0.2537404
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 39 cost time: 0.8517282009124756
Epoch: 39, Steps: 64 | Train Loss: 0.1307929 Vali Loss: 0.1938668 Test Loss: 0.2534940
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 40 cost time: 0.8746399879455566
Epoch: 40, Steps: 64 | Train Loss: 0.1308020 Vali Loss: 0.1930206 Test Loss: 0.2536018
Validation loss decreased (0.193550 --> 0.193021).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 41 cost time: 0.8586304187774658
Epoch: 41, Steps: 64 | Train Loss: 0.1299756 Vali Loss: 0.1926608 Test Loss: 0.2525176
Validation loss decreased (0.193021 --> 0.192661).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 42 cost time: 0.855431318283081
Epoch: 42, Steps: 64 | Train Loss: 0.1303117 Vali Loss: 0.1928337 Test Loss: 0.2531723
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 43 cost time: 0.8483469486236572
Epoch: 43, Steps: 64 | Train Loss: 0.1307954 Vali Loss: 0.1908151 Test Loss: 0.2507170
Validation loss decreased (0.192661 --> 0.190815).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 44 cost time: 0.8667824268341064
Epoch: 44, Steps: 64 | Train Loss: 0.1302051 Vali Loss: 0.1919072 Test Loss: 0.2519722
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 45 cost time: 0.8540000915527344
Epoch: 45, Steps: 64 | Train Loss: 0.1301100 Vali Loss: 0.1929699 Test Loss: 0.2534559
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 46 cost time: 0.8486168384552002
Epoch: 46, Steps: 64 | Train Loss: 0.1304330 Vali Loss: 0.1909068 Test Loss: 0.2506583
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 47 cost time: 0.8553502559661865
Epoch: 47, Steps: 64 | Train Loss: 0.1293506 Vali Loss: 0.1904932 Test Loss: 0.2504551
Validation loss decreased (0.190815 --> 0.190493).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 48 cost time: 0.855679988861084
Epoch: 48, Steps: 64 | Train Loss: 0.1302241 Vali Loss: 0.1905589 Test Loss: 0.2513671
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 49 cost time: 0.8493425846099854
Epoch: 49, Steps: 64 | Train Loss: 0.1302880 Vali Loss: 0.1900796 Test Loss: 0.2506890
Validation loss decreased (0.190493 --> 0.190080).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 50 cost time: 0.8489995002746582
Epoch: 50, Steps: 64 | Train Loss: 0.1294756 Vali Loss: 0.1909315 Test Loss: 0.2514115
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 51 cost time: 0.8576176166534424
Epoch: 51, Steps: 64 | Train Loss: 0.1295766 Vali Loss: 0.1899702 Test Loss: 0.2509637
Validation loss decreased (0.190080 --> 0.189970).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 52 cost time: 0.8472325801849365
Epoch: 52, Steps: 64 | Train Loss: 0.1293952 Vali Loss: 0.1924483 Test Loss: 0.2517132
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 53 cost time: 0.8504638671875
Epoch: 53, Steps: 64 | Train Loss: 0.1295773 Vali Loss: 0.1909984 Test Loss: 0.2498934
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 54 cost time: 0.852442741394043
Epoch: 54, Steps: 64 | Train Loss: 0.1299996 Vali Loss: 0.1901379 Test Loss: 0.2494093
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 55 cost time: 0.8564317226409912
Epoch: 55, Steps: 64 | Train Loss: 0.1301857 Vali Loss: 0.1897710 Test Loss: 0.2514005
Validation loss decreased (0.189970 --> 0.189771).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 56 cost time: 0.8396303653717041
Epoch: 56, Steps: 64 | Train Loss: 0.1297610 Vali Loss: 0.1913411 Test Loss: 0.2506314
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 57 cost time: 0.8526182174682617
Epoch: 57, Steps: 64 | Train Loss: 0.1302193 Vali Loss: 0.1898307 Test Loss: 0.2480532
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 58 cost time: 0.857067346572876
Epoch: 58, Steps: 64 | Train Loss: 0.1294647 Vali Loss: 0.1885566 Test Loss: 0.2485506
Validation loss decreased (0.189771 --> 0.188557).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 59 cost time: 0.87139892578125
Epoch: 59, Steps: 64 | Train Loss: 0.1294375 Vali Loss: 0.1889050 Test Loss: 0.2480336
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 60 cost time: 0.8509998321533203
Epoch: 60, Steps: 64 | Train Loss: 0.1295657 Vali Loss: 0.1901782 Test Loss: 0.2497721
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.24855059385299683, mae:0.3634597063064575, rse:0.25266292691230774
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 1 cost time: 2.2621026039123535
Epoch: 1, Steps: 64 | Train Loss: 0.8908606 Vali Loss: 2.3842490 Test Loss: 3.7982926
Validation loss decreased (inf --> 2.384249).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 2 cost time: 0.9039595127105713
Epoch: 2, Steps: 64 | Train Loss: 0.5717771 Vali Loss: 0.5641259 Test Loss: 0.8095397
Validation loss decreased (2.384249 --> 0.564126).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 3 cost time: 0.8912935256958008
Epoch: 3, Steps: 64 | Train Loss: 0.1811210 Vali Loss: 0.1914688 Test Loss: 0.2180953
Validation loss decreased (0.564126 --> 0.191469).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 4 cost time: 0.8903796672821045
Epoch: 4, Steps: 64 | Train Loss: 0.1414652 Vali Loss: 0.1944226 Test Loss: 0.2364907
EarlyStopping counter: 1 out of 100
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 5 cost time: 0.8884210586547852
Epoch: 5, Steps: 64 | Train Loss: 0.1341541 Vali Loss: 0.1876329 Test Loss: 0.2323364
Validation loss decreased (0.191469 --> 0.187633).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 6 cost time: 0.8907935619354248
Epoch: 6, Steps: 64 | Train Loss: 0.1310177 Vali Loss: 0.1871348 Test Loss: 0.2317543
Validation loss decreased (0.187633 --> 0.187135).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 7 cost time: 0.9170000553131104
Epoch: 7, Steps: 64 | Train Loss: 0.1282500 Vali Loss: 0.1838234 Test Loss: 0.2341762
Validation loss decreased (0.187135 --> 0.183823).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 8 cost time: 0.8889977931976318
Epoch: 8, Steps: 64 | Train Loss: 0.1255411 Vali Loss: 0.1793484 Test Loss: 0.2319867
Validation loss decreased (0.183823 --> 0.179348).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 9 cost time: 0.8903400897979736
Epoch: 9, Steps: 64 | Train Loss: 0.1245803 Vali Loss: 0.1821104 Test Loss: 0.2328882
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 10 cost time: 0.9017074108123779
Epoch: 10, Steps: 64 | Train Loss: 0.1229108 Vali Loss: 0.1816501 Test Loss: 0.2336634
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 11 cost time: 0.8911445140838623
Epoch: 11, Steps: 64 | Train Loss: 0.1223753 Vali Loss: 0.1794651 Test Loss: 0.2336214
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 12 cost time: 0.890366792678833
Epoch: 12, Steps: 64 | Train Loss: 0.1206189 Vali Loss: 0.1780462 Test Loss: 0.2348563
Validation loss decreased (0.179348 --> 0.178046).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 13 cost time: 0.8997476100921631
Epoch: 13, Steps: 64 | Train Loss: 0.1194914 Vali Loss: 0.1786672 Test Loss: 0.2314200
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 14 cost time: 0.8869996070861816
Epoch: 14, Steps: 64 | Train Loss: 0.1195194 Vali Loss: 0.1792656 Test Loss: 0.2356365
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 15 cost time: 0.895017147064209
Epoch: 15, Steps: 64 | Train Loss: 0.1184903 Vali Loss: 0.1765390 Test Loss: 0.2328034
Validation loss decreased (0.178046 --> 0.176539).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 16 cost time: 0.8853628635406494
Epoch: 16, Steps: 64 | Train Loss: 0.1182944 Vali Loss: 0.1779076 Test Loss: 0.2332304
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 17 cost time: 0.9019873142242432
Epoch: 17, Steps: 64 | Train Loss: 0.1173460 Vali Loss: 0.1782399 Test Loss: 0.2337659
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 18 cost time: 0.8873624801635742
Epoch: 18, Steps: 64 | Train Loss: 0.1171864 Vali Loss: 0.1776723 Test Loss: 0.2350364
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 19 cost time: 0.8908169269561768
Epoch: 19, Steps: 64 | Train Loss: 0.1157079 Vali Loss: 0.1762979 Test Loss: 0.2346834
Validation loss decreased (0.176539 --> 0.176298).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 20 cost time: 0.9000022411346436
Epoch: 20, Steps: 64 | Train Loss: 0.1164487 Vali Loss: 0.1772994 Test Loss: 0.2349583
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 21 cost time: 0.886627197265625
Epoch: 21, Steps: 64 | Train Loss: 0.1165651 Vali Loss: 0.1769750 Test Loss: 0.2338800
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 22 cost time: 0.8904149532318115
Epoch: 22, Steps: 64 | Train Loss: 0.1157694 Vali Loss: 0.1771135 Test Loss: 0.2347628
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 23 cost time: 0.8883640766143799
Epoch: 23, Steps: 64 | Train Loss: 0.1162728 Vali Loss: 0.1758584 Test Loss: 0.2344940
Validation loss decreased (0.176298 --> 0.175858).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 24 cost time: 0.8847548961639404
Epoch: 24, Steps: 64 | Train Loss: 0.1155526 Vali Loss: 0.1762279 Test Loss: 0.2360739
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 25 cost time: 0.8857171535491943
Epoch: 25, Steps: 64 | Train Loss: 0.1153617 Vali Loss: 0.1758391 Test Loss: 0.2355751
Validation loss decreased (0.175858 --> 0.175839).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 26 cost time: 0.8929998874664307
Epoch: 26, Steps: 64 | Train Loss: 0.1151703 Vali Loss: 0.1780705 Test Loss: 0.2361878
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 27 cost time: 0.8856227397918701
Epoch: 27, Steps: 64 | Train Loss: 0.1147360 Vali Loss: 0.1747350 Test Loss: 0.2350462
Validation loss decreased (0.175839 --> 0.174735).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 28 cost time: 0.8723857402801514
Epoch: 28, Steps: 64 | Train Loss: 0.1148265 Vali Loss: 0.1743740 Test Loss: 0.2347587
Validation loss decreased (0.174735 --> 0.174374).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 29 cost time: 0.8872461318969727
Epoch: 29, Steps: 64 | Train Loss: 0.1143977 Vali Loss: 0.1765449 Test Loss: 0.2359778
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 30 cost time: 0.8952798843383789
Epoch: 30, Steps: 64 | Train Loss: 0.1137018 Vali Loss: 0.1755853 Test Loss: 0.2354394
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 31 cost time: 0.892730712890625
Epoch: 31, Steps: 64 | Train Loss: 0.1142229 Vali Loss: 0.1753557 Test Loss: 0.2363308
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 32 cost time: 0.8809998035430908
Epoch: 32, Steps: 64 | Train Loss: 0.1139036 Vali Loss: 0.1753890 Test Loss: 0.2356649
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 33 cost time: 0.8910396099090576
Epoch: 33, Steps: 64 | Train Loss: 0.1140257 Vali Loss: 0.1759787 Test Loss: 0.2367516
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 34 cost time: 0.8866109848022461
Epoch: 34, Steps: 64 | Train Loss: 0.1135404 Vali Loss: 0.1746263 Test Loss: 0.2349236
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 35 cost time: 0.890329122543335
Epoch: 35, Steps: 64 | Train Loss: 0.1134937 Vali Loss: 0.1755483 Test Loss: 0.2355862
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 36 cost time: 0.88934326171875
Epoch: 36, Steps: 64 | Train Loss: 0.1135638 Vali Loss: 0.1741248 Test Loss: 0.2357827
Validation loss decreased (0.174374 --> 0.174125).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 37 cost time: 0.8853633403778076
Epoch: 37, Steps: 64 | Train Loss: 0.1134828 Vali Loss: 0.1745726 Test Loss: 0.2353583
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 38 cost time: 0.9001591205596924
Epoch: 38, Steps: 64 | Train Loss: 0.1133820 Vali Loss: 0.1752250 Test Loss: 0.2352273
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 39 cost time: 0.8830001354217529
Epoch: 39, Steps: 64 | Train Loss: 0.1134206 Vali Loss: 0.1751049 Test Loss: 0.2353848
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 40 cost time: 0.8866164684295654
Epoch: 40, Steps: 64 | Train Loss: 0.1132756 Vali Loss: 0.1752141 Test Loss: 0.2366989
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 41 cost time: 0.888329267501831
Epoch: 41, Steps: 64 | Train Loss: 0.1134476 Vali Loss: 0.1746747 Test Loss: 0.2351537
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 42 cost time: 0.9031682014465332
Epoch: 42, Steps: 64 | Train Loss: 0.1131373 Vali Loss: 0.1756976 Test Loss: 0.2352697
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 43 cost time: 0.8894085884094238
Epoch: 43, Steps: 64 | Train Loss: 0.1128745 Vali Loss: 0.1728379 Test Loss: 0.2362836
Validation loss decreased (0.174125 --> 0.172838).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 44 cost time: 0.8847484588623047
Epoch: 44, Steps: 64 | Train Loss: 0.1135577 Vali Loss: 0.1740642 Test Loss: 0.2363019
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 45 cost time: 0.898998498916626
Epoch: 45, Steps: 64 | Train Loss: 0.1133437 Vali Loss: 0.1742762 Test Loss: 0.2362517
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 46 cost time: 0.8876264095306396
Epoch: 46, Steps: 64 | Train Loss: 0.1133220 Vali Loss: 0.1749302 Test Loss: 0.2362268
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 47 cost time: 0.8893923759460449
Epoch: 47, Steps: 64 | Train Loss: 0.1130217 Vali Loss: 0.1737505 Test Loss: 0.2349490
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 48 cost time: 0.8894808292388916
Epoch: 48, Steps: 64 | Train Loss: 0.1130314 Vali Loss: 0.1734392 Test Loss: 0.2358613
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 49 cost time: 0.8943426609039307
Epoch: 49, Steps: 64 | Train Loss: 0.1127381 Vali Loss: 0.1751820 Test Loss: 0.2353311
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 50 cost time: 0.8857779502868652
Epoch: 50, Steps: 64 | Train Loss: 0.1133280 Vali Loss: 0.1757855 Test Loss: 0.2357772
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 51 cost time: 0.8854422569274902
Epoch: 51, Steps: 64 | Train Loss: 0.1133647 Vali Loss: 0.1760451 Test Loss: 0.2368247
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 52 cost time: 0.8826117515563965
Epoch: 52, Steps: 64 | Train Loss: 0.1129159 Vali Loss: 0.1746978 Test Loss: 0.2371247
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 53 cost time: 0.8773617744445801
Epoch: 53, Steps: 64 | Train Loss: 0.1129029 Vali Loss: 0.1746845 Test Loss: 0.2371771
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 54 cost time: 0.8880982398986816
Epoch: 54, Steps: 64 | Train Loss: 0.1128640 Vali Loss: 0.1761299 Test Loss: 0.2361835
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 55 cost time: 0.8853945732116699
Epoch: 55, Steps: 64 | Train Loss: 0.1126425 Vali Loss: 0.1756288 Test Loss: 0.2362538
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 56 cost time: 0.9003551006317139
Epoch: 56, Steps: 64 | Train Loss: 0.1134181 Vali Loss: 0.1756769 Test Loss: 0.2373221
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 57 cost time: 0.8899996280670166
Epoch: 57, Steps: 64 | Train Loss: 0.1137386 Vali Loss: 0.1756738 Test Loss: 0.2360790
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 58 cost time: 0.8876316547393799
Epoch: 58, Steps: 64 | Train Loss: 0.1130322 Vali Loss: 0.1751437 Test Loss: 0.2357465
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 59 cost time: 0.8880105018615723
Epoch: 59, Steps: 64 | Train Loss: 0.1134173 Vali Loss: 0.1742388 Test Loss: 0.2355270
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 60 cost time: 0.8813700675964355
Epoch: 60, Steps: 64 | Train Loss: 0.1136759 Vali Loss: 0.1739793 Test Loss: 0.2364925
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23628363013267517, mae:0.3561118543148041, rse:0.24634909629821777
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05694866180419922 GB
Epoch: 1 cost time: 2.320951461791992
Epoch: 1, Steps: 64 | Train Loss: 0.8647424 Vali Loss: 2.3354216 Test Loss: 3.7258534
Validation loss decreased (inf --> 2.335422).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 2 cost time: 0.9189980030059814
Epoch: 2, Steps: 64 | Train Loss: 0.4684956 Vali Loss: 0.2114051 Test Loss: 0.2359388
Validation loss decreased (2.335422 --> 0.211405).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 3 cost time: 0.9207141399383545
Epoch: 3, Steps: 64 | Train Loss: 0.1552545 Vali Loss: 0.2096298 Test Loss: 0.2571430
Validation loss decreased (0.211405 --> 0.209630).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 4 cost time: 0.9170000553131104
Epoch: 4, Steps: 64 | Train Loss: 0.1386547 Vali Loss: 0.1869968 Test Loss: 0.2257730
Validation loss decreased (0.209630 --> 0.186997).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 5 cost time: 0.9200007915496826
Epoch: 5, Steps: 64 | Train Loss: 0.1319127 Vali Loss: 0.1841728 Test Loss: 0.2256150
Validation loss decreased (0.186997 --> 0.184173).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 6 cost time: 0.9156184196472168
Epoch: 6, Steps: 64 | Train Loss: 0.1288509 Vali Loss: 0.1839083 Test Loss: 0.2309709
Validation loss decreased (0.184173 --> 0.183908).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 7 cost time: 0.9051673412322998
Epoch: 7, Steps: 64 | Train Loss: 0.1256683 Vali Loss: 0.1825760 Test Loss: 0.2281785
Validation loss decreased (0.183908 --> 0.182576).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 8 cost time: 0.9164512157440186
Epoch: 8, Steps: 64 | Train Loss: 0.1239088 Vali Loss: 0.1797600 Test Loss: 0.2297804
Validation loss decreased (0.182576 --> 0.179760).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 9 cost time: 0.9154493808746338
Epoch: 9, Steps: 64 | Train Loss: 0.1222624 Vali Loss: 0.1760350 Test Loss: 0.2292914
Validation loss decreased (0.179760 --> 0.176035).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 10 cost time: 0.9273922443389893
Epoch: 10, Steps: 64 | Train Loss: 0.1204369 Vali Loss: 0.1777295 Test Loss: 0.2331044
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 11 cost time: 0.918750524520874
Epoch: 11, Steps: 64 | Train Loss: 0.1198322 Vali Loss: 0.1770242 Test Loss: 0.2317146
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 12 cost time: 0.9170000553131104
Epoch: 12, Steps: 64 | Train Loss: 0.1184367 Vali Loss: 0.1759393 Test Loss: 0.2315039
Validation loss decreased (0.176035 --> 0.175939).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 13 cost time: 0.9234235286712646
Epoch: 13, Steps: 64 | Train Loss: 0.1183605 Vali Loss: 0.1739399 Test Loss: 0.2332827
Validation loss decreased (0.175939 --> 0.173940).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 14 cost time: 0.9896271228790283
Epoch: 14, Steps: 64 | Train Loss: 0.1170459 Vali Loss: 0.1746617 Test Loss: 0.2319267
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 15 cost time: 0.9834725856781006
Epoch: 15, Steps: 64 | Train Loss: 0.1173336 Vali Loss: 0.1741651 Test Loss: 0.2308088
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 16 cost time: 0.9864373207092285
Epoch: 16, Steps: 64 | Train Loss: 0.1164479 Vali Loss: 0.1775323 Test Loss: 0.2343744
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 17 cost time: 0.918142557144165
Epoch: 17, Steps: 64 | Train Loss: 0.1156742 Vali Loss: 0.1718726 Test Loss: 0.2322840
Validation loss decreased (0.173940 --> 0.171873).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 18 cost time: 0.914344310760498
Epoch: 18, Steps: 64 | Train Loss: 0.1152696 Vali Loss: 0.1745010 Test Loss: 0.2338706
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 19 cost time: 0.9194817543029785
Epoch: 19, Steps: 64 | Train Loss: 0.1152036 Vali Loss: 0.1745073 Test Loss: 0.2325064
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 20 cost time: 0.9217915534973145
Epoch: 20, Steps: 64 | Train Loss: 0.1152553 Vali Loss: 0.1741384 Test Loss: 0.2330212
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 21 cost time: 0.9180004596710205
Epoch: 21, Steps: 64 | Train Loss: 0.1142362 Vali Loss: 0.1749672 Test Loss: 0.2326995
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 22 cost time: 0.9146261215209961
Epoch: 22, Steps: 64 | Train Loss: 0.1144629 Vali Loss: 0.1746908 Test Loss: 0.2334266
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 23 cost time: 0.9104166030883789
Epoch: 23, Steps: 64 | Train Loss: 0.1132274 Vali Loss: 0.1729607 Test Loss: 0.2341201
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 24 cost time: 0.9089705944061279
Epoch: 24, Steps: 64 | Train Loss: 0.1140095 Vali Loss: 0.1760612 Test Loss: 0.2335066
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 25 cost time: 0.909510612487793
Epoch: 25, Steps: 64 | Train Loss: 0.1138924 Vali Loss: 0.1733347 Test Loss: 0.2343389
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 26 cost time: 0.9127779006958008
Epoch: 26, Steps: 64 | Train Loss: 0.1128363 Vali Loss: 0.1745218 Test Loss: 0.2350009
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 27 cost time: 0.9127097129821777
Epoch: 27, Steps: 64 | Train Loss: 0.1130756 Vali Loss: 0.1730758 Test Loss: 0.2356856
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 28 cost time: 0.8940000534057617
Epoch: 28, Steps: 64 | Train Loss: 0.1125351 Vali Loss: 0.1751743 Test Loss: 0.2360294
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 29 cost time: 0.9096219539642334
Epoch: 29, Steps: 64 | Train Loss: 0.1125322 Vali Loss: 0.1736643 Test Loss: 0.2349101
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 30 cost time: 0.9159753322601318
Epoch: 30, Steps: 64 | Train Loss: 0.1119059 Vali Loss: 0.1723877 Test Loss: 0.2357555
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 31 cost time: 0.9113919734954834
Epoch: 31, Steps: 64 | Train Loss: 0.1119122 Vali Loss: 0.1732318 Test Loss: 0.2354111
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 32 cost time: 0.9114396572113037
Epoch: 32, Steps: 64 | Train Loss: 0.1120560 Vali Loss: 0.1724047 Test Loss: 0.2355861
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 33 cost time: 0.9113969802856445
Epoch: 33, Steps: 64 | Train Loss: 0.1121239 Vali Loss: 0.1725526 Test Loss: 0.2365008
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 34 cost time: 0.9307787418365479
Epoch: 34, Steps: 64 | Train Loss: 0.1128334 Vali Loss: 0.1718932 Test Loss: 0.2361759
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 35 cost time: 0.9150002002716064
Epoch: 35, Steps: 64 | Train Loss: 0.1117191 Vali Loss: 0.1717580 Test Loss: 0.2357941
Validation loss decreased (0.171873 --> 0.171758).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 36 cost time: 0.9230010509490967
Epoch: 36, Steps: 64 | Train Loss: 0.1115487 Vali Loss: 0.1738975 Test Loss: 0.2366146
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 37 cost time: 0.9306163787841797
Epoch: 37, Steps: 64 | Train Loss: 0.1124405 Vali Loss: 0.1734888 Test Loss: 0.2363831
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 38 cost time: 0.9154083728790283
Epoch: 38, Steps: 64 | Train Loss: 0.1113564 Vali Loss: 0.1721966 Test Loss: 0.2358293
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 39 cost time: 0.912797212600708
Epoch: 39, Steps: 64 | Train Loss: 0.1118383 Vali Loss: 0.1719861 Test Loss: 0.2372718
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 40 cost time: 0.9163904190063477
Epoch: 40, Steps: 64 | Train Loss: 0.1119105 Vali Loss: 0.1718682 Test Loss: 0.2356804
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 41 cost time: 0.926339864730835
Epoch: 41, Steps: 64 | Train Loss: 0.1116126 Vali Loss: 0.1720313 Test Loss: 0.2353908
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 42 cost time: 0.9128303527832031
Epoch: 42, Steps: 64 | Train Loss: 0.1119055 Vali Loss: 0.1743068 Test Loss: 0.2365152
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 43 cost time: 0.9159998893737793
Epoch: 43, Steps: 64 | Train Loss: 0.1115720 Vali Loss: 0.1732264 Test Loss: 0.2354984
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 44 cost time: 0.9216675758361816
Epoch: 44, Steps: 64 | Train Loss: 0.1108961 Vali Loss: 0.1721904 Test Loss: 0.2369582
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 45 cost time: 0.9143276214599609
Epoch: 45, Steps: 64 | Train Loss: 0.1117058 Vali Loss: 0.1742999 Test Loss: 0.2374105
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 46 cost time: 0.9179022312164307
Epoch: 46, Steps: 64 | Train Loss: 0.1112002 Vali Loss: 0.1717317 Test Loss: 0.2361767
Validation loss decreased (0.171758 --> 0.171732).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 47 cost time: 0.9183788299560547
Epoch: 47, Steps: 64 | Train Loss: 0.1111519 Vali Loss: 0.1733278 Test Loss: 0.2368972
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 48 cost time: 0.9137609004974365
Epoch: 48, Steps: 64 | Train Loss: 0.1111217 Vali Loss: 0.1725226 Test Loss: 0.2368893
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 49 cost time: 0.912806510925293
Epoch: 49, Steps: 64 | Train Loss: 0.1114353 Vali Loss: 0.1728913 Test Loss: 0.2363493
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 50 cost time: 0.9110012054443359
Epoch: 50, Steps: 64 | Train Loss: 0.1110888 Vali Loss: 0.1735875 Test Loss: 0.2363311
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 51 cost time: 0.9203424453735352
Epoch: 51, Steps: 64 | Train Loss: 0.1117901 Vali Loss: 0.1729224 Test Loss: 0.2367981
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 52 cost time: 0.9037337303161621
Epoch: 52, Steps: 64 | Train Loss: 0.1112054 Vali Loss: 0.1725149 Test Loss: 0.2368606
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 53 cost time: 0.9153852462768555
Epoch: 53, Steps: 64 | Train Loss: 0.1112295 Vali Loss: 0.1721355 Test Loss: 0.2363901
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 54 cost time: 0.9144034385681152
Epoch: 54, Steps: 64 | Train Loss: 0.1110733 Vali Loss: 0.1713648 Test Loss: 0.2371371
Validation loss decreased (0.171732 --> 0.171365).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 55 cost time: 0.9314301013946533
Epoch: 55, Steps: 64 | Train Loss: 0.1117539 Vali Loss: 0.1707634 Test Loss: 0.2372200
Validation loss decreased (0.171365 --> 0.170763).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 56 cost time: 0.9193918704986572
Epoch: 56, Steps: 64 | Train Loss: 0.1116843 Vali Loss: 0.1727303 Test Loss: 0.2360304
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 57 cost time: 0.9137403964996338
Epoch: 57, Steps: 64 | Train Loss: 0.1110637 Vali Loss: 0.1717572 Test Loss: 0.2367091
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 58 cost time: 0.9289991855621338
Epoch: 58, Steps: 64 | Train Loss: 0.1111137 Vali Loss: 0.1725991 Test Loss: 0.2368955
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 59 cost time: 0.9206266403198242
Epoch: 59, Steps: 64 | Train Loss: 0.1118826 Vali Loss: 0.1718200 Test Loss: 0.2358433
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 60 cost time: 0.913377046585083
Epoch: 60, Steps: 64 | Train Loss: 0.1116731 Vali Loss: 0.1729833 Test Loss: 0.2378072
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23721997439861298, mae:0.3581148087978363, rse:0.24683672189712524
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.04982280731201172 GB
Epoch: 1 cost time: 2.2792165279388428
Epoch: 1, Steps: 64 | Train Loss: 0.9759989 Vali Loss: 2.5450237 Test Loss: 4.0801892
Validation loss decreased (inf --> 2.545024).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 2 cost time: 0.8629646301269531
Epoch: 2, Steps: 64 | Train Loss: 0.8181430 Vali Loss: 1.7708682 Test Loss: 2.7815430
Validation loss decreased (2.545024 --> 1.770868).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 3 cost time: 0.9414825439453125
Epoch: 3, Steps: 64 | Train Loss: 0.6133674 Vali Loss: 1.3052877 Test Loss: 2.0124474
Validation loss decreased (1.770868 --> 1.305288).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 4 cost time: 0.8717305660247803
Epoch: 4, Steps: 64 | Train Loss: 0.4723803 Vali Loss: 1.0037049 Test Loss: 1.5249983
Validation loss decreased (1.305288 --> 1.003705).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 5 cost time: 0.8768126964569092
Epoch: 5, Steps: 64 | Train Loss: 0.3716507 Vali Loss: 0.7803873 Test Loss: 1.1789765
Validation loss decreased (1.003705 --> 0.780387).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 6 cost time: 0.8689634799957275
Epoch: 6, Steps: 64 | Train Loss: 0.3030169 Vali Loss: 0.6203773 Test Loss: 0.9259424
Validation loss decreased (0.780387 --> 0.620377).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 7 cost time: 0.8703148365020752
Epoch: 7, Steps: 64 | Train Loss: 0.2555359 Vali Loss: 0.5170890 Test Loss: 0.7609934
Validation loss decreased (0.620377 --> 0.517089).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 8 cost time: 0.8605937957763672
Epoch: 8, Steps: 64 | Train Loss: 0.2232213 Vali Loss: 0.4364145 Test Loss: 0.6314801
Validation loss decreased (0.517089 --> 0.436415).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 9 cost time: 0.8723649978637695
Epoch: 9, Steps: 64 | Train Loss: 0.1995531 Vali Loss: 0.3788460 Test Loss: 0.5439873
Validation loss decreased (0.436415 --> 0.378846).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 10 cost time: 0.8670003414154053
Epoch: 10, Steps: 64 | Train Loss: 0.1831391 Vali Loss: 0.3351775 Test Loss: 0.4752263
Validation loss decreased (0.378846 --> 0.335178).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 11 cost time: 0.8706090450286865
Epoch: 11, Steps: 64 | Train Loss: 0.1713102 Vali Loss: 0.3044884 Test Loss: 0.4260727
Validation loss decreased (0.335178 --> 0.304488).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 12 cost time: 0.8826072216033936
Epoch: 12, Steps: 64 | Train Loss: 0.1621017 Vali Loss: 0.2854565 Test Loss: 0.3947168
Validation loss decreased (0.304488 --> 0.285456).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 13 cost time: 0.8719205856323242
Epoch: 13, Steps: 64 | Train Loss: 0.1560420 Vali Loss: 0.2643800 Test Loss: 0.3604968
Validation loss decreased (0.285456 --> 0.264380).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 14 cost time: 0.8703808784484863
Epoch: 14, Steps: 64 | Train Loss: 0.1508622 Vali Loss: 0.2553207 Test Loss: 0.3423599
Validation loss decreased (0.264380 --> 0.255321).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 15 cost time: 0.8684127330780029
Epoch: 15, Steps: 64 | Train Loss: 0.1463082 Vali Loss: 0.2415760 Test Loss: 0.3245810
Validation loss decreased (0.255321 --> 0.241576).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 16 cost time: 0.8759996891021729
Epoch: 16, Steps: 64 | Train Loss: 0.1431214 Vali Loss: 0.2334075 Test Loss: 0.3120761
Validation loss decreased (0.241576 --> 0.233407).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 17 cost time: 0.8666138648986816
Epoch: 17, Steps: 64 | Train Loss: 0.1413670 Vali Loss: 0.2256972 Test Loss: 0.3003784
Validation loss decreased (0.233407 --> 0.225697).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 18 cost time: 0.8693974018096924
Epoch: 18, Steps: 64 | Train Loss: 0.1387792 Vali Loss: 0.2208216 Test Loss: 0.2930406
Validation loss decreased (0.225697 --> 0.220822).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 19 cost time: 0.8783669471740723
Epoch: 19, Steps: 64 | Train Loss: 0.1370627 Vali Loss: 0.2148414 Test Loss: 0.2863466
Validation loss decreased (0.220822 --> 0.214841).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 20 cost time: 0.8722982406616211
Epoch: 20, Steps: 64 | Train Loss: 0.1362215 Vali Loss: 0.2127556 Test Loss: 0.2805842
Validation loss decreased (0.214841 --> 0.212756).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 21 cost time: 0.869739294052124
Epoch: 21, Steps: 64 | Train Loss: 0.1345473 Vali Loss: 0.2078489 Test Loss: 0.2736006
Validation loss decreased (0.212756 --> 0.207849).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 22 cost time: 0.8730008602142334
Epoch: 22, Steps: 64 | Train Loss: 0.1339717 Vali Loss: 0.2042901 Test Loss: 0.2701173
Validation loss decreased (0.207849 --> 0.204290).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 23 cost time: 0.8746070861816406
Epoch: 23, Steps: 64 | Train Loss: 0.1325375 Vali Loss: 0.2034919 Test Loss: 0.2669693
Validation loss decreased (0.204290 --> 0.203492).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 24 cost time: 0.8389320373535156
Epoch: 24, Steps: 64 | Train Loss: 0.1313410 Vali Loss: 0.2014289 Test Loss: 0.2649884
Validation loss decreased (0.203492 --> 0.201429).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 25 cost time: 0.859370231628418
Epoch: 25, Steps: 64 | Train Loss: 0.1311861 Vali Loss: 0.2003361 Test Loss: 0.2644141
Validation loss decreased (0.201429 --> 0.200336).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 26 cost time: 0.8614201545715332
Epoch: 26, Steps: 64 | Train Loss: 0.1300966 Vali Loss: 0.1978707 Test Loss: 0.2601990
Validation loss decreased (0.200336 --> 0.197871).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 27 cost time: 0.85477614402771
Epoch: 27, Steps: 64 | Train Loss: 0.1299168 Vali Loss: 0.1955403 Test Loss: 0.2588735
Validation loss decreased (0.197871 --> 0.195540).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 28 cost time: 0.866002082824707
Epoch: 28, Steps: 64 | Train Loss: 0.1298519 Vali Loss: 0.1974762 Test Loss: 0.2580370
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 29 cost time: 0.8646194934844971
Epoch: 29, Steps: 64 | Train Loss: 0.1298267 Vali Loss: 0.1963261 Test Loss: 0.2562372
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 30 cost time: 0.8674407005310059
Epoch: 30, Steps: 64 | Train Loss: 0.1296386 Vali Loss: 0.1944780 Test Loss: 0.2534597
Validation loss decreased (0.195540 --> 0.194478).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 31 cost time: 0.8664042949676514
Epoch: 31, Steps: 64 | Train Loss: 0.1292381 Vali Loss: 0.1924021 Test Loss: 0.2513340
Validation loss decreased (0.194478 --> 0.192402).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 32 cost time: 0.8658244609832764
Epoch: 32, Steps: 64 | Train Loss: 0.1284786 Vali Loss: 0.1930125 Test Loss: 0.2525728
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 33 cost time: 0.8613953590393066
Epoch: 33, Steps: 64 | Train Loss: 0.1281934 Vali Loss: 0.1938054 Test Loss: 0.2521467
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 34 cost time: 0.8686308860778809
Epoch: 34, Steps: 64 | Train Loss: 0.1282085 Vali Loss: 0.1923327 Test Loss: 0.2502219
Validation loss decreased (0.192402 --> 0.192333).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 35 cost time: 0.86037278175354
Epoch: 35, Steps: 64 | Train Loss: 0.1283737 Vali Loss: 0.1923662 Test Loss: 0.2495584
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 36 cost time: 0.8628108501434326
Epoch: 36, Steps: 64 | Train Loss: 0.1273549 Vali Loss: 0.1917742 Test Loss: 0.2492894
Validation loss decreased (0.192333 --> 0.191774).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 37 cost time: 0.8623561859130859
Epoch: 37, Steps: 64 | Train Loss: 0.1269213 Vali Loss: 0.1904754 Test Loss: 0.2470781
Validation loss decreased (0.191774 --> 0.190475).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 38 cost time: 0.8767704963684082
Epoch: 38, Steps: 64 | Train Loss: 0.1278713 Vali Loss: 0.1899417 Test Loss: 0.2488767
Validation loss decreased (0.190475 --> 0.189942).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 39 cost time: 0.8660006523132324
Epoch: 39, Steps: 64 | Train Loss: 0.1276305 Vali Loss: 0.1907694 Test Loss: 0.2491477
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 40 cost time: 0.8626255989074707
Epoch: 40, Steps: 64 | Train Loss: 0.1269279 Vali Loss: 0.1893247 Test Loss: 0.2479567
Validation loss decreased (0.189942 --> 0.189325).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 41 cost time: 0.8603670597076416
Epoch: 41, Steps: 64 | Train Loss: 0.1272259 Vali Loss: 0.1898940 Test Loss: 0.2472767
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 42 cost time: 0.8579685688018799
Epoch: 42, Steps: 64 | Train Loss: 0.1270510 Vali Loss: 0.1893316 Test Loss: 0.2461567
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 43 cost time: 0.8547024726867676
Epoch: 43, Steps: 64 | Train Loss: 0.1271107 Vali Loss: 0.1883707 Test Loss: 0.2458279
Validation loss decreased (0.189325 --> 0.188371).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 44 cost time: 0.8620026111602783
Epoch: 44, Steps: 64 | Train Loss: 0.1268505 Vali Loss: 0.1896393 Test Loss: 0.2466538
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 45 cost time: 0.8656213283538818
Epoch: 45, Steps: 64 | Train Loss: 0.1271815 Vali Loss: 0.1867641 Test Loss: 0.2452134
Validation loss decreased (0.188371 --> 0.186764).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 46 cost time: 0.8641500473022461
Epoch: 46, Steps: 64 | Train Loss: 0.1269706 Vali Loss: 0.1889822 Test Loss: 0.2461282
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 47 cost time: 0.865389347076416
Epoch: 47, Steps: 64 | Train Loss: 0.1270394 Vali Loss: 0.1864432 Test Loss: 0.2452224
Validation loss decreased (0.186764 --> 0.186443).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 48 cost time: 0.8663976192474365
Epoch: 48, Steps: 64 | Train Loss: 0.1269988 Vali Loss: 0.1871321 Test Loss: 0.2436982
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 49 cost time: 0.8689994812011719
Epoch: 49, Steps: 64 | Train Loss: 0.1265204 Vali Loss: 0.1868057 Test Loss: 0.2422598
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 50 cost time: 0.8599996566772461
Epoch: 50, Steps: 64 | Train Loss: 0.1260999 Vali Loss: 0.1891881 Test Loss: 0.2456240
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 51 cost time: 0.8579697608947754
Epoch: 51, Steps: 64 | Train Loss: 0.1270203 Vali Loss: 0.1873568 Test Loss: 0.2438404
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 52 cost time: 0.8594114780426025
Epoch: 52, Steps: 64 | Train Loss: 0.1259587 Vali Loss: 0.1875089 Test Loss: 0.2450782
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 53 cost time: 0.8545451164245605
Epoch: 53, Steps: 64 | Train Loss: 0.1269514 Vali Loss: 0.1874618 Test Loss: 0.2452686
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 54 cost time: 0.860767126083374
Epoch: 54, Steps: 64 | Train Loss: 0.1263761 Vali Loss: 0.1866835 Test Loss: 0.2445515
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 55 cost time: 0.8609998226165771
Epoch: 55, Steps: 64 | Train Loss: 0.1257610 Vali Loss: 0.1875152 Test Loss: 0.2436233
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 56 cost time: 0.8716156482696533
Epoch: 56, Steps: 64 | Train Loss: 0.1260648 Vali Loss: 0.1873955 Test Loss: 0.2450205
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 57 cost time: 0.8653512001037598
Epoch: 57, Steps: 64 | Train Loss: 0.1266052 Vali Loss: 0.1872278 Test Loss: 0.2426228
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 58 cost time: 0.8661706447601318
Epoch: 58, Steps: 64 | Train Loss: 0.1257159 Vali Loss: 0.1868813 Test Loss: 0.2434267
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 59 cost time: 0.8638119697570801
Epoch: 59, Steps: 64 | Train Loss: 0.1263178 Vali Loss: 0.1868587 Test Loss: 0.2422025
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 60 cost time: 0.869408130645752
Epoch: 60, Steps: 64 | Train Loss: 0.1257131 Vali Loss: 0.1879970 Test Loss: 0.2438961
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.24522235989570618, mae:0.3637275695800781, rse:0.25096559524536133
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 1 cost time: 2.244725227355957
Epoch: 1, Steps: 64 | Train Loss: 0.9111560 Vali Loss: 2.4431829 Test Loss: 3.9061537
Validation loss decreased (inf --> 2.443183).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 2 cost time: 0.898404598236084
Epoch: 2, Steps: 64 | Train Loss: 0.5795973 Vali Loss: 0.5156165 Test Loss: 0.6998986
Validation loss decreased (2.443183 --> 0.515616).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 3 cost time: 0.9104351997375488
Epoch: 3, Steps: 64 | Train Loss: 0.1774103 Vali Loss: 0.1988368 Test Loss: 0.2202179
Validation loss decreased (0.515616 --> 0.198837).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 4 cost time: 0.896376371383667
Epoch: 4, Steps: 64 | Train Loss: 0.1431311 Vali Loss: 0.1985838 Test Loss: 0.2337137
Validation loss decreased (0.198837 --> 0.198584).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 5 cost time: 0.8939898014068604
Epoch: 5, Steps: 64 | Train Loss: 0.1349729 Vali Loss: 0.1859034 Test Loss: 0.2247866
Validation loss decreased (0.198584 --> 0.185903).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 6 cost time: 0.8967924118041992
Epoch: 6, Steps: 64 | Train Loss: 0.1317157 Vali Loss: 0.1820633 Test Loss: 0.2240394
Validation loss decreased (0.185903 --> 0.182063).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 7 cost time: 0.8859999179840088
Epoch: 7, Steps: 64 | Train Loss: 0.1289411 Vali Loss: 0.1784530 Test Loss: 0.2222077
Validation loss decreased (0.182063 --> 0.178453).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 8 cost time: 0.8966178894042969
Epoch: 8, Steps: 64 | Train Loss: 0.1271134 Vali Loss: 0.1741202 Test Loss: 0.2210118
Validation loss decreased (0.178453 --> 0.174120).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 9 cost time: 0.8952548503875732
Epoch: 9, Steps: 64 | Train Loss: 0.1248498 Vali Loss: 0.1736321 Test Loss: 0.2213264
Validation loss decreased (0.174120 --> 0.173632).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 10 cost time: 0.9072301387786865
Epoch: 10, Steps: 64 | Train Loss: 0.1234120 Vali Loss: 0.1718093 Test Loss: 0.2216213
Validation loss decreased (0.173632 --> 0.171809).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 11 cost time: 0.8983614444732666
Epoch: 11, Steps: 64 | Train Loss: 0.1226616 Vali Loss: 0.1740868 Test Loss: 0.2236714
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 12 cost time: 0.900364875793457
Epoch: 12, Steps: 64 | Train Loss: 0.1214535 Vali Loss: 0.1751603 Test Loss: 0.2209282
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 13 cost time: 0.8954906463623047
Epoch: 13, Steps: 64 | Train Loss: 0.1210654 Vali Loss: 0.1697140 Test Loss: 0.2216201
Validation loss decreased (0.171809 --> 0.169714).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 14 cost time: 0.9013924598693848
Epoch: 14, Steps: 64 | Train Loss: 0.1198323 Vali Loss: 0.1695843 Test Loss: 0.2206259
Validation loss decreased (0.169714 --> 0.169584).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 15 cost time: 0.8966178894042969
Epoch: 15, Steps: 64 | Train Loss: 0.1192482 Vali Loss: 0.1692572 Test Loss: 0.2196013
Validation loss decreased (0.169584 --> 0.169257).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 16 cost time: 0.8944356441497803
Epoch: 16, Steps: 64 | Train Loss: 0.1189971 Vali Loss: 0.1677394 Test Loss: 0.2209466
Validation loss decreased (0.169257 --> 0.167739).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 17 cost time: 0.9053924083709717
Epoch: 17, Steps: 64 | Train Loss: 0.1189195 Vali Loss: 0.1668029 Test Loss: 0.2197305
Validation loss decreased (0.167739 --> 0.166803).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 18 cost time: 0.897362232208252
Epoch: 18, Steps: 64 | Train Loss: 0.1179640 Vali Loss: 0.1680489 Test Loss: 0.2195817
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 19 cost time: 0.8933215141296387
Epoch: 19, Steps: 64 | Train Loss: 0.1174622 Vali Loss: 0.1680590 Test Loss: 0.2192840
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 20 cost time: 0.8899998664855957
Epoch: 20, Steps: 64 | Train Loss: 0.1169213 Vali Loss: 0.1676560 Test Loss: 0.2206818
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 21 cost time: 0.9100003242492676
Epoch: 21, Steps: 64 | Train Loss: 0.1167221 Vali Loss: 0.1669565 Test Loss: 0.2207740
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 22 cost time: 0.896449089050293
Epoch: 22, Steps: 64 | Train Loss: 0.1167856 Vali Loss: 0.1661216 Test Loss: 0.2194884
Validation loss decreased (0.166803 --> 0.166122).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 23 cost time: 0.8943576812744141
Epoch: 23, Steps: 64 | Train Loss: 0.1168047 Vali Loss: 0.1667353 Test Loss: 0.2208770
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 24 cost time: 0.8936142921447754
Epoch: 24, Steps: 64 | Train Loss: 0.1161151 Vali Loss: 0.1672477 Test Loss: 0.2203039
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 25 cost time: 0.8943309783935547
Epoch: 25, Steps: 64 | Train Loss: 0.1161469 Vali Loss: 0.1678004 Test Loss: 0.2207218
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 26 cost time: 0.8908123970031738
Epoch: 26, Steps: 64 | Train Loss: 0.1155524 Vali Loss: 0.1677957 Test Loss: 0.2197168
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 27 cost time: 0.8994033336639404
Epoch: 27, Steps: 64 | Train Loss: 0.1155218 Vali Loss: 0.1663389 Test Loss: 0.2203895
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 28 cost time: 0.9036288261413574
Epoch: 28, Steps: 64 | Train Loss: 0.1152469 Vali Loss: 0.1656461 Test Loss: 0.2207729
Validation loss decreased (0.166122 --> 0.165646).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 29 cost time: 0.8963615894317627
Epoch: 29, Steps: 64 | Train Loss: 0.1148660 Vali Loss: 0.1670023 Test Loss: 0.2201234
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 30 cost time: 0.8984415531158447
Epoch: 30, Steps: 64 | Train Loss: 0.1156876 Vali Loss: 0.1649661 Test Loss: 0.2201873
Validation loss decreased (0.165646 --> 0.164966).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 31 cost time: 0.8993301391601562
Epoch: 31, Steps: 64 | Train Loss: 0.1149131 Vali Loss: 0.1665277 Test Loss: 0.2210881
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 32 cost time: 0.8863320350646973
Epoch: 32, Steps: 64 | Train Loss: 0.1145873 Vali Loss: 0.1675631 Test Loss: 0.2209157
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 33 cost time: 0.8937482833862305
Epoch: 33, Steps: 64 | Train Loss: 0.1147789 Vali Loss: 0.1663271 Test Loss: 0.2206210
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 34 cost time: 0.8930001258850098
Epoch: 34, Steps: 64 | Train Loss: 0.1149661 Vali Loss: 0.1679408 Test Loss: 0.2206160
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 35 cost time: 0.9054019451141357
Epoch: 35, Steps: 64 | Train Loss: 0.1143896 Vali Loss: 0.1669321 Test Loss: 0.2204595
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 36 cost time: 0.8974604606628418
Epoch: 36, Steps: 64 | Train Loss: 0.1148441 Vali Loss: 0.1663596 Test Loss: 0.2211716
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 37 cost time: 0.9014265537261963
Epoch: 37, Steps: 64 | Train Loss: 0.1146729 Vali Loss: 0.1661224 Test Loss: 0.2208735
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 38 cost time: 0.8993973731994629
Epoch: 38, Steps: 64 | Train Loss: 0.1150768 Vali Loss: 0.1665489 Test Loss: 0.2207912
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 39 cost time: 0.9726223945617676
Epoch: 39, Steps: 64 | Train Loss: 0.1144185 Vali Loss: 0.1657955 Test Loss: 0.2201594
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 40 cost time: 0.9080708026885986
Epoch: 40, Steps: 64 | Train Loss: 0.1147130 Vali Loss: 0.1658155 Test Loss: 0.2200898
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 41 cost time: 0.9166238307952881
Epoch: 41, Steps: 64 | Train Loss: 0.1149751 Vali Loss: 0.1663459 Test Loss: 0.2217495
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 42 cost time: 0.9217822551727295
Epoch: 42, Steps: 64 | Train Loss: 0.1143824 Vali Loss: 0.1675484 Test Loss: 0.2207282
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 43 cost time: 0.8946259021759033
Epoch: 43, Steps: 64 | Train Loss: 0.1139800 Vali Loss: 0.1655870 Test Loss: 0.2206188
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 44 cost time: 0.8995516300201416
Epoch: 44, Steps: 64 | Train Loss: 0.1143526 Vali Loss: 0.1660706 Test Loss: 0.2209565
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 45 cost time: 0.8973543643951416
Epoch: 45, Steps: 64 | Train Loss: 0.1146156 Vali Loss: 0.1661464 Test Loss: 0.2204398
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 46 cost time: 0.8973674774169922
Epoch: 46, Steps: 64 | Train Loss: 0.1142554 Vali Loss: 0.1648759 Test Loss: 0.2209650
Validation loss decreased (0.164966 --> 0.164876).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 47 cost time: 0.9007384777069092
Epoch: 47, Steps: 64 | Train Loss: 0.1139657 Vali Loss: 0.1652031 Test Loss: 0.2214691
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 48 cost time: 0.8938415050506592
Epoch: 48, Steps: 64 | Train Loss: 0.1145427 Vali Loss: 0.1648335 Test Loss: 0.2206885
Validation loss decreased (0.164876 --> 0.164833).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 49 cost time: 0.9006240367889404
Epoch: 49, Steps: 64 | Train Loss: 0.1141876 Vali Loss: 0.1663997 Test Loss: 0.2204890
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 50 cost time: 0.8953895568847656
Epoch: 50, Steps: 64 | Train Loss: 0.1138615 Vali Loss: 0.1663379 Test Loss: 0.2213120
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 51 cost time: 0.8983824253082275
Epoch: 51, Steps: 64 | Train Loss: 0.1140320 Vali Loss: 0.1676663 Test Loss: 0.2215545
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 52 cost time: 0.8943271636962891
Epoch: 52, Steps: 64 | Train Loss: 0.1142318 Vali Loss: 0.1665031 Test Loss: 0.2212220
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 53 cost time: 0.8687541484832764
Epoch: 53, Steps: 64 | Train Loss: 0.1139238 Vali Loss: 0.1665208 Test Loss: 0.2214786
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 54 cost time: 0.861802339553833
Epoch: 54, Steps: 64 | Train Loss: 0.1140256 Vali Loss: 0.1662494 Test Loss: 0.2212233
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 55 cost time: 0.9675147533416748
Epoch: 55, Steps: 64 | Train Loss: 0.1143689 Vali Loss: 0.1653406 Test Loss: 0.2208957
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 56 cost time: 0.9516172409057617
Epoch: 56, Steps: 64 | Train Loss: 0.1145987 Vali Loss: 0.1674205 Test Loss: 0.2216736
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 57 cost time: 0.8983633518218994
Epoch: 57, Steps: 64 | Train Loss: 0.1140211 Vali Loss: 0.1634289 Test Loss: 0.2214628
Validation loss decreased (0.164833 --> 0.163429).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 58 cost time: 0.8944907188415527
Epoch: 58, Steps: 64 | Train Loss: 0.1139845 Vali Loss: 0.1666496 Test Loss: 0.2212524
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 59 cost time: 0.8941648006439209
Epoch: 59, Steps: 64 | Train Loss: 0.1144861 Vali Loss: 0.1659588 Test Loss: 0.2206677
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 60 cost time: 0.9125127792358398
Epoch: 60, Steps: 64 | Train Loss: 0.1142763 Vali Loss: 0.1666821 Test Loss: 0.2207572
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22146271169185638, mae:0.33204585313796997, rse:0.23849783837795258
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.057109832763671875 GB
Epoch: 1 cost time: 2.2901856899261475
Epoch: 1, Steps: 64 | Train Loss: 0.8871204 Vali Loss: 2.4153018 Test Loss: 3.8351345
Validation loss decreased (inf --> 2.415302).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 2 cost time: 0.9365131855010986
Epoch: 2, Steps: 64 | Train Loss: 0.4996536 Vali Loss: 0.2686502 Test Loss: 0.2647595
Validation loss decreased (2.415302 --> 0.268650).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 3 cost time: 0.9183168411254883
Epoch: 3, Steps: 64 | Train Loss: 0.1598263 Vali Loss: 0.2178869 Test Loss: 0.2585655
Validation loss decreased (0.268650 --> 0.217887).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 4 cost time: 0.9265789985656738
Epoch: 4, Steps: 64 | Train Loss: 0.1404592 Vali Loss: 0.1892636 Test Loss: 0.2253306
Validation loss decreased (0.217887 --> 0.189264).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 5 cost time: 0.9254069328308105
Epoch: 5, Steps: 64 | Train Loss: 0.1347128 Vali Loss: 0.1859890 Test Loss: 0.2231596
Validation loss decreased (0.189264 --> 0.185989).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 6 cost time: 0.9300696849822998
Epoch: 6, Steps: 64 | Train Loss: 0.1304707 Vali Loss: 0.1820009 Test Loss: 0.2234039
Validation loss decreased (0.185989 --> 0.182001).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 7 cost time: 0.9253747463226318
Epoch: 7, Steps: 64 | Train Loss: 0.1269343 Vali Loss: 0.1777647 Test Loss: 0.2212741
Validation loss decreased (0.182001 --> 0.177765).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 8 cost time: 0.9233741760253906
Epoch: 8, Steps: 64 | Train Loss: 0.1259408 Vali Loss: 0.1769457 Test Loss: 0.2210804
Validation loss decreased (0.177765 --> 0.176946).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 9 cost time: 0.9298291206359863
Epoch: 9, Steps: 64 | Train Loss: 0.1239738 Vali Loss: 0.1747968 Test Loss: 0.2209138
Validation loss decreased (0.176946 --> 0.174797).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 10 cost time: 0.9368743896484375
Epoch: 10, Steps: 64 | Train Loss: 0.1224932 Vali Loss: 0.1724306 Test Loss: 0.2187061
Validation loss decreased (0.174797 --> 0.172431).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 11 cost time: 0.9276010990142822
Epoch: 11, Steps: 64 | Train Loss: 0.1212008 Vali Loss: 0.1707829 Test Loss: 0.2206861
Validation loss decreased (0.172431 --> 0.170783).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 12 cost time: 0.9366226196289062
Epoch: 12, Steps: 64 | Train Loss: 0.1197570 Vali Loss: 0.1717957 Test Loss: 0.2218628
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 13 cost time: 0.9514124393463135
Epoch: 13, Steps: 64 | Train Loss: 0.1190782 Vali Loss: 0.1701994 Test Loss: 0.2196452
Validation loss decreased (0.170783 --> 0.170199).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 14 cost time: 0.9353611469268799
Epoch: 14, Steps: 64 | Train Loss: 0.1190166 Vali Loss: 0.1695426 Test Loss: 0.2194295
Validation loss decreased (0.170199 --> 0.169543).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 15 cost time: 0.9354021549224854
Epoch: 15, Steps: 64 | Train Loss: 0.1180068 Vali Loss: 0.1700688 Test Loss: 0.2204804
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 16 cost time: 0.9314513206481934
Epoch: 16, Steps: 64 | Train Loss: 0.1172416 Vali Loss: 0.1676268 Test Loss: 0.2200814
Validation loss decreased (0.169543 --> 0.167627).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 17 cost time: 0.9293825626373291
Epoch: 17, Steps: 64 | Train Loss: 0.1173649 Vali Loss: 0.1677330 Test Loss: 0.2194769
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 18 cost time: 0.9437456130981445
Epoch: 18, Steps: 64 | Train Loss: 0.1164207 Vali Loss: 0.1668549 Test Loss: 0.2202861
Validation loss decreased (0.167627 --> 0.166855).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 19 cost time: 0.9368002414703369
Epoch: 19, Steps: 64 | Train Loss: 0.1159842 Vali Loss: 0.1656425 Test Loss: 0.2199025
Validation loss decreased (0.166855 --> 0.165642).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 20 cost time: 0.951998233795166
Epoch: 20, Steps: 64 | Train Loss: 0.1164779 Vali Loss: 0.1666948 Test Loss: 0.2201858
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 21 cost time: 0.9336225986480713
Epoch: 21, Steps: 64 | Train Loss: 0.1157217 Vali Loss: 0.1656273 Test Loss: 0.2213088
Validation loss decreased (0.165642 --> 0.165627).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 22 cost time: 0.9344985485076904
Epoch: 22, Steps: 64 | Train Loss: 0.1152243 Vali Loss: 0.1662931 Test Loss: 0.2205932
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 23 cost time: 0.9305498600006104
Epoch: 23, Steps: 64 | Train Loss: 0.1156645 Vali Loss: 0.1667276 Test Loss: 0.2219404
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 24 cost time: 0.9294474124908447
Epoch: 24, Steps: 64 | Train Loss: 0.1145669 Vali Loss: 0.1664009 Test Loss: 0.2216308
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 25 cost time: 0.9373700618743896
Epoch: 25, Steps: 64 | Train Loss: 0.1148265 Vali Loss: 0.1653938 Test Loss: 0.2222042
Validation loss decreased (0.165627 --> 0.165394).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 26 cost time: 0.9363758563995361
Epoch: 26, Steps: 64 | Train Loss: 0.1142430 Vali Loss: 0.1665757 Test Loss: 0.2224674
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 27 cost time: 0.9256711006164551
Epoch: 27, Steps: 64 | Train Loss: 0.1148878 Vali Loss: 0.1654517 Test Loss: 0.2207928
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 28 cost time: 0.9726176261901855
Epoch: 28, Steps: 64 | Train Loss: 0.1148006 Vali Loss: 0.1654944 Test Loss: 0.2213474
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 29 cost time: 0.9360003471374512
Epoch: 29, Steps: 64 | Train Loss: 0.1142986 Vali Loss: 0.1667559 Test Loss: 0.2221230
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 30 cost time: 0.9293177127838135
Epoch: 30, Steps: 64 | Train Loss: 0.1140821 Vali Loss: 0.1647351 Test Loss: 0.2217661
Validation loss decreased (0.165394 --> 0.164735).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 31 cost time: 0.9254059791564941
Epoch: 31, Steps: 64 | Train Loss: 0.1142233 Vali Loss: 0.1645493 Test Loss: 0.2222298
Validation loss decreased (0.164735 --> 0.164549).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 32 cost time: 0.9284012317657471
Epoch: 32, Steps: 64 | Train Loss: 0.1134980 Vali Loss: 0.1656645 Test Loss: 0.2222264
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 33 cost time: 0.9433548450469971
Epoch: 33, Steps: 64 | Train Loss: 0.1134062 Vali Loss: 0.1640413 Test Loss: 0.2221734
Validation loss decreased (0.164549 --> 0.164041).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 34 cost time: 0.927391529083252
Epoch: 34, Steps: 64 | Train Loss: 0.1135379 Vali Loss: 0.1638614 Test Loss: 0.2220828
Validation loss decreased (0.164041 --> 0.163861).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 35 cost time: 0.9374728202819824
Epoch: 35, Steps: 64 | Train Loss: 0.1131625 Vali Loss: 0.1654673 Test Loss: 0.2224305
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 36 cost time: 0.931495189666748
Epoch: 36, Steps: 64 | Train Loss: 0.1133161 Vali Loss: 0.1644935 Test Loss: 0.2223079
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 37 cost time: 0.948000431060791
Epoch: 37, Steps: 64 | Train Loss: 0.1132309 Vali Loss: 0.1641574 Test Loss: 0.2225218
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 38 cost time: 0.9426255226135254
Epoch: 38, Steps: 64 | Train Loss: 0.1139939 Vali Loss: 0.1640681 Test Loss: 0.2221292
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 39 cost time: 0.9266402721405029
Epoch: 39, Steps: 64 | Train Loss: 0.1129657 Vali Loss: 0.1630612 Test Loss: 0.2224133
Validation loss decreased (0.163861 --> 0.163061).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 40 cost time: 0.9470219612121582
Epoch: 40, Steps: 64 | Train Loss: 0.1135430 Vali Loss: 0.1632960 Test Loss: 0.2228896
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 41 cost time: 0.9285421371459961
Epoch: 41, Steps: 64 | Train Loss: 0.1136676 Vali Loss: 0.1642112 Test Loss: 0.2220435
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 42 cost time: 0.9284183979034424
Epoch: 42, Steps: 64 | Train Loss: 0.1127693 Vali Loss: 0.1641644 Test Loss: 0.2222449
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 43 cost time: 0.9293718338012695
Epoch: 43, Steps: 64 | Train Loss: 0.1133225 Vali Loss: 0.1646652 Test Loss: 0.2225539
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 44 cost time: 0.9147641658782959
Epoch: 44, Steps: 64 | Train Loss: 0.1132684 Vali Loss: 0.1652889 Test Loss: 0.2227831
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 45 cost time: 0.9400002956390381
Epoch: 45, Steps: 64 | Train Loss: 0.1135390 Vali Loss: 0.1634139 Test Loss: 0.2225064
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 46 cost time: 0.934999942779541
Epoch: 46, Steps: 64 | Train Loss: 0.1128297 Vali Loss: 0.1654339 Test Loss: 0.2231577
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 47 cost time: 0.9336183071136475
Epoch: 47, Steps: 64 | Train Loss: 0.1131816 Vali Loss: 0.1656077 Test Loss: 0.2226395
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 48 cost time: 0.9320411682128906
Epoch: 48, Steps: 64 | Train Loss: 0.1133802 Vali Loss: 0.1643715 Test Loss: 0.2224093
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 49 cost time: 0.9344098567962646
Epoch: 49, Steps: 64 | Train Loss: 0.1128650 Vali Loss: 0.1642662 Test Loss: 0.2226646
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 50 cost time: 0.9413425922393799
Epoch: 50, Steps: 64 | Train Loss: 0.1129574 Vali Loss: 0.1639865 Test Loss: 0.2222503
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 51 cost time: 0.917367696762085
Epoch: 51, Steps: 64 | Train Loss: 0.1137036 Vali Loss: 0.1641452 Test Loss: 0.2229947
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 52 cost time: 0.9448442459106445
Epoch: 52, Steps: 64 | Train Loss: 0.1125492 Vali Loss: 0.1638250 Test Loss: 0.2231627
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 53 cost time: 0.9383416175842285
Epoch: 53, Steps: 64 | Train Loss: 0.1130525 Vali Loss: 0.1648407 Test Loss: 0.2227669
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 54 cost time: 0.9499988555908203
Epoch: 54, Steps: 64 | Train Loss: 0.1129694 Vali Loss: 0.1649583 Test Loss: 0.2229129
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 55 cost time: 0.9376180171966553
Epoch: 55, Steps: 64 | Train Loss: 0.1132400 Vali Loss: 0.1647430 Test Loss: 0.2228210
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 56 cost time: 0.9304614067077637
Epoch: 56, Steps: 64 | Train Loss: 0.1126690 Vali Loss: 0.1652016 Test Loss: 0.2231412
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 57 cost time: 0.9413437843322754
Epoch: 57, Steps: 64 | Train Loss: 0.1129131 Vali Loss: 0.1656282 Test Loss: 0.2232890
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 58 cost time: 0.9344563484191895
Epoch: 58, Steps: 64 | Train Loss: 0.1130351 Vali Loss: 0.1639141 Test Loss: 0.2224935
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 59 cost time: 0.9286327362060547
Epoch: 59, Steps: 64 | Train Loss: 0.1126592 Vali Loss: 0.1647497 Test Loss: 0.2224018
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 60 cost time: 0.939354658126831
Epoch: 60, Steps: 64 | Train Loss: 0.1131586 Vali Loss: 0.1650038 Test Loss: 0.2233152
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22241325676441193, mae:0.3359775245189667, rse:0.23900912702083588
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.04998350143432617 GB
Epoch: 1 cost time: 2.311038017272949
Epoch: 1, Steps: 64 | Train Loss: 1.0515935 Vali Loss: 2.7581050 Test Loss: 4.3976383
Validation loss decreased (inf --> 2.758105).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 2 cost time: 0.9406185150146484
Epoch: 2, Steps: 64 | Train Loss: 0.8355594 Vali Loss: 1.6258227 Test Loss: 2.5133030
Validation loss decreased (2.758105 --> 1.625823).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 3 cost time: 0.9296183586120605
Epoch: 3, Steps: 64 | Train Loss: 0.5557233 Vali Loss: 1.1456534 Test Loss: 1.7250359
Validation loss decreased (1.625823 --> 1.145653).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 4 cost time: 0.8766176700592041
Epoch: 4, Steps: 64 | Train Loss: 0.4191817 Vali Loss: 0.8729531 Test Loss: 1.2817863
Validation loss decreased (1.145653 --> 0.872953).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 5 cost time: 0.8713915348052979
Epoch: 5, Steps: 64 | Train Loss: 0.3305658 Vali Loss: 0.6850218 Test Loss: 0.9887534
Validation loss decreased (0.872953 --> 0.685022).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 6 cost time: 0.8674068450927734
Epoch: 6, Steps: 64 | Train Loss: 0.2725744 Vali Loss: 0.5407958 Test Loss: 0.7771031
Validation loss decreased (0.685022 --> 0.540796).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 7 cost time: 0.8665077686309814
Epoch: 7, Steps: 64 | Train Loss: 0.2321134 Vali Loss: 0.4451789 Test Loss: 0.6286281
Validation loss decreased (0.540796 --> 0.445179).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 8 cost time: 0.8539998531341553
Epoch: 8, Steps: 64 | Train Loss: 0.2046548 Vali Loss: 0.3747663 Test Loss: 0.5215275
Validation loss decreased (0.445179 --> 0.374766).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 9 cost time: 0.863818883895874
Epoch: 9, Steps: 64 | Train Loss: 0.1859405 Vali Loss: 0.3321075 Test Loss: 0.4561460
Validation loss decreased (0.374766 --> 0.332107).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 10 cost time: 0.8723797798156738
Epoch: 10, Steps: 64 | Train Loss: 0.1725046 Vali Loss: 0.2958252 Test Loss: 0.4043765
Validation loss decreased (0.332107 --> 0.295825).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 11 cost time: 0.8833527565002441
Epoch: 11, Steps: 64 | Train Loss: 0.1620303 Vali Loss: 0.2688445 Test Loss: 0.3658268
Validation loss decreased (0.295825 --> 0.268844).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 12 cost time: 0.8734250068664551
Epoch: 12, Steps: 64 | Train Loss: 0.1540445 Vali Loss: 0.2534116 Test Loss: 0.3441765
Validation loss decreased (0.268844 --> 0.253412).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 13 cost time: 0.8737890720367432
Epoch: 13, Steps: 64 | Train Loss: 0.1500428 Vali Loss: 0.2385252 Test Loss: 0.3181238
Validation loss decreased (0.253412 --> 0.238525).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 14 cost time: 0.875
Epoch: 14, Steps: 64 | Train Loss: 0.1451962 Vali Loss: 0.2275709 Test Loss: 0.3023012
Validation loss decreased (0.238525 --> 0.227571).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 15 cost time: 0.8734025955200195
Epoch: 15, Steps: 64 | Train Loss: 0.1422479 Vali Loss: 0.2185512 Test Loss: 0.2904249
Validation loss decreased (0.227571 --> 0.218551).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 16 cost time: 0.8693456649780273
Epoch: 16, Steps: 64 | Train Loss: 0.1401514 Vali Loss: 0.2113736 Test Loss: 0.2813440
Validation loss decreased (0.218551 --> 0.211374).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 17 cost time: 0.8653934001922607
Epoch: 17, Steps: 64 | Train Loss: 0.1376647 Vali Loss: 0.2072085 Test Loss: 0.2754407
Validation loss decreased (0.211374 --> 0.207208).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 18 cost time: 0.8763558864593506
Epoch: 18, Steps: 64 | Train Loss: 0.1364872 Vali Loss: 0.2045959 Test Loss: 0.2691613
Validation loss decreased (0.207208 --> 0.204596).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 19 cost time: 0.9413790702819824
Epoch: 19, Steps: 64 | Train Loss: 0.1351713 Vali Loss: 0.1988600 Test Loss: 0.2615181
Validation loss decreased (0.204596 --> 0.198860).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 20 cost time: 0.8627979755401611
Epoch: 20, Steps: 64 | Train Loss: 0.1337049 Vali Loss: 0.1950627 Test Loss: 0.2582109
Validation loss decreased (0.198860 --> 0.195063).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 21 cost time: 0.8712515830993652
Epoch: 21, Steps: 64 | Train Loss: 0.1330273 Vali Loss: 0.1935675 Test Loss: 0.2546103
Validation loss decreased (0.195063 --> 0.193567).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 22 cost time: 0.8796319961547852
Epoch: 22, Steps: 64 | Train Loss: 0.1322356 Vali Loss: 0.1920124 Test Loss: 0.2542171
Validation loss decreased (0.193567 --> 0.192012).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 23 cost time: 0.8743405342102051
Epoch: 23, Steps: 64 | Train Loss: 0.1310571 Vali Loss: 0.1911316 Test Loss: 0.2503567
Validation loss decreased (0.192012 --> 0.191132).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 24 cost time: 0.8653254508972168
Epoch: 24, Steps: 64 | Train Loss: 0.1309630 Vali Loss: 0.1901233 Test Loss: 0.2491181
Validation loss decreased (0.191132 --> 0.190123).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 25 cost time: 0.8653819561004639
Epoch: 25, Steps: 64 | Train Loss: 0.1310471 Vali Loss: 0.1890773 Test Loss: 0.2467538
Validation loss decreased (0.190123 --> 0.189077).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 26 cost time: 0.8510000705718994
Epoch: 26, Steps: 64 | Train Loss: 0.1299394 Vali Loss: 0.1857831 Test Loss: 0.2433146
Validation loss decreased (0.189077 --> 0.185783).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 27 cost time: 0.8676185607910156
Epoch: 27, Steps: 64 | Train Loss: 0.1291331 Vali Loss: 0.1858825 Test Loss: 0.2430599
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 28 cost time: 0.8709075450897217
Epoch: 28, Steps: 64 | Train Loss: 0.1289625 Vali Loss: 0.1854035 Test Loss: 0.2428869
Validation loss decreased (0.185783 --> 0.185404).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 29 cost time: 0.8782548904418945
Epoch: 29, Steps: 64 | Train Loss: 0.1286231 Vali Loss: 0.1859820 Test Loss: 0.2431104
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 30 cost time: 0.8603897094726562
Epoch: 30, Steps: 64 | Train Loss: 0.1283385 Vali Loss: 0.1814173 Test Loss: 0.2406695
Validation loss decreased (0.185404 --> 0.181417).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 31 cost time: 0.8677370548248291
Epoch: 31, Steps: 64 | Train Loss: 0.1285617 Vali Loss: 0.1831480 Test Loss: 0.2404303
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 32 cost time: 0.8669998645782471
Epoch: 32, Steps: 64 | Train Loss: 0.1284771 Vali Loss: 0.1829617 Test Loss: 0.2393005
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 33 cost time: 0.8546984195709229
Epoch: 33, Steps: 64 | Train Loss: 0.1275460 Vali Loss: 0.1823180 Test Loss: 0.2390005
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 34 cost time: 0.8683946132659912
Epoch: 34, Steps: 64 | Train Loss: 0.1274132 Vali Loss: 0.1826310 Test Loss: 0.2380897
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 35 cost time: 0.8653967380523682
Epoch: 35, Steps: 64 | Train Loss: 0.1276481 Vali Loss: 0.1820218 Test Loss: 0.2392013
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 36 cost time: 0.8764781951904297
Epoch: 36, Steps: 64 | Train Loss: 0.1274763 Vali Loss: 0.1831539 Test Loss: 0.2384176
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 37 cost time: 0.8732657432556152
Epoch: 37, Steps: 64 | Train Loss: 0.1273328 Vali Loss: 0.1809740 Test Loss: 0.2370680
Validation loss decreased (0.181417 --> 0.180974).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 38 cost time: 0.8710002899169922
Epoch: 38, Steps: 64 | Train Loss: 0.1269453 Vali Loss: 0.1796222 Test Loss: 0.2358038
Validation loss decreased (0.180974 --> 0.179622).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 39 cost time: 0.8736138343811035
Epoch: 39, Steps: 64 | Train Loss: 0.1268072 Vali Loss: 0.1792313 Test Loss: 0.2359666
Validation loss decreased (0.179622 --> 0.179231).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 40 cost time: 0.8843860626220703
Epoch: 40, Steps: 64 | Train Loss: 0.1271475 Vali Loss: 0.1799556 Test Loss: 0.2360305
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 41 cost time: 0.8693311214447021
Epoch: 41, Steps: 64 | Train Loss: 0.1267668 Vali Loss: 0.1794431 Test Loss: 0.2369397
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 42 cost time: 0.8624193668365479
Epoch: 42, Steps: 64 | Train Loss: 0.1269556 Vali Loss: 0.1806487 Test Loss: 0.2366436
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 43 cost time: 0.8730018138885498
Epoch: 43, Steps: 64 | Train Loss: 0.1267340 Vali Loss: 0.1783205 Test Loss: 0.2354788
Validation loss decreased (0.179231 --> 0.178321).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 44 cost time: 0.8756494522094727
Epoch: 44, Steps: 64 | Train Loss: 0.1262788 Vali Loss: 0.1791870 Test Loss: 0.2366117
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 45 cost time: 0.8674459457397461
Epoch: 45, Steps: 64 | Train Loss: 0.1268705 Vali Loss: 0.1799517 Test Loss: 0.2367435
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 46 cost time: 0.8703582286834717
Epoch: 46, Steps: 64 | Train Loss: 0.1265983 Vali Loss: 0.1793245 Test Loss: 0.2350221
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 47 cost time: 0.8833515644073486
Epoch: 47, Steps: 64 | Train Loss: 0.1267681 Vali Loss: 0.1772066 Test Loss: 0.2344962
Validation loss decreased (0.178321 --> 0.177207).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 48 cost time: 0.8897848129272461
Epoch: 48, Steps: 64 | Train Loss: 0.1264168 Vali Loss: 0.1789803 Test Loss: 0.2350990
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 49 cost time: 0.8740003108978271
Epoch: 49, Steps: 64 | Train Loss: 0.1267380 Vali Loss: 0.1791016 Test Loss: 0.2344485
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 50 cost time: 0.8676149845123291
Epoch: 50, Steps: 64 | Train Loss: 0.1256859 Vali Loss: 0.1791555 Test Loss: 0.2351517
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 51 cost time: 0.8702397346496582
Epoch: 51, Steps: 64 | Train Loss: 0.1267420 Vali Loss: 0.1789448 Test Loss: 0.2348880
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 52 cost time: 0.8685102462768555
Epoch: 52, Steps: 64 | Train Loss: 0.1263701 Vali Loss: 0.1790785 Test Loss: 0.2358505
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 53 cost time: 0.8693630695343018
Epoch: 53, Steps: 64 | Train Loss: 0.1263381 Vali Loss: 0.1775532 Test Loss: 0.2332968
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 54 cost time: 0.8664629459381104
Epoch: 54, Steps: 64 | Train Loss: 0.1269315 Vali Loss: 0.1797254 Test Loss: 0.2344545
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 55 cost time: 0.8713576793670654
Epoch: 55, Steps: 64 | Train Loss: 0.1260789 Vali Loss: 0.1780602 Test Loss: 0.2339227
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 56 cost time: 0.8756170272827148
Epoch: 56, Steps: 64 | Train Loss: 0.1258290 Vali Loss: 0.1802076 Test Loss: 0.2354180
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 57 cost time: 0.8674643039703369
Epoch: 57, Steps: 64 | Train Loss: 0.1263330 Vali Loss: 0.1778725 Test Loss: 0.2338142
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 58 cost time: 0.8823690414428711
Epoch: 58, Steps: 64 | Train Loss: 0.1265165 Vali Loss: 0.1780023 Test Loss: 0.2324632
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 59 cost time: 0.8617417812347412
Epoch: 59, Steps: 64 | Train Loss: 0.1265530 Vali Loss: 0.1765129 Test Loss: 0.2330859
Validation loss decreased (0.177207 --> 0.176513).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 60 cost time: 0.8644216060638428
Epoch: 60, Steps: 64 | Train Loss: 0.1265144 Vali Loss: 0.1790985 Test Loss: 0.2345349
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23308591544628143, mae:0.3470531105995178, rse:0.24467644095420837
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 1 cost time: 2.1724750995635986
Epoch: 1, Steps: 64 | Train Loss: 0.9198486 Vali Loss: 2.4706547 Test Loss: 3.9234307
Validation loss decreased (inf --> 2.470655).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 2 cost time: 0.8453531265258789
Epoch: 2, Steps: 64 | Train Loss: 0.6216047 Vali Loss: 0.7334520 Test Loss: 1.0724466
Validation loss decreased (2.470655 --> 0.733452).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 3 cost time: 0.8413307666778564
Epoch: 3, Steps: 64 | Train Loss: 0.2075161 Vali Loss: 0.2079626 Test Loss: 0.2366642
Validation loss decreased (0.733452 --> 0.207963).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 4 cost time: 0.8402390480041504
Epoch: 4, Steps: 64 | Train Loss: 0.1471918 Vali Loss: 0.1993309 Test Loss: 0.2370906
Validation loss decreased (0.207963 --> 0.199331).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 5 cost time: 0.8389999866485596
Epoch: 5, Steps: 64 | Train Loss: 0.1388316 Vali Loss: 0.1898569 Test Loss: 0.2302499
Validation loss decreased (0.199331 --> 0.189857).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 6 cost time: 0.8226487636566162
Epoch: 6, Steps: 64 | Train Loss: 0.1334565 Vali Loss: 0.1842529 Test Loss: 0.2269747
Validation loss decreased (0.189857 --> 0.184253).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 7 cost time: 0.8434088230133057
Epoch: 7, Steps: 64 | Train Loss: 0.1303576 Vali Loss: 0.1799155 Test Loss: 0.2247836
Validation loss decreased (0.184253 --> 0.179915).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 8 cost time: 0.8364439010620117
Epoch: 8, Steps: 64 | Train Loss: 0.1275257 Vali Loss: 0.1804442 Test Loss: 0.2258015
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 9 cost time: 0.8421599864959717
Epoch: 9, Steps: 64 | Train Loss: 0.1259592 Vali Loss: 0.1767153 Test Loss: 0.2244784
Validation loss decreased (0.179915 --> 0.176715).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 10 cost time: 0.8360004425048828
Epoch: 10, Steps: 64 | Train Loss: 0.1243197 Vali Loss: 0.1740872 Test Loss: 0.2251039
Validation loss decreased (0.176715 --> 0.174087).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 11 cost time: 0.8416316509246826
Epoch: 11, Steps: 64 | Train Loss: 0.1232873 Vali Loss: 0.1732790 Test Loss: 0.2256404
Validation loss decreased (0.174087 --> 0.173279).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 12 cost time: 0.8433592319488525
Epoch: 12, Steps: 64 | Train Loss: 0.1212956 Vali Loss: 0.1738825 Test Loss: 0.2272972
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 13 cost time: 0.8586773872375488
Epoch: 13, Steps: 64 | Train Loss: 0.1211678 Vali Loss: 0.1763003 Test Loss: 0.2257874
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 14 cost time: 0.8476543426513672
Epoch: 14, Steps: 64 | Train Loss: 0.1196100 Vali Loss: 0.1736338 Test Loss: 0.2264550
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 15 cost time: 0.8373892307281494
Epoch: 15, Steps: 64 | Train Loss: 0.1192593 Vali Loss: 0.1740233 Test Loss: 0.2258882
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 16 cost time: 0.8410005569458008
Epoch: 16, Steps: 64 | Train Loss: 0.1186405 Vali Loss: 0.1725388 Test Loss: 0.2276483
Validation loss decreased (0.173279 --> 0.172539).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 17 cost time: 0.8510212898254395
Epoch: 17, Steps: 64 | Train Loss: 0.1182479 Vali Loss: 0.1718675 Test Loss: 0.2270960
Validation loss decreased (0.172539 --> 0.171868).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 18 cost time: 0.8344335556030273
Epoch: 18, Steps: 64 | Train Loss: 0.1176986 Vali Loss: 0.1704879 Test Loss: 0.2269576
Validation loss decreased (0.171868 --> 0.170488).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 19 cost time: 0.8374314308166504
Epoch: 19, Steps: 64 | Train Loss: 0.1180671 Vali Loss: 0.1701441 Test Loss: 0.2275906
Validation loss decreased (0.170488 --> 0.170144).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 20 cost time: 0.8421459197998047
Epoch: 20, Steps: 64 | Train Loss: 0.1173453 Vali Loss: 0.1711185 Test Loss: 0.2282392
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 21 cost time: 0.8359999656677246
Epoch: 21, Steps: 64 | Train Loss: 0.1167850 Vali Loss: 0.1739070 Test Loss: 0.2293631
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 22 cost time: 0.8356490135192871
Epoch: 22, Steps: 64 | Train Loss: 0.1169488 Vali Loss: 0.1709235 Test Loss: 0.2284473
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 23 cost time: 0.8404457569122314
Epoch: 23, Steps: 64 | Train Loss: 0.1165319 Vali Loss: 0.1718380 Test Loss: 0.2288157
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 24 cost time: 0.8494553565979004
Epoch: 24, Steps: 64 | Train Loss: 0.1157985 Vali Loss: 0.1709044 Test Loss: 0.2295105
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 25 cost time: 0.8397247791290283
Epoch: 25, Steps: 64 | Train Loss: 0.1155285 Vali Loss: 0.1713656 Test Loss: 0.2296169
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 26 cost time: 0.8389997482299805
Epoch: 26, Steps: 64 | Train Loss: 0.1150532 Vali Loss: 0.1706326 Test Loss: 0.2294253
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 27 cost time: 0.8396146297454834
Epoch: 27, Steps: 64 | Train Loss: 0.1153833 Vali Loss: 0.1704623 Test Loss: 0.2305673
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 28 cost time: 0.8344182968139648
Epoch: 28, Steps: 64 | Train Loss: 0.1152444 Vali Loss: 0.1694686 Test Loss: 0.2296915
Validation loss decreased (0.170144 --> 0.169469).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 29 cost time: 0.8364455699920654
Epoch: 29, Steps: 64 | Train Loss: 0.1139309 Vali Loss: 0.1711779 Test Loss: 0.2305852
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 30 cost time: 0.83675217628479
Epoch: 30, Steps: 64 | Train Loss: 0.1148730 Vali Loss: 0.1718487 Test Loss: 0.2305933
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 31 cost time: 0.8399996757507324
Epoch: 31, Steps: 64 | Train Loss: 0.1144278 Vali Loss: 0.1692413 Test Loss: 0.2300159
Validation loss decreased (0.169469 --> 0.169241).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 32 cost time: 0.8486196994781494
Epoch: 32, Steps: 64 | Train Loss: 0.1146818 Vali Loss: 0.1702627 Test Loss: 0.2311723
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 33 cost time: 0.8363792896270752
Epoch: 33, Steps: 64 | Train Loss: 0.1138112 Vali Loss: 0.1693454 Test Loss: 0.2307712
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 34 cost time: 0.833946943283081
Epoch: 34, Steps: 64 | Train Loss: 0.1139941 Vali Loss: 0.1698022 Test Loss: 0.2306944
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 35 cost time: 0.831805944442749
Epoch: 35, Steps: 64 | Train Loss: 0.1143668 Vali Loss: 0.1704394 Test Loss: 0.2310928
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 36 cost time: 0.8389995098114014
Epoch: 36, Steps: 64 | Train Loss: 0.1141265 Vali Loss: 0.1684664 Test Loss: 0.2309016
Validation loss decreased (0.169241 --> 0.168466).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 37 cost time: 0.8376202583312988
Epoch: 37, Steps: 64 | Train Loss: 0.1138279 Vali Loss: 0.1698174 Test Loss: 0.2304520
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 38 cost time: 0.8387839794158936
Epoch: 38, Steps: 64 | Train Loss: 0.1134175 Vali Loss: 0.1704149 Test Loss: 0.2297342
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 39 cost time: 0.8473470211029053
Epoch: 39, Steps: 64 | Train Loss: 0.1135740 Vali Loss: 0.1708322 Test Loss: 0.2309516
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 40 cost time: 0.8377318382263184
Epoch: 40, Steps: 64 | Train Loss: 0.1136507 Vali Loss: 0.1697645 Test Loss: 0.2308118
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 41 cost time: 0.8379995822906494
Epoch: 41, Steps: 64 | Train Loss: 0.1131560 Vali Loss: 0.1697128 Test Loss: 0.2310339
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 42 cost time: 0.8441925048828125
Epoch: 42, Steps: 64 | Train Loss: 0.1136851 Vali Loss: 0.1693568 Test Loss: 0.2312527
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 43 cost time: 0.8494257926940918
Epoch: 43, Steps: 64 | Train Loss: 0.1135214 Vali Loss: 0.1713602 Test Loss: 0.2313361
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 44 cost time: 0.8433592319488525
Epoch: 44, Steps: 64 | Train Loss: 0.1133681 Vali Loss: 0.1694710 Test Loss: 0.2314307
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 45 cost time: 0.8357951641082764
Epoch: 45, Steps: 64 | Train Loss: 0.1132111 Vali Loss: 0.1699622 Test Loss: 0.2321092
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 46 cost time: 0.8359999656677246
Epoch: 46, Steps: 64 | Train Loss: 0.1132368 Vali Loss: 0.1697899 Test Loss: 0.2313239
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 47 cost time: 0.8480613231658936
Epoch: 47, Steps: 64 | Train Loss: 0.1139371 Vali Loss: 0.1704451 Test Loss: 0.2313972
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 48 cost time: 0.8353433609008789
Epoch: 48, Steps: 64 | Train Loss: 0.1131139 Vali Loss: 0.1687845 Test Loss: 0.2315936
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 49 cost time: 0.8373668193817139
Epoch: 49, Steps: 64 | Train Loss: 0.1133799 Vali Loss: 0.1696959 Test Loss: 0.2313588
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 50 cost time: 0.8538098335266113
Epoch: 50, Steps: 64 | Train Loss: 0.1131581 Vali Loss: 0.1710014 Test Loss: 0.2319454
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 51 cost time: 0.7949998378753662
Epoch: 51, Steps: 64 | Train Loss: 0.1134158 Vali Loss: 0.1706678 Test Loss: 0.2322659
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 52 cost time: 0.8367793560028076
Epoch: 52, Steps: 64 | Train Loss: 0.1128196 Vali Loss: 0.1691424 Test Loss: 0.2321902
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 53 cost time: 0.8333847522735596
Epoch: 53, Steps: 64 | Train Loss: 0.1131607 Vali Loss: 0.1690531 Test Loss: 0.2314362
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 54 cost time: 0.8367416858673096
Epoch: 54, Steps: 64 | Train Loss: 0.1131045 Vali Loss: 0.1695526 Test Loss: 0.2313263
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 55 cost time: 0.8389997482299805
Epoch: 55, Steps: 64 | Train Loss: 0.1132085 Vali Loss: 0.1689190 Test Loss: 0.2315880
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 56 cost time: 0.8399999141693115
Epoch: 56, Steps: 64 | Train Loss: 0.1129165 Vali Loss: 0.1698683 Test Loss: 0.2319985
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 57 cost time: 0.8380923271179199
Epoch: 57, Steps: 64 | Train Loss: 0.1130410 Vali Loss: 0.1699579 Test Loss: 0.2314188
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 58 cost time: 0.8317315578460693
Epoch: 58, Steps: 64 | Train Loss: 0.1129905 Vali Loss: 0.1690301 Test Loss: 0.2306982
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 59 cost time: 0.840343713760376
Epoch: 59, Steps: 64 | Train Loss: 0.1130062 Vali Loss: 0.1698822 Test Loss: 0.2305858
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 60 cost time: 0.8360002040863037
Epoch: 60, Steps: 64 | Train Loss: 0.1133922 Vali Loss: 0.1688330 Test Loss: 0.2320157
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2309015691280365, mae:0.35035717487335205, rse:0.24352726340293884
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05727052688598633 GB
Epoch: 1 cost time: 2.2649848461151123
Epoch: 1, Steps: 64 | Train Loss: 0.8846949 Vali Loss: 2.4084930 Test Loss: 3.8360744
Validation loss decreased (inf --> 2.408493).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 2 cost time: 0.9123339653015137
Epoch: 2, Steps: 64 | Train Loss: 0.5343316 Vali Loss: 0.2850266 Test Loss: 0.3367834
Validation loss decreased (2.408493 --> 0.285027).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 3 cost time: 0.9354128837585449
Epoch: 3, Steps: 64 | Train Loss: 0.1604187 Vali Loss: 0.2233686 Test Loss: 0.2746057
Validation loss decreased (0.285027 --> 0.223369).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 4 cost time: 0.9432418346405029
Epoch: 4, Steps: 64 | Train Loss: 0.1386867 Vali Loss: 0.1880208 Test Loss: 0.2302443
Validation loss decreased (0.223369 --> 0.188021).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 5 cost time: 0.9286062717437744
Epoch: 5, Steps: 64 | Train Loss: 0.1317156 Vali Loss: 0.1844087 Test Loss: 0.2301442
Validation loss decreased (0.188021 --> 0.184409).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 6 cost time: 0.9284226894378662
Epoch: 6, Steps: 64 | Train Loss: 0.1286895 Vali Loss: 0.1834071 Test Loss: 0.2262444
Validation loss decreased (0.184409 --> 0.183407).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 7 cost time: 0.9267756938934326
Epoch: 7, Steps: 64 | Train Loss: 0.1260189 Vali Loss: 0.1772952 Test Loss: 0.2271096
Validation loss decreased (0.183407 --> 0.177295).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 8 cost time: 0.9319343566894531
Epoch: 8, Steps: 64 | Train Loss: 0.1225521 Vali Loss: 0.1809963 Test Loss: 0.2279188
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 9 cost time: 0.9409987926483154
Epoch: 9, Steps: 64 | Train Loss: 0.1215724 Vali Loss: 0.1750366 Test Loss: 0.2275702
Validation loss decreased (0.177295 --> 0.175037).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 10 cost time: 0.9334032535552979
Epoch: 10, Steps: 64 | Train Loss: 0.1204299 Vali Loss: 0.1748799 Test Loss: 0.2277753
Validation loss decreased (0.175037 --> 0.174880).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 11 cost time: 0.9386084079742432
Epoch: 11, Steps: 64 | Train Loss: 0.1193366 Vali Loss: 0.1759814 Test Loss: 0.2307144
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 12 cost time: 0.9453651905059814
Epoch: 12, Steps: 64 | Train Loss: 0.1187271 Vali Loss: 0.1750254 Test Loss: 0.2292902
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 13 cost time: 0.9353053569793701
Epoch: 13, Steps: 64 | Train Loss: 0.1174411 Vali Loss: 0.1723992 Test Loss: 0.2291516
Validation loss decreased (0.174880 --> 0.172399).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 14 cost time: 0.9281091690063477
Epoch: 14, Steps: 64 | Train Loss: 0.1172144 Vali Loss: 0.1764528 Test Loss: 0.2320530
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 15 cost time: 0.9393525123596191
Epoch: 15, Steps: 64 | Train Loss: 0.1166388 Vali Loss: 0.1763914 Test Loss: 0.2315996
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 16 cost time: 0.9297356605529785
Epoch: 16, Steps: 64 | Train Loss: 0.1160892 Vali Loss: 0.1739558 Test Loss: 0.2325582
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 17 cost time: 0.9238619804382324
Epoch: 17, Steps: 64 | Train Loss: 0.1156782 Vali Loss: 0.1728388 Test Loss: 0.2325227
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 18 cost time: 0.9495797157287598
Epoch: 18, Steps: 64 | Train Loss: 0.1148841 Vali Loss: 0.1732607 Test Loss: 0.2343155
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 19 cost time: 0.9406235218048096
Epoch: 19, Steps: 64 | Train Loss: 0.1136068 Vali Loss: 0.1716215 Test Loss: 0.2336095
Validation loss decreased (0.172399 --> 0.171622).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 20 cost time: 0.9356145858764648
Epoch: 20, Steps: 64 | Train Loss: 0.1138409 Vali Loss: 0.1750319 Test Loss: 0.2354525
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 21 cost time: 0.9383718967437744
Epoch: 21, Steps: 64 | Train Loss: 0.1135713 Vali Loss: 0.1749412 Test Loss: 0.2363775
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 22 cost time: 0.9277317523956299
Epoch: 22, Steps: 64 | Train Loss: 0.1133222 Vali Loss: 0.1743536 Test Loss: 0.2369999
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 23 cost time: 0.9279146194458008
Epoch: 23, Steps: 64 | Train Loss: 0.1124868 Vali Loss: 0.1733569 Test Loss: 0.2364357
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 24 cost time: 0.9343664646148682
Epoch: 24, Steps: 64 | Train Loss: 0.1131871 Vali Loss: 0.1732470 Test Loss: 0.2388224
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 25 cost time: 0.9357521533966064
Epoch: 25, Steps: 64 | Train Loss: 0.1127218 Vali Loss: 0.1754266 Test Loss: 0.2393990
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 26 cost time: 0.9359986782073975
Epoch: 26, Steps: 64 | Train Loss: 0.1124074 Vali Loss: 0.1743494 Test Loss: 0.2382157
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 27 cost time: 0.9363574981689453
Epoch: 27, Steps: 64 | Train Loss: 0.1124809 Vali Loss: 0.1757873 Test Loss: 0.2393109
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 28 cost time: 0.9316151142120361
Epoch: 28, Steps: 64 | Train Loss: 0.1115732 Vali Loss: 0.1734502 Test Loss: 0.2395725
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 29 cost time: 0.9253671169281006
Epoch: 29, Steps: 64 | Train Loss: 0.1122473 Vali Loss: 0.1754126 Test Loss: 0.2394648
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 30 cost time: 0.9313390254974365
Epoch: 30, Steps: 64 | Train Loss: 0.1118801 Vali Loss: 0.1741224 Test Loss: 0.2397624
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 31 cost time: 0.9303750991821289
Epoch: 31, Steps: 64 | Train Loss: 0.1117882 Vali Loss: 0.1731618 Test Loss: 0.2401133
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 32 cost time: 0.9343216419219971
Epoch: 32, Steps: 64 | Train Loss: 0.1113220 Vali Loss: 0.1732438 Test Loss: 0.2403816
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 33 cost time: 0.9373879432678223
Epoch: 33, Steps: 64 | Train Loss: 0.1121073 Vali Loss: 0.1738171 Test Loss: 0.2412461
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 34 cost time: 0.9297723770141602
Epoch: 34, Steps: 64 | Train Loss: 0.1115598 Vali Loss: 0.1752674 Test Loss: 0.2414489
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 35 cost time: 0.9493577480316162
Epoch: 35, Steps: 64 | Train Loss: 0.1112337 Vali Loss: 0.1737713 Test Loss: 0.2409970
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 36 cost time: 0.9380004405975342
Epoch: 36, Steps: 64 | Train Loss: 0.1114211 Vali Loss: 0.1753070 Test Loss: 0.2416307
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 37 cost time: 0.9386196136474609
Epoch: 37, Steps: 64 | Train Loss: 0.1112638 Vali Loss: 0.1754644 Test Loss: 0.2413977
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 38 cost time: 0.9363937377929688
Epoch: 38, Steps: 64 | Train Loss: 0.1113800 Vali Loss: 0.1751494 Test Loss: 0.2405857
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 39 cost time: 0.9449214935302734
Epoch: 39, Steps: 64 | Train Loss: 0.1109143 Vali Loss: 0.1739800 Test Loss: 0.2410551
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 40 cost time: 0.9493122100830078
Epoch: 40, Steps: 64 | Train Loss: 0.1113644 Vali Loss: 0.1736277 Test Loss: 0.2414108
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 41 cost time: 0.9436662197113037
Epoch: 41, Steps: 64 | Train Loss: 0.1107970 Vali Loss: 0.1748916 Test Loss: 0.2405696
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 42 cost time: 0.9534120559692383
Epoch: 42, Steps: 64 | Train Loss: 0.1114125 Vali Loss: 0.1769752 Test Loss: 0.2424299
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 43 cost time: 0.9487388134002686
Epoch: 43, Steps: 64 | Train Loss: 0.1113428 Vali Loss: 0.1733028 Test Loss: 0.2412776
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 44 cost time: 0.94773268699646
Epoch: 44, Steps: 64 | Train Loss: 0.1114426 Vali Loss: 0.1747187 Test Loss: 0.2416057
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 45 cost time: 0.9590003490447998
Epoch: 45, Steps: 64 | Train Loss: 0.1117999 Vali Loss: 0.1750783 Test Loss: 0.2426053
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 46 cost time: 0.9476041793823242
Epoch: 46, Steps: 64 | Train Loss: 0.1116079 Vali Loss: 0.1764408 Test Loss: 0.2418613
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 47 cost time: 0.9436018466949463
Epoch: 47, Steps: 64 | Train Loss: 0.1105995 Vali Loss: 0.1754707 Test Loss: 0.2415859
EarlyStopping counter: 28 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 48 cost time: 0.9467053413391113
Epoch: 48, Steps: 64 | Train Loss: 0.1110958 Vali Loss: 0.1766387 Test Loss: 0.2416747
EarlyStopping counter: 29 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 49 cost time: 0.9313397407531738
Epoch: 49, Steps: 64 | Train Loss: 0.1114127 Vali Loss: 0.1747441 Test Loss: 0.2413377
EarlyStopping counter: 30 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 50 cost time: 0.9403460025787354
Epoch: 50, Steps: 64 | Train Loss: 0.1105566 Vali Loss: 0.1748881 Test Loss: 0.2422797
EarlyStopping counter: 31 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 51 cost time: 0.9531474113464355
Epoch: 51, Steps: 64 | Train Loss: 0.1108565 Vali Loss: 0.1762761 Test Loss: 0.2420411
EarlyStopping counter: 32 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 52 cost time: 0.943936824798584
Epoch: 52, Steps: 64 | Train Loss: 0.1112516 Vali Loss: 0.1763975 Test Loss: 0.2422555
EarlyStopping counter: 33 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 53 cost time: 0.9323859214782715
Epoch: 53, Steps: 64 | Train Loss: 0.1104027 Vali Loss: 0.1753184 Test Loss: 0.2418211
EarlyStopping counter: 34 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 54 cost time: 0.9303793907165527
Epoch: 54, Steps: 64 | Train Loss: 0.1112194 Vali Loss: 0.1757960 Test Loss: 0.2417380
EarlyStopping counter: 35 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 55 cost time: 0.9336237907409668
Epoch: 55, Steps: 64 | Train Loss: 0.1109437 Vali Loss: 0.1743345 Test Loss: 0.2429848
EarlyStopping counter: 36 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 56 cost time: 0.9406583309173584
Epoch: 56, Steps: 64 | Train Loss: 0.1113107 Vali Loss: 0.1730338 Test Loss: 0.2419415
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 57 cost time: 0.9543280601501465
Epoch: 57, Steps: 64 | Train Loss: 0.1107611 Vali Loss: 0.1758831 Test Loss: 0.2430776
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 58 cost time: 0.9513833522796631
Epoch: 58, Steps: 64 | Train Loss: 0.1111678 Vali Loss: 0.1745605 Test Loss: 0.2413794
EarlyStopping counter: 39 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 59 cost time: 0.9663565158843994
Epoch: 59, Steps: 64 | Train Loss: 0.1110958 Vali Loss: 0.1725313 Test Loss: 0.2419814
EarlyStopping counter: 40 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 60 cost time: 0.9539980888366699
Epoch: 60, Steps: 64 | Train Loss: 0.1109067 Vali Loss: 0.1774622 Test Loss: 0.2430192
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23360946774482727, mae:0.3544365465641022, rse:0.24495108425617218
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.05014467239379883 GB
Epoch: 1 cost time: 2.258256673812866
Epoch: 1, Steps: 64 | Train Loss: 0.9410240 Vali Loss: 2.4426973 Test Loss: 3.8809607
Validation loss decreased (inf --> 2.442697).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 2 cost time: 0.8981292247772217
Epoch: 2, Steps: 64 | Train Loss: 0.7846847 Vali Loss: 1.6128529 Test Loss: 2.5177386
Validation loss decreased (2.442697 --> 1.612853).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 3 cost time: 0.8870000839233398
Epoch: 3, Steps: 64 | Train Loss: 0.5539864 Vali Loss: 1.1347430 Test Loss: 1.7272700
Validation loss decreased (1.612853 --> 1.134743).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 4 cost time: 0.885612964630127
Epoch: 4, Steps: 64 | Train Loss: 0.4200675 Vali Loss: 0.8703080 Test Loss: 1.3063767
Validation loss decreased (1.134743 --> 0.870308).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 5 cost time: 0.8874046802520752
Epoch: 5, Steps: 64 | Train Loss: 0.3322013 Vali Loss: 0.6766555 Test Loss: 1.0084902
Validation loss decreased (0.870308 --> 0.676656).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 6 cost time: 0.875054121017456
Epoch: 6, Steps: 64 | Train Loss: 0.2745445 Vali Loss: 0.5456408 Test Loss: 0.8063061
Validation loss decreased (0.676656 --> 0.545641).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 7 cost time: 0.8753609657287598
Epoch: 7, Steps: 64 | Train Loss: 0.2356398 Vali Loss: 0.4524386 Test Loss: 0.6589100
Validation loss decreased (0.545641 --> 0.452439).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 8 cost time: 0.8658063411712646
Epoch: 8, Steps: 64 | Train Loss: 0.2080286 Vali Loss: 0.3898352 Test Loss: 0.5592433
Validation loss decreased (0.452439 --> 0.389835).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 9 cost time: 0.8738305568695068
Epoch: 9, Steps: 64 | Train Loss: 0.1881319 Vali Loss: 0.3429814 Test Loss: 0.4848962
Validation loss decreased (0.389835 --> 0.342981).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 10 cost time: 0.9019262790679932
Epoch: 10, Steps: 64 | Train Loss: 0.1730235 Vali Loss: 0.3124225 Test Loss: 0.4356606
Validation loss decreased (0.342981 --> 0.312423).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 11 cost time: 0.9042563438415527
Epoch: 11, Steps: 64 | Train Loss: 0.1632162 Vali Loss: 0.2879367 Test Loss: 0.3995060
Validation loss decreased (0.312423 --> 0.287937).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 12 cost time: 0.8850007057189941
Epoch: 12, Steps: 64 | Train Loss: 0.1557536 Vali Loss: 0.2699904 Test Loss: 0.3710362
Validation loss decreased (0.287937 --> 0.269990).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 13 cost time: 0.8940002918243408
Epoch: 13, Steps: 64 | Train Loss: 0.1500529 Vali Loss: 0.2547370 Test Loss: 0.3473728
Validation loss decreased (0.269990 --> 0.254737).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 14 cost time: 0.8814821243286133
Epoch: 14, Steps: 64 | Train Loss: 0.1459557 Vali Loss: 0.2434732 Test Loss: 0.3284875
Validation loss decreased (0.254737 --> 0.243473).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 15 cost time: 0.8752717971801758
Epoch: 15, Steps: 64 | Train Loss: 0.1420338 Vali Loss: 0.2328487 Test Loss: 0.3130622
Validation loss decreased (0.243473 --> 0.232849).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 16 cost time: 0.8814172744750977
Epoch: 16, Steps: 64 | Train Loss: 0.1389883 Vali Loss: 0.2227914 Test Loss: 0.3025166
Validation loss decreased (0.232849 --> 0.222791).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 17 cost time: 0.8786211013793945
Epoch: 17, Steps: 64 | Train Loss: 0.1358127 Vali Loss: 0.2191611 Test Loss: 0.2943227
Validation loss decreased (0.222791 --> 0.219161).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 18 cost time: 0.8763883113861084
Epoch: 18, Steps: 64 | Train Loss: 0.1354609 Vali Loss: 0.2158004 Test Loss: 0.2867847
Validation loss decreased (0.219161 --> 0.215800).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 19 cost time: 0.8873751163482666
Epoch: 19, Steps: 64 | Train Loss: 0.1329966 Vali Loss: 0.2113611 Test Loss: 0.2808336
Validation loss decreased (0.215800 --> 0.211361).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 20 cost time: 0.8943452835083008
Epoch: 20, Steps: 64 | Train Loss: 0.1314607 Vali Loss: 0.2052134 Test Loss: 0.2744426
Validation loss decreased (0.211361 --> 0.205213).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 21 cost time: 0.884777307510376
Epoch: 21, Steps: 64 | Train Loss: 0.1301215 Vali Loss: 0.2049606 Test Loss: 0.2702035
Validation loss decreased (0.205213 --> 0.204961).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 22 cost time: 0.8857855796813965
Epoch: 22, Steps: 64 | Train Loss: 0.1296866 Vali Loss: 0.1979724 Test Loss: 0.2671410
Validation loss decreased (0.204961 --> 0.197972).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 23 cost time: 0.8846359252929688
Epoch: 23, Steps: 64 | Train Loss: 0.1294530 Vali Loss: 0.2007238 Test Loss: 0.2649308
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 24 cost time: 0.8713259696960449
Epoch: 24, Steps: 64 | Train Loss: 0.1278787 Vali Loss: 0.1985782 Test Loss: 0.2628874
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 25 cost time: 0.873992919921875
Epoch: 25, Steps: 64 | Train Loss: 0.1275501 Vali Loss: 0.1971841 Test Loss: 0.2611747
Validation loss decreased (0.197972 --> 0.197184).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 26 cost time: 0.8753962516784668
Epoch: 26, Steps: 64 | Train Loss: 0.1268065 Vali Loss: 0.1968359 Test Loss: 0.2600715
Validation loss decreased (0.197184 --> 0.196836).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 27 cost time: 0.8837594985961914
Epoch: 27, Steps: 64 | Train Loss: 0.1263982 Vali Loss: 0.1920163 Test Loss: 0.2558667
Validation loss decreased (0.196836 --> 0.192016).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 28 cost time: 0.878000020980835
Epoch: 28, Steps: 64 | Train Loss: 0.1261108 Vali Loss: 0.1923454 Test Loss: 0.2552354
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 29 cost time: 0.8756186962127686
Epoch: 29, Steps: 64 | Train Loss: 0.1259212 Vali Loss: 0.1924454 Test Loss: 0.2535223
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 30 cost time: 0.8753840923309326
Epoch: 30, Steps: 64 | Train Loss: 0.1253153 Vali Loss: 0.1890807 Test Loss: 0.2506010
Validation loss decreased (0.192016 --> 0.189081).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 31 cost time: 0.8855736255645752
Epoch: 31, Steps: 64 | Train Loss: 0.1249539 Vali Loss: 0.1904540 Test Loss: 0.2502611
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 32 cost time: 0.8793981075286865
Epoch: 32, Steps: 64 | Train Loss: 0.1245167 Vali Loss: 0.1877811 Test Loss: 0.2511967
Validation loss decreased (0.189081 --> 0.187781).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 33 cost time: 0.8797330856323242
Epoch: 33, Steps: 64 | Train Loss: 0.1244588 Vali Loss: 0.1895851 Test Loss: 0.2494043
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 34 cost time: 0.877000093460083
Epoch: 34, Steps: 64 | Train Loss: 0.1245897 Vali Loss: 0.1884281 Test Loss: 0.2485738
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 35 cost time: 0.8796379566192627
Epoch: 35, Steps: 64 | Train Loss: 0.1243635 Vali Loss: 0.1883187 Test Loss: 0.2492370
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 36 cost time: 0.8784129619598389
Epoch: 36, Steps: 64 | Train Loss: 0.1239444 Vali Loss: 0.1880811 Test Loss: 0.2491311
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 37 cost time: 0.88043212890625
Epoch: 37, Steps: 64 | Train Loss: 0.1244722 Vali Loss: 0.1887147 Test Loss: 0.2486543
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 38 cost time: 0.8973886966705322
Epoch: 38, Steps: 64 | Train Loss: 0.1242633 Vali Loss: 0.1851640 Test Loss: 0.2457941
Validation loss decreased (0.187781 --> 0.185164).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 39 cost time: 0.885735034942627
Epoch: 39, Steps: 64 | Train Loss: 0.1232216 Vali Loss: 0.1862353 Test Loss: 0.2459395
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 40 cost time: 0.8799998760223389
Epoch: 40, Steps: 64 | Train Loss: 0.1246870 Vali Loss: 0.1855616 Test Loss: 0.2467171
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 41 cost time: 0.8883845806121826
Epoch: 41, Steps: 64 | Train Loss: 0.1244967 Vali Loss: 0.1844993 Test Loss: 0.2464066
Validation loss decreased (0.185164 --> 0.184499).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 42 cost time: 0.8856086730957031
Epoch: 42, Steps: 64 | Train Loss: 0.1237008 Vali Loss: 0.1853377 Test Loss: 0.2459476
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 43 cost time: 0.8753645420074463
Epoch: 43, Steps: 64 | Train Loss: 0.1232769 Vali Loss: 0.1849495 Test Loss: 0.2440526
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 44 cost time: 0.8723821640014648
Epoch: 44, Steps: 64 | Train Loss: 0.1231865 Vali Loss: 0.1860596 Test Loss: 0.2453964
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 45 cost time: 0.89974045753479
Epoch: 45, Steps: 64 | Train Loss: 0.1234990 Vali Loss: 0.1844470 Test Loss: 0.2456340
Validation loss decreased (0.184499 --> 0.184447).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 46 cost time: 0.8826215267181396
Epoch: 46, Steps: 64 | Train Loss: 0.1232356 Vali Loss: 0.1861160 Test Loss: 0.2448641
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 47 cost time: 0.8800003528594971
Epoch: 47, Steps: 64 | Train Loss: 0.1230825 Vali Loss: 0.1837032 Test Loss: 0.2458357
Validation loss decreased (0.184447 --> 0.183703).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 48 cost time: 0.8796164989471436
Epoch: 48, Steps: 64 | Train Loss: 0.1238756 Vali Loss: 0.1843611 Test Loss: 0.2441333
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 49 cost time: 0.8648684024810791
Epoch: 49, Steps: 64 | Train Loss: 0.1230098 Vali Loss: 0.1838486 Test Loss: 0.2448781
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 50 cost time: 0.8523993492126465
Epoch: 50, Steps: 64 | Train Loss: 0.1232152 Vali Loss: 0.1850395 Test Loss: 0.2434710
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 51 cost time: 0.8596756458282471
Epoch: 51, Steps: 64 | Train Loss: 0.1235153 Vali Loss: 0.1840166 Test Loss: 0.2437637
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 52 cost time: 0.8823509216308594
Epoch: 52, Steps: 64 | Train Loss: 0.1229041 Vali Loss: 0.1854978 Test Loss: 0.2445043
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 53 cost time: 0.8746285438537598
Epoch: 53, Steps: 64 | Train Loss: 0.1230364 Vali Loss: 0.1829690 Test Loss: 0.2421618
Validation loss decreased (0.183703 --> 0.182969).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 54 cost time: 0.8852317333221436
Epoch: 54, Steps: 64 | Train Loss: 0.1226467 Vali Loss: 0.1846173 Test Loss: 0.2445788
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 55 cost time: 0.8784070014953613
Epoch: 55, Steps: 64 | Train Loss: 0.1232692 Vali Loss: 0.1845843 Test Loss: 0.2449782
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 56 cost time: 0.8923702239990234
Epoch: 56, Steps: 64 | Train Loss: 0.1234476 Vali Loss: 0.1829541 Test Loss: 0.2426486
Validation loss decreased (0.182969 --> 0.182954).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 57 cost time: 0.8837251663208008
Epoch: 57, Steps: 64 | Train Loss: 0.1235450 Vali Loss: 0.1834437 Test Loss: 0.2429072
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 58 cost time: 0.8817806243896484
Epoch: 58, Steps: 64 | Train Loss: 0.1225408 Vali Loss: 0.1849391 Test Loss: 0.2445726
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 59 cost time: 0.8802411556243896
Epoch: 59, Steps: 64 | Train Loss: 0.1232535 Vali Loss: 0.1832781 Test Loss: 0.2418166
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 60 cost time: 0.8758316040039062
Epoch: 60, Steps: 64 | Train Loss: 0.1231047 Vali Loss: 0.1832809 Test Loss: 0.2438983
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.24264852702617645, mae:0.3585817217826843, rse:0.24964505434036255
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 1 cost time: 2.3425261974334717
Epoch: 1, Steps: 64 | Train Loss: 0.8742131 Vali Loss: 2.3590376 Test Loss: 3.7571752
Validation loss decreased (inf --> 2.359038).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 2 cost time: 0.9956874847412109
Epoch: 2, Steps: 64 | Train Loss: 0.5347109 Vali Loss: 0.3839951 Test Loss: 0.5413120
Validation loss decreased (2.359038 --> 0.383995).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 3 cost time: 0.9175093173980713
Epoch: 3, Steps: 64 | Train Loss: 0.1637100 Vali Loss: 0.1857412 Test Loss: 0.2181068
Validation loss decreased (0.383995 --> 0.185741).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 4 cost time: 0.9209697246551514
Epoch: 4, Steps: 64 | Train Loss: 0.1383172 Vali Loss: 0.1849607 Test Loss: 0.2353330
Validation loss decreased (0.185741 --> 0.184961).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 5 cost time: 0.9164631366729736
Epoch: 5, Steps: 64 | Train Loss: 0.1319157 Vali Loss: 0.1791336 Test Loss: 0.2277104
Validation loss decreased (0.184961 --> 0.179134).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 6 cost time: 0.9197297096252441
Epoch: 6, Steps: 64 | Train Loss: 0.1289631 Vali Loss: 0.1752630 Test Loss: 0.2257833
Validation loss decreased (0.179134 --> 0.175263).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 7 cost time: 0.9100000858306885
Epoch: 7, Steps: 64 | Train Loss: 0.1255194 Vali Loss: 0.1762759 Test Loss: 0.2274709
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 8 cost time: 0.9066355228424072
Epoch: 8, Steps: 64 | Train Loss: 0.1239764 Vali Loss: 0.1780694 Test Loss: 0.2274880
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 9 cost time: 0.9193706512451172
Epoch: 9, Steps: 64 | Train Loss: 0.1220944 Vali Loss: 0.1742779 Test Loss: 0.2282893
Validation loss decreased (0.175263 --> 0.174278).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 10 cost time: 0.9883718490600586
Epoch: 10, Steps: 64 | Train Loss: 0.1205835 Vali Loss: 0.1741275 Test Loss: 0.2265808
Validation loss decreased (0.174278 --> 0.174127).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 11 cost time: 0.993384838104248
Epoch: 11, Steps: 64 | Train Loss: 0.1198049 Vali Loss: 0.1730428 Test Loss: 0.2274865
Validation loss decreased (0.174127 --> 0.173043).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 12 cost time: 0.9903638362884521
Epoch: 12, Steps: 64 | Train Loss: 0.1187738 Vali Loss: 0.1717573 Test Loss: 0.2276608
Validation loss decreased (0.173043 --> 0.171757).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 13 cost time: 0.9979896545410156
Epoch: 13, Steps: 64 | Train Loss: 0.1184419 Vali Loss: 0.1731523 Test Loss: 0.2296968
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 14 cost time: 0.9764533042907715
Epoch: 14, Steps: 64 | Train Loss: 0.1171658 Vali Loss: 0.1735069 Test Loss: 0.2295496
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 15 cost time: 0.9133374691009521
Epoch: 15, Steps: 64 | Train Loss: 0.1167928 Vali Loss: 0.1711526 Test Loss: 0.2285177
Validation loss decreased (0.171757 --> 0.171153).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 16 cost time: 0.9278309345245361
Epoch: 16, Steps: 64 | Train Loss: 0.1159477 Vali Loss: 0.1721581 Test Loss: 0.2292899
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 17 cost time: 0.9091789722442627
Epoch: 17, Steps: 64 | Train Loss: 0.1153344 Vali Loss: 0.1720141 Test Loss: 0.2286873
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 18 cost time: 0.9119992256164551
Epoch: 18, Steps: 64 | Train Loss: 0.1147688 Vali Loss: 0.1712098 Test Loss: 0.2287719
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 19 cost time: 0.9256336688995361
Epoch: 19, Steps: 64 | Train Loss: 0.1147579 Vali Loss: 0.1705580 Test Loss: 0.2283476
Validation loss decreased (0.171153 --> 0.170558).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 20 cost time: 0.9203879833221436
Epoch: 20, Steps: 64 | Train Loss: 0.1139908 Vali Loss: 0.1720699 Test Loss: 0.2294814
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 21 cost time: 0.9199919700622559
Epoch: 21, Steps: 64 | Train Loss: 0.1132697 Vali Loss: 0.1701916 Test Loss: 0.2294306
Validation loss decreased (0.170558 --> 0.170192).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 22 cost time: 0.913414716720581
Epoch: 22, Steps: 64 | Train Loss: 0.1134900 Vali Loss: 0.1712427 Test Loss: 0.2297345
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 23 cost time: 0.908348560333252
Epoch: 23, Steps: 64 | Train Loss: 0.1132454 Vali Loss: 0.1714028 Test Loss: 0.2296326
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 24 cost time: 0.9077389240264893
Epoch: 24, Steps: 64 | Train Loss: 0.1136806 Vali Loss: 0.1689900 Test Loss: 0.2282953
Validation loss decreased (0.170192 --> 0.168990).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 25 cost time: 0.9107661247253418
Epoch: 25, Steps: 64 | Train Loss: 0.1127810 Vali Loss: 0.1687848 Test Loss: 0.2292989
Validation loss decreased (0.168990 --> 0.168785).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 26 cost time: 0.919567346572876
Epoch: 26, Steps: 64 | Train Loss: 0.1122990 Vali Loss: 0.1676603 Test Loss: 0.2300938
Validation loss decreased (0.168785 --> 0.167660).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 27 cost time: 0.9196288585662842
Epoch: 27, Steps: 64 | Train Loss: 0.1122199 Vali Loss: 0.1694399 Test Loss: 0.2288082
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 28 cost time: 0.9183504581451416
Epoch: 28, Steps: 64 | Train Loss: 0.1128948 Vali Loss: 0.1695873 Test Loss: 0.2291901
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 29 cost time: 0.9197566509246826
Epoch: 29, Steps: 64 | Train Loss: 0.1115902 Vali Loss: 0.1682965 Test Loss: 0.2293726
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 30 cost time: 0.9069793224334717
Epoch: 30, Steps: 64 | Train Loss: 0.1115907 Vali Loss: 0.1682465 Test Loss: 0.2296938
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 31 cost time: 0.9109477996826172
Epoch: 31, Steps: 64 | Train Loss: 0.1115974 Vali Loss: 0.1697277 Test Loss: 0.2286852
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 32 cost time: 0.9097859859466553
Epoch: 32, Steps: 64 | Train Loss: 0.1114550 Vali Loss: 0.1689647 Test Loss: 0.2295403
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 33 cost time: 0.9110012054443359
Epoch: 33, Steps: 64 | Train Loss: 0.1111241 Vali Loss: 0.1677229 Test Loss: 0.2293026
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 34 cost time: 0.9112465381622314
Epoch: 34, Steps: 64 | Train Loss: 0.1112827 Vali Loss: 0.1680952 Test Loss: 0.2295603
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 35 cost time: 0.9163820743560791
Epoch: 35, Steps: 64 | Train Loss: 0.1117484 Vali Loss: 0.1669714 Test Loss: 0.2303724
Validation loss decreased (0.167660 --> 0.166971).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 36 cost time: 0.9303581714630127
Epoch: 36, Steps: 64 | Train Loss: 0.1109114 Vali Loss: 0.1677941 Test Loss: 0.2295931
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 37 cost time: 0.9144287109375
Epoch: 37, Steps: 64 | Train Loss: 0.1109519 Vali Loss: 0.1688219 Test Loss: 0.2296173
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 38 cost time: 0.9149608612060547
Epoch: 38, Steps: 64 | Train Loss: 0.1108388 Vali Loss: 0.1687939 Test Loss: 0.2296655
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 39 cost time: 0.915398359298706
Epoch: 39, Steps: 64 | Train Loss: 0.1110808 Vali Loss: 0.1686367 Test Loss: 0.2295312
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 40 cost time: 0.9241132736206055
Epoch: 40, Steps: 64 | Train Loss: 0.1110228 Vali Loss: 0.1683661 Test Loss: 0.2302944
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 41 cost time: 0.9050014019012451
Epoch: 41, Steps: 64 | Train Loss: 0.1107700 Vali Loss: 0.1688213 Test Loss: 0.2294496
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 42 cost time: 0.906012773513794
Epoch: 42, Steps: 64 | Train Loss: 0.1112101 Vali Loss: 0.1671734 Test Loss: 0.2308398
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 43 cost time: 0.9343774318695068
Epoch: 43, Steps: 64 | Train Loss: 0.1110424 Vali Loss: 0.1672945 Test Loss: 0.2303237
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 44 cost time: 0.9433531761169434
Epoch: 44, Steps: 64 | Train Loss: 0.1109514 Vali Loss: 0.1683826 Test Loss: 0.2311485
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 45 cost time: 0.9373431205749512
Epoch: 45, Steps: 64 | Train Loss: 0.1102945 Vali Loss: 0.1704077 Test Loss: 0.2309388
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 46 cost time: 0.9363627433776855
Epoch: 46, Steps: 64 | Train Loss: 0.1105473 Vali Loss: 0.1672586 Test Loss: 0.2301378
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 47 cost time: 0.9060375690460205
Epoch: 47, Steps: 64 | Train Loss: 0.1106160 Vali Loss: 0.1680895 Test Loss: 0.2304975
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 48 cost time: 0.9091811180114746
Epoch: 48, Steps: 64 | Train Loss: 0.1107012 Vali Loss: 0.1670969 Test Loss: 0.2298073
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 49 cost time: 0.9119999408721924
Epoch: 49, Steps: 64 | Train Loss: 0.1102158 Vali Loss: 0.1675959 Test Loss: 0.2298481
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 50 cost time: 0.9136106967926025
Epoch: 50, Steps: 64 | Train Loss: 0.1109092 Vali Loss: 0.1689561 Test Loss: 0.2307118
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 51 cost time: 0.9173521995544434
Epoch: 51, Steps: 64 | Train Loss: 0.1099054 Vali Loss: 0.1682578 Test Loss: 0.2306234
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 52 cost time: 0.9184432029724121
Epoch: 52, Steps: 64 | Train Loss: 0.1105998 Vali Loss: 0.1682523 Test Loss: 0.2306043
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 53 cost time: 0.9163923263549805
Epoch: 53, Steps: 64 | Train Loss: 0.1105851 Vali Loss: 0.1679208 Test Loss: 0.2306654
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 54 cost time: 0.9204320907592773
Epoch: 54, Steps: 64 | Train Loss: 0.1104483 Vali Loss: 0.1683037 Test Loss: 0.2300868
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 55 cost time: 0.9192442893981934
Epoch: 55, Steps: 64 | Train Loss: 0.1103594 Vali Loss: 0.1678476 Test Loss: 0.2308397
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 56 cost time: 0.9137759208679199
Epoch: 56, Steps: 64 | Train Loss: 0.1110453 Vali Loss: 0.1683393 Test Loss: 0.2307240
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 57 cost time: 0.9190001487731934
Epoch: 57, Steps: 64 | Train Loss: 0.1104562 Vali Loss: 0.1683370 Test Loss: 0.2300447
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 58 cost time: 0.9156208038330078
Epoch: 58, Steps: 64 | Train Loss: 0.1107694 Vali Loss: 0.1686980 Test Loss: 0.2297081
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 59 cost time: 0.9147157669067383
Epoch: 59, Steps: 64 | Train Loss: 0.1107856 Vali Loss: 0.1678304 Test Loss: 0.2295138
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 60 cost time: 0.9223728179931641
Epoch: 60, Steps: 64 | Train Loss: 0.1103495 Vali Loss: 0.1684323 Test Loss: 0.2306498
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23037245869636536, mae:0.34748080372810364, rse:0.2432480901479721
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.057431697845458984 GB
Epoch: 1 cost time: 2.287579298019409
Epoch: 1, Steps: 64 | Train Loss: 0.8594637 Vali Loss: 2.3287439 Test Loss: 3.7442944
Validation loss decreased (inf --> 2.328744).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 2 cost time: 0.9423749446868896
Epoch: 2, Steps: 64 | Train Loss: 0.4524034 Vali Loss: 0.1938810 Test Loss: 0.2413591
Validation loss decreased (2.328744 --> 0.193881).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 3 cost time: 0.9456777572631836
Epoch: 3, Steps: 64 | Train Loss: 0.1503682 Vali Loss: 0.2047551 Test Loss: 0.2609427
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 4 cost time: 0.9287919998168945
Epoch: 4, Steps: 64 | Train Loss: 0.1357567 Vali Loss: 0.1830957 Test Loss: 0.2283897
Validation loss decreased (0.193881 --> 0.183096).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 5 cost time: 0.9390003681182861
Epoch: 5, Steps: 64 | Train Loss: 0.1308119 Vali Loss: 0.1744401 Test Loss: 0.2252345
Validation loss decreased (0.183096 --> 0.174440).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 6 cost time: 0.9339983463287354
Epoch: 6, Steps: 64 | Train Loss: 0.1274935 Vali Loss: 0.1773803 Test Loss: 0.2261261
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 7 cost time: 0.9376125335693359
Epoch: 7, Steps: 64 | Train Loss: 0.1253052 Vali Loss: 0.1748455 Test Loss: 0.2225602
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 8 cost time: 0.9377954006195068
Epoch: 8, Steps: 64 | Train Loss: 0.1238976 Vali Loss: 0.1764161 Test Loss: 0.2234233
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 9 cost time: 0.9403409957885742
Epoch: 9, Steps: 64 | Train Loss: 0.1212830 Vali Loss: 0.1715102 Test Loss: 0.2220964
Validation loss decreased (0.174440 --> 0.171510).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 10 cost time: 0.9545900821685791
Epoch: 10, Steps: 64 | Train Loss: 0.1201589 Vali Loss: 0.1707049 Test Loss: 0.2251887
Validation loss decreased (0.171510 --> 0.170705).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 11 cost time: 0.9483828544616699
Epoch: 11, Steps: 64 | Train Loss: 0.1189239 Vali Loss: 0.1712535 Test Loss: 0.2247670
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 12 cost time: 0.9467065334320068
Epoch: 12, Steps: 64 | Train Loss: 0.1172882 Vali Loss: 0.1727329 Test Loss: 0.2263411
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 13 cost time: 0.9443647861480713
Epoch: 13, Steps: 64 | Train Loss: 0.1172464 Vali Loss: 0.1676772 Test Loss: 0.2233938
Validation loss decreased (0.170705 --> 0.167677).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 14 cost time: 0.9588809013366699
Epoch: 14, Steps: 64 | Train Loss: 0.1167738 Vali Loss: 0.1699463 Test Loss: 0.2251247
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 15 cost time: 0.934999942779541
Epoch: 15, Steps: 64 | Train Loss: 0.1154637 Vali Loss: 0.1700952 Test Loss: 0.2262309
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 16 cost time: 0.9407622814178467
Epoch: 16, Steps: 64 | Train Loss: 0.1150729 Vali Loss: 0.1690158 Test Loss: 0.2266549
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 17 cost time: 0.9507384300231934
Epoch: 17, Steps: 64 | Train Loss: 0.1144955 Vali Loss: 0.1699807 Test Loss: 0.2275980
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 18 cost time: 0.9424026012420654
Epoch: 18, Steps: 64 | Train Loss: 0.1146088 Vali Loss: 0.1704735 Test Loss: 0.2281737
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 19 cost time: 0.950355052947998
Epoch: 19, Steps: 64 | Train Loss: 0.1134830 Vali Loss: 0.1707856 Test Loss: 0.2281023
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 20 cost time: 0.9614415168762207
Epoch: 20, Steps: 64 | Train Loss: 0.1130767 Vali Loss: 0.1702722 Test Loss: 0.2285804
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 21 cost time: 0.9453630447387695
Epoch: 21, Steps: 64 | Train Loss: 0.1121907 Vali Loss: 0.1693999 Test Loss: 0.2293312
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 22 cost time: 0.9373927116394043
Epoch: 22, Steps: 64 | Train Loss: 0.1123095 Vali Loss: 0.1694791 Test Loss: 0.2296755
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 23 cost time: 0.9367697238922119
Epoch: 23, Steps: 64 | Train Loss: 0.1124414 Vali Loss: 0.1698900 Test Loss: 0.2305093
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 24 cost time: 0.9297866821289062
Epoch: 24, Steps: 64 | Train Loss: 0.1118846 Vali Loss: 0.1711889 Test Loss: 0.2298395
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 25 cost time: 0.9476182460784912
Epoch: 25, Steps: 64 | Train Loss: 0.1115767 Vali Loss: 0.1694535 Test Loss: 0.2303972
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 26 cost time: 0.9406089782714844
Epoch: 26, Steps: 64 | Train Loss: 0.1118430 Vali Loss: 0.1691546 Test Loss: 0.2302811
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 27 cost time: 0.949688196182251
Epoch: 27, Steps: 64 | Train Loss: 0.1117714 Vali Loss: 0.1679545 Test Loss: 0.2302684
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 28 cost time: 0.9474427700042725
Epoch: 28, Steps: 64 | Train Loss: 0.1114737 Vali Loss: 0.1691993 Test Loss: 0.2314066
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 29 cost time: 0.9469797611236572
Epoch: 29, Steps: 64 | Train Loss: 0.1115897 Vali Loss: 0.1686051 Test Loss: 0.2307876
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 30 cost time: 0.9553756713867188
Epoch: 30, Steps: 64 | Train Loss: 0.1109363 Vali Loss: 0.1689586 Test Loss: 0.2310225
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 31 cost time: 0.9433393478393555
Epoch: 31, Steps: 64 | Train Loss: 0.1108035 Vali Loss: 0.1679100 Test Loss: 0.2303156
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 32 cost time: 0.9443504810333252
Epoch: 32, Steps: 64 | Train Loss: 0.1106943 Vali Loss: 0.1680667 Test Loss: 0.2300289
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 33 cost time: 0.9411795139312744
Epoch: 33, Steps: 64 | Train Loss: 0.1108981 Vali Loss: 0.1700200 Test Loss: 0.2311871
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 34 cost time: 0.966799259185791
Epoch: 34, Steps: 64 | Train Loss: 0.1102725 Vali Loss: 0.1677173 Test Loss: 0.2315462
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 35 cost time: 0.9449999332427979
Epoch: 35, Steps: 64 | Train Loss: 0.1110270 Vali Loss: 0.1680224 Test Loss: 0.2317658
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 36 cost time: 0.94461989402771
Epoch: 36, Steps: 64 | Train Loss: 0.1097982 Vali Loss: 0.1695358 Test Loss: 0.2322290
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 37 cost time: 0.9582347869873047
Epoch: 37, Steps: 64 | Train Loss: 0.1102782 Vali Loss: 0.1672083 Test Loss: 0.2308097
Validation loss decreased (0.167677 --> 0.167208).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 38 cost time: 0.941387414932251
Epoch: 38, Steps: 64 | Train Loss: 0.1099717 Vali Loss: 0.1670885 Test Loss: 0.2306016
Validation loss decreased (0.167208 --> 0.167089).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 39 cost time: 0.9393939971923828
Epoch: 39, Steps: 64 | Train Loss: 0.1100919 Vali Loss: 0.1679868 Test Loss: 0.2308433
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 40 cost time: 0.9533627033233643
Epoch: 40, Steps: 64 | Train Loss: 0.1105389 Vali Loss: 0.1696453 Test Loss: 0.2306573
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 41 cost time: 0.9407637119293213
Epoch: 41, Steps: 64 | Train Loss: 0.1101938 Vali Loss: 0.1677501 Test Loss: 0.2299509
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 42 cost time: 0.9530305862426758
Epoch: 42, Steps: 64 | Train Loss: 0.1101071 Vali Loss: 0.1694292 Test Loss: 0.2309131
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 43 cost time: 0.9457895755767822
Epoch: 43, Steps: 64 | Train Loss: 0.1101469 Vali Loss: 0.1685857 Test Loss: 0.2306581
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 44 cost time: 0.9433972835540771
Epoch: 44, Steps: 64 | Train Loss: 0.1102961 Vali Loss: 0.1691711 Test Loss: 0.2317330
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 45 cost time: 0.9734246730804443
Epoch: 45, Steps: 64 | Train Loss: 0.1101984 Vali Loss: 0.1708807 Test Loss: 0.2319818
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 46 cost time: 0.9485998153686523
Epoch: 46, Steps: 64 | Train Loss: 0.1095636 Vali Loss: 0.1689343 Test Loss: 0.2317060
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 47 cost time: 0.9486789703369141
Epoch: 47, Steps: 64 | Train Loss: 0.1099843 Vali Loss: 0.1704117 Test Loss: 0.2322205
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 48 cost time: 0.9353723526000977
Epoch: 48, Steps: 64 | Train Loss: 0.1099510 Vali Loss: 0.1688577 Test Loss: 0.2301531
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 49 cost time: 0.9359755516052246
Epoch: 49, Steps: 64 | Train Loss: 0.1098509 Vali Loss: 0.1677331 Test Loss: 0.2316290
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 50 cost time: 0.9553289413452148
Epoch: 50, Steps: 64 | Train Loss: 0.1094789 Vali Loss: 0.1689989 Test Loss: 0.2313216
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 51 cost time: 0.9971027374267578
Epoch: 51, Steps: 64 | Train Loss: 0.1100394 Vali Loss: 0.1698864 Test Loss: 0.2323906
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 52 cost time: 0.946758508682251
Epoch: 52, Steps: 64 | Train Loss: 0.1099540 Vali Loss: 0.1679834 Test Loss: 0.2319949
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 53 cost time: 0.9513943195343018
Epoch: 53, Steps: 64 | Train Loss: 0.1095524 Vali Loss: 0.1696064 Test Loss: 0.2313211
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 54 cost time: 0.9228024482727051
Epoch: 54, Steps: 64 | Train Loss: 0.1097233 Vali Loss: 0.1688227 Test Loss: 0.2311244
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 55 cost time: 0.9340000152587891
Epoch: 55, Steps: 64 | Train Loss: 0.1104012 Vali Loss: 0.1678643 Test Loss: 0.2312361
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 56 cost time: 0.9370076656341553
Epoch: 56, Steps: 64 | Train Loss: 0.1098198 Vali Loss: 0.1691989 Test Loss: 0.2324184
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 57 cost time: 0.9530315399169922
Epoch: 57, Steps: 64 | Train Loss: 0.1098754 Vali Loss: 0.1686920 Test Loss: 0.2312248
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 58 cost time: 0.9363727569580078
Epoch: 58, Steps: 64 | Train Loss: 0.1098928 Vali Loss: 0.1687748 Test Loss: 0.2313102
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 59 cost time: 0.9394729137420654
Epoch: 59, Steps: 64 | Train Loss: 0.1098339 Vali Loss: 0.1694325 Test Loss: 0.2308979
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 60 cost time: 0.958338737487793
Epoch: 60, Steps: 64 | Train Loss: 0.1099668 Vali Loss: 0.1692228 Test Loss: 0.2325776
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23060159385204315, mae:0.3489015996456146, rse:0.24336901307106018
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.057007789611816406 GB
Epoch: 1 cost time: 2.2562687397003174
Epoch: 1, Steps: 64 | Train Loss: 0.9799172 Vali Loss: 2.5126779 Test Loss: 3.9840329
Validation loss decreased (inf --> 2.512678).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 2 cost time: 0.8537399768829346
Epoch: 2, Steps: 64 | Train Loss: 0.8041140 Vali Loss: 1.6897516 Test Loss: 2.6456530
Validation loss decreased (2.512678 --> 1.689752).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 3 cost time: 0.8515255451202393
Epoch: 3, Steps: 64 | Train Loss: 0.5985927 Vali Loss: 1.2795130 Test Loss: 1.9775963
Validation loss decreased (1.689752 --> 1.279513).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 4 cost time: 0.8445572853088379
Epoch: 4, Steps: 64 | Train Loss: 0.4683927 Vali Loss: 0.9936631 Test Loss: 1.5035889
Validation loss decreased (1.279513 --> 0.993663).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 5 cost time: 0.8503849506378174
Epoch: 5, Steps: 64 | Train Loss: 0.3698078 Vali Loss: 0.7711242 Test Loss: 1.1572303
Validation loss decreased (0.993663 --> 0.771124).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 6 cost time: 0.8423559665679932
Epoch: 6, Steps: 64 | Train Loss: 0.3005697 Vali Loss: 0.6158994 Test Loss: 0.9123507
Validation loss decreased (0.771124 --> 0.615899).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 7 cost time: 0.8461272716522217
Epoch: 7, Steps: 64 | Train Loss: 0.2536296 Vali Loss: 0.5030168 Test Loss: 0.7327591
Validation loss decreased (0.615899 --> 0.503017).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 8 cost time: 0.8429989814758301
Epoch: 8, Steps: 64 | Train Loss: 0.2217538 Vali Loss: 0.4262837 Test Loss: 0.6179270
Validation loss decreased (0.503017 --> 0.426284).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 9 cost time: 0.8396086692810059
Epoch: 9, Steps: 64 | Train Loss: 0.1996210 Vali Loss: 0.3746118 Test Loss: 0.5336515
Validation loss decreased (0.426284 --> 0.374612).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 10 cost time: 0.8443906307220459
Epoch: 10, Steps: 64 | Train Loss: 0.1837419 Vali Loss: 0.3347421 Test Loss: 0.4722315
Validation loss decreased (0.374612 --> 0.334742).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 11 cost time: 0.859184741973877
Epoch: 11, Steps: 64 | Train Loss: 0.1723567 Vali Loss: 0.3024720 Test Loss: 0.4193625
Validation loss decreased (0.334742 --> 0.302472).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 12 cost time: 0.8483505249023438
Epoch: 12, Steps: 64 | Train Loss: 0.1630687 Vali Loss: 0.2794974 Test Loss: 0.3852687
Validation loss decreased (0.302472 --> 0.279497).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 13 cost time: 0.8489997386932373
Epoch: 13, Steps: 64 | Train Loss: 0.1576428 Vali Loss: 0.2648874 Test Loss: 0.3621207
Validation loss decreased (0.279497 --> 0.264887).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 14 cost time: 0.8486087322235107
Epoch: 14, Steps: 64 | Train Loss: 0.1529652 Vali Loss: 0.2521579 Test Loss: 0.3417479
Validation loss decreased (0.264887 --> 0.252158).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 15 cost time: 0.8574087619781494
Epoch: 15, Steps: 64 | Train Loss: 0.1487811 Vali Loss: 0.2412484 Test Loss: 0.3276900
Validation loss decreased (0.252158 --> 0.241248).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 16 cost time: 0.843402624130249
Epoch: 16, Steps: 64 | Train Loss: 0.1461150 Vali Loss: 0.2365075 Test Loss: 0.3164742
Validation loss decreased (0.241248 --> 0.236507).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 17 cost time: 0.8387365341186523
Epoch: 17, Steps: 64 | Train Loss: 0.1429749 Vali Loss: 0.2277448 Test Loss: 0.3045488
Validation loss decreased (0.236507 --> 0.227745).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 18 cost time: 0.8479995727539062
Epoch: 18, Steps: 64 | Train Loss: 0.1407760 Vali Loss: 0.2233670 Test Loss: 0.2979962
Validation loss decreased (0.227745 --> 0.223367).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 19 cost time: 0.8556206226348877
Epoch: 19, Steps: 64 | Train Loss: 0.1388157 Vali Loss: 0.2204617 Test Loss: 0.2917177
Validation loss decreased (0.223367 --> 0.220462).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 20 cost time: 0.850841760635376
Epoch: 20, Steps: 64 | Train Loss: 0.1373394 Vali Loss: 0.2172363 Test Loss: 0.2898832
Validation loss decreased (0.220462 --> 0.217236).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 21 cost time: 0.8510425090789795
Epoch: 21, Steps: 64 | Train Loss: 0.1367116 Vali Loss: 0.2120060 Test Loss: 0.2831831
Validation loss decreased (0.217236 --> 0.212006).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 22 cost time: 0.8473565578460693
Epoch: 22, Steps: 64 | Train Loss: 0.1356600 Vali Loss: 0.2098046 Test Loss: 0.2816651
Validation loss decreased (0.212006 --> 0.209805).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 23 cost time: 0.8418583869934082
Epoch: 23, Steps: 64 | Train Loss: 0.1351821 Vali Loss: 0.2103846 Test Loss: 0.2797845
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 24 cost time: 0.8278849124908447
Epoch: 24, Steps: 64 | Train Loss: 0.1345333 Vali Loss: 0.2078631 Test Loss: 0.2751210
Validation loss decreased (0.209805 --> 0.207863).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 25 cost time: 0.8527700901031494
Epoch: 25, Steps: 64 | Train Loss: 0.1338985 Vali Loss: 0.2057762 Test Loss: 0.2740439
Validation loss decreased (0.207863 --> 0.205776).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 26 cost time: 0.8533973693847656
Epoch: 26, Steps: 64 | Train Loss: 0.1329768 Vali Loss: 0.2069657 Test Loss: 0.2733334
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 27 cost time: 0.8463749885559082
Epoch: 27, Steps: 64 | Train Loss: 0.1325059 Vali Loss: 0.2030759 Test Loss: 0.2695293
Validation loss decreased (0.205776 --> 0.203076).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 28 cost time: 0.8400003910064697
Epoch: 28, Steps: 64 | Train Loss: 0.1322777 Vali Loss: 0.2038901 Test Loss: 0.2695577
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 29 cost time: 0.8506269454956055
Epoch: 29, Steps: 64 | Train Loss: 0.1311135 Vali Loss: 0.2037495 Test Loss: 0.2707731
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 30 cost time: 0.8463757038116455
Epoch: 30, Steps: 64 | Train Loss: 0.1317679 Vali Loss: 0.2009465 Test Loss: 0.2672704
Validation loss decreased (0.203076 --> 0.200946).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 31 cost time: 0.8544766902923584
Epoch: 31, Steps: 64 | Train Loss: 0.1308318 Vali Loss: 0.2015748 Test Loss: 0.2675685
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 32 cost time: 0.8517224788665771
Epoch: 32, Steps: 64 | Train Loss: 0.1302004 Vali Loss: 0.2000809 Test Loss: 0.2666649
Validation loss decreased (0.200946 --> 0.200081).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 33 cost time: 0.8429975509643555
Epoch: 33, Steps: 64 | Train Loss: 0.1306988 Vali Loss: 0.1991562 Test Loss: 0.2668043
Validation loss decreased (0.200081 --> 0.199156).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 34 cost time: 0.8452856540679932
Epoch: 34, Steps: 64 | Train Loss: 0.1307749 Vali Loss: 0.2009650 Test Loss: 0.2657470
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 35 cost time: 0.8513972759246826
Epoch: 35, Steps: 64 | Train Loss: 0.1298246 Vali Loss: 0.1993055 Test Loss: 0.2662837
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 36 cost time: 0.8543481826782227
Epoch: 36, Steps: 64 | Train Loss: 0.1303268 Vali Loss: 0.1987929 Test Loss: 0.2640733
Validation loss decreased (0.199156 --> 0.198793).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 37 cost time: 0.8538281917572021
Epoch: 37, Steps: 64 | Train Loss: 0.1290012 Vali Loss: 0.1995110 Test Loss: 0.2647236
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 38 cost time: 0.8540008068084717
Epoch: 38, Steps: 64 | Train Loss: 0.1294804 Vali Loss: 0.1979443 Test Loss: 0.2645463
Validation loss decreased (0.198793 --> 0.197944).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 39 cost time: 0.8609483242034912
Epoch: 39, Steps: 64 | Train Loss: 0.1295465 Vali Loss: 0.1972724 Test Loss: 0.2635785
Validation loss decreased (0.197944 --> 0.197272).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 40 cost time: 0.8593235015869141
Epoch: 40, Steps: 64 | Train Loss: 0.1286872 Vali Loss: 0.1973378 Test Loss: 0.2637564
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 41 cost time: 0.8802309036254883
Epoch: 41, Steps: 64 | Train Loss: 0.1289197 Vali Loss: 0.1973675 Test Loss: 0.2619783
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 42 cost time: 0.8604176044464111
Epoch: 42, Steps: 64 | Train Loss: 0.1290657 Vali Loss: 0.1975934 Test Loss: 0.2629145
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 43 cost time: 0.855757474899292
Epoch: 43, Steps: 64 | Train Loss: 0.1295261 Vali Loss: 0.1980510 Test Loss: 0.2626016
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 44 cost time: 0.8539977073669434
Epoch: 44, Steps: 64 | Train Loss: 0.1289337 Vali Loss: 0.1984016 Test Loss: 0.2624900
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 45 cost time: 0.8653323650360107
Epoch: 45, Steps: 64 | Train Loss: 0.1289909 Vali Loss: 0.1979689 Test Loss: 0.2615812
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 46 cost time: 0.8544044494628906
Epoch: 46, Steps: 64 | Train Loss: 0.1292169 Vali Loss: 0.1974975 Test Loss: 0.2629012
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 47 cost time: 0.8507370948791504
Epoch: 47, Steps: 64 | Train Loss: 0.1286169 Vali Loss: 0.1952955 Test Loss: 0.2607202
Validation loss decreased (0.197272 --> 0.195295).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 48 cost time: 0.8597314357757568
Epoch: 48, Steps: 64 | Train Loss: 0.1284946 Vali Loss: 0.1940825 Test Loss: 0.2606396
Validation loss decreased (0.195295 --> 0.194082).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 49 cost time: 0.8416337966918945
Epoch: 49, Steps: 64 | Train Loss: 0.1288570 Vali Loss: 0.1966930 Test Loss: 0.2616829
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 50 cost time: 0.8493587970733643
Epoch: 50, Steps: 64 | Train Loss: 0.1290390 Vali Loss: 0.1971176 Test Loss: 0.2610221
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 51 cost time: 0.8494253158569336
Epoch: 51, Steps: 64 | Train Loss: 0.1282009 Vali Loss: 0.1960608 Test Loss: 0.2606367
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 52 cost time: 0.8493900299072266
Epoch: 52, Steps: 64 | Train Loss: 0.1284596 Vali Loss: 0.1967909 Test Loss: 0.2594410
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 53 cost time: 0.8405518531799316
Epoch: 53, Steps: 64 | Train Loss: 0.1289376 Vali Loss: 0.1969735 Test Loss: 0.2625121
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 54 cost time: 0.8420000076293945
Epoch: 54, Steps: 64 | Train Loss: 0.1289917 Vali Loss: 0.1963423 Test Loss: 0.2619382
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 55 cost time: 0.8424136638641357
Epoch: 55, Steps: 64 | Train Loss: 0.1285313 Vali Loss: 0.1972351 Test Loss: 0.2629716
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 56 cost time: 0.8514184951782227
Epoch: 56, Steps: 64 | Train Loss: 0.1291788 Vali Loss: 0.1965815 Test Loss: 0.2601756
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 57 cost time: 0.8498935699462891
Epoch: 57, Steps: 64 | Train Loss: 0.1291978 Vali Loss: 0.1980897 Test Loss: 0.2618747
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 58 cost time: 0.8543999195098877
Epoch: 58, Steps: 64 | Train Loss: 0.1288170 Vali Loss: 0.1944940 Test Loss: 0.2607686
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 59 cost time: 0.8556249141693115
Epoch: 59, Steps: 64 | Train Loss: 0.1281426 Vali Loss: 0.1946612 Test Loss: 0.2600407
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 60 cost time: 0.863379955291748
Epoch: 60, Steps: 64 | Train Loss: 0.1278560 Vali Loss: 0.1973450 Test Loss: 0.2609750
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.26063963770866394, mae:0.38504064083099365, rse:0.2587345242500305
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.060153961181640625 GB
Epoch: 1 cost time: 2.2400331497192383
Epoch: 1, Steps: 64 | Train Loss: 0.8491179 Vali Loss: 2.2558274 Test Loss: 3.6050618
Validation loss decreased (inf --> 2.255827).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 2 cost time: 0.8863871097564697
Epoch: 2, Steps: 64 | Train Loss: 0.5347846 Vali Loss: 0.5406477 Test Loss: 0.8144935
Validation loss decreased (2.255827 --> 0.540648).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 3 cost time: 0.8913538455963135
Epoch: 3, Steps: 64 | Train Loss: 0.1826479 Vali Loss: 0.1951061 Test Loss: 0.2361314
Validation loss decreased (0.540648 --> 0.195106).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 4 cost time: 0.858088493347168
Epoch: 4, Steps: 64 | Train Loss: 0.1442149 Vali Loss: 0.1949290 Test Loss: 0.2437436
Validation loss decreased (0.195106 --> 0.194929).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 5 cost time: 0.8856320381164551
Epoch: 5, Steps: 64 | Train Loss: 0.1384565 Vali Loss: 0.1878566 Test Loss: 0.2408280
Validation loss decreased (0.194929 --> 0.187857).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 6 cost time: 0.8813629150390625
Epoch: 6, Steps: 64 | Train Loss: 0.1338916 Vali Loss: 0.1872170 Test Loss: 0.2413599
Validation loss decreased (0.187857 --> 0.187217).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 7 cost time: 0.8793692588806152
Epoch: 7, Steps: 64 | Train Loss: 0.1297997 Vali Loss: 0.1912640 Test Loss: 0.2409150
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 8 cost time: 0.8820061683654785
Epoch: 8, Steps: 64 | Train Loss: 0.1271202 Vali Loss: 0.1832084 Test Loss: 0.2384483
Validation loss decreased (0.187217 --> 0.183208).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 9 cost time: 0.8797402381896973
Epoch: 9, Steps: 64 | Train Loss: 0.1254601 Vali Loss: 0.1820086 Test Loss: 0.2402698
Validation loss decreased (0.183208 --> 0.182009).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 10 cost time: 0.8849995136260986
Epoch: 10, Steps: 64 | Train Loss: 0.1233570 Vali Loss: 0.1825362 Test Loss: 0.2410647
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 11 cost time: 0.8786094188690186
Epoch: 11, Steps: 64 | Train Loss: 0.1217281 Vali Loss: 0.1835298 Test Loss: 0.2433846
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 12 cost time: 0.8839671611785889
Epoch: 12, Steps: 64 | Train Loss: 0.1208037 Vali Loss: 0.1838555 Test Loss: 0.2439520
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 13 cost time: 0.8863685131072998
Epoch: 13, Steps: 64 | Train Loss: 0.1202278 Vali Loss: 0.1837439 Test Loss: 0.2457485
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 14 cost time: 0.89835524559021
Epoch: 14, Steps: 64 | Train Loss: 0.1188172 Vali Loss: 0.1833050 Test Loss: 0.2477253
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 15 cost time: 0.8787603378295898
Epoch: 15, Steps: 64 | Train Loss: 0.1180280 Vali Loss: 0.1830198 Test Loss: 0.2468660
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 16 cost time: 0.8817307949066162
Epoch: 16, Steps: 64 | Train Loss: 0.1170161 Vali Loss: 0.1826093 Test Loss: 0.2480118
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 17 cost time: 0.8806207180023193
Epoch: 17, Steps: 64 | Train Loss: 0.1174133 Vali Loss: 0.1852766 Test Loss: 0.2509973
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 18 cost time: 0.8973381519317627
Epoch: 18, Steps: 64 | Train Loss: 0.1166101 Vali Loss: 0.1828496 Test Loss: 0.2517019
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 19 cost time: 0.8873372077941895
Epoch: 19, Steps: 64 | Train Loss: 0.1152816 Vali Loss: 0.1840216 Test Loss: 0.2515139
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 20 cost time: 0.888491153717041
Epoch: 20, Steps: 64 | Train Loss: 0.1148211 Vali Loss: 0.1841638 Test Loss: 0.2513133
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 21 cost time: 0.8881576061248779
Epoch: 21, Steps: 64 | Train Loss: 0.1145917 Vali Loss: 0.1847940 Test Loss: 0.2521166
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 22 cost time: 0.8932688236236572
Epoch: 22, Steps: 64 | Train Loss: 0.1145981 Vali Loss: 0.1854294 Test Loss: 0.2534174
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 23 cost time: 0.8866133689880371
Epoch: 23, Steps: 64 | Train Loss: 0.1144698 Vali Loss: 0.1844064 Test Loss: 0.2534820
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 24 cost time: 0.8617844581604004
Epoch: 24, Steps: 64 | Train Loss: 0.1134080 Vali Loss: 0.1848717 Test Loss: 0.2554254
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 25 cost time: 0.8723325729370117
Epoch: 25, Steps: 64 | Train Loss: 0.1137286 Vali Loss: 0.1836632 Test Loss: 0.2545002
EarlyStopping counter: 16 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 26 cost time: 0.882072925567627
Epoch: 26, Steps: 64 | Train Loss: 0.1130985 Vali Loss: 0.1866768 Test Loss: 0.2558712
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 27 cost time: 0.877000093460083
Epoch: 27, Steps: 64 | Train Loss: 0.1138814 Vali Loss: 0.1855768 Test Loss: 0.2559750
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 28 cost time: 0.8849997520446777
Epoch: 28, Steps: 64 | Train Loss: 0.1132337 Vali Loss: 0.1858995 Test Loss: 0.2576811
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 29 cost time: 0.8757612705230713
Epoch: 29, Steps: 64 | Train Loss: 0.1126745 Vali Loss: 0.1863641 Test Loss: 0.2557614
EarlyStopping counter: 20 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 30 cost time: 0.8833527565002441
Epoch: 30, Steps: 64 | Train Loss: 0.1124335 Vali Loss: 0.1845939 Test Loss: 0.2574783
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 31 cost time: 0.8904619216918945
Epoch: 31, Steps: 64 | Train Loss: 0.1125423 Vali Loss: 0.1861265 Test Loss: 0.2578457
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 32 cost time: 0.8905684947967529
Epoch: 32, Steps: 64 | Train Loss: 0.1120954 Vali Loss: 0.1871845 Test Loss: 0.2571830
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 33 cost time: 0.880000114440918
Epoch: 33, Steps: 64 | Train Loss: 0.1127532 Vali Loss: 0.1852812 Test Loss: 0.2580676
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 34 cost time: 0.884589433670044
Epoch: 34, Steps: 64 | Train Loss: 0.1123591 Vali Loss: 0.1849758 Test Loss: 0.2584989
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 35 cost time: 0.8823697566986084
Epoch: 35, Steps: 64 | Train Loss: 0.1119549 Vali Loss: 0.1855903 Test Loss: 0.2594671
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 36 cost time: 0.8914220333099365
Epoch: 36, Steps: 64 | Train Loss: 0.1122459 Vali Loss: 0.1857695 Test Loss: 0.2595007
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 37 cost time: 0.8883841037750244
Epoch: 37, Steps: 64 | Train Loss: 0.1115088 Vali Loss: 0.1849037 Test Loss: 0.2584971
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 38 cost time: 0.8877434730529785
Epoch: 38, Steps: 64 | Train Loss: 0.1120257 Vali Loss: 0.1859236 Test Loss: 0.2594216
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 39 cost time: 0.8866217136383057
Epoch: 39, Steps: 64 | Train Loss: 0.1120565 Vali Loss: 0.1840704 Test Loss: 0.2588487
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 40 cost time: 0.8879995346069336
Epoch: 40, Steps: 64 | Train Loss: 0.1115609 Vali Loss: 0.1860200 Test Loss: 0.2597846
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 41 cost time: 0.8846230506896973
Epoch: 41, Steps: 64 | Train Loss: 0.1114558 Vali Loss: 0.1861629 Test Loss: 0.2598678
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 42 cost time: 0.8784065246582031
Epoch: 42, Steps: 64 | Train Loss: 0.1115687 Vali Loss: 0.1865643 Test Loss: 0.2602902
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 43 cost time: 0.8934085369110107
Epoch: 43, Steps: 64 | Train Loss: 0.1116451 Vali Loss: 0.1826183 Test Loss: 0.2596331
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 44 cost time: 0.9058587551116943
Epoch: 44, Steps: 64 | Train Loss: 0.1118678 Vali Loss: 0.1844521 Test Loss: 0.2587110
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 45 cost time: 0.8799998760223389
Epoch: 45, Steps: 64 | Train Loss: 0.1118805 Vali Loss: 0.1864682 Test Loss: 0.2595105
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 46 cost time: 0.8850002288818359
Epoch: 46, Steps: 64 | Train Loss: 0.1112572 Vali Loss: 0.1860636 Test Loss: 0.2592402
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 47 cost time: 0.8706169128417969
Epoch: 47, Steps: 64 | Train Loss: 0.1115212 Vali Loss: 0.1861075 Test Loss: 0.2598999
EarlyStopping counter: 38 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 48 cost time: 0.8834681510925293
Epoch: 48, Steps: 64 | Train Loss: 0.1116506 Vali Loss: 0.1852076 Test Loss: 0.2595771
EarlyStopping counter: 39 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 49 cost time: 0.882319450378418
Epoch: 49, Steps: 64 | Train Loss: 0.1119067 Vali Loss: 0.1851012 Test Loss: 0.2589468
EarlyStopping counter: 40 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 50 cost time: 0.8964521884918213
Epoch: 50, Steps: 64 | Train Loss: 0.1110997 Vali Loss: 0.1864248 Test Loss: 0.2601058
EarlyStopping counter: 41 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 51 cost time: 0.877000093460083
Epoch: 51, Steps: 64 | Train Loss: 0.1111271 Vali Loss: 0.1861800 Test Loss: 0.2594469
EarlyStopping counter: 42 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 52 cost time: 0.8814542293548584
Epoch: 52, Steps: 64 | Train Loss: 0.1117722 Vali Loss: 0.1868390 Test Loss: 0.2592120
EarlyStopping counter: 43 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 53 cost time: 0.8816218376159668
Epoch: 53, Steps: 64 | Train Loss: 0.1115645 Vali Loss: 0.1877321 Test Loss: 0.2605612
EarlyStopping counter: 44 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 54 cost time: 0.8813943862915039
Epoch: 54, Steps: 64 | Train Loss: 0.1111461 Vali Loss: 0.1867402 Test Loss: 0.2599880
EarlyStopping counter: 45 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 55 cost time: 0.8863427639007568
Epoch: 55, Steps: 64 | Train Loss: 0.1112942 Vali Loss: 0.1854638 Test Loss: 0.2603348
EarlyStopping counter: 46 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 56 cost time: 0.8958437442779541
Epoch: 56, Steps: 64 | Train Loss: 0.1113495 Vali Loss: 0.1860385 Test Loss: 0.2597612
EarlyStopping counter: 47 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 57 cost time: 0.892669677734375
Epoch: 57, Steps: 64 | Train Loss: 0.1114466 Vali Loss: 0.1862325 Test Loss: 0.2610329
EarlyStopping counter: 48 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 58 cost time: 0.8900015354156494
Epoch: 58, Steps: 64 | Train Loss: 0.1112214 Vali Loss: 0.1867911 Test Loss: 0.2608303
EarlyStopping counter: 49 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 59 cost time: 0.8843543529510498
Epoch: 59, Steps: 64 | Train Loss: 0.1112868 Vali Loss: 0.1885414 Test Loss: 0.2608286
EarlyStopping counter: 50 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 60 cost time: 0.8844168186187744
Epoch: 60, Steps: 64 | Train Loss: 0.1112612 Vali Loss: 0.1861051 Test Loss: 0.2607326
EarlyStopping counter: 51 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2402697503566742, mae:0.3606223165988922, rse:0.24841836094856262
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06334877014160156 GB
Epoch: 1 cost time: 2.2660422325134277
Epoch: 1, Steps: 64 | Train Loss: 0.8582123 Vali Loss: 2.3225296 Test Loss: 3.7005568
Validation loss decreased (inf --> 2.322530).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 2 cost time: 0.9138846397399902
Epoch: 2, Steps: 64 | Train Loss: 0.4635379 Vali Loss: 0.2000740 Test Loss: 0.2485663
Validation loss decreased (2.322530 --> 0.200074).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 3 cost time: 0.9117708206176758
Epoch: 3, Steps: 64 | Train Loss: 0.1576792 Vali Loss: 0.2130511 Test Loss: 0.2669048
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 4 cost time: 0.9109997749328613
Epoch: 4, Steps: 64 | Train Loss: 0.1396052 Vali Loss: 0.1946245 Test Loss: 0.2375221
Validation loss decreased (0.200074 --> 0.194624).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 5 cost time: 0.8856191635131836
Epoch: 5, Steps: 64 | Train Loss: 0.1337179 Vali Loss: 0.1838159 Test Loss: 0.2353246
Validation loss decreased (0.194624 --> 0.183816).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 6 cost time: 0.9268405437469482
Epoch: 6, Steps: 64 | Train Loss: 0.1290681 Vali Loss: 0.1835772 Test Loss: 0.2359530
Validation loss decreased (0.183816 --> 0.183577).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 7 cost time: 0.9090924263000488
Epoch: 7, Steps: 64 | Train Loss: 0.1265599 Vali Loss: 0.1832099 Test Loss: 0.2408142
Validation loss decreased (0.183577 --> 0.183210).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 8 cost time: 0.9141445159912109
Epoch: 8, Steps: 64 | Train Loss: 0.1241010 Vali Loss: 0.1845906 Test Loss: 0.2398108
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 9 cost time: 0.9106988906860352
Epoch: 9, Steps: 64 | Train Loss: 0.1219173 Vali Loss: 0.1844597 Test Loss: 0.2408444
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 10 cost time: 0.9187510013580322
Epoch: 10, Steps: 64 | Train Loss: 0.1207117 Vali Loss: 0.1810307 Test Loss: 0.2430726
Validation loss decreased (0.183210 --> 0.181031).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 11 cost time: 0.9106206893920898
Epoch: 11, Steps: 64 | Train Loss: 0.1194390 Vali Loss: 0.1835384 Test Loss: 0.2433522
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 12 cost time: 0.9120011329650879
Epoch: 12, Steps: 64 | Train Loss: 0.1183552 Vali Loss: 0.1820787 Test Loss: 0.2455167
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 13 cost time: 0.907630205154419
Epoch: 13, Steps: 64 | Train Loss: 0.1174202 Vali Loss: 0.1820039 Test Loss: 0.2471307
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 14 cost time: 0.9084482192993164
Epoch: 14, Steps: 64 | Train Loss: 0.1160666 Vali Loss: 0.1803211 Test Loss: 0.2474167
Validation loss decreased (0.181031 --> 0.180321).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 15 cost time: 0.9180240631103516
Epoch: 15, Steps: 64 | Train Loss: 0.1152647 Vali Loss: 0.1837193 Test Loss: 0.2488992
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 16 cost time: 0.9123399257659912
Epoch: 16, Steps: 64 | Train Loss: 0.1144893 Vali Loss: 0.1800714 Test Loss: 0.2498062
Validation loss decreased (0.180321 --> 0.180071).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 17 cost time: 0.9057292938232422
Epoch: 17, Steps: 64 | Train Loss: 0.1137317 Vali Loss: 0.1829086 Test Loss: 0.2516786
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 18 cost time: 0.9080004692077637
Epoch: 18, Steps: 64 | Train Loss: 0.1139074 Vali Loss: 0.1830955 Test Loss: 0.2542431
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 19 cost time: 0.9091172218322754
Epoch: 19, Steps: 64 | Train Loss: 0.1130034 Vali Loss: 0.1825659 Test Loss: 0.2531494
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 20 cost time: 0.9106214046478271
Epoch: 20, Steps: 64 | Train Loss: 0.1131472 Vali Loss: 0.1839141 Test Loss: 0.2553655
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 21 cost time: 0.9163627624511719
Epoch: 21, Steps: 64 | Train Loss: 0.1126468 Vali Loss: 0.1807321 Test Loss: 0.2543571
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 22 cost time: 0.9083707332611084
Epoch: 22, Steps: 64 | Train Loss: 0.1119903 Vali Loss: 0.1808284 Test Loss: 0.2564577
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 23 cost time: 0.8983335494995117
Epoch: 23, Steps: 64 | Train Loss: 0.1118339 Vali Loss: 0.1822776 Test Loss: 0.2563105
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 24 cost time: 0.9077558517456055
Epoch: 24, Steps: 64 | Train Loss: 0.1114915 Vali Loss: 0.1830074 Test Loss: 0.2568220
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 25 cost time: 0.9040002822875977
Epoch: 25, Steps: 64 | Train Loss: 0.1108679 Vali Loss: 0.1818811 Test Loss: 0.2570682
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 26 cost time: 0.8996281623840332
Epoch: 26, Steps: 64 | Train Loss: 0.1110427 Vali Loss: 0.1821122 Test Loss: 0.2559776
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 27 cost time: 0.9102015495300293
Epoch: 27, Steps: 64 | Train Loss: 0.1107374 Vali Loss: 0.1824360 Test Loss: 0.2570504
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 28 cost time: 0.9139847755432129
Epoch: 28, Steps: 64 | Train Loss: 0.1110231 Vali Loss: 0.1818917 Test Loss: 0.2568765
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 29 cost time: 0.9143431186676025
Epoch: 29, Steps: 64 | Train Loss: 0.1103571 Vali Loss: 0.1816795 Test Loss: 0.2580212
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 30 cost time: 0.9093461036682129
Epoch: 30, Steps: 64 | Train Loss: 0.1105651 Vali Loss: 0.1830197 Test Loss: 0.2598772
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 31 cost time: 0.9078569412231445
Epoch: 31, Steps: 64 | Train Loss: 0.1104139 Vali Loss: 0.1837454 Test Loss: 0.2580860
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 32 cost time: 0.9038019180297852
Epoch: 32, Steps: 64 | Train Loss: 0.1097739 Vali Loss: 0.1836061 Test Loss: 0.2585033
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 33 cost time: 0.9066126346588135
Epoch: 33, Steps: 64 | Train Loss: 0.1102918 Vali Loss: 0.1846728 Test Loss: 0.2594371
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 34 cost time: 0.9043762683868408
Epoch: 34, Steps: 64 | Train Loss: 0.1098723 Vali Loss: 0.1854414 Test Loss: 0.2593501
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 35 cost time: 0.9063489437103271
Epoch: 35, Steps: 64 | Train Loss: 0.1096687 Vali Loss: 0.1819143 Test Loss: 0.2604400
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 36 cost time: 0.9253556728363037
Epoch: 36, Steps: 64 | Train Loss: 0.1095994 Vali Loss: 0.1846654 Test Loss: 0.2593065
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 37 cost time: 0.9100251197814941
Epoch: 37, Steps: 64 | Train Loss: 0.1094793 Vali Loss: 0.1821139 Test Loss: 0.2596470
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 38 cost time: 0.9137494564056396
Epoch: 38, Steps: 64 | Train Loss: 0.1094205 Vali Loss: 0.1833963 Test Loss: 0.2603003
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 39 cost time: 0.9079999923706055
Epoch: 39, Steps: 64 | Train Loss: 0.1092781 Vali Loss: 0.1823093 Test Loss: 0.2602482
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 40 cost time: 0.906623363494873
Epoch: 40, Steps: 64 | Train Loss: 0.1095695 Vali Loss: 0.1834763 Test Loss: 0.2606487
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 41 cost time: 0.9059946537017822
Epoch: 41, Steps: 64 | Train Loss: 0.1092239 Vali Loss: 0.1842639 Test Loss: 0.2606426
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 42 cost time: 0.9064750671386719
Epoch: 42, Steps: 64 | Train Loss: 0.1101176 Vali Loss: 0.1845371 Test Loss: 0.2595499
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 43 cost time: 0.9068558216094971
Epoch: 43, Steps: 64 | Train Loss: 0.1090158 Vali Loss: 0.1849497 Test Loss: 0.2599109
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 44 cost time: 0.9083878993988037
Epoch: 44, Steps: 64 | Train Loss: 0.1097280 Vali Loss: 0.1838020 Test Loss: 0.2596818
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 45 cost time: 0.9117996692657471
Epoch: 45, Steps: 64 | Train Loss: 0.1095377 Vali Loss: 0.1832862 Test Loss: 0.2603350
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 46 cost time: 0.9089996814727783
Epoch: 46, Steps: 64 | Train Loss: 0.1096035 Vali Loss: 0.1840622 Test Loss: 0.2612199
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 47 cost time: 0.8901138305664062
Epoch: 47, Steps: 64 | Train Loss: 0.1097328 Vali Loss: 0.1823907 Test Loss: 0.2600993
EarlyStopping counter: 31 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 48 cost time: 0.9103503227233887
Epoch: 48, Steps: 64 | Train Loss: 0.1090259 Vali Loss: 0.1846444 Test Loss: 0.2614374
EarlyStopping counter: 32 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 49 cost time: 0.9073426723480225
Epoch: 49, Steps: 64 | Train Loss: 0.1091926 Vali Loss: 0.1842411 Test Loss: 0.2602148
EarlyStopping counter: 33 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 50 cost time: 0.9072022438049316
Epoch: 50, Steps: 64 | Train Loss: 0.1088884 Vali Loss: 0.1835843 Test Loss: 0.2610365
EarlyStopping counter: 34 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 51 cost time: 0.9033565521240234
Epoch: 51, Steps: 64 | Train Loss: 0.1089990 Vali Loss: 0.1838420 Test Loss: 0.2604392
EarlyStopping counter: 35 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 52 cost time: 0.9067721366882324
Epoch: 52, Steps: 64 | Train Loss: 0.1089320 Vali Loss: 0.1838230 Test Loss: 0.2609636
EarlyStopping counter: 36 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 53 cost time: 0.9069981575012207
Epoch: 53, Steps: 64 | Train Loss: 0.1094061 Vali Loss: 0.1837876 Test Loss: 0.2604025
EarlyStopping counter: 37 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 54 cost time: 0.9039549827575684
Epoch: 54, Steps: 64 | Train Loss: 0.1090253 Vali Loss: 0.1819414 Test Loss: 0.2609436
EarlyStopping counter: 38 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 55 cost time: 0.9084234237670898
Epoch: 55, Steps: 64 | Train Loss: 0.1089651 Vali Loss: 0.1835392 Test Loss: 0.2610493
EarlyStopping counter: 39 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 56 cost time: 0.9063727855682373
Epoch: 56, Steps: 64 | Train Loss: 0.1089656 Vali Loss: 0.1827603 Test Loss: 0.2601927
EarlyStopping counter: 40 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 57 cost time: 0.9193911552429199
Epoch: 57, Steps: 64 | Train Loss: 0.1092026 Vali Loss: 0.1836805 Test Loss: 0.2605418
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 58 cost time: 0.9194681644439697
Epoch: 58, Steps: 64 | Train Loss: 0.1090477 Vali Loss: 0.1843480 Test Loss: 0.2608822
EarlyStopping counter: 42 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 59 cost time: 0.9097721576690674
Epoch: 59, Steps: 64 | Train Loss: 0.1093021 Vali Loss: 0.1841050 Test Loss: 0.2614333
EarlyStopping counter: 43 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 60 cost time: 0.9070000648498535
Epoch: 60, Steps: 64 | Train Loss: 0.1092677 Vali Loss: 0.1849615 Test Loss: 0.2603739
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.24980616569519043, mae:0.3742885887622833, rse:0.2533003091812134
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05716896057128906 GB
Epoch: 1 cost time: 2.1524698734283447
Epoch: 1, Steps: 64 | Train Loss: 1.0931006 Vali Loss: 2.8588295 Test Loss: 4.5604916
Validation loss decreased (inf --> 2.858829).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 2 cost time: 0.8054051399230957
Epoch: 2, Steps: 64 | Train Loss: 0.9474696 Vali Loss: 2.1755800 Test Loss: 3.4508224
Validation loss decreased (2.858829 --> 2.175580).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 3 cost time: 0.807358980178833
Epoch: 3, Steps: 64 | Train Loss: 0.7469632 Vali Loss: 1.6648562 Test Loss: 2.6181729
Validation loss decreased (2.175580 --> 1.664856).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 4 cost time: 0.8026161193847656
Epoch: 4, Steps: 64 | Train Loss: 0.5805628 Vali Loss: 1.2608286 Test Loss: 1.9538078
Validation loss decreased (1.664856 --> 1.260829).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 5 cost time: 0.8046178817749023
Epoch: 5, Steps: 64 | Train Loss: 0.4604351 Vali Loss: 1.0033408 Test Loss: 1.5518999
Validation loss decreased (1.260829 --> 1.003341).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 6 cost time: 0.8043856620788574
Epoch: 6, Steps: 64 | Train Loss: 0.3782785 Vali Loss: 0.8147353 Test Loss: 1.2468191
Validation loss decreased (1.003341 --> 0.814735).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 7 cost time: 0.8034088611602783
Epoch: 7, Steps: 64 | Train Loss: 0.3200808 Vali Loss: 0.6696698 Test Loss: 1.0190202
Validation loss decreased (0.814735 --> 0.669670).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 8 cost time: 0.8097748756408691
Epoch: 8, Steps: 64 | Train Loss: 0.2773782 Vali Loss: 0.5657189 Test Loss: 0.8555854
Validation loss decreased (0.669670 --> 0.565719).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 9 cost time: 0.7850015163421631
Epoch: 9, Steps: 64 | Train Loss: 0.2448262 Vali Loss: 0.4922776 Test Loss: 0.7341965
Validation loss decreased (0.565719 --> 0.492278).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 10 cost time: 0.8034565448760986
Epoch: 10, Steps: 64 | Train Loss: 0.2225270 Vali Loss: 0.4347766 Test Loss: 0.6439136
Validation loss decreased (0.492278 --> 0.434777).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 11 cost time: 0.8083741664886475
Epoch: 11, Steps: 64 | Train Loss: 0.2038168 Vali Loss: 0.3872028 Test Loss: 0.5683908
Validation loss decreased (0.434777 --> 0.387203).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 12 cost time: 0.8149261474609375
Epoch: 12, Steps: 64 | Train Loss: 0.1900919 Vali Loss: 0.3548607 Test Loss: 0.5150132
Validation loss decreased (0.387203 --> 0.354861).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 13 cost time: 0.8063998222351074
Epoch: 13, Steps: 64 | Train Loss: 0.1801328 Vali Loss: 0.3287183 Test Loss: 0.4712565
Validation loss decreased (0.354861 --> 0.328718).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 14 cost time: 0.8116259574890137
Epoch: 14, Steps: 64 | Train Loss: 0.1719752 Vali Loss: 0.3083616 Test Loss: 0.4371980
Validation loss decreased (0.328718 --> 0.308362).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 15 cost time: 0.8043229579925537
Epoch: 15, Steps: 64 | Train Loss: 0.1651847 Vali Loss: 0.2923748 Test Loss: 0.4145488
Validation loss decreased (0.308362 --> 0.292375).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 16 cost time: 0.8185145854949951
Epoch: 16, Steps: 64 | Train Loss: 0.1599553 Vali Loss: 0.2788031 Test Loss: 0.3941478
Validation loss decreased (0.292375 --> 0.278803).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 17 cost time: 0.8050000667572021
Epoch: 17, Steps: 64 | Train Loss: 0.1552562 Vali Loss: 0.2661711 Test Loss: 0.3716515
Validation loss decreased (0.278803 --> 0.266171).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 18 cost time: 0.8060286045074463
Epoch: 18, Steps: 64 | Train Loss: 0.1518892 Vali Loss: 0.2573319 Test Loss: 0.3607595
Validation loss decreased (0.266171 --> 0.257332).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 19 cost time: 0.8073246479034424
Epoch: 19, Steps: 64 | Train Loss: 0.1492735 Vali Loss: 0.2503193 Test Loss: 0.3479978
Validation loss decreased (0.257332 --> 0.250319).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 20 cost time: 0.8105993270874023
Epoch: 20, Steps: 64 | Train Loss: 0.1466956 Vali Loss: 0.2435151 Test Loss: 0.3383754
Validation loss decreased (0.250319 --> 0.243515).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 21 cost time: 0.8040001392364502
Epoch: 21, Steps: 64 | Train Loss: 0.1445266 Vali Loss: 0.2347220 Test Loss: 0.3245554
Validation loss decreased (0.243515 --> 0.234722).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 22 cost time: 0.8036186695098877
Epoch: 22, Steps: 64 | Train Loss: 0.1419012 Vali Loss: 0.2339197 Test Loss: 0.3207575
Validation loss decreased (0.234722 --> 0.233920).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 23 cost time: 0.8043351173400879
Epoch: 23, Steps: 64 | Train Loss: 0.1403858 Vali Loss: 0.2286568 Test Loss: 0.3133367
Validation loss decreased (0.233920 --> 0.228657).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 24 cost time: 0.8233816623687744
Epoch: 24, Steps: 64 | Train Loss: 0.1402188 Vali Loss: 0.2249759 Test Loss: 0.3078865
Validation loss decreased (0.228657 --> 0.224976).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 25 cost time: 0.8051023483276367
Epoch: 25, Steps: 64 | Train Loss: 0.1384187 Vali Loss: 0.2232552 Test Loss: 0.3038636
Validation loss decreased (0.224976 --> 0.223255).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 26 cost time: 0.8030002117156982
Epoch: 26, Steps: 64 | Train Loss: 0.1377777 Vali Loss: 0.2190500 Test Loss: 0.3001494
Validation loss decreased (0.223255 --> 0.219050).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 27 cost time: 0.8033738136291504
Epoch: 27, Steps: 64 | Train Loss: 0.1366045 Vali Loss: 0.2179174 Test Loss: 0.2962871
Validation loss decreased (0.219050 --> 0.217917).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 28 cost time: 0.7921032905578613
Epoch: 28, Steps: 64 | Train Loss: 0.1360369 Vali Loss: 0.2154709 Test Loss: 0.2953710
Validation loss decreased (0.217917 --> 0.215471).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 29 cost time: 0.8038139343261719
Epoch: 29, Steps: 64 | Train Loss: 0.1348895 Vali Loss: 0.2130342 Test Loss: 0.2900048
Validation loss decreased (0.215471 --> 0.213034).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 30 cost time: 0.7990002632141113
Epoch: 30, Steps: 64 | Train Loss: 0.1349535 Vali Loss: 0.2123945 Test Loss: 0.2899874
Validation loss decreased (0.213034 --> 0.212394).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 31 cost time: 0.802626371383667
Epoch: 31, Steps: 64 | Train Loss: 0.1340674 Vali Loss: 0.2095369 Test Loss: 0.2864054
Validation loss decreased (0.212394 --> 0.209537).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 32 cost time: 0.8021142482757568
Epoch: 32, Steps: 64 | Train Loss: 0.1335036 Vali Loss: 0.2096114 Test Loss: 0.2844064
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 33 cost time: 0.7977523803710938
Epoch: 33, Steps: 64 | Train Loss: 0.1328131 Vali Loss: 0.2066214 Test Loss: 0.2816514
Validation loss decreased (0.209537 --> 0.206621).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 34 cost time: 0.8030006885528564
Epoch: 34, Steps: 64 | Train Loss: 0.1327232 Vali Loss: 0.2062386 Test Loss: 0.2811897
Validation loss decreased (0.206621 --> 0.206239).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 35 cost time: 0.8016109466552734
Epoch: 35, Steps: 64 | Train Loss: 0.1324742 Vali Loss: 0.2060755 Test Loss: 0.2817135
Validation loss decreased (0.206239 --> 0.206076).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 36 cost time: 0.7965066432952881
Epoch: 36, Steps: 64 | Train Loss: 0.1317659 Vali Loss: 0.2062450 Test Loss: 0.2806284
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 37 cost time: 0.7987411022186279
Epoch: 37, Steps: 64 | Train Loss: 0.1313808 Vali Loss: 0.2029205 Test Loss: 0.2768513
Validation loss decreased (0.206076 --> 0.202921).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 38 cost time: 0.7969999313354492
Epoch: 38, Steps: 64 | Train Loss: 0.1310065 Vali Loss: 0.2041247 Test Loss: 0.2773666
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 39 cost time: 0.7936224937438965
Epoch: 39, Steps: 64 | Train Loss: 0.1310702 Vali Loss: 0.2033815 Test Loss: 0.2756494
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 40 cost time: 0.818354606628418
Epoch: 40, Steps: 64 | Train Loss: 0.1311117 Vali Loss: 0.2008951 Test Loss: 0.2738770
Validation loss decreased (0.202921 --> 0.200895).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 41 cost time: 0.8043560981750488
Epoch: 41, Steps: 64 | Train Loss: 0.1304893 Vali Loss: 0.2041382 Test Loss: 0.2749889
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 42 cost time: 0.8034489154815674
Epoch: 42, Steps: 64 | Train Loss: 0.1309326 Vali Loss: 0.2008616 Test Loss: 0.2731146
Validation loss decreased (0.200895 --> 0.200862).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 43 cost time: 0.8086299896240234
Epoch: 43, Steps: 64 | Train Loss: 0.1306333 Vali Loss: 0.2029019 Test Loss: 0.2736871
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 44 cost time: 0.8122773170471191
Epoch: 44, Steps: 64 | Train Loss: 0.1304050 Vali Loss: 0.2019064 Test Loss: 0.2726188
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 45 cost time: 0.7958576679229736
Epoch: 45, Steps: 64 | Train Loss: 0.1305146 Vali Loss: 0.2012347 Test Loss: 0.2740869
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 46 cost time: 0.7999069690704346
Epoch: 46, Steps: 64 | Train Loss: 0.1300670 Vali Loss: 0.2009515 Test Loss: 0.2728357
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 47 cost time: 0.7952563762664795
Epoch: 47, Steps: 64 | Train Loss: 0.1296432 Vali Loss: 0.2017343 Test Loss: 0.2712551
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 48 cost time: 0.8083255290985107
Epoch: 48, Steps: 64 | Train Loss: 0.1297023 Vali Loss: 0.1995143 Test Loss: 0.2684917
Validation loss decreased (0.200862 --> 0.199514).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 49 cost time: 0.7994463443756104
Epoch: 49, Steps: 64 | Train Loss: 0.1296295 Vali Loss: 0.1993179 Test Loss: 0.2696339
Validation loss decreased (0.199514 --> 0.199318).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 50 cost time: 0.8067588806152344
Epoch: 50, Steps: 64 | Train Loss: 0.1299687 Vali Loss: 0.1996543 Test Loss: 0.2709430
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 51 cost time: 0.8049986362457275
Epoch: 51, Steps: 64 | Train Loss: 0.1294472 Vali Loss: 0.1976364 Test Loss: 0.2684862
Validation loss decreased (0.199318 --> 0.197636).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 52 cost time: 0.776343584060669
Epoch: 52, Steps: 64 | Train Loss: 0.1296062 Vali Loss: 0.1992246 Test Loss: 0.2701682
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 53 cost time: 0.7984359264373779
Epoch: 53, Steps: 64 | Train Loss: 0.1298029 Vali Loss: 0.1989247 Test Loss: 0.2690291
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 54 cost time: 0.80076003074646
Epoch: 54, Steps: 64 | Train Loss: 0.1291739 Vali Loss: 0.2003891 Test Loss: 0.2692159
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 55 cost time: 0.7960000038146973
Epoch: 55, Steps: 64 | Train Loss: 0.1287677 Vali Loss: 0.1983960 Test Loss: 0.2693581
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 56 cost time: 0.7913415431976318
Epoch: 56, Steps: 64 | Train Loss: 0.1297214 Vali Loss: 0.1990673 Test Loss: 0.2702824
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 57 cost time: 0.7963635921478271
Epoch: 57, Steps: 64 | Train Loss: 0.1295497 Vali Loss: 0.1986373 Test Loss: 0.2686742
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 58 cost time: 0.791722297668457
Epoch: 58, Steps: 64 | Train Loss: 0.1297404 Vali Loss: 0.1989610 Test Loss: 0.2692164
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 59 cost time: 0.804999828338623
Epoch: 59, Steps: 64 | Train Loss: 0.1287625 Vali Loss: 0.1976448 Test Loss: 0.2683193
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 60 cost time: 0.7878744602203369
Epoch: 60, Steps: 64 | Train Loss: 0.1287116 Vali Loss: 0.1978784 Test Loss: 0.2679082
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2684861719608307, mae:0.38100993633270264, rse:0.26260024309158325
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06031513214111328 GB
Epoch: 1 cost time: 2.2311832904815674
Epoch: 1, Steps: 64 | Train Loss: 0.9303651 Vali Loss: 2.4928584 Test Loss: 3.9681361
Validation loss decreased (inf --> 2.492858).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 2 cost time: 0.833500862121582
Epoch: 2, Steps: 64 | Train Loss: 0.6201095 Vali Loss: 0.6783879 Test Loss: 1.0216608
Validation loss decreased (2.492858 --> 0.678388).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 3 cost time: 0.8474819660186768
Epoch: 3, Steps: 64 | Train Loss: 0.2002353 Vali Loss: 0.1921195 Test Loss: 0.2310571
Validation loss decreased (0.678388 --> 0.192120).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 4 cost time: 0.8319997787475586
Epoch: 4, Steps: 64 | Train Loss: 0.1394861 Vali Loss: 0.1859563 Test Loss: 0.2296042
Validation loss decreased (0.192120 --> 0.185956).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 5 cost time: 0.8304409980773926
Epoch: 5, Steps: 64 | Train Loss: 0.1330979 Vali Loss: 0.1790321 Test Loss: 0.2293882
Validation loss decreased (0.185956 --> 0.179032).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 6 cost time: 0.832409143447876
Epoch: 6, Steps: 64 | Train Loss: 0.1287899 Vali Loss: 0.1794988 Test Loss: 0.2299503
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 7 cost time: 0.8289999961853027
Epoch: 7, Steps: 64 | Train Loss: 0.1253431 Vali Loss: 0.1747530 Test Loss: 0.2270856
Validation loss decreased (0.179032 --> 0.174753).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 8 cost time: 0.8290002346038818
Epoch: 8, Steps: 64 | Train Loss: 0.1238803 Vali Loss: 0.1762577 Test Loss: 0.2289916
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 9 cost time: 0.8306252956390381
Epoch: 9, Steps: 64 | Train Loss: 0.1216725 Vali Loss: 0.1764638 Test Loss: 0.2288755
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 10 cost time: 0.8373532295227051
Epoch: 10, Steps: 64 | Train Loss: 0.1207210 Vali Loss: 0.1700810 Test Loss: 0.2295654
Validation loss decreased (0.174753 --> 0.170081).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 11 cost time: 0.8324241638183594
Epoch: 11, Steps: 64 | Train Loss: 0.1186777 Vali Loss: 0.1715525 Test Loss: 0.2301178
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 12 cost time: 0.8274013996124268
Epoch: 12, Steps: 64 | Train Loss: 0.1176158 Vali Loss: 0.1732726 Test Loss: 0.2309876
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 13 cost time: 0.8369998931884766
Epoch: 13, Steps: 64 | Train Loss: 0.1169206 Vali Loss: 0.1709167 Test Loss: 0.2304648
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 14 cost time: 0.8356256484985352
Epoch: 14, Steps: 64 | Train Loss: 0.1159496 Vali Loss: 0.1681434 Test Loss: 0.2309142
Validation loss decreased (0.170081 --> 0.168143).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 15 cost time: 0.8353776931762695
Epoch: 15, Steps: 64 | Train Loss: 0.1148816 Vali Loss: 0.1706680 Test Loss: 0.2329014
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 16 cost time: 0.8406972885131836
Epoch: 16, Steps: 64 | Train Loss: 0.1140900 Vali Loss: 0.1674916 Test Loss: 0.2351073
Validation loss decreased (0.168143 --> 0.167492).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 17 cost time: 0.8301565647125244
Epoch: 17, Steps: 64 | Train Loss: 0.1143247 Vali Loss: 0.1695999 Test Loss: 0.2356246
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 18 cost time: 0.8439991474151611
Epoch: 18, Steps: 64 | Train Loss: 0.1134204 Vali Loss: 0.1719715 Test Loss: 0.2354859
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 19 cost time: 0.8366444110870361
Epoch: 19, Steps: 64 | Train Loss: 0.1132700 Vali Loss: 0.1696146 Test Loss: 0.2352213
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 20 cost time: 0.8303530216217041
Epoch: 20, Steps: 64 | Train Loss: 0.1125666 Vali Loss: 0.1689640 Test Loss: 0.2364325
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 21 cost time: 0.8373618125915527
Epoch: 21, Steps: 64 | Train Loss: 0.1114206 Vali Loss: 0.1671324 Test Loss: 0.2364011
Validation loss decreased (0.167492 --> 0.167132).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 22 cost time: 0.8497233390808105
Epoch: 22, Steps: 64 | Train Loss: 0.1109632 Vali Loss: 0.1685011 Test Loss: 0.2376897
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 23 cost time: 0.8319997787475586
Epoch: 23, Steps: 64 | Train Loss: 0.1114666 Vali Loss: 0.1684347 Test Loss: 0.2381923
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 24 cost time: 0.83760666847229
Epoch: 24, Steps: 64 | Train Loss: 0.1112971 Vali Loss: 0.1684125 Test Loss: 0.2375949
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 25 cost time: 0.8343706130981445
Epoch: 25, Steps: 64 | Train Loss: 0.1108298 Vali Loss: 0.1697163 Test Loss: 0.2379483
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 26 cost time: 0.8300797939300537
Epoch: 26, Steps: 64 | Train Loss: 0.1102327 Vali Loss: 0.1681143 Test Loss: 0.2387205
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 27 cost time: 0.833000659942627
Epoch: 27, Steps: 64 | Train Loss: 0.1103648 Vali Loss: 0.1686109 Test Loss: 0.2385590
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 28 cost time: 0.826000452041626
Epoch: 28, Steps: 64 | Train Loss: 0.1096680 Vali Loss: 0.1669321 Test Loss: 0.2387052
Validation loss decreased (0.167132 --> 0.166932).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 29 cost time: 0.8334321975708008
Epoch: 29, Steps: 64 | Train Loss: 0.1095756 Vali Loss: 0.1689012 Test Loss: 0.2389636
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 30 cost time: 0.8163323402404785
Epoch: 30, Steps: 64 | Train Loss: 0.1097823 Vali Loss: 0.1666120 Test Loss: 0.2383626
Validation loss decreased (0.166932 --> 0.166612).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 31 cost time: 0.9100003242492676
Epoch: 31, Steps: 64 | Train Loss: 0.1098705 Vali Loss: 0.1683384 Test Loss: 0.2375671
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 32 cost time: 0.9137547016143799
Epoch: 32, Steps: 64 | Train Loss: 0.1095589 Vali Loss: 0.1680473 Test Loss: 0.2383459
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 33 cost time: 0.9030001163482666
Epoch: 33, Steps: 64 | Train Loss: 0.1087726 Vali Loss: 0.1677602 Test Loss: 0.2379261
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 34 cost time: 0.8286151885986328
Epoch: 34, Steps: 64 | Train Loss: 0.1092008 Vali Loss: 0.1675780 Test Loss: 0.2387584
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 35 cost time: 0.8320348262786865
Epoch: 35, Steps: 64 | Train Loss: 0.1090901 Vali Loss: 0.1680365 Test Loss: 0.2387746
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 36 cost time: 0.8313732147216797
Epoch: 36, Steps: 64 | Train Loss: 0.1089483 Vali Loss: 0.1679487 Test Loss: 0.2385273
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 37 cost time: 0.8368120193481445
Epoch: 37, Steps: 64 | Train Loss: 0.1085396 Vali Loss: 0.1677084 Test Loss: 0.2387390
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 38 cost time: 0.8349997997283936
Epoch: 38, Steps: 64 | Train Loss: 0.1086196 Vali Loss: 0.1676396 Test Loss: 0.2382716
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 39 cost time: 0.828620433807373
Epoch: 39, Steps: 64 | Train Loss: 0.1084862 Vali Loss: 0.1679710 Test Loss: 0.2386957
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 40 cost time: 0.82637619972229
Epoch: 40, Steps: 64 | Train Loss: 0.1088139 Vali Loss: 0.1688616 Test Loss: 0.2390153
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 41 cost time: 0.8503682613372803
Epoch: 41, Steps: 64 | Train Loss: 0.1090280 Vali Loss: 0.1659283 Test Loss: 0.2383362
Validation loss decreased (0.166612 --> 0.165928).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 42 cost time: 0.8327631950378418
Epoch: 42, Steps: 64 | Train Loss: 0.1088133 Vali Loss: 0.1668309 Test Loss: 0.2387006
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 43 cost time: 0.8329999446868896
Epoch: 43, Steps: 64 | Train Loss: 0.1083245 Vali Loss: 0.1682761 Test Loss: 0.2389221
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 44 cost time: 0.8304014205932617
Epoch: 44, Steps: 64 | Train Loss: 0.1083427 Vali Loss: 0.1682217 Test Loss: 0.2385119
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 45 cost time: 0.8433523178100586
Epoch: 45, Steps: 64 | Train Loss: 0.1078977 Vali Loss: 0.1662074 Test Loss: 0.2385276
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 46 cost time: 0.8278019428253174
Epoch: 46, Steps: 64 | Train Loss: 0.1086462 Vali Loss: 0.1657090 Test Loss: 0.2383857
Validation loss decreased (0.165928 --> 0.165709).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 47 cost time: 0.8349997997283936
Epoch: 47, Steps: 64 | Train Loss: 0.1082022 Vali Loss: 0.1676869 Test Loss: 0.2388650
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 48 cost time: 0.8450005054473877
Epoch: 48, Steps: 64 | Train Loss: 0.1082340 Vali Loss: 0.1668103 Test Loss: 0.2383223
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 49 cost time: 0.8427243232727051
Epoch: 49, Steps: 64 | Train Loss: 0.1080262 Vali Loss: 0.1681417 Test Loss: 0.2385834
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 50 cost time: 0.8293392658233643
Epoch: 50, Steps: 64 | Train Loss: 0.1083529 Vali Loss: 0.1670572 Test Loss: 0.2380267
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 51 cost time: 0.7977516651153564
Epoch: 51, Steps: 64 | Train Loss: 0.1080627 Vali Loss: 0.1659701 Test Loss: 0.2393769
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 52 cost time: 0.814000129699707
Epoch: 52, Steps: 64 | Train Loss: 0.1088087 Vali Loss: 0.1671349 Test Loss: 0.2380825
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 53 cost time: 0.8316161632537842
Epoch: 53, Steps: 64 | Train Loss: 0.1084438 Vali Loss: 0.1680739 Test Loss: 0.2387629
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 54 cost time: 0.8293654918670654
Epoch: 54, Steps: 64 | Train Loss: 0.1087178 Vali Loss: 0.1673861 Test Loss: 0.2381823
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 55 cost time: 0.8304047584533691
Epoch: 55, Steps: 64 | Train Loss: 0.1088652 Vali Loss: 0.1661397 Test Loss: 0.2379984
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 56 cost time: 0.8237359523773193
Epoch: 56, Steps: 64 | Train Loss: 0.1085756 Vali Loss: 0.1655958 Test Loss: 0.2387244
Validation loss decreased (0.165709 --> 0.165596).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 57 cost time: 0.810509204864502
Epoch: 57, Steps: 64 | Train Loss: 0.1086689 Vali Loss: 0.1677758 Test Loss: 0.2389458
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 58 cost time: 0.8334400653839111
Epoch: 58, Steps: 64 | Train Loss: 0.1080118 Vali Loss: 0.1671919 Test Loss: 0.2386642
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 59 cost time: 0.8373434543609619
Epoch: 59, Steps: 64 | Train Loss: 0.1080419 Vali Loss: 0.1678006 Test Loss: 0.2387023
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 60 cost time: 0.8234691619873047
Epoch: 60, Steps: 64 | Train Loss: 0.1082980 Vali Loss: 0.1660805 Test Loss: 0.2389660
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23872439563274384, mae:0.35783395171165466, rse:0.2476181834936142
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06350994110107422 GB
Epoch: 1 cost time: 2.308457851409912
Epoch: 1, Steps: 64 | Train Loss: 0.8657119 Vali Loss: 2.3323178 Test Loss: 3.7256629
Validation loss decreased (inf --> 2.332318).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 2 cost time: 0.9210002422332764
Epoch: 2, Steps: 64 | Train Loss: 0.4717237 Vali Loss: 0.2054476 Test Loss: 0.2460124
Validation loss decreased (2.332318 --> 0.205448).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 3 cost time: 0.927034854888916
Epoch: 3, Steps: 64 | Train Loss: 0.1534458 Vali Loss: 0.2055296 Test Loss: 0.2598073
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 4 cost time: 0.9366164207458496
Epoch: 4, Steps: 64 | Train Loss: 0.1373736 Vali Loss: 0.1806233 Test Loss: 0.2301429
Validation loss decreased (0.205448 --> 0.180623).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 5 cost time: 0.9183671474456787
Epoch: 5, Steps: 64 | Train Loss: 0.1312582 Vali Loss: 0.1803045 Test Loss: 0.2305682
Validation loss decreased (0.180623 --> 0.180304).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 6 cost time: 0.9174606800079346
Epoch: 6, Steps: 64 | Train Loss: 0.1278356 Vali Loss: 0.1765108 Test Loss: 0.2323051
Validation loss decreased (0.180304 --> 0.176511).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 7 cost time: 0.926398515701294
Epoch: 7, Steps: 64 | Train Loss: 0.1251502 Vali Loss: 0.1743294 Test Loss: 0.2279407
Validation loss decreased (0.176511 --> 0.174329).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 8 cost time: 0.9177629947662354
Epoch: 8, Steps: 64 | Train Loss: 0.1230354 Vali Loss: 0.1729802 Test Loss: 0.2299223
Validation loss decreased (0.174329 --> 0.172980).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 9 cost time: 0.9147853851318359
Epoch: 9, Steps: 64 | Train Loss: 0.1218449 Vali Loss: 0.1712794 Test Loss: 0.2273549
Validation loss decreased (0.172980 --> 0.171279).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 10 cost time: 0.924999475479126
Epoch: 10, Steps: 64 | Train Loss: 0.1204607 Vali Loss: 0.1706781 Test Loss: 0.2295438
Validation loss decreased (0.171279 --> 0.170678).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 11 cost time: 0.9097130298614502
Epoch: 11, Steps: 64 | Train Loss: 0.1191662 Vali Loss: 0.1680381 Test Loss: 0.2293271
Validation loss decreased (0.170678 --> 0.168038).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 12 cost time: 0.9160161018371582
Epoch: 12, Steps: 64 | Train Loss: 0.1178492 Vali Loss: 0.1664751 Test Loss: 0.2289013
Validation loss decreased (0.168038 --> 0.166475).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 13 cost time: 0.9254477024078369
Epoch: 13, Steps: 64 | Train Loss: 0.1170403 Vali Loss: 0.1684208 Test Loss: 0.2289043
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 14 cost time: 0.9253542423248291
Epoch: 14, Steps: 64 | Train Loss: 0.1163201 Vali Loss: 0.1695005 Test Loss: 0.2318495
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 15 cost time: 0.9253478050231934
Epoch: 15, Steps: 64 | Train Loss: 0.1155734 Vali Loss: 0.1662118 Test Loss: 0.2303851
Validation loss decreased (0.166475 --> 0.166212).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 16 cost time: 0.9173521995544434
Epoch: 16, Steps: 64 | Train Loss: 0.1149128 Vali Loss: 0.1661405 Test Loss: 0.2314912
Validation loss decreased (0.166212 --> 0.166140).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 17 cost time: 0.9277698993682861
Epoch: 17, Steps: 64 | Train Loss: 0.1144799 Vali Loss: 0.1671056 Test Loss: 0.2330656
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 18 cost time: 0.9226253032684326
Epoch: 18, Steps: 64 | Train Loss: 0.1134258 Vali Loss: 0.1671058 Test Loss: 0.2339799
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 19 cost time: 0.9220216274261475
Epoch: 19, Steps: 64 | Train Loss: 0.1129930 Vali Loss: 0.1659455 Test Loss: 0.2336704
Validation loss decreased (0.166140 --> 0.165945).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 20 cost time: 0.9210922718048096
Epoch: 20, Steps: 64 | Train Loss: 0.1129583 Vali Loss: 0.1666308 Test Loss: 0.2344348
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 21 cost time: 0.919419527053833
Epoch: 21, Steps: 64 | Train Loss: 0.1122123 Vali Loss: 0.1658332 Test Loss: 0.2344932
Validation loss decreased (0.165945 --> 0.165833).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 22 cost time: 0.9213399887084961
Epoch: 22, Steps: 64 | Train Loss: 0.1117492 Vali Loss: 0.1664113 Test Loss: 0.2367894
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 23 cost time: 0.9214885234832764
Epoch: 23, Steps: 64 | Train Loss: 0.1115746 Vali Loss: 0.1662639 Test Loss: 0.2360462
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 24 cost time: 0.9153718948364258
Epoch: 24, Steps: 64 | Train Loss: 0.1115836 Vali Loss: 0.1677164 Test Loss: 0.2376526
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 25 cost time: 0.9163832664489746
Epoch: 25, Steps: 64 | Train Loss: 0.1116793 Vali Loss: 0.1662947 Test Loss: 0.2366007
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 26 cost time: 0.9210007190704346
Epoch: 26, Steps: 64 | Train Loss: 0.1107017 Vali Loss: 0.1660114 Test Loss: 0.2378721
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 27 cost time: 0.9266149997711182
Epoch: 27, Steps: 64 | Train Loss: 0.1109064 Vali Loss: 0.1670932 Test Loss: 0.2378963
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 28 cost time: 0.9253761768341064
Epoch: 28, Steps: 64 | Train Loss: 0.1108853 Vali Loss: 0.1671830 Test Loss: 0.2376223
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 29 cost time: 0.9213688373565674
Epoch: 29, Steps: 64 | Train Loss: 0.1099244 Vali Loss: 0.1665646 Test Loss: 0.2383577
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 30 cost time: 0.9182968139648438
Epoch: 30, Steps: 64 | Train Loss: 0.1110987 Vali Loss: 0.1657710 Test Loss: 0.2391885
Validation loss decreased (0.165833 --> 0.165771).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 31 cost time: 0.9213287830352783
Epoch: 31, Steps: 64 | Train Loss: 0.1109022 Vali Loss: 0.1657306 Test Loss: 0.2386141
Validation loss decreased (0.165771 --> 0.165731).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 32 cost time: 0.9227795600891113
Epoch: 32, Steps: 64 | Train Loss: 0.1097094 Vali Loss: 0.1657221 Test Loss: 0.2386224
Validation loss decreased (0.165731 --> 0.165722).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 33 cost time: 0.9214606285095215
Epoch: 33, Steps: 64 | Train Loss: 0.1097700 Vali Loss: 0.1665136 Test Loss: 0.2399024
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 34 cost time: 0.9279990196228027
Epoch: 34, Steps: 64 | Train Loss: 0.1102160 Vali Loss: 0.1669560 Test Loss: 0.2392666
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 35 cost time: 0.9245076179504395
Epoch: 35, Steps: 64 | Train Loss: 0.1101007 Vali Loss: 0.1676930 Test Loss: 0.2401017
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 36 cost time: 0.9254453182220459
Epoch: 36, Steps: 64 | Train Loss: 0.1094062 Vali Loss: 0.1685968 Test Loss: 0.2408678
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 37 cost time: 0.9191417694091797
Epoch: 37, Steps: 64 | Train Loss: 0.1098681 Vali Loss: 0.1665722 Test Loss: 0.2406326
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 38 cost time: 0.9223639965057373
Epoch: 38, Steps: 64 | Train Loss: 0.1093048 Vali Loss: 0.1655879 Test Loss: 0.2407159
Validation loss decreased (0.165722 --> 0.165588).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 39 cost time: 0.9214396476745605
Epoch: 39, Steps: 64 | Train Loss: 0.1092456 Vali Loss: 0.1673568 Test Loss: 0.2406788
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 40 cost time: 0.9209072589874268
Epoch: 40, Steps: 64 | Train Loss: 0.1090993 Vali Loss: 0.1670897 Test Loss: 0.2401722
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 41 cost time: 0.936626672744751
Epoch: 41, Steps: 64 | Train Loss: 0.1091340 Vali Loss: 0.1679335 Test Loss: 0.2408548
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 42 cost time: 0.9226212501525879
Epoch: 42, Steps: 64 | Train Loss: 0.1095202 Vali Loss: 0.1674211 Test Loss: 0.2410664
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 43 cost time: 0.9196135997772217
Epoch: 43, Steps: 64 | Train Loss: 0.1091571 Vali Loss: 0.1678763 Test Loss: 0.2417728
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 44 cost time: 0.9254107475280762
Epoch: 44, Steps: 64 | Train Loss: 0.1090511 Vali Loss: 0.1679654 Test Loss: 0.2407204
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 45 cost time: 0.9083786010742188
Epoch: 45, Steps: 64 | Train Loss: 0.1088918 Vali Loss: 0.1672549 Test Loss: 0.2412603
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 46 cost time: 0.9063546657562256
Epoch: 46, Steps: 64 | Train Loss: 0.1091275 Vali Loss: 0.1685216 Test Loss: 0.2408851
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 47 cost time: 0.9304041862487793
Epoch: 47, Steps: 64 | Train Loss: 0.1093091 Vali Loss: 0.1675914 Test Loss: 0.2407130
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 48 cost time: 0.9278688430786133
Epoch: 48, Steps: 64 | Train Loss: 0.1088061 Vali Loss: 0.1670998 Test Loss: 0.2411780
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 49 cost time: 0.9230000972747803
Epoch: 49, Steps: 64 | Train Loss: 0.1092142 Vali Loss: 0.1683233 Test Loss: 0.2414118
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 50 cost time: 0.9229843616485596
Epoch: 50, Steps: 64 | Train Loss: 0.1085340 Vali Loss: 0.1674909 Test Loss: 0.2415559
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 51 cost time: 0.9304015636444092
Epoch: 51, Steps: 64 | Train Loss: 0.1090059 Vali Loss: 0.1685513 Test Loss: 0.2424996
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 52 cost time: 0.9232432842254639
Epoch: 52, Steps: 64 | Train Loss: 0.1090033 Vali Loss: 0.1665537 Test Loss: 0.2405180
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 53 cost time: 0.9313559532165527
Epoch: 53, Steps: 64 | Train Loss: 0.1088746 Vali Loss: 0.1691160 Test Loss: 0.2418422
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 54 cost time: 0.9279782772064209
Epoch: 54, Steps: 64 | Train Loss: 0.1085748 Vali Loss: 0.1670278 Test Loss: 0.2416101
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 55 cost time: 0.947413444519043
Epoch: 55, Steps: 64 | Train Loss: 0.1085890 Vali Loss: 0.1670419 Test Loss: 0.2412596
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 56 cost time: 0.9228067398071289
Epoch: 56, Steps: 64 | Train Loss: 0.1090724 Vali Loss: 0.1664456 Test Loss: 0.2413889
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 57 cost time: 0.9179999828338623
Epoch: 57, Steps: 64 | Train Loss: 0.1088755 Vali Loss: 0.1671546 Test Loss: 0.2413671
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 58 cost time: 0.929631233215332
Epoch: 58, Steps: 64 | Train Loss: 0.1089077 Vali Loss: 0.1657994 Test Loss: 0.2408656
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 59 cost time: 0.9256138801574707
Epoch: 59, Steps: 64 | Train Loss: 0.1092774 Vali Loss: 0.1682406 Test Loss: 0.2425026
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 60 cost time: 0.920806884765625
Epoch: 60, Steps: 64 | Train Loss: 0.1092864 Vali Loss: 0.1670420 Test Loss: 0.2417039
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2407158464193344, mae:0.3619004786014557, rse:0.24864886701107025
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05733013153076172 GB
Epoch: 1 cost time: 2.2071497440338135
Epoch: 1, Steps: 64 | Train Loss: 1.0556880 Vali Loss: 2.7568643 Test Loss: 4.4110336
Validation loss decreased (inf --> 2.756864).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 2 cost time: 0.8703670501708984
Epoch: 2, Steps: 64 | Train Loss: 0.8519609 Vali Loss: 1.7257100 Test Loss: 2.7032926
Validation loss decreased (2.756864 --> 1.725710).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 3 cost time: 0.8659999370574951
Epoch: 3, Steps: 64 | Train Loss: 0.5859431 Vali Loss: 1.1809103 Test Loss: 1.8075887
Validation loss decreased (1.725710 --> 1.180910).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 4 cost time: 0.8686206340789795
Epoch: 4, Steps: 64 | Train Loss: 0.4346206 Vali Loss: 0.8724324 Test Loss: 1.3180126
Validation loss decreased (1.180910 --> 0.872432).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 5 cost time: 0.8696203231811523
Epoch: 5, Steps: 64 | Train Loss: 0.3407726 Vali Loss: 0.6820285 Test Loss: 1.0140105
Validation loss decreased (0.872432 --> 0.682028).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 6 cost time: 0.8653697967529297
Epoch: 6, Steps: 64 | Train Loss: 0.2790461 Vali Loss: 0.5500942 Test Loss: 0.8035144
Validation loss decreased (0.682028 --> 0.550094).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 7 cost time: 0.8643441200256348
Epoch: 7, Steps: 64 | Train Loss: 0.2383184 Vali Loss: 0.4550617 Test Loss: 0.6600832
Validation loss decreased (0.550094 --> 0.455062).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 8 cost time: 0.8617181777954102
Epoch: 8, Steps: 64 | Train Loss: 0.2095532 Vali Loss: 0.3874221 Test Loss: 0.5548373
Validation loss decreased (0.455062 --> 0.387422).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 9 cost time: 0.8599998950958252
Epoch: 9, Steps: 64 | Train Loss: 0.1893676 Vali Loss: 0.3401939 Test Loss: 0.4779044
Validation loss decreased (0.387422 --> 0.340194).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 10 cost time: 0.8616228103637695
Epoch: 10, Steps: 64 | Train Loss: 0.1752856 Vali Loss: 0.3067859 Test Loss: 0.4250742
Validation loss decreased (0.340194 --> 0.306786).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 11 cost time: 0.8684446811676025
Epoch: 11, Steps: 64 | Train Loss: 0.1644578 Vali Loss: 0.2846336 Test Loss: 0.3883856
Validation loss decreased (0.306786 --> 0.284634).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 12 cost time: 0.8648624420166016
Epoch: 12, Steps: 64 | Train Loss: 0.1569481 Vali Loss: 0.2617845 Test Loss: 0.3536935
Validation loss decreased (0.284634 --> 0.261785).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 13 cost time: 0.8648269176483154
Epoch: 13, Steps: 64 | Train Loss: 0.1508139 Vali Loss: 0.2462353 Test Loss: 0.3334487
Validation loss decreased (0.261785 --> 0.246235).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 14 cost time: 0.8628754615783691
Epoch: 14, Steps: 64 | Train Loss: 0.1461434 Vali Loss: 0.2377279 Test Loss: 0.3163441
Validation loss decreased (0.246235 --> 0.237728).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 15 cost time: 0.8612697124481201
Epoch: 15, Steps: 64 | Train Loss: 0.1428535 Vali Loss: 0.2260828 Test Loss: 0.2998925
Validation loss decreased (0.237728 --> 0.226083).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 16 cost time: 0.871354341506958
Epoch: 16, Steps: 64 | Train Loss: 0.1406788 Vali Loss: 0.2201811 Test Loss: 0.2940654
Validation loss decreased (0.226083 --> 0.220181).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 17 cost time: 0.8598165512084961
Epoch: 17, Steps: 64 | Train Loss: 0.1385229 Vali Loss: 0.2150660 Test Loss: 0.2817635
Validation loss decreased (0.220181 --> 0.215066).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 18 cost time: 0.8613653182983398
Epoch: 18, Steps: 64 | Train Loss: 0.1354839 Vali Loss: 0.2109353 Test Loss: 0.2765031
Validation loss decreased (0.215066 --> 0.210935).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 19 cost time: 0.8597218990325928
Epoch: 19, Steps: 64 | Train Loss: 0.1344278 Vali Loss: 0.2077399 Test Loss: 0.2723888
Validation loss decreased (0.210935 --> 0.207740).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 20 cost time: 0.8809983730316162
Epoch: 20, Steps: 64 | Train Loss: 0.1323892 Vali Loss: 0.2028105 Test Loss: 0.2672192
Validation loss decreased (0.207740 --> 0.202811).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 21 cost time: 0.8640000820159912
Epoch: 21, Steps: 64 | Train Loss: 0.1313094 Vali Loss: 0.1972238 Test Loss: 0.2592728
Validation loss decreased (0.202811 --> 0.197224).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 22 cost time: 0.8673734664916992
Epoch: 22, Steps: 64 | Train Loss: 0.1304032 Vali Loss: 0.1990377 Test Loss: 0.2586155
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 23 cost time: 0.8693497180938721
Epoch: 23, Steps: 64 | Train Loss: 0.1303204 Vali Loss: 0.1949366 Test Loss: 0.2553708
Validation loss decreased (0.197224 --> 0.194937).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 24 cost time: 0.8563711643218994
Epoch: 24, Steps: 64 | Train Loss: 0.1290342 Vali Loss: 0.1944993 Test Loss: 0.2538010
Validation loss decreased (0.194937 --> 0.194499).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 25 cost time: 0.8597495555877686
Epoch: 25, Steps: 64 | Train Loss: 0.1284347 Vali Loss: 0.1922576 Test Loss: 0.2516211
Validation loss decreased (0.194499 --> 0.192258).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 26 cost time: 0.8618326187133789
Epoch: 26, Steps: 64 | Train Loss: 0.1275469 Vali Loss: 0.1911003 Test Loss: 0.2504654
Validation loss decreased (0.192258 --> 0.191100).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 27 cost time: 0.8676133155822754
Epoch: 27, Steps: 64 | Train Loss: 0.1276634 Vali Loss: 0.1911400 Test Loss: 0.2477420
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 28 cost time: 0.8603572845458984
Epoch: 28, Steps: 64 | Train Loss: 0.1268333 Vali Loss: 0.1891479 Test Loss: 0.2471630
Validation loss decreased (0.191100 --> 0.189148).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 29 cost time: 0.8674526214599609
Epoch: 29, Steps: 64 | Train Loss: 0.1269697 Vali Loss: 0.1897036 Test Loss: 0.2450750
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 30 cost time: 0.8654015064239502
Epoch: 30, Steps: 64 | Train Loss: 0.1269600 Vali Loss: 0.1887701 Test Loss: 0.2451174
Validation loss decreased (0.189148 --> 0.188770).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 31 cost time: 0.8685460090637207
Epoch: 31, Steps: 64 | Train Loss: 0.1266323 Vali Loss: 0.1881194 Test Loss: 0.2463762
Validation loss decreased (0.188770 --> 0.188119).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 32 cost time: 0.8650000095367432
Epoch: 32, Steps: 64 | Train Loss: 0.1255576 Vali Loss: 0.1874545 Test Loss: 0.2452807
Validation loss decreased (0.188119 --> 0.187455).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 33 cost time: 0.8603458404541016
Epoch: 33, Steps: 64 | Train Loss: 0.1258422 Vali Loss: 0.1847311 Test Loss: 0.2418241
Validation loss decreased (0.187455 --> 0.184731).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 34 cost time: 0.8604335784912109
Epoch: 34, Steps: 64 | Train Loss: 0.1256442 Vali Loss: 0.1874248 Test Loss: 0.2441009
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 35 cost time: 0.859959602355957
Epoch: 35, Steps: 64 | Train Loss: 0.1257519 Vali Loss: 0.1851815 Test Loss: 0.2432744
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 36 cost time: 0.8658111095428467
Epoch: 36, Steps: 64 | Train Loss: 0.1248529 Vali Loss: 0.1874714 Test Loss: 0.2434748
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 37 cost time: 0.8590011596679688
Epoch: 37, Steps: 64 | Train Loss: 0.1254365 Vali Loss: 0.1860548 Test Loss: 0.2424141
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 38 cost time: 0.8796248435974121
Epoch: 38, Steps: 64 | Train Loss: 0.1243988 Vali Loss: 0.1874716 Test Loss: 0.2424158
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 39 cost time: 0.9314179420471191
Epoch: 39, Steps: 64 | Train Loss: 0.1244199 Vali Loss: 0.1840729 Test Loss: 0.2405944
Validation loss decreased (0.184731 --> 0.184073).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 40 cost time: 0.9360415935516357
Epoch: 40, Steps: 64 | Train Loss: 0.1239941 Vali Loss: 0.1843187 Test Loss: 0.2412263
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 41 cost time: 0.9175834655761719
Epoch: 41, Steps: 64 | Train Loss: 0.1239368 Vali Loss: 0.1837197 Test Loss: 0.2411701
Validation loss decreased (0.184073 --> 0.183720).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 42 cost time: 0.8643519878387451
Epoch: 42, Steps: 64 | Train Loss: 0.1241697 Vali Loss: 0.1849656 Test Loss: 0.2391977
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 43 cost time: 0.8620002269744873
Epoch: 43, Steps: 64 | Train Loss: 0.1241727 Vali Loss: 0.1842763 Test Loss: 0.2402078
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 44 cost time: 0.8600668907165527
Epoch: 44, Steps: 64 | Train Loss: 0.1236892 Vali Loss: 0.1844663 Test Loss: 0.2416572
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 45 cost time: 0.8753938674926758
Epoch: 45, Steps: 64 | Train Loss: 0.1233639 Vali Loss: 0.1838329 Test Loss: 0.2392459
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 46 cost time: 0.9374828338623047
Epoch: 46, Steps: 64 | Train Loss: 0.1242548 Vali Loss: 0.1840260 Test Loss: 0.2397411
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 47 cost time: 0.931433916091919
Epoch: 47, Steps: 64 | Train Loss: 0.1241902 Vali Loss: 0.1843311 Test Loss: 0.2404283
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 48 cost time: 0.867356538772583
Epoch: 48, Steps: 64 | Train Loss: 0.1238768 Vali Loss: 0.1820144 Test Loss: 0.2397348
Validation loss decreased (0.183720 --> 0.182014).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 49 cost time: 0.875999927520752
Epoch: 49, Steps: 64 | Train Loss: 0.1235659 Vali Loss: 0.1834307 Test Loss: 0.2385318
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 50 cost time: 0.8660001754760742
Epoch: 50, Steps: 64 | Train Loss: 0.1233610 Vali Loss: 0.1845534 Test Loss: 0.2411756
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 51 cost time: 0.863640308380127
Epoch: 51, Steps: 64 | Train Loss: 0.1244271 Vali Loss: 0.1820685 Test Loss: 0.2379132
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 52 cost time: 0.8694033622741699
Epoch: 52, Steps: 64 | Train Loss: 0.1238071 Vali Loss: 0.1827643 Test Loss: 0.2391045
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 53 cost time: 0.8660049438476562
Epoch: 53, Steps: 64 | Train Loss: 0.1234819 Vali Loss: 0.1814287 Test Loss: 0.2398735
Validation loss decreased (0.182014 --> 0.181429).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 54 cost time: 0.8667576313018799
Epoch: 54, Steps: 64 | Train Loss: 0.1237627 Vali Loss: 0.1829261 Test Loss: 0.2379472
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 55 cost time: 0.8608598709106445
Epoch: 55, Steps: 64 | Train Loss: 0.1243490 Vali Loss: 0.1830652 Test Loss: 0.2390032
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 56 cost time: 0.8716239929199219
Epoch: 56, Steps: 64 | Train Loss: 0.1236801 Vali Loss: 0.1830435 Test Loss: 0.2396601
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 57 cost time: 0.8673968315124512
Epoch: 57, Steps: 64 | Train Loss: 0.1239917 Vali Loss: 0.1819950 Test Loss: 0.2376586
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 58 cost time: 0.8683736324310303
Epoch: 58, Steps: 64 | Train Loss: 0.1232394 Vali Loss: 0.1824947 Test Loss: 0.2386698
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 59 cost time: 0.8661394119262695
Epoch: 59, Steps: 64 | Train Loss: 0.1233171 Vali Loss: 0.1826154 Test Loss: 0.2387886
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 60 cost time: 0.8749990463256836
Epoch: 60, Steps: 64 | Train Loss: 0.1243306 Vali Loss: 0.1824529 Test Loss: 0.2386071
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23987345397472382, mae:0.3555946946144104, rse:0.24821339547634125
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06047630310058594 GB
Epoch: 1 cost time: 2.1751532554626465
Epoch: 1, Steps: 64 | Train Loss: 0.9234879 Vali Loss: 2.4627895 Test Loss: 3.9107769
Validation loss decreased (inf --> 2.462790).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 2 cost time: 0.8304460048675537
Epoch: 2, Steps: 64 | Train Loss: 0.5928243 Vali Loss: 0.5850829 Test Loss: 0.8492507
Validation loss decreased (2.462790 --> 0.585083).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 3 cost time: 0.8373897075653076
Epoch: 3, Steps: 64 | Train Loss: 0.1934463 Vali Loss: 0.2018568 Test Loss: 0.2256563
Validation loss decreased (0.585083 --> 0.201857).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 4 cost time: 0.8357892036437988
Epoch: 4, Steps: 64 | Train Loss: 0.1458783 Vali Loss: 0.1913383 Test Loss: 0.2332728
Validation loss decreased (0.201857 --> 0.191338).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 5 cost time: 0.8359999656677246
Epoch: 5, Steps: 64 | Train Loss: 0.1390464 Vali Loss: 0.1847224 Test Loss: 0.2268721
Validation loss decreased (0.191338 --> 0.184722).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 6 cost time: 0.8336341381072998
Epoch: 6, Steps: 64 | Train Loss: 0.1340926 Vali Loss: 0.1806628 Test Loss: 0.2260420
Validation loss decreased (0.184722 --> 0.180663).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 7 cost time: 0.8383560180664062
Epoch: 7, Steps: 64 | Train Loss: 0.1303292 Vali Loss: 0.1786948 Test Loss: 0.2254614
Validation loss decreased (0.180663 --> 0.178695).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 8 cost time: 0.8350317478179932
Epoch: 8, Steps: 64 | Train Loss: 0.1280418 Vali Loss: 0.1775918 Test Loss: 0.2251520
Validation loss decreased (0.178695 --> 0.177592).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 9 cost time: 0.8393876552581787
Epoch: 9, Steps: 64 | Train Loss: 0.1258132 Vali Loss: 0.1737799 Test Loss: 0.2246051
Validation loss decreased (0.177592 --> 0.173780).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 10 cost time: 0.8359999656677246
Epoch: 10, Steps: 64 | Train Loss: 0.1237721 Vali Loss: 0.1731534 Test Loss: 0.2239784
Validation loss decreased (0.173780 --> 0.173153).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 11 cost time: 0.8396151065826416
Epoch: 11, Steps: 64 | Train Loss: 0.1220614 Vali Loss: 0.1738673 Test Loss: 0.2235412
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 12 cost time: 0.8378129005432129
Epoch: 12, Steps: 64 | Train Loss: 0.1210730 Vali Loss: 0.1697060 Test Loss: 0.2255105
Validation loss decreased (0.173153 --> 0.169706).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 13 cost time: 0.8359129428863525
Epoch: 13, Steps: 64 | Train Loss: 0.1199115 Vali Loss: 0.1727660 Test Loss: 0.2252806
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 14 cost time: 0.8381862640380859
Epoch: 14, Steps: 64 | Train Loss: 0.1189177 Vali Loss: 0.1753792 Test Loss: 0.2259835
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 15 cost time: 0.8510003089904785
Epoch: 15, Steps: 64 | Train Loss: 0.1178664 Vali Loss: 0.1713133 Test Loss: 0.2286828
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 16 cost time: 0.8389999866485596
Epoch: 16, Steps: 64 | Train Loss: 0.1174641 Vali Loss: 0.1714070 Test Loss: 0.2288318
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 17 cost time: 0.835376501083374
Epoch: 17, Steps: 64 | Train Loss: 0.1163669 Vali Loss: 0.1683489 Test Loss: 0.2294835
Validation loss decreased (0.169706 --> 0.168349).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 18 cost time: 0.8488142490386963
Epoch: 18, Steps: 64 | Train Loss: 0.1158342 Vali Loss: 0.1711295 Test Loss: 0.2305519
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 19 cost time: 0.8403716087341309
Epoch: 19, Steps: 64 | Train Loss: 0.1152455 Vali Loss: 0.1707247 Test Loss: 0.2307751
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 20 cost time: 0.8340001106262207
Epoch: 20, Steps: 64 | Train Loss: 0.1146566 Vali Loss: 0.1718094 Test Loss: 0.2324343
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 21 cost time: 0.836824893951416
Epoch: 21, Steps: 64 | Train Loss: 0.1148300 Vali Loss: 0.1667929 Test Loss: 0.2312293
Validation loss decreased (0.168349 --> 0.166793).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 22 cost time: 0.8513400554656982
Epoch: 22, Steps: 64 | Train Loss: 0.1142836 Vali Loss: 0.1697676 Test Loss: 0.2334886
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 23 cost time: 0.8353312015533447
Epoch: 23, Steps: 64 | Train Loss: 0.1140837 Vali Loss: 0.1689508 Test Loss: 0.2337968
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 24 cost time: 0.8323817253112793
Epoch: 24, Steps: 64 | Train Loss: 0.1134817 Vali Loss: 0.1685717 Test Loss: 0.2323966
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 25 cost time: 0.8330001831054688
Epoch: 25, Steps: 64 | Train Loss: 0.1136895 Vali Loss: 0.1691858 Test Loss: 0.2330038
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 26 cost time: 0.8214595317840576
Epoch: 26, Steps: 64 | Train Loss: 0.1129950 Vali Loss: 0.1663648 Test Loss: 0.2320296
Validation loss decreased (0.166793 --> 0.166365).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 27 cost time: 0.8403711318969727
Epoch: 27, Steps: 64 | Train Loss: 0.1125110 Vali Loss: 0.1679063 Test Loss: 0.2326330
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 28 cost time: 0.8393700122833252
Epoch: 28, Steps: 64 | Train Loss: 0.1128578 Vali Loss: 0.1675283 Test Loss: 0.2330848
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 29 cost time: 0.8337349891662598
Epoch: 29, Steps: 64 | Train Loss: 0.1120696 Vali Loss: 0.1678204 Test Loss: 0.2326462
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 30 cost time: 0.830998420715332
Epoch: 30, Steps: 64 | Train Loss: 0.1125821 Vali Loss: 0.1657631 Test Loss: 0.2328878
Validation loss decreased (0.166365 --> 0.165763).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 31 cost time: 0.8352553844451904
Epoch: 31, Steps: 64 | Train Loss: 0.1118940 Vali Loss: 0.1671320 Test Loss: 0.2328531
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 32 cost time: 0.831345796585083
Epoch: 32, Steps: 64 | Train Loss: 0.1121998 Vali Loss: 0.1675138 Test Loss: 0.2340671
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 33 cost time: 0.8314082622528076
Epoch: 33, Steps: 64 | Train Loss: 0.1119049 Vali Loss: 0.1678676 Test Loss: 0.2338217
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 34 cost time: 0.8167343139648438
Epoch: 34, Steps: 64 | Train Loss: 0.1107594 Vali Loss: 0.1677100 Test Loss: 0.2341029
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 35 cost time: 0.8374345302581787
Epoch: 35, Steps: 64 | Train Loss: 0.1107788 Vali Loss: 0.1665132 Test Loss: 0.2340504
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 36 cost time: 0.833608865737915
Epoch: 36, Steps: 64 | Train Loss: 0.1118440 Vali Loss: 0.1660883 Test Loss: 0.2338805
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 37 cost time: 0.8453769683837891
Epoch: 37, Steps: 64 | Train Loss: 0.1111044 Vali Loss: 0.1686283 Test Loss: 0.2340841
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 38 cost time: 0.8303792476654053
Epoch: 38, Steps: 64 | Train Loss: 0.1113410 Vali Loss: 0.1682069 Test Loss: 0.2346899
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 39 cost time: 0.8387389183044434
Epoch: 39, Steps: 64 | Train Loss: 0.1113838 Vali Loss: 0.1669246 Test Loss: 0.2341795
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 40 cost time: 0.8383440971374512
Epoch: 40, Steps: 64 | Train Loss: 0.1112376 Vali Loss: 0.1677494 Test Loss: 0.2343570
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 41 cost time: 0.8476097583770752
Epoch: 41, Steps: 64 | Train Loss: 0.1111419 Vali Loss: 0.1676206 Test Loss: 0.2340000
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 42 cost time: 0.8354003429412842
Epoch: 42, Steps: 64 | Train Loss: 0.1116204 Vali Loss: 0.1675906 Test Loss: 0.2347411
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 43 cost time: 0.8403286933898926
Epoch: 43, Steps: 64 | Train Loss: 0.1105691 Vali Loss: 0.1669002 Test Loss: 0.2345832
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 44 cost time: 0.8346450328826904
Epoch: 44, Steps: 64 | Train Loss: 0.1101221 Vali Loss: 0.1666992 Test Loss: 0.2346197
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 45 cost time: 0.8470003604888916
Epoch: 45, Steps: 64 | Train Loss: 0.1112377 Vali Loss: 0.1669639 Test Loss: 0.2340009
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 46 cost time: 0.8386151790618896
Epoch: 46, Steps: 64 | Train Loss: 0.1107895 Vali Loss: 0.1675909 Test Loss: 0.2345854
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 47 cost time: 0.8393585681915283
Epoch: 47, Steps: 64 | Train Loss: 0.1102586 Vali Loss: 0.1665639 Test Loss: 0.2346244
EarlyStopping counter: 17 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 48 cost time: 0.8393599987030029
Epoch: 48, Steps: 64 | Train Loss: 0.1111433 Vali Loss: 0.1679870 Test Loss: 0.2345749
EarlyStopping counter: 18 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 49 cost time: 0.8344147205352783
Epoch: 49, Steps: 64 | Train Loss: 0.1108612 Vali Loss: 0.1674989 Test Loss: 0.2347102
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 50 cost time: 0.8359999656677246
Epoch: 50, Steps: 64 | Train Loss: 0.1110962 Vali Loss: 0.1670718 Test Loss: 0.2343233
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 51 cost time: 0.8316349983215332
Epoch: 51, Steps: 64 | Train Loss: 0.1106255 Vali Loss: 0.1677151 Test Loss: 0.2346044
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 52 cost time: 0.8404059410095215
Epoch: 52, Steps: 64 | Train Loss: 0.1108566 Vali Loss: 0.1658853 Test Loss: 0.2340455
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 53 cost time: 0.7983403205871582
Epoch: 53, Steps: 64 | Train Loss: 0.1104172 Vali Loss: 0.1685732 Test Loss: 0.2347151
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 54 cost time: 0.8120267391204834
Epoch: 54, Steps: 64 | Train Loss: 0.1108742 Vali Loss: 0.1675304 Test Loss: 0.2340918
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 55 cost time: 0.8258056640625
Epoch: 55, Steps: 64 | Train Loss: 0.1102168 Vali Loss: 0.1674419 Test Loss: 0.2342815
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 56 cost time: 0.8602607250213623
Epoch: 56, Steps: 64 | Train Loss: 0.1104379 Vali Loss: 0.1673165 Test Loss: 0.2345982
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 57 cost time: 0.8340880870819092
Epoch: 57, Steps: 64 | Train Loss: 0.1109087 Vali Loss: 0.1687734 Test Loss: 0.2345757
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 58 cost time: 0.8340873718261719
Epoch: 58, Steps: 64 | Train Loss: 0.1107782 Vali Loss: 0.1659241 Test Loss: 0.2336872
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 59 cost time: 0.841001033782959
Epoch: 59, Steps: 64 | Train Loss: 0.1107582 Vali Loss: 0.1670805 Test Loss: 0.2351356
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 60 cost time: 0.8369998931884766
Epoch: 60, Steps: 64 | Train Loss: 0.1108322 Vali Loss: 0.1660383 Test Loss: 0.2341177
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23288783431053162, mae:0.3523792028427124, rse:0.2445724457502365
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06367111206054688 GB
Epoch: 1 cost time: 2.2785773277282715
Epoch: 1, Steps: 64 | Train Loss: 0.8800334 Vali Loss: 2.3825321 Test Loss: 3.7765586
Validation loss decreased (inf --> 2.382532).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 2 cost time: 0.8676223754882812
Epoch: 2, Steps: 64 | Train Loss: 0.4902154 Vali Loss: 0.2009786 Test Loss: 0.2406717
Validation loss decreased (2.382532 --> 0.200979).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 3 cost time: 0.8624269962310791
Epoch: 3, Steps: 64 | Train Loss: 0.1574260 Vali Loss: 0.2001299 Test Loss: 0.2533310
Validation loss decreased (0.200979 --> 0.200130).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 4 cost time: 0.8629059791564941
Epoch: 4, Steps: 64 | Train Loss: 0.1389419 Vali Loss: 0.1830041 Test Loss: 0.2295169
Validation loss decreased (0.200130 --> 0.183004).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 5 cost time: 0.8630001544952393
Epoch: 5, Steps: 64 | Train Loss: 0.1327265 Vali Loss: 0.1756072 Test Loss: 0.2252065
Validation loss decreased (0.183004 --> 0.175607).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 6 cost time: 0.858626127243042
Epoch: 6, Steps: 64 | Train Loss: 0.1279122 Vali Loss: 0.1752817 Test Loss: 0.2260977
Validation loss decreased (0.175607 --> 0.175282).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 7 cost time: 0.8604326248168945
Epoch: 7, Steps: 64 | Train Loss: 0.1258432 Vali Loss: 0.1759434 Test Loss: 0.2262398
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 8 cost time: 0.8613698482513428
Epoch: 8, Steps: 64 | Train Loss: 0.1231903 Vali Loss: 0.1742267 Test Loss: 0.2267238
Validation loss decreased (0.175282 --> 0.174227).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 9 cost time: 0.8428230285644531
Epoch: 9, Steps: 64 | Train Loss: 0.1212467 Vali Loss: 0.1733693 Test Loss: 0.2298079
Validation loss decreased (0.174227 --> 0.173369).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 10 cost time: 0.8637347221374512
Epoch: 10, Steps: 64 | Train Loss: 0.1188449 Vali Loss: 0.1750876 Test Loss: 0.2297581
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 11 cost time: 0.8469998836517334
Epoch: 11, Steps: 64 | Train Loss: 0.1175170 Vali Loss: 0.1700982 Test Loss: 0.2299799
Validation loss decreased (0.173369 --> 0.170098).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 12 cost time: 0.8612625598907471
Epoch: 12, Steps: 64 | Train Loss: 0.1168181 Vali Loss: 0.1706914 Test Loss: 0.2329110
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 13 cost time: 0.8612096309661865
Epoch: 13, Steps: 64 | Train Loss: 0.1158209 Vali Loss: 0.1736563 Test Loss: 0.2363279
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 14 cost time: 0.8667314052581787
Epoch: 14, Steps: 64 | Train Loss: 0.1150268 Vali Loss: 0.1753265 Test Loss: 0.2362289
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 15 cost time: 0.8563787937164307
Epoch: 15, Steps: 64 | Train Loss: 0.1140469 Vali Loss: 0.1717712 Test Loss: 0.2383069
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 16 cost time: 0.8580000400543213
Epoch: 16, Steps: 64 | Train Loss: 0.1131139 Vali Loss: 0.1721960 Test Loss: 0.2401539
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 17 cost time: 0.8569998741149902
Epoch: 17, Steps: 64 | Train Loss: 0.1128681 Vali Loss: 0.1710455 Test Loss: 0.2392572
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 18 cost time: 0.8754978179931641
Epoch: 18, Steps: 64 | Train Loss: 0.1121236 Vali Loss: 0.1716924 Test Loss: 0.2418218
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 19 cost time: 0.8614113330841064
Epoch: 19, Steps: 64 | Train Loss: 0.1111461 Vali Loss: 0.1721826 Test Loss: 0.2409432
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 20 cost time: 0.8614580631256104
Epoch: 20, Steps: 64 | Train Loss: 0.1112917 Vali Loss: 0.1730651 Test Loss: 0.2428691
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 21 cost time: 0.8607723712921143
Epoch: 21, Steps: 64 | Train Loss: 0.1105771 Vali Loss: 0.1701108 Test Loss: 0.2411905
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 22 cost time: 0.8705031871795654
Epoch: 22, Steps: 64 | Train Loss: 0.1099738 Vali Loss: 0.1720098 Test Loss: 0.2442111
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 23 cost time: 0.8646302223205566
Epoch: 23, Steps: 64 | Train Loss: 0.1094396 Vali Loss: 0.1707341 Test Loss: 0.2432949
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 24 cost time: 0.861393928527832
Epoch: 24, Steps: 64 | Train Loss: 0.1097754 Vali Loss: 0.1708663 Test Loss: 0.2446919
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 25 cost time: 0.8633787631988525
Epoch: 25, Steps: 64 | Train Loss: 0.1097466 Vali Loss: 0.1688358 Test Loss: 0.2429773
Validation loss decreased (0.170098 --> 0.168836).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 26 cost time: 0.8604080677032471
Epoch: 26, Steps: 64 | Train Loss: 0.1089676 Vali Loss: 0.1714342 Test Loss: 0.2443044
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 27 cost time: 0.8571655750274658
Epoch: 27, Steps: 64 | Train Loss: 0.1086471 Vali Loss: 0.1714986 Test Loss: 0.2445075
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 28 cost time: 0.863999605178833
Epoch: 28, Steps: 64 | Train Loss: 0.1086276 Vali Loss: 0.1701232 Test Loss: 0.2451019
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 29 cost time: 0.8406133651733398
Epoch: 29, Steps: 64 | Train Loss: 0.1087572 Vali Loss: 0.1697211 Test Loss: 0.2442283
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 30 cost time: 0.8336482048034668
Epoch: 30, Steps: 64 | Train Loss: 0.1087702 Vali Loss: 0.1720101 Test Loss: 0.2453849
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 31 cost time: 0.8597769737243652
Epoch: 31, Steps: 64 | Train Loss: 0.1090663 Vali Loss: 0.1708078 Test Loss: 0.2448016
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 32 cost time: 0.8672580718994141
Epoch: 32, Steps: 64 | Train Loss: 0.1084178 Vali Loss: 0.1711723 Test Loss: 0.2448702
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 33 cost time: 0.8398487567901611
Epoch: 33, Steps: 64 | Train Loss: 0.1082827 Vali Loss: 0.1715357 Test Loss: 0.2456652
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 34 cost time: 0.8576188087463379
Epoch: 34, Steps: 64 | Train Loss: 0.1079447 Vali Loss: 0.1717671 Test Loss: 0.2463537
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 35 cost time: 0.8543515205383301
Epoch: 35, Steps: 64 | Train Loss: 0.1082958 Vali Loss: 0.1710908 Test Loss: 0.2451125
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 36 cost time: 0.8680355548858643
Epoch: 36, Steps: 64 | Train Loss: 0.1081552 Vali Loss: 0.1700862 Test Loss: 0.2449746
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 37 cost time: 0.8623583316802979
Epoch: 37, Steps: 64 | Train Loss: 0.1075897 Vali Loss: 0.1698022 Test Loss: 0.2456705
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 38 cost time: 0.8599998950958252
Epoch: 38, Steps: 64 | Train Loss: 0.1069097 Vali Loss: 0.1711517 Test Loss: 0.2462750
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 39 cost time: 0.8599998950958252
Epoch: 39, Steps: 64 | Train Loss: 0.1070285 Vali Loss: 0.1694193 Test Loss: 0.2453650
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 40 cost time: 0.8696963787078857
Epoch: 40, Steps: 64 | Train Loss: 0.1077215 Vali Loss: 0.1705287 Test Loss: 0.2452075
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 41 cost time: 0.857377290725708
Epoch: 41, Steps: 64 | Train Loss: 0.1080030 Vali Loss: 0.1697623 Test Loss: 0.2452197
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 42 cost time: 0.8573436737060547
Epoch: 42, Steps: 64 | Train Loss: 0.1075634 Vali Loss: 0.1712027 Test Loss: 0.2463963
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 43 cost time: 0.8597433567047119
Epoch: 43, Steps: 64 | Train Loss: 0.1076969 Vali Loss: 0.1714249 Test Loss: 0.2454252
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 44 cost time: 0.8566148281097412
Epoch: 44, Steps: 64 | Train Loss: 0.1070014 Vali Loss: 0.1690456 Test Loss: 0.2445063
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 45 cost time: 0.8556272983551025
Epoch: 45, Steps: 64 | Train Loss: 0.1070759 Vali Loss: 0.1706900 Test Loss: 0.2447928
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 46 cost time: 0.858365535736084
Epoch: 46, Steps: 64 | Train Loss: 0.1076063 Vali Loss: 0.1715083 Test Loss: 0.2457852
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 47 cost time: 0.872382402420044
Epoch: 47, Steps: 64 | Train Loss: 0.1074483 Vali Loss: 0.1706297 Test Loss: 0.2454964
EarlyStopping counter: 22 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 48 cost time: 0.8689525127410889
Epoch: 48, Steps: 64 | Train Loss: 0.1071009 Vali Loss: 0.1710186 Test Loss: 0.2439748
EarlyStopping counter: 23 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 49 cost time: 0.8705499172210693
Epoch: 49, Steps: 64 | Train Loss: 0.1069757 Vali Loss: 0.1693609 Test Loss: 0.2451283
EarlyStopping counter: 24 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 50 cost time: 0.8639998435974121
Epoch: 50, Steps: 64 | Train Loss: 0.1075211 Vali Loss: 0.1715951 Test Loss: 0.2455136
EarlyStopping counter: 25 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 51 cost time: 0.846616268157959
Epoch: 51, Steps: 64 | Train Loss: 0.1070951 Vali Loss: 0.1700548 Test Loss: 0.2453128
EarlyStopping counter: 26 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 52 cost time: 0.8423888683319092
Epoch: 52, Steps: 64 | Train Loss: 0.1077567 Vali Loss: 0.1688757 Test Loss: 0.2452798
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 53 cost time: 0.8623793125152588
Epoch: 53, Steps: 64 | Train Loss: 0.1076685 Vali Loss: 0.1696609 Test Loss: 0.2447130
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 54 cost time: 0.8680973052978516
Epoch: 54, Steps: 64 | Train Loss: 0.1071379 Vali Loss: 0.1691203 Test Loss: 0.2448970
EarlyStopping counter: 29 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 55 cost time: 0.8750002384185791
Epoch: 55, Steps: 64 | Train Loss: 0.1073767 Vali Loss: 0.1703804 Test Loss: 0.2448906
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 56 cost time: 0.8656306266784668
Epoch: 56, Steps: 64 | Train Loss: 0.1068545 Vali Loss: 0.1698708 Test Loss: 0.2454051
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 57 cost time: 0.8653807640075684
Epoch: 57, Steps: 64 | Train Loss: 0.1073783 Vali Loss: 0.1705406 Test Loss: 0.2455162
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 58 cost time: 0.8610999584197998
Epoch: 58, Steps: 64 | Train Loss: 0.1072721 Vali Loss: 0.1714655 Test Loss: 0.2454100
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 59 cost time: 0.8695113658905029
Epoch: 59, Steps: 64 | Train Loss: 0.1067797 Vali Loss: 0.1706930 Test Loss: 0.2453116
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 60 cost time: 0.86171555519104
Epoch: 60, Steps: 64 | Train Loss: 0.1072905 Vali Loss: 0.1704384 Test Loss: 0.2452655
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2429772913455963, mae:0.36564168334007263, rse:0.24981412291526794
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05749082565307617 GB
Epoch: 1 cost time: 2.230332612991333
Epoch: 1, Steps: 64 | Train Loss: 1.0142825 Vali Loss: 2.6382573 Test Loss: 4.2198524
Validation loss decreased (inf --> 2.638257).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 2 cost time: 0.8679032325744629
Epoch: 2, Steps: 64 | Train Loss: 0.8136693 Vali Loss: 1.6286982 Test Loss: 2.5587225
Validation loss decreased (2.638257 --> 1.628698).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 3 cost time: 0.8802728652954102
Epoch: 3, Steps: 64 | Train Loss: 0.5582910 Vali Loss: 1.1550307 Test Loss: 1.7700459
Validation loss decreased (1.628698 --> 1.155031).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 4 cost time: 0.8793456554412842
Epoch: 4, Steps: 64 | Train Loss: 0.4199269 Vali Loss: 0.8803544 Test Loss: 1.3269191
Validation loss decreased (1.155031 --> 0.880354).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 5 cost time: 0.8884174823760986
Epoch: 5, Steps: 64 | Train Loss: 0.3301298 Vali Loss: 0.6802976 Test Loss: 1.0166547
Validation loss decreased (0.880354 --> 0.680298).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 6 cost time: 0.9673423767089844
Epoch: 6, Steps: 64 | Train Loss: 0.2712726 Vali Loss: 0.5387928 Test Loss: 0.7939751
Validation loss decreased (0.680298 --> 0.538793).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 7 cost time: 0.8795099258422852
Epoch: 7, Steps: 64 | Train Loss: 0.2315087 Vali Loss: 0.4510157 Test Loss: 0.6532496
Validation loss decreased (0.538793 --> 0.451016).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 8 cost time: 0.88283371925354
Epoch: 8, Steps: 64 | Train Loss: 0.2035681 Vali Loss: 0.3806672 Test Loss: 0.5467947
Validation loss decreased (0.451016 --> 0.380667).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 9 cost time: 0.8776381015777588
Epoch: 9, Steps: 64 | Train Loss: 0.1852193 Vali Loss: 0.3338602 Test Loss: 0.4713494
Validation loss decreased (0.380667 --> 0.333860).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 10 cost time: 0.8864219188690186
Epoch: 10, Steps: 64 | Train Loss: 0.1706750 Vali Loss: 0.3043273 Test Loss: 0.4231362
Validation loss decreased (0.333860 --> 0.304327).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 11 cost time: 0.8942544460296631
Epoch: 11, Steps: 64 | Train Loss: 0.1605321 Vali Loss: 0.2807767 Test Loss: 0.3858957
Validation loss decreased (0.304327 --> 0.280777).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 12 cost time: 0.9014952182769775
Epoch: 12, Steps: 64 | Train Loss: 0.1533085 Vali Loss: 0.2622304 Test Loss: 0.3604751
Validation loss decreased (0.280777 --> 0.262230).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 13 cost time: 0.886066198348999
Epoch: 13, Steps: 64 | Train Loss: 0.1482144 Vali Loss: 0.2439917 Test Loss: 0.3333451
Validation loss decreased (0.262230 --> 0.243992).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 14 cost time: 0.8860006332397461
Epoch: 14, Steps: 64 | Train Loss: 0.1445514 Vali Loss: 0.2344967 Test Loss: 0.3152007
Validation loss decreased (0.243992 --> 0.234497).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 15 cost time: 0.883624792098999
Epoch: 15, Steps: 64 | Train Loss: 0.1403682 Vali Loss: 0.2247634 Test Loss: 0.3046142
Validation loss decreased (0.234497 --> 0.224763).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 16 cost time: 0.8880205154418945
Epoch: 16, Steps: 64 | Train Loss: 0.1369242 Vali Loss: 0.2198086 Test Loss: 0.2947267
Validation loss decreased (0.224763 --> 0.219809).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 17 cost time: 0.87587571144104
Epoch: 17, Steps: 64 | Train Loss: 0.1361265 Vali Loss: 0.2141927 Test Loss: 0.2870819
Validation loss decreased (0.219809 --> 0.214193).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 18 cost time: 0.8764212131500244
Epoch: 18, Steps: 64 | Train Loss: 0.1338894 Vali Loss: 0.2100858 Test Loss: 0.2813745
Validation loss decreased (0.214193 --> 0.210086).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 19 cost time: 0.8917427062988281
Epoch: 19, Steps: 64 | Train Loss: 0.1328802 Vali Loss: 0.2053818 Test Loss: 0.2760739
Validation loss decreased (0.210086 --> 0.205382).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 20 cost time: 0.8930003643035889
Epoch: 20, Steps: 64 | Train Loss: 0.1315214 Vali Loss: 0.2045148 Test Loss: 0.2709225
Validation loss decreased (0.205382 --> 0.204515).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 21 cost time: 0.8900010585784912
Epoch: 21, Steps: 64 | Train Loss: 0.1309779 Vali Loss: 0.2019815 Test Loss: 0.2678049
Validation loss decreased (0.204515 --> 0.201981).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 22 cost time: 0.8866231441497803
Epoch: 22, Steps: 64 | Train Loss: 0.1297083 Vali Loss: 0.1996576 Test Loss: 0.2645504
Validation loss decreased (0.201981 --> 0.199658).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 23 cost time: 0.8754360675811768
Epoch: 23, Steps: 64 | Train Loss: 0.1290375 Vali Loss: 0.1962954 Test Loss: 0.2600808
Validation loss decreased (0.199658 --> 0.196295).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 24 cost time: 0.8713970184326172
Epoch: 24, Steps: 64 | Train Loss: 0.1282345 Vali Loss: 0.1957044 Test Loss: 0.2602773
Validation loss decreased (0.196295 --> 0.195704).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 25 cost time: 0.8677389621734619
Epoch: 25, Steps: 64 | Train Loss: 0.1281936 Vali Loss: 0.1941711 Test Loss: 0.2562556
Validation loss decreased (0.195704 --> 0.194171).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 26 cost time: 0.8631243705749512
Epoch: 26, Steps: 64 | Train Loss: 0.1273934 Vali Loss: 0.1926911 Test Loss: 0.2559470
Validation loss decreased (0.194171 --> 0.192691).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 27 cost time: 0.8668012619018555
Epoch: 27, Steps: 64 | Train Loss: 0.1265910 Vali Loss: 0.1904600 Test Loss: 0.2539463
Validation loss decreased (0.192691 --> 0.190460).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 28 cost time: 0.8796601295471191
Epoch: 28, Steps: 64 | Train Loss: 0.1268344 Vali Loss: 0.1925926 Test Loss: 0.2543654
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 29 cost time: 0.8813889026641846
Epoch: 29, Steps: 64 | Train Loss: 0.1266331 Vali Loss: 0.1909450 Test Loss: 0.2529536
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 30 cost time: 0.8873143196105957
Epoch: 30, Steps: 64 | Train Loss: 0.1262815 Vali Loss: 0.1906418 Test Loss: 0.2525957
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 31 cost time: 0.885343074798584
Epoch: 31, Steps: 64 | Train Loss: 0.1255307 Vali Loss: 0.1883573 Test Loss: 0.2513178
Validation loss decreased (0.190460 --> 0.188357).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 32 cost time: 0.8768205642700195
Epoch: 32, Steps: 64 | Train Loss: 0.1257058 Vali Loss: 0.1885882 Test Loss: 0.2504550
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 33 cost time: 0.874000072479248
Epoch: 33, Steps: 64 | Train Loss: 0.1252963 Vali Loss: 0.1870203 Test Loss: 0.2491752
Validation loss decreased (0.188357 --> 0.187020).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 34 cost time: 0.8746263980865479
Epoch: 34, Steps: 64 | Train Loss: 0.1253642 Vali Loss: 0.1879867 Test Loss: 0.2493707
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 35 cost time: 0.8783888816833496
Epoch: 35, Steps: 64 | Train Loss: 0.1250439 Vali Loss: 0.1876693 Test Loss: 0.2487973
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 36 cost time: 0.8793675899505615
Epoch: 36, Steps: 64 | Train Loss: 0.1252486 Vali Loss: 0.1872846 Test Loss: 0.2484502
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 37 cost time: 0.8893296718597412
Epoch: 37, Steps: 64 | Train Loss: 0.1248259 Vali Loss: 0.1875672 Test Loss: 0.2454664
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 38 cost time: 0.8779997825622559
Epoch: 38, Steps: 64 | Train Loss: 0.1245575 Vali Loss: 0.1872828 Test Loss: 0.2473544
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 39 cost time: 0.8834147453308105
Epoch: 39, Steps: 64 | Train Loss: 0.1240254 Vali Loss: 0.1860483 Test Loss: 0.2482275
Validation loss decreased (0.187020 --> 0.186048).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 40 cost time: 0.8816113471984863
Epoch: 40, Steps: 64 | Train Loss: 0.1242122 Vali Loss: 0.1843949 Test Loss: 0.2471058
Validation loss decreased (0.186048 --> 0.184395).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 41 cost time: 0.8813683986663818
Epoch: 41, Steps: 64 | Train Loss: 0.1234747 Vali Loss: 0.1858188 Test Loss: 0.2472685
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 42 cost time: 0.873403787612915
Epoch: 42, Steps: 64 | Train Loss: 0.1237956 Vali Loss: 0.1846514 Test Loss: 0.2457345
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 43 cost time: 0.8804001808166504
Epoch: 43, Steps: 64 | Train Loss: 0.1242048 Vali Loss: 0.1848120 Test Loss: 0.2455422
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 44 cost time: 0.8766272068023682
Epoch: 44, Steps: 64 | Train Loss: 0.1248786 Vali Loss: 0.1850981 Test Loss: 0.2454294
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 45 cost time: 0.8840000629425049
Epoch: 45, Steps: 64 | Train Loss: 0.1240324 Vali Loss: 0.1844311 Test Loss: 0.2449399
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 46 cost time: 0.8816125392913818
Epoch: 46, Steps: 64 | Train Loss: 0.1241588 Vali Loss: 0.1841678 Test Loss: 0.2447076
Validation loss decreased (0.184395 --> 0.184168).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 47 cost time: 0.8810057640075684
Epoch: 47, Steps: 64 | Train Loss: 0.1233692 Vali Loss: 0.1852631 Test Loss: 0.2458524
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 48 cost time: 0.8893716335296631
Epoch: 48, Steps: 64 | Train Loss: 0.1237942 Vali Loss: 0.1834332 Test Loss: 0.2442246
Validation loss decreased (0.184168 --> 0.183433).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 49 cost time: 0.8803627490997314
Epoch: 49, Steps: 64 | Train Loss: 0.1237098 Vali Loss: 0.1852972 Test Loss: 0.2444700
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 50 cost time: 0.8787846565246582
Epoch: 50, Steps: 64 | Train Loss: 0.1233838 Vali Loss: 0.1849308 Test Loss: 0.2455967
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 51 cost time: 0.8789999485015869
Epoch: 51, Steps: 64 | Train Loss: 0.1234135 Vali Loss: 0.1837468 Test Loss: 0.2444954
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 52 cost time: 0.8654031753540039
Epoch: 52, Steps: 64 | Train Loss: 0.1237232 Vali Loss: 0.1845800 Test Loss: 0.2432149
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 53 cost time: 0.8804175853729248
Epoch: 53, Steps: 64 | Train Loss: 0.1234018 Vali Loss: 0.1850183 Test Loss: 0.2448279
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 54 cost time: 0.8854854106903076
Epoch: 54, Steps: 64 | Train Loss: 0.1229921 Vali Loss: 0.1856153 Test Loss: 0.2442636
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 55 cost time: 0.896024227142334
Epoch: 55, Steps: 64 | Train Loss: 0.1233129 Vali Loss: 0.1845539 Test Loss: 0.2428937
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 56 cost time: 0.8810000419616699
Epoch: 56, Steps: 64 | Train Loss: 0.1232693 Vali Loss: 0.1841283 Test Loss: 0.2441780
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 57 cost time: 0.8863837718963623
Epoch: 57, Steps: 64 | Train Loss: 0.1239769 Vali Loss: 0.1842221 Test Loss: 0.2428942
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 58 cost time: 0.8856549263000488
Epoch: 58, Steps: 64 | Train Loss: 0.1234263 Vali Loss: 0.1853677 Test Loss: 0.2449024
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 59 cost time: 0.8839998245239258
Epoch: 59, Steps: 64 | Train Loss: 0.1237027 Vali Loss: 0.1845761 Test Loss: 0.2429985
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 60 cost time: 0.8810689449310303
Epoch: 60, Steps: 64 | Train Loss: 0.1231883 Vali Loss: 0.1832264 Test Loss: 0.2434964
Validation loss decreased (0.183433 --> 0.183226).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.24349644780158997, mae:0.36328306794166565, rse:0.2500808537006378
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06063699722290039 GB
Epoch: 1 cost time: 2.255574941635132
Epoch: 1, Steps: 64 | Train Loss: 0.9112037 Vali Loss: 2.4443603 Test Loss: 3.9038820
Validation loss decreased (inf --> 2.444360).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 2 cost time: 0.9274177551269531
Epoch: 2, Steps: 64 | Train Loss: 0.6003075 Vali Loss: 0.5769820 Test Loss: 0.8588151
Validation loss decreased (2.444360 --> 0.576982).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 3 cost time: 0.9176311492919922
Epoch: 3, Steps: 64 | Train Loss: 0.1889183 Vali Loss: 0.1940190 Test Loss: 0.2243991
Validation loss decreased (0.576982 --> 0.194019).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 4 cost time: 0.9178526401519775
Epoch: 4, Steps: 64 | Train Loss: 0.1415874 Vali Loss: 0.1920583 Test Loss: 0.2420995
Validation loss decreased (0.194019 --> 0.192058).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 5 cost time: 0.9156146049499512
Epoch: 5, Steps: 64 | Train Loss: 0.1349401 Vali Loss: 0.1820712 Test Loss: 0.2319388
Validation loss decreased (0.192058 --> 0.182071).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 6 cost time: 0.8996145725250244
Epoch: 6, Steps: 64 | Train Loss: 0.1303240 Vali Loss: 0.1789902 Test Loss: 0.2271669
Validation loss decreased (0.182071 --> 0.178990).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 7 cost time: 0.9150857925415039
Epoch: 7, Steps: 64 | Train Loss: 0.1274674 Vali Loss: 0.1760837 Test Loss: 0.2313556
Validation loss decreased (0.178990 --> 0.176084).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 8 cost time: 0.9153809547424316
Epoch: 8, Steps: 64 | Train Loss: 0.1250406 Vali Loss: 0.1744448 Test Loss: 0.2306030
Validation loss decreased (0.176084 --> 0.174445).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 9 cost time: 0.9124064445495605
Epoch: 9, Steps: 64 | Train Loss: 0.1234217 Vali Loss: 0.1733304 Test Loss: 0.2287650
Validation loss decreased (0.174445 --> 0.173330).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 10 cost time: 0.9197542667388916
Epoch: 10, Steps: 64 | Train Loss: 0.1216945 Vali Loss: 0.1729923 Test Loss: 0.2293465
Validation loss decreased (0.173330 --> 0.172992).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 11 cost time: 0.9190001487731934
Epoch: 11, Steps: 64 | Train Loss: 0.1201407 Vali Loss: 0.1742057 Test Loss: 0.2303937
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 12 cost time: 0.9166252613067627
Epoch: 12, Steps: 64 | Train Loss: 0.1183755 Vali Loss: 0.1737614 Test Loss: 0.2289008
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 13 cost time: 0.9286463260650635
Epoch: 13, Steps: 64 | Train Loss: 0.1176997 Vali Loss: 0.1721592 Test Loss: 0.2294742
Validation loss decreased (0.172992 --> 0.172159).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 14 cost time: 0.9183495044708252
Epoch: 14, Steps: 64 | Train Loss: 0.1166543 Vali Loss: 0.1725349 Test Loss: 0.2329605
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 15 cost time: 0.9123408794403076
Epoch: 15, Steps: 64 | Train Loss: 0.1157984 Vali Loss: 0.1722089 Test Loss: 0.2315604
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 16 cost time: 0.9227941036224365
Epoch: 16, Steps: 64 | Train Loss: 0.1148346 Vali Loss: 0.1722739 Test Loss: 0.2373056
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 17 cost time: 0.9127659797668457
Epoch: 17, Steps: 64 | Train Loss: 0.1148430 Vali Loss: 0.1723494 Test Loss: 0.2360443
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 18 cost time: 0.9219987392425537
Epoch: 18, Steps: 64 | Train Loss: 0.1132981 Vali Loss: 0.1708169 Test Loss: 0.2367555
Validation loss decreased (0.172159 --> 0.170817).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 19 cost time: 0.9150004386901855
Epoch: 19, Steps: 64 | Train Loss: 0.1129932 Vali Loss: 0.1720600 Test Loss: 0.2387231
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 20 cost time: 0.918971061706543
Epoch: 20, Steps: 64 | Train Loss: 0.1130732 Vali Loss: 0.1720060 Test Loss: 0.2378082
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 21 cost time: 0.9209773540496826
Epoch: 21, Steps: 64 | Train Loss: 0.1128481 Vali Loss: 0.1712817 Test Loss: 0.2405044
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 22 cost time: 0.9154210090637207
Epoch: 22, Steps: 64 | Train Loss: 0.1110596 Vali Loss: 0.1725560 Test Loss: 0.2407281
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 23 cost time: 0.9154834747314453
Epoch: 23, Steps: 64 | Train Loss: 0.1123433 Vali Loss: 0.1719326 Test Loss: 0.2406932
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 24 cost time: 0.9124448299407959
Epoch: 24, Steps: 64 | Train Loss: 0.1115000 Vali Loss: 0.1717581 Test Loss: 0.2422456
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 25 cost time: 0.9117560386657715
Epoch: 25, Steps: 64 | Train Loss: 0.1107478 Vali Loss: 0.1720227 Test Loss: 0.2424573
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 26 cost time: 0.9079997539520264
Epoch: 26, Steps: 64 | Train Loss: 0.1108041 Vali Loss: 0.1717438 Test Loss: 0.2432795
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 27 cost time: 0.9116322994232178
Epoch: 27, Steps: 64 | Train Loss: 0.1112030 Vali Loss: 0.1730680 Test Loss: 0.2432040
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 28 cost time: 0.9196348190307617
Epoch: 28, Steps: 64 | Train Loss: 0.1104792 Vali Loss: 0.1728151 Test Loss: 0.2442081
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 29 cost time: 0.9170095920562744
Epoch: 29, Steps: 64 | Train Loss: 0.1101393 Vali Loss: 0.1736020 Test Loss: 0.2441916
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 30 cost time: 0.9284927845001221
Epoch: 30, Steps: 64 | Train Loss: 0.1101246 Vali Loss: 0.1727246 Test Loss: 0.2447062
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 31 cost time: 0.9110622406005859
Epoch: 31, Steps: 64 | Train Loss: 0.1110422 Vali Loss: 0.1731779 Test Loss: 0.2462347
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 32 cost time: 0.9097254276275635
Epoch: 32, Steps: 64 | Train Loss: 0.1104765 Vali Loss: 0.1729277 Test Loss: 0.2438810
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 33 cost time: 0.9222233295440674
Epoch: 33, Steps: 64 | Train Loss: 0.1099124 Vali Loss: 0.1734008 Test Loss: 0.2459031
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 34 cost time: 0.9139995574951172
Epoch: 34, Steps: 64 | Train Loss: 0.1096855 Vali Loss: 0.1727235 Test Loss: 0.2458210
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 35 cost time: 0.916618824005127
Epoch: 35, Steps: 64 | Train Loss: 0.1093762 Vali Loss: 0.1744681 Test Loss: 0.2468025
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 36 cost time: 0.9163355827331543
Epoch: 36, Steps: 64 | Train Loss: 0.1092980 Vali Loss: 0.1720591 Test Loss: 0.2454205
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 37 cost time: 0.9273879528045654
Epoch: 37, Steps: 64 | Train Loss: 0.1098767 Vali Loss: 0.1737683 Test Loss: 0.2466101
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 38 cost time: 0.9203619956970215
Epoch: 38, Steps: 64 | Train Loss: 0.1089826 Vali Loss: 0.1735345 Test Loss: 0.2477017
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 39 cost time: 0.9143517017364502
Epoch: 39, Steps: 64 | Train Loss: 0.1095626 Vali Loss: 0.1743923 Test Loss: 0.2471950
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 40 cost time: 0.9247446060180664
Epoch: 40, Steps: 64 | Train Loss: 0.1090890 Vali Loss: 0.1736383 Test Loss: 0.2473036
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 41 cost time: 0.9133443832397461
Epoch: 41, Steps: 64 | Train Loss: 0.1087816 Vali Loss: 0.1728563 Test Loss: 0.2475224
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 42 cost time: 0.914621114730835
Epoch: 42, Steps: 64 | Train Loss: 0.1090524 Vali Loss: 0.1733666 Test Loss: 0.2471697
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 43 cost time: 0.9166173934936523
Epoch: 43, Steps: 64 | Train Loss: 0.1089111 Vali Loss: 0.1753280 Test Loss: 0.2483715
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 44 cost time: 0.9313638210296631
Epoch: 44, Steps: 64 | Train Loss: 0.1090838 Vali Loss: 0.1732569 Test Loss: 0.2474778
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 45 cost time: 0.9173810482025146
Epoch: 45, Steps: 64 | Train Loss: 0.1091383 Vali Loss: 0.1729691 Test Loss: 0.2460318
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 46 cost time: 0.9203717708587646
Epoch: 46, Steps: 64 | Train Loss: 0.1093691 Vali Loss: 0.1724363 Test Loss: 0.2468740
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 47 cost time: 0.9243614673614502
Epoch: 47, Steps: 64 | Train Loss: 0.1089070 Vali Loss: 0.1731395 Test Loss: 0.2480280
EarlyStopping counter: 29 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 48 cost time: 0.9120504856109619
Epoch: 48, Steps: 64 | Train Loss: 0.1095634 Vali Loss: 0.1729604 Test Loss: 0.2477268
EarlyStopping counter: 30 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 49 cost time: 0.9099979400634766
Epoch: 49, Steps: 64 | Train Loss: 0.1090900 Vali Loss: 0.1729030 Test Loss: 0.2479360
EarlyStopping counter: 31 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 50 cost time: 0.9176352024078369
Epoch: 50, Steps: 64 | Train Loss: 0.1089714 Vali Loss: 0.1738060 Test Loss: 0.2479361
EarlyStopping counter: 32 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 51 cost time: 0.9079859256744385
Epoch: 51, Steps: 64 | Train Loss: 0.1091065 Vali Loss: 0.1716886 Test Loss: 0.2485276
EarlyStopping counter: 33 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 52 cost time: 0.9153499603271484
Epoch: 52, Steps: 64 | Train Loss: 0.1087321 Vali Loss: 0.1727116 Test Loss: 0.2472536
EarlyStopping counter: 34 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 53 cost time: 0.9153778553009033
Epoch: 53, Steps: 64 | Train Loss: 0.1089743 Vali Loss: 0.1726876 Test Loss: 0.2476024
EarlyStopping counter: 35 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 54 cost time: 0.9180090427398682
Epoch: 54, Steps: 64 | Train Loss: 0.1090859 Vali Loss: 0.1742012 Test Loss: 0.2492375
EarlyStopping counter: 36 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 55 cost time: 0.9137792587280273
Epoch: 55, Steps: 64 | Train Loss: 0.1090294 Vali Loss: 0.1720825 Test Loss: 0.2461441
EarlyStopping counter: 37 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 56 cost time: 0.9149978160858154
Epoch: 56, Steps: 64 | Train Loss: 0.1092047 Vali Loss: 0.1724145 Test Loss: 0.2473180
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 57 cost time: 0.9126083850860596
Epoch: 57, Steps: 64 | Train Loss: 0.1093516 Vali Loss: 0.1735091 Test Loss: 0.2488969
EarlyStopping counter: 39 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 58 cost time: 0.9077906608581543
Epoch: 58, Steps: 64 | Train Loss: 0.1091298 Vali Loss: 0.1752362 Test Loss: 0.2483258
EarlyStopping counter: 40 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 59 cost time: 0.9123849868774414
Epoch: 59, Steps: 64 | Train Loss: 0.1093358 Vali Loss: 0.1731996 Test Loss: 0.2473959
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 60 cost time: 0.9116606712341309
Epoch: 60, Steps: 64 | Train Loss: 0.1090024 Vali Loss: 0.1729555 Test Loss: 0.2471387
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23675552010536194, mae:0.3593546748161316, rse:0.24659496545791626
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06383180618286133 GB
Epoch: 1 cost time: 2.2828872203826904
Epoch: 1, Steps: 64 | Train Loss: 0.8465217 Vali Loss: 2.2930963 Test Loss: 3.6176522
Validation loss decreased (inf --> 2.293096).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 2 cost time: 0.9477822780609131
Epoch: 2, Steps: 64 | Train Loss: 0.4696709 Vali Loss: 0.2137111 Test Loss: 0.2479402
Validation loss decreased (2.293096 --> 0.213711).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 3 cost time: 0.9384148120880127
Epoch: 3, Steps: 64 | Train Loss: 0.1585960 Vali Loss: 0.2101998 Test Loss: 0.2671652
Validation loss decreased (0.213711 --> 0.210200).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 4 cost time: 0.9520001411437988
Epoch: 4, Steps: 64 | Train Loss: 0.1394534 Vali Loss: 0.1883903 Test Loss: 0.2356573
Validation loss decreased (0.210200 --> 0.188390).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 5 cost time: 1.0159995555877686
Epoch: 5, Steps: 64 | Train Loss: 0.1323883 Vali Loss: 0.1855958 Test Loss: 0.2349755
Validation loss decreased (0.188390 --> 0.185596).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 6 cost time: 0.9396498203277588
Epoch: 6, Steps: 64 | Train Loss: 0.1288343 Vali Loss: 0.1814376 Test Loss: 0.2326025
Validation loss decreased (0.185596 --> 0.181438).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 7 cost time: 0.9400372505187988
Epoch: 7, Steps: 64 | Train Loss: 0.1252461 Vali Loss: 0.1782985 Test Loss: 0.2340115
Validation loss decreased (0.181438 --> 0.178298).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 8 cost time: 0.9297409057617188
Epoch: 8, Steps: 64 | Train Loss: 0.1233085 Vali Loss: 0.1801150 Test Loss: 0.2329958
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 9 cost time: 0.9391329288482666
Epoch: 9, Steps: 64 | Train Loss: 0.1211968 Vali Loss: 0.1760257 Test Loss: 0.2378514
Validation loss decreased (0.178298 --> 0.176026).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 10 cost time: 0.9422099590301514
Epoch: 10, Steps: 64 | Train Loss: 0.1194698 Vali Loss: 0.1774061 Test Loss: 0.2389921
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 11 cost time: 0.9538273811340332
Epoch: 11, Steps: 64 | Train Loss: 0.1187368 Vali Loss: 0.1760470 Test Loss: 0.2390661
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 12 cost time: 0.9544162750244141
Epoch: 12, Steps: 64 | Train Loss: 0.1169572 Vali Loss: 0.1782102 Test Loss: 0.2422163
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 13 cost time: 0.9516668319702148
Epoch: 13, Steps: 64 | Train Loss: 0.1159738 Vali Loss: 0.1774594 Test Loss: 0.2431273
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 14 cost time: 0.9567396640777588
Epoch: 14, Steps: 64 | Train Loss: 0.1155586 Vali Loss: 0.1771655 Test Loss: 0.2451034
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 15 cost time: 0.9447853565216064
Epoch: 15, Steps: 64 | Train Loss: 0.1148556 Vali Loss: 0.1780951 Test Loss: 0.2469360
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 16 cost time: 0.949620246887207
Epoch: 16, Steps: 64 | Train Loss: 0.1140182 Vali Loss: 0.1776223 Test Loss: 0.2462171
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 17 cost time: 0.9446213245391846
Epoch: 17, Steps: 64 | Train Loss: 0.1131855 Vali Loss: 0.1764261 Test Loss: 0.2465228
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 18 cost time: 0.9573843479156494
Epoch: 18, Steps: 64 | Train Loss: 0.1127068 Vali Loss: 0.1790457 Test Loss: 0.2507171
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 19 cost time: 0.9543623924255371
Epoch: 19, Steps: 64 | Train Loss: 0.1118561 Vali Loss: 0.1768831 Test Loss: 0.2505341
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 20 cost time: 0.9429886341094971
Epoch: 20, Steps: 64 | Train Loss: 0.1125885 Vali Loss: 0.1795496 Test Loss: 0.2501345
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 21 cost time: 0.9544734954833984
Epoch: 21, Steps: 64 | Train Loss: 0.1114000 Vali Loss: 0.1787213 Test Loss: 0.2507072
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 22 cost time: 0.937370777130127
Epoch: 22, Steps: 64 | Train Loss: 0.1113535 Vali Loss: 0.1800009 Test Loss: 0.2523914
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 23 cost time: 0.931746244430542
Epoch: 23, Steps: 64 | Train Loss: 0.1109952 Vali Loss: 0.1768614 Test Loss: 0.2507498
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 24 cost time: 0.9444112777709961
Epoch: 24, Steps: 64 | Train Loss: 0.1107732 Vali Loss: 0.1783456 Test Loss: 0.2507574
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 25 cost time: 0.9154195785522461
Epoch: 25, Steps: 64 | Train Loss: 0.1113659 Vali Loss: 0.1802679 Test Loss: 0.2525094
EarlyStopping counter: 16 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 26 cost time: 0.9476127624511719
Epoch: 26, Steps: 64 | Train Loss: 0.1100963 Vali Loss: 0.1791565 Test Loss: 0.2548097
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 27 cost time: 0.9363763332366943
Epoch: 27, Steps: 64 | Train Loss: 0.1107905 Vali Loss: 0.1782264 Test Loss: 0.2516587
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 28 cost time: 0.9283461570739746
Epoch: 28, Steps: 64 | Train Loss: 0.1102258 Vali Loss: 0.1797029 Test Loss: 0.2541400
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 29 cost time: 0.9359691143035889
Epoch: 29, Steps: 64 | Train Loss: 0.1094370 Vali Loss: 0.1789210 Test Loss: 0.2531585
EarlyStopping counter: 20 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 30 cost time: 0.9314060211181641
Epoch: 30, Steps: 64 | Train Loss: 0.1103134 Vali Loss: 0.1794940 Test Loss: 0.2545803
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 31 cost time: 0.9343862533569336
Epoch: 31, Steps: 64 | Train Loss: 0.1095228 Vali Loss: 0.1811996 Test Loss: 0.2566366
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 32 cost time: 0.9318115711212158
Epoch: 32, Steps: 64 | Train Loss: 0.1094309 Vali Loss: 0.1808027 Test Loss: 0.2551032
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 33 cost time: 0.9283714294433594
Epoch: 33, Steps: 64 | Train Loss: 0.1095604 Vali Loss: 0.1809095 Test Loss: 0.2568277
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 34 cost time: 0.9356193542480469
Epoch: 34, Steps: 64 | Train Loss: 0.1093512 Vali Loss: 0.1813438 Test Loss: 0.2565915
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 35 cost time: 0.9373435974121094
Epoch: 35, Steps: 64 | Train Loss: 0.1091399 Vali Loss: 0.1811918 Test Loss: 0.2568593
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 36 cost time: 0.9363505840301514
Epoch: 36, Steps: 64 | Train Loss: 0.1092911 Vali Loss: 0.1799344 Test Loss: 0.2566674
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 37 cost time: 0.9383296966552734
Epoch: 37, Steps: 64 | Train Loss: 0.1089327 Vali Loss: 0.1798685 Test Loss: 0.2563739
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 38 cost time: 0.9435083866119385
Epoch: 38, Steps: 64 | Train Loss: 0.1090696 Vali Loss: 0.1801470 Test Loss: 0.2578523
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 39 cost time: 0.9283428192138672
Epoch: 39, Steps: 64 | Train Loss: 0.1093865 Vali Loss: 0.1805966 Test Loss: 0.2563117
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 40 cost time: 0.9327547550201416
Epoch: 40, Steps: 64 | Train Loss: 0.1086913 Vali Loss: 0.1813713 Test Loss: 0.2551510
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 41 cost time: 0.9411418437957764
Epoch: 41, Steps: 64 | Train Loss: 0.1089532 Vali Loss: 0.1783586 Test Loss: 0.2554752
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 42 cost time: 0.9370017051696777
Epoch: 42, Steps: 64 | Train Loss: 0.1087306 Vali Loss: 0.1803118 Test Loss: 0.2560912
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 43 cost time: 0.9326157569885254
Epoch: 43, Steps: 64 | Train Loss: 0.1087969 Vali Loss: 0.1817235 Test Loss: 0.2573197
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 44 cost time: 0.9349348545074463
Epoch: 44, Steps: 64 | Train Loss: 0.1084641 Vali Loss: 0.1805648 Test Loss: 0.2559159
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 45 cost time: 0.923025369644165
Epoch: 45, Steps: 64 | Train Loss: 0.1085768 Vali Loss: 0.1786152 Test Loss: 0.2555867
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 46 cost time: 0.9406471252441406
Epoch: 46, Steps: 64 | Train Loss: 0.1087920 Vali Loss: 0.1814631 Test Loss: 0.2563410
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 47 cost time: 0.939455509185791
Epoch: 47, Steps: 64 | Train Loss: 0.1092015 Vali Loss: 0.1796227 Test Loss: 0.2549314
EarlyStopping counter: 38 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 48 cost time: 0.930769681930542
Epoch: 48, Steps: 64 | Train Loss: 0.1084126 Vali Loss: 0.1815681 Test Loss: 0.2565459
EarlyStopping counter: 39 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 49 cost time: 0.9104824066162109
Epoch: 49, Steps: 64 | Train Loss: 0.1088815 Vali Loss: 0.1828615 Test Loss: 0.2562811
EarlyStopping counter: 40 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 50 cost time: 0.9330005645751953
Epoch: 50, Steps: 64 | Train Loss: 0.1088060 Vali Loss: 0.1824457 Test Loss: 0.2570411
EarlyStopping counter: 41 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 51 cost time: 0.9483973979949951
Epoch: 51, Steps: 64 | Train Loss: 0.1085211 Vali Loss: 0.1834585 Test Loss: 0.2584354
EarlyStopping counter: 42 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 52 cost time: 0.9426202774047852
Epoch: 52, Steps: 64 | Train Loss: 0.1086802 Vali Loss: 0.1817345 Test Loss: 0.2567069
EarlyStopping counter: 43 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 53 cost time: 0.935366153717041
Epoch: 53, Steps: 64 | Train Loss: 0.1087738 Vali Loss: 0.1798447 Test Loss: 0.2559929
EarlyStopping counter: 44 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 54 cost time: 0.9369964599609375
Epoch: 54, Steps: 64 | Train Loss: 0.1087701 Vali Loss: 0.1799695 Test Loss: 0.2565135
EarlyStopping counter: 45 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 55 cost time: 0.9394159317016602
Epoch: 55, Steps: 64 | Train Loss: 0.1086391 Vali Loss: 0.1811520 Test Loss: 0.2579461
EarlyStopping counter: 46 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 56 cost time: 0.9284818172454834
Epoch: 56, Steps: 64 | Train Loss: 0.1084183 Vali Loss: 0.1815178 Test Loss: 0.2571669
EarlyStopping counter: 47 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 57 cost time: 0.9283473491668701
Epoch: 57, Steps: 64 | Train Loss: 0.1089242 Vali Loss: 0.1792005 Test Loss: 0.2561712
EarlyStopping counter: 48 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 58 cost time: 0.9403398036956787
Epoch: 58, Steps: 64 | Train Loss: 0.1082188 Vali Loss: 0.1811500 Test Loss: 0.2560269
EarlyStopping counter: 49 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 59 cost time: 0.9440000057220459
Epoch: 59, Steps: 64 | Train Loss: 0.1086242 Vali Loss: 0.1809928 Test Loss: 0.2557726
EarlyStopping counter: 50 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 60 cost time: 0.9366250038146973
Epoch: 60, Steps: 64 | Train Loss: 0.1087583 Vali Loss: 0.1802452 Test Loss: 0.2565040
EarlyStopping counter: 51 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23785139620304108, mae:0.3614186644554138, rse:0.2471650093793869
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.05765199661254883 GB
Epoch: 1 cost time: 2.235994815826416
Epoch: 1, Steps: 64 | Train Loss: 0.9645546 Vali Loss: 2.5119839 Test Loss: 4.0369706
Validation loss decreased (inf --> 2.511984).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 2 cost time: 0.8790614604949951
Epoch: 2, Steps: 64 | Train Loss: 0.7450404 Vali Loss: 1.3690126 Test Loss: 2.1358516
Validation loss decreased (2.511984 --> 1.369013).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 3 cost time: 0.8787627220153809
Epoch: 3, Steps: 64 | Train Loss: 0.4960667 Vali Loss: 1.0048193 Test Loss: 1.5445917
Validation loss decreased (1.369013 --> 1.004819).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 4 cost time: 0.8849577903747559
Epoch: 4, Steps: 64 | Train Loss: 0.3740908 Vali Loss: 0.7549191 Test Loss: 1.1456860
Validation loss decreased (1.004819 --> 0.754919).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 5 cost time: 0.8777458667755127
Epoch: 5, Steps: 64 | Train Loss: 0.2946083 Vali Loss: 0.5882399 Test Loss: 0.8830514
Validation loss decreased (0.754919 --> 0.588240).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 6 cost time: 0.8739993572235107
Epoch: 6, Steps: 64 | Train Loss: 0.2431287 Vali Loss: 0.4656084 Test Loss: 0.6965531
Validation loss decreased (0.588240 --> 0.465608).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 7 cost time: 0.8689756393432617
Epoch: 7, Steps: 64 | Train Loss: 0.2082384 Vali Loss: 0.3884581 Test Loss: 0.5715768
Validation loss decreased (0.465608 --> 0.388458).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 8 cost time: 0.8784010410308838
Epoch: 8, Steps: 64 | Train Loss: 0.1862696 Vali Loss: 0.3348110 Test Loss: 0.4846695
Validation loss decreased (0.388458 --> 0.334811).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 9 cost time: 0.8664588928222656
Epoch: 9, Steps: 64 | Train Loss: 0.1701282 Vali Loss: 0.2942981 Test Loss: 0.4200044
Validation loss decreased (0.334811 --> 0.294298).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 10 cost time: 0.8803482055664062
Epoch: 10, Steps: 64 | Train Loss: 0.1574075 Vali Loss: 0.2676862 Test Loss: 0.3770270
Validation loss decreased (0.294298 --> 0.267686).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 11 cost time: 0.8807332515716553
Epoch: 11, Steps: 64 | Train Loss: 0.1496353 Vali Loss: 0.2501486 Test Loss: 0.3466155
Validation loss decreased (0.267686 --> 0.250149).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 12 cost time: 0.895000696182251
Epoch: 12, Steps: 64 | Train Loss: 0.1445046 Vali Loss: 0.2311419 Test Loss: 0.3199624
Validation loss decreased (0.250149 --> 0.231142).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 13 cost time: 0.8826525211334229
Epoch: 13, Steps: 64 | Train Loss: 0.1391714 Vali Loss: 0.2219879 Test Loss: 0.3047705
Validation loss decreased (0.231142 --> 0.221988).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 14 cost time: 0.883399248123169
Epoch: 14, Steps: 64 | Train Loss: 0.1358417 Vali Loss: 0.2158217 Test Loss: 0.2922309
Validation loss decreased (0.221988 --> 0.215822).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 15 cost time: 0.8704719543457031
Epoch: 15, Steps: 64 | Train Loss: 0.1327734 Vali Loss: 0.2073506 Test Loss: 0.2792393
Validation loss decreased (0.215822 --> 0.207351).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 16 cost time: 0.8809866905212402
Epoch: 16, Steps: 64 | Train Loss: 0.1311531 Vali Loss: 0.2030381 Test Loss: 0.2728155
Validation loss decreased (0.207351 --> 0.203038).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 17 cost time: 0.875739336013794
Epoch: 17, Steps: 64 | Train Loss: 0.1292637 Vali Loss: 0.1987277 Test Loss: 0.2655314
Validation loss decreased (0.203038 --> 0.198728).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 18 cost time: 0.8700006008148193
Epoch: 18, Steps: 64 | Train Loss: 0.1280078 Vali Loss: 0.1949550 Test Loss: 0.2617972
Validation loss decreased (0.198728 --> 0.194955).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 19 cost time: 0.8896198272705078
Epoch: 19, Steps: 64 | Train Loss: 0.1265388 Vali Loss: 0.1942328 Test Loss: 0.2588887
Validation loss decreased (0.194955 --> 0.194233).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 20 cost time: 0.9018471240997314
Epoch: 20, Steps: 64 | Train Loss: 0.1268840 Vali Loss: 0.1917967 Test Loss: 0.2549804
Validation loss decreased (0.194233 --> 0.191797).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 21 cost time: 0.8803448677062988
Epoch: 21, Steps: 64 | Train Loss: 0.1247985 Vali Loss: 0.1895440 Test Loss: 0.2528017
Validation loss decreased (0.191797 --> 0.189544).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 22 cost time: 0.8773674964904785
Epoch: 22, Steps: 64 | Train Loss: 0.1240718 Vali Loss: 0.1854369 Test Loss: 0.2488084
Validation loss decreased (0.189544 --> 0.185437).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 23 cost time: 0.8747696876525879
Epoch: 23, Steps: 64 | Train Loss: 0.1244552 Vali Loss: 0.1863936 Test Loss: 0.2491651
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 24 cost time: 0.8710002899169922
Epoch: 24, Steps: 64 | Train Loss: 0.1237947 Vali Loss: 0.1850188 Test Loss: 0.2448126
Validation loss decreased (0.185437 --> 0.185019).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 25 cost time: 0.8772509098052979
Epoch: 25, Steps: 64 | Train Loss: 0.1227693 Vali Loss: 0.1850695 Test Loss: 0.2436602
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 26 cost time: 0.8704473972320557
Epoch: 26, Steps: 64 | Train Loss: 0.1224853 Vali Loss: 0.1845370 Test Loss: 0.2445182
Validation loss decreased (0.185019 --> 0.184537).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 27 cost time: 0.8633463382720947
Epoch: 27, Steps: 64 | Train Loss: 0.1217864 Vali Loss: 0.1833172 Test Loss: 0.2420304
Validation loss decreased (0.184537 --> 0.183317).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 28 cost time: 0.8773624897003174
Epoch: 28, Steps: 64 | Train Loss: 0.1217498 Vali Loss: 0.1825244 Test Loss: 0.2420165
Validation loss decreased (0.183317 --> 0.182524).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 29 cost time: 0.8784923553466797
Epoch: 29, Steps: 64 | Train Loss: 0.1223083 Vali Loss: 0.1821884 Test Loss: 0.2414421
Validation loss decreased (0.182524 --> 0.182188).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 30 cost time: 0.8799989223480225
Epoch: 30, Steps: 64 | Train Loss: 0.1218191 Vali Loss: 0.1823640 Test Loss: 0.2409273
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 31 cost time: 0.8869993686676025
Epoch: 31, Steps: 64 | Train Loss: 0.1208578 Vali Loss: 0.1823034 Test Loss: 0.2408706
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 32 cost time: 0.8746185302734375
Epoch: 32, Steps: 64 | Train Loss: 0.1204569 Vali Loss: 0.1786926 Test Loss: 0.2394045
Validation loss decreased (0.182188 --> 0.178693).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 33 cost time: 0.8711893558502197
Epoch: 33, Steps: 64 | Train Loss: 0.1213554 Vali Loss: 0.1816836 Test Loss: 0.2397117
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 34 cost time: 0.8747050762176514
Epoch: 34, Steps: 64 | Train Loss: 0.1212526 Vali Loss: 0.1817260 Test Loss: 0.2401893
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 35 cost time: 0.8787000179290771
Epoch: 35, Steps: 64 | Train Loss: 0.1207093 Vali Loss: 0.1815370 Test Loss: 0.2386288
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 36 cost time: 0.8730001449584961
Epoch: 36, Steps: 64 | Train Loss: 0.1203491 Vali Loss: 0.1814263 Test Loss: 0.2389230
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 37 cost time: 0.8909997940063477
Epoch: 37, Steps: 64 | Train Loss: 0.1208096 Vali Loss: 0.1788893 Test Loss: 0.2382891
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 38 cost time: 0.8833553791046143
Epoch: 38, Steps: 64 | Train Loss: 0.1198679 Vali Loss: 0.1809625 Test Loss: 0.2388905
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 39 cost time: 0.8772444725036621
Epoch: 39, Steps: 64 | Train Loss: 0.1199582 Vali Loss: 0.1804594 Test Loss: 0.2384510
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 40 cost time: 0.8863639831542969
Epoch: 40, Steps: 64 | Train Loss: 0.1200922 Vali Loss: 0.1801305 Test Loss: 0.2375265
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 41 cost time: 0.8817143440246582
Epoch: 41, Steps: 64 | Train Loss: 0.1198901 Vali Loss: 0.1790548 Test Loss: 0.2366444
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 42 cost time: 0.8667862415313721
Epoch: 42, Steps: 64 | Train Loss: 0.1200427 Vali Loss: 0.1792093 Test Loss: 0.2361564
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 43 cost time: 0.872999906539917
Epoch: 43, Steps: 64 | Train Loss: 0.1190192 Vali Loss: 0.1781578 Test Loss: 0.2373009
Validation loss decreased (0.178693 --> 0.178158).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 44 cost time: 0.871415376663208
Epoch: 44, Steps: 64 | Train Loss: 0.1197952 Vali Loss: 0.1792753 Test Loss: 0.2373215
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 45 cost time: 0.8774089813232422
Epoch: 45, Steps: 64 | Train Loss: 0.1196897 Vali Loss: 0.1792886 Test Loss: 0.2364965
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 46 cost time: 0.876380205154419
Epoch: 46, Steps: 64 | Train Loss: 0.1192390 Vali Loss: 0.1812336 Test Loss: 0.2401416
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 47 cost time: 0.8821535110473633
Epoch: 47, Steps: 64 | Train Loss: 0.1191444 Vali Loss: 0.1786182 Test Loss: 0.2368739
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 48 cost time: 0.8779997825622559
Epoch: 48, Steps: 64 | Train Loss: 0.1195640 Vali Loss: 0.1794617 Test Loss: 0.2363235
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 49 cost time: 0.8566176891326904
Epoch: 49, Steps: 64 | Train Loss: 0.1193031 Vali Loss: 0.1799458 Test Loss: 0.2381966
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 50 cost time: 0.866466760635376
Epoch: 50, Steps: 64 | Train Loss: 0.1188277 Vali Loss: 0.1795224 Test Loss: 0.2375555
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 51 cost time: 0.8660304546356201
Epoch: 51, Steps: 64 | Train Loss: 0.1190625 Vali Loss: 0.1801156 Test Loss: 0.2362856
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 52 cost time: 0.8733711242675781
Epoch: 52, Steps: 64 | Train Loss: 0.1187305 Vali Loss: 0.1792255 Test Loss: 0.2362597
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 53 cost time: 0.869767427444458
Epoch: 53, Steps: 64 | Train Loss: 0.1197950 Vali Loss: 0.1807121 Test Loss: 0.2372228
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 54 cost time: 0.877000093460083
Epoch: 54, Steps: 64 | Train Loss: 0.1194110 Vali Loss: 0.1771296 Test Loss: 0.2362590
Validation loss decreased (0.178158 --> 0.177130).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 55 cost time: 0.888620138168335
Epoch: 55, Steps: 64 | Train Loss: 0.1198501 Vali Loss: 0.1780350 Test Loss: 0.2355215
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 56 cost time: 0.8772683143615723
Epoch: 56, Steps: 64 | Train Loss: 0.1190439 Vali Loss: 0.1792753 Test Loss: 0.2371689
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 57 cost time: 0.8773612976074219
Epoch: 57, Steps: 64 | Train Loss: 0.1193440 Vali Loss: 0.1790942 Test Loss: 0.2378300
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 58 cost time: 0.8804066181182861
Epoch: 58, Steps: 64 | Train Loss: 0.1196317 Vali Loss: 0.1791977 Test Loss: 0.2368308
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 59 cost time: 0.8817379474639893
Epoch: 59, Steps: 64 | Train Loss: 0.1183489 Vali Loss: 0.1781582 Test Loss: 0.2346119
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 60 cost time: 0.870370626449585
Epoch: 60, Steps: 64 | Train Loss: 0.1194587 Vali Loss: 0.1795083 Test Loss: 0.2364441
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23625902831554413, mae:0.3538616895675659, rse:0.24633626639842987
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06079816818237305 GB
Epoch: 1 cost time: 2.2446558475494385
Epoch: 1, Steps: 64 | Train Loss: 0.8473534 Vali Loss: 2.2482438 Test Loss: 3.5729442
Validation loss decreased (inf --> 2.248244).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 2 cost time: 0.9093680381774902
Epoch: 2, Steps: 64 | Train Loss: 0.4796593 Vali Loss: 0.3027467 Test Loss: 0.3975918
Validation loss decreased (2.248244 --> 0.302747).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 3 cost time: 0.9133646488189697
Epoch: 3, Steps: 64 | Train Loss: 0.1581203 Vali Loss: 0.1877302 Test Loss: 0.2186791
Validation loss decreased (0.302747 --> 0.187730).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 4 cost time: 0.9103877544403076
Epoch: 4, Steps: 64 | Train Loss: 0.1403642 Vali Loss: 0.1921027 Test Loss: 0.2391047
EarlyStopping counter: 1 out of 100
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 5 cost time: 0.9093785285949707
Epoch: 5, Steps: 64 | Train Loss: 0.1329051 Vali Loss: 0.1809889 Test Loss: 0.2248344
Validation loss decreased (0.187730 --> 0.180989).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 6 cost time: 0.8987164497375488
Epoch: 6, Steps: 64 | Train Loss: 0.1284829 Vali Loss: 0.1779256 Test Loss: 0.2259231
Validation loss decreased (0.180989 --> 0.177926).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 7 cost time: 0.9059996604919434
Epoch: 7, Steps: 64 | Train Loss: 0.1256504 Vali Loss: 0.1777444 Test Loss: 0.2262970
Validation loss decreased (0.177926 --> 0.177744).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 8 cost time: 0.898639440536499
Epoch: 8, Steps: 64 | Train Loss: 0.1238567 Vali Loss: 0.1765994 Test Loss: 0.2289200
Validation loss decreased (0.177744 --> 0.176599).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 9 cost time: 0.9081339836120605
Epoch: 9, Steps: 64 | Train Loss: 0.1216562 Vali Loss: 0.1769273 Test Loss: 0.2302185
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 10 cost time: 0.9123818874359131
Epoch: 10, Steps: 64 | Train Loss: 0.1207346 Vali Loss: 0.1750270 Test Loss: 0.2289919
Validation loss decreased (0.176599 --> 0.175027).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 11 cost time: 0.9094843864440918
Epoch: 11, Steps: 64 | Train Loss: 0.1188088 Vali Loss: 0.1726766 Test Loss: 0.2314005
Validation loss decreased (0.175027 --> 0.172677).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 12 cost time: 0.9133768081665039
Epoch: 12, Steps: 64 | Train Loss: 0.1175306 Vali Loss: 0.1746640 Test Loss: 0.2293569
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 13 cost time: 0.9267532825469971
Epoch: 13, Steps: 64 | Train Loss: 0.1164489 Vali Loss: 0.1731148 Test Loss: 0.2315108
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 14 cost time: 0.9006190299987793
Epoch: 14, Steps: 64 | Train Loss: 0.1161697 Vali Loss: 0.1719442 Test Loss: 0.2309119
Validation loss decreased (0.172677 --> 0.171944).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 15 cost time: 0.9030005931854248
Epoch: 15, Steps: 64 | Train Loss: 0.1158869 Vali Loss: 0.1758509 Test Loss: 0.2359364
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 16 cost time: 0.9196109771728516
Epoch: 16, Steps: 64 | Train Loss: 0.1147039 Vali Loss: 0.1744203 Test Loss: 0.2336781
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 17 cost time: 0.9023482799530029
Epoch: 17, Steps: 64 | Train Loss: 0.1144299 Vali Loss: 0.1714752 Test Loss: 0.2336700
Validation loss decreased (0.171944 --> 0.171475).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 18 cost time: 0.9043641090393066
Epoch: 18, Steps: 64 | Train Loss: 0.1131496 Vali Loss: 0.1708042 Test Loss: 0.2341713
Validation loss decreased (0.171475 --> 0.170804).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 19 cost time: 0.9154117107391357
Epoch: 19, Steps: 64 | Train Loss: 0.1132037 Vali Loss: 0.1722143 Test Loss: 0.2339573
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 20 cost time: 0.9223847389221191
Epoch: 20, Steps: 64 | Train Loss: 0.1126589 Vali Loss: 0.1689874 Test Loss: 0.2353203
Validation loss decreased (0.170804 --> 0.168987).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 21 cost time: 0.9147653579711914
Epoch: 21, Steps: 64 | Train Loss: 0.1122566 Vali Loss: 0.1717116 Test Loss: 0.2340670
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 22 cost time: 0.9063913822174072
Epoch: 22, Steps: 64 | Train Loss: 0.1120101 Vali Loss: 0.1723986 Test Loss: 0.2360509
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 23 cost time: 0.9024553298950195
Epoch: 23, Steps: 64 | Train Loss: 0.1123705 Vali Loss: 0.1729627 Test Loss: 0.2369267
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 24 cost time: 0.903449296951294
Epoch: 24, Steps: 64 | Train Loss: 0.1121845 Vali Loss: 0.1728626 Test Loss: 0.2350907
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 25 cost time: 0.8983643054962158
Epoch: 25, Steps: 64 | Train Loss: 0.1115027 Vali Loss: 0.1713711 Test Loss: 0.2371505
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 26 cost time: 0.9011962413787842
Epoch: 26, Steps: 64 | Train Loss: 0.1118476 Vali Loss: 0.1711304 Test Loss: 0.2365615
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 27 cost time: 0.8965635299682617
Epoch: 27, Steps: 64 | Train Loss: 0.1108247 Vali Loss: 0.1695099 Test Loss: 0.2369217
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 28 cost time: 0.9357080459594727
Epoch: 28, Steps: 64 | Train Loss: 0.1104073 Vali Loss: 0.1722744 Test Loss: 0.2374969
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 29 cost time: 0.9270000457763672
Epoch: 29, Steps: 64 | Train Loss: 0.1110296 Vali Loss: 0.1727450 Test Loss: 0.2376340
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 30 cost time: 0.9300000667572021
Epoch: 30, Steps: 64 | Train Loss: 0.1109966 Vali Loss: 0.1714915 Test Loss: 0.2367425
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 31 cost time: 0.9268674850463867
Epoch: 31, Steps: 64 | Train Loss: 0.1109125 Vali Loss: 0.1696098 Test Loss: 0.2376884
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 32 cost time: 0.9233732223510742
Epoch: 32, Steps: 64 | Train Loss: 0.1106177 Vali Loss: 0.1707735 Test Loss: 0.2372576
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 33 cost time: 0.922311544418335
Epoch: 33, Steps: 64 | Train Loss: 0.1106843 Vali Loss: 0.1686833 Test Loss: 0.2366862
Validation loss decreased (0.168987 --> 0.168683).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 34 cost time: 0.9145419597625732
Epoch: 34, Steps: 64 | Train Loss: 0.1101697 Vali Loss: 0.1703591 Test Loss: 0.2377127
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 35 cost time: 0.9158012866973877
Epoch: 35, Steps: 64 | Train Loss: 0.1101418 Vali Loss: 0.1706199 Test Loss: 0.2388299
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 36 cost time: 0.9151685237884521
Epoch: 36, Steps: 64 | Train Loss: 0.1103349 Vali Loss: 0.1717353 Test Loss: 0.2383204
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 37 cost time: 0.9270029067993164
Epoch: 37, Steps: 64 | Train Loss: 0.1102389 Vali Loss: 0.1693480 Test Loss: 0.2383157
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 38 cost time: 0.916602611541748
Epoch: 38, Steps: 64 | Train Loss: 0.1099551 Vali Loss: 0.1732241 Test Loss: 0.2389177
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 39 cost time: 0.9120135307312012
Epoch: 39, Steps: 64 | Train Loss: 0.1101309 Vali Loss: 0.1696768 Test Loss: 0.2379234
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 40 cost time: 0.9153542518615723
Epoch: 40, Steps: 64 | Train Loss: 0.1095277 Vali Loss: 0.1720351 Test Loss: 0.2387515
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 41 cost time: 0.9153976440429688
Epoch: 41, Steps: 64 | Train Loss: 0.1099845 Vali Loss: 0.1713595 Test Loss: 0.2392111
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 42 cost time: 0.9184041023254395
Epoch: 42, Steps: 64 | Train Loss: 0.1094438 Vali Loss: 0.1713959 Test Loss: 0.2390425
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 43 cost time: 0.9158525466918945
Epoch: 43, Steps: 64 | Train Loss: 0.1096572 Vali Loss: 0.1708871 Test Loss: 0.2393995
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 44 cost time: 0.9217288494110107
Epoch: 44, Steps: 64 | Train Loss: 0.1096088 Vali Loss: 0.1694724 Test Loss: 0.2388763
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 45 cost time: 0.9067387580871582
Epoch: 45, Steps: 64 | Train Loss: 0.1101883 Vali Loss: 0.1722672 Test Loss: 0.2394344
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 46 cost time: 0.9216127395629883
Epoch: 46, Steps: 64 | Train Loss: 0.1096613 Vali Loss: 0.1715900 Test Loss: 0.2386634
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 47 cost time: 0.9291024208068848
Epoch: 47, Steps: 64 | Train Loss: 0.1098189 Vali Loss: 0.1729350 Test Loss: 0.2393166
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 48 cost time: 0.9917149543762207
Epoch: 48, Steps: 64 | Train Loss: 0.1104601 Vali Loss: 0.1707560 Test Loss: 0.2390344
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 49 cost time: 0.9120090007781982
Epoch: 49, Steps: 64 | Train Loss: 0.1101644 Vali Loss: 0.1722545 Test Loss: 0.2396692
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 50 cost time: 0.9153969287872314
Epoch: 50, Steps: 64 | Train Loss: 0.1095697 Vali Loss: 0.1697454 Test Loss: 0.2393869
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 51 cost time: 0.9018065929412842
Epoch: 51, Steps: 64 | Train Loss: 0.1097036 Vali Loss: 0.1710373 Test Loss: 0.2389720
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 52 cost time: 0.9363038539886475
Epoch: 52, Steps: 64 | Train Loss: 0.1099959 Vali Loss: 0.1711341 Test Loss: 0.2391697
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 53 cost time: 0.9386029243469238
Epoch: 53, Steps: 64 | Train Loss: 0.1097083 Vali Loss: 0.1724351 Test Loss: 0.2391599
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 54 cost time: 0.9265999794006348
Epoch: 54, Steps: 64 | Train Loss: 0.1099235 Vali Loss: 0.1719629 Test Loss: 0.2390854
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 55 cost time: 0.9956099987030029
Epoch: 55, Steps: 64 | Train Loss: 0.1096480 Vali Loss: 0.1713699 Test Loss: 0.2397598
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 56 cost time: 0.9923863410949707
Epoch: 56, Steps: 64 | Train Loss: 0.1094252 Vali Loss: 0.1712393 Test Loss: 0.2390688
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 57 cost time: 0.994387149810791
Epoch: 57, Steps: 64 | Train Loss: 0.1097946 Vali Loss: 0.1711355 Test Loss: 0.2396396
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 58 cost time: 0.9313247203826904
Epoch: 58, Steps: 64 | Train Loss: 0.1092584 Vali Loss: 0.1707656 Test Loss: 0.2391867
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 59 cost time: 0.939373254776001
Epoch: 59, Steps: 64 | Train Loss: 0.1099144 Vali Loss: 0.1727009 Test Loss: 0.2392781
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 60 cost time: 0.9444582462310791
Epoch: 60, Steps: 64 | Train Loss: 0.1097824 Vali Loss: 0.1732731 Test Loss: 0.2397648
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.23668618500232697, mae:0.35698479413986206, rse:0.24655885994434357
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06399297714233398 GB
Epoch: 1 cost time: 2.2904715538024902
Epoch: 1, Steps: 64 | Train Loss: 0.8621983 Vali Loss: 2.3432488 Test Loss: 3.7159271
Validation loss decreased (inf --> 2.343249).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 2 cost time: 0.9514822959899902
Epoch: 2, Steps: 64 | Train Loss: 0.4568896 Vali Loss: 0.2460308 Test Loss: 0.3093337
Validation loss decreased (2.343249 --> 0.246031).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 3 cost time: 0.9478023052215576
Epoch: 3, Steps: 64 | Train Loss: 0.1509372 Vali Loss: 0.2032309 Test Loss: 0.2577555
Validation loss decreased (0.246031 --> 0.203231).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 4 cost time: 0.9295880794525146
Epoch: 4, Steps: 64 | Train Loss: 0.1337733 Vali Loss: 0.1807503 Test Loss: 0.2271101
Validation loss decreased (0.203231 --> 0.180750).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 5 cost time: 0.946617603302002
Epoch: 5, Steps: 64 | Train Loss: 0.1294044 Vali Loss: 0.1786224 Test Loss: 0.2246015
Validation loss decreased (0.180750 --> 0.178622).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 6 cost time: 0.9406163692474365
Epoch: 6, Steps: 64 | Train Loss: 0.1263337 Vali Loss: 0.1752074 Test Loss: 0.2265827
Validation loss decreased (0.178622 --> 0.175207).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 7 cost time: 0.9424924850463867
Epoch: 7, Steps: 64 | Train Loss: 0.1237757 Vali Loss: 0.1749399 Test Loss: 0.2248889
Validation loss decreased (0.175207 --> 0.174940).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 8 cost time: 0.9378011226654053
Epoch: 8, Steps: 64 | Train Loss: 0.1211604 Vali Loss: 0.1793245 Test Loss: 0.2281962
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 9 cost time: 0.9463744163513184
Epoch: 9, Steps: 64 | Train Loss: 0.1200262 Vali Loss: 0.1737310 Test Loss: 0.2265714
Validation loss decreased (0.174940 --> 0.173731).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 10 cost time: 0.9443216323852539
Epoch: 10, Steps: 64 | Train Loss: 0.1183264 Vali Loss: 0.1723439 Test Loss: 0.2279090
Validation loss decreased (0.173731 --> 0.172344).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 11 cost time: 0.9413647651672363
Epoch: 11, Steps: 64 | Train Loss: 0.1169003 Vali Loss: 0.1701686 Test Loss: 0.2296370
Validation loss decreased (0.172344 --> 0.170169).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 12 cost time: 0.9427354335784912
Epoch: 12, Steps: 64 | Train Loss: 0.1149351 Vali Loss: 0.1714774 Test Loss: 0.2323603
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 13 cost time: 0.9391541481018066
Epoch: 13, Steps: 64 | Train Loss: 0.1144935 Vali Loss: 0.1721167 Test Loss: 0.2335341
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 14 cost time: 0.9550004005432129
Epoch: 14, Steps: 64 | Train Loss: 0.1140243 Vali Loss: 0.1749818 Test Loss: 0.2391519
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 15 cost time: 0.9436264038085938
Epoch: 15, Steps: 64 | Train Loss: 0.1128942 Vali Loss: 0.1734504 Test Loss: 0.2390693
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 16 cost time: 0.9416162967681885
Epoch: 16, Steps: 64 | Train Loss: 0.1120283 Vali Loss: 0.1753889 Test Loss: 0.2429861
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 17 cost time: 0.9533348083496094
Epoch: 17, Steps: 64 | Train Loss: 0.1116064 Vali Loss: 0.1754095 Test Loss: 0.2427567
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 18 cost time: 0.9413857460021973
Epoch: 18, Steps: 64 | Train Loss: 0.1114918 Vali Loss: 0.1767630 Test Loss: 0.2465857
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 19 cost time: 0.9392096996307373
Epoch: 19, Steps: 64 | Train Loss: 0.1110082 Vali Loss: 0.1747909 Test Loss: 0.2447091
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 20 cost time: 0.9444959163665771
Epoch: 20, Steps: 64 | Train Loss: 0.1107574 Vali Loss: 0.1770501 Test Loss: 0.2477571
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 21 cost time: 0.9557399749755859
Epoch: 21, Steps: 64 | Train Loss: 0.1105000 Vali Loss: 0.1764827 Test Loss: 0.2459479
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 22 cost time: 0.9448702335357666
Epoch: 22, Steps: 64 | Train Loss: 0.1103846 Vali Loss: 0.1762527 Test Loss: 0.2450120
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 23 cost time: 0.9388229846954346
Epoch: 23, Steps: 64 | Train Loss: 0.1098213 Vali Loss: 0.1781457 Test Loss: 0.2484334
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 24 cost time: 0.948401689529419
Epoch: 24, Steps: 64 | Train Loss: 0.1097864 Vali Loss: 0.1767279 Test Loss: 0.2481268
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 25 cost time: 0.9380412101745605
Epoch: 25, Steps: 64 | Train Loss: 0.1093176 Vali Loss: 0.1770922 Test Loss: 0.2490211
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 26 cost time: 0.9496245384216309
Epoch: 26, Steps: 64 | Train Loss: 0.1093833 Vali Loss: 0.1772483 Test Loss: 0.2488171
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 27 cost time: 0.9509198665618896
Epoch: 27, Steps: 64 | Train Loss: 0.1091872 Vali Loss: 0.1774439 Test Loss: 0.2506094
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 28 cost time: 0.9403362274169922
Epoch: 28, Steps: 64 | Train Loss: 0.1091848 Vali Loss: 0.1772580 Test Loss: 0.2517441
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 29 cost time: 0.9383773803710938
Epoch: 29, Steps: 64 | Train Loss: 0.1091801 Vali Loss: 0.1800373 Test Loss: 0.2518085
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 30 cost time: 0.9289729595184326
Epoch: 30, Steps: 64 | Train Loss: 0.1093319 Vali Loss: 0.1766084 Test Loss: 0.2524173
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 31 cost time: 0.9333927631378174
Epoch: 31, Steps: 64 | Train Loss: 0.1091230 Vali Loss: 0.1792859 Test Loss: 0.2520022
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 32 cost time: 0.9256248474121094
Epoch: 32, Steps: 64 | Train Loss: 0.1091303 Vali Loss: 0.1808336 Test Loss: 0.2531163
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 33 cost time: 0.9340000152587891
Epoch: 33, Steps: 64 | Train Loss: 0.1088632 Vali Loss: 0.1791738 Test Loss: 0.2532345
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 34 cost time: 0.9462714195251465
Epoch: 34, Steps: 64 | Train Loss: 0.1087410 Vali Loss: 0.1798258 Test Loss: 0.2542762
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 35 cost time: 0.9376194477081299
Epoch: 35, Steps: 64 | Train Loss: 0.1079198 Vali Loss: 0.1783638 Test Loss: 0.2526688
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 36 cost time: 0.9413671493530273
Epoch: 36, Steps: 64 | Train Loss: 0.1082534 Vali Loss: 0.1785721 Test Loss: 0.2525901
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 37 cost time: 0.9473507404327393
Epoch: 37, Steps: 64 | Train Loss: 0.1080686 Vali Loss: 0.1790556 Test Loss: 0.2532739
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 38 cost time: 0.9284627437591553
Epoch: 38, Steps: 64 | Train Loss: 0.1086860 Vali Loss: 0.1786139 Test Loss: 0.2548343
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 39 cost time: 0.984473705291748
Epoch: 39, Steps: 64 | Train Loss: 0.1083819 Vali Loss: 0.1786772 Test Loss: 0.2532768
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 40 cost time: 0.9293792247772217
Epoch: 40, Steps: 64 | Train Loss: 0.1083153 Vali Loss: 0.1791084 Test Loss: 0.2551982
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 41 cost time: 0.9452462196350098
Epoch: 41, Steps: 64 | Train Loss: 0.1080685 Vali Loss: 0.1803808 Test Loss: 0.2556974
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 42 cost time: 0.9481732845306396
Epoch: 42, Steps: 64 | Train Loss: 0.1078993 Vali Loss: 0.1796440 Test Loss: 0.2555923
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 43 cost time: 0.9429998397827148
Epoch: 43, Steps: 64 | Train Loss: 0.1078883 Vali Loss: 0.1795541 Test Loss: 0.2544586
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 44 cost time: 0.9400763511657715
Epoch: 44, Steps: 64 | Train Loss: 0.1079231 Vali Loss: 0.1795449 Test Loss: 0.2548757
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 45 cost time: 0.9553563594818115
Epoch: 45, Steps: 64 | Train Loss: 0.1081534 Vali Loss: 0.1793283 Test Loss: 0.2547873
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 46 cost time: 0.9340019226074219
Epoch: 46, Steps: 64 | Train Loss: 0.1080243 Vali Loss: 0.1781909 Test Loss: 0.2553768
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 47 cost time: 0.9353790283203125
Epoch: 47, Steps: 64 | Train Loss: 0.1077869 Vali Loss: 0.1793758 Test Loss: 0.2546932
EarlyStopping counter: 36 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 48 cost time: 0.9273929595947266
Epoch: 48, Steps: 64 | Train Loss: 0.1078369 Vali Loss: 0.1783279 Test Loss: 0.2552556
EarlyStopping counter: 37 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 49 cost time: 0.9313671588897705
Epoch: 49, Steps: 64 | Train Loss: 0.1084569 Vali Loss: 0.1791458 Test Loss: 0.2551145
EarlyStopping counter: 38 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 50 cost time: 0.9338135719299316
Epoch: 50, Steps: 64 | Train Loss: 0.1078667 Vali Loss: 0.1791566 Test Loss: 0.2563449
EarlyStopping counter: 39 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 51 cost time: 0.9395999908447266
Epoch: 51, Steps: 64 | Train Loss: 0.1076128 Vali Loss: 0.1803282 Test Loss: 0.2561224
EarlyStopping counter: 40 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 52 cost time: 0.9419991970062256
Epoch: 52, Steps: 64 | Train Loss: 0.1080586 Vali Loss: 0.1802131 Test Loss: 0.2543915
EarlyStopping counter: 41 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 53 cost time: 0.9436173439025879
Epoch: 53, Steps: 64 | Train Loss: 0.1084714 Vali Loss: 0.1786102 Test Loss: 0.2549082
EarlyStopping counter: 42 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 54 cost time: 0.958993673324585
Epoch: 54, Steps: 64 | Train Loss: 0.1075956 Vali Loss: 0.1800899 Test Loss: 0.2551793
EarlyStopping counter: 43 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 55 cost time: 0.9418511390686035
Epoch: 55, Steps: 64 | Train Loss: 0.1081814 Vali Loss: 0.1805805 Test Loss: 0.2549980
EarlyStopping counter: 44 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 56 cost time: 0.9403986930847168
Epoch: 56, Steps: 64 | Train Loss: 0.1084228 Vali Loss: 0.1793922 Test Loss: 0.2549735
EarlyStopping counter: 45 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 57 cost time: 0.9523816108703613
Epoch: 57, Steps: 64 | Train Loss: 0.1086485 Vali Loss: 0.1804614 Test Loss: 0.2558467
EarlyStopping counter: 46 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 58 cost time: 0.9403634071350098
Epoch: 58, Steps: 64 | Train Loss: 0.1081064 Vali Loss: 0.1775828 Test Loss: 0.2550512
EarlyStopping counter: 47 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 59 cost time: 0.9443495273590088
Epoch: 59, Steps: 64 | Train Loss: 0.1072566 Vali Loss: 0.1803780 Test Loss: 0.2549585
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 60 cost time: 0.9427974224090576
Epoch: 60, Steps: 64 | Train Loss: 0.1080014 Vali Loss: 0.1797991 Test Loss: 0.2551541
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2296370565891266, mae:0.3482319414615631, rse:0.24285951256752014
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.053999900817871094 GB
Epoch: 1 cost time: 2.1017870903015137
Epoch: 1, Steps: 64 | Train Loss: 1.0903032 Vali Loss: 2.8124528 Test Loss: 4.5336232
Validation loss decreased (inf --> 2.812453).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 2 cost time: 0.7863528728485107
Epoch: 2, Steps: 64 | Train Loss: 0.8342937 Vali Loss: 1.5186385 Test Loss: 2.3723972
Validation loss decreased (2.812453 --> 1.518638).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 3 cost time: 0.7834184169769287
Epoch: 3, Steps: 64 | Train Loss: 0.4975951 Vali Loss: 0.8309641 Test Loss: 1.2160056
Validation loss decreased (1.518638 --> 0.830964).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 4 cost time: 0.7841095924377441
Epoch: 4, Steps: 64 | Train Loss: 0.3086553 Vali Loss: 0.4998151 Test Loss: 0.6849915
Validation loss decreased (0.830964 --> 0.499815).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 5 cost time: 0.7913656234741211
Epoch: 5, Steps: 64 | Train Loss: 0.2194334 Vali Loss: 0.3616258 Test Loss: 0.4736475
Validation loss decreased (0.499815 --> 0.361626).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 6 cost time: 0.7813496589660645
Epoch: 6, Steps: 64 | Train Loss: 0.1798593 Vali Loss: 0.2851810 Test Loss: 0.3670943
Validation loss decreased (0.361626 --> 0.285181).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 7 cost time: 0.7823891639709473
Epoch: 7, Steps: 64 | Train Loss: 0.1601080 Vali Loss: 0.2437786 Test Loss: 0.3076864
Validation loss decreased (0.285181 --> 0.243779).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 8 cost time: 0.780829906463623
Epoch: 8, Steps: 64 | Train Loss: 0.1488793 Vali Loss: 0.2208610 Test Loss: 0.2759636
Validation loss decreased (0.243779 --> 0.220861).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 9 cost time: 0.7823734283447266
Epoch: 9, Steps: 64 | Train Loss: 0.1427916 Vali Loss: 0.2070285 Test Loss: 0.2600581
Validation loss decreased (0.220861 --> 0.207029).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 10 cost time: 0.7793724536895752
Epoch: 10, Steps: 64 | Train Loss: 0.1380212 Vali Loss: 0.1976054 Test Loss: 0.2480521
Validation loss decreased (0.207029 --> 0.197605).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 11 cost time: 0.787391185760498
Epoch: 11, Steps: 64 | Train Loss: 0.1350603 Vali Loss: 0.1936706 Test Loss: 0.2450739
Validation loss decreased (0.197605 --> 0.193671).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 12 cost time: 0.7817304134368896
Epoch: 12, Steps: 64 | Train Loss: 0.1325661 Vali Loss: 0.1885109 Test Loss: 0.2390556
Validation loss decreased (0.193671 --> 0.188511).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 13 cost time: 0.7829999923706055
Epoch: 13, Steps: 64 | Train Loss: 0.1302949 Vali Loss: 0.1849627 Test Loss: 0.2368285
Validation loss decreased (0.188511 --> 0.184963).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 14 cost time: 0.7913751602172852
Epoch: 14, Steps: 64 | Train Loss: 0.1291925 Vali Loss: 0.1805289 Test Loss: 0.2345290
Validation loss decreased (0.184963 --> 0.180529).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 15 cost time: 0.7903716564178467
Epoch: 15, Steps: 64 | Train Loss: 0.1277454 Vali Loss: 0.1819183 Test Loss: 0.2344618
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 16 cost time: 0.7807412147521973
Epoch: 16, Steps: 64 | Train Loss: 0.1269364 Vali Loss: 0.1803053 Test Loss: 0.2328840
Validation loss decreased (0.180529 --> 0.180305).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 17 cost time: 0.7909972667694092
Epoch: 17, Steps: 64 | Train Loss: 0.1253881 Vali Loss: 0.1778832 Test Loss: 0.2315818
Validation loss decreased (0.180305 --> 0.177883).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 18 cost time: 0.7804200649261475
Epoch: 18, Steps: 64 | Train Loss: 0.1253025 Vali Loss: 0.1780151 Test Loss: 0.2314726
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 19 cost time: 0.7817296981811523
Epoch: 19, Steps: 64 | Train Loss: 0.1244948 Vali Loss: 0.1769506 Test Loss: 0.2312266
Validation loss decreased (0.177883 --> 0.176951).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 20 cost time: 0.7810003757476807
Epoch: 20, Steps: 64 | Train Loss: 0.1229457 Vali Loss: 0.1758156 Test Loss: 0.2295196
Validation loss decreased (0.176951 --> 0.175816).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 21 cost time: 0.8010067939758301
Epoch: 21, Steps: 64 | Train Loss: 0.1239141 Vali Loss: 0.1755893 Test Loss: 0.2305703
Validation loss decreased (0.175816 --> 0.175589).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 22 cost time: 0.8218040466308594
Epoch: 22, Steps: 64 | Train Loss: 0.1228227 Vali Loss: 0.1729759 Test Loss: 0.2292696
Validation loss decreased (0.175589 --> 0.172976).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 23 cost time: 0.7847192287445068
Epoch: 23, Steps: 64 | Train Loss: 0.1218358 Vali Loss: 0.1747630 Test Loss: 0.2297354
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 24 cost time: 0.7881197929382324
Epoch: 24, Steps: 64 | Train Loss: 0.1219656 Vali Loss: 0.1744177 Test Loss: 0.2302642
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 25 cost time: 0.7975325584411621
Epoch: 25, Steps: 64 | Train Loss: 0.1220465 Vali Loss: 0.1727735 Test Loss: 0.2282376
Validation loss decreased (0.172976 --> 0.172774).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 26 cost time: 0.7793881893157959
Epoch: 26, Steps: 64 | Train Loss: 0.1215071 Vali Loss: 0.1733013 Test Loss: 0.2293636
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 27 cost time: 0.781440019607544
Epoch: 27, Steps: 64 | Train Loss: 0.1207089 Vali Loss: 0.1701693 Test Loss: 0.2286143
Validation loss decreased (0.172774 --> 0.170169).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 28 cost time: 0.7759993076324463
Epoch: 28, Steps: 64 | Train Loss: 0.1208878 Vali Loss: 0.1706833 Test Loss: 0.2281701
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 29 cost time: 0.7890121936798096
Epoch: 29, Steps: 64 | Train Loss: 0.1206072 Vali Loss: 0.1710124 Test Loss: 0.2286909
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 30 cost time: 0.7773489952087402
Epoch: 30, Steps: 64 | Train Loss: 0.1202729 Vali Loss: 0.1704260 Test Loss: 0.2283007
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 31 cost time: 0.7844057083129883
Epoch: 31, Steps: 64 | Train Loss: 0.1199317 Vali Loss: 0.1712139 Test Loss: 0.2284507
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 32 cost time: 0.7869997024536133
Epoch: 32, Steps: 64 | Train Loss: 0.1192045 Vali Loss: 0.1714052 Test Loss: 0.2286366
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 33 cost time: 0.7855508327484131
Epoch: 33, Steps: 64 | Train Loss: 0.1200277 Vali Loss: 0.1699772 Test Loss: 0.2281937
Validation loss decreased (0.170169 --> 0.169977).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 34 cost time: 0.7872390747070312
Epoch: 34, Steps: 64 | Train Loss: 0.1195611 Vali Loss: 0.1699704 Test Loss: 0.2279584
Validation loss decreased (0.169977 --> 0.169970).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 35 cost time: 0.7853617668151855
Epoch: 35, Steps: 64 | Train Loss: 0.1196305 Vali Loss: 0.1700620 Test Loss: 0.2273732
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 36 cost time: 0.7860000133514404
Epoch: 36, Steps: 64 | Train Loss: 0.1199919 Vali Loss: 0.1688064 Test Loss: 0.2269459
Validation loss decreased (0.169970 --> 0.168806).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 37 cost time: 0.7826263904571533
Epoch: 37, Steps: 64 | Train Loss: 0.1191138 Vali Loss: 0.1705263 Test Loss: 0.2278499
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 38 cost time: 0.7854881286621094
Epoch: 38, Steps: 64 | Train Loss: 0.1194899 Vali Loss: 0.1710766 Test Loss: 0.2270857
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 39 cost time: 0.783308744430542
Epoch: 39, Steps: 64 | Train Loss: 0.1196201 Vali Loss: 0.1694050 Test Loss: 0.2277085
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 40 cost time: 0.7839999198913574
Epoch: 40, Steps: 64 | Train Loss: 0.1191021 Vali Loss: 0.1701760 Test Loss: 0.2271526
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 41 cost time: 0.795616865158081
Epoch: 41, Steps: 64 | Train Loss: 0.1190153 Vali Loss: 0.1687509 Test Loss: 0.2281193
Validation loss decreased (0.168806 --> 0.168751).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 42 cost time: 0.7853820323944092
Epoch: 42, Steps: 64 | Train Loss: 0.1179592 Vali Loss: 0.1702592 Test Loss: 0.2276866
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 43 cost time: 0.7857170104980469
Epoch: 43, Steps: 64 | Train Loss: 0.1189737 Vali Loss: 0.1708428 Test Loss: 0.2282606
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 44 cost time: 0.7856221199035645
Epoch: 44, Steps: 64 | Train Loss: 0.1192196 Vali Loss: 0.1702289 Test Loss: 0.2271078
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 45 cost time: 0.7993576526641846
Epoch: 45, Steps: 64 | Train Loss: 0.1187552 Vali Loss: 0.1688538 Test Loss: 0.2275163
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 46 cost time: 0.7893645763397217
Epoch: 46, Steps: 64 | Train Loss: 0.1189499 Vali Loss: 0.1697712 Test Loss: 0.2269868
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 47 cost time: 0.7827768325805664
Epoch: 47, Steps: 64 | Train Loss: 0.1177866 Vali Loss: 0.1701846 Test Loss: 0.2278184
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 48 cost time: 0.7860000133514404
Epoch: 48, Steps: 64 | Train Loss: 0.1183566 Vali Loss: 0.1680326 Test Loss: 0.2270999
Validation loss decreased (0.168751 --> 0.168033).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 49 cost time: 0.7966177463531494
Epoch: 49, Steps: 64 | Train Loss: 0.1189315 Vali Loss: 0.1697371 Test Loss: 0.2271933
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 50 cost time: 0.7823383808135986
Epoch: 50, Steps: 64 | Train Loss: 0.1189536 Vali Loss: 0.1689083 Test Loss: 0.2272707
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 51 cost time: 0.7867419719696045
Epoch: 51, Steps: 64 | Train Loss: 0.1183182 Vali Loss: 0.1690476 Test Loss: 0.2276934
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 52 cost time: 0.7839999198913574
Epoch: 52, Steps: 64 | Train Loss: 0.1186198 Vali Loss: 0.1702612 Test Loss: 0.2274596
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 53 cost time: 0.7940537929534912
Epoch: 53, Steps: 64 | Train Loss: 0.1185023 Vali Loss: 0.1688111 Test Loss: 0.2277585
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 54 cost time: 0.8494582176208496
Epoch: 54, Steps: 64 | Train Loss: 0.1186100 Vali Loss: 0.1705092 Test Loss: 0.2278999
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 55 cost time: 0.7809329032897949
Epoch: 55, Steps: 64 | Train Loss: 0.1186859 Vali Loss: 0.1689136 Test Loss: 0.2273000
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 56 cost time: 0.7779994010925293
Epoch: 56, Steps: 64 | Train Loss: 0.1182140 Vali Loss: 0.1705346 Test Loss: 0.2278636
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 57 cost time: 0.7859768867492676
Epoch: 57, Steps: 64 | Train Loss: 0.1188212 Vali Loss: 0.1676384 Test Loss: 0.2270915
Validation loss decreased (0.168033 --> 0.167638).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 58 cost time: 0.7814323902130127
Epoch: 58, Steps: 64 | Train Loss: 0.1187473 Vali Loss: 0.1680756 Test Loss: 0.2268183
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 59 cost time: 0.7787928581237793
Epoch: 59, Steps: 64 | Train Loss: 0.1183963 Vali Loss: 0.1684873 Test Loss: 0.2273239
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 60 cost time: 0.7799999713897705
Epoch: 60, Steps: 64 | Train Loss: 0.1184640 Vali Loss: 0.1682901 Test Loss: 0.2265645
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22709152102470398, mae:0.33526426553726196, rse:0.24150970578193665
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.058394432067871094 GB
Epoch: 1 cost time: 2.153592109680176
Epoch: 1, Steps: 64 | Train Loss: 0.7901102 Vali Loss: 2.0576258 Test Loss: 3.2510974
Validation loss decreased (inf --> 2.057626).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 2 cost time: 0.8220000267028809
Epoch: 2, Steps: 64 | Train Loss: 0.3662912 Vali Loss: 0.2194121 Test Loss: 0.2657530
Validation loss decreased (2.057626 --> 0.219412).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 3 cost time: 0.8176305294036865
Epoch: 3, Steps: 64 | Train Loss: 0.1400905 Vali Loss: 0.1885263 Test Loss: 0.2382707
Validation loss decreased (0.219412 --> 0.188526).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 4 cost time: 0.8189995288848877
Epoch: 4, Steps: 64 | Train Loss: 0.1271394 Vali Loss: 0.1803195 Test Loss: 0.2303264
Validation loss decreased (0.188526 --> 0.180320).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 5 cost time: 0.819603443145752
Epoch: 5, Steps: 64 | Train Loss: 0.1217941 Vali Loss: 0.1768169 Test Loss: 0.2284319
Validation loss decreased (0.180320 --> 0.176817).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 6 cost time: 0.8214120864868164
Epoch: 6, Steps: 64 | Train Loss: 0.1188319 Vali Loss: 0.1701880 Test Loss: 0.2265838
Validation loss decreased (0.176817 --> 0.170188).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 7 cost time: 0.8203809261322021
Epoch: 7, Steps: 64 | Train Loss: 0.1155995 Vali Loss: 0.1726984 Test Loss: 0.2275247
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 8 cost time: 0.8190000057220459
Epoch: 8, Steps: 64 | Train Loss: 0.1139089 Vali Loss: 0.1682585 Test Loss: 0.2259965
Validation loss decreased (0.170188 --> 0.168258).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 9 cost time: 0.8257753849029541
Epoch: 9, Steps: 64 | Train Loss: 0.1127310 Vali Loss: 0.1692483 Test Loss: 0.2255374
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 10 cost time: 0.8253428936004639
Epoch: 10, Steps: 64 | Train Loss: 0.1112805 Vali Loss: 0.1627111 Test Loss: 0.2243472
Validation loss decreased (0.168258 --> 0.162711).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 11 cost time: 0.8223226070404053
Epoch: 11, Steps: 64 | Train Loss: 0.1097661 Vali Loss: 0.1623492 Test Loss: 0.2248964
Validation loss decreased (0.162711 --> 0.162349).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 12 cost time: 0.8177337646484375
Epoch: 12, Steps: 64 | Train Loss: 0.1089639 Vali Loss: 0.1618334 Test Loss: 0.2243075
Validation loss decreased (0.162349 --> 0.161833).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 13 cost time: 0.8199989795684814
Epoch: 13, Steps: 64 | Train Loss: 0.1082061 Vali Loss: 0.1611616 Test Loss: 0.2249667
Validation loss decreased (0.161833 --> 0.161162).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 14 cost time: 0.8179323673248291
Epoch: 14, Steps: 64 | Train Loss: 0.1073138 Vali Loss: 0.1564374 Test Loss: 0.2244522
Validation loss decreased (0.161162 --> 0.156437).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 15 cost time: 0.8243887424468994
Epoch: 15, Steps: 64 | Train Loss: 0.1067096 Vali Loss: 0.1569572 Test Loss: 0.2238366
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 16 cost time: 0.8308367729187012
Epoch: 16, Steps: 64 | Train Loss: 0.1065337 Vali Loss: 0.1586643 Test Loss: 0.2243736
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 17 cost time: 0.825709342956543
Epoch: 17, Steps: 64 | Train Loss: 0.1060924 Vali Loss: 0.1584464 Test Loss: 0.2235113
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 18 cost time: 0.8169996738433838
Epoch: 18, Steps: 64 | Train Loss: 0.1053735 Vali Loss: 0.1586529 Test Loss: 0.2243551
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 19 cost time: 0.8210275173187256
Epoch: 19, Steps: 64 | Train Loss: 0.1047640 Vali Loss: 0.1586707 Test Loss: 0.2249374
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 20 cost time: 0.8354015350341797
Epoch: 20, Steps: 64 | Train Loss: 0.1042641 Vali Loss: 0.1569853 Test Loss: 0.2240663
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 21 cost time: 0.8223943710327148
Epoch: 21, Steps: 64 | Train Loss: 0.1041518 Vali Loss: 0.1559138 Test Loss: 0.2249933
Validation loss decreased (0.156437 --> 0.155914).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 22 cost time: 0.818000316619873
Epoch: 22, Steps: 64 | Train Loss: 0.1035214 Vali Loss: 0.1573754 Test Loss: 0.2247481
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 23 cost time: 0.8226137161254883
Epoch: 23, Steps: 64 | Train Loss: 0.1038618 Vali Loss: 0.1585314 Test Loss: 0.2248324
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 24 cost time: 0.8372502326965332
Epoch: 24, Steps: 64 | Train Loss: 0.1033682 Vali Loss: 0.1568459 Test Loss: 0.2245199
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 25 cost time: 0.8183488845825195
Epoch: 25, Steps: 64 | Train Loss: 0.1037910 Vali Loss: 0.1571236 Test Loss: 0.2245943
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 26 cost time: 0.8217167854309082
Epoch: 26, Steps: 64 | Train Loss: 0.1032209 Vali Loss: 0.1567258 Test Loss: 0.2248743
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 27 cost time: 0.8190007209777832
Epoch: 27, Steps: 64 | Train Loss: 0.1031375 Vali Loss: 0.1564491 Test Loss: 0.2246977
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 28 cost time: 0.8263604640960693
Epoch: 28, Steps: 64 | Train Loss: 0.1031617 Vali Loss: 0.1560236 Test Loss: 0.2243260
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 29 cost time: 0.8254547119140625
Epoch: 29, Steps: 64 | Train Loss: 0.1023809 Vali Loss: 0.1566593 Test Loss: 0.2247183
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 30 cost time: 0.8247127532958984
Epoch: 30, Steps: 64 | Train Loss: 0.1021155 Vali Loss: 0.1557245 Test Loss: 0.2243919
Validation loss decreased (0.155914 --> 0.155724).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 31 cost time: 0.815000057220459
Epoch: 31, Steps: 64 | Train Loss: 0.1026827 Vali Loss: 0.1557372 Test Loss: 0.2246499
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 32 cost time: 0.8066134452819824
Epoch: 32, Steps: 64 | Train Loss: 0.1021225 Vali Loss: 0.1554973 Test Loss: 0.2244474
Validation loss decreased (0.155724 --> 0.155497).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 33 cost time: 0.8208718299865723
Epoch: 33, Steps: 64 | Train Loss: 0.1021556 Vali Loss: 0.1559514 Test Loss: 0.2243929
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 34 cost time: 0.8214387893676758
Epoch: 34, Steps: 64 | Train Loss: 0.1021831 Vali Loss: 0.1543060 Test Loss: 0.2247313
Validation loss decreased (0.155497 --> 0.154306).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 35 cost time: 0.8167963027954102
Epoch: 35, Steps: 64 | Train Loss: 0.1018941 Vali Loss: 0.1566853 Test Loss: 0.2242575
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 36 cost time: 0.819526195526123
Epoch: 36, Steps: 64 | Train Loss: 0.1023923 Vali Loss: 0.1546703 Test Loss: 0.2248167
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 37 cost time: 0.8166205883026123
Epoch: 37, Steps: 64 | Train Loss: 0.1019882 Vali Loss: 0.1551174 Test Loss: 0.2243868
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 38 cost time: 0.8164007663726807
Epoch: 38, Steps: 64 | Train Loss: 0.1016932 Vali Loss: 0.1561764 Test Loss: 0.2247166
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 39 cost time: 0.8323264122009277
Epoch: 39, Steps: 64 | Train Loss: 0.1021783 Vali Loss: 0.1554496 Test Loss: 0.2247904
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 40 cost time: 0.8987998962402344
Epoch: 40, Steps: 64 | Train Loss: 0.1017237 Vali Loss: 0.1550247 Test Loss: 0.2248042
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 41 cost time: 0.8940000534057617
Epoch: 41, Steps: 64 | Train Loss: 0.1017316 Vali Loss: 0.1562541 Test Loss: 0.2252315
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 42 cost time: 0.8429925441741943
Epoch: 42, Steps: 64 | Train Loss: 0.1017442 Vali Loss: 0.1564561 Test Loss: 0.2248011
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 43 cost time: 0.8352100849151611
Epoch: 43, Steps: 64 | Train Loss: 0.1015166 Vali Loss: 0.1540987 Test Loss: 0.2244409
Validation loss decreased (0.154306 --> 0.154099).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 44 cost time: 0.8231923580169678
Epoch: 44, Steps: 64 | Train Loss: 0.1017574 Vali Loss: 0.1542905 Test Loss: 0.2248365
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 45 cost time: 0.8227419853210449
Epoch: 45, Steps: 64 | Train Loss: 0.1020264 Vali Loss: 0.1548741 Test Loss: 0.2247895
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 46 cost time: 0.8230001926422119
Epoch: 46, Steps: 64 | Train Loss: 0.1020003 Vali Loss: 0.1549617 Test Loss: 0.2246549
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 47 cost time: 0.8392457962036133
Epoch: 47, Steps: 64 | Train Loss: 0.1018275 Vali Loss: 0.1552524 Test Loss: 0.2246543
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 48 cost time: 0.8223848342895508
Epoch: 48, Steps: 64 | Train Loss: 0.1019688 Vali Loss: 0.1552300 Test Loss: 0.2250230
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 49 cost time: 0.8163871765136719
Epoch: 49, Steps: 64 | Train Loss: 0.1013728 Vali Loss: 0.1549980 Test Loss: 0.2249331
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 50 cost time: 0.8199992179870605
Epoch: 50, Steps: 64 | Train Loss: 0.1016345 Vali Loss: 0.1557292 Test Loss: 0.2248791
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 51 cost time: 0.8216149806976318
Epoch: 51, Steps: 64 | Train Loss: 0.1015348 Vali Loss: 0.1550913 Test Loss: 0.2250050
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 52 cost time: 0.8236088752746582
Epoch: 52, Steps: 64 | Train Loss: 0.1017124 Vali Loss: 0.1556323 Test Loss: 0.2251774
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 53 cost time: 0.8233435153961182
Epoch: 53, Steps: 64 | Train Loss: 0.1012614 Vali Loss: 0.1555862 Test Loss: 0.2246423
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 54 cost time: 0.8267269134521484
Epoch: 54, Steps: 64 | Train Loss: 0.1016879 Vali Loss: 0.1544531 Test Loss: 0.2245676
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 55 cost time: 0.8149998188018799
Epoch: 55, Steps: 64 | Train Loss: 0.1018694 Vali Loss: 0.1537910 Test Loss: 0.2241592
Validation loss decreased (0.154099 --> 0.153791).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 56 cost time: 0.825387716293335
Epoch: 56, Steps: 64 | Train Loss: 0.1018959 Vali Loss: 0.1556849 Test Loss: 0.2249828
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 57 cost time: 0.8223915100097656
Epoch: 57, Steps: 64 | Train Loss: 0.1012194 Vali Loss: 0.1547252 Test Loss: 0.2247734
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 58 cost time: 0.8253262042999268
Epoch: 58, Steps: 64 | Train Loss: 0.1015919 Vali Loss: 0.1553740 Test Loss: 0.2249960
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 59 cost time: 0.8060019016265869
Epoch: 59, Steps: 64 | Train Loss: 0.1015778 Vali Loss: 0.1548989 Test Loss: 0.2247164
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 60 cost time: 0.8286309242248535
Epoch: 60, Steps: 64 | Train Loss: 0.1017873 Vali Loss: 0.1555255 Test Loss: 0.2245796
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2241591513156891, mae:0.3344409465789795, rse:0.23994536697864532
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06169319152832031 GB
Epoch: 1 cost time: 2.3560686111450195
Epoch: 1, Steps: 64 | Train Loss: 0.8797526 Vali Loss: 2.3473489 Test Loss: 3.7288265
Validation loss decreased (inf --> 2.347349).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 2 cost time: 0.9424164295196533
Epoch: 2, Steps: 64 | Train Loss: 0.3585000 Vali Loss: 0.2547925 Test Loss: 0.3231743
Validation loss decreased (2.347349 --> 0.254792).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 3 cost time: 0.9333591461181641
Epoch: 3, Steps: 64 | Train Loss: 0.1368679 Vali Loss: 0.1858980 Test Loss: 0.2319820
Validation loss decreased (0.254792 --> 0.185898).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 4 cost time: 0.9383506774902344
Epoch: 4, Steps: 64 | Train Loss: 0.1227820 Vali Loss: 0.1818012 Test Loss: 0.2287933
Validation loss decreased (0.185898 --> 0.181801).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 5 cost time: 0.9293527603149414
Epoch: 5, Steps: 64 | Train Loss: 0.1188778 Vali Loss: 0.1768544 Test Loss: 0.2264607
Validation loss decreased (0.181801 --> 0.176854).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 6 cost time: 0.9302544593811035
Epoch: 6, Steps: 64 | Train Loss: 0.1154392 Vali Loss: 0.1716645 Test Loss: 0.2272003
Validation loss decreased (0.176854 --> 0.171665).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 7 cost time: 0.9300000667572021
Epoch: 7, Steps: 64 | Train Loss: 0.1139243 Vali Loss: 0.1690474 Test Loss: 0.2238570
Validation loss decreased (0.171665 --> 0.169047).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 8 cost time: 0.9320001602172852
Epoch: 8, Steps: 64 | Train Loss: 0.1117633 Vali Loss: 0.1651343 Test Loss: 0.2238661
Validation loss decreased (0.169047 --> 0.165134).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 9 cost time: 0.9266257286071777
Epoch: 9, Steps: 64 | Train Loss: 0.1103630 Vali Loss: 0.1657770 Test Loss: 0.2252235
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 10 cost time: 0.937035083770752
Epoch: 10, Steps: 64 | Train Loss: 0.1090019 Vali Loss: 0.1627685 Test Loss: 0.2246316
Validation loss decreased (0.165134 --> 0.162769).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 11 cost time: 0.9343788623809814
Epoch: 11, Steps: 64 | Train Loss: 0.1081535 Vali Loss: 0.1603191 Test Loss: 0.2260755
Validation loss decreased (0.162769 --> 0.160319).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 12 cost time: 0.9383745193481445
Epoch: 12, Steps: 64 | Train Loss: 0.1073329 Vali Loss: 0.1613859 Test Loss: 0.2258210
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 13 cost time: 0.9363582134246826
Epoch: 13, Steps: 64 | Train Loss: 0.1068651 Vali Loss: 0.1607605 Test Loss: 0.2266173
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 14 cost time: 0.9318070411682129
Epoch: 14, Steps: 64 | Train Loss: 0.1058294 Vali Loss: 0.1621752 Test Loss: 0.2266264
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 15 cost time: 0.9448668956756592
Epoch: 15, Steps: 64 | Train Loss: 0.1054698 Vali Loss: 0.1577484 Test Loss: 0.2256442
Validation loss decreased (0.160319 --> 0.157748).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 16 cost time: 0.939000129699707
Epoch: 16, Steps: 64 | Train Loss: 0.1051951 Vali Loss: 0.1597616 Test Loss: 0.2257299
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 17 cost time: 0.935615062713623
Epoch: 17, Steps: 64 | Train Loss: 0.1045546 Vali Loss: 0.1586742 Test Loss: 0.2282288
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 18 cost time: 0.9400923252105713
Epoch: 18, Steps: 64 | Train Loss: 0.1038883 Vali Loss: 0.1588051 Test Loss: 0.2259893
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 19 cost time: 0.9594290256500244
Epoch: 19, Steps: 64 | Train Loss: 0.1038880 Vali Loss: 0.1579250 Test Loss: 0.2276740
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 20 cost time: 0.9323549270629883
Epoch: 20, Steps: 64 | Train Loss: 0.1028888 Vali Loss: 0.1581174 Test Loss: 0.2275022
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 21 cost time: 0.936373233795166
Epoch: 21, Steps: 64 | Train Loss: 0.1030996 Vali Loss: 0.1560977 Test Loss: 0.2268057
Validation loss decreased (0.157748 --> 0.156098).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 22 cost time: 0.9340846538543701
Epoch: 22, Steps: 64 | Train Loss: 0.1023198 Vali Loss: 0.1565025 Test Loss: 0.2269530
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 23 cost time: 0.9261839389801025
Epoch: 23, Steps: 64 | Train Loss: 0.1026838 Vali Loss: 0.1554995 Test Loss: 0.2277273
Validation loss decreased (0.156098 --> 0.155500).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 24 cost time: 0.9319992065429688
Epoch: 24, Steps: 64 | Train Loss: 0.1019389 Vali Loss: 0.1566563 Test Loss: 0.2286502
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 25 cost time: 0.9516129493713379
Epoch: 25, Steps: 64 | Train Loss: 0.1020058 Vali Loss: 0.1566495 Test Loss: 0.2268955
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 26 cost time: 0.9162025451660156
Epoch: 26, Steps: 64 | Train Loss: 0.1018653 Vali Loss: 0.1569306 Test Loss: 0.2284927
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 27 cost time: 0.9281833171844482
Epoch: 27, Steps: 64 | Train Loss: 0.1021749 Vali Loss: 0.1546477 Test Loss: 0.2276036
Validation loss decreased (0.155500 --> 0.154648).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 28 cost time: 0.9283716678619385
Epoch: 28, Steps: 64 | Train Loss: 0.1013267 Vali Loss: 0.1553100 Test Loss: 0.2274168
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 29 cost time: 0.9326841831207275
Epoch: 29, Steps: 64 | Train Loss: 0.1011062 Vali Loss: 0.1561151 Test Loss: 0.2276209
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 30 cost time: 0.9277298450469971
Epoch: 30, Steps: 64 | Train Loss: 0.1012903 Vali Loss: 0.1544521 Test Loss: 0.2270939
Validation loss decreased (0.154648 --> 0.154452).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 31 cost time: 0.9289424419403076
Epoch: 31, Steps: 64 | Train Loss: 0.1014153 Vali Loss: 0.1545857 Test Loss: 0.2271954
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 32 cost time: 0.9437777996063232
Epoch: 32, Steps: 64 | Train Loss: 0.1012090 Vali Loss: 0.1556858 Test Loss: 0.2276970
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 33 cost time: 0.9310002326965332
Epoch: 33, Steps: 64 | Train Loss: 0.1012980 Vali Loss: 0.1555796 Test Loss: 0.2273000
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 34 cost time: 0.9266161918640137
Epoch: 34, Steps: 64 | Train Loss: 0.1011285 Vali Loss: 0.1536157 Test Loss: 0.2270089
Validation loss decreased (0.154452 --> 0.153616).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 35 cost time: 0.9293420314788818
Epoch: 35, Steps: 64 | Train Loss: 0.1008432 Vali Loss: 0.1543584 Test Loss: 0.2280377
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 36 cost time: 0.9423584938049316
Epoch: 36, Steps: 64 | Train Loss: 0.1008289 Vali Loss: 0.1566280 Test Loss: 0.2274106
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 37 cost time: 0.9310564994812012
Epoch: 37, Steps: 64 | Train Loss: 0.1009618 Vali Loss: 0.1559957 Test Loss: 0.2276619
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 38 cost time: 0.9363443851470947
Epoch: 38, Steps: 64 | Train Loss: 0.1006302 Vali Loss: 0.1551595 Test Loss: 0.2275426
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 39 cost time: 0.940767765045166
Epoch: 39, Steps: 64 | Train Loss: 0.1007870 Vali Loss: 0.1558175 Test Loss: 0.2276663
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 40 cost time: 0.935999870300293
Epoch: 40, Steps: 64 | Train Loss: 0.1006247 Vali Loss: 0.1558000 Test Loss: 0.2274442
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 41 cost time: 0.9303715229034424
Epoch: 41, Steps: 64 | Train Loss: 0.1006353 Vali Loss: 0.1563316 Test Loss: 0.2276963
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 42 cost time: 0.9306247234344482
Epoch: 42, Steps: 64 | Train Loss: 0.1006474 Vali Loss: 0.1545267 Test Loss: 0.2275370
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 43 cost time: 0.9243712425231934
Epoch: 43, Steps: 64 | Train Loss: 0.1008456 Vali Loss: 0.1567568 Test Loss: 0.2277125
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 44 cost time: 0.93135666847229
Epoch: 44, Steps: 64 | Train Loss: 0.1009214 Vali Loss: 0.1572038 Test Loss: 0.2277134
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 45 cost time: 0.9293777942657471
Epoch: 45, Steps: 64 | Train Loss: 0.1004013 Vali Loss: 0.1565933 Test Loss: 0.2269579
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 46 cost time: 0.9317827224731445
Epoch: 46, Steps: 64 | Train Loss: 0.1008566 Vali Loss: 0.1566942 Test Loss: 0.2275505
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 47 cost time: 0.9057559967041016
Epoch: 47, Steps: 64 | Train Loss: 0.1002433 Vali Loss: 0.1566540 Test Loss: 0.2279293
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 48 cost time: 0.9429998397827148
Epoch: 48, Steps: 64 | Train Loss: 0.1004475 Vali Loss: 0.1557928 Test Loss: 0.2276883
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 49 cost time: 0.9476051330566406
Epoch: 49, Steps: 64 | Train Loss: 0.1003680 Vali Loss: 0.1551640 Test Loss: 0.2270477
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 50 cost time: 0.916609525680542
Epoch: 50, Steps: 64 | Train Loss: 0.1003870 Vali Loss: 0.1558795 Test Loss: 0.2282300
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 51 cost time: 0.9424355030059814
Epoch: 51, Steps: 64 | Train Loss: 0.1003342 Vali Loss: 0.1548847 Test Loss: 0.2276980
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 52 cost time: 0.9473426342010498
Epoch: 52, Steps: 64 | Train Loss: 0.1002450 Vali Loss: 0.1541202 Test Loss: 0.2276407
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 53 cost time: 0.9538233280181885
Epoch: 53, Steps: 64 | Train Loss: 0.1006791 Vali Loss: 0.1552374 Test Loss: 0.2273078
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 54 cost time: 0.9499106407165527
Epoch: 54, Steps: 64 | Train Loss: 0.1004744 Vali Loss: 0.1543989 Test Loss: 0.2270533
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 55 cost time: 0.9513530731201172
Epoch: 55, Steps: 64 | Train Loss: 0.1000750 Vali Loss: 0.1535391 Test Loss: 0.2270473
Validation loss decreased (0.153616 --> 0.153539).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 56 cost time: 0.9547116756439209
Epoch: 56, Steps: 64 | Train Loss: 0.1005875 Vali Loss: 0.1546246 Test Loss: 0.2270181
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 57 cost time: 0.9459998607635498
Epoch: 57, Steps: 64 | Train Loss: 0.1000772 Vali Loss: 0.1548756 Test Loss: 0.2278280
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 58 cost time: 0.9472146034240723
Epoch: 58, Steps: 64 | Train Loss: 0.1006601 Vali Loss: 0.1541592 Test Loss: 0.2277537
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 59 cost time: 0.9456498622894287
Epoch: 59, Steps: 64 | Train Loss: 0.1006119 Vali Loss: 0.1534076 Test Loss: 0.2271284
Validation loss decreased (0.153539 --> 0.153408).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 60 cost time: 0.94437575340271
Epoch: 60, Steps: 64 | Train Loss: 0.1000805 Vali Loss: 0.1559594 Test Loss: 0.2276184
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22712841629981995, mae:0.3391505479812622, rse:0.24152933061122894
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05416154861450195 GB
Epoch: 1 cost time: 2.243257761001587
Epoch: 1, Steps: 64 | Train Loss: 1.0743923 Vali Loss: 2.7938790 Test Loss: 4.4751248
Validation loss decreased (inf --> 2.793879).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 2 cost time: 0.8789911270141602
Epoch: 2, Steps: 64 | Train Loss: 0.7970841 Vali Loss: 1.3604513 Test Loss: 2.0885403
Validation loss decreased (2.793879 --> 1.360451).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 3 cost time: 0.8799715042114258
Epoch: 3, Steps: 64 | Train Loss: 0.4611279 Vali Loss: 0.7769559 Test Loss: 1.1270155
Validation loss decreased (1.360451 --> 0.776956).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 4 cost time: 0.857353925704956
Epoch: 4, Steps: 64 | Train Loss: 0.2943848 Vali Loss: 0.4948927 Test Loss: 0.6712176
Validation loss decreased (0.776956 --> 0.494893).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 5 cost time: 0.8546199798583984
Epoch: 5, Steps: 64 | Train Loss: 0.2129421 Vali Loss: 0.3392955 Test Loss: 0.4358548
Validation loss decreased (0.494893 --> 0.339296).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 6 cost time: 0.846365213394165
Epoch: 6, Steps: 64 | Train Loss: 0.1730521 Vali Loss: 0.2702703 Test Loss: 0.3367264
Validation loss decreased (0.339296 --> 0.270270).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 7 cost time: 0.8561902046203613
Epoch: 7, Steps: 64 | Train Loss: 0.1548285 Vali Loss: 0.2248905 Test Loss: 0.2835982
Validation loss decreased (0.270270 --> 0.224891).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 8 cost time: 0.849879264831543
Epoch: 8, Steps: 64 | Train Loss: 0.1435969 Vali Loss: 0.2075733 Test Loss: 0.2599503
Validation loss decreased (0.224891 --> 0.207573).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 9 cost time: 0.8470025062561035
Epoch: 9, Steps: 64 | Train Loss: 0.1376319 Vali Loss: 0.1946453 Test Loss: 0.2479868
Validation loss decreased (0.207573 --> 0.194645).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 10 cost time: 0.8526113033294678
Epoch: 10, Steps: 64 | Train Loss: 0.1339091 Vali Loss: 0.1865768 Test Loss: 0.2408988
Validation loss decreased (0.194645 --> 0.186577).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 11 cost time: 0.839369535446167
Epoch: 11, Steps: 64 | Train Loss: 0.1304859 Vali Loss: 0.1825783 Test Loss: 0.2363035
Validation loss decreased (0.186577 --> 0.182578).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 12 cost time: 0.853463888168335
Epoch: 12, Steps: 64 | Train Loss: 0.1284899 Vali Loss: 0.1777844 Test Loss: 0.2328805
Validation loss decreased (0.182578 --> 0.177784).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 13 cost time: 0.8593399524688721
Epoch: 13, Steps: 64 | Train Loss: 0.1275166 Vali Loss: 0.1766662 Test Loss: 0.2320591
Validation loss decreased (0.177784 --> 0.176666).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 14 cost time: 0.8707029819488525
Epoch: 14, Steps: 64 | Train Loss: 0.1252829 Vali Loss: 0.1750985 Test Loss: 0.2321986
Validation loss decreased (0.176666 --> 0.175098).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 15 cost time: 0.8499999046325684
Epoch: 15, Steps: 64 | Train Loss: 0.1243003 Vali Loss: 0.1729281 Test Loss: 0.2292864
Validation loss decreased (0.175098 --> 0.172928).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 16 cost time: 0.8486053943634033
Epoch: 16, Steps: 64 | Train Loss: 0.1237652 Vali Loss: 0.1688587 Test Loss: 0.2297650
Validation loss decreased (0.172928 --> 0.168859).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 17 cost time: 0.8501052856445312
Epoch: 17, Steps: 64 | Train Loss: 0.1224585 Vali Loss: 0.1691175 Test Loss: 0.2271904
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 18 cost time: 0.8573794364929199
Epoch: 18, Steps: 64 | Train Loss: 0.1218202 Vali Loss: 0.1694363 Test Loss: 0.2288585
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 19 cost time: 0.8474054336547852
Epoch: 19, Steps: 64 | Train Loss: 0.1214509 Vali Loss: 0.1682175 Test Loss: 0.2282996
Validation loss decreased (0.168859 --> 0.168217).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 20 cost time: 0.8554160594940186
Epoch: 20, Steps: 64 | Train Loss: 0.1205337 Vali Loss: 0.1687116 Test Loss: 0.2278536
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 21 cost time: 0.854628324508667
Epoch: 21, Steps: 64 | Train Loss: 0.1199731 Vali Loss: 0.1664539 Test Loss: 0.2265764
Validation loss decreased (0.168217 --> 0.166454).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 22 cost time: 0.8579902648925781
Epoch: 22, Steps: 64 | Train Loss: 0.1192211 Vali Loss: 0.1663951 Test Loss: 0.2265784
Validation loss decreased (0.166454 --> 0.166395).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 23 cost time: 0.8603150844573975
Epoch: 23, Steps: 64 | Train Loss: 0.1194660 Vali Loss: 0.1669601 Test Loss: 0.2284482
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 24 cost time: 0.8487563133239746
Epoch: 24, Steps: 64 | Train Loss: 0.1192665 Vali Loss: 0.1680888 Test Loss: 0.2279694
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 25 cost time: 0.859999418258667
Epoch: 25, Steps: 64 | Train Loss: 0.1187897 Vali Loss: 0.1653867 Test Loss: 0.2271782
Validation loss decreased (0.166395 --> 0.165387).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 26 cost time: 0.827613353729248
Epoch: 26, Steps: 64 | Train Loss: 0.1191669 Vali Loss: 0.1649711 Test Loss: 0.2270653
Validation loss decreased (0.165387 --> 0.164971).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 27 cost time: 0.8503363132476807
Epoch: 27, Steps: 64 | Train Loss: 0.1183078 Vali Loss: 0.1659176 Test Loss: 0.2265853
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 28 cost time: 0.8471114635467529
Epoch: 28, Steps: 64 | Train Loss: 0.1176288 Vali Loss: 0.1660628 Test Loss: 0.2267013
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 29 cost time: 0.8606770038604736
Epoch: 29, Steps: 64 | Train Loss: 0.1176080 Vali Loss: 0.1650587 Test Loss: 0.2273872
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 30 cost time: 0.8570001125335693
Epoch: 30, Steps: 64 | Train Loss: 0.1176236 Vali Loss: 0.1661639 Test Loss: 0.2268926
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 31 cost time: 0.8543224334716797
Epoch: 31, Steps: 64 | Train Loss: 0.1174353 Vali Loss: 0.1652752 Test Loss: 0.2257294
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 32 cost time: 0.8513998985290527
Epoch: 32, Steps: 64 | Train Loss: 0.1176356 Vali Loss: 0.1646345 Test Loss: 0.2262029
Validation loss decreased (0.164971 --> 0.164635).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 33 cost time: 0.8513200283050537
Epoch: 33, Steps: 64 | Train Loss: 0.1168518 Vali Loss: 0.1646381 Test Loss: 0.2262076
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 34 cost time: 0.846754789352417
Epoch: 34, Steps: 64 | Train Loss: 0.1178199 Vali Loss: 0.1654331 Test Loss: 0.2266487
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 35 cost time: 0.847449541091919
Epoch: 35, Steps: 64 | Train Loss: 0.1167137 Vali Loss: 0.1642277 Test Loss: 0.2260900
Validation loss decreased (0.164635 --> 0.164228).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 36 cost time: 0.8460550308227539
Epoch: 36, Steps: 64 | Train Loss: 0.1167681 Vali Loss: 0.1641270 Test Loss: 0.2258799
Validation loss decreased (0.164228 --> 0.164127).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 37 cost time: 0.8541266918182373
Epoch: 37, Steps: 64 | Train Loss: 0.1169102 Vali Loss: 0.1642241 Test Loss: 0.2269067
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 38 cost time: 0.8563668727874756
Epoch: 38, Steps: 64 | Train Loss: 0.1167550 Vali Loss: 0.1642039 Test Loss: 0.2261735
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 39 cost time: 0.8557348251342773
Epoch: 39, Steps: 64 | Train Loss: 0.1164157 Vali Loss: 0.1639431 Test Loss: 0.2256762
Validation loss decreased (0.164127 --> 0.163943).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 40 cost time: 0.873999834060669
Epoch: 40, Steps: 64 | Train Loss: 0.1167851 Vali Loss: 0.1642310 Test Loss: 0.2269172
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 41 cost time: 0.8586306571960449
Epoch: 41, Steps: 64 | Train Loss: 0.1166919 Vali Loss: 0.1638954 Test Loss: 0.2265545
Validation loss decreased (0.163943 --> 0.163895).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 42 cost time: 0.8585150241851807
Epoch: 42, Steps: 64 | Train Loss: 0.1169206 Vali Loss: 0.1652678 Test Loss: 0.2258866
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 43 cost time: 0.8553750514984131
Epoch: 43, Steps: 64 | Train Loss: 0.1160682 Vali Loss: 0.1642387 Test Loss: 0.2266121
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 44 cost time: 0.8646228313446045
Epoch: 44, Steps: 64 | Train Loss: 0.1162087 Vali Loss: 0.1641698 Test Loss: 0.2262540
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 45 cost time: 0.8519995212554932
Epoch: 45, Steps: 64 | Train Loss: 0.1161874 Vali Loss: 0.1644817 Test Loss: 0.2269618
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 46 cost time: 0.8476247787475586
Epoch: 46, Steps: 64 | Train Loss: 0.1160680 Vali Loss: 0.1631020 Test Loss: 0.2266839
Validation loss decreased (0.163895 --> 0.163102).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 47 cost time: 0.8564209938049316
Epoch: 47, Steps: 64 | Train Loss: 0.1163392 Vali Loss: 0.1636755 Test Loss: 0.2258888
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 48 cost time: 0.8525660037994385
Epoch: 48, Steps: 64 | Train Loss: 0.1163643 Vali Loss: 0.1611833 Test Loss: 0.2251638
Validation loss decreased (0.163102 --> 0.161183).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 49 cost time: 0.9025461673736572
Epoch: 49, Steps: 64 | Train Loss: 0.1165130 Vali Loss: 0.1637976 Test Loss: 0.2273868
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 50 cost time: 0.8533644676208496
Epoch: 50, Steps: 64 | Train Loss: 0.1167234 Vali Loss: 0.1632506 Test Loss: 0.2253874
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 51 cost time: 0.8679995536804199
Epoch: 51, Steps: 64 | Train Loss: 0.1159606 Vali Loss: 0.1628900 Test Loss: 0.2258117
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 52 cost time: 0.8216230869293213
Epoch: 52, Steps: 64 | Train Loss: 0.1156432 Vali Loss: 0.1620661 Test Loss: 0.2260645
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 53 cost time: 0.8483829498291016
Epoch: 53, Steps: 64 | Train Loss: 0.1162376 Vali Loss: 0.1646611 Test Loss: 0.2255888
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 54 cost time: 0.8453567028045654
Epoch: 54, Steps: 64 | Train Loss: 0.1161459 Vali Loss: 0.1647280 Test Loss: 0.2257015
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 55 cost time: 0.8571324348449707
Epoch: 55, Steps: 64 | Train Loss: 0.1159405 Vali Loss: 0.1624399 Test Loss: 0.2261256
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 56 cost time: 0.8550009727478027
Epoch: 56, Steps: 64 | Train Loss: 0.1161863 Vali Loss: 0.1643985 Test Loss: 0.2257743
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 57 cost time: 0.8556087017059326
Epoch: 57, Steps: 64 | Train Loss: 0.1161136 Vali Loss: 0.1634902 Test Loss: 0.2255059
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 58 cost time: 0.8563780784606934
Epoch: 58, Steps: 64 | Train Loss: 0.1151499 Vali Loss: 0.1636443 Test Loss: 0.2267201
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 59 cost time: 0.8693649768829346
Epoch: 59, Steps: 64 | Train Loss: 0.1157782 Vali Loss: 0.1625409 Test Loss: 0.2256778
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 60 cost time: 0.8537933826446533
Epoch: 60, Steps: 64 | Train Loss: 0.1157601 Vali Loss: 0.1640092 Test Loss: 0.2255105
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2251638025045395, mae:0.32748183608055115, rse:0.24048247933387756
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05855607986450195 GB
Epoch: 1 cost time: 2.288088321685791
Epoch: 1, Steps: 64 | Train Loss: 0.9232819 Vali Loss: 2.4238861 Test Loss: 3.8501766
Validation loss decreased (inf --> 2.423886).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 2 cost time: 0.890249490737915
Epoch: 2, Steps: 64 | Train Loss: 0.4467793 Vali Loss: 0.2584056 Test Loss: 0.3013626
Validation loss decreased (2.423886 --> 0.258406).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 3 cost time: 0.8707013130187988
Epoch: 3, Steps: 64 | Train Loss: 0.1361589 Vali Loss: 0.1801127 Test Loss: 0.2204401
Validation loss decreased (0.258406 --> 0.180113).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 4 cost time: 0.8913509845733643
Epoch: 4, Steps: 64 | Train Loss: 0.1231779 Vali Loss: 0.1716347 Test Loss: 0.2208611
Validation loss decreased (0.180113 --> 0.171635).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 5 cost time: 0.8910496234893799
Epoch: 5, Steps: 64 | Train Loss: 0.1177011 Vali Loss: 0.1659226 Test Loss: 0.2183223
Validation loss decreased (0.171635 --> 0.165923).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 6 cost time: 0.8978424072265625
Epoch: 6, Steps: 64 | Train Loss: 0.1151050 Vali Loss: 0.1640186 Test Loss: 0.2182614
Validation loss decreased (0.165923 --> 0.164019).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 7 cost time: 0.8829996585845947
Epoch: 7, Steps: 64 | Train Loss: 0.1133496 Vali Loss: 0.1594055 Test Loss: 0.2173711
Validation loss decreased (0.164019 --> 0.159406).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 8 cost time: 0.8850007057189941
Epoch: 8, Steps: 64 | Train Loss: 0.1104947 Vali Loss: 0.1585723 Test Loss: 0.2163331
Validation loss decreased (0.159406 --> 0.158572).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 9 cost time: 0.8850681781768799
Epoch: 9, Steps: 64 | Train Loss: 0.1088987 Vali Loss: 0.1589178 Test Loss: 0.2184137
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 10 cost time: 0.8812112808227539
Epoch: 10, Steps: 64 | Train Loss: 0.1081089 Vali Loss: 0.1544374 Test Loss: 0.2174613
Validation loss decreased (0.158572 --> 0.154437).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 11 cost time: 0.8894193172454834
Epoch: 11, Steps: 64 | Train Loss: 0.1070075 Vali Loss: 0.1552339 Test Loss: 0.2179284
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 12 cost time: 0.8983895778656006
Epoch: 12, Steps: 64 | Train Loss: 0.1058484 Vali Loss: 0.1564309 Test Loss: 0.2184531
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 13 cost time: 0.9087502956390381
Epoch: 13, Steps: 64 | Train Loss: 0.1054489 Vali Loss: 0.1544405 Test Loss: 0.2179823
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 14 cost time: 0.8900001049041748
Epoch: 14, Steps: 64 | Train Loss: 0.1046667 Vali Loss: 0.1556117 Test Loss: 0.2196898
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 15 cost time: 0.8946287631988525
Epoch: 15, Steps: 64 | Train Loss: 0.1039703 Vali Loss: 0.1530191 Test Loss: 0.2183144
Validation loss decreased (0.154437 --> 0.153019).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 16 cost time: 0.8944051265716553
Epoch: 16, Steps: 64 | Train Loss: 0.1034965 Vali Loss: 0.1524474 Test Loss: 0.2193929
Validation loss decreased (0.153019 --> 0.152447).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 17 cost time: 0.8931581974029541
Epoch: 17, Steps: 64 | Train Loss: 0.1030399 Vali Loss: 0.1525917 Test Loss: 0.2190744
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 18 cost time: 0.8879897594451904
Epoch: 18, Steps: 64 | Train Loss: 0.1028888 Vali Loss: 0.1525850 Test Loss: 0.2200500
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 19 cost time: 0.8999791145324707
Epoch: 19, Steps: 64 | Train Loss: 0.1027148 Vali Loss: 0.1501266 Test Loss: 0.2192359
Validation loss decreased (0.152447 --> 0.150127).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 20 cost time: 0.905998945236206
Epoch: 20, Steps: 64 | Train Loss: 0.1021350 Vali Loss: 0.1522650 Test Loss: 0.2184925
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 21 cost time: 0.9036123752593994
Epoch: 21, Steps: 64 | Train Loss: 0.1017819 Vali Loss: 0.1503547 Test Loss: 0.2198768
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 22 cost time: 0.8959569931030273
Epoch: 22, Steps: 64 | Train Loss: 0.1016727 Vali Loss: 0.1510787 Test Loss: 0.2203767
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 23 cost time: 0.8893849849700928
Epoch: 23, Steps: 64 | Train Loss: 0.1009768 Vali Loss: 0.1499741 Test Loss: 0.2202509
Validation loss decreased (0.150127 --> 0.149974).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 24 cost time: 0.8834760189056396
Epoch: 24, Steps: 64 | Train Loss: 0.1016315 Vali Loss: 0.1511532 Test Loss: 0.2203630
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 25 cost time: 0.8833432197570801
Epoch: 25, Steps: 64 | Train Loss: 0.1009916 Vali Loss: 0.1499967 Test Loss: 0.2194069
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 26 cost time: 0.8867392539978027
Epoch: 26, Steps: 64 | Train Loss: 0.1008263 Vali Loss: 0.1494114 Test Loss: 0.2204024
Validation loss decreased (0.149974 --> 0.149411).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 27 cost time: 0.8900012969970703
Epoch: 27, Steps: 64 | Train Loss: 0.1002209 Vali Loss: 0.1491880 Test Loss: 0.2203597
Validation loss decreased (0.149411 --> 0.149188).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 28 cost time: 0.9006054401397705
Epoch: 28, Steps: 64 | Train Loss: 0.1008348 Vali Loss: 0.1490991 Test Loss: 0.2203851
Validation loss decreased (0.149188 --> 0.149099).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 29 cost time: 0.9023981094360352
Epoch: 29, Steps: 64 | Train Loss: 0.1006392 Vali Loss: 0.1498511 Test Loss: 0.2204024
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 30 cost time: 0.8993220329284668
Epoch: 30, Steps: 64 | Train Loss: 0.1003913 Vali Loss: 0.1496720 Test Loss: 0.2205572
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 31 cost time: 0.8835349082946777
Epoch: 31, Steps: 64 | Train Loss: 0.1004001 Vali Loss: 0.1490427 Test Loss: 0.2207824
Validation loss decreased (0.149099 --> 0.149043).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 32 cost time: 0.8867356777191162
Epoch: 32, Steps: 64 | Train Loss: 0.1001521 Vali Loss: 0.1491122 Test Loss: 0.2198482
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 33 cost time: 0.8899998664855957
Epoch: 33, Steps: 64 | Train Loss: 0.1003360 Vali Loss: 0.1486957 Test Loss: 0.2203465
Validation loss decreased (0.149043 --> 0.148696).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 34 cost time: 0.9006271362304688
Epoch: 34, Steps: 64 | Train Loss: 0.0997576 Vali Loss: 0.1514685 Test Loss: 0.2205066
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 35 cost time: 0.8868038654327393
Epoch: 35, Steps: 64 | Train Loss: 0.1001357 Vali Loss: 0.1487392 Test Loss: 0.2208940
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 36 cost time: 0.893338680267334
Epoch: 36, Steps: 64 | Train Loss: 0.1001306 Vali Loss: 0.1501970 Test Loss: 0.2203782
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 37 cost time: 0.8953676223754883
Epoch: 37, Steps: 64 | Train Loss: 0.1000601 Vali Loss: 0.1515070 Test Loss: 0.2213044
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 38 cost time: 0.9067561626434326
Epoch: 38, Steps: 64 | Train Loss: 0.0997378 Vali Loss: 0.1484685 Test Loss: 0.2205581
Validation loss decreased (0.148696 --> 0.148469).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 39 cost time: 0.888216495513916
Epoch: 39, Steps: 64 | Train Loss: 0.0997752 Vali Loss: 0.1500905 Test Loss: 0.2207531
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 40 cost time: 0.8906223773956299
Epoch: 40, Steps: 64 | Train Loss: 0.0997224 Vali Loss: 0.1493276 Test Loss: 0.2205175
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 41 cost time: 0.8946115970611572
Epoch: 41, Steps: 64 | Train Loss: 0.0995905 Vali Loss: 0.1496371 Test Loss: 0.2211747
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 42 cost time: 0.8891184329986572
Epoch: 42, Steps: 64 | Train Loss: 0.1000042 Vali Loss: 0.1491844 Test Loss: 0.2210107
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 43 cost time: 0.8914682865142822
Epoch: 43, Steps: 64 | Train Loss: 0.0995524 Vali Loss: 0.1490656 Test Loss: 0.2205469
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 44 cost time: 0.8867847919464111
Epoch: 44, Steps: 64 | Train Loss: 0.0996261 Vali Loss: 0.1488620 Test Loss: 0.2204921
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 45 cost time: 0.880739688873291
Epoch: 45, Steps: 64 | Train Loss: 0.0993864 Vali Loss: 0.1472114 Test Loss: 0.2206549
Validation loss decreased (0.148469 --> 0.147211).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 46 cost time: 0.869915246963501
Epoch: 46, Steps: 64 | Train Loss: 0.0994213 Vali Loss: 0.1485822 Test Loss: 0.2211247
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 47 cost time: 0.8946189880371094
Epoch: 47, Steps: 64 | Train Loss: 0.0996101 Vali Loss: 0.1496344 Test Loss: 0.2215733
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 48 cost time: 0.8911697864532471
Epoch: 48, Steps: 64 | Train Loss: 0.0994213 Vali Loss: 0.1486009 Test Loss: 0.2206487
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 49 cost time: 0.8843767642974854
Epoch: 49, Steps: 64 | Train Loss: 0.0997677 Vali Loss: 0.1492291 Test Loss: 0.2222462
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 50 cost time: 0.885850191116333
Epoch: 50, Steps: 64 | Train Loss: 0.0993960 Vali Loss: 0.1493058 Test Loss: 0.2210360
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 51 cost time: 0.8858091831207275
Epoch: 51, Steps: 64 | Train Loss: 0.0998412 Vali Loss: 0.1488324 Test Loss: 0.2207871
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 52 cost time: 0.8899998664855957
Epoch: 52, Steps: 64 | Train Loss: 0.0998038 Vali Loss: 0.1488349 Test Loss: 0.2208233
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 53 cost time: 0.888624906539917
Epoch: 53, Steps: 64 | Train Loss: 0.0997443 Vali Loss: 0.1495378 Test Loss: 0.2210148
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 54 cost time: 0.8958737850189209
Epoch: 54, Steps: 64 | Train Loss: 0.0996893 Vali Loss: 0.1477585 Test Loss: 0.2205698
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 55 cost time: 0.8943800926208496
Epoch: 55, Steps: 64 | Train Loss: 0.0993477 Vali Loss: 0.1501788 Test Loss: 0.2204590
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 56 cost time: 0.8993535041809082
Epoch: 56, Steps: 64 | Train Loss: 0.0994338 Vali Loss: 0.1481233 Test Loss: 0.2213125
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 57 cost time: 0.8924057483673096
Epoch: 57, Steps: 64 | Train Loss: 0.0993868 Vali Loss: 0.1499727 Test Loss: 0.2207619
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 58 cost time: 0.8879997730255127
Epoch: 58, Steps: 64 | Train Loss: 0.0999367 Vali Loss: 0.1491334 Test Loss: 0.2212487
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 59 cost time: 0.8986263275146484
Epoch: 59, Steps: 64 | Train Loss: 0.0996254 Vali Loss: 0.1496022 Test Loss: 0.2205441
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 60 cost time: 0.8885867595672607
Epoch: 60, Steps: 64 | Train Loss: 0.0993195 Vali Loss: 0.1488651 Test Loss: 0.2210428
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22065487504005432, mae:0.32092559337615967, rse:0.23806245625019073
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06185483932495117 GB
Epoch: 1 cost time: 2.3187851905822754
Epoch: 1, Steps: 64 | Train Loss: 0.8649927 Vali Loss: 2.3114128 Test Loss: 3.6833997
Validation loss decreased (inf --> 2.311413).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 2 cost time: 0.9497196674346924
Epoch: 2, Steps: 64 | Train Loss: 0.3588458 Vali Loss: 0.2569621 Test Loss: 0.3268979
Validation loss decreased (2.311413 --> 0.256962).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 3 cost time: 0.8223922252655029
Epoch: 3, Steps: 64 | Train Loss: 0.1318601 Vali Loss: 0.1810157 Test Loss: 0.2265739
Validation loss decreased (0.256962 --> 0.181016).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 4 cost time: 0.834789514541626
Epoch: 4, Steps: 64 | Train Loss: 0.1184524 Vali Loss: 0.1772542 Test Loss: 0.2262373
Validation loss decreased (0.181016 --> 0.177254).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 5 cost time: 0.8589997291564941
Epoch: 5, Steps: 64 | Train Loss: 0.1152290 Vali Loss: 0.1719262 Test Loss: 0.2189367
Validation loss decreased (0.177254 --> 0.171926).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 6 cost time: 0.861616849899292
Epoch: 6, Steps: 64 | Train Loss: 0.1125913 Vali Loss: 0.1642646 Test Loss: 0.2178355
Validation loss decreased (0.171926 --> 0.164265).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 7 cost time: 0.8574309349060059
Epoch: 7, Steps: 64 | Train Loss: 0.1109670 Vali Loss: 0.1659851 Test Loss: 0.2178189
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 8 cost time: 0.8604221343994141
Epoch: 8, Steps: 64 | Train Loss: 0.1094743 Vali Loss: 0.1654985 Test Loss: 0.2176477
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 9 cost time: 0.8593535423278809
Epoch: 9, Steps: 64 | Train Loss: 0.1084948 Vali Loss: 0.1613708 Test Loss: 0.2161874
Validation loss decreased (0.164265 --> 0.161371).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 10 cost time: 0.8547790050506592
Epoch: 10, Steps: 64 | Train Loss: 0.1078678 Vali Loss: 0.1612049 Test Loss: 0.2156593
Validation loss decreased (0.161371 --> 0.161205).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 11 cost time: 0.8553438186645508
Epoch: 11, Steps: 64 | Train Loss: 0.1064599 Vali Loss: 0.1592828 Test Loss: 0.2163276
Validation loss decreased (0.161205 --> 0.159283).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 12 cost time: 0.8576183319091797
Epoch: 12, Steps: 64 | Train Loss: 0.1064579 Vali Loss: 0.1591056 Test Loss: 0.2158649
Validation loss decreased (0.159283 --> 0.159106).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 13 cost time: 0.8541271686553955
Epoch: 13, Steps: 64 | Train Loss: 0.1054472 Vali Loss: 0.1572469 Test Loss: 0.2167357
Validation loss decreased (0.159106 --> 0.157247).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 14 cost time: 0.858349084854126
Epoch: 14, Steps: 64 | Train Loss: 0.1049492 Vali Loss: 0.1581851 Test Loss: 0.2180655
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 15 cost time: 0.8568301200866699
Epoch: 15, Steps: 64 | Train Loss: 0.1045059 Vali Loss: 0.1571346 Test Loss: 0.2160593
Validation loss decreased (0.157247 --> 0.157135).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 16 cost time: 0.8556199073791504
Epoch: 16, Steps: 64 | Train Loss: 0.1041603 Vali Loss: 0.1566919 Test Loss: 0.2169959
Validation loss decreased (0.157135 --> 0.156692).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 17 cost time: 0.8686168193817139
Epoch: 17, Steps: 64 | Train Loss: 0.1036816 Vali Loss: 0.1555396 Test Loss: 0.2165378
Validation loss decreased (0.156692 --> 0.155540).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 18 cost time: 0.8526206016540527
Epoch: 18, Steps: 64 | Train Loss: 0.1033022 Vali Loss: 0.1543145 Test Loss: 0.2154962
Validation loss decreased (0.155540 --> 0.154314).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 19 cost time: 0.860386848449707
Epoch: 19, Steps: 64 | Train Loss: 0.1029453 Vali Loss: 0.1564707 Test Loss: 0.2174233
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 20 cost time: 0.8523666858673096
Epoch: 20, Steps: 64 | Train Loss: 0.1025574 Vali Loss: 0.1524571 Test Loss: 0.2166891
Validation loss decreased (0.154314 --> 0.152457).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 21 cost time: 0.8707363605499268
Epoch: 21, Steps: 64 | Train Loss: 0.1023223 Vali Loss: 0.1535445 Test Loss: 0.2169325
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 22 cost time: 0.86100172996521
Epoch: 22, Steps: 64 | Train Loss: 0.1022748 Vali Loss: 0.1520278 Test Loss: 0.2178515
Validation loss decreased (0.152457 --> 0.152028).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 23 cost time: 0.8536331653594971
Epoch: 23, Steps: 64 | Train Loss: 0.1013404 Vali Loss: 0.1527945 Test Loss: 0.2173727
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 24 cost time: 0.8563456535339355
Epoch: 24, Steps: 64 | Train Loss: 0.1015416 Vali Loss: 0.1524398 Test Loss: 0.2177738
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 25 cost time: 0.8549964427947998
Epoch: 25, Steps: 64 | Train Loss: 0.1015966 Vali Loss: 0.1501660 Test Loss: 0.2167519
Validation loss decreased (0.152028 --> 0.150166).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 26 cost time: 0.8534014225006104
Epoch: 26, Steps: 64 | Train Loss: 0.1014523 Vali Loss: 0.1528616 Test Loss: 0.2177542
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 27 cost time: 0.8540000915527344
Epoch: 27, Steps: 64 | Train Loss: 0.1011808 Vali Loss: 0.1525739 Test Loss: 0.2175214
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 28 cost time: 0.8496136665344238
Epoch: 28, Steps: 64 | Train Loss: 0.1007972 Vali Loss: 0.1518956 Test Loss: 0.2180792
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 29 cost time: 0.8578627109527588
Epoch: 29, Steps: 64 | Train Loss: 0.1002871 Vali Loss: 0.1520778 Test Loss: 0.2180958
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 30 cost time: 0.8543643951416016
Epoch: 30, Steps: 64 | Train Loss: 0.1004249 Vali Loss: 0.1508326 Test Loss: 0.2178218
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 31 cost time: 0.855388879776001
Epoch: 31, Steps: 64 | Train Loss: 0.1005122 Vali Loss: 0.1504277 Test Loss: 0.2182584
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 32 cost time: 0.8561074733734131
Epoch: 32, Steps: 64 | Train Loss: 0.1004665 Vali Loss: 0.1488355 Test Loss: 0.2183872
Validation loss decreased (0.150166 --> 0.148836).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 33 cost time: 0.8733441829681396
Epoch: 33, Steps: 64 | Train Loss: 0.1000624 Vali Loss: 0.1502522 Test Loss: 0.2178683
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 34 cost time: 0.8745949268341064
Epoch: 34, Steps: 64 | Train Loss: 0.1002804 Vali Loss: 0.1507095 Test Loss: 0.2180913
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 35 cost time: 0.8883376121520996
Epoch: 35, Steps: 64 | Train Loss: 0.1004140 Vali Loss: 0.1502451 Test Loss: 0.2180171
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 36 cost time: 0.8713366985321045
Epoch: 36, Steps: 64 | Train Loss: 0.1002019 Vali Loss: 0.1481210 Test Loss: 0.2178754
Validation loss decreased (0.148836 --> 0.148121).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 37 cost time: 0.8747737407684326
Epoch: 37, Steps: 64 | Train Loss: 0.1000999 Vali Loss: 0.1500267 Test Loss: 0.2181362
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 38 cost time: 0.8727378845214844
Epoch: 38, Steps: 64 | Train Loss: 0.1000775 Vali Loss: 0.1514764 Test Loss: 0.2183113
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 39 cost time: 0.8816020488739014
Epoch: 39, Steps: 64 | Train Loss: 0.1004977 Vali Loss: 0.1489019 Test Loss: 0.2182811
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 40 cost time: 0.8666017055511475
Epoch: 40, Steps: 64 | Train Loss: 0.1001170 Vali Loss: 0.1504560 Test Loss: 0.2181355
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 41 cost time: 0.8784003257751465
Epoch: 41, Steps: 64 | Train Loss: 0.1004258 Vali Loss: 0.1490781 Test Loss: 0.2179149
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 42 cost time: 0.867680549621582
Epoch: 42, Steps: 64 | Train Loss: 0.0998656 Vali Loss: 0.1485699 Test Loss: 0.2183469
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 43 cost time: 0.8760538101196289
Epoch: 43, Steps: 64 | Train Loss: 0.0999276 Vali Loss: 0.1496906 Test Loss: 0.2181877
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 44 cost time: 0.8737080097198486
Epoch: 44, Steps: 64 | Train Loss: 0.0998904 Vali Loss: 0.1500966 Test Loss: 0.2179592
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 45 cost time: 0.8724236488342285
Epoch: 45, Steps: 64 | Train Loss: 0.0995930 Vali Loss: 0.1484795 Test Loss: 0.2178679
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 46 cost time: 0.8765971660614014
Epoch: 46, Steps: 64 | Train Loss: 0.0997962 Vali Loss: 0.1492123 Test Loss: 0.2182488
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 47 cost time: 0.8771102428436279
Epoch: 47, Steps: 64 | Train Loss: 0.0996268 Vali Loss: 0.1489357 Test Loss: 0.2183418
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 48 cost time: 0.8743455410003662
Epoch: 48, Steps: 64 | Train Loss: 0.0999542 Vali Loss: 0.1493179 Test Loss: 0.2182475
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 49 cost time: 0.8723032474517822
Epoch: 49, Steps: 64 | Train Loss: 0.0994188 Vali Loss: 0.1492128 Test Loss: 0.2184106
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 50 cost time: 0.8577220439910889
Epoch: 50, Steps: 64 | Train Loss: 0.0996590 Vali Loss: 0.1494847 Test Loss: 0.2184877
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 51 cost time: 0.8569986820220947
Epoch: 51, Steps: 64 | Train Loss: 0.0996224 Vali Loss: 0.1492475 Test Loss: 0.2180164
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 52 cost time: 0.8715982437133789
Epoch: 52, Steps: 64 | Train Loss: 0.0999112 Vali Loss: 0.1484069 Test Loss: 0.2185534
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 53 cost time: 0.8734748363494873
Epoch: 53, Steps: 64 | Train Loss: 0.0998377 Vali Loss: 0.1487063 Test Loss: 0.2179568
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 54 cost time: 0.8733155727386475
Epoch: 54, Steps: 64 | Train Loss: 0.1001011 Vali Loss: 0.1490137 Test Loss: 0.2185456
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 55 cost time: 0.8748116493225098
Epoch: 55, Steps: 64 | Train Loss: 0.0995353 Vali Loss: 0.1500570 Test Loss: 0.2182517
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 56 cost time: 0.8713905811309814
Epoch: 56, Steps: 64 | Train Loss: 0.0994791 Vali Loss: 0.1490328 Test Loss: 0.2183561
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 57 cost time: 0.8580009937286377
Epoch: 57, Steps: 64 | Train Loss: 0.0997189 Vali Loss: 0.1493056 Test Loss: 0.2182749
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 58 cost time: 0.8703560829162598
Epoch: 58, Steps: 64 | Train Loss: 0.0994953 Vali Loss: 0.1488995 Test Loss: 0.2184685
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 59 cost time: 0.8694021701812744
Epoch: 59, Steps: 64 | Train Loss: 0.0993479 Vali Loss: 0.1494430 Test Loss: 0.2184152
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 60 cost time: 0.8683185577392578
Epoch: 60, Steps: 64 | Train Loss: 0.0996416 Vali Loss: 0.1498479 Test Loss: 0.2187056
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2178753763437271, mae:0.31830331683158875, rse:0.23655831813812256
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.054323673248291016 GB
Epoch: 1 cost time: 2.2339060306549072
Epoch: 1, Steps: 64 | Train Loss: 0.9376677 Vali Loss: 2.3847599 Test Loss: 3.8153646
Validation loss decreased (inf --> 2.384760).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 2 cost time: 0.8861901760101318
Epoch: 2, Steps: 64 | Train Loss: 0.6895324 Vali Loss: 1.1573938 Test Loss: 1.7860707
Validation loss decreased (2.384760 --> 1.157394).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 3 cost time: 0.8825962543487549
Epoch: 3, Steps: 64 | Train Loss: 0.3884152 Vali Loss: 0.5713888 Test Loss: 0.8276697
Validation loss decreased (1.157394 --> 0.571389).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 4 cost time: 0.8803446292877197
Epoch: 4, Steps: 64 | Train Loss: 0.2418883 Vali Loss: 0.3639408 Test Loss: 0.5143403
Validation loss decreased (0.571389 --> 0.363941).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 5 cost time: 0.883371114730835
Epoch: 5, Steps: 64 | Train Loss: 0.1780344 Vali Loss: 0.2585251 Test Loss: 0.3510511
Validation loss decreased (0.363941 --> 0.258525).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 6 cost time: 0.8798911571502686
Epoch: 6, Steps: 64 | Train Loss: 0.1516651 Vali Loss: 0.2162550 Test Loss: 0.2881336
Validation loss decreased (0.258525 --> 0.216255).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 7 cost time: 0.8787143230438232
Epoch: 7, Steps: 64 | Train Loss: 0.1402952 Vali Loss: 0.1939197 Test Loss: 0.2557062
Validation loss decreased (0.216255 --> 0.193920).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 8 cost time: 0.871999979019165
Epoch: 8, Steps: 64 | Train Loss: 0.1342612 Vali Loss: 0.1827497 Test Loss: 0.2418161
Validation loss decreased (0.193920 --> 0.182750).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 9 cost time: 0.8808925151824951
Epoch: 9, Steps: 64 | Train Loss: 0.1294972 Vali Loss: 0.1761347 Test Loss: 0.2333958
Validation loss decreased (0.182750 --> 0.176135).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 10 cost time: 0.8830740451812744
Epoch: 10, Steps: 64 | Train Loss: 0.1272409 Vali Loss: 0.1756609 Test Loss: 0.2298426
Validation loss decreased (0.176135 --> 0.175661).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 11 cost time: 0.8914785385131836
Epoch: 11, Steps: 64 | Train Loss: 0.1259417 Vali Loss: 0.1712722 Test Loss: 0.2269685
Validation loss decreased (0.175661 --> 0.171272).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 12 cost time: 0.8883094787597656
Epoch: 12, Steps: 64 | Train Loss: 0.1241055 Vali Loss: 0.1702798 Test Loss: 0.2257924
Validation loss decreased (0.171272 --> 0.170280).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 13 cost time: 0.887310266494751
Epoch: 13, Steps: 64 | Train Loss: 0.1228655 Vali Loss: 0.1685170 Test Loss: 0.2248425
Validation loss decreased (0.170280 --> 0.168517).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 14 cost time: 0.8847358226776123
Epoch: 14, Steps: 64 | Train Loss: 0.1223938 Vali Loss: 0.1669461 Test Loss: 0.2235307
Validation loss decreased (0.168517 --> 0.166946).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 15 cost time: 0.8826048374176025
Epoch: 15, Steps: 64 | Train Loss: 0.1209735 Vali Loss: 0.1681834 Test Loss: 0.2246249
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 16 cost time: 0.8785989284515381
Epoch: 16, Steps: 64 | Train Loss: 0.1200625 Vali Loss: 0.1697936 Test Loss: 0.2240816
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 17 cost time: 0.8783328533172607
Epoch: 17, Steps: 64 | Train Loss: 0.1200792 Vali Loss: 0.1657431 Test Loss: 0.2230826
Validation loss decreased (0.166946 --> 0.165743).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 18 cost time: 0.8773965835571289
Epoch: 18, Steps: 64 | Train Loss: 0.1192377 Vali Loss: 0.1662875 Test Loss: 0.2231948
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 19 cost time: 0.8813376426696777
Epoch: 19, Steps: 64 | Train Loss: 0.1186876 Vali Loss: 0.1660996 Test Loss: 0.2227219
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 20 cost time: 0.8816003799438477
Epoch: 20, Steps: 64 | Train Loss: 0.1184084 Vali Loss: 0.1643975 Test Loss: 0.2215627
Validation loss decreased (0.165743 --> 0.164397).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 21 cost time: 0.8849999904632568
Epoch: 21, Steps: 64 | Train Loss: 0.1175910 Vali Loss: 0.1652188 Test Loss: 0.2229788
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 22 cost time: 0.8896021842956543
Epoch: 22, Steps: 64 | Train Loss: 0.1177356 Vali Loss: 0.1631939 Test Loss: 0.2214831
Validation loss decreased (0.164397 --> 0.163194).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 23 cost time: 0.8824083805084229
Epoch: 23, Steps: 64 | Train Loss: 0.1170846 Vali Loss: 0.1647122 Test Loss: 0.2215856
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 24 cost time: 0.878347635269165
Epoch: 24, Steps: 64 | Train Loss: 0.1171723 Vali Loss: 0.1639828 Test Loss: 0.2218051
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 25 cost time: 0.87528395652771
Epoch: 25, Steps: 64 | Train Loss: 0.1162225 Vali Loss: 0.1651569 Test Loss: 0.2214822
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 26 cost time: 0.8610007762908936
Epoch: 26, Steps: 64 | Train Loss: 0.1162408 Vali Loss: 0.1627692 Test Loss: 0.2223395
Validation loss decreased (0.163194 --> 0.162769).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 27 cost time: 0.8749997615814209
Epoch: 27, Steps: 64 | Train Loss: 0.1159441 Vali Loss: 0.1624710 Test Loss: 0.2208883
Validation loss decreased (0.162769 --> 0.162471).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 28 cost time: 0.8823568820953369
Epoch: 28, Steps: 64 | Train Loss: 0.1159784 Vali Loss: 0.1627285 Test Loss: 0.2205354
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 29 cost time: 0.8889510631561279
Epoch: 29, Steps: 64 | Train Loss: 0.1158307 Vali Loss: 0.1635061 Test Loss: 0.2207195
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 30 cost time: 0.8863925933837891
Epoch: 30, Steps: 64 | Train Loss: 0.1154883 Vali Loss: 0.1645170 Test Loss: 0.2234175
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 31 cost time: 0.8870303630828857
Epoch: 31, Steps: 64 | Train Loss: 0.1154182 Vali Loss: 0.1631242 Test Loss: 0.2210491
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 32 cost time: 0.8810000419616699
Epoch: 32, Steps: 64 | Train Loss: 0.1152199 Vali Loss: 0.1619957 Test Loss: 0.2214173
Validation loss decreased (0.162471 --> 0.161996).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 33 cost time: 0.8813393115997314
Epoch: 33, Steps: 64 | Train Loss: 0.1157346 Vali Loss: 0.1619258 Test Loss: 0.2208970
Validation loss decreased (0.161996 --> 0.161926).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 34 cost time: 0.8756139278411865
Epoch: 34, Steps: 64 | Train Loss: 0.1151635 Vali Loss: 0.1628050 Test Loss: 0.2216074
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 35 cost time: 0.8783650398254395
Epoch: 35, Steps: 64 | Train Loss: 0.1151259 Vali Loss: 0.1625098 Test Loss: 0.2211482
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 36 cost time: 0.876305103302002
Epoch: 36, Steps: 64 | Train Loss: 0.1152349 Vali Loss: 0.1620453 Test Loss: 0.2212298
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 37 cost time: 0.8868350982666016
Epoch: 37, Steps: 64 | Train Loss: 0.1146568 Vali Loss: 0.1591728 Test Loss: 0.2202620
Validation loss decreased (0.161926 --> 0.159173).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 38 cost time: 0.8870000839233398
Epoch: 38, Steps: 64 | Train Loss: 0.1143873 Vali Loss: 0.1624333 Test Loss: 0.2203370
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 39 cost time: 0.8816025257110596
Epoch: 39, Steps: 64 | Train Loss: 0.1145772 Vali Loss: 0.1618121 Test Loss: 0.2213215
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 40 cost time: 0.8923871517181396
Epoch: 40, Steps: 64 | Train Loss: 0.1149861 Vali Loss: 0.1628805 Test Loss: 0.2208925
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 41 cost time: 0.881378173828125
Epoch: 41, Steps: 64 | Train Loss: 0.1152506 Vali Loss: 0.1605646 Test Loss: 0.2206033
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 42 cost time: 0.8799757957458496
Epoch: 42, Steps: 64 | Train Loss: 0.1149107 Vali Loss: 0.1631455 Test Loss: 0.2202460
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 43 cost time: 0.8760843276977539
Epoch: 43, Steps: 64 | Train Loss: 0.1145495 Vali Loss: 0.1608208 Test Loss: 0.2210792
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 44 cost time: 0.8910000324249268
Epoch: 44, Steps: 64 | Train Loss: 0.1147696 Vali Loss: 0.1616082 Test Loss: 0.2214686
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 45 cost time: 0.8766005039215088
Epoch: 45, Steps: 64 | Train Loss: 0.1147651 Vali Loss: 0.1628920 Test Loss: 0.2216026
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 46 cost time: 0.8851332664489746
Epoch: 46, Steps: 64 | Train Loss: 0.1145040 Vali Loss: 0.1606883 Test Loss: 0.2200952
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 47 cost time: 0.8924295902252197
Epoch: 47, Steps: 64 | Train Loss: 0.1140730 Vali Loss: 0.1627380 Test Loss: 0.2207496
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 48 cost time: 0.8863162994384766
Epoch: 48, Steps: 64 | Train Loss: 0.1140499 Vali Loss: 0.1622584 Test Loss: 0.2204843
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 49 cost time: 0.8757493495941162
Epoch: 49, Steps: 64 | Train Loss: 0.1142229 Vali Loss: 0.1617906 Test Loss: 0.2217223
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 50 cost time: 0.882000207901001
Epoch: 50, Steps: 64 | Train Loss: 0.1147030 Vali Loss: 0.1613410 Test Loss: 0.2206368
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 51 cost time: 0.8756299018859863
Epoch: 51, Steps: 64 | Train Loss: 0.1140031 Vali Loss: 0.1631954 Test Loss: 0.2215433
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 52 cost time: 0.8839046955108643
Epoch: 52, Steps: 64 | Train Loss: 0.1140973 Vali Loss: 0.1616168 Test Loss: 0.2200508
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 53 cost time: 0.8813612461090088
Epoch: 53, Steps: 64 | Train Loss: 0.1143564 Vali Loss: 0.1637444 Test Loss: 0.2207741
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 54 cost time: 0.8803107738494873
Epoch: 54, Steps: 64 | Train Loss: 0.1142522 Vali Loss: 0.1621244 Test Loss: 0.2204341
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 55 cost time: 0.8541452884674072
Epoch: 55, Steps: 64 | Train Loss: 0.1144013 Vali Loss: 0.1624905 Test Loss: 0.2203182
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 56 cost time: 0.888338565826416
Epoch: 56, Steps: 64 | Train Loss: 0.1143461 Vali Loss: 0.1624316 Test Loss: 0.2210347
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 57 cost time: 0.8875904083251953
Epoch: 57, Steps: 64 | Train Loss: 0.1146437 Vali Loss: 0.1634880 Test Loss: 0.2205956
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 58 cost time: 0.8951995372772217
Epoch: 58, Steps: 64 | Train Loss: 0.1146032 Vali Loss: 0.1623874 Test Loss: 0.2215017
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 59 cost time: 0.882908821105957
Epoch: 59, Steps: 64 | Train Loss: 0.1141262 Vali Loss: 0.1615075 Test Loss: 0.2207126
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 60 cost time: 0.881772518157959
Epoch: 60, Steps: 64 | Train Loss: 0.1144132 Vali Loss: 0.1631975 Test Loss: 0.2208803
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22026202082633972, mae:0.3245371878147125, rse:0.23785042762756348
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.058718204498291016 GB
Epoch: 1 cost time: 2.278937816619873
Epoch: 1, Steps: 64 | Train Loss: 0.8337312 Vali Loss: 2.1975107 Test Loss: 3.4762275
Validation loss decreased (inf --> 2.197511).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 2 cost time: 0.9066112041473389
Epoch: 2, Steps: 64 | Train Loss: 0.3832444 Vali Loss: 0.2113320 Test Loss: 0.2485035
Validation loss decreased (2.197511 --> 0.211332).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 3 cost time: 0.9229998588562012
Epoch: 3, Steps: 64 | Train Loss: 0.1320054 Vali Loss: 0.1816601 Test Loss: 0.2328866
Validation loss decreased (0.211332 --> 0.181660).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 4 cost time: 0.9246044158935547
Epoch: 4, Steps: 64 | Train Loss: 0.1210027 Vali Loss: 0.1717240 Test Loss: 0.2216792
Validation loss decreased (0.181660 --> 0.171724).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 5 cost time: 0.9171111583709717
Epoch: 5, Steps: 64 | Train Loss: 0.1168484 Vali Loss: 0.1675113 Test Loss: 0.2184223
Validation loss decreased (0.171724 --> 0.167511).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 6 cost time: 0.9191014766693115
Epoch: 6, Steps: 64 | Train Loss: 0.1142701 Vali Loss: 0.1671593 Test Loss: 0.2156987
Validation loss decreased (0.167511 --> 0.167159).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 7 cost time: 0.9197185039520264
Epoch: 7, Steps: 64 | Train Loss: 0.1123654 Vali Loss: 0.1647033 Test Loss: 0.2170011
Validation loss decreased (0.167159 --> 0.164703).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 8 cost time: 0.9233963489532471
Epoch: 8, Steps: 64 | Train Loss: 0.1108630 Vali Loss: 0.1609506 Test Loss: 0.2167897
Validation loss decreased (0.164703 --> 0.160951).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 9 cost time: 0.9147090911865234
Epoch: 9, Steps: 64 | Train Loss: 0.1093463 Vali Loss: 0.1567082 Test Loss: 0.2167292
Validation loss decreased (0.160951 --> 0.156708).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 10 cost time: 0.9270000457763672
Epoch: 10, Steps: 64 | Train Loss: 0.1083462 Vali Loss: 0.1591391 Test Loss: 0.2174726
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 11 cost time: 0.9196040630340576
Epoch: 11, Steps: 64 | Train Loss: 0.1072947 Vali Loss: 0.1558670 Test Loss: 0.2181151
Validation loss decreased (0.156708 --> 0.155867).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 12 cost time: 0.9325988292694092
Epoch: 12, Steps: 64 | Train Loss: 0.1069947 Vali Loss: 0.1560371 Test Loss: 0.2173074
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 13 cost time: 0.9253344535827637
Epoch: 13, Steps: 64 | Train Loss: 0.1055769 Vali Loss: 0.1536787 Test Loss: 0.2171266
Validation loss decreased (0.155867 --> 0.153679).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 14 cost time: 0.9173190593719482
Epoch: 14, Steps: 64 | Train Loss: 0.1057846 Vali Loss: 0.1563822 Test Loss: 0.2188755
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 15 cost time: 0.9260170459747314
Epoch: 15, Steps: 64 | Train Loss: 0.1052303 Vali Loss: 0.1534826 Test Loss: 0.2178087
Validation loss decreased (0.153679 --> 0.153483).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 16 cost time: 0.9204628467559814
Epoch: 16, Steps: 64 | Train Loss: 0.1046994 Vali Loss: 0.1538442 Test Loss: 0.2191686
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 17 cost time: 0.9187331199645996
Epoch: 17, Steps: 64 | Train Loss: 0.1040222 Vali Loss: 0.1521789 Test Loss: 0.2185278
Validation loss decreased (0.153483 --> 0.152179).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 18 cost time: 0.9210002422332764
Epoch: 18, Steps: 64 | Train Loss: 0.1038188 Vali Loss: 0.1528429 Test Loss: 0.2188827
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 19 cost time: 0.9313502311706543
Epoch: 19, Steps: 64 | Train Loss: 0.1027764 Vali Loss: 0.1506906 Test Loss: 0.2189515
Validation loss decreased (0.152179 --> 0.150691).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 20 cost time: 0.9134182929992676
Epoch: 20, Steps: 64 | Train Loss: 0.1027948 Vali Loss: 0.1519377 Test Loss: 0.2186970
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 21 cost time: 0.907376766204834
Epoch: 21, Steps: 64 | Train Loss: 0.1024557 Vali Loss: 0.1525570 Test Loss: 0.2194018
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 22 cost time: 0.9104251861572266
Epoch: 22, Steps: 64 | Train Loss: 0.1026135 Vali Loss: 0.1519934 Test Loss: 0.2193686
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 23 cost time: 0.9043595790863037
Epoch: 23, Steps: 64 | Train Loss: 0.1016825 Vali Loss: 0.1513560 Test Loss: 0.2194952
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 24 cost time: 0.9023692607879639
Epoch: 24, Steps: 64 | Train Loss: 0.1021874 Vali Loss: 0.1506274 Test Loss: 0.2192231
Validation loss decreased (0.150691 --> 0.150627).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 25 cost time: 0.905731201171875
Epoch: 25, Steps: 64 | Train Loss: 0.1019182 Vali Loss: 0.1517312 Test Loss: 0.2196748
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 26 cost time: 0.8989999294281006
Epoch: 26, Steps: 64 | Train Loss: 0.1020500 Vali Loss: 0.1502073 Test Loss: 0.2195829
Validation loss decreased (0.150627 --> 0.150207).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 27 cost time: 0.9066214561462402
Epoch: 27, Steps: 64 | Train Loss: 0.1019507 Vali Loss: 0.1519635 Test Loss: 0.2195889
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 28 cost time: 0.9126229286193848
Epoch: 28, Steps: 64 | Train Loss: 0.1014192 Vali Loss: 0.1493582 Test Loss: 0.2195211
Validation loss decreased (0.150207 --> 0.149358).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 29 cost time: 0.9197235107421875
Epoch: 29, Steps: 64 | Train Loss: 0.1006753 Vali Loss: 0.1471535 Test Loss: 0.2197637
Validation loss decreased (0.149358 --> 0.147153).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 30 cost time: 0.9052932262420654
Epoch: 30, Steps: 64 | Train Loss: 0.1015862 Vali Loss: 0.1492734 Test Loss: 0.2197789
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 31 cost time: 0.9073746204376221
Epoch: 31, Steps: 64 | Train Loss: 0.1013696 Vali Loss: 0.1503202 Test Loss: 0.2197260
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 32 cost time: 0.9022197723388672
Epoch: 32, Steps: 64 | Train Loss: 0.1013480 Vali Loss: 0.1488609 Test Loss: 0.2199332
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 33 cost time: 0.8979995250701904
Epoch: 33, Steps: 64 | Train Loss: 0.1013515 Vali Loss: 0.1497562 Test Loss: 0.2199541
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 34 cost time: 0.9046180248260498
Epoch: 34, Steps: 64 | Train Loss: 0.1008324 Vali Loss: 0.1491366 Test Loss: 0.2202281
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 35 cost time: 0.9093270301818848
Epoch: 35, Steps: 64 | Train Loss: 0.1010772 Vali Loss: 0.1494822 Test Loss: 0.2201624
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 36 cost time: 0.9191794395446777
Epoch: 36, Steps: 64 | Train Loss: 0.1010937 Vali Loss: 0.1485689 Test Loss: 0.2197820
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 37 cost time: 0.9063749313354492
Epoch: 37, Steps: 64 | Train Loss: 0.1009865 Vali Loss: 0.1504357 Test Loss: 0.2204992
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 38 cost time: 0.9054040908813477
Epoch: 38, Steps: 64 | Train Loss: 0.1009129 Vali Loss: 0.1490566 Test Loss: 0.2198474
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 39 cost time: 0.9097602367401123
Epoch: 39, Steps: 64 | Train Loss: 0.1010447 Vali Loss: 0.1500166 Test Loss: 0.2199927
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 40 cost time: 0.8998782634735107
Epoch: 40, Steps: 64 | Train Loss: 0.1005317 Vali Loss: 0.1486118 Test Loss: 0.2197357
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 41 cost time: 0.8950097560882568
Epoch: 41, Steps: 64 | Train Loss: 0.1006797 Vali Loss: 0.1496736 Test Loss: 0.2199219
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 42 cost time: 0.8994476795196533
Epoch: 42, Steps: 64 | Train Loss: 0.1006798 Vali Loss: 0.1489086 Test Loss: 0.2200742
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 43 cost time: 0.917349100112915
Epoch: 43, Steps: 64 | Train Loss: 0.1012090 Vali Loss: 0.1489154 Test Loss: 0.2198092
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 44 cost time: 0.9733343124389648
Epoch: 44, Steps: 64 | Train Loss: 0.1010003 Vali Loss: 0.1482893 Test Loss: 0.2195594
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 45 cost time: 0.9786913394927979
Epoch: 45, Steps: 64 | Train Loss: 0.1004051 Vali Loss: 0.1495498 Test Loss: 0.2203193
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 46 cost time: 0.9873859882354736
Epoch: 46, Steps: 64 | Train Loss: 0.1006436 Vali Loss: 0.1490696 Test Loss: 0.2197361
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 47 cost time: 0.9067850112915039
Epoch: 47, Steps: 64 | Train Loss: 0.1006957 Vali Loss: 0.1479654 Test Loss: 0.2199011
EarlyStopping counter: 18 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 48 cost time: 0.8979997634887695
Epoch: 48, Steps: 64 | Train Loss: 0.1005067 Vali Loss: 0.1484881 Test Loss: 0.2199714
EarlyStopping counter: 19 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 49 cost time: 0.8977551460266113
Epoch: 49, Steps: 64 | Train Loss: 0.1006038 Vali Loss: 0.1477021 Test Loss: 0.2199642
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 50 cost time: 0.9002881050109863
Epoch: 50, Steps: 64 | Train Loss: 0.1009835 Vali Loss: 0.1479567 Test Loss: 0.2202191
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 51 cost time: 0.8983838558197021
Epoch: 51, Steps: 64 | Train Loss: 0.1005423 Vali Loss: 0.1485076 Test Loss: 0.2200353
EarlyStopping counter: 22 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 52 cost time: 0.9063675403594971
Epoch: 52, Steps: 64 | Train Loss: 0.1001990 Vali Loss: 0.1481108 Test Loss: 0.2199459
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 53 cost time: 0.9193210601806641
Epoch: 53, Steps: 64 | Train Loss: 0.1008915 Vali Loss: 0.1478397 Test Loss: 0.2200507
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 54 cost time: 0.9152646064758301
Epoch: 54, Steps: 64 | Train Loss: 0.1007929 Vali Loss: 0.1474024 Test Loss: 0.2202044
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 55 cost time: 0.9110000133514404
Epoch: 55, Steps: 64 | Train Loss: 0.1005023 Vali Loss: 0.1492400 Test Loss: 0.2199417
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 56 cost time: 0.9090001583099365
Epoch: 56, Steps: 64 | Train Loss: 0.1002296 Vali Loss: 0.1493742 Test Loss: 0.2197588
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 57 cost time: 0.9200007915496826
Epoch: 57, Steps: 64 | Train Loss: 0.1005335 Vali Loss: 0.1488471 Test Loss: 0.2199737
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 58 cost time: 0.9083805084228516
Epoch: 58, Steps: 64 | Train Loss: 0.1001811 Vali Loss: 0.1480404 Test Loss: 0.2201109
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 59 cost time: 0.9103593826293945
Epoch: 59, Steps: 64 | Train Loss: 0.1006498 Vali Loss: 0.1478217 Test Loss: 0.2197315
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 60 cost time: 0.9164280891418457
Epoch: 60, Steps: 64 | Train Loss: 0.1004240 Vali Loss: 0.1481725 Test Loss: 0.2199839
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.21976371109485626, mae:0.3249762952327728, rse:0.23758122324943542
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.062016963958740234 GB
Epoch: 1 cost time: 2.289335250854492
Epoch: 1, Steps: 64 | Train Loss: 0.8095751 Vali Loss: 2.1633816 Test Loss: 3.4291015
Validation loss decreased (inf --> 2.163382).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 2 cost time: 0.9347813129425049
Epoch: 2, Steps: 64 | Train Loss: 0.3364787 Vali Loss: 0.2632693 Test Loss: 0.3424789
Validation loss decreased (2.163382 --> 0.263269).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 3 cost time: 0.9325096607208252
Epoch: 3, Steps: 64 | Train Loss: 0.1319301 Vali Loss: 0.1779613 Test Loss: 0.2190991
Validation loss decreased (0.263269 --> 0.177961).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 4 cost time: 0.9072685241699219
Epoch: 4, Steps: 64 | Train Loss: 0.1191304 Vali Loss: 0.1671339 Test Loss: 0.2227101
Validation loss decreased (0.177961 --> 0.167134).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 5 cost time: 0.9326245784759521
Epoch: 5, Steps: 64 | Train Loss: 0.1151077 Vali Loss: 0.1667118 Test Loss: 0.2200709
Validation loss decreased (0.167134 --> 0.166712).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 6 cost time: 0.93387770652771
Epoch: 6, Steps: 64 | Train Loss: 0.1126244 Vali Loss: 0.1619442 Test Loss: 0.2190782
Validation loss decreased (0.166712 --> 0.161944).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 7 cost time: 0.9368078708648682
Epoch: 7, Steps: 64 | Train Loss: 0.1109341 Vali Loss: 0.1605013 Test Loss: 0.2171925
Validation loss decreased (0.161944 --> 0.160501).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 8 cost time: 0.9314336776733398
Epoch: 8, Steps: 64 | Train Loss: 0.1097046 Vali Loss: 0.1577560 Test Loss: 0.2158383
Validation loss decreased (0.160501 --> 0.157756).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 9 cost time: 0.9324066638946533
Epoch: 9, Steps: 64 | Train Loss: 0.1085012 Vali Loss: 0.1556575 Test Loss: 0.2187079
Validation loss decreased (0.157756 --> 0.155658).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 10 cost time: 0.9464178085327148
Epoch: 10, Steps: 64 | Train Loss: 0.1069760 Vali Loss: 0.1563607 Test Loss: 0.2162686
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 11 cost time: 0.9360833168029785
Epoch: 11, Steps: 64 | Train Loss: 0.1062441 Vali Loss: 0.1542038 Test Loss: 0.2167665
Validation loss decreased (0.155658 --> 0.154204).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 12 cost time: 0.94100022315979
Epoch: 12, Steps: 64 | Train Loss: 0.1053399 Vali Loss: 0.1538662 Test Loss: 0.2170782
Validation loss decreased (0.154204 --> 0.153866).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 13 cost time: 0.9329981803894043
Epoch: 13, Steps: 64 | Train Loss: 0.1045786 Vali Loss: 0.1537694 Test Loss: 0.2174308
Validation loss decreased (0.153866 --> 0.153769).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 14 cost time: 0.9423987865447998
Epoch: 14, Steps: 64 | Train Loss: 0.1038007 Vali Loss: 0.1531496 Test Loss: 0.2186495
Validation loss decreased (0.153769 --> 0.153150).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 15 cost time: 0.9308135509490967
Epoch: 15, Steps: 64 | Train Loss: 0.1032705 Vali Loss: 0.1556785 Test Loss: 0.2194875
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 16 cost time: 0.9323616027832031
Epoch: 16, Steps: 64 | Train Loss: 0.1021627 Vali Loss: 0.1501606 Test Loss: 0.2169802
Validation loss decreased (0.153150 --> 0.150161).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 17 cost time: 0.9480526447296143
Epoch: 17, Steps: 64 | Train Loss: 0.1022515 Vali Loss: 0.1520616 Test Loss: 0.2180215
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 18 cost time: 0.9358842372894287
Epoch: 18, Steps: 64 | Train Loss: 0.1021206 Vali Loss: 0.1513681 Test Loss: 0.2182992
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 19 cost time: 0.9427273273468018
Epoch: 19, Steps: 64 | Train Loss: 0.1015756 Vali Loss: 0.1524831 Test Loss: 0.2179363
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 20 cost time: 0.9537718296051025
Epoch: 20, Steps: 64 | Train Loss: 0.1014300 Vali Loss: 0.1519291 Test Loss: 0.2187554
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 21 cost time: 0.9367127418518066
Epoch: 21, Steps: 64 | Train Loss: 0.1011642 Vali Loss: 0.1493932 Test Loss: 0.2192637
Validation loss decreased (0.150161 --> 0.149393).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 22 cost time: 0.9300003051757812
Epoch: 22, Steps: 64 | Train Loss: 0.1013502 Vali Loss: 0.1507272 Test Loss: 0.2184864
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 23 cost time: 0.9313709735870361
Epoch: 23, Steps: 64 | Train Loss: 0.1008144 Vali Loss: 0.1508077 Test Loss: 0.2198644
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 24 cost time: 0.9336066246032715
Epoch: 24, Steps: 64 | Train Loss: 0.1006607 Vali Loss: 0.1510398 Test Loss: 0.2192543
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 25 cost time: 0.9273748397827148
Epoch: 25, Steps: 64 | Train Loss: 0.1001303 Vali Loss: 0.1514731 Test Loss: 0.2189675
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 26 cost time: 0.9424276351928711
Epoch: 26, Steps: 64 | Train Loss: 0.1001116 Vali Loss: 0.1507922 Test Loss: 0.2193012
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 27 cost time: 0.9383742809295654
Epoch: 27, Steps: 64 | Train Loss: 0.1000503 Vali Loss: 0.1500689 Test Loss: 0.2189673
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 28 cost time: 0.940988302230835
Epoch: 28, Steps: 64 | Train Loss: 0.1003036 Vali Loss: 0.1500956 Test Loss: 0.2194135
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 29 cost time: 0.9337201118469238
Epoch: 29, Steps: 64 | Train Loss: 0.1002030 Vali Loss: 0.1510200 Test Loss: 0.2196671
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 30 cost time: 0.9287877082824707
Epoch: 30, Steps: 64 | Train Loss: 0.1003906 Vali Loss: 0.1495842 Test Loss: 0.2195227
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 31 cost time: 0.9519999027252197
Epoch: 31, Steps: 64 | Train Loss: 0.1000961 Vali Loss: 0.1504074 Test Loss: 0.2197422
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 32 cost time: 0.929624080657959
Epoch: 32, Steps: 64 | Train Loss: 0.0993774 Vali Loss: 0.1481788 Test Loss: 0.2194228
Validation loss decreased (0.149393 --> 0.148179).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 33 cost time: 0.9323902130126953
Epoch: 33, Steps: 64 | Train Loss: 0.1002104 Vali Loss: 0.1484849 Test Loss: 0.2194839
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 34 cost time: 0.9503612518310547
Epoch: 34, Steps: 64 | Train Loss: 0.0994347 Vali Loss: 0.1487069 Test Loss: 0.2195064
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 35 cost time: 0.9354598522186279
Epoch: 35, Steps: 64 | Train Loss: 0.0991673 Vali Loss: 0.1476279 Test Loss: 0.2191744
Validation loss decreased (0.148179 --> 0.147628).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 36 cost time: 0.9453299045562744
Epoch: 36, Steps: 64 | Train Loss: 0.0995195 Vali Loss: 0.1499051 Test Loss: 0.2194985
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 37 cost time: 0.9544365406036377
Epoch: 37, Steps: 64 | Train Loss: 0.0995020 Vali Loss: 0.1491428 Test Loss: 0.2197438
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 38 cost time: 0.928358793258667
Epoch: 38, Steps: 64 | Train Loss: 0.0993339 Vali Loss: 0.1492565 Test Loss: 0.2197070
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 39 cost time: 0.9297349452972412
Epoch: 39, Steps: 64 | Train Loss: 0.0994831 Vali Loss: 0.1487879 Test Loss: 0.2197023
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 40 cost time: 0.9329991340637207
Epoch: 40, Steps: 64 | Train Loss: 0.0996098 Vali Loss: 0.1502038 Test Loss: 0.2201769
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 41 cost time: 0.9488589763641357
Epoch: 41, Steps: 64 | Train Loss: 0.0993196 Vali Loss: 0.1490453 Test Loss: 0.2196870
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 42 cost time: 0.9326210021972656
Epoch: 42, Steps: 64 | Train Loss: 0.0995107 Vali Loss: 0.1497126 Test Loss: 0.2199108
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 43 cost time: 0.9383790493011475
Epoch: 43, Steps: 64 | Train Loss: 0.0992736 Vali Loss: 0.1494602 Test Loss: 0.2198287
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 44 cost time: 0.9327740669250488
Epoch: 44, Steps: 64 | Train Loss: 0.0991218 Vali Loss: 0.1496364 Test Loss: 0.2199490
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 45 cost time: 0.9021296501159668
Epoch: 45, Steps: 64 | Train Loss: 0.0990913 Vali Loss: 0.1485679 Test Loss: 0.2198646
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 46 cost time: 0.9323875904083252
Epoch: 46, Steps: 64 | Train Loss: 0.0991289 Vali Loss: 0.1489350 Test Loss: 0.2198057
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 47 cost time: 0.9378128051757812
Epoch: 47, Steps: 64 | Train Loss: 0.0995132 Vali Loss: 0.1498831 Test Loss: 0.2197622
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 48 cost time: 0.9260001182556152
Epoch: 48, Steps: 64 | Train Loss: 0.0990714 Vali Loss: 0.1502392 Test Loss: 0.2197992
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 49 cost time: 0.9283618927001953
Epoch: 49, Steps: 64 | Train Loss: 0.0994329 Vali Loss: 0.1484075 Test Loss: 0.2198281
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 50 cost time: 0.9316225051879883
Epoch: 50, Steps: 64 | Train Loss: 0.0992231 Vali Loss: 0.1502709 Test Loss: 0.2198116
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 51 cost time: 0.9296765327453613
Epoch: 51, Steps: 64 | Train Loss: 0.0994050 Vali Loss: 0.1489775 Test Loss: 0.2197372
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 52 cost time: 0.9374086856842041
Epoch: 52, Steps: 64 | Train Loss: 0.0991595 Vali Loss: 0.1482958 Test Loss: 0.2200192
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 53 cost time: 0.9400134086608887
Epoch: 53, Steps: 64 | Train Loss: 0.0993239 Vali Loss: 0.1494927 Test Loss: 0.2200838
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 54 cost time: 0.9434826374053955
Epoch: 54, Steps: 64 | Train Loss: 0.0989596 Vali Loss: 0.1475337 Test Loss: 0.2200619
Validation loss decreased (0.147628 --> 0.147534).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 55 cost time: 0.9383213520050049
Epoch: 55, Steps: 64 | Train Loss: 0.0987380 Vali Loss: 0.1480185 Test Loss: 0.2200019
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 56 cost time: 0.935744047164917
Epoch: 56, Steps: 64 | Train Loss: 0.0986674 Vali Loss: 0.1498524 Test Loss: 0.2198763
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 57 cost time: 0.9337794780731201
Epoch: 57, Steps: 64 | Train Loss: 0.0985345 Vali Loss: 0.1485929 Test Loss: 0.2200412
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 58 cost time: 0.92889404296875
Epoch: 58, Steps: 64 | Train Loss: 0.0990946 Vali Loss: 0.1485511 Test Loss: 0.2197680
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 59 cost time: 0.9330487251281738
Epoch: 59, Steps: 64 | Train Loss: 0.0988947 Vali Loss: 0.1485795 Test Loss: 0.2198406
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 60 cost time: 0.9354088306427002
Epoch: 60, Steps: 64 | Train Loss: 0.0990538 Vali Loss: 0.1496393 Test Loss: 0.2198076
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22006194293498993, mae:0.32501816749572754, rse:0.2377423793077469
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054485321044921875 GB
Epoch: 1 cost time: 2.2675092220306396
Epoch: 1, Steps: 64 | Train Loss: 1.0072268 Vali Loss: 2.6073775 Test Loss: 4.1428351
Validation loss decreased (inf --> 2.607378).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 2 cost time: 0.8824145793914795
Epoch: 2, Steps: 64 | Train Loss: 0.6679036 Vali Loss: 0.9658254 Test Loss: 1.4356709
Validation loss decreased (2.607378 --> 0.965825).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 3 cost time: 0.878800630569458
Epoch: 3, Steps: 64 | Train Loss: 0.3555212 Vali Loss: 0.5769133 Test Loss: 0.8173496
Validation loss decreased (0.965825 --> 0.576913).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 4 cost time: 0.8730015754699707
Epoch: 4, Steps: 64 | Train Loss: 0.2360389 Vali Loss: 0.3702317 Test Loss: 0.4962983
Validation loss decreased (0.576913 --> 0.370232).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 5 cost time: 0.8826155662536621
Epoch: 5, Steps: 64 | Train Loss: 0.1789937 Vali Loss: 0.2784455 Test Loss: 0.3590165
Validation loss decreased (0.370232 --> 0.278446).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 6 cost time: 0.8696086406707764
Epoch: 6, Steps: 64 | Train Loss: 0.1520009 Vali Loss: 0.2292219 Test Loss: 0.2895368
Validation loss decreased (0.278446 --> 0.229222).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 7 cost time: 0.8644199371337891
Epoch: 7, Steps: 64 | Train Loss: 0.1401728 Vali Loss: 0.2086804 Test Loss: 0.2651318
Validation loss decreased (0.229222 --> 0.208680).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 8 cost time: 0.8594470024108887
Epoch: 8, Steps: 64 | Train Loss: 0.1327802 Vali Loss: 0.1892610 Test Loss: 0.2426610
Validation loss decreased (0.208680 --> 0.189261).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 9 cost time: 0.8657479286193848
Epoch: 9, Steps: 64 | Train Loss: 0.1300124 Vali Loss: 0.1846005 Test Loss: 0.2371459
Validation loss decreased (0.189261 --> 0.184600).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 10 cost time: 0.878000020980835
Epoch: 10, Steps: 64 | Train Loss: 0.1261121 Vali Loss: 0.1800690 Test Loss: 0.2300370
Validation loss decreased (0.184600 --> 0.180069).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 11 cost time: 0.8746201992034912
Epoch: 11, Steps: 64 | Train Loss: 0.1253850 Vali Loss: 0.1773083 Test Loss: 0.2292279
Validation loss decreased (0.180069 --> 0.177308).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 12 cost time: 0.8840241432189941
Epoch: 12, Steps: 64 | Train Loss: 0.1240484 Vali Loss: 0.1744751 Test Loss: 0.2258827
Validation loss decreased (0.177308 --> 0.174475).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 13 cost time: 0.8894562721252441
Epoch: 13, Steps: 64 | Train Loss: 0.1222482 Vali Loss: 0.1724896 Test Loss: 0.2252948
Validation loss decreased (0.174475 --> 0.172490).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 14 cost time: 0.8774189949035645
Epoch: 14, Steps: 64 | Train Loss: 0.1213173 Vali Loss: 0.1705411 Test Loss: 0.2244306
Validation loss decreased (0.172490 --> 0.170541).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 15 cost time: 0.8814520835876465
Epoch: 15, Steps: 64 | Train Loss: 0.1202749 Vali Loss: 0.1692720 Test Loss: 0.2235753
Validation loss decreased (0.170541 --> 0.169272).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 16 cost time: 0.8706274032592773
Epoch: 16, Steps: 64 | Train Loss: 0.1201870 Vali Loss: 0.1706589 Test Loss: 0.2237101
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 17 cost time: 0.8726208209991455
Epoch: 17, Steps: 64 | Train Loss: 0.1189150 Vali Loss: 0.1688954 Test Loss: 0.2226334
Validation loss decreased (0.169272 --> 0.168895).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 18 cost time: 0.8693957328796387
Epoch: 18, Steps: 64 | Train Loss: 0.1184784 Vali Loss: 0.1665025 Test Loss: 0.2214783
Validation loss decreased (0.168895 --> 0.166503).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 19 cost time: 0.8934116363525391
Epoch: 19, Steps: 64 | Train Loss: 0.1177418 Vali Loss: 0.1672409 Test Loss: 0.2223039
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 20 cost time: 0.8803720474243164
Epoch: 20, Steps: 64 | Train Loss: 0.1168185 Vali Loss: 0.1658582 Test Loss: 0.2220583
Validation loss decreased (0.166503 --> 0.165858).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 21 cost time: 0.8793950080871582
Epoch: 21, Steps: 64 | Train Loss: 0.1172522 Vali Loss: 0.1658797 Test Loss: 0.2210897
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 22 cost time: 0.8860001564025879
Epoch: 22, Steps: 64 | Train Loss: 0.1171775 Vali Loss: 0.1661633 Test Loss: 0.2222160
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 23 cost time: 0.8699965476989746
Epoch: 23, Steps: 64 | Train Loss: 0.1160852 Vali Loss: 0.1667149 Test Loss: 0.2222901
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 24 cost time: 0.873406171798706
Epoch: 24, Steps: 64 | Train Loss: 0.1161977 Vali Loss: 0.1663402 Test Loss: 0.2222572
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 25 cost time: 0.873403787612915
Epoch: 25, Steps: 64 | Train Loss: 0.1162530 Vali Loss: 0.1654275 Test Loss: 0.2211097
Validation loss decreased (0.165858 --> 0.165427).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 26 cost time: 0.8773548603057861
Epoch: 26, Steps: 64 | Train Loss: 0.1153820 Vali Loss: 0.1651835 Test Loss: 0.2219754
Validation loss decreased (0.165427 --> 0.165183).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 27 cost time: 0.8419938087463379
Epoch: 27, Steps: 64 | Train Loss: 0.1152973 Vali Loss: 0.1645951 Test Loss: 0.2205505
Validation loss decreased (0.165183 --> 0.164595).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 28 cost time: 0.8800003528594971
Epoch: 28, Steps: 64 | Train Loss: 0.1153984 Vali Loss: 0.1641279 Test Loss: 0.2211979
Validation loss decreased (0.164595 --> 0.164128).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 29 cost time: 0.8756277561187744
Epoch: 29, Steps: 64 | Train Loss: 0.1153397 Vali Loss: 0.1646606 Test Loss: 0.2207648
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 30 cost time: 0.886366605758667
Epoch: 30, Steps: 64 | Train Loss: 0.1154855 Vali Loss: 0.1640754 Test Loss: 0.2204132
Validation loss decreased (0.164128 --> 0.164075).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 31 cost time: 0.8773612976074219
Epoch: 31, Steps: 64 | Train Loss: 0.1155228 Vali Loss: 0.1646658 Test Loss: 0.2212116
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 32 cost time: 0.8804192543029785
Epoch: 32, Steps: 64 | Train Loss: 0.1144824 Vali Loss: 0.1650725 Test Loss: 0.2214539
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 33 cost time: 0.8777308464050293
Epoch: 33, Steps: 64 | Train Loss: 0.1153255 Vali Loss: 0.1644647 Test Loss: 0.2198124
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 34 cost time: 0.8653643131256104
Epoch: 34, Steps: 64 | Train Loss: 0.1142371 Vali Loss: 0.1631076 Test Loss: 0.2203557
Validation loss decreased (0.164075 --> 0.163108).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 35 cost time: 0.8786194324493408
Epoch: 35, Steps: 64 | Train Loss: 0.1146193 Vali Loss: 0.1646167 Test Loss: 0.2201031
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 36 cost time: 0.8733575344085693
Epoch: 36, Steps: 64 | Train Loss: 0.1146550 Vali Loss: 0.1645728 Test Loss: 0.2196997
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 37 cost time: 0.882347822189331
Epoch: 37, Steps: 64 | Train Loss: 0.1145984 Vali Loss: 0.1642959 Test Loss: 0.2202079
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 38 cost time: 0.8773696422576904
Epoch: 38, Steps: 64 | Train Loss: 0.1147873 Vali Loss: 0.1641404 Test Loss: 0.2201859
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 39 cost time: 0.8913156986236572
Epoch: 39, Steps: 64 | Train Loss: 0.1139770 Vali Loss: 0.1636901 Test Loss: 0.2198668
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 40 cost time: 0.8799996376037598
Epoch: 40, Steps: 64 | Train Loss: 0.1137602 Vali Loss: 0.1647413 Test Loss: 0.2207521
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 41 cost time: 0.8836190700531006
Epoch: 41, Steps: 64 | Train Loss: 0.1141076 Vali Loss: 0.1647023 Test Loss: 0.2211894
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 42 cost time: 0.8773708343505859
Epoch: 42, Steps: 64 | Train Loss: 0.1145939 Vali Loss: 0.1652629 Test Loss: 0.2207119
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 43 cost time: 0.8793487548828125
Epoch: 43, Steps: 64 | Train Loss: 0.1138245 Vali Loss: 0.1643978 Test Loss: 0.2209364
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 44 cost time: 0.8853616714477539
Epoch: 44, Steps: 64 | Train Loss: 0.1137000 Vali Loss: 0.1620175 Test Loss: 0.2198721
Validation loss decreased (0.163108 --> 0.162018).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 45 cost time: 0.8798131942749023
Epoch: 45, Steps: 64 | Train Loss: 0.1143056 Vali Loss: 0.1637600 Test Loss: 0.2202520
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 46 cost time: 0.8820004463195801
Epoch: 46, Steps: 64 | Train Loss: 0.1142073 Vali Loss: 0.1629663 Test Loss: 0.2205100
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 47 cost time: 0.8756232261657715
Epoch: 47, Steps: 64 | Train Loss: 0.1138493 Vali Loss: 0.1631593 Test Loss: 0.2203142
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 48 cost time: 0.8803253173828125
Epoch: 48, Steps: 64 | Train Loss: 0.1140361 Vali Loss: 0.1650418 Test Loss: 0.2204313
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 49 cost time: 0.8763580322265625
Epoch: 49, Steps: 64 | Train Loss: 0.1140565 Vali Loss: 0.1627931 Test Loss: 0.2199521
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 50 cost time: 0.8763983249664307
Epoch: 50, Steps: 64 | Train Loss: 0.1141555 Vali Loss: 0.1629159 Test Loss: 0.2203339
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 51 cost time: 0.8799998760223389
Epoch: 51, Steps: 64 | Train Loss: 0.1139059 Vali Loss: 0.1633398 Test Loss: 0.2193977
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 52 cost time: 0.8714320659637451
Epoch: 52, Steps: 64 | Train Loss: 0.1142739 Vali Loss: 0.1638311 Test Loss: 0.2202969
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 53 cost time: 0.8753550052642822
Epoch: 53, Steps: 64 | Train Loss: 0.1136729 Vali Loss: 0.1633603 Test Loss: 0.2204773
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 54 cost time: 0.8678269386291504
Epoch: 54, Steps: 64 | Train Loss: 0.1134428 Vali Loss: 0.1622433 Test Loss: 0.2204593
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 55 cost time: 0.8842356204986572
Epoch: 55, Steps: 64 | Train Loss: 0.1135936 Vali Loss: 0.1615940 Test Loss: 0.2200821
Validation loss decreased (0.162018 --> 0.161594).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 56 cost time: 0.8788883686065674
Epoch: 56, Steps: 64 | Train Loss: 0.1139774 Vali Loss: 0.1619255 Test Loss: 0.2191487
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 57 cost time: 0.8739995956420898
Epoch: 57, Steps: 64 | Train Loss: 0.1137883 Vali Loss: 0.1617205 Test Loss: 0.2196486
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 58 cost time: 0.8736238479614258
Epoch: 58, Steps: 64 | Train Loss: 0.1136792 Vali Loss: 0.1632920 Test Loss: 0.2191177
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 59 cost time: 0.8713817596435547
Epoch: 59, Steps: 64 | Train Loss: 0.1137309 Vali Loss: 0.1637833 Test Loss: 0.2190043
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 60 cost time: 0.8735065460205078
Epoch: 60, Steps: 64 | Train Loss: 0.1140060 Vali Loss: 0.1639611 Test Loss: 0.2196020
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2200821191072464, mae:0.3236026167869568, rse:0.23775328695774078
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.058879852294921875 GB
Epoch: 1 cost time: 2.2417452335357666
Epoch: 1, Steps: 64 | Train Loss: 0.9473773 Vali Loss: 2.4703152 Test Loss: 3.9836712
Validation loss decreased (inf --> 2.470315).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 2 cost time: 0.9207897186279297
Epoch: 2, Steps: 64 | Train Loss: 0.4237019 Vali Loss: 0.2006618 Test Loss: 0.2386997
Validation loss decreased (2.470315 --> 0.200662).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 3 cost time: 0.9095406532287598
Epoch: 3, Steps: 64 | Train Loss: 0.1344489 Vali Loss: 0.1843652 Test Loss: 0.2341690
Validation loss decreased (0.200662 --> 0.184365).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 4 cost time: 0.9129996299743652
Epoch: 4, Steps: 64 | Train Loss: 0.1216627 Vali Loss: 0.1710583 Test Loss: 0.2203531
Validation loss decreased (0.184365 --> 0.171058).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 5 cost time: 0.9076375961303711
Epoch: 5, Steps: 64 | Train Loss: 0.1164642 Vali Loss: 0.1696430 Test Loss: 0.2187597
Validation loss decreased (0.171058 --> 0.169643).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 6 cost time: 0.8966236114501953
Epoch: 6, Steps: 64 | Train Loss: 0.1134926 Vali Loss: 0.1619800 Test Loss: 0.2183185
Validation loss decreased (0.169643 --> 0.161980).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 7 cost time: 0.8990118503570557
Epoch: 7, Steps: 64 | Train Loss: 0.1115630 Vali Loss: 0.1630128 Test Loss: 0.2189749
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 8 cost time: 0.8994083404541016
Epoch: 8, Steps: 64 | Train Loss: 0.1102587 Vali Loss: 0.1643835 Test Loss: 0.2217284
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 9 cost time: 0.9063687324523926
Epoch: 9, Steps: 64 | Train Loss: 0.1085215 Vali Loss: 0.1588077 Test Loss: 0.2175982
Validation loss decreased (0.161980 --> 0.158808).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 10 cost time: 0.909203290939331
Epoch: 10, Steps: 64 | Train Loss: 0.1076484 Vali Loss: 0.1575131 Test Loss: 0.2178419
Validation loss decreased (0.158808 --> 0.157513).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 11 cost time: 0.9123637676239014
Epoch: 11, Steps: 64 | Train Loss: 0.1071374 Vali Loss: 0.1600912 Test Loss: 0.2189848
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 12 cost time: 0.9176182746887207
Epoch: 12, Steps: 64 | Train Loss: 0.1066111 Vali Loss: 0.1569170 Test Loss: 0.2179280
Validation loss decreased (0.157513 --> 0.156917).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 13 cost time: 0.9123573303222656
Epoch: 13, Steps: 64 | Train Loss: 0.1059311 Vali Loss: 0.1580367 Test Loss: 0.2191856
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 14 cost time: 0.8994851112365723
Epoch: 14, Steps: 64 | Train Loss: 0.1051339 Vali Loss: 0.1576926 Test Loss: 0.2191086
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 15 cost time: 0.8983931541442871
Epoch: 15, Steps: 64 | Train Loss: 0.1045364 Vali Loss: 0.1569691 Test Loss: 0.2179205
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 16 cost time: 0.9160358905792236
Epoch: 16, Steps: 64 | Train Loss: 0.1046167 Vali Loss: 0.1551730 Test Loss: 0.2189988
Validation loss decreased (0.156917 --> 0.155173).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 17 cost time: 0.8977806568145752
Epoch: 17, Steps: 64 | Train Loss: 0.1041518 Vali Loss: 0.1552996 Test Loss: 0.2183130
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 18 cost time: 0.9059996604919434
Epoch: 18, Steps: 64 | Train Loss: 0.1037210 Vali Loss: 0.1551923 Test Loss: 0.2195120
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 19 cost time: 0.9086439609527588
Epoch: 19, Steps: 64 | Train Loss: 0.1034901 Vali Loss: 0.1530628 Test Loss: 0.2184910
Validation loss decreased (0.155173 --> 0.153063).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 20 cost time: 0.9070348739624023
Epoch: 20, Steps: 64 | Train Loss: 0.1029355 Vali Loss: 0.1540820 Test Loss: 0.2192664
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 21 cost time: 0.9094266891479492
Epoch: 21, Steps: 64 | Train Loss: 0.1026382 Vali Loss: 0.1544895 Test Loss: 0.2189158
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 22 cost time: 0.9073469638824463
Epoch: 22, Steps: 64 | Train Loss: 0.1025750 Vali Loss: 0.1530760 Test Loss: 0.2182201
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 23 cost time: 0.9083936214447021
Epoch: 23, Steps: 64 | Train Loss: 0.1019918 Vali Loss: 0.1544599 Test Loss: 0.2204658
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 24 cost time: 0.9027531147003174
Epoch: 24, Steps: 64 | Train Loss: 0.1020006 Vali Loss: 0.1545993 Test Loss: 0.2198319
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 25 cost time: 0.9059998989105225
Epoch: 25, Steps: 64 | Train Loss: 0.1014534 Vali Loss: 0.1500315 Test Loss: 0.2190550
Validation loss decreased (0.153063 --> 0.150032).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 26 cost time: 0.9089996814727783
Epoch: 26, Steps: 64 | Train Loss: 0.1010309 Vali Loss: 0.1529891 Test Loss: 0.2191546
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 27 cost time: 0.9106252193450928
Epoch: 27, Steps: 64 | Train Loss: 0.1009716 Vali Loss: 0.1527188 Test Loss: 0.2186354
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 28 cost time: 0.915177583694458
Epoch: 28, Steps: 64 | Train Loss: 0.1017317 Vali Loss: 0.1517407 Test Loss: 0.2192589
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 29 cost time: 0.9080605506896973
Epoch: 29, Steps: 64 | Train Loss: 0.1010299 Vali Loss: 0.1524154 Test Loss: 0.2197799
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 30 cost time: 0.9043543338775635
Epoch: 30, Steps: 64 | Train Loss: 0.1007570 Vali Loss: 0.1527589 Test Loss: 0.2192233
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 31 cost time: 0.8997697830200195
Epoch: 31, Steps: 64 | Train Loss: 0.1012491 Vali Loss: 0.1525144 Test Loss: 0.2194422
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 32 cost time: 0.8989999294281006
Epoch: 32, Steps: 64 | Train Loss: 0.1009252 Vali Loss: 0.1517207 Test Loss: 0.2192735
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 33 cost time: 0.9124095439910889
Epoch: 33, Steps: 64 | Train Loss: 0.1004939 Vali Loss: 0.1516917 Test Loss: 0.2185741
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 34 cost time: 0.8986141681671143
Epoch: 34, Steps: 64 | Train Loss: 0.1009405 Vali Loss: 0.1508875 Test Loss: 0.2192262
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 35 cost time: 0.9034008979797363
Epoch: 35, Steps: 64 | Train Loss: 0.1005769 Vali Loss: 0.1511836 Test Loss: 0.2189774
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 36 cost time: 0.9132804870605469
Epoch: 36, Steps: 64 | Train Loss: 0.1008487 Vali Loss: 0.1518774 Test Loss: 0.2205847
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 37 cost time: 0.9191122055053711
Epoch: 37, Steps: 64 | Train Loss: 0.1004172 Vali Loss: 0.1506710 Test Loss: 0.2198193
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 38 cost time: 0.9113707542419434
Epoch: 38, Steps: 64 | Train Loss: 0.1003566 Vali Loss: 0.1504830 Test Loss: 0.2193358
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 39 cost time: 0.9108049869537354
Epoch: 39, Steps: 64 | Train Loss: 0.0999970 Vali Loss: 0.1499899 Test Loss: 0.2192554
Validation loss decreased (0.150032 --> 0.149990).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 40 cost time: 0.9100003242492676
Epoch: 40, Steps: 64 | Train Loss: 0.1002362 Vali Loss: 0.1513879 Test Loss: 0.2195932
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 41 cost time: 0.8976171016693115
Epoch: 41, Steps: 64 | Train Loss: 0.1006913 Vali Loss: 0.1513430 Test Loss: 0.2212777
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 42 cost time: 0.8962419033050537
Epoch: 42, Steps: 64 | Train Loss: 0.1003415 Vali Loss: 0.1522885 Test Loss: 0.2198642
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 43 cost time: 0.8997678756713867
Epoch: 43, Steps: 64 | Train Loss: 0.1002647 Vali Loss: 0.1515203 Test Loss: 0.2198385
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 44 cost time: 0.9193878173828125
Epoch: 44, Steps: 64 | Train Loss: 0.0998862 Vali Loss: 0.1515396 Test Loss: 0.2198382
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 45 cost time: 0.9063396453857422
Epoch: 45, Steps: 64 | Train Loss: 0.1003508 Vali Loss: 0.1508020 Test Loss: 0.2201875
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 46 cost time: 0.91214919090271
Epoch: 46, Steps: 64 | Train Loss: 0.1002261 Vali Loss: 0.1506850 Test Loss: 0.2197167
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 47 cost time: 0.9180004596710205
Epoch: 47, Steps: 64 | Train Loss: 0.1006181 Vali Loss: 0.1500379 Test Loss: 0.2189876
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 48 cost time: 0.8986191749572754
Epoch: 48, Steps: 64 | Train Loss: 0.1001696 Vali Loss: 0.1498560 Test Loss: 0.2197327
Validation loss decreased (0.149990 --> 0.149856).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 49 cost time: 0.9014029502868652
Epoch: 49, Steps: 64 | Train Loss: 0.0999990 Vali Loss: 0.1495516 Test Loss: 0.2194111
Validation loss decreased (0.149856 --> 0.149552).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 50 cost time: 0.9020264148712158
Epoch: 50, Steps: 64 | Train Loss: 0.1002179 Vali Loss: 0.1497814 Test Loss: 0.2197459
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 51 cost time: 0.9003844261169434
Epoch: 51, Steps: 64 | Train Loss: 0.1000503 Vali Loss: 0.1512856 Test Loss: 0.2192906
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 52 cost time: 0.9053797721862793
Epoch: 52, Steps: 64 | Train Loss: 0.1003934 Vali Loss: 0.1505233 Test Loss: 0.2203120
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 53 cost time: 0.9132084846496582
Epoch: 53, Steps: 64 | Train Loss: 0.0999436 Vali Loss: 0.1505758 Test Loss: 0.2203971
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 54 cost time: 0.9197249412536621
Epoch: 54, Steps: 64 | Train Loss: 0.0997408 Vali Loss: 0.1496315 Test Loss: 0.2192630
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 55 cost time: 0.9036228656768799
Epoch: 55, Steps: 64 | Train Loss: 0.0998131 Vali Loss: 0.1495194 Test Loss: 0.2193743
Validation loss decreased (0.149552 --> 0.149519).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 56 cost time: 0.9123589992523193
Epoch: 56, Steps: 64 | Train Loss: 0.1001248 Vali Loss: 0.1511895 Test Loss: 0.2197853
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 57 cost time: 0.8973708152770996
Epoch: 57, Steps: 64 | Train Loss: 0.1003196 Vali Loss: 0.1504160 Test Loss: 0.2199205
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 58 cost time: 0.9133491516113281
Epoch: 58, Steps: 64 | Train Loss: 0.0998901 Vali Loss: 0.1505979 Test Loss: 0.2203299
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 59 cost time: 0.9019794464111328
Epoch: 59, Steps: 64 | Train Loss: 0.1002848 Vali Loss: 0.1508193 Test Loss: 0.2192146
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 60 cost time: 0.8977742195129395
Epoch: 60, Steps: 64 | Train Loss: 0.0995925 Vali Loss: 0.1515067 Test Loss: 0.2190635
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.21937428414821625, mae:0.3215447664260864, rse:0.23737062513828278
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.062178611755371094 GB
Epoch: 1 cost time: 2.2772042751312256
Epoch: 1, Steps: 64 | Train Loss: 0.8439614 Vali Loss: 2.2607517 Test Loss: 3.6059177
Validation loss decreased (inf --> 2.260752).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 2 cost time: 0.941612958908081
Epoch: 2, Steps: 64 | Train Loss: 0.3499630 Vali Loss: 0.2523203 Test Loss: 0.3323458
Validation loss decreased (2.260752 --> 0.252320).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 3 cost time: 0.9406259059906006
Epoch: 3, Steps: 64 | Train Loss: 0.1284366 Vali Loss: 0.1741581 Test Loss: 0.2207128
Validation loss decreased (0.252320 --> 0.174158).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 4 cost time: 0.9406180381774902
Epoch: 4, Steps: 64 | Train Loss: 0.1167039 Vali Loss: 0.1741512 Test Loss: 0.2235375
Validation loss decreased (0.174158 --> 0.174151).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 5 cost time: 1.0204176902770996
Epoch: 5, Steps: 64 | Train Loss: 0.1131647 Vali Loss: 0.1707781 Test Loss: 0.2214859
Validation loss decreased (0.174151 --> 0.170778).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 6 cost time: 0.940115213394165
Epoch: 6, Steps: 64 | Train Loss: 0.1113165 Vali Loss: 0.1669295 Test Loss: 0.2188931
Validation loss decreased (0.170778 --> 0.166930).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 7 cost time: 0.9383945465087891
Epoch: 7, Steps: 64 | Train Loss: 0.1095159 Vali Loss: 0.1640073 Test Loss: 0.2164092
Validation loss decreased (0.166930 --> 0.164007).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 8 cost time: 0.9201431274414062
Epoch: 8, Steps: 64 | Train Loss: 0.1087973 Vali Loss: 0.1622984 Test Loss: 0.2153690
Validation loss decreased (0.164007 --> 0.162298).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 9 cost time: 0.9403896331787109
Epoch: 9, Steps: 64 | Train Loss: 0.1080228 Vali Loss: 0.1602324 Test Loss: 0.2175596
Validation loss decreased (0.162298 --> 0.160232).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 10 cost time: 0.9377830028533936
Epoch: 10, Steps: 64 | Train Loss: 0.1063889 Vali Loss: 0.1582329 Test Loss: 0.2183738
Validation loss decreased (0.160232 --> 0.158233).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 11 cost time: 0.9528288841247559
Epoch: 11, Steps: 64 | Train Loss: 0.1059320 Vali Loss: 0.1574498 Test Loss: 0.2182585
Validation loss decreased (0.158233 --> 0.157450).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 12 cost time: 0.9423892498016357
Epoch: 12, Steps: 64 | Train Loss: 0.1052209 Vali Loss: 0.1561324 Test Loss: 0.2189781
Validation loss decreased (0.157450 --> 0.156132).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 13 cost time: 0.9426183700561523
Epoch: 13, Steps: 64 | Train Loss: 0.1052131 Vali Loss: 0.1577729 Test Loss: 0.2192060
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 14 cost time: 0.9396250247955322
Epoch: 14, Steps: 64 | Train Loss: 0.1047644 Vali Loss: 0.1559096 Test Loss: 0.2191383
Validation loss decreased (0.156132 --> 0.155910).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 15 cost time: 0.9414026737213135
Epoch: 15, Steps: 64 | Train Loss: 0.1037126 Vali Loss: 0.1575745 Test Loss: 0.2190956
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 16 cost time: 0.9344525337219238
Epoch: 16, Steps: 64 | Train Loss: 0.1038161 Vali Loss: 0.1542973 Test Loss: 0.2200737
Validation loss decreased (0.155910 --> 0.154297).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 17 cost time: 0.9363739490509033
Epoch: 17, Steps: 64 | Train Loss: 0.1032063 Vali Loss: 0.1541958 Test Loss: 0.2183612
Validation loss decreased (0.154297 --> 0.154196).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 18 cost time: 0.956505298614502
Epoch: 18, Steps: 64 | Train Loss: 0.1028411 Vali Loss: 0.1545834 Test Loss: 0.2196973
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 19 cost time: 0.9394149780273438
Epoch: 19, Steps: 64 | Train Loss: 0.1024835 Vali Loss: 0.1525279 Test Loss: 0.2184132
Validation loss decreased (0.154196 --> 0.152528).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 20 cost time: 0.9464497566223145
Epoch: 20, Steps: 64 | Train Loss: 0.1023686 Vali Loss: 0.1528696 Test Loss: 0.2189974
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 21 cost time: 0.9567840099334717
Epoch: 21, Steps: 64 | Train Loss: 0.1021874 Vali Loss: 0.1510011 Test Loss: 0.2181500
Validation loss decreased (0.152528 --> 0.151001).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 22 cost time: 0.931999683380127
Epoch: 22, Steps: 64 | Train Loss: 0.1019294 Vali Loss: 0.1526938 Test Loss: 0.2200693
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 23 cost time: 0.931621789932251
Epoch: 23, Steps: 64 | Train Loss: 0.1017153 Vali Loss: 0.1531310 Test Loss: 0.2195146
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 24 cost time: 0.9388723373413086
Epoch: 24, Steps: 64 | Train Loss: 0.1017416 Vali Loss: 0.1522027 Test Loss: 0.2194572
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 25 cost time: 1.0154330730438232
Epoch: 25, Steps: 64 | Train Loss: 0.1011972 Vali Loss: 0.1501389 Test Loss: 0.2193156
Validation loss decreased (0.151001 --> 0.150139).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 26 cost time: 0.9395043849945068
Epoch: 26, Steps: 64 | Train Loss: 0.1011352 Vali Loss: 0.1530640 Test Loss: 0.2204932
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 27 cost time: 0.9413795471191406
Epoch: 27, Steps: 64 | Train Loss: 0.1014387 Vali Loss: 0.1511281 Test Loss: 0.2190668
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 28 cost time: 0.9299747943878174
Epoch: 28, Steps: 64 | Train Loss: 0.1009981 Vali Loss: 0.1517888 Test Loss: 0.2189925
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 29 cost time: 0.9434077739715576
Epoch: 29, Steps: 64 | Train Loss: 0.1010285 Vali Loss: 0.1519045 Test Loss: 0.2197853
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 30 cost time: 0.9427783489227295
Epoch: 30, Steps: 64 | Train Loss: 0.1007900 Vali Loss: 0.1526355 Test Loss: 0.2195198
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 31 cost time: 0.9347817897796631
Epoch: 31, Steps: 64 | Train Loss: 0.1012045 Vali Loss: 0.1518656 Test Loss: 0.2200465
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 32 cost time: 0.9434020519256592
Epoch: 32, Steps: 64 | Train Loss: 0.1006702 Vali Loss: 0.1496157 Test Loss: 0.2191148
Validation loss decreased (0.150139 --> 0.149616).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 33 cost time: 0.9396264553070068
Epoch: 33, Steps: 64 | Train Loss: 0.1007338 Vali Loss: 0.1519123 Test Loss: 0.2198818
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 34 cost time: 0.9516103267669678
Epoch: 34, Steps: 64 | Train Loss: 0.1001302 Vali Loss: 0.1507885 Test Loss: 0.2191369
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 35 cost time: 0.9394378662109375
Epoch: 35, Steps: 64 | Train Loss: 0.1000771 Vali Loss: 0.1503019 Test Loss: 0.2190740
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 36 cost time: 0.9439635276794434
Epoch: 36, Steps: 64 | Train Loss: 0.0999779 Vali Loss: 0.1508766 Test Loss: 0.2195345
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 37 cost time: 0.9414103031158447
Epoch: 37, Steps: 64 | Train Loss: 0.1002846 Vali Loss: 0.1496588 Test Loss: 0.2194038
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 38 cost time: 0.953193187713623
Epoch: 38, Steps: 64 | Train Loss: 0.0998872 Vali Loss: 0.1507707 Test Loss: 0.2192353
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 39 cost time: 0.9453897476196289
Epoch: 39, Steps: 64 | Train Loss: 0.1002991 Vali Loss: 0.1499497 Test Loss: 0.2193887
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 40 cost time: 0.9377973079681396
Epoch: 40, Steps: 64 | Train Loss: 0.0998401 Vali Loss: 0.1495930 Test Loss: 0.2197573
Validation loss decreased (0.149616 --> 0.149593).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 41 cost time: 0.9459998607635498
Epoch: 41, Steps: 64 | Train Loss: 0.0998450 Vali Loss: 0.1501077 Test Loss: 0.2193473
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 42 cost time: 0.9440000057220459
Epoch: 42, Steps: 64 | Train Loss: 0.1002777 Vali Loss: 0.1512884 Test Loss: 0.2197159
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 43 cost time: 0.9420194625854492
Epoch: 43, Steps: 64 | Train Loss: 0.1002089 Vali Loss: 0.1501984 Test Loss: 0.2195480
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 44 cost time: 0.9506325721740723
Epoch: 44, Steps: 64 | Train Loss: 0.1000536 Vali Loss: 0.1508456 Test Loss: 0.2198608
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 45 cost time: 0.9354128837585449
Epoch: 45, Steps: 64 | Train Loss: 0.0999588 Vali Loss: 0.1515772 Test Loss: 0.2196609
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 46 cost time: 0.9414117336273193
Epoch: 46, Steps: 64 | Train Loss: 0.0998728 Vali Loss: 0.1498890 Test Loss: 0.2200106
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 47 cost time: 0.9354701042175293
Epoch: 47, Steps: 64 | Train Loss: 0.1000217 Vali Loss: 0.1512390 Test Loss: 0.2197951
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 48 cost time: 0.9493551254272461
Epoch: 48, Steps: 64 | Train Loss: 0.0999821 Vali Loss: 0.1496527 Test Loss: 0.2194673
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 49 cost time: 0.9344158172607422
Epoch: 49, Steps: 64 | Train Loss: 0.0999973 Vali Loss: 0.1505352 Test Loss: 0.2195557
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 50 cost time: 0.9417257308959961
Epoch: 50, Steps: 64 | Train Loss: 0.1000546 Vali Loss: 0.1501393 Test Loss: 0.2195772
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 51 cost time: 0.9446060657501221
Epoch: 51, Steps: 64 | Train Loss: 0.0997186 Vali Loss: 0.1497060 Test Loss: 0.2194452
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 52 cost time: 0.9396243095397949
Epoch: 52, Steps: 64 | Train Loss: 0.0996471 Vali Loss: 0.1494602 Test Loss: 0.2196095
Validation loss decreased (0.149593 --> 0.149460).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 53 cost time: 0.9482824802398682
Epoch: 53, Steps: 64 | Train Loss: 0.1003450 Vali Loss: 0.1494801 Test Loss: 0.2197891
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 54 cost time: 0.9484298229217529
Epoch: 54, Steps: 64 | Train Loss: 0.1000987 Vali Loss: 0.1515410 Test Loss: 0.2196140
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 55 cost time: 0.934422492980957
Epoch: 55, Steps: 64 | Train Loss: 0.0997692 Vali Loss: 0.1509922 Test Loss: 0.2197986
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 56 cost time: 0.9343981742858887
Epoch: 56, Steps: 64 | Train Loss: 0.0998339 Vali Loss: 0.1511855 Test Loss: 0.2198158
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 57 cost time: 0.9326009750366211
Epoch: 57, Steps: 64 | Train Loss: 0.0997731 Vali Loss: 0.1506377 Test Loss: 0.2196915
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 58 cost time: 0.9553759098052979
Epoch: 58, Steps: 64 | Train Loss: 0.0999622 Vali Loss: 0.1510670 Test Loss: 0.2196214
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 59 cost time: 0.9417464733123779
Epoch: 59, Steps: 64 | Train Loss: 0.0996479 Vali Loss: 0.1490159 Test Loss: 0.2192643
Validation loss decreased (0.149460 --> 0.149016).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 60 cost time: 0.9419994354248047
Epoch: 60, Steps: 64 | Train Loss: 0.1001207 Vali Loss: 0.1511464 Test Loss: 0.2196563
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.21926428377628326, mae:0.32468196749687195, rse:0.23731112480163574
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.05464744567871094 GB
Epoch: 1 cost time: 2.2430970668792725
Epoch: 1, Steps: 64 | Train Loss: 0.9986101 Vali Loss: 2.5408041 Test Loss: 4.1175113
Validation loss decreased (inf --> 2.540804).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 2 cost time: 0.8715054988861084
Epoch: 2, Steps: 64 | Train Loss: 0.6888991 Vali Loss: 1.0314634 Test Loss: 1.5985663
Validation loss decreased (2.540804 --> 1.031463).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 3 cost time: 0.8813977241516113
Epoch: 3, Steps: 64 | Train Loss: 0.3855629 Vali Loss: 0.6243170 Test Loss: 0.9100999
Validation loss decreased (1.031463 --> 0.624317).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 4 cost time: 0.8823864459991455
Epoch: 4, Steps: 64 | Train Loss: 0.2539956 Vali Loss: 0.4044936 Test Loss: 0.5604562
Validation loss decreased (0.624317 --> 0.404494).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 5 cost time: 0.8939785957336426
Epoch: 5, Steps: 64 | Train Loss: 0.1860484 Vali Loss: 0.2891932 Test Loss: 0.3890013
Validation loss decreased (0.404494 --> 0.289193).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 6 cost time: 0.8763799667358398
Epoch: 6, Steps: 64 | Train Loss: 0.1571356 Vali Loss: 0.2368387 Test Loss: 0.3101847
Validation loss decreased (0.289193 --> 0.236839).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 7 cost time: 0.8800005912780762
Epoch: 7, Steps: 64 | Train Loss: 0.1417491 Vali Loss: 0.2069146 Test Loss: 0.2708234
Validation loss decreased (0.236839 --> 0.206915).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 8 cost time: 0.8796062469482422
Epoch: 8, Steps: 64 | Train Loss: 0.1328122 Vali Loss: 0.1923843 Test Loss: 0.2529788
Validation loss decreased (0.206915 --> 0.192384).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 9 cost time: 0.8763687610626221
Epoch: 9, Steps: 64 | Train Loss: 0.1285693 Vali Loss: 0.1809264 Test Loss: 0.2402731
Validation loss decreased (0.192384 --> 0.180926).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 10 cost time: 0.8780224323272705
Epoch: 10, Steps: 64 | Train Loss: 0.1260908 Vali Loss: 0.1748865 Test Loss: 0.2330795
Validation loss decreased (0.180926 --> 0.174886).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 11 cost time: 0.8843343257904053
Epoch: 11, Steps: 64 | Train Loss: 0.1241234 Vali Loss: 0.1729060 Test Loss: 0.2308726
Validation loss decreased (0.174886 --> 0.172906).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 12 cost time: 0.8888192176818848
Epoch: 12, Steps: 64 | Train Loss: 0.1213121 Vali Loss: 0.1704047 Test Loss: 0.2275071
Validation loss decreased (0.172906 --> 0.170405).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 13 cost time: 0.880000114440918
Epoch: 13, Steps: 64 | Train Loss: 0.1211802 Vali Loss: 0.1688475 Test Loss: 0.2273398
Validation loss decreased (0.170405 --> 0.168848).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 14 cost time: 0.8806116580963135
Epoch: 14, Steps: 64 | Train Loss: 0.1193112 Vali Loss: 0.1672346 Test Loss: 0.2245403
Validation loss decreased (0.168848 --> 0.167235).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 15 cost time: 0.8833708763122559
Epoch: 15, Steps: 64 | Train Loss: 0.1185032 Vali Loss: 0.1649783 Test Loss: 0.2239551
Validation loss decreased (0.167235 --> 0.164978).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 16 cost time: 0.8753886222839355
Epoch: 16, Steps: 64 | Train Loss: 0.1182589 Vali Loss: 0.1650338 Test Loss: 0.2245641
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 17 cost time: 0.8873424530029297
Epoch: 17, Steps: 64 | Train Loss: 0.1172553 Vali Loss: 0.1644847 Test Loss: 0.2232211
Validation loss decreased (0.164978 --> 0.164485).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 18 cost time: 0.8907909393310547
Epoch: 18, Steps: 64 | Train Loss: 0.1164306 Vali Loss: 0.1622588 Test Loss: 0.2229879
Validation loss decreased (0.164485 --> 0.162259).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 19 cost time: 0.9053757190704346
Epoch: 19, Steps: 64 | Train Loss: 0.1163779 Vali Loss: 0.1631867 Test Loss: 0.2242319
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 20 cost time: 0.8979997634887695
Epoch: 20, Steps: 64 | Train Loss: 0.1160783 Vali Loss: 0.1600117 Test Loss: 0.2217978
Validation loss decreased (0.162259 --> 0.160012).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 21 cost time: 0.9006009101867676
Epoch: 21, Steps: 64 | Train Loss: 0.1148725 Vali Loss: 0.1625279 Test Loss: 0.2228987
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 22 cost time: 0.903313159942627
Epoch: 22, Steps: 64 | Train Loss: 0.1154673 Vali Loss: 0.1638765 Test Loss: 0.2221951
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 23 cost time: 0.9431302547454834
Epoch: 23, Steps: 64 | Train Loss: 0.1149180 Vali Loss: 0.1634412 Test Loss: 0.2238929
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 24 cost time: 0.887427568435669
Epoch: 24, Steps: 64 | Train Loss: 0.1149625 Vali Loss: 0.1624492 Test Loss: 0.2225989
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 25 cost time: 0.889723539352417
Epoch: 25, Steps: 64 | Train Loss: 0.1150734 Vali Loss: 0.1612654 Test Loss: 0.2222242
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 26 cost time: 0.8880000114440918
Epoch: 26, Steps: 64 | Train Loss: 0.1143513 Vali Loss: 0.1604776 Test Loss: 0.2219828
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 27 cost time: 0.9005985260009766
Epoch: 27, Steps: 64 | Train Loss: 0.1141344 Vali Loss: 0.1610226 Test Loss: 0.2227467
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 28 cost time: 0.8923137187957764
Epoch: 28, Steps: 64 | Train Loss: 0.1138458 Vali Loss: 0.1620927 Test Loss: 0.2217913
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 29 cost time: 0.9013464450836182
Epoch: 29, Steps: 64 | Train Loss: 0.1136372 Vali Loss: 0.1622471 Test Loss: 0.2219342
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 30 cost time: 0.9473192691802979
Epoch: 30, Steps: 64 | Train Loss: 0.1136516 Vali Loss: 0.1625495 Test Loss: 0.2226926
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 31 cost time: 0.8954195976257324
Epoch: 31, Steps: 64 | Train Loss: 0.1138009 Vali Loss: 0.1611504 Test Loss: 0.2225066
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 32 cost time: 0.8864264488220215
Epoch: 32, Steps: 64 | Train Loss: 0.1133537 Vali Loss: 0.1612723 Test Loss: 0.2226813
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 33 cost time: 0.8920001983642578
Epoch: 33, Steps: 64 | Train Loss: 0.1138706 Vali Loss: 0.1626876 Test Loss: 0.2223582
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 34 cost time: 0.885610818862915
Epoch: 34, Steps: 64 | Train Loss: 0.1130993 Vali Loss: 0.1605087 Test Loss: 0.2227379
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 35 cost time: 0.8883223533630371
Epoch: 35, Steps: 64 | Train Loss: 0.1123775 Vali Loss: 0.1616398 Test Loss: 0.2228369
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 36 cost time: 0.9023470878601074
Epoch: 36, Steps: 64 | Train Loss: 0.1131436 Vali Loss: 0.1608914 Test Loss: 0.2217851
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 37 cost time: 0.9003150463104248
Epoch: 37, Steps: 64 | Train Loss: 0.1126301 Vali Loss: 0.1617797 Test Loss: 0.2227593
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 38 cost time: 0.8953356742858887
Epoch: 38, Steps: 64 | Train Loss: 0.1130242 Vali Loss: 0.1613227 Test Loss: 0.2231425
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 39 cost time: 0.9038505554199219
Epoch: 39, Steps: 64 | Train Loss: 0.1127834 Vali Loss: 0.1599086 Test Loss: 0.2226540
Validation loss decreased (0.160012 --> 0.159909).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 40 cost time: 0.9040000438690186
Epoch: 40, Steps: 64 | Train Loss: 0.1130480 Vali Loss: 0.1613570 Test Loss: 0.2226112
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 41 cost time: 0.8934051990509033
Epoch: 41, Steps: 64 | Train Loss: 0.1125984 Vali Loss: 0.1593366 Test Loss: 0.2220365
Validation loss decreased (0.159909 --> 0.159337).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 42 cost time: 0.8913326263427734
Epoch: 42, Steps: 64 | Train Loss: 0.1131678 Vali Loss: 0.1618598 Test Loss: 0.2234953
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 43 cost time: 0.8953471183776855
Epoch: 43, Steps: 64 | Train Loss: 0.1125786 Vali Loss: 0.1606503 Test Loss: 0.2230083
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 44 cost time: 0.8789236545562744
Epoch: 44, Steps: 64 | Train Loss: 0.1125333 Vali Loss: 0.1609050 Test Loss: 0.2223979
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 45 cost time: 0.8958001136779785
Epoch: 45, Steps: 64 | Train Loss: 0.1125805 Vali Loss: 0.1601527 Test Loss: 0.2222147
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 46 cost time: 0.8963561058044434
Epoch: 46, Steps: 64 | Train Loss: 0.1125343 Vali Loss: 0.1600568 Test Loss: 0.2223041
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 47 cost time: 0.881629228591919
Epoch: 47, Steps: 64 | Train Loss: 0.1122887 Vali Loss: 0.1599355 Test Loss: 0.2223577
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 48 cost time: 0.9466156959533691
Epoch: 48, Steps: 64 | Train Loss: 0.1124274 Vali Loss: 0.1598381 Test Loss: 0.2229273
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 49 cost time: 0.8803834915161133
Epoch: 49, Steps: 64 | Train Loss: 0.1129088 Vali Loss: 0.1597528 Test Loss: 0.2215228
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 50 cost time: 0.8784365653991699
Epoch: 50, Steps: 64 | Train Loss: 0.1122385 Vali Loss: 0.1599476 Test Loss: 0.2225781
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 51 cost time: 0.8453676700592041
Epoch: 51, Steps: 64 | Train Loss: 0.1124708 Vali Loss: 0.1586188 Test Loss: 0.2223871
Validation loss decreased (0.159337 --> 0.158619).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 52 cost time: 0.8747730255126953
Epoch: 52, Steps: 64 | Train Loss: 0.1122753 Vali Loss: 0.1602634 Test Loss: 0.2237804
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 53 cost time: 0.8714230060577393
Epoch: 53, Steps: 64 | Train Loss: 0.1125199 Vali Loss: 0.1598896 Test Loss: 0.2230022
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 54 cost time: 0.889866828918457
Epoch: 54, Steps: 64 | Train Loss: 0.1118335 Vali Loss: 0.1597314 Test Loss: 0.2231913
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 55 cost time: 0.884345531463623
Epoch: 55, Steps: 64 | Train Loss: 0.1121413 Vali Loss: 0.1605597 Test Loss: 0.2221670
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 56 cost time: 0.8833978176116943
Epoch: 56, Steps: 64 | Train Loss: 0.1125377 Vali Loss: 0.1600571 Test Loss: 0.2225380
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 57 cost time: 0.8853981494903564
Epoch: 57, Steps: 64 | Train Loss: 0.1120098 Vali Loss: 0.1588666 Test Loss: 0.2225182
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 58 cost time: 0.8887546062469482
Epoch: 58, Steps: 64 | Train Loss: 0.1124225 Vali Loss: 0.1607724 Test Loss: 0.2225433
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 59 cost time: 0.877408504486084
Epoch: 59, Steps: 64 | Train Loss: 0.1122754 Vali Loss: 0.1586111 Test Loss: 0.2214685
Validation loss decreased (0.158619 --> 0.158611).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 60 cost time: 0.873615026473999
Epoch: 60, Steps: 64 | Train Loss: 0.1122824 Vali Loss: 0.1612917 Test Loss: 0.2219330
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22146852314472198, mae:0.3223893344402313, rse:0.23850096762180328
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.05904197692871094 GB
Epoch: 1 cost time: 2.3047146797180176
Epoch: 1, Steps: 64 | Train Loss: 0.7788915 Vali Loss: 2.0208762 Test Loss: 3.2062709
Validation loss decreased (inf --> 2.020876).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 2 cost time: 0.9273266792297363
Epoch: 2, Steps: 64 | Train Loss: 0.3291722 Vali Loss: 0.2197901 Test Loss: 0.2584334
Validation loss decreased (2.020876 --> 0.219790).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 3 cost time: 0.9263041019439697
Epoch: 3, Steps: 64 | Train Loss: 0.1320092 Vali Loss: 0.1871838 Test Loss: 0.2339164
Validation loss decreased (0.219790 --> 0.187184).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 4 cost time: 0.9287121295928955
Epoch: 4, Steps: 64 | Train Loss: 0.1205953 Vali Loss: 0.1721277 Test Loss: 0.2211448
Validation loss decreased (0.187184 --> 0.172128).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 5 cost time: 0.8999068737030029
Epoch: 5, Steps: 64 | Train Loss: 0.1164839 Vali Loss: 0.1704549 Test Loss: 0.2180726
Validation loss decreased (0.172128 --> 0.170455).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 6 cost time: 0.9427793025970459
Epoch: 6, Steps: 64 | Train Loss: 0.1135906 Vali Loss: 0.1655050 Test Loss: 0.2194512
Validation loss decreased (0.170455 --> 0.165505).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 7 cost time: 0.9269998073577881
Epoch: 7, Steps: 64 | Train Loss: 0.1119057 Vali Loss: 0.1664791 Test Loss: 0.2182562
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 8 cost time: 0.9299588203430176
Epoch: 8, Steps: 64 | Train Loss: 0.1097955 Vali Loss: 0.1624393 Test Loss: 0.2169563
Validation loss decreased (0.165505 --> 0.162439).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 9 cost time: 0.9266016483306885
Epoch: 9, Steps: 64 | Train Loss: 0.1093751 Vali Loss: 0.1591512 Test Loss: 0.2171397
Validation loss decreased (0.162439 --> 0.159151).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 10 cost time: 0.9383211135864258
Epoch: 10, Steps: 64 | Train Loss: 0.1081118 Vali Loss: 0.1597954 Test Loss: 0.2167468
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 11 cost time: 0.9493193626403809
Epoch: 11, Steps: 64 | Train Loss: 0.1065983 Vali Loss: 0.1607159 Test Loss: 0.2156652
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 12 cost time: 0.9423267841339111
Epoch: 12, Steps: 64 | Train Loss: 0.1064962 Vali Loss: 0.1567971 Test Loss: 0.2153240
Validation loss decreased (0.159151 --> 0.156797).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 13 cost time: 0.9393682479858398
Epoch: 13, Steps: 64 | Train Loss: 0.1060710 Vali Loss: 0.1582086 Test Loss: 0.2159454
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 14 cost time: 0.9312989711761475
Epoch: 14, Steps: 64 | Train Loss: 0.1047860 Vali Loss: 0.1568560 Test Loss: 0.2165665
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 15 cost time: 0.9345624446868896
Epoch: 15, Steps: 64 | Train Loss: 0.1048440 Vali Loss: 0.1549027 Test Loss: 0.2149272
Validation loss decreased (0.156797 --> 0.154903).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 16 cost time: 0.9093494415283203
Epoch: 16, Steps: 64 | Train Loss: 0.1042198 Vali Loss: 0.1544937 Test Loss: 0.2164546
Validation loss decreased (0.154903 --> 0.154494).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 17 cost time: 0.9076056480407715
Epoch: 17, Steps: 64 | Train Loss: 0.1037060 Vali Loss: 0.1535226 Test Loss: 0.2164656
Validation loss decreased (0.154494 --> 0.153523).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 18 cost time: 0.9334166049957275
Epoch: 18, Steps: 64 | Train Loss: 0.1028299 Vali Loss: 0.1509034 Test Loss: 0.2168498
Validation loss decreased (0.153523 --> 0.150903).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 19 cost time: 0.9923765659332275
Epoch: 19, Steps: 64 | Train Loss: 0.1030798 Vali Loss: 0.1523760 Test Loss: 0.2163986
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 20 cost time: 0.9503014087677002
Epoch: 20, Steps: 64 | Train Loss: 0.1020282 Vali Loss: 0.1524409 Test Loss: 0.2160278
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 21 cost time: 0.9283175468444824
Epoch: 21, Steps: 64 | Train Loss: 0.1023492 Vali Loss: 0.1506690 Test Loss: 0.2161982
Validation loss decreased (0.150903 --> 0.150669).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 22 cost time: 0.9094631671905518
Epoch: 22, Steps: 64 | Train Loss: 0.1013318 Vali Loss: 0.1540886 Test Loss: 0.2163368
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 23 cost time: 0.9104084968566895
Epoch: 23, Steps: 64 | Train Loss: 0.1013372 Vali Loss: 0.1508229 Test Loss: 0.2168733
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 24 cost time: 0.912731409072876
Epoch: 24, Steps: 64 | Train Loss: 0.1011033 Vali Loss: 0.1488880 Test Loss: 0.2166085
Validation loss decreased (0.150669 --> 0.148888).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 25 cost time: 0.902332067489624
Epoch: 25, Steps: 64 | Train Loss: 0.1008180 Vali Loss: 0.1510368 Test Loss: 0.2159705
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 26 cost time: 0.9113874435424805
Epoch: 26, Steps: 64 | Train Loss: 0.1008547 Vali Loss: 0.1521796 Test Loss: 0.2162040
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 27 cost time: 0.991389274597168
Epoch: 27, Steps: 64 | Train Loss: 0.1006346 Vali Loss: 0.1501813 Test Loss: 0.2161955
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 28 cost time: 0.960515022277832
Epoch: 28, Steps: 64 | Train Loss: 0.1000884 Vali Loss: 0.1505902 Test Loss: 0.2162269
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 29 cost time: 0.9472470283508301
Epoch: 29, Steps: 64 | Train Loss: 0.0993958 Vali Loss: 0.1499848 Test Loss: 0.2172468
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 30 cost time: 0.9074239730834961
Epoch: 30, Steps: 64 | Train Loss: 0.0998947 Vali Loss: 0.1505350 Test Loss: 0.2169928
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 31 cost time: 0.9053621292114258
Epoch: 31, Steps: 64 | Train Loss: 0.0999538 Vali Loss: 0.1501155 Test Loss: 0.2173116
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 32 cost time: 0.9117245674133301
Epoch: 32, Steps: 64 | Train Loss: 0.1001680 Vali Loss: 0.1510902 Test Loss: 0.2166525
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 33 cost time: 0.9081645011901855
Epoch: 33, Steps: 64 | Train Loss: 0.0999369 Vali Loss: 0.1502726 Test Loss: 0.2165558
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 34 cost time: 0.9180011749267578
Epoch: 34, Steps: 64 | Train Loss: 0.0998862 Vali Loss: 0.1501897 Test Loss: 0.2171021
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 35 cost time: 0.9306213855743408
Epoch: 35, Steps: 64 | Train Loss: 0.0997008 Vali Loss: 0.1495923 Test Loss: 0.2165539
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 36 cost time: 0.9213612079620361
Epoch: 36, Steps: 64 | Train Loss: 0.0998233 Vali Loss: 0.1506877 Test Loss: 0.2170128
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 37 cost time: 0.9163601398468018
Epoch: 37, Steps: 64 | Train Loss: 0.0997871 Vali Loss: 0.1493780 Test Loss: 0.2161827
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 38 cost time: 0.9263598918914795
Epoch: 38, Steps: 64 | Train Loss: 0.0994622 Vali Loss: 0.1500802 Test Loss: 0.2159594
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 39 cost time: 0.9083986282348633
Epoch: 39, Steps: 64 | Train Loss: 0.0990015 Vali Loss: 0.1489764 Test Loss: 0.2165697
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 40 cost time: 0.9107272624969482
Epoch: 40, Steps: 64 | Train Loss: 0.0992717 Vali Loss: 0.1494683 Test Loss: 0.2168241
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 41 cost time: 0.9053969383239746
Epoch: 41, Steps: 64 | Train Loss: 0.0994861 Vali Loss: 0.1479821 Test Loss: 0.2169225
Validation loss decreased (0.148888 --> 0.147982).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 42 cost time: 0.9230003356933594
Epoch: 42, Steps: 64 | Train Loss: 0.0990829 Vali Loss: 0.1487151 Test Loss: 0.2165600
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 43 cost time: 0.9196138381958008
Epoch: 43, Steps: 64 | Train Loss: 0.0995328 Vali Loss: 0.1500823 Test Loss: 0.2171215
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 44 cost time: 0.9203622341156006
Epoch: 44, Steps: 64 | Train Loss: 0.0991743 Vali Loss: 0.1498020 Test Loss: 0.2172449
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 45 cost time: 0.9231927394866943
Epoch: 45, Steps: 64 | Train Loss: 0.0988065 Vali Loss: 0.1501839 Test Loss: 0.2175101
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 46 cost time: 0.9536464214324951
Epoch: 46, Steps: 64 | Train Loss: 0.0989080 Vali Loss: 0.1498863 Test Loss: 0.2165595
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 47 cost time: 0.9117147922515869
Epoch: 47, Steps: 64 | Train Loss: 0.0990367 Vali Loss: 0.1496566 Test Loss: 0.2171101
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 48 cost time: 0.9117856025695801
Epoch: 48, Steps: 64 | Train Loss: 0.0990723 Vali Loss: 0.1492130 Test Loss: 0.2170303
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 49 cost time: 0.8879992961883545
Epoch: 49, Steps: 64 | Train Loss: 0.0982917 Vali Loss: 0.1503347 Test Loss: 0.2171782
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 50 cost time: 0.9106221199035645
Epoch: 50, Steps: 64 | Train Loss: 0.0990925 Vali Loss: 0.1503052 Test Loss: 0.2163696
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 51 cost time: 0.9156372547149658
Epoch: 51, Steps: 64 | Train Loss: 0.0992013 Vali Loss: 0.1486772 Test Loss: 0.2163460
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 52 cost time: 0.9205322265625
Epoch: 52, Steps: 64 | Train Loss: 0.0993104 Vali Loss: 0.1497090 Test Loss: 0.2171911
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 53 cost time: 0.9153478145599365
Epoch: 53, Steps: 64 | Train Loss: 0.0987225 Vali Loss: 0.1490309 Test Loss: 0.2171520
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 54 cost time: 0.9240832328796387
Epoch: 54, Steps: 64 | Train Loss: 0.0989436 Vali Loss: 0.1486527 Test Loss: 0.2174292
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 55 cost time: 0.9184064865112305
Epoch: 55, Steps: 64 | Train Loss: 0.0989249 Vali Loss: 0.1485416 Test Loss: 0.2161758
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 56 cost time: 0.9167153835296631
Epoch: 56, Steps: 64 | Train Loss: 0.0989607 Vali Loss: 0.1492980 Test Loss: 0.2171282
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 57 cost time: 0.9199995994567871
Epoch: 57, Steps: 64 | Train Loss: 0.0988377 Vali Loss: 0.1472003 Test Loss: 0.2162507
Validation loss decreased (0.147982 --> 0.147200).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 58 cost time: 0.914353609085083
Epoch: 58, Steps: 64 | Train Loss: 0.0990917 Vali Loss: 0.1487059 Test Loss: 0.2169417
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 59 cost time: 0.9356033802032471
Epoch: 59, Steps: 64 | Train Loss: 0.0985925 Vali Loss: 0.1465525 Test Loss: 0.2158991
Validation loss decreased (0.147200 --> 0.146553).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 60 cost time: 0.9194328784942627
Epoch: 60, Steps: 64 | Train Loss: 0.0990317 Vali Loss: 0.1492596 Test Loss: 0.2166178
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.21589909493923187, mae:0.312264621257782, rse:0.23548299074172974
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.062340736389160156 GB
Epoch: 1 cost time: 2.3706166744232178
Epoch: 1, Steps: 64 | Train Loss: 0.8819577 Vali Loss: 2.3438063 Test Loss: 3.7264175
Validation loss decreased (inf --> 2.343806).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 2 cost time: 0.9544122219085693
Epoch: 2, Steps: 64 | Train Loss: 0.3447323 Vali Loss: 0.2832171 Test Loss: 0.3760683
Validation loss decreased (2.343806 --> 0.283217).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 3 cost time: 1.031341314315796
Epoch: 3, Steps: 64 | Train Loss: 0.1308761 Vali Loss: 0.1755442 Test Loss: 0.2153101
Validation loss decreased (0.283217 --> 0.175544).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 4 cost time: 1.032470941543579
Epoch: 4, Steps: 64 | Train Loss: 0.1190809 Vali Loss: 0.1721172 Test Loss: 0.2201133
Validation loss decreased (0.175544 --> 0.172117).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 5 cost time: 1.0194509029388428
Epoch: 5, Steps: 64 | Train Loss: 0.1150658 Vali Loss: 0.1656159 Test Loss: 0.2140754
Validation loss decreased (0.172117 --> 0.165616).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 6 cost time: 0.9564149379730225
Epoch: 6, Steps: 64 | Train Loss: 0.1127989 Vali Loss: 0.1670008 Test Loss: 0.2173265
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 7 cost time: 0.9539694786071777
Epoch: 7, Steps: 64 | Train Loss: 0.1105223 Vali Loss: 0.1648141 Test Loss: 0.2154157
Validation loss decreased (0.165616 --> 0.164814).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 8 cost time: 0.9524631500244141
Epoch: 8, Steps: 64 | Train Loss: 0.1094809 Vali Loss: 0.1629510 Test Loss: 0.2127111
Validation loss decreased (0.164814 --> 0.162951).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 9 cost time: 0.9577286243438721
Epoch: 9, Steps: 64 | Train Loss: 0.1084096 Vali Loss: 0.1581049 Test Loss: 0.2156310
Validation loss decreased (0.162951 --> 0.158105).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 10 cost time: 0.9577670097351074
Epoch: 10, Steps: 64 | Train Loss: 0.1070960 Vali Loss: 0.1584536 Test Loss: 0.2133926
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 11 cost time: 0.9556238651275635
Epoch: 11, Steps: 64 | Train Loss: 0.1059801 Vali Loss: 0.1601223 Test Loss: 0.2140219
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 12 cost time: 0.9646213054656982
Epoch: 12, Steps: 64 | Train Loss: 0.1054711 Vali Loss: 0.1569022 Test Loss: 0.2133245
Validation loss decreased (0.158105 --> 0.156902).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 13 cost time: 0.9506270885467529
Epoch: 13, Steps: 64 | Train Loss: 0.1050031 Vali Loss: 0.1553530 Test Loss: 0.2138102
Validation loss decreased (0.156902 --> 0.155353).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 14 cost time: 0.9493589401245117
Epoch: 14, Steps: 64 | Train Loss: 0.1042248 Vali Loss: 0.1558917 Test Loss: 0.2134433
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 15 cost time: 0.959317684173584
Epoch: 15, Steps: 64 | Train Loss: 0.1042396 Vali Loss: 0.1532429 Test Loss: 0.2138131
Validation loss decreased (0.155353 --> 0.153243).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 16 cost time: 0.9514079093933105
Epoch: 16, Steps: 64 | Train Loss: 0.1030282 Vali Loss: 0.1529825 Test Loss: 0.2140063
Validation loss decreased (0.153243 --> 0.152983).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 17 cost time: 0.9563307762145996
Epoch: 17, Steps: 64 | Train Loss: 0.1029885 Vali Loss: 0.1533133 Test Loss: 0.2136645
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 18 cost time: 0.9665877819061279
Epoch: 18, Steps: 64 | Train Loss: 0.1031597 Vali Loss: 0.1528087 Test Loss: 0.2136675
Validation loss decreased (0.152983 --> 0.152809).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 19 cost time: 0.9628920555114746
Epoch: 19, Steps: 64 | Train Loss: 0.1029112 Vali Loss: 0.1527246 Test Loss: 0.2144772
Validation loss decreased (0.152809 --> 0.152725).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 20 cost time: 0.960763692855835
Epoch: 20, Steps: 64 | Train Loss: 0.1017438 Vali Loss: 0.1516416 Test Loss: 0.2142653
Validation loss decreased (0.152725 --> 0.151642).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 21 cost time: 0.9927239418029785
Epoch: 21, Steps: 64 | Train Loss: 0.1018544 Vali Loss: 0.1489147 Test Loss: 0.2138138
Validation loss decreased (0.151642 --> 0.148915).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 22 cost time: 0.9347949028015137
Epoch: 22, Steps: 64 | Train Loss: 0.1018441 Vali Loss: 0.1508329 Test Loss: 0.2148809
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 23 cost time: 0.9424312114715576
Epoch: 23, Steps: 64 | Train Loss: 0.1015045 Vali Loss: 0.1520977 Test Loss: 0.2149023
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 24 cost time: 0.9466156959533691
Epoch: 24, Steps: 64 | Train Loss: 0.1009407 Vali Loss: 0.1500339 Test Loss: 0.2147828
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 25 cost time: 0.9376273155212402
Epoch: 25, Steps: 64 | Train Loss: 0.1010382 Vali Loss: 0.1503050 Test Loss: 0.2143277
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 26 cost time: 0.9291834831237793
Epoch: 26, Steps: 64 | Train Loss: 0.1011777 Vali Loss: 0.1495453 Test Loss: 0.2147982
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 27 cost time: 0.9573674201965332
Epoch: 27, Steps: 64 | Train Loss: 0.1009552 Vali Loss: 0.1495655 Test Loss: 0.2142459
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 28 cost time: 0.9623665809631348
Epoch: 28, Steps: 64 | Train Loss: 0.1014547 Vali Loss: 0.1513443 Test Loss: 0.2147557
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 29 cost time: 0.9533951282501221
Epoch: 29, Steps: 64 | Train Loss: 0.1006911 Vali Loss: 0.1502463 Test Loss: 0.2145462
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 30 cost time: 0.955535888671875
Epoch: 30, Steps: 64 | Train Loss: 0.1010290 Vali Loss: 0.1501442 Test Loss: 0.2145941
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 31 cost time: 0.9490644931793213
Epoch: 31, Steps: 64 | Train Loss: 0.1009211 Vali Loss: 0.1495924 Test Loss: 0.2147717
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 32 cost time: 0.948718786239624
Epoch: 32, Steps: 64 | Train Loss: 0.1003875 Vali Loss: 0.1492164 Test Loss: 0.2145085
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 33 cost time: 0.9534049034118652
Epoch: 33, Steps: 64 | Train Loss: 0.1006050 Vali Loss: 0.1483255 Test Loss: 0.2151801
Validation loss decreased (0.148915 --> 0.148325).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 34 cost time: 0.9586186408996582
Epoch: 34, Steps: 64 | Train Loss: 0.1006662 Vali Loss: 0.1502545 Test Loss: 0.2155735
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 35 cost time: 0.9700028896331787
Epoch: 35, Steps: 64 | Train Loss: 0.1009120 Vali Loss: 0.1511644 Test Loss: 0.2151140
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 36 cost time: 0.9596157073974609
Epoch: 36, Steps: 64 | Train Loss: 0.1001749 Vali Loss: 0.1483535 Test Loss: 0.2146442
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 37 cost time: 0.9519727230072021
Epoch: 37, Steps: 64 | Train Loss: 0.1005364 Vali Loss: 0.1481599 Test Loss: 0.2147470
Validation loss decreased (0.148325 --> 0.148160).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 38 cost time: 0.9674010276794434
Epoch: 38, Steps: 64 | Train Loss: 0.1004261 Vali Loss: 0.1498168 Test Loss: 0.2145771
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 39 cost time: 0.9553623199462891
Epoch: 39, Steps: 64 | Train Loss: 0.1000586 Vali Loss: 0.1489640 Test Loss: 0.2151841
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 40 cost time: 0.9513909816741943
Epoch: 40, Steps: 64 | Train Loss: 0.1000564 Vali Loss: 0.1482430 Test Loss: 0.2147335
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 41 cost time: 0.9713411331176758
Epoch: 41, Steps: 64 | Train Loss: 0.1002184 Vali Loss: 0.1486108 Test Loss: 0.2149194
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 42 cost time: 0.9564230442047119
Epoch: 42, Steps: 64 | Train Loss: 0.1002199 Vali Loss: 0.1492518 Test Loss: 0.2147478
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 43 cost time: 0.9571335315704346
Epoch: 43, Steps: 64 | Train Loss: 0.0999540 Vali Loss: 0.1481498 Test Loss: 0.2149173
Validation loss decreased (0.148160 --> 0.148150).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 44 cost time: 0.9607224464416504
Epoch: 44, Steps: 64 | Train Loss: 0.1000264 Vali Loss: 0.1486885 Test Loss: 0.2154592
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 45 cost time: 0.9220685958862305
Epoch: 45, Steps: 64 | Train Loss: 0.1003346 Vali Loss: 0.1485956 Test Loss: 0.2144866
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 46 cost time: 1.0396125316619873
Epoch: 46, Steps: 64 | Train Loss: 0.1004973 Vali Loss: 0.1490156 Test Loss: 0.2150505
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 47 cost time: 1.0444962978363037
Epoch: 47, Steps: 64 | Train Loss: 0.1004755 Vali Loss: 0.1499919 Test Loss: 0.2149368
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 48 cost time: 0.932645320892334
Epoch: 48, Steps: 64 | Train Loss: 0.1000981 Vali Loss: 0.1482837 Test Loss: 0.2150920
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 49 cost time: 0.9594337940216064
Epoch: 49, Steps: 64 | Train Loss: 0.1000092 Vali Loss: 0.1485225 Test Loss: 0.2144690
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 50 cost time: 0.9604978561401367
Epoch: 50, Steps: 64 | Train Loss: 0.1002909 Vali Loss: 0.1487613 Test Loss: 0.2147837
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 51 cost time: 0.9429912567138672
Epoch: 51, Steps: 64 | Train Loss: 0.1002693 Vali Loss: 0.1489396 Test Loss: 0.2148157
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 52 cost time: 0.9533483982086182
Epoch: 52, Steps: 64 | Train Loss: 0.1003329 Vali Loss: 0.1485115 Test Loss: 0.2149713
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 53 cost time: 0.9453608989715576
Epoch: 53, Steps: 64 | Train Loss: 0.0997595 Vali Loss: 0.1492499 Test Loss: 0.2146088
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 54 cost time: 0.959357500076294
Epoch: 54, Steps: 64 | Train Loss: 0.0998179 Vali Loss: 0.1504292 Test Loss: 0.2153968
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 55 cost time: 0.9502513408660889
Epoch: 55, Steps: 64 | Train Loss: 0.1003177 Vali Loss: 0.1492472 Test Loss: 0.2148973
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 56 cost time: 0.9447245597839355
Epoch: 56, Steps: 64 | Train Loss: 0.1001925 Vali Loss: 0.1489596 Test Loss: 0.2151964
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 57 cost time: 0.9559993743896484
Epoch: 57, Steps: 64 | Train Loss: 0.1002204 Vali Loss: 0.1467401 Test Loss: 0.2149439
Validation loss decreased (0.148150 --> 0.146740).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 58 cost time: 0.9566237926483154
Epoch: 58, Steps: 64 | Train Loss: 0.1000483 Vali Loss: 0.1473084 Test Loss: 0.2148447
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 59 cost time: 0.9549634456634521
Epoch: 59, Steps: 64 | Train Loss: 0.0997703 Vali Loss: 0.1471799 Test Loss: 0.2147763
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 60 cost time: 0.9593536853790283
Epoch: 60, Steps: 64 | Train Loss: 0.0993710 Vali Loss: 0.1496392 Test Loss: 0.2149403
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.21494390070438385, mae:0.3136863708496094, rse:0.23496149480342865
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.057959556579589844 GB
Epoch: 1 cost time: 2.2148942947387695
Epoch: 1, Steps: 64 | Train Loss: 0.9302377 Vali Loss: 2.4024189 Test Loss: 3.8782337
Validation loss decreased (inf --> 2.402419).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 2 cost time: 0.9401400089263916
Epoch: 2, Steps: 64 | Train Loss: 0.7295115 Vali Loss: 1.3344408 Test Loss: 2.0768874
Validation loss decreased (2.402419 --> 1.334441).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 3 cost time: 0.8664660453796387
Epoch: 3, Steps: 64 | Train Loss: 0.4430588 Vali Loss: 0.7485563 Test Loss: 1.0938960
Validation loss decreased (1.334441 --> 0.748556).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 4 cost time: 0.8634848594665527
Epoch: 4, Steps: 64 | Train Loss: 0.2857702 Vali Loss: 0.4757829 Test Loss: 0.6746708
Validation loss decreased (0.748556 --> 0.475783).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 5 cost time: 0.8334105014801025
Epoch: 5, Steps: 64 | Train Loss: 0.2045393 Vali Loss: 0.3304234 Test Loss: 0.4503310
Validation loss decreased (0.475783 --> 0.330423).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 6 cost time: 0.8446247577667236
Epoch: 6, Steps: 64 | Train Loss: 0.1677164 Vali Loss: 0.2595974 Test Loss: 0.3470725
Validation loss decreased (0.330423 --> 0.259597).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 7 cost time: 0.8533673286437988
Epoch: 7, Steps: 64 | Train Loss: 0.1490134 Vali Loss: 0.2223670 Test Loss: 0.2943907
Validation loss decreased (0.259597 --> 0.222367).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 8 cost time: 0.8564193248748779
Epoch: 8, Steps: 64 | Train Loss: 0.1402589 Vali Loss: 0.2023066 Test Loss: 0.2638251
Validation loss decreased (0.222367 --> 0.202307).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 9 cost time: 0.8502035140991211
Epoch: 9, Steps: 64 | Train Loss: 0.1338591 Vali Loss: 0.1916987 Test Loss: 0.2517934
Validation loss decreased (0.202307 --> 0.191699).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 10 cost time: 0.8580005168914795
Epoch: 10, Steps: 64 | Train Loss: 0.1305649 Vali Loss: 0.1848116 Test Loss: 0.2442229
Validation loss decreased (0.191699 --> 0.184812).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 11 cost time: 0.8566327095031738
Epoch: 11, Steps: 64 | Train Loss: 0.1282658 Vali Loss: 0.1787714 Test Loss: 0.2373832
Validation loss decreased (0.184812 --> 0.178771).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 12 cost time: 0.8756997585296631
Epoch: 12, Steps: 64 | Train Loss: 0.1266729 Vali Loss: 0.1748761 Test Loss: 0.2339020
Validation loss decreased (0.178771 --> 0.174876).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 13 cost time: 0.8624088764190674
Epoch: 13, Steps: 64 | Train Loss: 0.1248204 Vali Loss: 0.1687040 Test Loss: 0.2300007
Validation loss decreased (0.174876 --> 0.168704).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 14 cost time: 0.8562362194061279
Epoch: 14, Steps: 64 | Train Loss: 0.1239217 Vali Loss: 0.1693509 Test Loss: 0.2285504
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 15 cost time: 0.8595619201660156
Epoch: 15, Steps: 64 | Train Loss: 0.1226753 Vali Loss: 0.1680349 Test Loss: 0.2291911
Validation loss decreased (0.168704 --> 0.168035).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 16 cost time: 0.8622176647186279
Epoch: 16, Steps: 64 | Train Loss: 0.1219607 Vali Loss: 0.1695752 Test Loss: 0.2278920
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 17 cost time: 0.8533449172973633
Epoch: 17, Steps: 64 | Train Loss: 0.1209917 Vali Loss: 0.1657478 Test Loss: 0.2272944
Validation loss decreased (0.168035 --> 0.165748).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 18 cost time: 0.8564515113830566
Epoch: 18, Steps: 64 | Train Loss: 0.1205551 Vali Loss: 0.1653050 Test Loss: 0.2274917
Validation loss decreased (0.165748 --> 0.165305).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 19 cost time: 0.8607687950134277
Epoch: 19, Steps: 64 | Train Loss: 0.1194612 Vali Loss: 0.1645910 Test Loss: 0.2265281
Validation loss decreased (0.165305 --> 0.164591).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 20 cost time: 0.8724241256713867
Epoch: 20, Steps: 64 | Train Loss: 0.1196069 Vali Loss: 0.1642714 Test Loss: 0.2271903
Validation loss decreased (0.164591 --> 0.164271).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 21 cost time: 0.8670001029968262
Epoch: 21, Steps: 64 | Train Loss: 0.1190815 Vali Loss: 0.1620047 Test Loss: 0.2261533
Validation loss decreased (0.164271 --> 0.162005).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 22 cost time: 0.8721034526824951
Epoch: 22, Steps: 64 | Train Loss: 0.1183720 Vali Loss: 0.1633041 Test Loss: 0.2255830
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 23 cost time: 0.8565108776092529
Epoch: 23, Steps: 64 | Train Loss: 0.1176276 Vali Loss: 0.1632381 Test Loss: 0.2261411
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 24 cost time: 0.8504064083099365
Epoch: 24, Steps: 64 | Train Loss: 0.1183820 Vali Loss: 0.1630365 Test Loss: 0.2263931
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 25 cost time: 0.8515207767486572
Epoch: 25, Steps: 64 | Train Loss: 0.1177702 Vali Loss: 0.1616162 Test Loss: 0.2253079
Validation loss decreased (0.162005 --> 0.161616).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 26 cost time: 0.8489997386932373
Epoch: 26, Steps: 64 | Train Loss: 0.1176007 Vali Loss: 0.1619602 Test Loss: 0.2250960
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 27 cost time: 0.834381103515625
Epoch: 27, Steps: 64 | Train Loss: 0.1169715 Vali Loss: 0.1609920 Test Loss: 0.2257129
Validation loss decreased (0.161616 --> 0.160992).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 28 cost time: 0.8534946441650391
Epoch: 28, Steps: 64 | Train Loss: 0.1169994 Vali Loss: 0.1612920 Test Loss: 0.2253522
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 29 cost time: 0.8610677719116211
Epoch: 29, Steps: 64 | Train Loss: 0.1171458 Vali Loss: 0.1632274 Test Loss: 0.2255677
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 30 cost time: 0.8673460483551025
Epoch: 30, Steps: 64 | Train Loss: 0.1169428 Vali Loss: 0.1591498 Test Loss: 0.2247934
Validation loss decreased (0.160992 --> 0.159150).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 31 cost time: 0.8494231700897217
Epoch: 31, Steps: 64 | Train Loss: 0.1169251 Vali Loss: 0.1619240 Test Loss: 0.2255342
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 32 cost time: 0.8506274223327637
Epoch: 32, Steps: 64 | Train Loss: 0.1163727 Vali Loss: 0.1598373 Test Loss: 0.2246606
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 33 cost time: 0.8600106239318848
Epoch: 33, Steps: 64 | Train Loss: 0.1163894 Vali Loss: 0.1611938 Test Loss: 0.2247996
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 34 cost time: 0.8615937232971191
Epoch: 34, Steps: 64 | Train Loss: 0.1168425 Vali Loss: 0.1628858 Test Loss: 0.2252873
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 35 cost time: 0.855461835861206
Epoch: 35, Steps: 64 | Train Loss: 0.1164258 Vali Loss: 0.1594421 Test Loss: 0.2250728
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 36 cost time: 0.8560009002685547
Epoch: 36, Steps: 64 | Train Loss: 0.1158210 Vali Loss: 0.1601215 Test Loss: 0.2245805
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 37 cost time: 0.850628137588501
Epoch: 37, Steps: 64 | Train Loss: 0.1152120 Vali Loss: 0.1607989 Test Loss: 0.2245002
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 38 cost time: 0.8664298057556152
Epoch: 38, Steps: 64 | Train Loss: 0.1156303 Vali Loss: 0.1606126 Test Loss: 0.2245370
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 39 cost time: 0.8624608516693115
Epoch: 39, Steps: 64 | Train Loss: 0.1152640 Vali Loss: 0.1597765 Test Loss: 0.2248778
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 40 cost time: 0.856393575668335
Epoch: 40, Steps: 64 | Train Loss: 0.1152778 Vali Loss: 0.1598398 Test Loss: 0.2245020
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 41 cost time: 0.8566188812255859
Epoch: 41, Steps: 64 | Train Loss: 0.1156062 Vali Loss: 0.1604753 Test Loss: 0.2249438
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 42 cost time: 0.8554263114929199
Epoch: 42, Steps: 64 | Train Loss: 0.1152873 Vali Loss: 0.1588679 Test Loss: 0.2245153
Validation loss decreased (0.159150 --> 0.158868).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 43 cost time: 0.8463582992553711
Epoch: 43, Steps: 64 | Train Loss: 0.1156931 Vali Loss: 0.1587116 Test Loss: 0.2248533
Validation loss decreased (0.158868 --> 0.158712).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 44 cost time: 0.8463809490203857
Epoch: 44, Steps: 64 | Train Loss: 0.1154654 Vali Loss: 0.1601799 Test Loss: 0.2255119
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 45 cost time: 0.8557496070861816
Epoch: 45, Steps: 64 | Train Loss: 0.1158105 Vali Loss: 0.1600034 Test Loss: 0.2252218
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 46 cost time: 0.8550004959106445
Epoch: 46, Steps: 64 | Train Loss: 0.1154396 Vali Loss: 0.1603035 Test Loss: 0.2249107
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 47 cost time: 0.8569810390472412
Epoch: 47, Steps: 64 | Train Loss: 0.1153575 Vali Loss: 0.1604862 Test Loss: 0.2245533
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 48 cost time: 0.8593127727508545
Epoch: 48, Steps: 64 | Train Loss: 0.1146691 Vali Loss: 0.1590735 Test Loss: 0.2245304
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 49 cost time: 0.8593111038208008
Epoch: 49, Steps: 64 | Train Loss: 0.1151500 Vali Loss: 0.1603211 Test Loss: 0.2256011
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 50 cost time: 0.8289492130279541
Epoch: 50, Steps: 64 | Train Loss: 0.1156622 Vali Loss: 0.1604928 Test Loss: 0.2248633
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 51 cost time: 0.9229996204376221
Epoch: 51, Steps: 64 | Train Loss: 0.1151778 Vali Loss: 0.1603948 Test Loss: 0.2250766
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 52 cost time: 0.9186289310455322
Epoch: 52, Steps: 64 | Train Loss: 0.1156736 Vali Loss: 0.1605778 Test Loss: 0.2251388
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 53 cost time: 0.8334982395172119
Epoch: 53, Steps: 64 | Train Loss: 0.1151262 Vali Loss: 0.1591649 Test Loss: 0.2249254
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 54 cost time: 0.8443503379821777
Epoch: 54, Steps: 64 | Train Loss: 0.1152271 Vali Loss: 0.1604213 Test Loss: 0.2245046
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 55 cost time: 0.8454666137695312
Epoch: 55, Steps: 64 | Train Loss: 0.1153949 Vali Loss: 0.1598701 Test Loss: 0.2252838
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 56 cost time: 0.8574039936065674
Epoch: 56, Steps: 64 | Train Loss: 0.1153748 Vali Loss: 0.1591211 Test Loss: 0.2244111
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 57 cost time: 0.8546156883239746
Epoch: 57, Steps: 64 | Train Loss: 0.1154053 Vali Loss: 0.1613060 Test Loss: 0.2256908
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 58 cost time: 0.8503456115722656
Epoch: 58, Steps: 64 | Train Loss: 0.1151424 Vali Loss: 0.1604630 Test Loss: 0.2245410
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 59 cost time: 0.8523459434509277
Epoch: 59, Steps: 64 | Train Loss: 0.1154824 Vali Loss: 0.1596780 Test Loss: 0.2246216
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 60 cost time: 0.8633739948272705
Epoch: 60, Steps: 64 | Train Loss: 0.1152406 Vali Loss: 0.1607429 Test Loss: 0.2252886
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22485336661338806, mae:0.3330296277999878, rse:0.24031664431095123
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.062354087829589844 GB
Epoch: 1 cost time: 2.231048583984375
Epoch: 1, Steps: 64 | Train Loss: 0.8421519 Vali Loss: 2.2297473 Test Loss: 3.5154746
Validation loss decreased (inf --> 2.229747).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 2 cost time: 0.8906638622283936
Epoch: 2, Steps: 64 | Train Loss: 0.4104958 Vali Loss: 0.2537684 Test Loss: 0.2735529
Validation loss decreased (2.229747 --> 0.253768).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 3 cost time: 0.8864405155181885
Epoch: 3, Steps: 64 | Train Loss: 0.1389709 Vali Loss: 0.1858697 Test Loss: 0.2321544
Validation loss decreased (0.253768 --> 0.185870).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 4 cost time: 0.8789098262786865
Epoch: 4, Steps: 64 | Train Loss: 0.1255496 Vali Loss: 0.1744166 Test Loss: 0.2257476
Validation loss decreased (0.185870 --> 0.174417).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 5 cost time: 0.8915126323699951
Epoch: 5, Steps: 64 | Train Loss: 0.1201986 Vali Loss: 0.1743232 Test Loss: 0.2254439
Validation loss decreased (0.174417 --> 0.174323).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 6 cost time: 0.8921387195587158
Epoch: 6, Steps: 64 | Train Loss: 0.1164619 Vali Loss: 0.1699448 Test Loss: 0.2242716
Validation loss decreased (0.174323 --> 0.169945).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 7 cost time: 0.9039585590362549
Epoch: 7, Steps: 64 | Train Loss: 0.1141810 Vali Loss: 0.1666058 Test Loss: 0.2240053
Validation loss decreased (0.169945 --> 0.166606).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 8 cost time: 0.8980002403259277
Epoch: 8, Steps: 64 | Train Loss: 0.1115561 Vali Loss: 0.1645358 Test Loss: 0.2249128
Validation loss decreased (0.166606 --> 0.164536).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 9 cost time: 0.8936336040496826
Epoch: 9, Steps: 64 | Train Loss: 0.1107611 Vali Loss: 0.1623742 Test Loss: 0.2242688
Validation loss decreased (0.164536 --> 0.162374).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 10 cost time: 0.8988158702850342
Epoch: 10, Steps: 64 | Train Loss: 0.1085594 Vali Loss: 0.1624257 Test Loss: 0.2244315
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 11 cost time: 0.8984615802764893
Epoch: 11, Steps: 64 | Train Loss: 0.1086676 Vali Loss: 0.1601394 Test Loss: 0.2241969
Validation loss decreased (0.162374 --> 0.160139).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 12 cost time: 0.970435380935669
Epoch: 12, Steps: 64 | Train Loss: 0.1072638 Vali Loss: 0.1604740 Test Loss: 0.2246086
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 13 cost time: 0.9284441471099854
Epoch: 13, Steps: 64 | Train Loss: 0.1067955 Vali Loss: 0.1606484 Test Loss: 0.2255333
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 14 cost time: 0.9077954292297363
Epoch: 14, Steps: 64 | Train Loss: 0.1055666 Vali Loss: 0.1593202 Test Loss: 0.2244537
Validation loss decreased (0.160139 --> 0.159320).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 15 cost time: 0.8950016498565674
Epoch: 15, Steps: 64 | Train Loss: 0.1053563 Vali Loss: 0.1561871 Test Loss: 0.2256221
Validation loss decreased (0.159320 --> 0.156187).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 16 cost time: 0.8886127471923828
Epoch: 16, Steps: 64 | Train Loss: 0.1054592 Vali Loss: 0.1580700 Test Loss: 0.2247621
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 17 cost time: 0.890430212020874
Epoch: 17, Steps: 64 | Train Loss: 0.1048314 Vali Loss: 0.1585209 Test Loss: 0.2253657
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 18 cost time: 0.9002368450164795
Epoch: 18, Steps: 64 | Train Loss: 0.1041478 Vali Loss: 0.1573600 Test Loss: 0.2261518
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 19 cost time: 0.8909878730773926
Epoch: 19, Steps: 64 | Train Loss: 0.1044860 Vali Loss: 0.1560344 Test Loss: 0.2252837
Validation loss decreased (0.156187 --> 0.156034).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 20 cost time: 0.9007408618927002
Epoch: 20, Steps: 64 | Train Loss: 0.1042252 Vali Loss: 0.1575459 Test Loss: 0.2256192
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 21 cost time: 0.9078083038330078
Epoch: 21, Steps: 64 | Train Loss: 0.1028467 Vali Loss: 0.1565832 Test Loss: 0.2257533
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 22 cost time: 0.8980000019073486
Epoch: 22, Steps: 64 | Train Loss: 0.1028415 Vali Loss: 0.1555029 Test Loss: 0.2252781
Validation loss decreased (0.156034 --> 0.155503).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 23 cost time: 0.8970847129821777
Epoch: 23, Steps: 64 | Train Loss: 0.1025172 Vali Loss: 0.1566476 Test Loss: 0.2257258
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 24 cost time: 0.8923499584197998
Epoch: 24, Steps: 64 | Train Loss: 0.1024676 Vali Loss: 0.1562552 Test Loss: 0.2257118
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 25 cost time: 0.8913958072662354
Epoch: 25, Steps: 64 | Train Loss: 0.1027939 Vali Loss: 0.1547136 Test Loss: 0.2257281
Validation loss decreased (0.155503 --> 0.154714).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 26 cost time: 0.8964242935180664
Epoch: 26, Steps: 64 | Train Loss: 0.1020832 Vali Loss: 0.1558151 Test Loss: 0.2260395
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 27 cost time: 0.8968379497528076
Epoch: 27, Steps: 64 | Train Loss: 0.1019489 Vali Loss: 0.1548616 Test Loss: 0.2256277
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 28 cost time: 0.9109997749328613
Epoch: 28, Steps: 64 | Train Loss: 0.1023967 Vali Loss: 0.1552853 Test Loss: 0.2261143
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 29 cost time: 0.8999996185302734
Epoch: 29, Steps: 64 | Train Loss: 0.1017895 Vali Loss: 0.1547869 Test Loss: 0.2259803
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 30 cost time: 0.90236496925354
Epoch: 30, Steps: 64 | Train Loss: 0.1019124 Vali Loss: 0.1547130 Test Loss: 0.2255073
Validation loss decreased (0.154714 --> 0.154713).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 31 cost time: 0.9025716781616211
Epoch: 31, Steps: 64 | Train Loss: 0.1023702 Vali Loss: 0.1539549 Test Loss: 0.2254730
Validation loss decreased (0.154713 --> 0.153955).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 32 cost time: 0.8970327377319336
Epoch: 32, Steps: 64 | Train Loss: 0.1014171 Vali Loss: 0.1535798 Test Loss: 0.2255159
Validation loss decreased (0.153955 --> 0.153580).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 33 cost time: 0.8943772315979004
Epoch: 33, Steps: 64 | Train Loss: 0.1012420 Vali Loss: 0.1534642 Test Loss: 0.2256563
Validation loss decreased (0.153580 --> 0.153464).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 34 cost time: 0.8887507915496826
Epoch: 34, Steps: 64 | Train Loss: 0.1016449 Vali Loss: 0.1541599 Test Loss: 0.2257168
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 35 cost time: 0.9010000228881836
Epoch: 35, Steps: 64 | Train Loss: 0.1012152 Vali Loss: 0.1529139 Test Loss: 0.2259092
Validation loss decreased (0.153464 --> 0.152914).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 36 cost time: 0.8909838199615479
Epoch: 36, Steps: 64 | Train Loss: 0.1015720 Vali Loss: 0.1536503 Test Loss: 0.2258551
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 37 cost time: 0.8903934955596924
Epoch: 37, Steps: 64 | Train Loss: 0.1010715 Vali Loss: 0.1530991 Test Loss: 0.2259822
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 38 cost time: 0.8973743915557861
Epoch: 38, Steps: 64 | Train Loss: 0.1013148 Vali Loss: 0.1530253 Test Loss: 0.2260402
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 39 cost time: 0.9133334159851074
Epoch: 39, Steps: 64 | Train Loss: 0.1010820 Vali Loss: 0.1509394 Test Loss: 0.2261920
Validation loss decreased (0.152914 --> 0.150939).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 40 cost time: 0.9007415771484375
Epoch: 40, Steps: 64 | Train Loss: 0.1012782 Vali Loss: 0.1524729 Test Loss: 0.2258480
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 41 cost time: 0.8983855247497559
Epoch: 41, Steps: 64 | Train Loss: 0.1015392 Vali Loss: 0.1532623 Test Loss: 0.2263004
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 42 cost time: 0.9050002098083496
Epoch: 42, Steps: 64 | Train Loss: 0.1005522 Vali Loss: 0.1543196 Test Loss: 0.2262803
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 43 cost time: 0.8996405601501465
Epoch: 43, Steps: 64 | Train Loss: 0.1014600 Vali Loss: 0.1535077 Test Loss: 0.2261534
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 44 cost time: 0.8964509963989258
Epoch: 44, Steps: 64 | Train Loss: 0.1008374 Vali Loss: 0.1545803 Test Loss: 0.2262707
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 45 cost time: 0.9023981094360352
Epoch: 45, Steps: 64 | Train Loss: 0.1010840 Vali Loss: 0.1540200 Test Loss: 0.2261365
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 46 cost time: 0.9031350612640381
Epoch: 46, Steps: 64 | Train Loss: 0.1012138 Vali Loss: 0.1530116 Test Loss: 0.2257768
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 47 cost time: 0.892742395401001
Epoch: 47, Steps: 64 | Train Loss: 0.1007857 Vali Loss: 0.1507610 Test Loss: 0.2260066
Validation loss decreased (0.150939 --> 0.150761).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 48 cost time: 0.8880000114440918
Epoch: 48, Steps: 64 | Train Loss: 0.1006396 Vali Loss: 0.1527370 Test Loss: 0.2264560
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 49 cost time: 0.8856174945831299
Epoch: 49, Steps: 64 | Train Loss: 0.1008103 Vali Loss: 0.1540907 Test Loss: 0.2262766
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 50 cost time: 0.8842389583587646
Epoch: 50, Steps: 64 | Train Loss: 0.1006902 Vali Loss: 0.1527119 Test Loss: 0.2258406
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 51 cost time: 0.8865549564361572
Epoch: 51, Steps: 64 | Train Loss: 0.1010395 Vali Loss: 0.1510200 Test Loss: 0.2260567
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 52 cost time: 0.88433837890625
Epoch: 52, Steps: 64 | Train Loss: 0.1008285 Vali Loss: 0.1530969 Test Loss: 0.2259098
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 53 cost time: 0.8856916427612305
Epoch: 53, Steps: 64 | Train Loss: 0.1007360 Vali Loss: 0.1527303 Test Loss: 0.2260188
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 54 cost time: 0.9544222354888916
Epoch: 54, Steps: 64 | Train Loss: 0.1008376 Vali Loss: 0.1546066 Test Loss: 0.2262454
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 55 cost time: 0.9030003547668457
Epoch: 55, Steps: 64 | Train Loss: 0.1008964 Vali Loss: 0.1527894 Test Loss: 0.2261656
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 56 cost time: 0.8886160850524902
Epoch: 56, Steps: 64 | Train Loss: 0.1007641 Vali Loss: 0.1529883 Test Loss: 0.2262850
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 57 cost time: 0.8913929462432861
Epoch: 57, Steps: 64 | Train Loss: 0.1008424 Vali Loss: 0.1538219 Test Loss: 0.2263159
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 58 cost time: 0.8822500705718994
Epoch: 58, Steps: 64 | Train Loss: 0.1008936 Vali Loss: 0.1534229 Test Loss: 0.2258509
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 59 cost time: 0.8914473056793213
Epoch: 59, Steps: 64 | Train Loss: 0.1009945 Vali Loss: 0.1532563 Test Loss: 0.2259893
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 60 cost time: 0.8897566795349121
Epoch: 60, Steps: 64 | Train Loss: 0.1007771 Vali Loss: 0.1526312 Test Loss: 0.2263814
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22600653767585754, mae:0.3362162709236145, rse:0.24093207716941833
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.06565284729003906 GB
Epoch: 1 cost time: 2.338510513305664
Epoch: 1, Steps: 64 | Train Loss: 0.8890471 Vali Loss: 2.3843920 Test Loss: 3.8090267
Validation loss decreased (inf --> 2.384392).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 2 cost time: 0.929602861404419
Epoch: 2, Steps: 64 | Train Loss: 0.3892400 Vali Loss: 0.2628103 Test Loss: 0.3383243
Validation loss decreased (2.384392 --> 0.262810).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 3 cost time: 0.9280617237091064
Epoch: 3, Steps: 64 | Train Loss: 0.1367184 Vali Loss: 0.1891247 Test Loss: 0.2343115
Validation loss decreased (0.262810 --> 0.189125).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 4 cost time: 0.8880834579467773
Epoch: 4, Steps: 64 | Train Loss: 0.1221183 Vali Loss: 0.1764359 Test Loss: 0.2283326
Validation loss decreased (0.189125 --> 0.176436).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 5 cost time: 0.9173977375030518
Epoch: 5, Steps: 64 | Train Loss: 0.1172187 Vali Loss: 0.1742061 Test Loss: 0.2248698
Validation loss decreased (0.176436 --> 0.174206).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 6 cost time: 0.9193441867828369
Epoch: 6, Steps: 64 | Train Loss: 0.1143179 Vali Loss: 0.1667544 Test Loss: 0.2219807
Validation loss decreased (0.174206 --> 0.166754).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 7 cost time: 0.9248180389404297
Epoch: 7, Steps: 64 | Train Loss: 0.1123183 Vali Loss: 0.1668807 Test Loss: 0.2218665
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 8 cost time: 0.9143705368041992
Epoch: 8, Steps: 64 | Train Loss: 0.1102152 Vali Loss: 0.1645136 Test Loss: 0.2224002
Validation loss decreased (0.166754 --> 0.164514).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 9 cost time: 0.9250001907348633
Epoch: 9, Steps: 64 | Train Loss: 0.1089373 Vali Loss: 0.1617725 Test Loss: 0.2215412
Validation loss decreased (0.164514 --> 0.161773).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 10 cost time: 0.9426186084747314
Epoch: 10, Steps: 64 | Train Loss: 0.1081002 Vali Loss: 0.1616462 Test Loss: 0.2211815
Validation loss decreased (0.161773 --> 0.161646).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 11 cost time: 0.9226152896881104
Epoch: 11, Steps: 64 | Train Loss: 0.1070289 Vali Loss: 0.1623417 Test Loss: 0.2224462
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 12 cost time: 0.9209344387054443
Epoch: 12, Steps: 64 | Train Loss: 0.1057157 Vali Loss: 0.1585494 Test Loss: 0.2222342
Validation loss decreased (0.161646 --> 0.158549).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 13 cost time: 0.9213881492614746
Epoch: 13, Steps: 64 | Train Loss: 0.1053496 Vali Loss: 0.1603335 Test Loss: 0.2232699
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 14 cost time: 0.9372982978820801
Epoch: 14, Steps: 64 | Train Loss: 0.1044699 Vali Loss: 0.1579222 Test Loss: 0.2241318
Validation loss decreased (0.158549 --> 0.157922).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 15 cost time: 0.9214081764221191
Epoch: 15, Steps: 64 | Train Loss: 0.1041317 Vali Loss: 0.1569169 Test Loss: 0.2229702
Validation loss decreased (0.157922 --> 0.156917).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 16 cost time: 0.926746129989624
Epoch: 16, Steps: 64 | Train Loss: 0.1042092 Vali Loss: 0.1577556 Test Loss: 0.2242410
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 17 cost time: 0.9409983158111572
Epoch: 17, Steps: 64 | Train Loss: 0.1032437 Vali Loss: 0.1539989 Test Loss: 0.2239022
Validation loss decreased (0.156917 --> 0.153999).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 18 cost time: 0.9286224842071533
Epoch: 18, Steps: 64 | Train Loss: 0.1027883 Vali Loss: 0.1556975 Test Loss: 0.2242224
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 19 cost time: 0.9276440143585205
Epoch: 19, Steps: 64 | Train Loss: 0.1025729 Vali Loss: 0.1547911 Test Loss: 0.2236975
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 20 cost time: 0.9243969917297363
Epoch: 20, Steps: 64 | Train Loss: 0.1022843 Vali Loss: 0.1555103 Test Loss: 0.2246052
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 21 cost time: 0.9349727630615234
Epoch: 21, Steps: 64 | Train Loss: 0.1017477 Vali Loss: 0.1559497 Test Loss: 0.2253368
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 22 cost time: 0.924354076385498
Epoch: 22, Steps: 64 | Train Loss: 0.1022083 Vali Loss: 0.1546585 Test Loss: 0.2241638
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 23 cost time: 0.9274568557739258
Epoch: 23, Steps: 64 | Train Loss: 0.1012529 Vali Loss: 0.1548770 Test Loss: 0.2257904
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 24 cost time: 0.9087502956390381
Epoch: 24, Steps: 64 | Train Loss: 0.1020839 Vali Loss: 0.1540482 Test Loss: 0.2248728
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 25 cost time: 0.9173767566680908
Epoch: 25, Steps: 64 | Train Loss: 0.1010602 Vali Loss: 0.1553689 Test Loss: 0.2259124
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 26 cost time: 0.9206271171569824
Epoch: 26, Steps: 64 | Train Loss: 0.1015389 Vali Loss: 0.1546884 Test Loss: 0.2256454
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 27 cost time: 0.9223709106445312
Epoch: 27, Steps: 64 | Train Loss: 0.1012394 Vali Loss: 0.1531331 Test Loss: 0.2255410
Validation loss decreased (0.153999 --> 0.153133).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 28 cost time: 0.9203529357910156
Epoch: 28, Steps: 64 | Train Loss: 0.1011539 Vali Loss: 0.1524790 Test Loss: 0.2259912
Validation loss decreased (0.153133 --> 0.152479).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 29 cost time: 0.9171679019927979
Epoch: 29, Steps: 64 | Train Loss: 0.1010168 Vali Loss: 0.1521972 Test Loss: 0.2254544
Validation loss decreased (0.152479 --> 0.152197).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 30 cost time: 0.9164314270019531
Epoch: 30, Steps: 64 | Train Loss: 0.1003929 Vali Loss: 0.1536056 Test Loss: 0.2249911
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 31 cost time: 0.9114108085632324
Epoch: 31, Steps: 64 | Train Loss: 0.1009640 Vali Loss: 0.1526171 Test Loss: 0.2255242
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 32 cost time: 0.9177179336547852
Epoch: 32, Steps: 64 | Train Loss: 0.1008856 Vali Loss: 0.1532310 Test Loss: 0.2254686
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 33 cost time: 0.9172065258026123
Epoch: 33, Steps: 64 | Train Loss: 0.1008502 Vali Loss: 0.1533289 Test Loss: 0.2263878
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 34 cost time: 0.926621675491333
Epoch: 34, Steps: 64 | Train Loss: 0.1006161 Vali Loss: 0.1549525 Test Loss: 0.2260721
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 35 cost time: 0.9193296432495117
Epoch: 35, Steps: 64 | Train Loss: 0.1002258 Vali Loss: 0.1538958 Test Loss: 0.2258495
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 36 cost time: 0.9187393188476562
Epoch: 36, Steps: 64 | Train Loss: 0.1005671 Vali Loss: 0.1545369 Test Loss: 0.2262272
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 37 cost time: 0.9194014072418213
Epoch: 37, Steps: 64 | Train Loss: 0.1008869 Vali Loss: 0.1536451 Test Loss: 0.2263788
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 38 cost time: 0.9339561462402344
Epoch: 38, Steps: 64 | Train Loss: 0.1008328 Vali Loss: 0.1536693 Test Loss: 0.2261371
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 39 cost time: 0.9228343963623047
Epoch: 39, Steps: 64 | Train Loss: 0.1005336 Vali Loss: 0.1535794 Test Loss: 0.2262922
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 40 cost time: 0.9170002937316895
Epoch: 40, Steps: 64 | Train Loss: 0.1003511 Vali Loss: 0.1526987 Test Loss: 0.2262098
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 41 cost time: 0.9324140548706055
Epoch: 41, Steps: 64 | Train Loss: 0.1004710 Vali Loss: 0.1521326 Test Loss: 0.2259029
Validation loss decreased (0.152197 --> 0.152133).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 42 cost time: 0.9236218929290771
Epoch: 42, Steps: 64 | Train Loss: 0.1004060 Vali Loss: 0.1531244 Test Loss: 0.2260548
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 43 cost time: 0.9303395748138428
Epoch: 43, Steps: 64 | Train Loss: 0.1001486 Vali Loss: 0.1526251 Test Loss: 0.2256932
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 44 cost time: 0.9312639236450195
Epoch: 44, Steps: 64 | Train Loss: 0.1006181 Vali Loss: 0.1528463 Test Loss: 0.2264262
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 45 cost time: 0.9207525253295898
Epoch: 45, Steps: 64 | Train Loss: 0.1000284 Vali Loss: 0.1526661 Test Loss: 0.2262447
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 46 cost time: 0.9159440994262695
Epoch: 46, Steps: 64 | Train Loss: 0.1002101 Vali Loss: 0.1529909 Test Loss: 0.2263465
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 47 cost time: 0.9228250980377197
Epoch: 47, Steps: 64 | Train Loss: 0.0998490 Vali Loss: 0.1532829 Test Loss: 0.2263671
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 48 cost time: 0.9259991645812988
Epoch: 48, Steps: 64 | Train Loss: 0.1000649 Vali Loss: 0.1529308 Test Loss: 0.2262930
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 49 cost time: 0.9196372032165527
Epoch: 49, Steps: 64 | Train Loss: 0.1002593 Vali Loss: 0.1521291 Test Loss: 0.2267682
Validation loss decreased (0.152133 --> 0.152129).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 50 cost time: 0.9283990859985352
Epoch: 50, Steps: 64 | Train Loss: 0.0999555 Vali Loss: 0.1516365 Test Loss: 0.2259902
Validation loss decreased (0.152129 --> 0.151636).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 51 cost time: 0.922461748123169
Epoch: 51, Steps: 64 | Train Loss: 0.1001474 Vali Loss: 0.1525185 Test Loss: 0.2264591
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 52 cost time: 0.9143047332763672
Epoch: 52, Steps: 64 | Train Loss: 0.1002332 Vali Loss: 0.1530361 Test Loss: 0.2263457
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 53 cost time: 0.9163951873779297
Epoch: 53, Steps: 64 | Train Loss: 0.0999714 Vali Loss: 0.1526027 Test Loss: 0.2263437
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 54 cost time: 0.9223792552947998
Epoch: 54, Steps: 64 | Train Loss: 0.0999388 Vali Loss: 0.1526223 Test Loss: 0.2268406
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 55 cost time: 0.9344618320465088
Epoch: 55, Steps: 64 | Train Loss: 0.1002791 Vali Loss: 0.1534600 Test Loss: 0.2262262
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 56 cost time: 0.9190020561218262
Epoch: 56, Steps: 64 | Train Loss: 0.1008890 Vali Loss: 0.1528376 Test Loss: 0.2263416
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 57 cost time: 0.9246268272399902
Epoch: 57, Steps: 64 | Train Loss: 0.1000952 Vali Loss: 0.1526143 Test Loss: 0.2265520
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 58 cost time: 0.9151761531829834
Epoch: 58, Steps: 64 | Train Loss: 0.1002725 Vali Loss: 0.1542773 Test Loss: 0.2263134
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 59 cost time: 0.9180917739868164
Epoch: 59, Steps: 64 | Train Loss: 0.1003521 Vali Loss: 0.1536021 Test Loss: 0.2260907
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 60 cost time: 0.9153234958648682
Epoch: 60, Steps: 64 | Train Loss: 0.1003983 Vali Loss: 0.1526742 Test Loss: 0.2266789
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2259901612997055, mae:0.33684560656547546, rse:0.24092335999011993
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.0581212043762207 GB
Epoch: 1 cost time: 2.2622272968292236
Epoch: 1, Steps: 64 | Train Loss: 1.0939556 Vali Loss: 2.8463407 Test Loss: 4.5353308
Validation loss decreased (inf --> 2.846341).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 2 cost time: 0.8550481796264648
Epoch: 2, Steps: 64 | Train Loss: 0.7689955 Vali Loss: 1.1661315 Test Loss: 1.7692559
Validation loss decreased (2.846341 --> 1.166131).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 3 cost time: 0.858999490737915
Epoch: 3, Steps: 64 | Train Loss: 0.3984870 Vali Loss: 0.6123591 Test Loss: 0.8682246
Validation loss decreased (1.166131 --> 0.612359).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 4 cost time: 0.8643672466278076
Epoch: 4, Steps: 64 | Train Loss: 0.2522019 Vali Loss: 0.3922014 Test Loss: 0.5264982
Validation loss decreased (0.612359 --> 0.392201).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 5 cost time: 0.8610372543334961
Epoch: 5, Steps: 64 | Train Loss: 0.1914990 Vali Loss: 0.2943051 Test Loss: 0.3847851
Validation loss decreased (0.392201 --> 0.294305).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 6 cost time: 0.8448774814605713
Epoch: 6, Steps: 64 | Train Loss: 0.1635729 Vali Loss: 0.2411498 Test Loss: 0.3142541
Validation loss decreased (0.294305 --> 0.241150).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 7 cost time: 0.8557350635528564
Epoch: 7, Steps: 64 | Train Loss: 0.1491403 Vali Loss: 0.2129956 Test Loss: 0.2726835
Validation loss decreased (0.241150 --> 0.212996).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 8 cost time: 0.8589990139007568
Epoch: 8, Steps: 64 | Train Loss: 0.1414530 Vali Loss: 0.1979993 Test Loss: 0.2546725
Validation loss decreased (0.212996 --> 0.197999).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 9 cost time: 0.8586196899414062
Epoch: 9, Steps: 64 | Train Loss: 0.1364975 Vali Loss: 0.1893147 Test Loss: 0.2447427
Validation loss decreased (0.197999 --> 0.189315).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 10 cost time: 0.8586163520812988
Epoch: 10, Steps: 64 | Train Loss: 0.1328443 Vali Loss: 0.1816028 Test Loss: 0.2362004
Validation loss decreased (0.189315 --> 0.181603).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 11 cost time: 0.8584234714508057
Epoch: 11, Steps: 64 | Train Loss: 0.1300342 Vali Loss: 0.1792006 Test Loss: 0.2345379
Validation loss decreased (0.181603 --> 0.179201).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 12 cost time: 0.8573818206787109
Epoch: 12, Steps: 64 | Train Loss: 0.1291175 Vali Loss: 0.1753439 Test Loss: 0.2307309
Validation loss decreased (0.179201 --> 0.175344).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 13 cost time: 0.8719995021820068
Epoch: 13, Steps: 64 | Train Loss: 0.1276099 Vali Loss: 0.1729124 Test Loss: 0.2295329
Validation loss decreased (0.175344 --> 0.172912).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 14 cost time: 0.8583674430847168
Epoch: 14, Steps: 64 | Train Loss: 0.1255869 Vali Loss: 0.1700620 Test Loss: 0.2278886
Validation loss decreased (0.172912 --> 0.170062).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 15 cost time: 0.8564651012420654
Epoch: 15, Steps: 64 | Train Loss: 0.1252084 Vali Loss: 0.1711859 Test Loss: 0.2287509
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 16 cost time: 0.8554065227508545
Epoch: 16, Steps: 64 | Train Loss: 0.1248423 Vali Loss: 0.1698014 Test Loss: 0.2274087
Validation loss decreased (0.170062 --> 0.169801).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 17 cost time: 0.8711259365081787
Epoch: 17, Steps: 64 | Train Loss: 0.1231218 Vali Loss: 0.1692103 Test Loss: 0.2267252
Validation loss decreased (0.169801 --> 0.169210).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 18 cost time: 0.856792688369751
Epoch: 18, Steps: 64 | Train Loss: 0.1228902 Vali Loss: 0.1696662 Test Loss: 0.2270485
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 19 cost time: 0.8526668548583984
Epoch: 19, Steps: 64 | Train Loss: 0.1218777 Vali Loss: 0.1674626 Test Loss: 0.2262262
Validation loss decreased (0.169210 --> 0.167463).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 20 cost time: 0.8646106719970703
Epoch: 20, Steps: 64 | Train Loss: 0.1217076 Vali Loss: 0.1664004 Test Loss: 0.2257411
Validation loss decreased (0.167463 --> 0.166400).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 21 cost time: 0.8563895225524902
Epoch: 21, Steps: 64 | Train Loss: 0.1212894 Vali Loss: 0.1665773 Test Loss: 0.2259527
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 22 cost time: 0.8603746891021729
Epoch: 22, Steps: 64 | Train Loss: 0.1202142 Vali Loss: 0.1651855 Test Loss: 0.2255073
Validation loss decreased (0.166400 --> 0.165186).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 23 cost time: 0.857837438583374
Epoch: 23, Steps: 64 | Train Loss: 0.1206042 Vali Loss: 0.1668398 Test Loss: 0.2266823
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 24 cost time: 0.8560009002685547
Epoch: 24, Steps: 64 | Train Loss: 0.1202425 Vali Loss: 0.1642723 Test Loss: 0.2244429
Validation loss decreased (0.165186 --> 0.164272).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 25 cost time: 0.8536360263824463
Epoch: 25, Steps: 64 | Train Loss: 0.1200196 Vali Loss: 0.1655014 Test Loss: 0.2265066
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 26 cost time: 0.8563647270202637
Epoch: 26, Steps: 64 | Train Loss: 0.1193070 Vali Loss: 0.1645905 Test Loss: 0.2265085
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 27 cost time: 0.8513615131378174
Epoch: 27, Steps: 64 | Train Loss: 0.1190613 Vali Loss: 0.1647099 Test Loss: 0.2251082
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 28 cost time: 0.8471102714538574
Epoch: 28, Steps: 64 | Train Loss: 0.1192851 Vali Loss: 0.1633119 Test Loss: 0.2252597
Validation loss decreased (0.164272 --> 0.163312).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 29 cost time: 0.8550004959106445
Epoch: 29, Steps: 64 | Train Loss: 0.1189825 Vali Loss: 0.1649386 Test Loss: 0.2256187
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 30 cost time: 0.8596110343933105
Epoch: 30, Steps: 64 | Train Loss: 0.1182873 Vali Loss: 0.1625145 Test Loss: 0.2255501
Validation loss decreased (0.163312 --> 0.162514).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 31 cost time: 0.8553309440612793
Epoch: 31, Steps: 64 | Train Loss: 0.1187883 Vali Loss: 0.1642648 Test Loss: 0.2249641
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 32 cost time: 0.8401176929473877
Epoch: 32, Steps: 64 | Train Loss: 0.1181368 Vali Loss: 0.1636008 Test Loss: 0.2244004
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 33 cost time: 0.8547580242156982
Epoch: 33, Steps: 64 | Train Loss: 0.1185002 Vali Loss: 0.1645140 Test Loss: 0.2259776
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 34 cost time: 0.8500008583068848
Epoch: 34, Steps: 64 | Train Loss: 0.1179436 Vali Loss: 0.1627799 Test Loss: 0.2252331
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 35 cost time: 0.8686196804046631
Epoch: 35, Steps: 64 | Train Loss: 0.1181900 Vali Loss: 0.1618003 Test Loss: 0.2255246
Validation loss decreased (0.162514 --> 0.161800).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 36 cost time: 0.8533637523651123
Epoch: 36, Steps: 64 | Train Loss: 0.1179055 Vali Loss: 0.1636613 Test Loss: 0.2250170
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 37 cost time: 0.8514149188995361
Epoch: 37, Steps: 64 | Train Loss: 0.1175541 Vali Loss: 0.1628765 Test Loss: 0.2247767
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 38 cost time: 0.8537411689758301
Epoch: 38, Steps: 64 | Train Loss: 0.1176317 Vali Loss: 0.1598647 Test Loss: 0.2247285
Validation loss decreased (0.161800 --> 0.159865).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 39 cost time: 0.868431568145752
Epoch: 39, Steps: 64 | Train Loss: 0.1172368 Vali Loss: 0.1620528 Test Loss: 0.2243050
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 40 cost time: 0.8606224060058594
Epoch: 40, Steps: 64 | Train Loss: 0.1175921 Vali Loss: 0.1635207 Test Loss: 0.2256653
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 41 cost time: 0.8583955764770508
Epoch: 41, Steps: 64 | Train Loss: 0.1178349 Vali Loss: 0.1624286 Test Loss: 0.2256776
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 42 cost time: 0.8559956550598145
Epoch: 42, Steps: 64 | Train Loss: 0.1174091 Vali Loss: 0.1634944 Test Loss: 0.2258993
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 43 cost time: 0.8647568225860596
Epoch: 43, Steps: 64 | Train Loss: 0.1173282 Vali Loss: 0.1627146 Test Loss: 0.2246701
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 44 cost time: 0.8542945384979248
Epoch: 44, Steps: 64 | Train Loss: 0.1171085 Vali Loss: 0.1634921 Test Loss: 0.2248928
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 45 cost time: 0.8530001640319824
Epoch: 45, Steps: 64 | Train Loss: 0.1175958 Vali Loss: 0.1636743 Test Loss: 0.2250482
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 46 cost time: 0.8608376979827881
Epoch: 46, Steps: 64 | Train Loss: 0.1175518 Vali Loss: 0.1631361 Test Loss: 0.2250330
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 47 cost time: 0.8543980121612549
Epoch: 47, Steps: 64 | Train Loss: 0.1178476 Vali Loss: 0.1623995 Test Loss: 0.2247611
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 48 cost time: 0.859459638595581
Epoch: 48, Steps: 64 | Train Loss: 0.1169922 Vali Loss: 0.1628217 Test Loss: 0.2254955
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 49 cost time: 0.8586952686309814
Epoch: 49, Steps: 64 | Train Loss: 0.1170485 Vali Loss: 0.1643218 Test Loss: 0.2254066
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 50 cost time: 0.8629379272460938
Epoch: 50, Steps: 64 | Train Loss: 0.1172975 Vali Loss: 0.1628874 Test Loss: 0.2243925
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 51 cost time: 0.8616137504577637
Epoch: 51, Steps: 64 | Train Loss: 0.1170254 Vali Loss: 0.1620366 Test Loss: 0.2252619
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 52 cost time: 0.8503913879394531
Epoch: 52, Steps: 64 | Train Loss: 0.1177104 Vali Loss: 0.1619325 Test Loss: 0.2246213
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 53 cost time: 0.8523623943328857
Epoch: 53, Steps: 64 | Train Loss: 0.1168389 Vali Loss: 0.1622005 Test Loss: 0.2243716
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 54 cost time: 0.8437175750732422
Epoch: 54, Steps: 64 | Train Loss: 0.1171318 Vali Loss: 0.1622732 Test Loss: 0.2243992
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 55 cost time: 0.8493642807006836
Epoch: 55, Steps: 64 | Train Loss: 0.1166765 Vali Loss: 0.1619445 Test Loss: 0.2248184
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 56 cost time: 0.8484292030334473
Epoch: 56, Steps: 64 | Train Loss: 0.1167125 Vali Loss: 0.1621855 Test Loss: 0.2251855
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 57 cost time: 0.8539712429046631
Epoch: 57, Steps: 64 | Train Loss: 0.1166910 Vali Loss: 0.1625425 Test Loss: 0.2252631
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 58 cost time: 0.8548083305358887
Epoch: 58, Steps: 64 | Train Loss: 0.1172598 Vali Loss: 0.1633256 Test Loss: 0.2247595
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 59 cost time: 0.8667573928833008
Epoch: 59, Steps: 64 | Train Loss: 0.1167102 Vali Loss: 0.1609878 Test Loss: 0.2252735
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 60 cost time: 0.8604168891906738
Epoch: 60, Steps: 64 | Train Loss: 0.1168241 Vali Loss: 0.1622203 Test Loss: 0.2239591
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22472846508026123, mae:0.3308069705963135, rse:0.2402498871088028
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.0625157356262207 GB
Epoch: 1 cost time: 2.2655205726623535
Epoch: 1, Steps: 64 | Train Loss: 0.8494650 Vali Loss: 2.2221117 Test Loss: 3.5443821
Validation loss decreased (inf --> 2.222112).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 2 cost time: 0.8972194194793701
Epoch: 2, Steps: 64 | Train Loss: 0.3736057 Vali Loss: 0.2046281 Test Loss: 0.2464433
Validation loss decreased (2.222112 --> 0.204628).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 3 cost time: 0.8983762264251709
Epoch: 3, Steps: 64 | Train Loss: 0.1320287 Vali Loss: 0.1832238 Test Loss: 0.2284763
Validation loss decreased (0.204628 --> 0.183224).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 4 cost time: 0.8923540115356445
Epoch: 4, Steps: 64 | Train Loss: 0.1205518 Vali Loss: 0.1741818 Test Loss: 0.2208685
Validation loss decreased (0.183224 --> 0.174182).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 5 cost time: 0.8859424591064453
Epoch: 5, Steps: 64 | Train Loss: 0.1164404 Vali Loss: 0.1669360 Test Loss: 0.2193095
Validation loss decreased (0.174182 --> 0.166936).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 6 cost time: 0.8894472122192383
Epoch: 6, Steps: 64 | Train Loss: 0.1142527 Vali Loss: 0.1700243 Test Loss: 0.2210666
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 7 cost time: 0.8906152248382568
Epoch: 7, Steps: 64 | Train Loss: 0.1116540 Vali Loss: 0.1666852 Test Loss: 0.2189414
Validation loss decreased (0.166936 --> 0.166685).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 8 cost time: 0.8963384628295898
Epoch: 8, Steps: 64 | Train Loss: 0.1101515 Vali Loss: 0.1631309 Test Loss: 0.2186919
Validation loss decreased (0.166685 --> 0.163131).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 9 cost time: 0.8932368755340576
Epoch: 9, Steps: 64 | Train Loss: 0.1091387 Vali Loss: 0.1628125 Test Loss: 0.2199701
Validation loss decreased (0.163131 --> 0.162813).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 10 cost time: 0.8944430351257324
Epoch: 10, Steps: 64 | Train Loss: 0.1077535 Vali Loss: 0.1599540 Test Loss: 0.2183348
Validation loss decreased (0.162813 --> 0.159954).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 11 cost time: 0.8937222957611084
Epoch: 11, Steps: 64 | Train Loss: 0.1066859 Vali Loss: 0.1589457 Test Loss: 0.2183794
Validation loss decreased (0.159954 --> 0.158946).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 12 cost time: 0.904998779296875
Epoch: 12, Steps: 64 | Train Loss: 0.1062627 Vali Loss: 0.1580342 Test Loss: 0.2188013
Validation loss decreased (0.158946 --> 0.158034).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 13 cost time: 0.8910019397735596
Epoch: 13, Steps: 64 | Train Loss: 0.1052842 Vali Loss: 0.1573371 Test Loss: 0.2179379
Validation loss decreased (0.158034 --> 0.157337).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 14 cost time: 0.8923616409301758
Epoch: 14, Steps: 64 | Train Loss: 0.1047224 Vali Loss: 0.1566530 Test Loss: 0.2182108
Validation loss decreased (0.157337 --> 0.156653).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 15 cost time: 0.8943791389465332
Epoch: 15, Steps: 64 | Train Loss: 0.1040726 Vali Loss: 0.1575205 Test Loss: 0.2186704
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 16 cost time: 0.8943507671356201
Epoch: 16, Steps: 64 | Train Loss: 0.1039173 Vali Loss: 0.1566054 Test Loss: 0.2184282
Validation loss decreased (0.156653 --> 0.156605).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 17 cost time: 0.8903734683990479
Epoch: 17, Steps: 64 | Train Loss: 0.1034357 Vali Loss: 0.1560809 Test Loss: 0.2190331
Validation loss decreased (0.156605 --> 0.156081).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 18 cost time: 0.888744592666626
Epoch: 18, Steps: 64 | Train Loss: 0.1026927 Vali Loss: 0.1562413 Test Loss: 0.2189394
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 19 cost time: 0.9036285877227783
Epoch: 19, Steps: 64 | Train Loss: 0.1026519 Vali Loss: 0.1534400 Test Loss: 0.2184920
Validation loss decreased (0.156081 --> 0.153440).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 20 cost time: 0.8946270942687988
Epoch: 20, Steps: 64 | Train Loss: 0.1019068 Vali Loss: 0.1551022 Test Loss: 0.2202607
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 21 cost time: 0.8913989067077637
Epoch: 21, Steps: 64 | Train Loss: 0.1013746 Vali Loss: 0.1544468 Test Loss: 0.2189800
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 22 cost time: 0.899430513381958
Epoch: 22, Steps: 64 | Train Loss: 0.1011788 Vali Loss: 0.1530581 Test Loss: 0.2198801
Validation loss decreased (0.153440 --> 0.153058).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 23 cost time: 0.894993782043457
Epoch: 23, Steps: 64 | Train Loss: 0.1010911 Vali Loss: 0.1532398 Test Loss: 0.2200515
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 24 cost time: 0.8848319053649902
Epoch: 24, Steps: 64 | Train Loss: 0.1009645 Vali Loss: 0.1526098 Test Loss: 0.2200897
Validation loss decreased (0.153058 --> 0.152610).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 25 cost time: 0.8910024166107178
Epoch: 25, Steps: 64 | Train Loss: 0.1006661 Vali Loss: 0.1543894 Test Loss: 0.2204063
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 26 cost time: 0.8990001678466797
Epoch: 26, Steps: 64 | Train Loss: 0.1008808 Vali Loss: 0.1527325 Test Loss: 0.2198734
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 27 cost time: 0.8949790000915527
Epoch: 27, Steps: 64 | Train Loss: 0.1003757 Vali Loss: 0.1539143 Test Loss: 0.2203285
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 28 cost time: 0.8893687725067139
Epoch: 28, Steps: 64 | Train Loss: 0.1000042 Vali Loss: 0.1534311 Test Loss: 0.2204157
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 29 cost time: 0.8924045562744141
Epoch: 29, Steps: 64 | Train Loss: 0.0999115 Vali Loss: 0.1529759 Test Loss: 0.2205937
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 30 cost time: 0.8731238842010498
Epoch: 30, Steps: 64 | Train Loss: 0.0994825 Vali Loss: 0.1527433 Test Loss: 0.2203280
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 31 cost time: 0.8948097229003906
Epoch: 31, Steps: 64 | Train Loss: 0.0998210 Vali Loss: 0.1530548 Test Loss: 0.2205823
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 32 cost time: 0.8866236209869385
Epoch: 32, Steps: 64 | Train Loss: 0.0995314 Vali Loss: 0.1529088 Test Loss: 0.2205352
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 33 cost time: 0.89361572265625
Epoch: 33, Steps: 64 | Train Loss: 0.0999472 Vali Loss: 0.1537335 Test Loss: 0.2204702
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 34 cost time: 0.886368989944458
Epoch: 34, Steps: 64 | Train Loss: 0.0992187 Vali Loss: 0.1521421 Test Loss: 0.2206584
Validation loss decreased (0.152610 --> 0.152142).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 35 cost time: 0.8813574314117432
Epoch: 35, Steps: 64 | Train Loss: 0.0991508 Vali Loss: 0.1519657 Test Loss: 0.2205807
Validation loss decreased (0.152142 --> 0.151966).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 36 cost time: 0.8890132904052734
Epoch: 36, Steps: 64 | Train Loss: 0.1000295 Vali Loss: 0.1531184 Test Loss: 0.2206670
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 37 cost time: 0.9069783687591553
Epoch: 37, Steps: 64 | Train Loss: 0.0992588 Vali Loss: 0.1530299 Test Loss: 0.2209801
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 38 cost time: 0.8959994316101074
Epoch: 38, Steps: 64 | Train Loss: 0.0993154 Vali Loss: 0.1519473 Test Loss: 0.2207686
Validation loss decreased (0.151966 --> 0.151947).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 39 cost time: 0.8956069946289062
Epoch: 39, Steps: 64 | Train Loss: 0.0990852 Vali Loss: 0.1528339 Test Loss: 0.2210925
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 40 cost time: 0.9031798839569092
Epoch: 40, Steps: 64 | Train Loss: 0.0989003 Vali Loss: 0.1509920 Test Loss: 0.2207097
Validation loss decreased (0.151947 --> 0.150992).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 41 cost time: 0.9614384174346924
Epoch: 41, Steps: 64 | Train Loss: 0.0992257 Vali Loss: 0.1518784 Test Loss: 0.2209453
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 42 cost time: 0.8843486309051514
Epoch: 42, Steps: 64 | Train Loss: 0.0998209 Vali Loss: 0.1513783 Test Loss: 0.2209914
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 43 cost time: 0.8893990516662598
Epoch: 43, Steps: 64 | Train Loss: 0.0997573 Vali Loss: 0.1515236 Test Loss: 0.2204954
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 44 cost time: 0.8997416496276855
Epoch: 44, Steps: 64 | Train Loss: 0.0989078 Vali Loss: 0.1513624 Test Loss: 0.2204948
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 45 cost time: 0.8916177749633789
Epoch: 45, Steps: 64 | Train Loss: 0.0990828 Vali Loss: 0.1515196 Test Loss: 0.2209818
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 46 cost time: 0.8926043510437012
Epoch: 46, Steps: 64 | Train Loss: 0.0992722 Vali Loss: 0.1526951 Test Loss: 0.2212473
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 47 cost time: 0.9013488292694092
Epoch: 47, Steps: 64 | Train Loss: 0.0985620 Vali Loss: 0.1525652 Test Loss: 0.2211705
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 48 cost time: 0.8841328620910645
Epoch: 48, Steps: 64 | Train Loss: 0.0991697 Vali Loss: 0.1511361 Test Loss: 0.2209694
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 49 cost time: 0.8716733455657959
Epoch: 49, Steps: 64 | Train Loss: 0.0990967 Vali Loss: 0.1513005 Test Loss: 0.2207886
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 50 cost time: 0.8834061622619629
Epoch: 50, Steps: 64 | Train Loss: 0.0987215 Vali Loss: 0.1518500 Test Loss: 0.2206959
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 51 cost time: 0.8959999084472656
Epoch: 51, Steps: 64 | Train Loss: 0.0991433 Vali Loss: 0.1527729 Test Loss: 0.2209831
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 52 cost time: 0.8886427879333496
Epoch: 52, Steps: 64 | Train Loss: 0.0991700 Vali Loss: 0.1518574 Test Loss: 0.2209329
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 53 cost time: 0.8881998062133789
Epoch: 53, Steps: 64 | Train Loss: 0.0991801 Vali Loss: 0.1518977 Test Loss: 0.2207752
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 54 cost time: 0.9024026393890381
Epoch: 54, Steps: 64 | Train Loss: 0.0987292 Vali Loss: 0.1512932 Test Loss: 0.2211060
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 55 cost time: 0.8953425884246826
Epoch: 55, Steps: 64 | Train Loss: 0.0988733 Vali Loss: 0.1524375 Test Loss: 0.2208716
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 56 cost time: 0.8917896747589111
Epoch: 56, Steps: 64 | Train Loss: 0.0986257 Vali Loss: 0.1508274 Test Loss: 0.2206233
Validation loss decreased (0.150992 --> 0.150827).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 57 cost time: 0.8959999084472656
Epoch: 57, Steps: 64 | Train Loss: 0.0983427 Vali Loss: 0.1525259 Test Loss: 0.2212663
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 58 cost time: 0.9026203155517578
Epoch: 58, Steps: 64 | Train Loss: 0.0988518 Vali Loss: 0.1525942 Test Loss: 0.2209016
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 59 cost time: 0.8886265754699707
Epoch: 59, Steps: 64 | Train Loss: 0.0993832 Vali Loss: 0.1534519 Test Loss: 0.2210256
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 60 cost time: 0.8903777599334717
Epoch: 60, Steps: 64 | Train Loss: 0.0990171 Vali Loss: 0.1518816 Test Loss: 0.2212214
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22062332928180695, mae:0.3275684118270874, rse:0.23804543912410736
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06581449508666992 GB
Epoch: 1 cost time: 2.313370704650879
Epoch: 1, Steps: 64 | Train Loss: 0.8635289 Vali Loss: 2.3108914 Test Loss: 3.6613781
Validation loss decreased (inf --> 2.310891).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 2 cost time: 0.9653520584106445
Epoch: 2, Steps: 64 | Train Loss: 0.3486988 Vali Loss: 0.2466159 Test Loss: 0.3240305
Validation loss decreased (2.310891 --> 0.246616).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 3 cost time: 0.9292006492614746
Epoch: 3, Steps: 64 | Train Loss: 0.1285024 Vali Loss: 0.1788044 Test Loss: 0.2236272
Validation loss decreased (0.246616 --> 0.178804).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 4 cost time: 0.9133424758911133
Epoch: 4, Steps: 64 | Train Loss: 0.1174076 Vali Loss: 0.1746743 Test Loss: 0.2232440
Validation loss decreased (0.178804 --> 0.174674).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 5 cost time: 0.9234054088592529
Epoch: 5, Steps: 64 | Train Loss: 0.1141963 Vali Loss: 0.1650806 Test Loss: 0.2193994
Validation loss decreased (0.174674 --> 0.165081).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 6 cost time: 0.924619197845459
Epoch: 6, Steps: 64 | Train Loss: 0.1115447 Vali Loss: 0.1676909 Test Loss: 0.2192294
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 7 cost time: 0.9240546226501465
Epoch: 7, Steps: 64 | Train Loss: 0.1093815 Vali Loss: 0.1641805 Test Loss: 0.2200006
Validation loss decreased (0.165081 --> 0.164181).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 8 cost time: 0.9263839721679688
Epoch: 8, Steps: 64 | Train Loss: 0.1080729 Vali Loss: 0.1630098 Test Loss: 0.2173133
Validation loss decreased (0.164181 --> 0.163010).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 9 cost time: 0.9223432540893555
Epoch: 9, Steps: 64 | Train Loss: 0.1068869 Vali Loss: 0.1584638 Test Loss: 0.2181733
Validation loss decreased (0.163010 --> 0.158464).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 10 cost time: 0.9344244003295898
Epoch: 10, Steps: 64 | Train Loss: 0.1059202 Vali Loss: 0.1589247 Test Loss: 0.2189744
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 11 cost time: 0.9254324436187744
Epoch: 11, Steps: 64 | Train Loss: 0.1044225 Vali Loss: 0.1534354 Test Loss: 0.2176368
Validation loss decreased (0.158464 --> 0.153435).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 12 cost time: 0.9312400817871094
Epoch: 12, Steps: 64 | Train Loss: 0.1042001 Vali Loss: 0.1541664 Test Loss: 0.2176941
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 13 cost time: 0.9289999008178711
Epoch: 13, Steps: 64 | Train Loss: 0.1025846 Vali Loss: 0.1557422 Test Loss: 0.2179646
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 14 cost time: 0.9240000247955322
Epoch: 14, Steps: 64 | Train Loss: 0.1024855 Vali Loss: 0.1563362 Test Loss: 0.2198385
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 15 cost time: 0.9386284351348877
Epoch: 15, Steps: 64 | Train Loss: 0.1016379 Vali Loss: 0.1534695 Test Loss: 0.2198098
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 16 cost time: 0.9234218597412109
Epoch: 16, Steps: 64 | Train Loss: 0.1011303 Vali Loss: 0.1523893 Test Loss: 0.2197943
Validation loss decreased (0.153435 --> 0.152389).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 17 cost time: 0.9220051765441895
Epoch: 17, Steps: 64 | Train Loss: 0.1004407 Vali Loss: 0.1529000 Test Loss: 0.2191988
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 18 cost time: 0.9297647476196289
Epoch: 18, Steps: 64 | Train Loss: 0.1001951 Vali Loss: 0.1504292 Test Loss: 0.2184862
Validation loss decreased (0.152389 --> 0.150429).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 19 cost time: 0.931349515914917
Epoch: 19, Steps: 64 | Train Loss: 0.0998090 Vali Loss: 0.1524217 Test Loss: 0.2196082
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 20 cost time: 0.9281718730926514
Epoch: 20, Steps: 64 | Train Loss: 0.0993949 Vali Loss: 0.1510530 Test Loss: 0.2199195
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 21 cost time: 0.9269981384277344
Epoch: 21, Steps: 64 | Train Loss: 0.0988624 Vali Loss: 0.1505460 Test Loss: 0.2197025
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 22 cost time: 0.9270000457763672
Epoch: 22, Steps: 64 | Train Loss: 0.0992771 Vali Loss: 0.1511584 Test Loss: 0.2204755
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 23 cost time: 0.9226183891296387
Epoch: 23, Steps: 64 | Train Loss: 0.0982191 Vali Loss: 0.1503863 Test Loss: 0.2214671
Validation loss decreased (0.150429 --> 0.150386).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 24 cost time: 0.9238722324371338
Epoch: 24, Steps: 64 | Train Loss: 0.0983755 Vali Loss: 0.1479824 Test Loss: 0.2204332
Validation loss decreased (0.150386 --> 0.147982).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 25 cost time: 0.9273676872253418
Epoch: 25, Steps: 64 | Train Loss: 0.0987935 Vali Loss: 0.1498885 Test Loss: 0.2207669
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 26 cost time: 0.9273746013641357
Epoch: 26, Steps: 64 | Train Loss: 0.0985201 Vali Loss: 0.1508644 Test Loss: 0.2208323
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 27 cost time: 0.9273536205291748
Epoch: 27, Steps: 64 | Train Loss: 0.0975390 Vali Loss: 0.1489382 Test Loss: 0.2215067
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 28 cost time: 0.9247393608093262
Epoch: 28, Steps: 64 | Train Loss: 0.0977201 Vali Loss: 0.1482102 Test Loss: 0.2205771
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 29 cost time: 0.9129998683929443
Epoch: 29, Steps: 64 | Train Loss: 0.0976064 Vali Loss: 0.1495417 Test Loss: 0.2211618
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 30 cost time: 0.9440004825592041
Epoch: 30, Steps: 64 | Train Loss: 0.0972976 Vali Loss: 0.1491781 Test Loss: 0.2206877
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 31 cost time: 0.9226195812225342
Epoch: 31, Steps: 64 | Train Loss: 0.0974917 Vali Loss: 0.1492570 Test Loss: 0.2214657
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 32 cost time: 0.9283633232116699
Epoch: 32, Steps: 64 | Train Loss: 0.0974502 Vali Loss: 0.1475497 Test Loss: 0.2209601
Validation loss decreased (0.147982 --> 0.147550).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 33 cost time: 0.9270176887512207
Epoch: 33, Steps: 64 | Train Loss: 0.0973088 Vali Loss: 0.1506888 Test Loss: 0.2215392
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 34 cost time: 0.9233262538909912
Epoch: 34, Steps: 64 | Train Loss: 0.0969063 Vali Loss: 0.1484919 Test Loss: 0.2211894
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 35 cost time: 0.9334299564361572
Epoch: 35, Steps: 64 | Train Loss: 0.0972413 Vali Loss: 0.1498737 Test Loss: 0.2211042
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 36 cost time: 0.9312217235565186
Epoch: 36, Steps: 64 | Train Loss: 0.0975155 Vali Loss: 0.1479441 Test Loss: 0.2213263
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 37 cost time: 0.9251437187194824
Epoch: 37, Steps: 64 | Train Loss: 0.0968803 Vali Loss: 0.1494058 Test Loss: 0.2212936
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 38 cost time: 0.9330000877380371
Epoch: 38, Steps: 64 | Train Loss: 0.0969100 Vali Loss: 0.1490480 Test Loss: 0.2214944
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 39 cost time: 0.9336142539978027
Epoch: 39, Steps: 64 | Train Loss: 0.0972635 Vali Loss: 0.1462363 Test Loss: 0.2215283
Validation loss decreased (0.147550 --> 0.146236).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 40 cost time: 0.9234044551849365
Epoch: 40, Steps: 64 | Train Loss: 0.0970840 Vali Loss: 0.1485240 Test Loss: 0.2217634
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 41 cost time: 0.9223663806915283
Epoch: 41, Steps: 64 | Train Loss: 0.0969266 Vali Loss: 0.1483086 Test Loss: 0.2218706
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 42 cost time: 0.9343686103820801
Epoch: 42, Steps: 64 | Train Loss: 0.0969228 Vali Loss: 0.1478938 Test Loss: 0.2215205
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 43 cost time: 0.9273462295532227
Epoch: 43, Steps: 64 | Train Loss: 0.0969959 Vali Loss: 0.1473606 Test Loss: 0.2216550
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 44 cost time: 0.9277322292327881
Epoch: 44, Steps: 64 | Train Loss: 0.0966475 Vali Loss: 0.1478080 Test Loss: 0.2214031
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 45 cost time: 0.9288301467895508
Epoch: 45, Steps: 64 | Train Loss: 0.0970159 Vali Loss: 0.1477898 Test Loss: 0.2215589
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 46 cost time: 0.9246227741241455
Epoch: 46, Steps: 64 | Train Loss: 0.0971398 Vali Loss: 0.1479775 Test Loss: 0.2212088
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 47 cost time: 0.9236171245574951
Epoch: 47, Steps: 64 | Train Loss: 0.0972273 Vali Loss: 0.1469622 Test Loss: 0.2213580
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 48 cost time: 0.9223544597625732
Epoch: 48, Steps: 64 | Train Loss: 0.0973648 Vali Loss: 0.1495941 Test Loss: 0.2218909
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 49 cost time: 0.9194016456604004
Epoch: 49, Steps: 64 | Train Loss: 0.0970305 Vali Loss: 0.1492312 Test Loss: 0.2214966
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 50 cost time: 0.9247782230377197
Epoch: 50, Steps: 64 | Train Loss: 0.0970405 Vali Loss: 0.1482670 Test Loss: 0.2214771
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 51 cost time: 0.927375316619873
Epoch: 51, Steps: 64 | Train Loss: 0.0966374 Vali Loss: 0.1491297 Test Loss: 0.2215828
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 52 cost time: 0.9284262657165527
Epoch: 52, Steps: 64 | Train Loss: 0.0968900 Vali Loss: 0.1481615 Test Loss: 0.2217087
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 53 cost time: 0.9119999408721924
Epoch: 53, Steps: 64 | Train Loss: 0.0969979 Vali Loss: 0.1482419 Test Loss: 0.2214228
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 54 cost time: 0.9213497638702393
Epoch: 54, Steps: 64 | Train Loss: 0.0970573 Vali Loss: 0.1486950 Test Loss: 0.2215522
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 55 cost time: 0.929610013961792
Epoch: 55, Steps: 64 | Train Loss: 0.0970299 Vali Loss: 0.1486356 Test Loss: 0.2217581
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 56 cost time: 0.9393389225006104
Epoch: 56, Steps: 64 | Train Loss: 0.0971816 Vali Loss: 0.1487437 Test Loss: 0.2217123
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 57 cost time: 0.9243409633636475
Epoch: 57, Steps: 64 | Train Loss: 0.0965110 Vali Loss: 0.1492592 Test Loss: 0.2216481
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 58 cost time: 0.9233832359313965
Epoch: 58, Steps: 64 | Train Loss: 0.0970550 Vali Loss: 0.1468532 Test Loss: 0.2214187
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 59 cost time: 0.9284055233001709
Epoch: 59, Steps: 64 | Train Loss: 0.0965062 Vali Loss: 0.1482417 Test Loss: 0.2217189
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 60 cost time: 0.926750659942627
Epoch: 60, Steps: 64 | Train Loss: 0.0967125 Vali Loss: 0.1487138 Test Loss: 0.2216508
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22152827680110931, mae:0.3280440866947174, rse:0.2385331392288208
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.058283329010009766 GB
Epoch: 1 cost time: 2.210550546646118
Epoch: 1, Steps: 64 | Train Loss: 0.9194342 Vali Loss: 2.3506901 Test Loss: 3.7283368
Validation loss decreased (inf --> 2.350690).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 2 cost time: 0.8652594089508057
Epoch: 2, Steps: 64 | Train Loss: 0.6912259 Vali Loss: 1.2105428 Test Loss: 1.8567827
Validation loss decreased (2.350690 --> 1.210543).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 3 cost time: 0.8689322471618652
Epoch: 3, Steps: 64 | Train Loss: 0.4156066 Vali Loss: 0.6832162 Test Loss: 1.0033610
Validation loss decreased (1.210543 --> 0.683216).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 4 cost time: 0.8673293590545654
Epoch: 4, Steps: 64 | Train Loss: 0.2654735 Vali Loss: 0.4094265 Test Loss: 0.5830448
Validation loss decreased (0.683216 --> 0.409427).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 5 cost time: 0.8704161643981934
Epoch: 5, Steps: 64 | Train Loss: 0.1909663 Vali Loss: 0.2906487 Test Loss: 0.3868096
Validation loss decreased (0.409427 --> 0.290649).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 6 cost time: 0.8667747974395752
Epoch: 6, Steps: 64 | Train Loss: 0.1587953 Vali Loss: 0.2383392 Test Loss: 0.3126938
Validation loss decreased (0.290649 --> 0.238339).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 7 cost time: 0.862999677658081
Epoch: 7, Steps: 64 | Train Loss: 0.1428621 Vali Loss: 0.2116486 Test Loss: 0.2716949
Validation loss decreased (0.238339 --> 0.211649).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 8 cost time: 0.8660111427307129
Epoch: 8, Steps: 64 | Train Loss: 0.1345988 Vali Loss: 0.1976307 Test Loss: 0.2509981
Validation loss decreased (0.211649 --> 0.197631).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 9 cost time: 0.8674213886260986
Epoch: 9, Steps: 64 | Train Loss: 0.1298197 Vali Loss: 0.1866808 Test Loss: 0.2409403
Validation loss decreased (0.197631 --> 0.186681).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 10 cost time: 0.8743927478790283
Epoch: 10, Steps: 64 | Train Loss: 0.1269462 Vali Loss: 0.1825839 Test Loss: 0.2358933
Validation loss decreased (0.186681 --> 0.182584).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 11 cost time: 0.8583996295928955
Epoch: 11, Steps: 64 | Train Loss: 0.1236529 Vali Loss: 0.1778676 Test Loss: 0.2311449
Validation loss decreased (0.182584 --> 0.177868).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 12 cost time: 0.8660242557525635
Epoch: 12, Steps: 64 | Train Loss: 0.1222580 Vali Loss: 0.1745608 Test Loss: 0.2285566
Validation loss decreased (0.177868 --> 0.174561).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 13 cost time: 0.8700010776519775
Epoch: 13, Steps: 64 | Train Loss: 0.1211143 Vali Loss: 0.1737766 Test Loss: 0.2286426
Validation loss decreased (0.174561 --> 0.173777).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 14 cost time: 0.8796372413635254
Epoch: 14, Steps: 64 | Train Loss: 0.1192895 Vali Loss: 0.1697265 Test Loss: 0.2267650
Validation loss decreased (0.173777 --> 0.169726).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 15 cost time: 0.8674259185791016
Epoch: 15, Steps: 64 | Train Loss: 0.1186562 Vali Loss: 0.1691352 Test Loss: 0.2250998
Validation loss decreased (0.169726 --> 0.169135).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 16 cost time: 0.8633508682250977
Epoch: 16, Steps: 64 | Train Loss: 0.1170061 Vali Loss: 0.1700277 Test Loss: 0.2262248
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 17 cost time: 0.8661510944366455
Epoch: 17, Steps: 64 | Train Loss: 0.1166764 Vali Loss: 0.1676193 Test Loss: 0.2243862
Validation loss decreased (0.169135 --> 0.167619).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 18 cost time: 0.8670003414154053
Epoch: 18, Steps: 64 | Train Loss: 0.1164455 Vali Loss: 0.1662572 Test Loss: 0.2238521
Validation loss decreased (0.167619 --> 0.166257).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 19 cost time: 0.8666291236877441
Epoch: 19, Steps: 64 | Train Loss: 0.1151423 Vali Loss: 0.1668067 Test Loss: 0.2242856
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 20 cost time: 0.8724360466003418
Epoch: 20, Steps: 64 | Train Loss: 0.1149353 Vali Loss: 0.1670359 Test Loss: 0.2234864
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 21 cost time: 0.8771793842315674
Epoch: 21, Steps: 64 | Train Loss: 0.1140096 Vali Loss: 0.1652502 Test Loss: 0.2238005
Validation loss decreased (0.166257 --> 0.165250).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 22 cost time: 0.8673958778381348
Epoch: 22, Steps: 64 | Train Loss: 0.1131856 Vali Loss: 0.1644433 Test Loss: 0.2243884
Validation loss decreased (0.165250 --> 0.164443).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 23 cost time: 0.8697242736816406
Epoch: 23, Steps: 64 | Train Loss: 0.1127561 Vali Loss: 0.1635916 Test Loss: 0.2230317
Validation loss decreased (0.164443 --> 0.163592).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 24 cost time: 0.8620007038116455
Epoch: 24, Steps: 64 | Train Loss: 0.1132744 Vali Loss: 0.1638089 Test Loss: 0.2226116
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 25 cost time: 0.874617338180542
Epoch: 25, Steps: 64 | Train Loss: 0.1129268 Vali Loss: 0.1630687 Test Loss: 0.2231486
Validation loss decreased (0.163592 --> 0.163069).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 26 cost time: 0.8602352142333984
Epoch: 26, Steps: 64 | Train Loss: 0.1120571 Vali Loss: 0.1620993 Test Loss: 0.2223520
Validation loss decreased (0.163069 --> 0.162099).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 27 cost time: 0.8634397983551025
Epoch: 27, Steps: 64 | Train Loss: 0.1118474 Vali Loss: 0.1623262 Test Loss: 0.2234891
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 28 cost time: 0.8703982830047607
Epoch: 28, Steps: 64 | Train Loss: 0.1116721 Vali Loss: 0.1609079 Test Loss: 0.2218407
Validation loss decreased (0.162099 --> 0.160908).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 29 cost time: 0.8697571754455566
Epoch: 29, Steps: 64 | Train Loss: 0.1109732 Vali Loss: 0.1608339 Test Loss: 0.2226614
Validation loss decreased (0.160908 --> 0.160834).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 30 cost time: 0.8673720359802246
Epoch: 30, Steps: 64 | Train Loss: 0.1111041 Vali Loss: 0.1605148 Test Loss: 0.2232447
Validation loss decreased (0.160834 --> 0.160515).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 31 cost time: 0.8626387119293213
Epoch: 31, Steps: 64 | Train Loss: 0.1116485 Vali Loss: 0.1615991 Test Loss: 0.2224360
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 32 cost time: 0.8684113025665283
Epoch: 32, Steps: 64 | Train Loss: 0.1109506 Vali Loss: 0.1609193 Test Loss: 0.2224836
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 33 cost time: 0.8613536357879639
Epoch: 33, Steps: 64 | Train Loss: 0.1113713 Vali Loss: 0.1605756 Test Loss: 0.2226933
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 34 cost time: 0.8637630939483643
Epoch: 34, Steps: 64 | Train Loss: 0.1112710 Vali Loss: 0.1596789 Test Loss: 0.2221304
Validation loss decreased (0.160515 --> 0.159679).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 35 cost time: 0.8694174289703369
Epoch: 35, Steps: 64 | Train Loss: 0.1111173 Vali Loss: 0.1598585 Test Loss: 0.2222619
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 36 cost time: 0.8706107139587402
Epoch: 36, Steps: 64 | Train Loss: 0.1106884 Vali Loss: 0.1611481 Test Loss: 0.2219117
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 37 cost time: 0.8633737564086914
Epoch: 37, Steps: 64 | Train Loss: 0.1100852 Vali Loss: 0.1605422 Test Loss: 0.2217149
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 38 cost time: 0.8703701496124268
Epoch: 38, Steps: 64 | Train Loss: 0.1106806 Vali Loss: 0.1601230 Test Loss: 0.2227794
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 39 cost time: 0.8733329772949219
Epoch: 39, Steps: 64 | Train Loss: 0.1100677 Vali Loss: 0.1600695 Test Loss: 0.2227175
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 40 cost time: 0.8680558204650879
Epoch: 40, Steps: 64 | Train Loss: 0.1105636 Vali Loss: 0.1604433 Test Loss: 0.2221084
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 41 cost time: 0.8709995746612549
Epoch: 41, Steps: 64 | Train Loss: 0.1102110 Vali Loss: 0.1597649 Test Loss: 0.2222961
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 42 cost time: 0.8606293201446533
Epoch: 42, Steps: 64 | Train Loss: 0.1098820 Vali Loss: 0.1599816 Test Loss: 0.2228448
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 43 cost time: 0.8743934631347656
Epoch: 43, Steps: 64 | Train Loss: 0.1102245 Vali Loss: 0.1611020 Test Loss: 0.2223646
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 44 cost time: 0.8618383407592773
Epoch: 44, Steps: 64 | Train Loss: 0.1099650 Vali Loss: 0.1602411 Test Loss: 0.2226344
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 45 cost time: 0.8637580871582031
Epoch: 45, Steps: 64 | Train Loss: 0.1098479 Vali Loss: 0.1599902 Test Loss: 0.2227159
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 46 cost time: 0.8650002479553223
Epoch: 46, Steps: 64 | Train Loss: 0.1096927 Vali Loss: 0.1581690 Test Loss: 0.2220496
Validation loss decreased (0.159679 --> 0.158169).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 47 cost time: 0.8636150360107422
Epoch: 47, Steps: 64 | Train Loss: 0.1100674 Vali Loss: 0.1608316 Test Loss: 0.2225444
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 48 cost time: 0.9339475631713867
Epoch: 48, Steps: 64 | Train Loss: 0.1094656 Vali Loss: 0.1596086 Test Loss: 0.2223841
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 49 cost time: 0.8654305934906006
Epoch: 49, Steps: 64 | Train Loss: 0.1102793 Vali Loss: 0.1583007 Test Loss: 0.2226600
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 50 cost time: 0.8693656921386719
Epoch: 50, Steps: 64 | Train Loss: 0.1103158 Vali Loss: 0.1583907 Test Loss: 0.2221088
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 51 cost time: 0.8577783107757568
Epoch: 51, Steps: 64 | Train Loss: 0.1101456 Vali Loss: 0.1601141 Test Loss: 0.2220468
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 52 cost time: 0.8630001544952393
Epoch: 52, Steps: 64 | Train Loss: 0.1096786 Vali Loss: 0.1600299 Test Loss: 0.2229298
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 53 cost time: 0.8636164665222168
Epoch: 53, Steps: 64 | Train Loss: 0.1094653 Vali Loss: 0.1599168 Test Loss: 0.2223976
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 54 cost time: 0.858346700668335
Epoch: 54, Steps: 64 | Train Loss: 0.1099639 Vali Loss: 0.1594413 Test Loss: 0.2224979
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 55 cost time: 0.8693609237670898
Epoch: 55, Steps: 64 | Train Loss: 0.1098864 Vali Loss: 0.1596362 Test Loss: 0.2221930
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 56 cost time: 0.8683645725250244
Epoch: 56, Steps: 64 | Train Loss: 0.1096683 Vali Loss: 0.1597701 Test Loss: 0.2232416
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 57 cost time: 0.8683507442474365
Epoch: 57, Steps: 64 | Train Loss: 0.1094482 Vali Loss: 0.1590535 Test Loss: 0.2225921
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 58 cost time: 0.8706085681915283
Epoch: 58, Steps: 64 | Train Loss: 0.1099549 Vali Loss: 0.1597096 Test Loss: 0.2223483
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 59 cost time: 0.8663325309753418
Epoch: 59, Steps: 64 | Train Loss: 0.1099211 Vali Loss: 0.1591665 Test Loss: 0.2220045
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 60 cost time: 0.8644158840179443
Epoch: 60, Steps: 64 | Train Loss: 0.1098026 Vali Loss: 0.1587343 Test Loss: 0.2220782
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22204960882663727, mae:0.329501211643219, rse:0.23881365358829498
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06267786026000977 GB
Epoch: 1 cost time: 2.296846866607666
Epoch: 1, Steps: 64 | Train Loss: 0.8737996 Vali Loss: 2.2803161 Test Loss: 3.6542823
Validation loss decreased (inf --> 2.280316).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 2 cost time: 0.9171285629272461
Epoch: 2, Steps: 64 | Train Loss: 0.3788957 Vali Loss: 0.2084765 Test Loss: 0.2442018
Validation loss decreased (2.280316 --> 0.208476).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 3 cost time: 0.9090001583099365
Epoch: 3, Steps: 64 | Train Loss: 0.1338351 Vali Loss: 0.1840774 Test Loss: 0.2318775
Validation loss decreased (0.208476 --> 0.184077).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 4 cost time: 0.9110000133514404
Epoch: 4, Steps: 64 | Train Loss: 0.1222388 Vali Loss: 0.1705987 Test Loss: 0.2171350
Validation loss decreased (0.184077 --> 0.170599).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 5 cost time: 0.9206328392028809
Epoch: 5, Steps: 64 | Train Loss: 0.1166420 Vali Loss: 0.1679162 Test Loss: 0.2169314
Validation loss decreased (0.170599 --> 0.167916).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 6 cost time: 0.9103527069091797
Epoch: 6, Steps: 64 | Train Loss: 0.1137372 Vali Loss: 0.1629192 Test Loss: 0.2176427
Validation loss decreased (0.167916 --> 0.162919).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 7 cost time: 0.9069781303405762
Epoch: 7, Steps: 64 | Train Loss: 0.1113297 Vali Loss: 0.1587030 Test Loss: 0.2175268
Validation loss decreased (0.162919 --> 0.158703).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 8 cost time: 0.9054296016693115
Epoch: 8, Steps: 64 | Train Loss: 0.1086183 Vali Loss: 0.1578161 Test Loss: 0.2195325
Validation loss decreased (0.158703 --> 0.157816).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 9 cost time: 0.9003543853759766
Epoch: 9, Steps: 64 | Train Loss: 0.1080695 Vali Loss: 0.1590911 Test Loss: 0.2195245
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 10 cost time: 0.9138655662536621
Epoch: 10, Steps: 64 | Train Loss: 0.1061942 Vali Loss: 0.1568433 Test Loss: 0.2201834
Validation loss decreased (0.157816 --> 0.156843).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 11 cost time: 0.9103362560272217
Epoch: 11, Steps: 64 | Train Loss: 0.1051105 Vali Loss: 0.1528678 Test Loss: 0.2204199
Validation loss decreased (0.156843 --> 0.152868).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 12 cost time: 0.9109997749328613
Epoch: 12, Steps: 64 | Train Loss: 0.1036500 Vali Loss: 0.1547511 Test Loss: 0.2219104
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 13 cost time: 0.9156303405761719
Epoch: 13, Steps: 64 | Train Loss: 0.1028813 Vali Loss: 0.1553087 Test Loss: 0.2221971
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 14 cost time: 0.9043698310852051
Epoch: 14, Steps: 64 | Train Loss: 0.1022476 Vali Loss: 0.1529286 Test Loss: 0.2240050
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 15 cost time: 0.9144515991210938
Epoch: 15, Steps: 64 | Train Loss: 0.1017788 Vali Loss: 0.1542847 Test Loss: 0.2235183
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 16 cost time: 0.9073736667633057
Epoch: 16, Steps: 64 | Train Loss: 0.1011442 Vali Loss: 0.1519117 Test Loss: 0.2230654
Validation loss decreased (0.152868 --> 0.151912).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 17 cost time: 0.905747652053833
Epoch: 17, Steps: 64 | Train Loss: 0.1004498 Vali Loss: 0.1512729 Test Loss: 0.2235942
Validation loss decreased (0.151912 --> 0.151273).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 18 cost time: 0.9110002517700195
Epoch: 18, Steps: 64 | Train Loss: 0.1002299 Vali Loss: 0.1537596 Test Loss: 0.2244466
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 19 cost time: 0.9157814979553223
Epoch: 19, Steps: 64 | Train Loss: 0.1002041 Vali Loss: 0.1500371 Test Loss: 0.2234642
Validation loss decreased (0.151273 --> 0.150037).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 20 cost time: 0.940617561340332
Epoch: 20, Steps: 64 | Train Loss: 0.0997258 Vali Loss: 0.1528854 Test Loss: 0.2243466
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 21 cost time: 0.9113526344299316
Epoch: 21, Steps: 64 | Train Loss: 0.0992522 Vali Loss: 0.1515399 Test Loss: 0.2251231
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 22 cost time: 0.9305899143218994
Epoch: 22, Steps: 64 | Train Loss: 0.0993501 Vali Loss: 0.1516275 Test Loss: 0.2245856
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 23 cost time: 0.924370527267456
Epoch: 23, Steps: 64 | Train Loss: 0.0991384 Vali Loss: 0.1500997 Test Loss: 0.2240070
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 24 cost time: 0.9254250526428223
Epoch: 24, Steps: 64 | Train Loss: 0.0988419 Vali Loss: 0.1516572 Test Loss: 0.2237882
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 25 cost time: 0.9337196350097656
Epoch: 25, Steps: 64 | Train Loss: 0.0983525 Vali Loss: 0.1518213 Test Loss: 0.2237431
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 26 cost time: 0.9069986343383789
Epoch: 26, Steps: 64 | Train Loss: 0.0984343 Vali Loss: 0.1517305 Test Loss: 0.2243092
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 27 cost time: 0.9320001602172852
Epoch: 27, Steps: 64 | Train Loss: 0.0983719 Vali Loss: 0.1517864 Test Loss: 0.2240309
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 28 cost time: 0.927605152130127
Epoch: 28, Steps: 64 | Train Loss: 0.0980003 Vali Loss: 0.1487608 Test Loss: 0.2238209
Validation loss decreased (0.150037 --> 0.148761).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 29 cost time: 0.9153473377227783
Epoch: 29, Steps: 64 | Train Loss: 0.0985060 Vali Loss: 0.1500514 Test Loss: 0.2243356
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 30 cost time: 0.9273490905761719
Epoch: 30, Steps: 64 | Train Loss: 0.0979415 Vali Loss: 0.1505130 Test Loss: 0.2247954
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 31 cost time: 0.9273784160614014
Epoch: 31, Steps: 64 | Train Loss: 0.0979109 Vali Loss: 0.1501114 Test Loss: 0.2242619
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 32 cost time: 0.9239974021911621
Epoch: 32, Steps: 64 | Train Loss: 0.0978697 Vali Loss: 0.1500650 Test Loss: 0.2239412
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 33 cost time: 0.9267776012420654
Epoch: 33, Steps: 64 | Train Loss: 0.0979292 Vali Loss: 0.1497782 Test Loss: 0.2236459
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 34 cost time: 0.937999963760376
Epoch: 34, Steps: 64 | Train Loss: 0.0979055 Vali Loss: 0.1503164 Test Loss: 0.2241438
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 35 cost time: 0.9290001392364502
Epoch: 35, Steps: 64 | Train Loss: 0.0979066 Vali Loss: 0.1510052 Test Loss: 0.2239083
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 36 cost time: 0.929959774017334
Epoch: 36, Steps: 64 | Train Loss: 0.0975466 Vali Loss: 0.1485181 Test Loss: 0.2236039
Validation loss decreased (0.148761 --> 0.148518).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 37 cost time: 0.9264450073242188
Epoch: 37, Steps: 64 | Train Loss: 0.0975077 Vali Loss: 0.1505323 Test Loss: 0.2243421
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 38 cost time: 0.9383640289306641
Epoch: 38, Steps: 64 | Train Loss: 0.0973738 Vali Loss: 0.1506919 Test Loss: 0.2241608
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 39 cost time: 0.9329187870025635
Epoch: 39, Steps: 64 | Train Loss: 0.0974976 Vali Loss: 0.1506245 Test Loss: 0.2236556
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 40 cost time: 0.9106693267822266
Epoch: 40, Steps: 64 | Train Loss: 0.0972596 Vali Loss: 0.1504991 Test Loss: 0.2239452
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 41 cost time: 0.9097716808319092
Epoch: 41, Steps: 64 | Train Loss: 0.0973975 Vali Loss: 0.1513514 Test Loss: 0.2238698
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 42 cost time: 0.9090001583099365
Epoch: 42, Steps: 64 | Train Loss: 0.0976359 Vali Loss: 0.1514789 Test Loss: 0.2248721
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 43 cost time: 0.9130001068115234
Epoch: 43, Steps: 64 | Train Loss: 0.0967093 Vali Loss: 0.1487781 Test Loss: 0.2236311
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 44 cost time: 0.9126062393188477
Epoch: 44, Steps: 64 | Train Loss: 0.0975022 Vali Loss: 0.1502545 Test Loss: 0.2241267
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 45 cost time: 0.9172344207763672
Epoch: 45, Steps: 64 | Train Loss: 0.0972026 Vali Loss: 0.1507273 Test Loss: 0.2244437
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 46 cost time: 0.916379451751709
Epoch: 46, Steps: 64 | Train Loss: 0.0977603 Vali Loss: 0.1502556 Test Loss: 0.2236361
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 47 cost time: 0.8896727561950684
Epoch: 47, Steps: 64 | Train Loss: 0.0970205 Vali Loss: 0.1507190 Test Loss: 0.2242962
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 48 cost time: 0.9034342765808105
Epoch: 48, Steps: 64 | Train Loss: 0.0975082 Vali Loss: 0.1493034 Test Loss: 0.2243773
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 49 cost time: 0.9162235260009766
Epoch: 49, Steps: 64 | Train Loss: 0.0971634 Vali Loss: 0.1502719 Test Loss: 0.2238596
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 50 cost time: 0.8797726631164551
Epoch: 50, Steps: 64 | Train Loss: 0.0975196 Vali Loss: 0.1489344 Test Loss: 0.2241315
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 51 cost time: 0.9186081886291504
Epoch: 51, Steps: 64 | Train Loss: 0.0973360 Vali Loss: 0.1499656 Test Loss: 0.2242613
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 52 cost time: 0.9115140438079834
Epoch: 52, Steps: 64 | Train Loss: 0.0968609 Vali Loss: 0.1504423 Test Loss: 0.2244835
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 53 cost time: 0.9737484455108643
Epoch: 53, Steps: 64 | Train Loss: 0.0972073 Vali Loss: 0.1498156 Test Loss: 0.2242699
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 54 cost time: 0.9209558963775635
Epoch: 54, Steps: 64 | Train Loss: 0.0973093 Vali Loss: 0.1508243 Test Loss: 0.2242725
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 55 cost time: 0.9355661869049072
Epoch: 55, Steps: 64 | Train Loss: 0.0972235 Vali Loss: 0.1503764 Test Loss: 0.2245174
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 56 cost time: 0.9358360767364502
Epoch: 56, Steps: 64 | Train Loss: 0.0972750 Vali Loss: 0.1498276 Test Loss: 0.2244383
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 57 cost time: 0.9330203533172607
Epoch: 57, Steps: 64 | Train Loss: 0.0969693 Vali Loss: 0.1507242 Test Loss: 0.2240502
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 58 cost time: 0.9366097450256348
Epoch: 58, Steps: 64 | Train Loss: 0.0972085 Vali Loss: 0.1500519 Test Loss: 0.2236152
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 59 cost time: 0.9139986038208008
Epoch: 59, Steps: 64 | Train Loss: 0.0971940 Vali Loss: 0.1516135 Test Loss: 0.2241598
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 60 cost time: 0.9289975166320801
Epoch: 60, Steps: 64 | Train Loss: 0.0972789 Vali Loss: 0.1496975 Test Loss: 0.2241385
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22360388934612274, mae:0.3335070013999939, rse:0.2396479994058609
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06597661972045898 GB
Epoch: 1 cost time: 2.311824083328247
Epoch: 1, Steps: 64 | Train Loss: 0.8668592 Vali Loss: 2.3116627 Test Loss: 3.6797481
Validation loss decreased (inf --> 2.311663).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 2 cost time: 0.9683382511138916
Epoch: 2, Steps: 64 | Train Loss: 0.3693299 Vali Loss: 0.2888921 Test Loss: 0.3750988
Validation loss decreased (2.311663 --> 0.288892).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 3 cost time: 0.9666213989257812
Epoch: 3, Steps: 64 | Train Loss: 0.1341620 Vali Loss: 0.1789684 Test Loss: 0.2239409
Validation loss decreased (0.288892 --> 0.178968).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 4 cost time: 0.9374842643737793
Epoch: 4, Steps: 64 | Train Loss: 0.1193344 Vali Loss: 0.1690934 Test Loss: 0.2214048
Validation loss decreased (0.178968 --> 0.169093).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 5 cost time: 0.9433693885803223
Epoch: 5, Steps: 64 | Train Loss: 0.1145875 Vali Loss: 0.1648738 Test Loss: 0.2181586
Validation loss decreased (0.169093 --> 0.164874).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 6 cost time: 0.947868824005127
Epoch: 6, Steps: 64 | Train Loss: 0.1120639 Vali Loss: 0.1648649 Test Loss: 0.2185074
Validation loss decreased (0.164874 --> 0.164865).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 7 cost time: 0.9182455539703369
Epoch: 7, Steps: 64 | Train Loss: 0.1102180 Vali Loss: 0.1587464 Test Loss: 0.2179912
Validation loss decreased (0.164865 --> 0.158746).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 8 cost time: 0.92799973487854
Epoch: 8, Steps: 64 | Train Loss: 0.1079968 Vali Loss: 0.1613071 Test Loss: 0.2186241
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 9 cost time: 0.936612606048584
Epoch: 9, Steps: 64 | Train Loss: 0.1063987 Vali Loss: 0.1583533 Test Loss: 0.2189517
Validation loss decreased (0.158746 --> 0.158353).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 10 cost time: 0.9362821578979492
Epoch: 10, Steps: 64 | Train Loss: 0.1053638 Vali Loss: 0.1574286 Test Loss: 0.2197197
Validation loss decreased (0.158353 --> 0.157429).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 11 cost time: 0.9460668563842773
Epoch: 11, Steps: 64 | Train Loss: 0.1035989 Vali Loss: 0.1567432 Test Loss: 0.2215125
Validation loss decreased (0.157429 --> 0.156743).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 12 cost time: 0.9584412574768066
Epoch: 12, Steps: 64 | Train Loss: 0.1026593 Vali Loss: 0.1560153 Test Loss: 0.2208939
Validation loss decreased (0.156743 --> 0.156015).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 13 cost time: 0.9584078788757324
Epoch: 13, Steps: 64 | Train Loss: 0.1014865 Vali Loss: 0.1580618 Test Loss: 0.2221916
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 14 cost time: 0.949329137802124
Epoch: 14, Steps: 64 | Train Loss: 0.1011613 Vali Loss: 0.1568948 Test Loss: 0.2203671
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 15 cost time: 0.9497778415679932
Epoch: 15, Steps: 64 | Train Loss: 0.1009814 Vali Loss: 0.1539168 Test Loss: 0.2220540
Validation loss decreased (0.156015 --> 0.153917).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 16 cost time: 0.9601244926452637
Epoch: 16, Steps: 64 | Train Loss: 0.1003476 Vali Loss: 0.1545584 Test Loss: 0.2204936
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 17 cost time: 0.9547288417816162
Epoch: 17, Steps: 64 | Train Loss: 0.0992390 Vali Loss: 0.1541987 Test Loss: 0.2213026
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 18 cost time: 0.9619998931884766
Epoch: 18, Steps: 64 | Train Loss: 0.0994297 Vali Loss: 0.1530360 Test Loss: 0.2218954
Validation loss decreased (0.153917 --> 0.153036).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 19 cost time: 0.9592068195343018
Epoch: 19, Steps: 64 | Train Loss: 0.0988764 Vali Loss: 0.1539939 Test Loss: 0.2205677
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 20 cost time: 0.9567570686340332
Epoch: 20, Steps: 64 | Train Loss: 0.0985516 Vali Loss: 0.1545630 Test Loss: 0.2222914
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 21 cost time: 0.9506146907806396
Epoch: 21, Steps: 64 | Train Loss: 0.0984985 Vali Loss: 0.1548666 Test Loss: 0.2227240
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 22 cost time: 0.9563090801239014
Epoch: 22, Steps: 64 | Train Loss: 0.0982600 Vali Loss: 0.1538917 Test Loss: 0.2211438
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 23 cost time: 0.9363217353820801
Epoch: 23, Steps: 64 | Train Loss: 0.0979026 Vali Loss: 0.1530784 Test Loss: 0.2224054
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 24 cost time: 0.926361083984375
Epoch: 24, Steps: 64 | Train Loss: 0.0976543 Vali Loss: 0.1526233 Test Loss: 0.2220653
Validation loss decreased (0.153036 --> 0.152623).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 25 cost time: 0.9254553318023682
Epoch: 25, Steps: 64 | Train Loss: 0.0979522 Vali Loss: 0.1526372 Test Loss: 0.2220036
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 26 cost time: 0.9577264785766602
Epoch: 26, Steps: 64 | Train Loss: 0.0979444 Vali Loss: 0.1514391 Test Loss: 0.2215244
Validation loss decreased (0.152623 --> 0.151439).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 27 cost time: 0.9623198509216309
Epoch: 27, Steps: 64 | Train Loss: 0.0974271 Vali Loss: 0.1524121 Test Loss: 0.2214411
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 28 cost time: 0.9139881134033203
Epoch: 28, Steps: 64 | Train Loss: 0.0974694 Vali Loss: 0.1523061 Test Loss: 0.2216318
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 29 cost time: 0.9565997123718262
Epoch: 29, Steps: 64 | Train Loss: 0.0973537 Vali Loss: 0.1513276 Test Loss: 0.2213685
Validation loss decreased (0.151439 --> 0.151328).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 30 cost time: 0.9383108615875244
Epoch: 30, Steps: 64 | Train Loss: 0.0971464 Vali Loss: 0.1504403 Test Loss: 0.2216599
Validation loss decreased (0.151328 --> 0.150440).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 31 cost time: 0.9463686943054199
Epoch: 31, Steps: 64 | Train Loss: 0.0971572 Vali Loss: 0.1520238 Test Loss: 0.2216063
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 32 cost time: 0.942990779876709
Epoch: 32, Steps: 64 | Train Loss: 0.0968098 Vali Loss: 0.1509350 Test Loss: 0.2222135
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 33 cost time: 0.9673597812652588
Epoch: 33, Steps: 64 | Train Loss: 0.0972602 Vali Loss: 0.1523604 Test Loss: 0.2219290
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 34 cost time: 0.960317850112915
Epoch: 34, Steps: 64 | Train Loss: 0.0966569 Vali Loss: 0.1512239 Test Loss: 0.2220346
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 35 cost time: 0.9543514251708984
Epoch: 35, Steps: 64 | Train Loss: 0.0967320 Vali Loss: 0.1510045 Test Loss: 0.2217875
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 36 cost time: 0.9730401039123535
Epoch: 36, Steps: 64 | Train Loss: 0.0964229 Vali Loss: 0.1510364 Test Loss: 0.2219847
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 37 cost time: 0.9578430652618408
Epoch: 37, Steps: 64 | Train Loss: 0.0964910 Vali Loss: 0.1512442 Test Loss: 0.2217618
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 38 cost time: 0.9565238952636719
Epoch: 38, Steps: 64 | Train Loss: 0.0967661 Vali Loss: 0.1515360 Test Loss: 0.2219613
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 39 cost time: 0.9571952819824219
Epoch: 39, Steps: 64 | Train Loss: 0.0967113 Vali Loss: 0.1521882 Test Loss: 0.2214921
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 40 cost time: 0.9492273330688477
Epoch: 40, Steps: 64 | Train Loss: 0.0970141 Vali Loss: 0.1511577 Test Loss: 0.2218084
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 41 cost time: 0.9493744373321533
Epoch: 41, Steps: 64 | Train Loss: 0.0962763 Vali Loss: 0.1508139 Test Loss: 0.2218030
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 42 cost time: 0.956566333770752
Epoch: 42, Steps: 64 | Train Loss: 0.0969861 Vali Loss: 0.1509557 Test Loss: 0.2224831
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 43 cost time: 0.9433150291442871
Epoch: 43, Steps: 64 | Train Loss: 0.0961322 Vali Loss: 0.1512570 Test Loss: 0.2214749
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 44 cost time: 0.9809308052062988
Epoch: 44, Steps: 64 | Train Loss: 0.0966435 Vali Loss: 0.1507685 Test Loss: 0.2217159
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 45 cost time: 0.9553799629211426
Epoch: 45, Steps: 64 | Train Loss: 0.0970165 Vali Loss: 0.1505331 Test Loss: 0.2219276
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 46 cost time: 0.9453322887420654
Epoch: 46, Steps: 64 | Train Loss: 0.0967004 Vali Loss: 0.1518527 Test Loss: 0.2216955
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 47 cost time: 0.9467289447784424
Epoch: 47, Steps: 64 | Train Loss: 0.0964645 Vali Loss: 0.1509230 Test Loss: 0.2217264
EarlyStopping counter: 17 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 48 cost time: 0.9374268054962158
Epoch: 48, Steps: 64 | Train Loss: 0.0963586 Vali Loss: 0.1500705 Test Loss: 0.2218685
Validation loss decreased (0.150440 --> 0.150070).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 49 cost time: 0.9306035041809082
Epoch: 49, Steps: 64 | Train Loss: 0.0965637 Vali Loss: 0.1512140 Test Loss: 0.2220789
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 50 cost time: 0.940617561340332
Epoch: 50, Steps: 64 | Train Loss: 0.0964978 Vali Loss: 0.1502172 Test Loss: 0.2217752
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 51 cost time: 0.9563639163970947
Epoch: 51, Steps: 64 | Train Loss: 0.0970538 Vali Loss: 0.1495481 Test Loss: 0.2216719
Validation loss decreased (0.150070 --> 0.149548).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 52 cost time: 0.952988862991333
Epoch: 52, Steps: 64 | Train Loss: 0.0966005 Vali Loss: 0.1502824 Test Loss: 0.2215848
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 53 cost time: 0.9663386344909668
Epoch: 53, Steps: 64 | Train Loss: 0.0964131 Vali Loss: 0.1513084 Test Loss: 0.2219786
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 54 cost time: 0.9475643634796143
Epoch: 54, Steps: 64 | Train Loss: 0.0962949 Vali Loss: 0.1521938 Test Loss: 0.2217946
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 55 cost time: 0.9393494129180908
Epoch: 55, Steps: 64 | Train Loss: 0.0963571 Vali Loss: 0.1514776 Test Loss: 0.2218718
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 56 cost time: 0.950803279876709
Epoch: 56, Steps: 64 | Train Loss: 0.0963605 Vali Loss: 0.1509044 Test Loss: 0.2219568
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 57 cost time: 0.9417481422424316
Epoch: 57, Steps: 64 | Train Loss: 0.0966231 Vali Loss: 0.1493084 Test Loss: 0.2214993
Validation loss decreased (0.149548 --> 0.149308).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 58 cost time: 0.9409999847412109
Epoch: 58, Steps: 64 | Train Loss: 0.0963796 Vali Loss: 0.1508121 Test Loss: 0.2218076
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 59 cost time: 0.9448525905609131
Epoch: 59, Steps: 64 | Train Loss: 0.0960862 Vali Loss: 0.1500059 Test Loss: 0.2218283
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 60 cost time: 0.9454262256622314
Epoch: 60, Steps: 64 | Train Loss: 0.0959771 Vali Loss: 0.1515659 Test Loss: 0.2221048
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22149930894374847, mae:0.3308713436126709, rse:0.23851753771305084
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058444976806640625 GB
Epoch: 1 cost time: 2.2662265300750732
Epoch: 1, Steps: 64 | Train Loss: 1.0370820 Vali Loss: 2.7002025 Test Loss: 4.3066888
Validation loss decreased (inf --> 2.700202).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 2 cost time: 0.8704814910888672
Epoch: 2, Steps: 64 | Train Loss: 0.7734790 Vali Loss: 1.2220308 Test Loss: 1.8611960
Validation loss decreased (2.700202 --> 1.222031).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 3 cost time: 0.886333703994751
Epoch: 3, Steps: 64 | Train Loss: 0.4197837 Vali Loss: 0.6855086 Test Loss: 0.9772822
Validation loss decreased (1.222031 --> 0.685509).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 4 cost time: 0.8708114624023438
Epoch: 4, Steps: 64 | Train Loss: 0.2661079 Vali Loss: 0.4358977 Test Loss: 0.6019905
Validation loss decreased (0.685509 --> 0.435898).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 5 cost time: 0.8704466819763184
Epoch: 5, Steps: 64 | Train Loss: 0.1937775 Vali Loss: 0.3066463 Test Loss: 0.4106527
Validation loss decreased (0.435898 --> 0.306646).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 6 cost time: 0.8696098327636719
Epoch: 6, Steps: 64 | Train Loss: 0.1604748 Vali Loss: 0.2432500 Test Loss: 0.3174841
Validation loss decreased (0.306646 --> 0.243250).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 7 cost time: 0.8703413009643555
Epoch: 7, Steps: 64 | Train Loss: 0.1441131 Vali Loss: 0.2144168 Test Loss: 0.2769371
Validation loss decreased (0.243250 --> 0.214417).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 8 cost time: 0.8694784641265869
Epoch: 8, Steps: 64 | Train Loss: 0.1354213 Vali Loss: 0.1957368 Test Loss: 0.2514627
Validation loss decreased (0.214417 --> 0.195737).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 9 cost time: 0.8703527450561523
Epoch: 9, Steps: 64 | Train Loss: 0.1295066 Vali Loss: 0.1844920 Test Loss: 0.2406465
Validation loss decreased (0.195737 --> 0.184492).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 10 cost time: 0.8770802021026611
Epoch: 10, Steps: 64 | Train Loss: 0.1258593 Vali Loss: 0.1805420 Test Loss: 0.2341993
Validation loss decreased (0.184492 --> 0.180542).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 11 cost time: 0.8750028610229492
Epoch: 11, Steps: 64 | Train Loss: 0.1233635 Vali Loss: 0.1747229 Test Loss: 0.2334387
Validation loss decreased (0.180542 --> 0.174723).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 12 cost time: 0.8766195774078369
Epoch: 12, Steps: 64 | Train Loss: 0.1219919 Vali Loss: 0.1703422 Test Loss: 0.2277665
Validation loss decreased (0.174723 --> 0.170342).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 13 cost time: 0.8643577098846436
Epoch: 13, Steps: 64 | Train Loss: 0.1198921 Vali Loss: 0.1686875 Test Loss: 0.2272763
Validation loss decreased (0.170342 --> 0.168688).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 14 cost time: 0.8860492706298828
Epoch: 14, Steps: 64 | Train Loss: 0.1191558 Vali Loss: 0.1681824 Test Loss: 0.2253072
Validation loss decreased (0.168688 --> 0.168182).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 15 cost time: 0.8673694133758545
Epoch: 15, Steps: 64 | Train Loss: 0.1185666 Vali Loss: 0.1665649 Test Loss: 0.2264207
Validation loss decreased (0.168182 --> 0.166565).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 16 cost time: 0.8717286586761475
Epoch: 16, Steps: 64 | Train Loss: 0.1176597 Vali Loss: 0.1643461 Test Loss: 0.2239601
Validation loss decreased (0.166565 --> 0.164346).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 17 cost time: 0.878000020980835
Epoch: 17, Steps: 64 | Train Loss: 0.1163532 Vali Loss: 0.1639169 Test Loss: 0.2243005
Validation loss decreased (0.164346 --> 0.163917).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 18 cost time: 0.8686206340789795
Epoch: 18, Steps: 64 | Train Loss: 0.1161756 Vali Loss: 0.1652314 Test Loss: 0.2241728
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 19 cost time: 0.8713712692260742
Epoch: 19, Steps: 64 | Train Loss: 0.1151964 Vali Loss: 0.1615556 Test Loss: 0.2243601
Validation loss decreased (0.163917 --> 0.161556).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 20 cost time: 0.8693573474884033
Epoch: 20, Steps: 64 | Train Loss: 0.1146776 Vali Loss: 0.1632477 Test Loss: 0.2247908
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 21 cost time: 0.8857161998748779
Epoch: 21, Steps: 64 | Train Loss: 0.1138964 Vali Loss: 0.1625466 Test Loss: 0.2245787
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 22 cost time: 0.8769989013671875
Epoch: 22, Steps: 64 | Train Loss: 0.1139617 Vali Loss: 0.1605626 Test Loss: 0.2240971
Validation loss decreased (0.161556 --> 0.160563).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 23 cost time: 0.8694233894348145
Epoch: 23, Steps: 64 | Train Loss: 0.1130426 Vali Loss: 0.1601316 Test Loss: 0.2243146
Validation loss decreased (0.160563 --> 0.160132).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 24 cost time: 0.8654098510742188
Epoch: 24, Steps: 64 | Train Loss: 0.1135470 Vali Loss: 0.1594895 Test Loss: 0.2228543
Validation loss decreased (0.160132 --> 0.159489).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 25 cost time: 0.8635175228118896
Epoch: 25, Steps: 64 | Train Loss: 0.1132754 Vali Loss: 0.1592856 Test Loss: 0.2246290
Validation loss decreased (0.159489 --> 0.159286).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 26 cost time: 0.8703761100769043
Epoch: 26, Steps: 64 | Train Loss: 0.1127802 Vali Loss: 0.1590063 Test Loss: 0.2238279
Validation loss decreased (0.159286 --> 0.159006).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 27 cost time: 0.865792989730835
Epoch: 27, Steps: 64 | Train Loss: 0.1118938 Vali Loss: 0.1586069 Test Loss: 0.2232476
Validation loss decreased (0.159006 --> 0.158607).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 28 cost time: 0.8816237449645996
Epoch: 28, Steps: 64 | Train Loss: 0.1118766 Vali Loss: 0.1586966 Test Loss: 0.2233914
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 29 cost time: 0.8776371479034424
Epoch: 29, Steps: 64 | Train Loss: 0.1114365 Vali Loss: 0.1596586 Test Loss: 0.2246649
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 30 cost time: 0.8743324279785156
Epoch: 30, Steps: 64 | Train Loss: 0.1122037 Vali Loss: 0.1593571 Test Loss: 0.2243169
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 31 cost time: 0.8704240322113037
Epoch: 31, Steps: 64 | Train Loss: 0.1118185 Vali Loss: 0.1573664 Test Loss: 0.2237659
Validation loss decreased (0.158607 --> 0.157366).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 32 cost time: 0.8694233894348145
Epoch: 32, Steps: 64 | Train Loss: 0.1114689 Vali Loss: 0.1573848 Test Loss: 0.2232070
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 33 cost time: 0.8677787780761719
Epoch: 33, Steps: 64 | Train Loss: 0.1110896 Vali Loss: 0.1599503 Test Loss: 0.2234439
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 34 cost time: 0.8649978637695312
Epoch: 34, Steps: 64 | Train Loss: 0.1112390 Vali Loss: 0.1582843 Test Loss: 0.2238842
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 35 cost time: 0.8696138858795166
Epoch: 35, Steps: 64 | Train Loss: 0.1109609 Vali Loss: 0.1586758 Test Loss: 0.2235726
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 36 cost time: 0.8643999099731445
Epoch: 36, Steps: 64 | Train Loss: 0.1112076 Vali Loss: 0.1581256 Test Loss: 0.2239940
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 37 cost time: 0.8719916343688965
Epoch: 37, Steps: 64 | Train Loss: 0.1113344 Vali Loss: 0.1570780 Test Loss: 0.2232940
Validation loss decreased (0.157366 --> 0.157078).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 38 cost time: 0.8765673637390137
Epoch: 38, Steps: 64 | Train Loss: 0.1108755 Vali Loss: 0.1571626 Test Loss: 0.2240346
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 39 cost time: 0.8897736072540283
Epoch: 39, Steps: 64 | Train Loss: 0.1106185 Vali Loss: 0.1566544 Test Loss: 0.2234164
Validation loss decreased (0.157078 --> 0.156654).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 40 cost time: 0.8680000305175781
Epoch: 40, Steps: 64 | Train Loss: 0.1109622 Vali Loss: 0.1569549 Test Loss: 0.2229507
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 41 cost time: 0.86604905128479
Epoch: 41, Steps: 64 | Train Loss: 0.1104336 Vali Loss: 0.1581364 Test Loss: 0.2243983
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 42 cost time: 0.8744628429412842
Epoch: 42, Steps: 64 | Train Loss: 0.1105217 Vali Loss: 0.1589186 Test Loss: 0.2251345
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 43 cost time: 0.8783471584320068
Epoch: 43, Steps: 64 | Train Loss: 0.1107194 Vali Loss: 0.1588179 Test Loss: 0.2248300
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 44 cost time: 0.8817365169525146
Epoch: 44, Steps: 64 | Train Loss: 0.1105158 Vali Loss: 0.1580445 Test Loss: 0.2232154
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 45 cost time: 0.8659999370574951
Epoch: 45, Steps: 64 | Train Loss: 0.1103110 Vali Loss: 0.1568593 Test Loss: 0.2230079
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 46 cost time: 0.8782446384429932
Epoch: 46, Steps: 64 | Train Loss: 0.1104287 Vali Loss: 0.1565705 Test Loss: 0.2232608
Validation loss decreased (0.156654 --> 0.156570).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 47 cost time: 0.8694391250610352
Epoch: 47, Steps: 64 | Train Loss: 0.1102368 Vali Loss: 0.1574991 Test Loss: 0.2238267
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 48 cost time: 0.8683497905731201
Epoch: 48, Steps: 64 | Train Loss: 0.1099193 Vali Loss: 0.1578063 Test Loss: 0.2235782
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 49 cost time: 0.8784623146057129
Epoch: 49, Steps: 64 | Train Loss: 0.1100251 Vali Loss: 0.1581180 Test Loss: 0.2245809
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 50 cost time: 0.8694193363189697
Epoch: 50, Steps: 64 | Train Loss: 0.1106566 Vali Loss: 0.1578698 Test Loss: 0.2237186
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 51 cost time: 0.8499999046325684
Epoch: 51, Steps: 64 | Train Loss: 0.1104558 Vali Loss: 0.1581915 Test Loss: 0.2242997
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 52 cost time: 0.8606507778167725
Epoch: 52, Steps: 64 | Train Loss: 0.1099397 Vali Loss: 0.1595857 Test Loss: 0.2252036
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 53 cost time: 0.8653173446655273
Epoch: 53, Steps: 64 | Train Loss: 0.1102085 Vali Loss: 0.1582107 Test Loss: 0.2237227
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 54 cost time: 0.8571257591247559
Epoch: 54, Steps: 64 | Train Loss: 0.1100011 Vali Loss: 0.1567844 Test Loss: 0.2234446
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 55 cost time: 0.8691873550415039
Epoch: 55, Steps: 64 | Train Loss: 0.1097064 Vali Loss: 0.1581503 Test Loss: 0.2246754
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 56 cost time: 0.8730006217956543
Epoch: 56, Steps: 64 | Train Loss: 0.1102277 Vali Loss: 0.1557880 Test Loss: 0.2238518
Validation loss decreased (0.156570 --> 0.155788).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 57 cost time: 0.891629695892334
Epoch: 57, Steps: 64 | Train Loss: 0.1098704 Vali Loss: 0.1581724 Test Loss: 0.2243138
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 58 cost time: 0.8763659000396729
Epoch: 58, Steps: 64 | Train Loss: 0.1103946 Vali Loss: 0.1577418 Test Loss: 0.2237732
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 59 cost time: 0.8689777851104736
Epoch: 59, Steps: 64 | Train Loss: 0.1105656 Vali Loss: 0.1577419 Test Loss: 0.2243747
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 60 cost time: 0.8683815002441406
Epoch: 60, Steps: 64 | Train Loss: 0.1099518 Vali Loss: 0.1575123 Test Loss: 0.2235299
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22385182976722717, mae:0.3232268989086151, rse:0.23978082835674286
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.06283950805664062 GB
Epoch: 1 cost time: 2.2560341358184814
Epoch: 1, Steps: 64 | Train Loss: 0.8784405 Vali Loss: 2.2889783 Test Loss: 3.6388288
Validation loss decreased (inf --> 2.288978).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 2 cost time: 0.9259989261627197
Epoch: 2, Steps: 64 | Train Loss: 0.3755285 Vali Loss: 0.2024297 Test Loss: 0.2358142
Validation loss decreased (2.288978 --> 0.202430).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 3 cost time: 0.9186224937438965
Epoch: 3, Steps: 64 | Train Loss: 0.1303854 Vali Loss: 0.1792950 Test Loss: 0.2334362
Validation loss decreased (0.202430 --> 0.179295).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 4 cost time: 0.9247555732727051
Epoch: 4, Steps: 64 | Train Loss: 0.1192714 Vali Loss: 0.1668471 Test Loss: 0.2240312
Validation loss decreased (0.179295 --> 0.166847).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 5 cost time: 0.914384126663208
Epoch: 5, Steps: 64 | Train Loss: 0.1142298 Vali Loss: 0.1611143 Test Loss: 0.2187717
Validation loss decreased (0.166847 --> 0.161114).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 6 cost time: 0.9106159210205078
Epoch: 6, Steps: 64 | Train Loss: 0.1125331 Vali Loss: 0.1617746 Test Loss: 0.2215887
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 7 cost time: 0.9087848663330078
Epoch: 7, Steps: 64 | Train Loss: 0.1095236 Vali Loss: 0.1580845 Test Loss: 0.2207128
Validation loss decreased (0.161114 --> 0.158085).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 8 cost time: 0.9104206562042236
Epoch: 8, Steps: 64 | Train Loss: 0.1081841 Vali Loss: 0.1601089 Test Loss: 0.2206386
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 9 cost time: 0.908475399017334
Epoch: 9, Steps: 64 | Train Loss: 0.1068622 Vali Loss: 0.1606714 Test Loss: 0.2219123
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 10 cost time: 0.9166145324707031
Epoch: 10, Steps: 64 | Train Loss: 0.1054653 Vali Loss: 0.1588104 Test Loss: 0.2215795
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 11 cost time: 0.9246232509613037
Epoch: 11, Steps: 64 | Train Loss: 0.1047873 Vali Loss: 0.1563692 Test Loss: 0.2224464
Validation loss decreased (0.158085 --> 0.156369).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 12 cost time: 0.9159684181213379
Epoch: 12, Steps: 64 | Train Loss: 0.1042465 Vali Loss: 0.1553430 Test Loss: 0.2223405
Validation loss decreased (0.156369 --> 0.155343).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 13 cost time: 0.9104104042053223
Epoch: 13, Steps: 64 | Train Loss: 0.1030597 Vali Loss: 0.1552474 Test Loss: 0.2221063
Validation loss decreased (0.155343 --> 0.155247).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 14 cost time: 0.9143593311309814
Epoch: 14, Steps: 64 | Train Loss: 0.1026580 Vali Loss: 0.1513388 Test Loss: 0.2240137
Validation loss decreased (0.155247 --> 0.151339).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 15 cost time: 0.9198412895202637
Epoch: 15, Steps: 64 | Train Loss: 0.1018259 Vali Loss: 0.1531132 Test Loss: 0.2241943
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 16 cost time: 0.9068202972412109
Epoch: 16, Steps: 64 | Train Loss: 0.1014222 Vali Loss: 0.1517877 Test Loss: 0.2248044
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 17 cost time: 0.9092001914978027
Epoch: 17, Steps: 64 | Train Loss: 0.1010375 Vali Loss: 0.1508669 Test Loss: 0.2230694
Validation loss decreased (0.151339 --> 0.150867).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 18 cost time: 0.9259998798370361
Epoch: 18, Steps: 64 | Train Loss: 0.1005746 Vali Loss: 0.1517325 Test Loss: 0.2228150
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 19 cost time: 0.9816269874572754
Epoch: 19, Steps: 64 | Train Loss: 0.1005019 Vali Loss: 0.1521298 Test Loss: 0.2248533
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 20 cost time: 0.9266107082366943
Epoch: 20, Steps: 64 | Train Loss: 0.1001505 Vali Loss: 0.1496928 Test Loss: 0.2239709
Validation loss decreased (0.150867 --> 0.149693).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 21 cost time: 0.909857988357544
Epoch: 21, Steps: 64 | Train Loss: 0.0999491 Vali Loss: 0.1498526 Test Loss: 0.2233469
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 22 cost time: 0.9118666648864746
Epoch: 22, Steps: 64 | Train Loss: 0.0993459 Vali Loss: 0.1503107 Test Loss: 0.2237219
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 23 cost time: 0.9083518981933594
Epoch: 23, Steps: 64 | Train Loss: 0.0993652 Vali Loss: 0.1497088 Test Loss: 0.2244231
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 24 cost time: 0.9123525619506836
Epoch: 24, Steps: 64 | Train Loss: 0.0996651 Vali Loss: 0.1505604 Test Loss: 0.2237726
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 25 cost time: 0.9137389659881592
Epoch: 25, Steps: 64 | Train Loss: 0.0987500 Vali Loss: 0.1489831 Test Loss: 0.2237653
Validation loss decreased (0.149693 --> 0.148983).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 26 cost time: 0.9100000858306885
Epoch: 26, Steps: 64 | Train Loss: 0.0985040 Vali Loss: 0.1493406 Test Loss: 0.2243712
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 27 cost time: 0.9096183776855469
Epoch: 27, Steps: 64 | Train Loss: 0.0987346 Vali Loss: 0.1479810 Test Loss: 0.2240359
Validation loss decreased (0.148983 --> 0.147981).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 28 cost time: 0.9114267826080322
Epoch: 28, Steps: 64 | Train Loss: 0.0985110 Vali Loss: 0.1502490 Test Loss: 0.2242170
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 29 cost time: 0.9340567588806152
Epoch: 29, Steps: 64 | Train Loss: 0.0987461 Vali Loss: 0.1488416 Test Loss: 0.2241207
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 30 cost time: 0.9109737873077393
Epoch: 30, Steps: 64 | Train Loss: 0.0985974 Vali Loss: 0.1476469 Test Loss: 0.2243142
Validation loss decreased (0.147981 --> 0.147647).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 31 cost time: 0.9057526588439941
Epoch: 31, Steps: 64 | Train Loss: 0.0985283 Vali Loss: 0.1486514 Test Loss: 0.2243571
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 32 cost time: 0.9108004570007324
Epoch: 32, Steps: 64 | Train Loss: 0.0982686 Vali Loss: 0.1491673 Test Loss: 0.2246876
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 33 cost time: 0.9034795761108398
Epoch: 33, Steps: 64 | Train Loss: 0.0980821 Vali Loss: 0.1489256 Test Loss: 0.2242003
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 34 cost time: 0.9063620567321777
Epoch: 34, Steps: 64 | Train Loss: 0.0982736 Vali Loss: 0.1496219 Test Loss: 0.2245980
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 35 cost time: 0.9236264228820801
Epoch: 35, Steps: 64 | Train Loss: 0.0981393 Vali Loss: 0.1483210 Test Loss: 0.2245369
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 36 cost time: 0.908376932144165
Epoch: 36, Steps: 64 | Train Loss: 0.0977391 Vali Loss: 0.1474491 Test Loss: 0.2247293
Validation loss decreased (0.147647 --> 0.147449).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 37 cost time: 0.9153478145599365
Epoch: 37, Steps: 64 | Train Loss: 0.0986208 Vali Loss: 0.1474296 Test Loss: 0.2245181
Validation loss decreased (0.147449 --> 0.147430).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 38 cost time: 0.9144210815429688
Epoch: 38, Steps: 64 | Train Loss: 0.0978747 Vali Loss: 0.1466101 Test Loss: 0.2247006
Validation loss decreased (0.147430 --> 0.146610).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 39 cost time: 0.9203758239746094
Epoch: 39, Steps: 64 | Train Loss: 0.0981666 Vali Loss: 0.1494613 Test Loss: 0.2251932
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 40 cost time: 0.9017598628997803
Epoch: 40, Steps: 64 | Train Loss: 0.0976212 Vali Loss: 0.1479119 Test Loss: 0.2244010
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 41 cost time: 0.9099984169006348
Epoch: 41, Steps: 64 | Train Loss: 0.0976972 Vali Loss: 0.1476532 Test Loss: 0.2248865
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 42 cost time: 0.910423755645752
Epoch: 42, Steps: 64 | Train Loss: 0.0975197 Vali Loss: 0.1504656 Test Loss: 0.2252879
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 43 cost time: 0.9064452648162842
Epoch: 43, Steps: 64 | Train Loss: 0.0979009 Vali Loss: 0.1487087 Test Loss: 0.2246089
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 44 cost time: 0.911400556564331
Epoch: 44, Steps: 64 | Train Loss: 0.0979904 Vali Loss: 0.1455973 Test Loss: 0.2247625
Validation loss decreased (0.146610 --> 0.145597).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 45 cost time: 0.9083681106567383
Epoch: 45, Steps: 64 | Train Loss: 0.0976146 Vali Loss: 0.1474353 Test Loss: 0.2245493
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 46 cost time: 0.8979878425598145
Epoch: 46, Steps: 64 | Train Loss: 0.0980301 Vali Loss: 0.1484319 Test Loss: 0.2245858
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 47 cost time: 0.8853411674499512
Epoch: 47, Steps: 64 | Train Loss: 0.0976224 Vali Loss: 0.1479252 Test Loss: 0.2244162
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 48 cost time: 0.9150002002716064
Epoch: 48, Steps: 64 | Train Loss: 0.0978009 Vali Loss: 0.1485130 Test Loss: 0.2241941
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 49 cost time: 0.9175965785980225
Epoch: 49, Steps: 64 | Train Loss: 0.0973337 Vali Loss: 0.1481664 Test Loss: 0.2248820
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 50 cost time: 0.9153580665588379
Epoch: 50, Steps: 64 | Train Loss: 0.0977445 Vali Loss: 0.1482088 Test Loss: 0.2245204
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 51 cost time: 0.921356201171875
Epoch: 51, Steps: 64 | Train Loss: 0.0978763 Vali Loss: 0.1479634 Test Loss: 0.2247424
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 52 cost time: 0.9353988170623779
Epoch: 52, Steps: 64 | Train Loss: 0.0979913 Vali Loss: 0.1502369 Test Loss: 0.2244173
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 53 cost time: 0.8899614810943604
Epoch: 53, Steps: 64 | Train Loss: 0.0977236 Vali Loss: 0.1482812 Test Loss: 0.2245805
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 54 cost time: 0.9277822971343994
Epoch: 54, Steps: 64 | Train Loss: 0.0975255 Vali Loss: 0.1478281 Test Loss: 0.2249261
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 55 cost time: 0.9301166534423828
Epoch: 55, Steps: 64 | Train Loss: 0.0972638 Vali Loss: 0.1483310 Test Loss: 0.2247655
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 56 cost time: 0.9280011653900146
Epoch: 56, Steps: 64 | Train Loss: 0.0977993 Vali Loss: 0.1484644 Test Loss: 0.2247523
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 57 cost time: 0.9036097526550293
Epoch: 57, Steps: 64 | Train Loss: 0.0973113 Vali Loss: 0.1470806 Test Loss: 0.2251075
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 58 cost time: 0.9103763103485107
Epoch: 58, Steps: 64 | Train Loss: 0.0976849 Vali Loss: 0.1454645 Test Loss: 0.2244152
Validation loss decreased (0.145597 --> 0.145464).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 59 cost time: 0.9060928821563721
Epoch: 59, Steps: 64 | Train Loss: 0.0973016 Vali Loss: 0.1486785 Test Loss: 0.2247956
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 60 cost time: 0.9253485202789307
Epoch: 60, Steps: 64 | Train Loss: 0.0973733 Vali Loss: 0.1477268 Test Loss: 0.2246764
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22441524267196655, mae:0.3291277289390564, rse:0.24008239805698395
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06613826751708984 GB
Epoch: 1 cost time: 2.3233742713928223
Epoch: 1, Steps: 64 | Train Loss: 0.8500047 Vali Loss: 2.2489352 Test Loss: 3.5788836
Validation loss decreased (inf --> 2.248935).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 2 cost time: 0.9657142162322998
Epoch: 2, Steps: 64 | Train Loss: 0.3279096 Vali Loss: 0.2467637 Test Loss: 0.3273091
Validation loss decreased (2.248935 --> 0.246764).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 3 cost time: 0.958402156829834
Epoch: 3, Steps: 64 | Train Loss: 0.1262123 Vali Loss: 0.1735118 Test Loss: 0.2195913
Validation loss decreased (0.246764 --> 0.173512).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 4 cost time: 0.9423651695251465
Epoch: 4, Steps: 64 | Train Loss: 0.1152451 Vali Loss: 0.1661963 Test Loss: 0.2183266
Validation loss decreased (0.173512 --> 0.166196).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 5 cost time: 0.9419984817504883
Epoch: 5, Steps: 64 | Train Loss: 0.1117888 Vali Loss: 0.1671860 Test Loss: 0.2195170
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 6 cost time: 0.9426169395446777
Epoch: 6, Steps: 64 | Train Loss: 0.1088788 Vali Loss: 0.1608155 Test Loss: 0.2178719
Validation loss decreased (0.166196 --> 0.160816).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 7 cost time: 0.9356193542480469
Epoch: 7, Steps: 64 | Train Loss: 0.1067590 Vali Loss: 0.1601511 Test Loss: 0.2200899
Validation loss decreased (0.160816 --> 0.160151).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 8 cost time: 0.9426982402801514
Epoch: 8, Steps: 64 | Train Loss: 0.1058468 Vali Loss: 0.1595164 Test Loss: 0.2169352
Validation loss decreased (0.160151 --> 0.159516).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 9 cost time: 0.9489684104919434
Epoch: 9, Steps: 64 | Train Loss: 0.1044310 Vali Loss: 0.1552925 Test Loss: 0.2193799
Validation loss decreased (0.159516 --> 0.155292).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 10 cost time: 0.9471521377563477
Epoch: 10, Steps: 64 | Train Loss: 0.1042485 Vali Loss: 0.1544429 Test Loss: 0.2172698
Validation loss decreased (0.155292 --> 0.154443).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 11 cost time: 0.9467389583587646
Epoch: 11, Steps: 64 | Train Loss: 0.1029603 Vali Loss: 0.1543122 Test Loss: 0.2204530
Validation loss decreased (0.154443 --> 0.154312).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 12 cost time: 0.9453508853912354
Epoch: 12, Steps: 64 | Train Loss: 0.1024209 Vali Loss: 0.1532776 Test Loss: 0.2176536
Validation loss decreased (0.154312 --> 0.153278).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 13 cost time: 0.9613573551177979
Epoch: 13, Steps: 64 | Train Loss: 0.1018042 Vali Loss: 0.1525177 Test Loss: 0.2194745
Validation loss decreased (0.153278 --> 0.152518).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 14 cost time: 0.9377562999725342
Epoch: 14, Steps: 64 | Train Loss: 0.1010194 Vali Loss: 0.1530890 Test Loss: 0.2204079
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 15 cost time: 0.94100022315979
Epoch: 15, Steps: 64 | Train Loss: 0.1011276 Vali Loss: 0.1507667 Test Loss: 0.2203722
Validation loss decreased (0.152518 --> 0.150767).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 16 cost time: 0.963789701461792
Epoch: 16, Steps: 64 | Train Loss: 0.1000789 Vali Loss: 0.1493949 Test Loss: 0.2190384
Validation loss decreased (0.150767 --> 0.149395).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 17 cost time: 0.9426274299621582
Epoch: 17, Steps: 64 | Train Loss: 0.0996995 Vali Loss: 0.1477206 Test Loss: 0.2196718
Validation loss decreased (0.149395 --> 0.147721).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 18 cost time: 0.9453952312469482
Epoch: 18, Steps: 64 | Train Loss: 0.0995902 Vali Loss: 0.1481488 Test Loss: 0.2197259
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 19 cost time: 0.9564254283905029
Epoch: 19, Steps: 64 | Train Loss: 0.0988253 Vali Loss: 0.1485334 Test Loss: 0.2209668
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 20 cost time: 0.9450454711914062
Epoch: 20, Steps: 64 | Train Loss: 0.0985717 Vali Loss: 0.1492193 Test Loss: 0.2205791
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 21 cost time: 0.9433467388153076
Epoch: 21, Steps: 64 | Train Loss: 0.0986650 Vali Loss: 0.1466939 Test Loss: 0.2219986
Validation loss decreased (0.147721 --> 0.146694).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 22 cost time: 0.9423630237579346
Epoch: 22, Steps: 64 | Train Loss: 0.0984667 Vali Loss: 0.1457256 Test Loss: 0.2206351
Validation loss decreased (0.146694 --> 0.145726).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 23 cost time: 0.9434242248535156
Epoch: 23, Steps: 64 | Train Loss: 0.0981375 Vali Loss: 0.1494313 Test Loss: 0.2209066
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 24 cost time: 0.9397883415222168
Epoch: 24, Steps: 64 | Train Loss: 0.0981139 Vali Loss: 0.1501458 Test Loss: 0.2213816
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 25 cost time: 0.9419999122619629
Epoch: 25, Steps: 64 | Train Loss: 0.0979365 Vali Loss: 0.1474207 Test Loss: 0.2212237
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 26 cost time: 0.9436156749725342
Epoch: 26, Steps: 64 | Train Loss: 0.0982345 Vali Loss: 0.1459225 Test Loss: 0.2211775
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 27 cost time: 1.0236289501190186
Epoch: 27, Steps: 64 | Train Loss: 0.0973848 Vali Loss: 0.1477592 Test Loss: 0.2217621
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 28 cost time: 1.022383213043213
Epoch: 28, Steps: 64 | Train Loss: 0.0975025 Vali Loss: 0.1470935 Test Loss: 0.2211119
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 29 cost time: 0.9996240139007568
Epoch: 29, Steps: 64 | Train Loss: 0.0974065 Vali Loss: 0.1466862 Test Loss: 0.2212192
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 30 cost time: 0.9374330043792725
Epoch: 30, Steps: 64 | Train Loss: 0.0970861 Vali Loss: 0.1462196 Test Loss: 0.2210177
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 31 cost time: 0.9463684558868408
Epoch: 31, Steps: 64 | Train Loss: 0.0973609 Vali Loss: 0.1470238 Test Loss: 0.2217944
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 32 cost time: 0.943350076675415
Epoch: 32, Steps: 64 | Train Loss: 0.0973254 Vali Loss: 0.1459248 Test Loss: 0.2217013
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 33 cost time: 0.9424262046813965
Epoch: 33, Steps: 64 | Train Loss: 0.0971238 Vali Loss: 0.1456228 Test Loss: 0.2214220
Validation loss decreased (0.145726 --> 0.145623).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 34 cost time: 0.9484546184539795
Epoch: 34, Steps: 64 | Train Loss: 0.0971949 Vali Loss: 0.1458712 Test Loss: 0.2212889
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 35 cost time: 0.9477431774139404
Epoch: 35, Steps: 64 | Train Loss: 0.0970363 Vali Loss: 0.1471913 Test Loss: 0.2218392
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 36 cost time: 0.9527325630187988
Epoch: 36, Steps: 64 | Train Loss: 0.0975019 Vali Loss: 0.1452601 Test Loss: 0.2218698
Validation loss decreased (0.145623 --> 0.145260).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 37 cost time: 0.9496171474456787
Epoch: 37, Steps: 64 | Train Loss: 0.0970668 Vali Loss: 0.1460672 Test Loss: 0.2223747
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 38 cost time: 0.944622278213501
Epoch: 38, Steps: 64 | Train Loss: 0.0972688 Vali Loss: 0.1459804 Test Loss: 0.2219609
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 39 cost time: 0.954627275466919
Epoch: 39, Steps: 64 | Train Loss: 0.0969682 Vali Loss: 0.1463157 Test Loss: 0.2218509
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 40 cost time: 0.9424004554748535
Epoch: 40, Steps: 64 | Train Loss: 0.0966093 Vali Loss: 0.1449458 Test Loss: 0.2217371
Validation loss decreased (0.145260 --> 0.144946).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 41 cost time: 0.9412264823913574
Epoch: 41, Steps: 64 | Train Loss: 0.0968639 Vali Loss: 0.1463876 Test Loss: 0.2217383
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 42 cost time: 1.0119946002960205
Epoch: 42, Steps: 64 | Train Loss: 0.0971736 Vali Loss: 0.1464352 Test Loss: 0.2221090
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 43 cost time: 0.9724113941192627
Epoch: 43, Steps: 64 | Train Loss: 0.0966101 Vali Loss: 0.1472399 Test Loss: 0.2218390
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 44 cost time: 0.927454948425293
Epoch: 44, Steps: 64 | Train Loss: 0.0966902 Vali Loss: 0.1451838 Test Loss: 0.2222414
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 45 cost time: 0.9210972785949707
Epoch: 45, Steps: 64 | Train Loss: 0.0965483 Vali Loss: 0.1463202 Test Loss: 0.2219701
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 46 cost time: 0.9437878131866455
Epoch: 46, Steps: 64 | Train Loss: 0.0965709 Vali Loss: 0.1451662 Test Loss: 0.2220669
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 47 cost time: 0.9380002021789551
Epoch: 47, Steps: 64 | Train Loss: 0.0966242 Vali Loss: 0.1457225 Test Loss: 0.2219719
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 48 cost time: 0.9419996738433838
Epoch: 48, Steps: 64 | Train Loss: 0.0967521 Vali Loss: 0.1448532 Test Loss: 0.2222454
Validation loss decreased (0.144946 --> 0.144853).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 49 cost time: 0.9476253986358643
Epoch: 49, Steps: 64 | Train Loss: 0.0968065 Vali Loss: 0.1460493 Test Loss: 0.2221632
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 50 cost time: 0.9463436603546143
Epoch: 50, Steps: 64 | Train Loss: 0.0969059 Vali Loss: 0.1451704 Test Loss: 0.2217837
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 51 cost time: 0.9444169998168945
Epoch: 51, Steps: 64 | Train Loss: 0.0966650 Vali Loss: 0.1471169 Test Loss: 0.2222636
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 52 cost time: 0.9544203281402588
Epoch: 52, Steps: 64 | Train Loss: 0.0965930 Vali Loss: 0.1460613 Test Loss: 0.2222145
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 53 cost time: 0.9431054592132568
Epoch: 53, Steps: 64 | Train Loss: 0.0970235 Vali Loss: 0.1463584 Test Loss: 0.2222912
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 54 cost time: 0.9464273452758789
Epoch: 54, Steps: 64 | Train Loss: 0.0972307 Vali Loss: 0.1465371 Test Loss: 0.2219095
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 55 cost time: 0.9418604373931885
Epoch: 55, Steps: 64 | Train Loss: 0.0969343 Vali Loss: 0.1450986 Test Loss: 0.2218883
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 56 cost time: 0.9487645626068115
Epoch: 56, Steps: 64 | Train Loss: 0.0964617 Vali Loss: 0.1451599 Test Loss: 0.2217156
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 57 cost time: 0.940629243850708
Epoch: 57, Steps: 64 | Train Loss: 0.0972033 Vali Loss: 0.1471027 Test Loss: 0.2221824
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 58 cost time: 0.9473841190338135
Epoch: 58, Steps: 64 | Train Loss: 0.0967058 Vali Loss: 0.1453556 Test Loss: 0.2216846
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 59 cost time: 0.9546103477478027
Epoch: 59, Steps: 64 | Train Loss: 0.0968797 Vali Loss: 0.1454045 Test Loss: 0.2221755
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 60 cost time: 0.9474165439605713
Epoch: 60, Steps: 64 | Train Loss: 0.0965087 Vali Loss: 0.1456469 Test Loss: 0.2219809
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22224535048007965, mae:0.3238062262535095, rse:0.23891888558864594
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.05860710144042969 GB
Epoch: 1 cost time: 2.243633508682251
Epoch: 1, Steps: 64 | Train Loss: 0.9943975 Vali Loss: 2.5488687 Test Loss: 4.0402956
Validation loss decreased (inf --> 2.548869).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 2 cost time: 0.8872509002685547
Epoch: 2, Steps: 64 | Train Loss: 0.6790045 Vali Loss: 0.9998050 Test Loss: 1.4997344
Validation loss decreased (2.548869 --> 0.999805).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 3 cost time: 0.850933313369751
Epoch: 3, Steps: 64 | Train Loss: 0.3567292 Vali Loss: 0.5382730 Test Loss: 0.7609595
Validation loss decreased (0.999805 --> 0.538273).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 4 cost time: 0.8839995861053467
Epoch: 4, Steps: 64 | Train Loss: 0.2291667 Vali Loss: 0.3350364 Test Loss: 0.4420619
Validation loss decreased (0.538273 --> 0.335036).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 5 cost time: 0.885000467300415
Epoch: 5, Steps: 64 | Train Loss: 0.1733596 Vali Loss: 0.2517004 Test Loss: 0.3171119
Validation loss decreased (0.335036 --> 0.251700).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 6 cost time: 0.8855295181274414
Epoch: 6, Steps: 64 | Train Loss: 0.1494986 Vali Loss: 0.2141576 Test Loss: 0.2649519
Validation loss decreased (0.251700 --> 0.214158).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 7 cost time: 0.8784294128417969
Epoch: 7, Steps: 64 | Train Loss: 0.1386545 Vali Loss: 0.1975269 Test Loss: 0.2422604
Validation loss decreased (0.214158 --> 0.197527).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 8 cost time: 0.8753535747528076
Epoch: 8, Steps: 64 | Train Loss: 0.1327181 Vali Loss: 0.1860833 Test Loss: 0.2296332
Validation loss decreased (0.197527 --> 0.186083).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 9 cost time: 0.8757812976837158
Epoch: 9, Steps: 64 | Train Loss: 0.1288155 Vali Loss: 0.1807016 Test Loss: 0.2265612
Validation loss decreased (0.186083 --> 0.180702).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 10 cost time: 0.8927559852600098
Epoch: 10, Steps: 64 | Train Loss: 0.1267579 Vali Loss: 0.1750965 Test Loss: 0.2208398
Validation loss decreased (0.180702 --> 0.175096).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 11 cost time: 0.8836228847503662
Epoch: 11, Steps: 64 | Train Loss: 0.1238691 Vali Loss: 0.1725867 Test Loss: 0.2203657
Validation loss decreased (0.175096 --> 0.172587).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 12 cost time: 0.8856287002563477
Epoch: 12, Steps: 64 | Train Loss: 0.1215747 Vali Loss: 0.1707963 Test Loss: 0.2195790
Validation loss decreased (0.172587 --> 0.170796).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 13 cost time: 0.8933432102203369
Epoch: 13, Steps: 64 | Train Loss: 0.1219255 Vali Loss: 0.1684733 Test Loss: 0.2181555
Validation loss decreased (0.170796 --> 0.168473).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 14 cost time: 0.8827219009399414
Epoch: 14, Steps: 64 | Train Loss: 0.1201337 Vali Loss: 0.1686204 Test Loss: 0.2177460
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 15 cost time: 0.881443977355957
Epoch: 15, Steps: 64 | Train Loss: 0.1198301 Vali Loss: 0.1686921 Test Loss: 0.2189683
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 16 cost time: 0.87673020362854
Epoch: 16, Steps: 64 | Train Loss: 0.1192723 Vali Loss: 0.1683748 Test Loss: 0.2182084
Validation loss decreased (0.168473 --> 0.168375).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 17 cost time: 0.8949770927429199
Epoch: 17, Steps: 64 | Train Loss: 0.1180338 Vali Loss: 0.1665911 Test Loss: 0.2177560
Validation loss decreased (0.168375 --> 0.166591).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 18 cost time: 0.8756308555603027
Epoch: 18, Steps: 64 | Train Loss: 0.1172976 Vali Loss: 0.1662574 Test Loss: 0.2174608
Validation loss decreased (0.166591 --> 0.166257).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 19 cost time: 0.8863909244537354
Epoch: 19, Steps: 64 | Train Loss: 0.1162994 Vali Loss: 0.1649002 Test Loss: 0.2174341
Validation loss decreased (0.166257 --> 0.164900).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 20 cost time: 0.9000122547149658
Epoch: 20, Steps: 64 | Train Loss: 0.1164086 Vali Loss: 0.1644369 Test Loss: 0.2185903
Validation loss decreased (0.164900 --> 0.164437).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 21 cost time: 0.8793644905090332
Epoch: 21, Steps: 64 | Train Loss: 0.1160840 Vali Loss: 0.1646480 Test Loss: 0.2176329
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 22 cost time: 0.8833749294281006
Epoch: 22, Steps: 64 | Train Loss: 0.1152135 Vali Loss: 0.1644758 Test Loss: 0.2178684
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 23 cost time: 0.8797929286956787
Epoch: 23, Steps: 64 | Train Loss: 0.1148083 Vali Loss: 0.1634541 Test Loss: 0.2174879
Validation loss decreased (0.164437 --> 0.163454).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 24 cost time: 0.8654181957244873
Epoch: 24, Steps: 64 | Train Loss: 0.1144782 Vali Loss: 0.1645037 Test Loss: 0.2188906
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 25 cost time: 0.8790104389190674
Epoch: 25, Steps: 64 | Train Loss: 0.1145386 Vali Loss: 0.1627393 Test Loss: 0.2178276
Validation loss decreased (0.163454 --> 0.162739).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 26 cost time: 0.8743982315063477
Epoch: 26, Steps: 64 | Train Loss: 0.1143032 Vali Loss: 0.1636036 Test Loss: 0.2177684
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 27 cost time: 0.869396448135376
Epoch: 27, Steps: 64 | Train Loss: 0.1145205 Vali Loss: 0.1637986 Test Loss: 0.2176747
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 28 cost time: 0.9105238914489746
Epoch: 28, Steps: 64 | Train Loss: 0.1137273 Vali Loss: 0.1620153 Test Loss: 0.2172532
Validation loss decreased (0.162739 --> 0.162015).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 29 cost time: 0.8837642669677734
Epoch: 29, Steps: 64 | Train Loss: 0.1135181 Vali Loss: 0.1621655 Test Loss: 0.2182371
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 30 cost time: 0.8805315494537354
Epoch: 30, Steps: 64 | Train Loss: 0.1137419 Vali Loss: 0.1629632 Test Loss: 0.2179511
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 31 cost time: 0.8792867660522461
Epoch: 31, Steps: 64 | Train Loss: 0.1137477 Vali Loss: 0.1628187 Test Loss: 0.2176058
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 32 cost time: 0.8763418197631836
Epoch: 32, Steps: 64 | Train Loss: 0.1131873 Vali Loss: 0.1624600 Test Loss: 0.2179314
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 33 cost time: 0.8849844932556152
Epoch: 33, Steps: 64 | Train Loss: 0.1137846 Vali Loss: 0.1626765 Test Loss: 0.2180208
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 34 cost time: 0.880387544631958
Epoch: 34, Steps: 64 | Train Loss: 0.1127775 Vali Loss: 0.1625713 Test Loss: 0.2178314
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 35 cost time: 0.8767557144165039
Epoch: 35, Steps: 64 | Train Loss: 0.1132628 Vali Loss: 0.1610275 Test Loss: 0.2171210
Validation loss decreased (0.162015 --> 0.161028).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 36 cost time: 0.880000114440918
Epoch: 36, Steps: 64 | Train Loss: 0.1131452 Vali Loss: 0.1616163 Test Loss: 0.2177976
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 37 cost time: 0.8892436027526855
Epoch: 37, Steps: 64 | Train Loss: 0.1128058 Vali Loss: 0.1620283 Test Loss: 0.2178491
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 38 cost time: 0.8942587375640869
Epoch: 38, Steps: 64 | Train Loss: 0.1128423 Vali Loss: 0.1617462 Test Loss: 0.2177968
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 39 cost time: 0.878631591796875
Epoch: 39, Steps: 64 | Train Loss: 0.1126539 Vali Loss: 0.1624161 Test Loss: 0.2174020
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 40 cost time: 0.8797695636749268
Epoch: 40, Steps: 64 | Train Loss: 0.1123555 Vali Loss: 0.1618325 Test Loss: 0.2180389
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 41 cost time: 0.8777689933776855
Epoch: 41, Steps: 64 | Train Loss: 0.1126927 Vali Loss: 0.1613813 Test Loss: 0.2177850
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 42 cost time: 0.8863809108734131
Epoch: 42, Steps: 64 | Train Loss: 0.1124918 Vali Loss: 0.1629708 Test Loss: 0.2178239
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 43 cost time: 0.8746132850646973
Epoch: 43, Steps: 64 | Train Loss: 0.1132767 Vali Loss: 0.1621874 Test Loss: 0.2177836
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 44 cost time: 0.8773684501647949
Epoch: 44, Steps: 64 | Train Loss: 0.1118889 Vali Loss: 0.1621161 Test Loss: 0.2176558
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 45 cost time: 0.8933329582214355
Epoch: 45, Steps: 64 | Train Loss: 0.1122321 Vali Loss: 0.1605288 Test Loss: 0.2179213
Validation loss decreased (0.161028 --> 0.160529).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 46 cost time: 0.8843545913696289
Epoch: 46, Steps: 64 | Train Loss: 0.1131265 Vali Loss: 0.1625519 Test Loss: 0.2178584
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 47 cost time: 0.8787503242492676
Epoch: 47, Steps: 64 | Train Loss: 0.1116753 Vali Loss: 0.1611449 Test Loss: 0.2185477
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 48 cost time: 0.8809995651245117
Epoch: 48, Steps: 64 | Train Loss: 0.1123199 Vali Loss: 0.1617320 Test Loss: 0.2184214
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 49 cost time: 0.8855760097503662
Epoch: 49, Steps: 64 | Train Loss: 0.1119007 Vali Loss: 0.1617526 Test Loss: 0.2178912
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 50 cost time: 0.8673663139343262
Epoch: 50, Steps: 64 | Train Loss: 0.1122198 Vali Loss: 0.1624225 Test Loss: 0.2177239
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 51 cost time: 0.8780083656311035
Epoch: 51, Steps: 64 | Train Loss: 0.1131271 Vali Loss: 0.1624468 Test Loss: 0.2182487
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 52 cost time: 0.8774013519287109
Epoch: 52, Steps: 64 | Train Loss: 0.1126490 Vali Loss: 0.1625542 Test Loss: 0.2187456
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 53 cost time: 0.8737390041351318
Epoch: 53, Steps: 64 | Train Loss: 0.1128066 Vali Loss: 0.1618489 Test Loss: 0.2182293
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 54 cost time: 0.8829998970031738
Epoch: 54, Steps: 64 | Train Loss: 0.1122264 Vali Loss: 0.1623884 Test Loss: 0.2181696
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 55 cost time: 0.881981611251831
Epoch: 55, Steps: 64 | Train Loss: 0.1120611 Vali Loss: 0.1609253 Test Loss: 0.2179376
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 56 cost time: 0.8929564952850342
Epoch: 56, Steps: 64 | Train Loss: 0.1125566 Vali Loss: 0.1621606 Test Loss: 0.2187057
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 57 cost time: 0.8893752098083496
Epoch: 57, Steps: 64 | Train Loss: 0.1118751 Vali Loss: 0.1612955 Test Loss: 0.2173860
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 58 cost time: 0.8793637752532959
Epoch: 58, Steps: 64 | Train Loss: 0.1118669 Vali Loss: 0.1612889 Test Loss: 0.2178056
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 59 cost time: 0.8757634162902832
Epoch: 59, Steps: 64 | Train Loss: 0.1120060 Vali Loss: 0.1611227 Test Loss: 0.2182009
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 60 cost time: 0.8866147994995117
Epoch: 60, Steps: 64 | Train Loss: 0.1127907 Vali Loss: 0.1634777 Test Loss: 0.2180572
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.21792128682136536, mae:0.31809765100479126, rse:0.23658323287963867
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.06300163269042969 GB
Epoch: 1 cost time: 2.2966156005859375
Epoch: 1, Steps: 64 | Train Loss: 0.9600920 Vali Loss: 2.5331776 Test Loss: 4.0635457
Validation loss decreased (inf --> 2.533178).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 2 cost time: 0.9343826770782471
Epoch: 2, Steps: 64 | Train Loss: 0.4846930 Vali Loss: 0.2165768 Test Loss: 0.2489871
Validation loss decreased (2.533178 --> 0.216577).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 3 cost time: 0.9363937377929688
Epoch: 3, Steps: 64 | Train Loss: 0.1361633 Vali Loss: 0.1852852 Test Loss: 0.2218226
Validation loss decreased (0.216577 --> 0.185285).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 4 cost time: 0.9283401966094971
Epoch: 4, Steps: 64 | Train Loss: 0.1215442 Vali Loss: 0.1702723 Test Loss: 0.2159070
Validation loss decreased (0.185285 --> 0.170272).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 5 cost time: 0.929985523223877
Epoch: 5, Steps: 64 | Train Loss: 0.1165532 Vali Loss: 0.1676681 Test Loss: 0.2173940
Validation loss decreased (0.170272 --> 0.167668).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 6 cost time: 0.9224059581756592
Epoch: 6, Steps: 64 | Train Loss: 0.1126857 Vali Loss: 0.1642868 Test Loss: 0.2169382
Validation loss decreased (0.167668 --> 0.164287).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 7 cost time: 0.9237902164459229
Epoch: 7, Steps: 64 | Train Loss: 0.1109072 Vali Loss: 0.1643901 Test Loss: 0.2167304
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 8 cost time: 0.9229991436004639
Epoch: 8, Steps: 64 | Train Loss: 0.1089434 Vali Loss: 0.1621652 Test Loss: 0.2160598
Validation loss decreased (0.164287 --> 0.162165).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 9 cost time: 0.9256250858306885
Epoch: 9, Steps: 64 | Train Loss: 0.1079404 Vali Loss: 0.1615779 Test Loss: 0.2174999
Validation loss decreased (0.162165 --> 0.161578).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 10 cost time: 0.9376306533813477
Epoch: 10, Steps: 64 | Train Loss: 0.1066091 Vali Loss: 0.1604547 Test Loss: 0.2164698
Validation loss decreased (0.161578 --> 0.160455).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 11 cost time: 0.9344565868377686
Epoch: 11, Steps: 64 | Train Loss: 0.1053244 Vali Loss: 0.1602497 Test Loss: 0.2154261
Validation loss decreased (0.160455 --> 0.160250).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 12 cost time: 0.932328462600708
Epoch: 12, Steps: 64 | Train Loss: 0.1047438 Vali Loss: 0.1561412 Test Loss: 0.2163427
Validation loss decreased (0.160250 --> 0.156141).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 13 cost time: 0.9458396434783936
Epoch: 13, Steps: 64 | Train Loss: 0.1037997 Vali Loss: 0.1563035 Test Loss: 0.2155093
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 14 cost time: 0.9236595630645752
Epoch: 14, Steps: 64 | Train Loss: 0.1033012 Vali Loss: 0.1574302 Test Loss: 0.2168152
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 15 cost time: 0.9273734092712402
Epoch: 15, Steps: 64 | Train Loss: 0.1024491 Vali Loss: 0.1569223 Test Loss: 0.2178130
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 16 cost time: 0.9307315349578857
Epoch: 16, Steps: 64 | Train Loss: 0.1018905 Vali Loss: 0.1552111 Test Loss: 0.2164253
Validation loss decreased (0.156141 --> 0.155211).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 17 cost time: 0.9263887405395508
Epoch: 17, Steps: 64 | Train Loss: 0.1015821 Vali Loss: 0.1548400 Test Loss: 0.2175766
Validation loss decreased (0.155211 --> 0.154840).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 18 cost time: 0.9320001602172852
Epoch: 18, Steps: 64 | Train Loss: 0.1009428 Vali Loss: 0.1538257 Test Loss: 0.2174296
Validation loss decreased (0.154840 --> 0.153826).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 19 cost time: 0.9296176433563232
Epoch: 19, Steps: 64 | Train Loss: 0.0999348 Vali Loss: 0.1519701 Test Loss: 0.2163942
Validation loss decreased (0.153826 --> 0.151970).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 20 cost time: 0.950380802154541
Epoch: 20, Steps: 64 | Train Loss: 0.0992917 Vali Loss: 0.1524496 Test Loss: 0.2172867
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 21 cost time: 0.9317195415496826
Epoch: 21, Steps: 64 | Train Loss: 0.0995619 Vali Loss: 0.1536304 Test Loss: 0.2175316
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 22 cost time: 0.9263515472412109
Epoch: 22, Steps: 64 | Train Loss: 0.0990469 Vali Loss: 0.1526273 Test Loss: 0.2180082
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 23 cost time: 0.9343364238739014
Epoch: 23, Steps: 64 | Train Loss: 0.0982632 Vali Loss: 0.1522212 Test Loss: 0.2178083
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 24 cost time: 0.9264557361602783
Epoch: 24, Steps: 64 | Train Loss: 0.0985412 Vali Loss: 0.1519068 Test Loss: 0.2183575
Validation loss decreased (0.151970 --> 0.151907).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 25 cost time: 0.9276983737945557
Epoch: 25, Steps: 64 | Train Loss: 0.0983448 Vali Loss: 0.1523314 Test Loss: 0.2177478
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 26 cost time: 0.9330000877380371
Epoch: 26, Steps: 64 | Train Loss: 0.0978616 Vali Loss: 0.1516108 Test Loss: 0.2183186
Validation loss decreased (0.151907 --> 0.151611).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 27 cost time: 0.9162254333496094
Epoch: 27, Steps: 64 | Train Loss: 0.0977321 Vali Loss: 0.1526515 Test Loss: 0.2184884
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 28 cost time: 1.0056195259094238
Epoch: 28, Steps: 64 | Train Loss: 0.0974972 Vali Loss: 0.1511154 Test Loss: 0.2182491
Validation loss decreased (0.151611 --> 0.151115).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 29 cost time: 1.0061895847320557
Epoch: 29, Steps: 64 | Train Loss: 0.0974286 Vali Loss: 0.1495021 Test Loss: 0.2179667
Validation loss decreased (0.151115 --> 0.149502).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 30 cost time: 0.9575262069702148
Epoch: 30, Steps: 64 | Train Loss: 0.0971805 Vali Loss: 0.1502793 Test Loss: 0.2180921
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 31 cost time: 0.9154229164123535
Epoch: 31, Steps: 64 | Train Loss: 0.0971117 Vali Loss: 0.1495656 Test Loss: 0.2179500
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 32 cost time: 0.9193861484527588
Epoch: 32, Steps: 64 | Train Loss: 0.0977028 Vali Loss: 0.1494243 Test Loss: 0.2179621
Validation loss decreased (0.149502 --> 0.149424).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 33 cost time: 0.9253573417663574
Epoch: 33, Steps: 64 | Train Loss: 0.0974212 Vali Loss: 0.1510768 Test Loss: 0.2185369
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 34 cost time: 0.9229738712310791
Epoch: 34, Steps: 64 | Train Loss: 0.0974973 Vali Loss: 0.1511608 Test Loss: 0.2189762
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 35 cost time: 0.9347538948059082
Epoch: 35, Steps: 64 | Train Loss: 0.0971690 Vali Loss: 0.1504923 Test Loss: 0.2174796
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 36 cost time: 0.9330003261566162
Epoch: 36, Steps: 64 | Train Loss: 0.0969986 Vali Loss: 0.1489561 Test Loss: 0.2177892
Validation loss decreased (0.149424 --> 0.148956).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 37 cost time: 0.9416284561157227
Epoch: 37, Steps: 64 | Train Loss: 0.0971158 Vali Loss: 0.1502632 Test Loss: 0.2182005
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 38 cost time: 0.9306185245513916
Epoch: 38, Steps: 64 | Train Loss: 0.0965646 Vali Loss: 0.1506138 Test Loss: 0.2180519
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 39 cost time: 0.9184122085571289
Epoch: 39, Steps: 64 | Train Loss: 0.0970115 Vali Loss: 0.1494050 Test Loss: 0.2182841
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 40 cost time: 0.9273183345794678
Epoch: 40, Steps: 64 | Train Loss: 0.0969476 Vali Loss: 0.1520940 Test Loss: 0.2181258
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 41 cost time: 0.919442892074585
Epoch: 41, Steps: 64 | Train Loss: 0.0968365 Vali Loss: 0.1506287 Test Loss: 0.2184107
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 42 cost time: 0.9188408851623535
Epoch: 42, Steps: 64 | Train Loss: 0.0966134 Vali Loss: 0.1497459 Test Loss: 0.2180102
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 43 cost time: 0.9318251609802246
Epoch: 43, Steps: 64 | Train Loss: 0.0966583 Vali Loss: 0.1493005 Test Loss: 0.2179151
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 44 cost time: 0.8918516635894775
Epoch: 44, Steps: 64 | Train Loss: 0.0964202 Vali Loss: 0.1503319 Test Loss: 0.2185659
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 45 cost time: 0.9169349670410156
Epoch: 45, Steps: 64 | Train Loss: 0.0961858 Vali Loss: 0.1485734 Test Loss: 0.2185436
Validation loss decreased (0.148956 --> 0.148573).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 46 cost time: 0.9209799766540527
Epoch: 46, Steps: 64 | Train Loss: 0.0967903 Vali Loss: 0.1490656 Test Loss: 0.2181889
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 47 cost time: 0.9174370765686035
Epoch: 47, Steps: 64 | Train Loss: 0.0968056 Vali Loss: 0.1507569 Test Loss: 0.2181963
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 48 cost time: 0.9163672924041748
Epoch: 48, Steps: 64 | Train Loss: 0.0966675 Vali Loss: 0.1497920 Test Loss: 0.2184913
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 49 cost time: 0.9233574867248535
Epoch: 49, Steps: 64 | Train Loss: 0.0968774 Vali Loss: 0.1503206 Test Loss: 0.2182801
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 50 cost time: 0.9377598762512207
Epoch: 50, Steps: 64 | Train Loss: 0.0965276 Vali Loss: 0.1502301 Test Loss: 0.2181840
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 51 cost time: 0.9248251914978027
Epoch: 51, Steps: 64 | Train Loss: 0.0963955 Vali Loss: 0.1498954 Test Loss: 0.2180451
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 52 cost time: 0.9259989261627197
Epoch: 52, Steps: 64 | Train Loss: 0.0963376 Vali Loss: 0.1510090 Test Loss: 0.2185040
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 53 cost time: 0.9329991340637207
Epoch: 53, Steps: 64 | Train Loss: 0.0967047 Vali Loss: 0.1489209 Test Loss: 0.2183329
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 54 cost time: 0.9336223602294922
Epoch: 54, Steps: 64 | Train Loss: 0.0967554 Vali Loss: 0.1496831 Test Loss: 0.2182291
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 55 cost time: 0.926257848739624
Epoch: 55, Steps: 64 | Train Loss: 0.0968355 Vali Loss: 0.1497253 Test Loss: 0.2181033
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 56 cost time: 0.9213600158691406
Epoch: 56, Steps: 64 | Train Loss: 0.0964702 Vali Loss: 0.1480684 Test Loss: 0.2181098
Validation loss decreased (0.148573 --> 0.148068).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 57 cost time: 0.9314596652984619
Epoch: 57, Steps: 64 | Train Loss: 0.0965223 Vali Loss: 0.1502989 Test Loss: 0.2186956
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 58 cost time: 0.9213962554931641
Epoch: 58, Steps: 64 | Train Loss: 0.0972297 Vali Loss: 0.1485139 Test Loss: 0.2186841
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 59 cost time: 0.9351673126220703
Epoch: 59, Steps: 64 | Train Loss: 0.0966347 Vali Loss: 0.1492941 Test Loss: 0.2187537
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 60 cost time: 0.9307451248168945
Epoch: 60, Steps: 64 | Train Loss: 0.0967321 Vali Loss: 0.1507377 Test Loss: 0.2185627
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.21810981631278992, mae:0.3209686279296875, rse:0.23668554425239563
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.0663003921508789 GB
Epoch: 1 cost time: 2.2832388877868652
Epoch: 1, Steps: 64 | Train Loss: 0.8802292 Vali Loss: 2.3459148 Test Loss: 3.7557282
Validation loss decreased (inf --> 2.345915).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 2 cost time: 0.9656128883361816
Epoch: 2, Steps: 64 | Train Loss: 0.3607135 Vali Loss: 0.3077638 Test Loss: 0.4174048
Validation loss decreased (2.345915 --> 0.307764).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 3 cost time: 0.9700455665588379
Epoch: 3, Steps: 64 | Train Loss: 0.1302741 Vali Loss: 0.1706541 Test Loss: 0.2155374
Validation loss decreased (0.307764 --> 0.170654).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 4 cost time: 0.9676206111907959
Epoch: 4, Steps: 64 | Train Loss: 0.1173749 Vali Loss: 0.1684266 Test Loss: 0.2190584
Validation loss decreased (0.170654 --> 0.168427).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 5 cost time: 0.9574282169342041
Epoch: 5, Steps: 64 | Train Loss: 0.1131581 Vali Loss: 0.1681681 Test Loss: 0.2159183
Validation loss decreased (0.168427 --> 0.168168).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 6 cost time: 0.958362340927124
Epoch: 6, Steps: 64 | Train Loss: 0.1103159 Vali Loss: 0.1611993 Test Loss: 0.2135588
Validation loss decreased (0.168168 --> 0.161199).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 7 cost time: 0.9533722400665283
Epoch: 7, Steps: 64 | Train Loss: 0.1090513 Vali Loss: 0.1592479 Test Loss: 0.2169329
Validation loss decreased (0.161199 --> 0.159248).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 8 cost time: 0.9510054588317871
Epoch: 8, Steps: 64 | Train Loss: 0.1068906 Vali Loss: 0.1608061 Test Loss: 0.2148944
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 9 cost time: 0.9623785018920898
Epoch: 9, Steps: 64 | Train Loss: 0.1061566 Vali Loss: 0.1617852 Test Loss: 0.2156578
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 10 cost time: 0.9844164848327637
Epoch: 10, Steps: 64 | Train Loss: 0.1049081 Vali Loss: 0.1589458 Test Loss: 0.2156374
Validation loss decreased (0.159248 --> 0.158946).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 11 cost time: 1.0258615016937256
Epoch: 11, Steps: 64 | Train Loss: 0.1040632 Vali Loss: 0.1545032 Test Loss: 0.2165314
Validation loss decreased (0.158946 --> 0.154503).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 12 cost time: 0.9624404907226562
Epoch: 12, Steps: 64 | Train Loss: 0.1031816 Vali Loss: 0.1539885 Test Loss: 0.2160809
Validation loss decreased (0.154503 --> 0.153989).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 13 cost time: 0.9619998931884766
Epoch: 13, Steps: 64 | Train Loss: 0.1021804 Vali Loss: 0.1539780 Test Loss: 0.2163003
Validation loss decreased (0.153989 --> 0.153978).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 14 cost time: 0.9609994888305664
Epoch: 14, Steps: 64 | Train Loss: 0.1018215 Vali Loss: 0.1513224 Test Loss: 0.2171696
Validation loss decreased (0.153978 --> 0.151322).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 15 cost time: 0.9576270580291748
Epoch: 15, Steps: 64 | Train Loss: 0.1013272 Vali Loss: 0.1543418 Test Loss: 0.2172817
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 16 cost time: 0.9570014476776123
Epoch: 16, Steps: 64 | Train Loss: 0.1012431 Vali Loss: 0.1503786 Test Loss: 0.2171842
Validation loss decreased (0.151322 --> 0.150379).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 17 cost time: 0.9743931293487549
Epoch: 17, Steps: 64 | Train Loss: 0.1000245 Vali Loss: 0.1511889 Test Loss: 0.2170509
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 18 cost time: 0.9653892517089844
Epoch: 18, Steps: 64 | Train Loss: 0.1002621 Vali Loss: 0.1485814 Test Loss: 0.2163844
Validation loss decreased (0.150379 --> 0.148581).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 19 cost time: 0.9664280414581299
Epoch: 19, Steps: 64 | Train Loss: 0.0999224 Vali Loss: 0.1497397 Test Loss: 0.2176350
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 20 cost time: 0.9769763946533203
Epoch: 20, Steps: 64 | Train Loss: 0.0994008 Vali Loss: 0.1476122 Test Loss: 0.2180458
Validation loss decreased (0.148581 --> 0.147612).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 21 cost time: 0.9603753089904785
Epoch: 21, Steps: 64 | Train Loss: 0.0990813 Vali Loss: 0.1481249 Test Loss: 0.2173424
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 22 cost time: 0.9563701152801514
Epoch: 22, Steps: 64 | Train Loss: 0.0987125 Vali Loss: 0.1475593 Test Loss: 0.2171576
Validation loss decreased (0.147612 --> 0.147559).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 23 cost time: 0.964404821395874
Epoch: 23, Steps: 64 | Train Loss: 0.0989729 Vali Loss: 0.1480033 Test Loss: 0.2179406
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 24 cost time: 0.9655201435089111
Epoch: 24, Steps: 64 | Train Loss: 0.0984449 Vali Loss: 0.1479968 Test Loss: 0.2185370
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 25 cost time: 0.9669992923736572
Epoch: 25, Steps: 64 | Train Loss: 0.0977200 Vali Loss: 0.1470708 Test Loss: 0.2174989
Validation loss decreased (0.147559 --> 0.147071).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 26 cost time: 0.9650001525878906
Epoch: 26, Steps: 64 | Train Loss: 0.0982094 Vali Loss: 0.1470238 Test Loss: 0.2175368
Validation loss decreased (0.147071 --> 0.147024).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 27 cost time: 0.9566197395324707
Epoch: 27, Steps: 64 | Train Loss: 0.0982547 Vali Loss: 0.1484534 Test Loss: 0.2173999
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 28 cost time: 0.9676263332366943
Epoch: 28, Steps: 64 | Train Loss: 0.0982451 Vali Loss: 0.1464003 Test Loss: 0.2174984
Validation loss decreased (0.147024 --> 0.146400).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 29 cost time: 0.9613690376281738
Epoch: 29, Steps: 64 | Train Loss: 0.0977087 Vali Loss: 0.1470588 Test Loss: 0.2176813
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 30 cost time: 0.9563841819763184
Epoch: 30, Steps: 64 | Train Loss: 0.0978293 Vali Loss: 0.1466748 Test Loss: 0.2181109
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 31 cost time: 0.9613587856292725
Epoch: 31, Steps: 64 | Train Loss: 0.0975323 Vali Loss: 0.1453571 Test Loss: 0.2179463
Validation loss decreased (0.146400 --> 0.145357).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 32 cost time: 0.9619841575622559
Epoch: 32, Steps: 64 | Train Loss: 0.0973296 Vali Loss: 0.1460715 Test Loss: 0.2179449
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 33 cost time: 0.9753580093383789
Epoch: 33, Steps: 64 | Train Loss: 0.0973464 Vali Loss: 0.1469231 Test Loss: 0.2181863
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 34 cost time: 0.9633758068084717
Epoch: 34, Steps: 64 | Train Loss: 0.0974592 Vali Loss: 0.1467469 Test Loss: 0.2183177
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 35 cost time: 0.9623854160308838
Epoch: 35, Steps: 64 | Train Loss: 0.0971881 Vali Loss: 0.1464959 Test Loss: 0.2178407
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 36 cost time: 0.9803786277770996
Epoch: 36, Steps: 64 | Train Loss: 0.0971158 Vali Loss: 0.1437410 Test Loss: 0.2179849
Validation loss decreased (0.145357 --> 0.143741).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 37 cost time: 0.9870419502258301
Epoch: 37, Steps: 64 | Train Loss: 0.0977636 Vali Loss: 0.1470678 Test Loss: 0.2182076
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 38 cost time: 0.9609999656677246
Epoch: 38, Steps: 64 | Train Loss: 0.0973550 Vali Loss: 0.1449025 Test Loss: 0.2181749
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 39 cost time: 0.9570000171661377
Epoch: 39, Steps: 64 | Train Loss: 0.0975231 Vali Loss: 0.1455074 Test Loss: 0.2183639
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 40 cost time: 0.9576060771942139
Epoch: 40, Steps: 64 | Train Loss: 0.0970068 Vali Loss: 0.1456372 Test Loss: 0.2183051
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 41 cost time: 0.9594497680664062
Epoch: 41, Steps: 64 | Train Loss: 0.0976322 Vali Loss: 0.1461250 Test Loss: 0.2183663
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 42 cost time: 0.9604434967041016
Epoch: 42, Steps: 64 | Train Loss: 0.0970226 Vali Loss: 0.1451657 Test Loss: 0.2182349
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 43 cost time: 0.9743843078613281
Epoch: 43, Steps: 64 | Train Loss: 0.0967574 Vali Loss: 0.1437382 Test Loss: 0.2183531
Validation loss decreased (0.143741 --> 0.143738).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 44 cost time: 0.9640262126922607
Epoch: 44, Steps: 64 | Train Loss: 0.0969365 Vali Loss: 0.1460961 Test Loss: 0.2177891
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 45 cost time: 0.9573395252227783
Epoch: 45, Steps: 64 | Train Loss: 0.0971717 Vali Loss: 0.1452835 Test Loss: 0.2179448
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 46 cost time: 0.9664056301116943
Epoch: 46, Steps: 64 | Train Loss: 0.0968786 Vali Loss: 0.1453194 Test Loss: 0.2178833
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 47 cost time: 0.9547972679138184
Epoch: 47, Steps: 64 | Train Loss: 0.0971362 Vali Loss: 0.1455347 Test Loss: 0.2179901
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 48 cost time: 0.9563877582550049
Epoch: 48, Steps: 64 | Train Loss: 0.0971726 Vali Loss: 0.1444388 Test Loss: 0.2180626
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 49 cost time: 0.9589998722076416
Epoch: 49, Steps: 64 | Train Loss: 0.0970233 Vali Loss: 0.1454068 Test Loss: 0.2180271
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 50 cost time: 0.9579999446868896
Epoch: 50, Steps: 64 | Train Loss: 0.0967288 Vali Loss: 0.1453142 Test Loss: 0.2180155
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 51 cost time: 0.9614729881286621
Epoch: 51, Steps: 64 | Train Loss: 0.0967063 Vali Loss: 0.1452119 Test Loss: 0.2179981
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 52 cost time: 0.9646129608154297
Epoch: 52, Steps: 64 | Train Loss: 0.0967126 Vali Loss: 0.1431456 Test Loss: 0.2185459
Validation loss decreased (0.143738 --> 0.143146).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 53 cost time: 0.9592514038085938
Epoch: 53, Steps: 64 | Train Loss: 0.0964881 Vali Loss: 0.1451052 Test Loss: 0.2184778
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 54 cost time: 0.9524431228637695
Epoch: 54, Steps: 64 | Train Loss: 0.0964854 Vali Loss: 0.1452576 Test Loss: 0.2188612
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 55 cost time: 0.9513473510742188
Epoch: 55, Steps: 64 | Train Loss: 0.0968342 Vali Loss: 0.1445721 Test Loss: 0.2181145
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 56 cost time: 0.9681963920593262
Epoch: 56, Steps: 64 | Train Loss: 0.0974932 Vali Loss: 0.1437986 Test Loss: 0.2185327
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 57 cost time: 0.9623889923095703
Epoch: 57, Steps: 64 | Train Loss: 0.0962459 Vali Loss: 0.1463550 Test Loss: 0.2181384
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 58 cost time: 0.956028938293457
Epoch: 58, Steps: 64 | Train Loss: 0.0970442 Vali Loss: 0.1457156 Test Loss: 0.2177323
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 59 cost time: 0.9687442779541016
Epoch: 59, Steps: 64 | Train Loss: 0.0969597 Vali Loss: 0.1453911 Test Loss: 0.2181157
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 60 cost time: 0.9631729125976562
Epoch: 60, Steps: 64 | Train Loss: 0.0964651 Vali Loss: 0.1451145 Test Loss: 0.2182520
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.21854591369628906, mae:0.32049989700317383, rse:0.23692205548286438
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06551265716552734 GB
Epoch: 1 cost time: 2.177149772644043
Epoch: 1, Steps: 64 | Train Loss: 0.9368413 Vali Loss: 2.3929827 Test Loss: 3.8278193
Validation loss decreased (inf --> 2.392983).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 2 cost time: 0.8566164970397949
Epoch: 2, Steps: 64 | Train Loss: 0.6962092 Vali Loss: 1.1309533 Test Loss: 1.7329036
Validation loss decreased (2.392983 --> 1.130953).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 3 cost time: 0.8589324951171875
Epoch: 3, Steps: 64 | Train Loss: 0.3825204 Vali Loss: 0.5456632 Test Loss: 0.7765786
Validation loss decreased (1.130953 --> 0.545663).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 4 cost time: 0.8573367595672607
Epoch: 4, Steps: 64 | Train Loss: 0.2341187 Vali Loss: 0.3311907 Test Loss: 0.4458608
Validation loss decreased (0.545663 --> 0.331191).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 5 cost time: 0.8543391227722168
Epoch: 5, Steps: 64 | Train Loss: 0.1740762 Vali Loss: 0.2456232 Test Loss: 0.3213984
Validation loss decreased (0.331191 --> 0.245623).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 6 cost time: 0.8536233901977539
Epoch: 6, Steps: 64 | Train Loss: 0.1494623 Vali Loss: 0.2097730 Test Loss: 0.2703207
Validation loss decreased (0.245623 --> 0.209773).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 7 cost time: 0.8536169528961182
Epoch: 7, Steps: 64 | Train Loss: 0.1386653 Vali Loss: 0.1890194 Test Loss: 0.2455503
Validation loss decreased (0.209773 --> 0.189019).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 8 cost time: 0.8533697128295898
Epoch: 8, Steps: 64 | Train Loss: 0.1323509 Vali Loss: 0.1827755 Test Loss: 0.2353641
Validation loss decreased (0.189019 --> 0.182776).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 9 cost time: 0.8524260520935059
Epoch: 9, Steps: 64 | Train Loss: 0.1290996 Vali Loss: 0.1772143 Test Loss: 0.2302266
Validation loss decreased (0.182776 --> 0.177214).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 10 cost time: 0.8713881969451904
Epoch: 10, Steps: 64 | Train Loss: 0.1257326 Vali Loss: 0.1737995 Test Loss: 0.2282260
Validation loss decreased (0.177214 --> 0.173799).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 11 cost time: 0.8550000190734863
Epoch: 11, Steps: 64 | Train Loss: 0.1241011 Vali Loss: 0.1702853 Test Loss: 0.2249469
Validation loss decreased (0.173799 --> 0.170285).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 12 cost time: 0.854621171951294
Epoch: 12, Steps: 64 | Train Loss: 0.1214095 Vali Loss: 0.1702374 Test Loss: 0.2236387
Validation loss decreased (0.170285 --> 0.170237).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 13 cost time: 0.8545000553131104
Epoch: 13, Steps: 64 | Train Loss: 0.1200847 Vali Loss: 0.1664265 Test Loss: 0.2224382
Validation loss decreased (0.170237 --> 0.166426).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 14 cost time: 0.8653640747070312
Epoch: 14, Steps: 64 | Train Loss: 0.1192010 Vali Loss: 0.1658742 Test Loss: 0.2229841
Validation loss decreased (0.166426 --> 0.165874).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 15 cost time: 0.853989839553833
Epoch: 15, Steps: 64 | Train Loss: 0.1176771 Vali Loss: 0.1631849 Test Loss: 0.2224707
Validation loss decreased (0.165874 --> 0.163185).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 16 cost time: 0.8539998531341553
Epoch: 16, Steps: 64 | Train Loss: 0.1169026 Vali Loss: 0.1628929 Test Loss: 0.2212773
Validation loss decreased (0.163185 --> 0.162893).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 17 cost time: 0.8510003089904785
Epoch: 17, Steps: 64 | Train Loss: 0.1162003 Vali Loss: 0.1622811 Test Loss: 0.2221026
Validation loss decreased (0.162893 --> 0.162281).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 18 cost time: 0.8563601970672607
Epoch: 18, Steps: 64 | Train Loss: 0.1153865 Vali Loss: 0.1604559 Test Loss: 0.2214743
Validation loss decreased (0.162281 --> 0.160456).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 19 cost time: 0.856576681137085
Epoch: 19, Steps: 64 | Train Loss: 0.1147480 Vali Loss: 0.1615790 Test Loss: 0.2218867
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 20 cost time: 0.853365421295166
Epoch: 20, Steps: 64 | Train Loss: 0.1142556 Vali Loss: 0.1587189 Test Loss: 0.2217681
Validation loss decreased (0.160456 --> 0.158719).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 21 cost time: 0.8637113571166992
Epoch: 21, Steps: 64 | Train Loss: 0.1136014 Vali Loss: 0.1598950 Test Loss: 0.2211174
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 22 cost time: 0.8559999465942383
Epoch: 22, Steps: 64 | Train Loss: 0.1135068 Vali Loss: 0.1612059 Test Loss: 0.2220204
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 23 cost time: 0.8546123504638672
Epoch: 23, Steps: 64 | Train Loss: 0.1129896 Vali Loss: 0.1575855 Test Loss: 0.2216350
Validation loss decreased (0.158719 --> 0.157586).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 24 cost time: 0.8522357940673828
Epoch: 24, Steps: 64 | Train Loss: 0.1123358 Vali Loss: 0.1581863 Test Loss: 0.2217320
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 25 cost time: 0.8436791896820068
Epoch: 25, Steps: 64 | Train Loss: 0.1126535 Vali Loss: 0.1579552 Test Loss: 0.2219722
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 26 cost time: 0.8267238140106201
Epoch: 26, Steps: 64 | Train Loss: 0.1122415 Vali Loss: 0.1582220 Test Loss: 0.2215819
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 27 cost time: 0.8495361804962158
Epoch: 27, Steps: 64 | Train Loss: 0.1117243 Vali Loss: 0.1575329 Test Loss: 0.2214306
Validation loss decreased (0.157586 --> 0.157533).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 28 cost time: 0.8501665592193604
Epoch: 28, Steps: 64 | Train Loss: 0.1118910 Vali Loss: 0.1582776 Test Loss: 0.2213299
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 29 cost time: 0.8633675575256348
Epoch: 29, Steps: 64 | Train Loss: 0.1115728 Vali Loss: 0.1574441 Test Loss: 0.2215379
Validation loss decreased (0.157533 --> 0.157444).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 30 cost time: 0.8533589839935303
Epoch: 30, Steps: 64 | Train Loss: 0.1110347 Vali Loss: 0.1571375 Test Loss: 0.2216304
Validation loss decreased (0.157444 --> 0.157137).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 31 cost time: 0.8592398166656494
Epoch: 31, Steps: 64 | Train Loss: 0.1113525 Vali Loss: 0.1564305 Test Loss: 0.2217483
Validation loss decreased (0.157137 --> 0.156430).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 32 cost time: 0.8540005683898926
Epoch: 32, Steps: 64 | Train Loss: 0.1107769 Vali Loss: 0.1555597 Test Loss: 0.2221573
Validation loss decreased (0.156430 --> 0.155560).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 33 cost time: 0.8372542858123779
Epoch: 33, Steps: 64 | Train Loss: 0.1106219 Vali Loss: 0.1546582 Test Loss: 0.2216566
Validation loss decreased (0.155560 --> 0.154658).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 34 cost time: 0.8523569107055664
Epoch: 34, Steps: 64 | Train Loss: 0.1106981 Vali Loss: 0.1551223 Test Loss: 0.2213689
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 35 cost time: 0.8543572425842285
Epoch: 35, Steps: 64 | Train Loss: 0.1104235 Vali Loss: 0.1531939 Test Loss: 0.2217493
Validation loss decreased (0.154658 --> 0.153194).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 36 cost time: 0.8647546768188477
Epoch: 36, Steps: 64 | Train Loss: 0.1104977 Vali Loss: 0.1554415 Test Loss: 0.2214097
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 37 cost time: 0.8537209033966064
Epoch: 37, Steps: 64 | Train Loss: 0.1112187 Vali Loss: 0.1556224 Test Loss: 0.2213929
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 38 cost time: 0.8539187908172607
Epoch: 38, Steps: 64 | Train Loss: 0.1108196 Vali Loss: 0.1561123 Test Loss: 0.2220554
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 39 cost time: 0.8568096160888672
Epoch: 39, Steps: 64 | Train Loss: 0.1108454 Vali Loss: 0.1566787 Test Loss: 0.2214011
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 40 cost time: 0.8664143085479736
Epoch: 40, Steps: 64 | Train Loss: 0.1105841 Vali Loss: 0.1562243 Test Loss: 0.2215705
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 41 cost time: 0.8574507236480713
Epoch: 41, Steps: 64 | Train Loss: 0.1103208 Vali Loss: 0.1542297 Test Loss: 0.2220716
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 42 cost time: 0.8564677238464355
Epoch: 42, Steps: 64 | Train Loss: 0.1104529 Vali Loss: 0.1549326 Test Loss: 0.2215976
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 43 cost time: 0.8556153774261475
Epoch: 43, Steps: 64 | Train Loss: 0.1100550 Vali Loss: 0.1555389 Test Loss: 0.2215420
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 44 cost time: 0.8593540191650391
Epoch: 44, Steps: 64 | Train Loss: 0.1098153 Vali Loss: 0.1551622 Test Loss: 0.2216455
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 45 cost time: 0.8514060974121094
Epoch: 45, Steps: 64 | Train Loss: 0.1099811 Vali Loss: 0.1549195 Test Loss: 0.2216667
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 46 cost time: 0.8558032512664795
Epoch: 46, Steps: 64 | Train Loss: 0.1094663 Vali Loss: 0.1538524 Test Loss: 0.2214873
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 47 cost time: 0.8636307716369629
Epoch: 47, Steps: 64 | Train Loss: 0.1097171 Vali Loss: 0.1541759 Test Loss: 0.2216367
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 48 cost time: 0.8546199798583984
Epoch: 48, Steps: 64 | Train Loss: 0.1100516 Vali Loss: 0.1570318 Test Loss: 0.2217270
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 49 cost time: 0.8564453125
Epoch: 49, Steps: 64 | Train Loss: 0.1094591 Vali Loss: 0.1545695 Test Loss: 0.2215277
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 50 cost time: 0.8603823184967041
Epoch: 50, Steps: 64 | Train Loss: 0.1100796 Vali Loss: 0.1539277 Test Loss: 0.2215945
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 51 cost time: 0.8607890605926514
Epoch: 51, Steps: 64 | Train Loss: 0.1099957 Vali Loss: 0.1560871 Test Loss: 0.2216910
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 52 cost time: 0.8400001525878906
Epoch: 52, Steps: 64 | Train Loss: 0.1096720 Vali Loss: 0.1547289 Test Loss: 0.2216940
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 53 cost time: 0.8536355495452881
Epoch: 53, Steps: 64 | Train Loss: 0.1100775 Vali Loss: 0.1564439 Test Loss: 0.2217159
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 54 cost time: 0.8513786792755127
Epoch: 54, Steps: 64 | Train Loss: 0.1098716 Vali Loss: 0.1536827 Test Loss: 0.2215499
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 55 cost time: 0.8403549194335938
Epoch: 55, Steps: 64 | Train Loss: 0.1101117 Vali Loss: 0.1549396 Test Loss: 0.2216701
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 56 cost time: 0.8381714820861816
Epoch: 56, Steps: 64 | Train Loss: 0.1096983 Vali Loss: 0.1545048 Test Loss: 0.2216095
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 57 cost time: 0.8563940525054932
Epoch: 57, Steps: 64 | Train Loss: 0.1099167 Vali Loss: 0.1541714 Test Loss: 0.2219968
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 58 cost time: 0.8556118011474609
Epoch: 58, Steps: 64 | Train Loss: 0.1101692 Vali Loss: 0.1556413 Test Loss: 0.2217488
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 59 cost time: 0.8654420375823975
Epoch: 59, Steps: 64 | Train Loss: 0.1100731 Vali Loss: 0.1539784 Test Loss: 0.2215678
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 60 cost time: 0.8524050712585449
Epoch: 60, Steps: 64 | Train Loss: 0.1093185 Vali Loss: 0.1564884 Test Loss: 0.2216599
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22174929082393646, mae:0.3227168023586273, rse:0.2386520951986313
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.06978511810302734 GB
Epoch: 1 cost time: 2.219259738922119
Epoch: 1, Steps: 64 | Train Loss: 0.8434055 Vali Loss: 2.2179334 Test Loss: 3.4730392
Validation loss decreased (inf --> 2.217933).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 2 cost time: 0.8946413993835449
Epoch: 2, Steps: 64 | Train Loss: 0.3782255 Vali Loss: 0.2309354 Test Loss: 0.2636640
Validation loss decreased (2.217933 --> 0.230935).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 3 cost time: 0.8866250514984131
Epoch: 3, Steps: 64 | Train Loss: 0.1374615 Vali Loss: 0.1885514 Test Loss: 0.2356104
Validation loss decreased (0.230935 --> 0.188551).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 4 cost time: 0.8834688663482666
Epoch: 4, Steps: 64 | Train Loss: 0.1243933 Vali Loss: 0.1756718 Test Loss: 0.2237845
Validation loss decreased (0.188551 --> 0.175672).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 5 cost time: 0.8882529735565186
Epoch: 5, Steps: 64 | Train Loss: 0.1194196 Vali Loss: 0.1737065 Test Loss: 0.2257316
Validation loss decreased (0.175672 --> 0.173707).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 6 cost time: 0.8850483894348145
Epoch: 6, Steps: 64 | Train Loss: 0.1164040 Vali Loss: 0.1696759 Test Loss: 0.2217675
Validation loss decreased (0.173707 --> 0.169676).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 7 cost time: 0.8793656826019287
Epoch: 7, Steps: 64 | Train Loss: 0.1132797 Vali Loss: 0.1673413 Test Loss: 0.2208657
Validation loss decreased (0.169676 --> 0.167341).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 8 cost time: 0.8808953762054443
Epoch: 8, Steps: 64 | Train Loss: 0.1115619 Vali Loss: 0.1630971 Test Loss: 0.2205148
Validation loss decreased (0.167341 --> 0.163097).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 9 cost time: 0.9209990501403809
Epoch: 9, Steps: 64 | Train Loss: 0.1099808 Vali Loss: 0.1599008 Test Loss: 0.2206012
Validation loss decreased (0.163097 --> 0.159901).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 10 cost time: 0.9182329177856445
Epoch: 10, Steps: 64 | Train Loss: 0.1087476 Vali Loss: 0.1603269 Test Loss: 0.2205376
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 11 cost time: 0.8844349384307861
Epoch: 11, Steps: 64 | Train Loss: 0.1079514 Vali Loss: 0.1604094 Test Loss: 0.2218759
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 12 cost time: 0.8880002498626709
Epoch: 12, Steps: 64 | Train Loss: 0.1069237 Vali Loss: 0.1568038 Test Loss: 0.2211796
Validation loss decreased (0.159901 --> 0.156804).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 13 cost time: 0.8999006748199463
Epoch: 13, Steps: 64 | Train Loss: 0.1060251 Vali Loss: 0.1558917 Test Loss: 0.2213301
Validation loss decreased (0.156804 --> 0.155892).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 14 cost time: 0.8827865123748779
Epoch: 14, Steps: 64 | Train Loss: 0.1054663 Vali Loss: 0.1556755 Test Loss: 0.2210437
Validation loss decreased (0.155892 --> 0.155675).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 15 cost time: 0.880000114440918
Epoch: 15, Steps: 64 | Train Loss: 0.1049637 Vali Loss: 0.1557020 Test Loss: 0.2206410
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 16 cost time: 0.8856279850006104
Epoch: 16, Steps: 64 | Train Loss: 0.1042388 Vali Loss: 0.1544657 Test Loss: 0.2212976
Validation loss decreased (0.155675 --> 0.154466).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 17 cost time: 0.8863928318023682
Epoch: 17, Steps: 64 | Train Loss: 0.1030279 Vali Loss: 0.1539061 Test Loss: 0.2205724
Validation loss decreased (0.154466 --> 0.153906).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 18 cost time: 0.8794665336608887
Epoch: 18, Steps: 64 | Train Loss: 0.1033291 Vali Loss: 0.1546222 Test Loss: 0.2215955
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 19 cost time: 0.8809590339660645
Epoch: 19, Steps: 64 | Train Loss: 0.1023391 Vali Loss: 0.1516261 Test Loss: 0.2207503
Validation loss decreased (0.153906 --> 0.151626).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 20 cost time: 0.9027929306030273
Epoch: 20, Steps: 64 | Train Loss: 0.1026490 Vali Loss: 0.1531196 Test Loss: 0.2216966
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 21 cost time: 0.887000322341919
Epoch: 21, Steps: 64 | Train Loss: 0.1022695 Vali Loss: 0.1528521 Test Loss: 0.2209785
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 22 cost time: 0.8866260051727295
Epoch: 22, Steps: 64 | Train Loss: 0.1017354 Vali Loss: 0.1531631 Test Loss: 0.2211821
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 23 cost time: 0.8818199634552002
Epoch: 23, Steps: 64 | Train Loss: 0.1020259 Vali Loss: 0.1521355 Test Loss: 0.2217247
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 24 cost time: 0.8753840923309326
Epoch: 24, Steps: 64 | Train Loss: 0.1014128 Vali Loss: 0.1515667 Test Loss: 0.2214922
Validation loss decreased (0.151626 --> 0.151567).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 25 cost time: 0.9014987945556641
Epoch: 25, Steps: 64 | Train Loss: 0.1015191 Vali Loss: 0.1524607 Test Loss: 0.2209881
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 26 cost time: 0.8799676895141602
Epoch: 26, Steps: 64 | Train Loss: 0.1013868 Vali Loss: 0.1507202 Test Loss: 0.2208664
Validation loss decreased (0.151567 --> 0.150720).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 27 cost time: 0.8807988166809082
Epoch: 27, Steps: 64 | Train Loss: 0.1010529 Vali Loss: 0.1530594 Test Loss: 0.2214785
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 28 cost time: 0.8846235275268555
Epoch: 28, Steps: 64 | Train Loss: 0.1010011 Vali Loss: 0.1499704 Test Loss: 0.2209120
Validation loss decreased (0.150720 --> 0.149970).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 29 cost time: 0.8865706920623779
Epoch: 29, Steps: 64 | Train Loss: 0.1006541 Vali Loss: 0.1532200 Test Loss: 0.2209432
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 30 cost time: 0.8899736404418945
Epoch: 30, Steps: 64 | Train Loss: 0.1003707 Vali Loss: 0.1515529 Test Loss: 0.2216860
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 31 cost time: 0.884392261505127
Epoch: 31, Steps: 64 | Train Loss: 0.1004103 Vali Loss: 0.1518632 Test Loss: 0.2216929
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 32 cost time: 0.9318609237670898
Epoch: 32, Steps: 64 | Train Loss: 0.1001477 Vali Loss: 0.1500694 Test Loss: 0.2215358
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 33 cost time: 0.8787367343902588
Epoch: 33, Steps: 64 | Train Loss: 0.1002796 Vali Loss: 0.1510219 Test Loss: 0.2217236
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 34 cost time: 0.8940000534057617
Epoch: 34, Steps: 64 | Train Loss: 0.1001001 Vali Loss: 0.1507961 Test Loss: 0.2213616
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 35 cost time: 0.8826141357421875
Epoch: 35, Steps: 64 | Train Loss: 0.1005653 Vali Loss: 0.1516326 Test Loss: 0.2216780
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 36 cost time: 0.8847579956054688
Epoch: 36, Steps: 64 | Train Loss: 0.1000542 Vali Loss: 0.1501807 Test Loss: 0.2220394
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 37 cost time: 0.88641357421875
Epoch: 37, Steps: 64 | Train Loss: 0.1002165 Vali Loss: 0.1509704 Test Loss: 0.2217427
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 38 cost time: 0.8974318504333496
Epoch: 38, Steps: 64 | Train Loss: 0.1002158 Vali Loss: 0.1515553 Test Loss: 0.2215707
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 39 cost time: 0.8848388195037842
Epoch: 39, Steps: 64 | Train Loss: 0.0995841 Vali Loss: 0.1517404 Test Loss: 0.2217057
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 40 cost time: 0.8819997310638428
Epoch: 40, Steps: 64 | Train Loss: 0.0998720 Vali Loss: 0.1506646 Test Loss: 0.2213012
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 41 cost time: 0.8836183547973633
Epoch: 41, Steps: 64 | Train Loss: 0.1003265 Vali Loss: 0.1500243 Test Loss: 0.2215997
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 42 cost time: 0.8858287334442139
Epoch: 42, Steps: 64 | Train Loss: 0.0996160 Vali Loss: 0.1489514 Test Loss: 0.2215865
Validation loss decreased (0.149970 --> 0.148951).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 43 cost time: 0.8883497714996338
Epoch: 43, Steps: 64 | Train Loss: 0.0997690 Vali Loss: 0.1499946 Test Loss: 0.2214740
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 44 cost time: 0.8853805065155029
Epoch: 44, Steps: 64 | Train Loss: 0.0996037 Vali Loss: 0.1518189 Test Loss: 0.2213527
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 45 cost time: 0.8868465423583984
Epoch: 45, Steps: 64 | Train Loss: 0.0996586 Vali Loss: 0.1489253 Test Loss: 0.2212365
Validation loss decreased (0.148951 --> 0.148925).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 46 cost time: 0.8869998455047607
Epoch: 46, Steps: 64 | Train Loss: 0.0996583 Vali Loss: 0.1502312 Test Loss: 0.2215397
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 47 cost time: 0.8856191635131836
Epoch: 47, Steps: 64 | Train Loss: 0.0998337 Vali Loss: 0.1506858 Test Loss: 0.2215819
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 48 cost time: 0.8914580345153809
Epoch: 48, Steps: 64 | Train Loss: 0.0996199 Vali Loss: 0.1513586 Test Loss: 0.2217135
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 49 cost time: 0.8954901695251465
Epoch: 49, Steps: 64 | Train Loss: 0.0991278 Vali Loss: 0.1506814 Test Loss: 0.2214514
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 50 cost time: 0.887739896774292
Epoch: 50, Steps: 64 | Train Loss: 0.0997322 Vali Loss: 0.1497963 Test Loss: 0.2214453
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 51 cost time: 0.8857429027557373
Epoch: 51, Steps: 64 | Train Loss: 0.0996215 Vali Loss: 0.1514211 Test Loss: 0.2213486
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 52 cost time: 0.8880002498626709
Epoch: 52, Steps: 64 | Train Loss: 0.0996099 Vali Loss: 0.1512684 Test Loss: 0.2213922
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 53 cost time: 0.8886263370513916
Epoch: 53, Steps: 64 | Train Loss: 0.0996805 Vali Loss: 0.1511854 Test Loss: 0.2216651
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 54 cost time: 0.8883960247039795
Epoch: 54, Steps: 64 | Train Loss: 0.0992156 Vali Loss: 0.1509743 Test Loss: 0.2214236
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 55 cost time: 0.8868508338928223
Epoch: 55, Steps: 64 | Train Loss: 0.0988861 Vali Loss: 0.1506147 Test Loss: 0.2216529
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 56 cost time: 0.8953759670257568
Epoch: 56, Steps: 64 | Train Loss: 0.0997550 Vali Loss: 0.1526283 Test Loss: 0.2216799
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 57 cost time: 0.8857731819152832
Epoch: 57, Steps: 64 | Train Loss: 0.0997204 Vali Loss: 0.1506744 Test Loss: 0.2215454
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 58 cost time: 0.8899996280670166
Epoch: 58, Steps: 64 | Train Loss: 0.0995543 Vali Loss: 0.1499434 Test Loss: 0.2215540
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 59 cost time: 0.8880658149719238
Epoch: 59, Steps: 64 | Train Loss: 0.0994121 Vali Loss: 0.1502156 Test Loss: 0.2215848
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 60 cost time: 0.883350133895874
Epoch: 60, Steps: 64 | Train Loss: 0.0993201 Vali Loss: 0.1506744 Test Loss: 0.2213026
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22123649716377258, mae:0.3267243206501007, rse:0.23837599158287048
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.07290077209472656 GB
Epoch: 1 cost time: 2.1836910247802734
Epoch: 1, Steps: 64 | Train Loss: 0.8560238 Vali Loss: 2.2834098 Test Loss: 3.6199958
Validation loss decreased (inf --> 2.283410).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 2 cost time: 0.8518919944763184
Epoch: 2, Steps: 64 | Train Loss: 0.3533775 Vali Loss: 0.2646492 Test Loss: 0.3514146
Validation loss decreased (2.283410 --> 0.264649).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 3 cost time: 0.8644371032714844
Epoch: 3, Steps: 64 | Train Loss: 0.1323103 Vali Loss: 0.1784235 Test Loss: 0.2218751
Validation loss decreased (0.264649 --> 0.178423).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 4 cost time: 0.8526327610015869
Epoch: 4, Steps: 64 | Train Loss: 0.1204345 Vali Loss: 0.1687281 Test Loss: 0.2264077
Validation loss decreased (0.178423 --> 0.168728).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 5 cost time: 0.8579995632171631
Epoch: 5, Steps: 64 | Train Loss: 0.1159985 Vali Loss: 0.1662210 Test Loss: 0.2213712
Validation loss decreased (0.168728 --> 0.166221).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 6 cost time: 0.8522439002990723
Epoch: 6, Steps: 64 | Train Loss: 0.1127758 Vali Loss: 0.1625084 Test Loss: 0.2193807
Validation loss decreased (0.166221 --> 0.162508).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 7 cost time: 0.8573622703552246
Epoch: 7, Steps: 64 | Train Loss: 0.1100291 Vali Loss: 0.1613186 Test Loss: 0.2195937
Validation loss decreased (0.162508 --> 0.161319).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 8 cost time: 0.855736494064331
Epoch: 8, Steps: 64 | Train Loss: 0.1082238 Vali Loss: 0.1578470 Test Loss: 0.2186483
Validation loss decreased (0.161319 --> 0.157847).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 9 cost time: 0.850360631942749
Epoch: 9, Steps: 64 | Train Loss: 0.1069341 Vali Loss: 0.1563381 Test Loss: 0.2183756
Validation loss decreased (0.157847 --> 0.156338).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 10 cost time: 0.8566184043884277
Epoch: 10, Steps: 64 | Train Loss: 0.1058584 Vali Loss: 0.1557603 Test Loss: 0.2188126
Validation loss decreased (0.156338 --> 0.155760).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 11 cost time: 0.8584475517272949
Epoch: 11, Steps: 64 | Train Loss: 0.1046917 Vali Loss: 0.1560784 Test Loss: 0.2199846
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 12 cost time: 0.8504092693328857
Epoch: 12, Steps: 64 | Train Loss: 0.1032496 Vali Loss: 0.1553799 Test Loss: 0.2185553
Validation loss decreased (0.155760 --> 0.155380).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 13 cost time: 0.8573505878448486
Epoch: 13, Steps: 64 | Train Loss: 0.1026054 Vali Loss: 0.1544968 Test Loss: 0.2189505
Validation loss decreased (0.155380 --> 0.154497).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 14 cost time: 0.8657560348510742
Epoch: 14, Steps: 64 | Train Loss: 0.1017213 Vali Loss: 0.1521868 Test Loss: 0.2178702
Validation loss decreased (0.154497 --> 0.152187).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 15 cost time: 0.8519999980926514
Epoch: 15, Steps: 64 | Train Loss: 0.1013676 Vali Loss: 0.1514479 Test Loss: 0.2178874
Validation loss decreased (0.152187 --> 0.151448).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 16 cost time: 0.8536210060119629
Epoch: 16, Steps: 64 | Train Loss: 0.1003383 Vali Loss: 0.1530992 Test Loss: 0.2194958
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 17 cost time: 0.8572535514831543
Epoch: 17, Steps: 64 | Train Loss: 0.0997224 Vali Loss: 0.1507166 Test Loss: 0.2181923
Validation loss decreased (0.151448 --> 0.150717).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 18 cost time: 0.8811743259429932
Epoch: 18, Steps: 64 | Train Loss: 0.0993826 Vali Loss: 0.1521020 Test Loss: 0.2191091
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 19 cost time: 0.871819257736206
Epoch: 19, Steps: 64 | Train Loss: 0.0991879 Vali Loss: 0.1514163 Test Loss: 0.2184900
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 20 cost time: 0.8680002689361572
Epoch: 20, Steps: 64 | Train Loss: 0.0990561 Vali Loss: 0.1503350 Test Loss: 0.2185720
Validation loss decreased (0.150717 --> 0.150335).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 21 cost time: 0.8815979957580566
Epoch: 21, Steps: 64 | Train Loss: 0.0988070 Vali Loss: 0.1515734 Test Loss: 0.2194777
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 22 cost time: 0.8803410530090332
Epoch: 22, Steps: 64 | Train Loss: 0.0980395 Vali Loss: 0.1511802 Test Loss: 0.2193348
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 23 cost time: 0.8664157390594482
Epoch: 23, Steps: 64 | Train Loss: 0.0983423 Vali Loss: 0.1518248 Test Loss: 0.2195803
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 24 cost time: 0.8604099750518799
Epoch: 24, Steps: 64 | Train Loss: 0.0975249 Vali Loss: 0.1496067 Test Loss: 0.2188330
Validation loss decreased (0.150335 --> 0.149607).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 25 cost time: 0.8520739078521729
Epoch: 25, Steps: 64 | Train Loss: 0.0979598 Vali Loss: 0.1490670 Test Loss: 0.2195598
Validation loss decreased (0.149607 --> 0.149067).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 26 cost time: 0.8519151210784912
Epoch: 26, Steps: 64 | Train Loss: 0.0976734 Vali Loss: 0.1483649 Test Loss: 0.2191062
Validation loss decreased (0.149067 --> 0.148365).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 27 cost time: 0.8522341251373291
Epoch: 27, Steps: 64 | Train Loss: 0.0977753 Vali Loss: 0.1524549 Test Loss: 0.2192192
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 28 cost time: 0.8513617515563965
Epoch: 28, Steps: 64 | Train Loss: 0.0974784 Vali Loss: 0.1499524 Test Loss: 0.2192529
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 29 cost time: 0.8378212451934814
Epoch: 29, Steps: 64 | Train Loss: 0.0970793 Vali Loss: 0.1513068 Test Loss: 0.2192137
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 30 cost time: 0.8513171672821045
Epoch: 30, Steps: 64 | Train Loss: 0.0971443 Vali Loss: 0.1499670 Test Loss: 0.2192913
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 31 cost time: 0.8557314872741699
Epoch: 31, Steps: 64 | Train Loss: 0.0969592 Vali Loss: 0.1496226 Test Loss: 0.2191879
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 32 cost time: 0.8706164360046387
Epoch: 32, Steps: 64 | Train Loss: 0.0965170 Vali Loss: 0.1505344 Test Loss: 0.2193512
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 33 cost time: 0.8574109077453613
Epoch: 33, Steps: 64 | Train Loss: 0.0965283 Vali Loss: 0.1502611 Test Loss: 0.2195402
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 34 cost time: 0.8593759536743164
Epoch: 34, Steps: 64 | Train Loss: 0.0970310 Vali Loss: 0.1483688 Test Loss: 0.2195202
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 35 cost time: 0.8554646968841553
Epoch: 35, Steps: 64 | Train Loss: 0.0964624 Vali Loss: 0.1512549 Test Loss: 0.2197617
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 36 cost time: 0.8475205898284912
Epoch: 36, Steps: 64 | Train Loss: 0.0969002 Vali Loss: 0.1496083 Test Loss: 0.2194253
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 37 cost time: 0.8516197204589844
Epoch: 37, Steps: 64 | Train Loss: 0.0967290 Vali Loss: 0.1496854 Test Loss: 0.2195102
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 38 cost time: 0.8503806591033936
Epoch: 38, Steps: 64 | Train Loss: 0.0964936 Vali Loss: 0.1499374 Test Loss: 0.2193138
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 39 cost time: 0.8534352779388428
Epoch: 39, Steps: 64 | Train Loss: 0.0960548 Vali Loss: 0.1514573 Test Loss: 0.2198649
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 40 cost time: 0.871035099029541
Epoch: 40, Steps: 64 | Train Loss: 0.0965875 Vali Loss: 0.1490977 Test Loss: 0.2196123
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 41 cost time: 0.8537259101867676
Epoch: 41, Steps: 64 | Train Loss: 0.0959143 Vali Loss: 0.1489909 Test Loss: 0.2195091
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 42 cost time: 0.8539998531341553
Epoch: 42, Steps: 64 | Train Loss: 0.0966002 Vali Loss: 0.1482443 Test Loss: 0.2197035
Validation loss decreased (0.148365 --> 0.148244).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 43 cost time: 0.8616251945495605
Epoch: 43, Steps: 64 | Train Loss: 0.0967197 Vali Loss: 0.1502302 Test Loss: 0.2195537
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 44 cost time: 0.8553481101989746
Epoch: 44, Steps: 64 | Train Loss: 0.0965972 Vali Loss: 0.1494782 Test Loss: 0.2195245
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 45 cost time: 0.8533284664154053
Epoch: 45, Steps: 64 | Train Loss: 0.0965126 Vali Loss: 0.1503381 Test Loss: 0.2196523
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 46 cost time: 0.85439133644104
Epoch: 46, Steps: 64 | Train Loss: 0.0962218 Vali Loss: 0.1495711 Test Loss: 0.2198011
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 47 cost time: 0.8722875118255615
Epoch: 47, Steps: 64 | Train Loss: 0.0960704 Vali Loss: 0.1497349 Test Loss: 0.2196675
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 48 cost time: 0.8526289463043213
Epoch: 48, Steps: 64 | Train Loss: 0.0963496 Vali Loss: 0.1496531 Test Loss: 0.2197178
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 49 cost time: 0.8563723564147949
Epoch: 49, Steps: 64 | Train Loss: 0.0963766 Vali Loss: 0.1479036 Test Loss: 0.2197532
Validation loss decreased (0.148244 --> 0.147904).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 50 cost time: 0.8548438549041748
Epoch: 50, Steps: 64 | Train Loss: 0.0958390 Vali Loss: 0.1493796 Test Loss: 0.2196103
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 51 cost time: 0.8497295379638672
Epoch: 51, Steps: 64 | Train Loss: 0.0959980 Vali Loss: 0.1490196 Test Loss: 0.2195683
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 52 cost time: 0.8559999465942383
Epoch: 52, Steps: 64 | Train Loss: 0.0963156 Vali Loss: 0.1493293 Test Loss: 0.2195330
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 53 cost time: 0.8580069541931152
Epoch: 53, Steps: 64 | Train Loss: 0.0965066 Vali Loss: 0.1484988 Test Loss: 0.2197476
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 54 cost time: 0.8524425029754639
Epoch: 54, Steps: 64 | Train Loss: 0.0963230 Vali Loss: 0.1486286 Test Loss: 0.2197374
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 55 cost time: 0.8520081043243408
Epoch: 55, Steps: 64 | Train Loss: 0.0962831 Vali Loss: 0.1485505 Test Loss: 0.2197109
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 56 cost time: 0.8563883304595947
Epoch: 56, Steps: 64 | Train Loss: 0.0961282 Vali Loss: 0.1501651 Test Loss: 0.2195644
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 57 cost time: 0.8537402153015137
Epoch: 57, Steps: 64 | Train Loss: 0.0957210 Vali Loss: 0.1507992 Test Loss: 0.2195464
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 58 cost time: 0.8619999885559082
Epoch: 58, Steps: 64 | Train Loss: 0.0963114 Vali Loss: 0.1487445 Test Loss: 0.2196857
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 59 cost time: 0.8517172336578369
Epoch: 59, Steps: 64 | Train Loss: 0.0961582 Vali Loss: 0.1479800 Test Loss: 0.2199414
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 60 cost time: 0.8551416397094727
Epoch: 60, Steps: 64 | Train Loss: 0.0959768 Vali Loss: 0.1504932 Test Loss: 0.2194300
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.21975325047969818, mae:0.32555779814720154, rse:0.23757557570934296
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.0656743049621582 GB
Epoch: 1 cost time: 2.131185293197632
Epoch: 1, Steps: 64 | Train Loss: 0.9188174 Vali Loss: 2.3702023 Test Loss: 3.6975567
Validation loss decreased (inf --> 2.370202).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 2 cost time: 0.7950012683868408
Epoch: 2, Steps: 64 | Train Loss: 0.6302536 Vali Loss: 0.9360176 Test Loss: 1.3576715
Validation loss decreased (2.370202 --> 0.936018).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 3 cost time: 0.8066165447235107
Epoch: 3, Steps: 64 | Train Loss: 0.3331464 Vali Loss: 0.5065041 Test Loss: 0.6821706
Validation loss decreased (0.936018 --> 0.506504).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 4 cost time: 0.8093593120574951
Epoch: 4, Steps: 64 | Train Loss: 0.2167162 Vali Loss: 0.3337299 Test Loss: 0.4373738
Validation loss decreased (0.506504 --> 0.333730).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 5 cost time: 0.8064048290252686
Epoch: 5, Steps: 64 | Train Loss: 0.1669856 Vali Loss: 0.2522767 Test Loss: 0.3230208
Validation loss decreased (0.333730 --> 0.252277).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 6 cost time: 0.8135943412780762
Epoch: 6, Steps: 64 | Train Loss: 0.1462114 Vali Loss: 0.2150682 Test Loss: 0.2739525
Validation loss decreased (0.252277 --> 0.215068).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 7 cost time: 0.8089990615844727
Epoch: 7, Steps: 64 | Train Loss: 0.1363146 Vali Loss: 0.1932296 Test Loss: 0.2476556
Validation loss decreased (0.215068 --> 0.193230).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 8 cost time: 0.8114914894104004
Epoch: 8, Steps: 64 | Train Loss: 0.1309239 Vali Loss: 0.1835621 Test Loss: 0.2349894
Validation loss decreased (0.193230 --> 0.183562).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 9 cost time: 0.8094191551208496
Epoch: 9, Steps: 64 | Train Loss: 0.1269312 Vali Loss: 0.1791488 Test Loss: 0.2309306
Validation loss decreased (0.183562 --> 0.179149).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 10 cost time: 0.8129062652587891
Epoch: 10, Steps: 64 | Train Loss: 0.1246138 Vali Loss: 0.1753258 Test Loss: 0.2286364
Validation loss decreased (0.179149 --> 0.175326).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 11 cost time: 0.8087520599365234
Epoch: 11, Steps: 64 | Train Loss: 0.1226543 Vali Loss: 0.1714703 Test Loss: 0.2253641
Validation loss decreased (0.175326 --> 0.171470).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 12 cost time: 0.8146195411682129
Epoch: 12, Steps: 64 | Train Loss: 0.1211199 Vali Loss: 0.1696193 Test Loss: 0.2233967
Validation loss decreased (0.171470 --> 0.169619).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 13 cost time: 0.811915397644043
Epoch: 13, Steps: 64 | Train Loss: 0.1200271 Vali Loss: 0.1676895 Test Loss: 0.2237864
Validation loss decreased (0.169619 --> 0.167690).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 14 cost time: 0.8283848762512207
Epoch: 14, Steps: 64 | Train Loss: 0.1188516 Vali Loss: 0.1689324 Test Loss: 0.2244721
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 15 cost time: 0.8080000877380371
Epoch: 15, Steps: 64 | Train Loss: 0.1179003 Vali Loss: 0.1663743 Test Loss: 0.2227686
Validation loss decreased (0.167690 --> 0.166374).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 16 cost time: 0.8030664920806885
Epoch: 16, Steps: 64 | Train Loss: 0.1167834 Vali Loss: 0.1677944 Test Loss: 0.2231479
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 17 cost time: 0.8031678199768066
Epoch: 17, Steps: 64 | Train Loss: 0.1160225 Vali Loss: 0.1649254 Test Loss: 0.2217756
Validation loss decreased (0.166374 --> 0.164925).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 18 cost time: 0.7973887920379639
Epoch: 18, Steps: 64 | Train Loss: 0.1153340 Vali Loss: 0.1640643 Test Loss: 0.2221320
Validation loss decreased (0.164925 --> 0.164064).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 19 cost time: 0.8007278442382812
Epoch: 19, Steps: 64 | Train Loss: 0.1147977 Vali Loss: 0.1639945 Test Loss: 0.2218399
Validation loss decreased (0.164064 --> 0.163994).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 20 cost time: 0.8049993515014648
Epoch: 20, Steps: 64 | Train Loss: 0.1143437 Vali Loss: 0.1658018 Test Loss: 0.2231710
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 21 cost time: 0.8054249286651611
Epoch: 21, Steps: 64 | Train Loss: 0.1145292 Vali Loss: 0.1623520 Test Loss: 0.2217800
Validation loss decreased (0.163994 --> 0.162352).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 22 cost time: 0.8056313991546631
Epoch: 22, Steps: 64 | Train Loss: 0.1133188 Vali Loss: 0.1639180 Test Loss: 0.2227377
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 23 cost time: 0.8120508193969727
Epoch: 23, Steps: 64 | Train Loss: 0.1130932 Vali Loss: 0.1646446 Test Loss: 0.2224090
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 24 cost time: 0.8030006885528564
Epoch: 24, Steps: 64 | Train Loss: 0.1130644 Vali Loss: 0.1630987 Test Loss: 0.2223667
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 25 cost time: 0.8026294708251953
Epoch: 25, Steps: 64 | Train Loss: 0.1128068 Vali Loss: 0.1619188 Test Loss: 0.2224486
Validation loss decreased (0.162352 --> 0.161919).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 26 cost time: 0.7931239604949951
Epoch: 26, Steps: 64 | Train Loss: 0.1125347 Vali Loss: 0.1604677 Test Loss: 0.2219088
Validation loss decreased (0.161919 --> 0.160468).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 27 cost time: 0.7997515201568604
Epoch: 27, Steps: 64 | Train Loss: 0.1119263 Vali Loss: 0.1613346 Test Loss: 0.2228471
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 28 cost time: 0.7960002422332764
Epoch: 28, Steps: 64 | Train Loss: 0.1117436 Vali Loss: 0.1626378 Test Loss: 0.2224352
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 29 cost time: 0.8046166896820068
Epoch: 29, Steps: 64 | Train Loss: 0.1113442 Vali Loss: 0.1619128 Test Loss: 0.2222016
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 30 cost time: 0.7815747261047363
Epoch: 30, Steps: 64 | Train Loss: 0.1112197 Vali Loss: 0.1616375 Test Loss: 0.2217263
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 31 cost time: 0.8044805526733398
Epoch: 31, Steps: 64 | Train Loss: 0.1110490 Vali Loss: 0.1617832 Test Loss: 0.2227516
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 32 cost time: 0.804999828338623
Epoch: 32, Steps: 64 | Train Loss: 0.1116568 Vali Loss: 0.1604639 Test Loss: 0.2222987
Validation loss decreased (0.160468 --> 0.160464).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 33 cost time: 0.8136298656463623
Epoch: 33, Steps: 64 | Train Loss: 0.1112429 Vali Loss: 0.1602622 Test Loss: 0.2223731
Validation loss decreased (0.160464 --> 0.160262).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 34 cost time: 0.8024060726165771
Epoch: 34, Steps: 64 | Train Loss: 0.1114216 Vali Loss: 0.1616181 Test Loss: 0.2221063
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 35 cost time: 0.7961959838867188
Epoch: 35, Steps: 64 | Train Loss: 0.1106250 Vali Loss: 0.1593625 Test Loss: 0.2225007
Validation loss decreased (0.160262 --> 0.159362).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 36 cost time: 0.801001787185669
Epoch: 36, Steps: 64 | Train Loss: 0.1111911 Vali Loss: 0.1601799 Test Loss: 0.2223229
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 37 cost time: 0.8106260299682617
Epoch: 37, Steps: 64 | Train Loss: 0.1106221 Vali Loss: 0.1623728 Test Loss: 0.2224343
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 38 cost time: 0.8003644943237305
Epoch: 38, Steps: 64 | Train Loss: 0.1106682 Vali Loss: 0.1598715 Test Loss: 0.2216562
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 39 cost time: 0.8031485080718994
Epoch: 39, Steps: 64 | Train Loss: 0.1102285 Vali Loss: 0.1610952 Test Loss: 0.2227486
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 40 cost time: 0.8057935237884521
Epoch: 40, Steps: 64 | Train Loss: 0.1103048 Vali Loss: 0.1595741 Test Loss: 0.2220829
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 41 cost time: 0.8236267566680908
Epoch: 41, Steps: 64 | Train Loss: 0.1104218 Vali Loss: 0.1604324 Test Loss: 0.2222092
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 42 cost time: 0.8082468509674072
Epoch: 42, Steps: 64 | Train Loss: 0.1101400 Vali Loss: 0.1600854 Test Loss: 0.2222517
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 43 cost time: 0.8063979148864746
Epoch: 43, Steps: 64 | Train Loss: 0.1101628 Vali Loss: 0.1587925 Test Loss: 0.2219618
Validation loss decreased (0.159362 --> 0.158792).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 44 cost time: 0.8067257404327393
Epoch: 44, Steps: 64 | Train Loss: 0.1101039 Vali Loss: 0.1593099 Test Loss: 0.2224140
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 45 cost time: 0.8133866786956787
Epoch: 45, Steps: 64 | Train Loss: 0.1106638 Vali Loss: 0.1586973 Test Loss: 0.2218169
Validation loss decreased (0.158792 --> 0.158697).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 46 cost time: 0.799335241317749
Epoch: 46, Steps: 64 | Train Loss: 0.1104444 Vali Loss: 0.1611054 Test Loss: 0.2231527
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 47 cost time: 0.8011953830718994
Epoch: 47, Steps: 64 | Train Loss: 0.1100774 Vali Loss: 0.1595785 Test Loss: 0.2220716
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 48 cost time: 0.8008396625518799
Epoch: 48, Steps: 64 | Train Loss: 0.1101862 Vali Loss: 0.1618556 Test Loss: 0.2216482
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 49 cost time: 0.8159997463226318
Epoch: 49, Steps: 64 | Train Loss: 0.1103107 Vali Loss: 0.1585245 Test Loss: 0.2217518
Validation loss decreased (0.158697 --> 0.158525).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 50 cost time: 0.8107907772064209
Epoch: 50, Steps: 64 | Train Loss: 0.1096172 Vali Loss: 0.1596368 Test Loss: 0.2215058
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 51 cost time: 0.8044087886810303
Epoch: 51, Steps: 64 | Train Loss: 0.1094542 Vali Loss: 0.1588200 Test Loss: 0.2218621
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 52 cost time: 0.803809642791748
Epoch: 52, Steps: 64 | Train Loss: 0.1103001 Vali Loss: 0.1611670 Test Loss: 0.2230986
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 53 cost time: 0.804999828338623
Epoch: 53, Steps: 64 | Train Loss: 0.1095849 Vali Loss: 0.1589204 Test Loss: 0.2223380
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 54 cost time: 0.8016257286071777
Epoch: 54, Steps: 64 | Train Loss: 0.1105758 Vali Loss: 0.1607566 Test Loss: 0.2228890
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 55 cost time: 0.8034207820892334
Epoch: 55, Steps: 64 | Train Loss: 0.1104863 Vali Loss: 0.1603429 Test Loss: 0.2218850
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 56 cost time: 0.8013961315155029
Epoch: 56, Steps: 64 | Train Loss: 0.1101270 Vali Loss: 0.1591251 Test Loss: 0.2218289
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 57 cost time: 0.7939999103546143
Epoch: 57, Steps: 64 | Train Loss: 0.1101999 Vali Loss: 0.1600889 Test Loss: 0.2220221
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 58 cost time: 0.8006165027618408
Epoch: 58, Steps: 64 | Train Loss: 0.1103243 Vali Loss: 0.1596112 Test Loss: 0.2221450
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 59 cost time: 0.8049399852752686
Epoch: 59, Steps: 64 | Train Loss: 0.1096202 Vali Loss: 0.1588547 Test Loss: 0.2218955
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 60 cost time: 0.8096117973327637
Epoch: 60, Steps: 64 | Train Loss: 0.1097734 Vali Loss: 0.1603692 Test Loss: 0.2222323
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2217518389225006, mae:0.3263847529888153, rse:0.23865346610546112
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.0699467658996582 GB
Epoch: 1 cost time: 2.2457385063171387
Epoch: 1, Steps: 64 | Train Loss: 0.9059973 Vali Loss: 2.3739586 Test Loss: 3.7946596
Validation loss decreased (inf --> 2.373959).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 2 cost time: 0.9120070934295654
Epoch: 2, Steps: 64 | Train Loss: 0.3882841 Vali Loss: 0.2072742 Test Loss: 0.2502877
Validation loss decreased (2.373959 --> 0.207274).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 3 cost time: 0.9066236019134521
Epoch: 3, Steps: 64 | Train Loss: 0.1305588 Vali Loss: 0.1814575 Test Loss: 0.2315875
Validation loss decreased (0.207274 --> 0.181458).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 4 cost time: 0.913271427154541
Epoch: 4, Steps: 64 | Train Loss: 0.1195412 Vali Loss: 0.1727926 Test Loss: 0.2207244
Validation loss decreased (0.181458 --> 0.172793).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 5 cost time: 0.9073915481567383
Epoch: 5, Steps: 64 | Train Loss: 0.1145635 Vali Loss: 0.1689831 Test Loss: 0.2193736
Validation loss decreased (0.172793 --> 0.168983).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 6 cost time: 0.9028639793395996
Epoch: 6, Steps: 64 | Train Loss: 0.1126761 Vali Loss: 0.1650907 Test Loss: 0.2185057
Validation loss decreased (0.168983 --> 0.165091).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 7 cost time: 0.9082159996032715
Epoch: 7, Steps: 64 | Train Loss: 0.1109008 Vali Loss: 0.1604603 Test Loss: 0.2174077
Validation loss decreased (0.165091 --> 0.160460).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 8 cost time: 0.8929998874664307
Epoch: 8, Steps: 64 | Train Loss: 0.1089219 Vali Loss: 0.1605540 Test Loss: 0.2183752
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 9 cost time: 0.9079678058624268
Epoch: 9, Steps: 64 | Train Loss: 0.1077860 Vali Loss: 0.1579765 Test Loss: 0.2181360
Validation loss decreased (0.160460 --> 0.157977).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 10 cost time: 0.9102344512939453
Epoch: 10, Steps: 64 | Train Loss: 0.1072480 Vali Loss: 0.1560970 Test Loss: 0.2184755
Validation loss decreased (0.157977 --> 0.156097).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 11 cost time: 0.9149994850158691
Epoch: 11, Steps: 64 | Train Loss: 0.1056834 Vali Loss: 0.1556647 Test Loss: 0.2177911
Validation loss decreased (0.156097 --> 0.155665).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 12 cost time: 0.9096231460571289
Epoch: 12, Steps: 64 | Train Loss: 0.1047249 Vali Loss: 0.1561721 Test Loss: 0.2192930
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 13 cost time: 0.9074313640594482
Epoch: 13, Steps: 64 | Train Loss: 0.1042429 Vali Loss: 0.1538652 Test Loss: 0.2192204
Validation loss decreased (0.155665 --> 0.153865).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 14 cost time: 0.9077317714691162
Epoch: 14, Steps: 64 | Train Loss: 0.1041746 Vali Loss: 0.1547299 Test Loss: 0.2184897
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 15 cost time: 0.910468578338623
Epoch: 15, Steps: 64 | Train Loss: 0.1033687 Vali Loss: 0.1566670 Test Loss: 0.2197975
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 16 cost time: 0.9069993495941162
Epoch: 16, Steps: 64 | Train Loss: 0.1028267 Vali Loss: 0.1546675 Test Loss: 0.2191752
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 17 cost time: 0.9076125621795654
Epoch: 17, Steps: 64 | Train Loss: 0.1025880 Vali Loss: 0.1522333 Test Loss: 0.2190568
Validation loss decreased (0.153865 --> 0.152233).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 18 cost time: 0.9253251552581787
Epoch: 18, Steps: 64 | Train Loss: 0.1014280 Vali Loss: 0.1544943 Test Loss: 0.2201284
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 19 cost time: 0.9113664627075195
Epoch: 19, Steps: 64 | Train Loss: 0.1007205 Vali Loss: 0.1530974 Test Loss: 0.2199020
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 20 cost time: 0.9123282432556152
Epoch: 20, Steps: 64 | Train Loss: 0.1005918 Vali Loss: 0.1537532 Test Loss: 0.2206654
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 21 cost time: 0.9164447784423828
Epoch: 21, Steps: 64 | Train Loss: 0.1000022 Vali Loss: 0.1511874 Test Loss: 0.2211328
Validation loss decreased (0.152233 --> 0.151187).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 22 cost time: 0.91965651512146
Epoch: 22, Steps: 64 | Train Loss: 0.0997471 Vali Loss: 0.1519014 Test Loss: 0.2205878
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 23 cost time: 0.8999993801116943
Epoch: 23, Steps: 64 | Train Loss: 0.0993905 Vali Loss: 0.1506725 Test Loss: 0.2206340
Validation loss decreased (0.151187 --> 0.150672).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 24 cost time: 0.89864182472229
Epoch: 24, Steps: 64 | Train Loss: 0.0985419 Vali Loss: 0.1516973 Test Loss: 0.2206293
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 25 cost time: 0.901613712310791
Epoch: 25, Steps: 64 | Train Loss: 0.0990364 Vali Loss: 0.1519085 Test Loss: 0.2212630
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 26 cost time: 0.9754025936126709
Epoch: 26, Steps: 64 | Train Loss: 0.0992454 Vali Loss: 0.1510150 Test Loss: 0.2211985
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 27 cost time: 0.9775781631469727
Epoch: 27, Steps: 64 | Train Loss: 0.0984765 Vali Loss: 0.1498155 Test Loss: 0.2213833
Validation loss decreased (0.150672 --> 0.149816).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 28 cost time: 0.9069681167602539
Epoch: 28, Steps: 64 | Train Loss: 0.0983068 Vali Loss: 0.1504056 Test Loss: 0.2217462
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 29 cost time: 0.8946933746337891
Epoch: 29, Steps: 64 | Train Loss: 0.0982412 Vali Loss: 0.1497744 Test Loss: 0.2216120
Validation loss decreased (0.149816 --> 0.149774).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 30 cost time: 0.9087505340576172
Epoch: 30, Steps: 64 | Train Loss: 0.0986048 Vali Loss: 0.1499536 Test Loss: 0.2217131
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 31 cost time: 0.9029998779296875
Epoch: 31, Steps: 64 | Train Loss: 0.0976143 Vali Loss: 0.1493110 Test Loss: 0.2214540
Validation loss decreased (0.149774 --> 0.149311).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 32 cost time: 0.8950364589691162
Epoch: 32, Steps: 64 | Train Loss: 0.0980676 Vali Loss: 0.1498520 Test Loss: 0.2218035
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 33 cost time: 0.8983371257781982
Epoch: 33, Steps: 64 | Train Loss: 0.0975620 Vali Loss: 0.1506381 Test Loss: 0.2219190
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 34 cost time: 0.9033551216125488
Epoch: 34, Steps: 64 | Train Loss: 0.0975094 Vali Loss: 0.1494486 Test Loss: 0.2220484
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 35 cost time: 0.9053807258605957
Epoch: 35, Steps: 64 | Train Loss: 0.0976898 Vali Loss: 0.1505166 Test Loss: 0.2216668
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 36 cost time: 0.9084019660949707
Epoch: 36, Steps: 64 | Train Loss: 0.0974641 Vali Loss: 0.1503079 Test Loss: 0.2218264
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 37 cost time: 0.9107444286346436
Epoch: 37, Steps: 64 | Train Loss: 0.0975488 Vali Loss: 0.1490275 Test Loss: 0.2217492
Validation loss decreased (0.149311 --> 0.149028).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 38 cost time: 0.9070000648498535
Epoch: 38, Steps: 64 | Train Loss: 0.0973927 Vali Loss: 0.1504882 Test Loss: 0.2220084
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 39 cost time: 0.9146246910095215
Epoch: 39, Steps: 64 | Train Loss: 0.0971792 Vali Loss: 0.1513483 Test Loss: 0.2216739
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 40 cost time: 0.9043517112731934
Epoch: 40, Steps: 64 | Train Loss: 0.0972613 Vali Loss: 0.1496175 Test Loss: 0.2220135
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 41 cost time: 0.9050726890563965
Epoch: 41, Steps: 64 | Train Loss: 0.0975695 Vali Loss: 0.1483995 Test Loss: 0.2220114
Validation loss decreased (0.149028 --> 0.148400).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 42 cost time: 0.9014694690704346
Epoch: 42, Steps: 64 | Train Loss: 0.0973928 Vali Loss: 0.1496922 Test Loss: 0.2220701
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 43 cost time: 0.9074351787567139
Epoch: 43, Steps: 64 | Train Loss: 0.0972294 Vali Loss: 0.1489749 Test Loss: 0.2224582
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 44 cost time: 0.9787921905517578
Epoch: 44, Steps: 64 | Train Loss: 0.0972114 Vali Loss: 0.1484432 Test Loss: 0.2225174
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 45 cost time: 0.9233300685882568
Epoch: 45, Steps: 64 | Train Loss: 0.0970508 Vali Loss: 0.1496869 Test Loss: 0.2222772
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 46 cost time: 0.9040000438690186
Epoch: 46, Steps: 64 | Train Loss: 0.0967710 Vali Loss: 0.1493240 Test Loss: 0.2224620
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 47 cost time: 0.9056143760681152
Epoch: 47, Steps: 64 | Train Loss: 0.0974203 Vali Loss: 0.1501646 Test Loss: 0.2222946
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 48 cost time: 0.9070494174957275
Epoch: 48, Steps: 64 | Train Loss: 0.0972121 Vali Loss: 0.1484381 Test Loss: 0.2226177
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 49 cost time: 0.9090173244476318
Epoch: 49, Steps: 64 | Train Loss: 0.0966522 Vali Loss: 0.1493170 Test Loss: 0.2217593
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 50 cost time: 0.9014546871185303
Epoch: 50, Steps: 64 | Train Loss: 0.0974604 Vali Loss: 0.1487709 Test Loss: 0.2222359
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 51 cost time: 0.9017915725708008
Epoch: 51, Steps: 64 | Train Loss: 0.0971402 Vali Loss: 0.1496013 Test Loss: 0.2221918
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 52 cost time: 0.9039983749389648
Epoch: 52, Steps: 64 | Train Loss: 0.0975806 Vali Loss: 0.1489708 Test Loss: 0.2224608
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 53 cost time: 0.9209811687469482
Epoch: 53, Steps: 64 | Train Loss: 0.0972414 Vali Loss: 0.1473944 Test Loss: 0.2218259
Validation loss decreased (0.148400 --> 0.147394).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 54 cost time: 0.9046170711517334
Epoch: 54, Steps: 64 | Train Loss: 0.0969566 Vali Loss: 0.1490511 Test Loss: 0.2222345
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 55 cost time: 0.9090774059295654
Epoch: 55, Steps: 64 | Train Loss: 0.0969643 Vali Loss: 0.1498014 Test Loss: 0.2225077
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 56 cost time: 0.9183869361877441
Epoch: 56, Steps: 64 | Train Loss: 0.0975931 Vali Loss: 0.1509016 Test Loss: 0.2223623
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 57 cost time: 0.9063718318939209
Epoch: 57, Steps: 64 | Train Loss: 0.0973867 Vali Loss: 0.1506885 Test Loss: 0.2224280
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 58 cost time: 0.9031081199645996
Epoch: 58, Steps: 64 | Train Loss: 0.0971456 Vali Loss: 0.1497346 Test Loss: 0.2221292
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 59 cost time: 0.9049973487854004
Epoch: 59, Steps: 64 | Train Loss: 0.0973409 Vali Loss: 0.1489500 Test Loss: 0.2222773
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 60 cost time: 0.9111149311065674
Epoch: 60, Steps: 64 | Train Loss: 0.0970898 Vali Loss: 0.1490123 Test Loss: 0.2218962
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22182591259479523, mae:0.3302370607852936, rse:0.23869334161281586
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07306241989135742 GB
Epoch: 1 cost time: 2.3272528648376465
Epoch: 1, Steps: 64 | Train Loss: 0.8522360 Vali Loss: 2.2589939 Test Loss: 3.6042495
Validation loss decreased (inf --> 2.258994).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 2 cost time: 0.9326725006103516
Epoch: 2, Steps: 64 | Train Loss: 0.3384615 Vali Loss: 0.2651578 Test Loss: 0.3578516
Validation loss decreased (2.258994 --> 0.265158).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 3 cost time: 0.9393668174743652
Epoch: 3, Steps: 64 | Train Loss: 0.1259167 Vali Loss: 0.1727072 Test Loss: 0.2192366
Validation loss decreased (0.265158 --> 0.172707).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 4 cost time: 0.9363570213317871
Epoch: 4, Steps: 64 | Train Loss: 0.1145480 Vali Loss: 0.1664923 Test Loss: 0.2195156
Validation loss decreased (0.172707 --> 0.166492).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 5 cost time: 0.9293880462646484
Epoch: 5, Steps: 64 | Train Loss: 0.1109573 Vali Loss: 0.1634422 Test Loss: 0.2179878
Validation loss decreased (0.166492 --> 0.163442).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 6 cost time: 0.9347498416900635
Epoch: 6, Steps: 64 | Train Loss: 0.1079236 Vali Loss: 0.1607216 Test Loss: 0.2172806
Validation loss decreased (0.163442 --> 0.160722).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 7 cost time: 0.930241584777832
Epoch: 7, Steps: 64 | Train Loss: 0.1068506 Vali Loss: 0.1582877 Test Loss: 0.2186501
Validation loss decreased (0.160722 --> 0.158288).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 8 cost time: 0.935999870300293
Epoch: 8, Steps: 64 | Train Loss: 0.1050335 Vali Loss: 0.1571289 Test Loss: 0.2188143
Validation loss decreased (0.158288 --> 0.157129).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 9 cost time: 0.9356162548065186
Epoch: 9, Steps: 64 | Train Loss: 0.1031974 Vali Loss: 0.1577600 Test Loss: 0.2198266
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 10 cost time: 0.9426400661468506
Epoch: 10, Steps: 64 | Train Loss: 0.1025966 Vali Loss: 0.1534880 Test Loss: 0.2211776
Validation loss decreased (0.157129 --> 0.153488).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 11 cost time: 0.9440855979919434
Epoch: 11, Steps: 64 | Train Loss: 0.1015924 Vali Loss: 0.1536366 Test Loss: 0.2198492
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 12 cost time: 0.9413700103759766
Epoch: 12, Steps: 64 | Train Loss: 0.1006280 Vali Loss: 0.1513704 Test Loss: 0.2221657
Validation loss decreased (0.153488 --> 0.151370).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 13 cost time: 0.9513697624206543
Epoch: 13, Steps: 64 | Train Loss: 0.1002513 Vali Loss: 0.1505052 Test Loss: 0.2224965
Validation loss decreased (0.151370 --> 0.150505).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 14 cost time: 0.9383790493011475
Epoch: 14, Steps: 64 | Train Loss: 0.0995791 Vali Loss: 0.1487234 Test Loss: 0.2241453
Validation loss decreased (0.150505 --> 0.148723).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 15 cost time: 0.9353222846984863
Epoch: 15, Steps: 64 | Train Loss: 0.0984911 Vali Loss: 0.1498702 Test Loss: 0.2229209
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 16 cost time: 0.9327783584594727
Epoch: 16, Steps: 64 | Train Loss: 0.0981603 Vali Loss: 0.1483869 Test Loss: 0.2237495
Validation loss decreased (0.148723 --> 0.148387).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 17 cost time: 0.9449491500854492
Epoch: 17, Steps: 64 | Train Loss: 0.0974244 Vali Loss: 0.1487335 Test Loss: 0.2241575
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 18 cost time: 0.9356167316436768
Epoch: 18, Steps: 64 | Train Loss: 0.0968305 Vali Loss: 0.1477329 Test Loss: 0.2269565
Validation loss decreased (0.148387 --> 0.147733).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 19 cost time: 0.9304461479187012
Epoch: 19, Steps: 64 | Train Loss: 0.0965815 Vali Loss: 0.1466416 Test Loss: 0.2254956
Validation loss decreased (0.147733 --> 0.146642).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 20 cost time: 0.9432404041290283
Epoch: 20, Steps: 64 | Train Loss: 0.0961915 Vali Loss: 0.1469400 Test Loss: 0.2274851
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 21 cost time: 0.9317512512207031
Epoch: 21, Steps: 64 | Train Loss: 0.0957948 Vali Loss: 0.1474735 Test Loss: 0.2269770
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 22 cost time: 0.9283363819122314
Epoch: 22, Steps: 64 | Train Loss: 0.0959166 Vali Loss: 0.1469374 Test Loss: 0.2258682
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 23 cost time: 0.9293737411499023
Epoch: 23, Steps: 64 | Train Loss: 0.0956192 Vali Loss: 0.1476189 Test Loss: 0.2275398
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 24 cost time: 0.929741382598877
Epoch: 24, Steps: 64 | Train Loss: 0.0955491 Vali Loss: 0.1463875 Test Loss: 0.2269507
Validation loss decreased (0.146642 --> 0.146387).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 25 cost time: 0.9330012798309326
Epoch: 25, Steps: 64 | Train Loss: 0.0952118 Vali Loss: 0.1458015 Test Loss: 0.2280700
Validation loss decreased (0.146387 --> 0.145801).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 26 cost time: 0.9290003776550293
Epoch: 26, Steps: 64 | Train Loss: 0.0954842 Vali Loss: 0.1458598 Test Loss: 0.2263106
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 27 cost time: 0.9332075119018555
Epoch: 27, Steps: 64 | Train Loss: 0.0952788 Vali Loss: 0.1460774 Test Loss: 0.2280651
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 28 cost time: 0.9556231498718262
Epoch: 28, Steps: 64 | Train Loss: 0.0946103 Vali Loss: 0.1460028 Test Loss: 0.2275774
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 29 cost time: 0.9293642044067383
Epoch: 29, Steps: 64 | Train Loss: 0.0947946 Vali Loss: 0.1466127 Test Loss: 0.2275792
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 30 cost time: 0.932471513748169
Epoch: 30, Steps: 64 | Train Loss: 0.0943429 Vali Loss: 0.1458248 Test Loss: 0.2278981
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 31 cost time: 0.9273684024810791
Epoch: 31, Steps: 64 | Train Loss: 0.0947122 Vali Loss: 0.1466965 Test Loss: 0.2286524
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 32 cost time: 0.9266819953918457
Epoch: 32, Steps: 64 | Train Loss: 0.0943184 Vali Loss: 0.1463952 Test Loss: 0.2282701
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 33 cost time: 0.9242730140686035
Epoch: 33, Steps: 64 | Train Loss: 0.0941340 Vali Loss: 0.1444249 Test Loss: 0.2282941
Validation loss decreased (0.145801 --> 0.144425).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 34 cost time: 0.947998046875
Epoch: 34, Steps: 64 | Train Loss: 0.0947125 Vali Loss: 0.1460209 Test Loss: 0.2286156
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 35 cost time: 0.9266071319580078
Epoch: 35, Steps: 64 | Train Loss: 0.0943126 Vali Loss: 0.1441302 Test Loss: 0.2281766
Validation loss decreased (0.144425 --> 0.144130).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 36 cost time: 0.9310088157653809
Epoch: 36, Steps: 64 | Train Loss: 0.0940031 Vali Loss: 0.1447538 Test Loss: 0.2290739
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 37 cost time: 0.9463694095611572
Epoch: 37, Steps: 64 | Train Loss: 0.0941937 Vali Loss: 0.1454110 Test Loss: 0.2286646
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 38 cost time: 0.9303536415100098
Epoch: 38, Steps: 64 | Train Loss: 0.0943427 Vali Loss: 0.1454218 Test Loss: 0.2284296
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 39 cost time: 0.9323890209197998
Epoch: 39, Steps: 64 | Train Loss: 0.0943099 Vali Loss: 0.1454550 Test Loss: 0.2287759
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 40 cost time: 0.9343595504760742
Epoch: 40, Steps: 64 | Train Loss: 0.0940778 Vali Loss: 0.1456124 Test Loss: 0.2290702
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 41 cost time: 0.9337401390075684
Epoch: 41, Steps: 64 | Train Loss: 0.0938411 Vali Loss: 0.1463629 Test Loss: 0.2289627
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 42 cost time: 0.9269998073577881
Epoch: 42, Steps: 64 | Train Loss: 0.0943754 Vali Loss: 0.1455370 Test Loss: 0.2284508
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 43 cost time: 0.9250001907348633
Epoch: 43, Steps: 64 | Train Loss: 0.0941363 Vali Loss: 0.1464856 Test Loss: 0.2293351
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 44 cost time: 0.9362962245941162
Epoch: 44, Steps: 64 | Train Loss: 0.0936113 Vali Loss: 0.1451464 Test Loss: 0.2288207
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 45 cost time: 0.9344000816345215
Epoch: 45, Steps: 64 | Train Loss: 0.0939431 Vali Loss: 0.1468249 Test Loss: 0.2290817
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 46 cost time: 0.932366132736206
Epoch: 46, Steps: 64 | Train Loss: 0.0939498 Vali Loss: 0.1455816 Test Loss: 0.2285782
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 47 cost time: 0.9319994449615479
Epoch: 47, Steps: 64 | Train Loss: 0.0937104 Vali Loss: 0.1460155 Test Loss: 0.2291338
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 48 cost time: 0.9254257678985596
Epoch: 48, Steps: 64 | Train Loss: 0.0932573 Vali Loss: 0.1454344 Test Loss: 0.2294186
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 49 cost time: 0.9277670383453369
Epoch: 49, Steps: 64 | Train Loss: 0.0938134 Vali Loss: 0.1456837 Test Loss: 0.2291831
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 50 cost time: 0.9289994239807129
Epoch: 50, Steps: 64 | Train Loss: 0.0937783 Vali Loss: 0.1455958 Test Loss: 0.2293203
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 51 cost time: 0.928217887878418
Epoch: 51, Steps: 64 | Train Loss: 0.0940932 Vali Loss: 0.1438185 Test Loss: 0.2286874
Validation loss decreased (0.144130 --> 0.143818).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 52 cost time: 0.9366199970245361
Epoch: 52, Steps: 64 | Train Loss: 0.0938290 Vali Loss: 0.1438155 Test Loss: 0.2285843
Validation loss decreased (0.143818 --> 0.143816).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 53 cost time: 0.9303717613220215
Epoch: 53, Steps: 64 | Train Loss: 0.0939138 Vali Loss: 0.1455213 Test Loss: 0.2294136
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 54 cost time: 0.9383583068847656
Epoch: 54, Steps: 64 | Train Loss: 0.0936662 Vali Loss: 0.1467068 Test Loss: 0.2295263
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 55 cost time: 0.9273660182952881
Epoch: 55, Steps: 64 | Train Loss: 0.0938273 Vali Loss: 0.1453952 Test Loss: 0.2290140
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 56 cost time: 0.930365800857544
Epoch: 56, Steps: 64 | Train Loss: 0.0935565 Vali Loss: 0.1455913 Test Loss: 0.2292265
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 57 cost time: 0.9258582592010498
Epoch: 57, Steps: 64 | Train Loss: 0.0941878 Vali Loss: 0.1453378 Test Loss: 0.2292392
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 58 cost time: 0.9297263622283936
Epoch: 58, Steps: 64 | Train Loss: 0.0939858 Vali Loss: 0.1463922 Test Loss: 0.2296260
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 59 cost time: 0.9250004291534424
Epoch: 59, Steps: 64 | Train Loss: 0.0941553 Vali Loss: 0.1457442 Test Loss: 0.2290195
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 60 cost time: 0.9336071014404297
Epoch: 60, Steps: 64 | Train Loss: 0.0936468 Vali Loss: 0.1461038 Test Loss: 0.2288622
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22858434915542603, mae:0.34020912647247314, rse:0.24230220913887024
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06583642959594727 GB
Epoch: 1 cost time: 2.2320406436920166
Epoch: 1, Steps: 64 | Train Loss: 0.9581301 Vali Loss: 2.4295089 Test Loss: 3.8349888
Validation loss decreased (inf --> 2.429509).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 2 cost time: 0.8764777183532715
Epoch: 2, Steps: 64 | Train Loss: 0.6283347 Vali Loss: 0.8349715 Test Loss: 1.2398261
Validation loss decreased (2.429509 --> 0.834972).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 3 cost time: 0.8727121353149414
Epoch: 3, Steps: 64 | Train Loss: 0.3048890 Vali Loss: 0.4134712 Test Loss: 0.5655625
Validation loss decreased (0.834972 --> 0.413471).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 4 cost time: 0.8970563411712646
Epoch: 4, Steps: 64 | Train Loss: 0.1965034 Vali Loss: 0.2696972 Test Loss: 0.3487162
Validation loss decreased (0.413471 --> 0.269697).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 5 cost time: 0.8786830902099609
Epoch: 5, Steps: 64 | Train Loss: 0.1542996 Vali Loss: 0.2135721 Test Loss: 0.2790874
Validation loss decreased (0.269697 --> 0.213572).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 6 cost time: 0.8735096454620361
Epoch: 6, Steps: 64 | Train Loss: 0.1391416 Vali Loss: 0.1933035 Test Loss: 0.2501656
Validation loss decreased (0.213572 --> 0.193304).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 7 cost time: 0.8746612071990967
Epoch: 7, Steps: 64 | Train Loss: 0.1315136 Vali Loss: 0.1861685 Test Loss: 0.2378941
Validation loss decreased (0.193304 --> 0.186168).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 8 cost time: 0.8772380352020264
Epoch: 8, Steps: 64 | Train Loss: 0.1281304 Vali Loss: 0.1793078 Test Loss: 0.2332433
Validation loss decreased (0.186168 --> 0.179308).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 9 cost time: 0.8550140857696533
Epoch: 9, Steps: 64 | Train Loss: 0.1251485 Vali Loss: 0.1746081 Test Loss: 0.2274305
Validation loss decreased (0.179308 --> 0.174608).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 10 cost time: 0.8778214454650879
Epoch: 10, Steps: 64 | Train Loss: 0.1228566 Vali Loss: 0.1757081 Test Loss: 0.2258589
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 11 cost time: 0.8789992332458496
Epoch: 11, Steps: 64 | Train Loss: 0.1213371 Vali Loss: 0.1703490 Test Loss: 0.2240556
Validation loss decreased (0.174608 --> 0.170349).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 12 cost time: 0.8950567245483398
Epoch: 12, Steps: 64 | Train Loss: 0.1192197 Vali Loss: 0.1689851 Test Loss: 0.2248857
Validation loss decreased (0.170349 --> 0.168985).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 13 cost time: 0.8868539333343506
Epoch: 13, Steps: 64 | Train Loss: 0.1180113 Vali Loss: 0.1702824 Test Loss: 0.2236884
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 14 cost time: 0.8825428485870361
Epoch: 14, Steps: 64 | Train Loss: 0.1178979 Vali Loss: 0.1666427 Test Loss: 0.2244381
Validation loss decreased (0.168985 --> 0.166643).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 15 cost time: 0.8773767948150635
Epoch: 15, Steps: 64 | Train Loss: 0.1169819 Vali Loss: 0.1666205 Test Loss: 0.2235383
Validation loss decreased (0.166643 --> 0.166620).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 16 cost time: 0.8738503456115723
Epoch: 16, Steps: 64 | Train Loss: 0.1153771 Vali Loss: 0.1654116 Test Loss: 0.2223265
Validation loss decreased (0.166620 --> 0.165412).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 17 cost time: 0.8699994087219238
Epoch: 17, Steps: 64 | Train Loss: 0.1151787 Vali Loss: 0.1639360 Test Loss: 0.2224409
Validation loss decreased (0.165412 --> 0.163936).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 18 cost time: 0.873629093170166
Epoch: 18, Steps: 64 | Train Loss: 0.1136732 Vali Loss: 0.1631447 Test Loss: 0.2230861
Validation loss decreased (0.163936 --> 0.163145).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 19 cost time: 0.8858284950256348
Epoch: 19, Steps: 64 | Train Loss: 0.1137931 Vali Loss: 0.1631828 Test Loss: 0.2229393
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 20 cost time: 0.8784477710723877
Epoch: 20, Steps: 64 | Train Loss: 0.1134818 Vali Loss: 0.1605348 Test Loss: 0.2232197
Validation loss decreased (0.163145 --> 0.160535).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 21 cost time: 0.879000186920166
Epoch: 21, Steps: 64 | Train Loss: 0.1120649 Vali Loss: 0.1612181 Test Loss: 0.2223416
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 22 cost time: 0.875798225402832
Epoch: 22, Steps: 64 | Train Loss: 0.1124980 Vali Loss: 0.1613889 Test Loss: 0.2217643
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 23 cost time: 0.8790006637573242
Epoch: 23, Steps: 64 | Train Loss: 0.1118504 Vali Loss: 0.1604936 Test Loss: 0.2220605
Validation loss decreased (0.160535 --> 0.160494).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 24 cost time: 0.8726229667663574
Epoch: 24, Steps: 64 | Train Loss: 0.1114604 Vali Loss: 0.1610713 Test Loss: 0.2229498
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 25 cost time: 0.8658294677734375
Epoch: 25, Steps: 64 | Train Loss: 0.1115081 Vali Loss: 0.1596622 Test Loss: 0.2222346
Validation loss decreased (0.160494 --> 0.159662).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 26 cost time: 0.8620376586914062
Epoch: 26, Steps: 64 | Train Loss: 0.1108790 Vali Loss: 0.1595851 Test Loss: 0.2225123
Validation loss decreased (0.159662 --> 0.159585).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 27 cost time: 0.8595902919769287
Epoch: 27, Steps: 64 | Train Loss: 0.1106699 Vali Loss: 0.1591711 Test Loss: 0.2218009
Validation loss decreased (0.159585 --> 0.159171).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 28 cost time: 0.876776933670044
Epoch: 28, Steps: 64 | Train Loss: 0.1096646 Vali Loss: 0.1594724 Test Loss: 0.2221485
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 29 cost time: 0.8736164569854736
Epoch: 29, Steps: 64 | Train Loss: 0.1100399 Vali Loss: 0.1576862 Test Loss: 0.2225317
Validation loss decreased (0.159171 --> 0.157686).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 30 cost time: 0.8706116676330566
Epoch: 30, Steps: 64 | Train Loss: 0.1100118 Vali Loss: 0.1582141 Test Loss: 0.2221597
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 31 cost time: 0.8734076023101807
Epoch: 31, Steps: 64 | Train Loss: 0.1105190 Vali Loss: 0.1587935 Test Loss: 0.2223322
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 32 cost time: 0.8693623542785645
Epoch: 32, Steps: 64 | Train Loss: 0.1099258 Vali Loss: 0.1610529 Test Loss: 0.2222809
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 33 cost time: 0.872391939163208
Epoch: 33, Steps: 64 | Train Loss: 0.1097249 Vali Loss: 0.1594547 Test Loss: 0.2227909
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 34 cost time: 0.8654167652130127
Epoch: 34, Steps: 64 | Train Loss: 0.1100786 Vali Loss: 0.1577354 Test Loss: 0.2217428
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 35 cost time: 0.8676209449768066
Epoch: 35, Steps: 64 | Train Loss: 0.1090854 Vali Loss: 0.1580445 Test Loss: 0.2220114
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 36 cost time: 0.8643498420715332
Epoch: 36, Steps: 64 | Train Loss: 0.1096061 Vali Loss: 0.1584381 Test Loss: 0.2223864
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 37 cost time: 0.8784706592559814
Epoch: 37, Steps: 64 | Train Loss: 0.1091801 Vali Loss: 0.1591656 Test Loss: 0.2217458
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 38 cost time: 0.8734920024871826
Epoch: 38, Steps: 64 | Train Loss: 0.1094001 Vali Loss: 0.1587664 Test Loss: 0.2222342
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 39 cost time: 0.8683905601501465
Epoch: 39, Steps: 64 | Train Loss: 0.1094623 Vali Loss: 0.1572648 Test Loss: 0.2216427
Validation loss decreased (0.157686 --> 0.157265).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 40 cost time: 0.8709993362426758
Epoch: 40, Steps: 64 | Train Loss: 0.1088000 Vali Loss: 0.1572101 Test Loss: 0.2213983
Validation loss decreased (0.157265 --> 0.157210).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 41 cost time: 0.8836252689361572
Epoch: 41, Steps: 64 | Train Loss: 0.1088145 Vali Loss: 0.1586814 Test Loss: 0.2220041
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 42 cost time: 0.861356258392334
Epoch: 42, Steps: 64 | Train Loss: 0.1089373 Vali Loss: 0.1569905 Test Loss: 0.2216285
Validation loss decreased (0.157210 --> 0.156990).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 43 cost time: 0.8694515228271484
Epoch: 43, Steps: 64 | Train Loss: 0.1091207 Vali Loss: 0.1573937 Test Loss: 0.2223188
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 44 cost time: 0.8733546733856201
Epoch: 44, Steps: 64 | Train Loss: 0.1090466 Vali Loss: 0.1572123 Test Loss: 0.2219446
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 45 cost time: 0.8660001754760742
Epoch: 45, Steps: 64 | Train Loss: 0.1082947 Vali Loss: 0.1571584 Test Loss: 0.2217276
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 46 cost time: 0.8689999580383301
Epoch: 46, Steps: 64 | Train Loss: 0.1089898 Vali Loss: 0.1572277 Test Loss: 0.2223558
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 47 cost time: 0.8693380355834961
Epoch: 47, Steps: 64 | Train Loss: 0.1080674 Vali Loss: 0.1573331 Test Loss: 0.2218658
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 48 cost time: 0.8850240707397461
Epoch: 48, Steps: 64 | Train Loss: 0.1087145 Vali Loss: 0.1570018 Test Loss: 0.2221307
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 49 cost time: 0.8703405857086182
Epoch: 49, Steps: 64 | Train Loss: 0.1087496 Vali Loss: 0.1570536 Test Loss: 0.2218677
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 50 cost time: 0.8757627010345459
Epoch: 50, Steps: 64 | Train Loss: 0.1090071 Vali Loss: 0.1563416 Test Loss: 0.2221800
Validation loss decreased (0.156990 --> 0.156342).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 51 cost time: 0.8650000095367432
Epoch: 51, Steps: 64 | Train Loss: 0.1087475 Vali Loss: 0.1572016 Test Loss: 0.2224225
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 52 cost time: 0.8542518615722656
Epoch: 52, Steps: 64 | Train Loss: 0.1085500 Vali Loss: 0.1580011 Test Loss: 0.2219630
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 53 cost time: 0.866370439529419
Epoch: 53, Steps: 64 | Train Loss: 0.1088013 Vali Loss: 0.1591597 Test Loss: 0.2224108
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 54 cost time: 0.8616611957550049
Epoch: 54, Steps: 64 | Train Loss: 0.1085197 Vali Loss: 0.1561960 Test Loss: 0.2223805
Validation loss decreased (0.156342 --> 0.156196).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 55 cost time: 0.8847668170928955
Epoch: 55, Steps: 64 | Train Loss: 0.1085304 Vali Loss: 0.1575895 Test Loss: 0.2215861
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 56 cost time: 0.8700001239776611
Epoch: 56, Steps: 64 | Train Loss: 0.1089702 Vali Loss: 0.1575473 Test Loss: 0.2219341
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 57 cost time: 0.867999792098999
Epoch: 57, Steps: 64 | Train Loss: 0.1085642 Vali Loss: 0.1566434 Test Loss: 0.2218540
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 58 cost time: 0.8694286346435547
Epoch: 58, Steps: 64 | Train Loss: 0.1088484 Vali Loss: 0.1575276 Test Loss: 0.2219666
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 59 cost time: 0.882983922958374
Epoch: 59, Steps: 64 | Train Loss: 0.1087161 Vali Loss: 0.1586580 Test Loss: 0.2224634
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 60 cost time: 0.8733170032501221
Epoch: 60, Steps: 64 | Train Loss: 0.1082336 Vali Loss: 0.1572207 Test Loss: 0.2219175
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22238048911094666, mae:0.3295566439628601, rse:0.23899151384830475
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07010889053344727 GB
Epoch: 1 cost time: 2.251085042953491
Epoch: 1, Steps: 64 | Train Loss: 0.8602372 Vali Loss: 2.2495685 Test Loss: 3.5763454
Validation loss decreased (inf --> 2.249568).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 2 cost time: 0.9080004692077637
Epoch: 2, Steps: 64 | Train Loss: 0.4009282 Vali Loss: 0.2046024 Test Loss: 0.2385819
Validation loss decreased (2.249568 --> 0.204602).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 3 cost time: 0.8979997634887695
Epoch: 3, Steps: 64 | Train Loss: 0.1331943 Vali Loss: 0.1789339 Test Loss: 0.2258935
Validation loss decreased (0.204602 --> 0.178934).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 4 cost time: 0.9056289196014404
Epoch: 4, Steps: 64 | Train Loss: 0.1195035 Vali Loss: 0.1707085 Test Loss: 0.2155981
Validation loss decreased (0.178934 --> 0.170709).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 5 cost time: 0.8994250297546387
Epoch: 5, Steps: 64 | Train Loss: 0.1165331 Vali Loss: 0.1617498 Test Loss: 0.2181529
Validation loss decreased (0.170709 --> 0.161750).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 6 cost time: 0.9011507034301758
Epoch: 6, Steps: 64 | Train Loss: 0.1124042 Vali Loss: 0.1589493 Test Loss: 0.2189293
Validation loss decreased (0.161750 --> 0.158949).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 7 cost time: 0.8963685035705566
Epoch: 7, Steps: 64 | Train Loss: 0.1105246 Vali Loss: 0.1566463 Test Loss: 0.2178372
Validation loss decreased (0.158949 --> 0.156646).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 8 cost time: 0.8977823257446289
Epoch: 8, Steps: 64 | Train Loss: 0.1081278 Vali Loss: 0.1563906 Test Loss: 0.2177406
Validation loss decreased (0.156646 --> 0.156391).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 9 cost time: 0.902001142501831
Epoch: 9, Steps: 64 | Train Loss: 0.1066867 Vali Loss: 0.1544164 Test Loss: 0.2196973
Validation loss decreased (0.156391 --> 0.154416).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 10 cost time: 0.9059998989105225
Epoch: 10, Steps: 64 | Train Loss: 0.1050177 Vali Loss: 0.1565510 Test Loss: 0.2209754
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 11 cost time: 0.8996167182922363
Epoch: 11, Steps: 64 | Train Loss: 0.1041985 Vali Loss: 0.1523160 Test Loss: 0.2189611
Validation loss decreased (0.154416 --> 0.152316).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 12 cost time: 0.9032502174377441
Epoch: 12, Steps: 64 | Train Loss: 0.1026511 Vali Loss: 0.1501223 Test Loss: 0.2193556
Validation loss decreased (0.152316 --> 0.150122).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 13 cost time: 0.9123504161834717
Epoch: 13, Steps: 64 | Train Loss: 0.1020069 Vali Loss: 0.1502909 Test Loss: 0.2211404
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 14 cost time: 0.898369312286377
Epoch: 14, Steps: 64 | Train Loss: 0.1011044 Vali Loss: 0.1502075 Test Loss: 0.2208733
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 15 cost time: 0.9030795097351074
Epoch: 15, Steps: 64 | Train Loss: 0.1003334 Vali Loss: 0.1494551 Test Loss: 0.2213046
Validation loss decreased (0.150122 --> 0.149455).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 16 cost time: 0.8981547355651855
Epoch: 16, Steps: 64 | Train Loss: 0.0995664 Vali Loss: 0.1506940 Test Loss: 0.2217632
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 17 cost time: 0.9030001163482666
Epoch: 17, Steps: 64 | Train Loss: 0.0988911 Vali Loss: 0.1489587 Test Loss: 0.2212516
Validation loss decreased (0.149455 --> 0.148959).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 18 cost time: 0.9076194763183594
Epoch: 18, Steps: 64 | Train Loss: 0.0985203 Vali Loss: 0.1491502 Test Loss: 0.2218253
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 19 cost time: 0.9014124870300293
Epoch: 19, Steps: 64 | Train Loss: 0.0981085 Vali Loss: 0.1500774 Test Loss: 0.2225693
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 20 cost time: 0.9143569469451904
Epoch: 20, Steps: 64 | Train Loss: 0.0980006 Vali Loss: 0.1488454 Test Loss: 0.2224789
Validation loss decreased (0.148959 --> 0.148845).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 21 cost time: 0.8983488082885742
Epoch: 21, Steps: 64 | Train Loss: 0.0978059 Vali Loss: 0.1479646 Test Loss: 0.2228001
Validation loss decreased (0.148845 --> 0.147965).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 22 cost time: 0.9043889045715332
Epoch: 22, Steps: 64 | Train Loss: 0.0973514 Vali Loss: 0.1482003 Test Loss: 0.2220742
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 23 cost time: 0.8997619152069092
Epoch: 23, Steps: 64 | Train Loss: 0.0968748 Vali Loss: 0.1470400 Test Loss: 0.2231282
Validation loss decreased (0.147965 --> 0.147040).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 24 cost time: 0.8977506160736084
Epoch: 24, Steps: 64 | Train Loss: 0.0972851 Vali Loss: 0.1476850 Test Loss: 0.2223624
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 25 cost time: 0.8986217975616455
Epoch: 25, Steps: 64 | Train Loss: 0.0969179 Vali Loss: 0.1480504 Test Loss: 0.2225947
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 26 cost time: 0.8963358402252197
Epoch: 26, Steps: 64 | Train Loss: 0.0968031 Vali Loss: 0.1474040 Test Loss: 0.2227499
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 27 cost time: 0.9060313701629639
Epoch: 27, Steps: 64 | Train Loss: 0.0965726 Vali Loss: 0.1475728 Test Loss: 0.2227719
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 28 cost time: 0.9024600982666016
Epoch: 28, Steps: 64 | Train Loss: 0.0959716 Vali Loss: 0.1462502 Test Loss: 0.2229183
Validation loss decreased (0.147040 --> 0.146250).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 29 cost time: 0.9001481533050537
Epoch: 29, Steps: 64 | Train Loss: 0.0955788 Vali Loss: 0.1453758 Test Loss: 0.2229558
Validation loss decreased (0.146250 --> 0.145376).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 30 cost time: 0.9077887535095215
Epoch: 30, Steps: 64 | Train Loss: 0.0958245 Vali Loss: 0.1457392 Test Loss: 0.2233135
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 31 cost time: 0.9020004272460938
Epoch: 31, Steps: 64 | Train Loss: 0.0962147 Vali Loss: 0.1474004 Test Loss: 0.2233234
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 32 cost time: 0.8956301212310791
Epoch: 32, Steps: 64 | Train Loss: 0.0959918 Vali Loss: 0.1466330 Test Loss: 0.2231804
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 33 cost time: 0.8969426155090332
Epoch: 33, Steps: 64 | Train Loss: 0.0961873 Vali Loss: 0.1470398 Test Loss: 0.2229746
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 34 cost time: 0.9115800857543945
Epoch: 34, Steps: 64 | Train Loss: 0.0958889 Vali Loss: 0.1472431 Test Loss: 0.2233886
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 35 cost time: 0.9023525714874268
Epoch: 35, Steps: 64 | Train Loss: 0.0959000 Vali Loss: 0.1469754 Test Loss: 0.2228843
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 36 cost time: 0.9018251895904541
Epoch: 36, Steps: 64 | Train Loss: 0.0959643 Vali Loss: 0.1464884 Test Loss: 0.2227149
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 37 cost time: 0.9058058261871338
Epoch: 37, Steps: 64 | Train Loss: 0.0959788 Vali Loss: 0.1461350 Test Loss: 0.2229767
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 38 cost time: 0.9469995498657227
Epoch: 38, Steps: 64 | Train Loss: 0.0956423 Vali Loss: 0.1465257 Test Loss: 0.2231819
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 39 cost time: 0.9046216011047363
Epoch: 39, Steps: 64 | Train Loss: 0.0960598 Vali Loss: 0.1463778 Test Loss: 0.2231478
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 40 cost time: 0.9024143218994141
Epoch: 40, Steps: 64 | Train Loss: 0.0954860 Vali Loss: 0.1465216 Test Loss: 0.2232258
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 41 cost time: 0.908057451248169
Epoch: 41, Steps: 64 | Train Loss: 0.0956076 Vali Loss: 0.1463478 Test Loss: 0.2233227
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 42 cost time: 0.8959825038909912
Epoch: 42, Steps: 64 | Train Loss: 0.0956995 Vali Loss: 0.1472802 Test Loss: 0.2233584
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 43 cost time: 0.8998095989227295
Epoch: 43, Steps: 64 | Train Loss: 0.0954402 Vali Loss: 0.1462580 Test Loss: 0.2233169
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 44 cost time: 0.9030008316040039
Epoch: 44, Steps: 64 | Train Loss: 0.0953697 Vali Loss: 0.1447240 Test Loss: 0.2230535
Validation loss decreased (0.145376 --> 0.144724).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 45 cost time: 0.9049999713897705
Epoch: 45, Steps: 64 | Train Loss: 0.0954213 Vali Loss: 0.1467055 Test Loss: 0.2231580
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 46 cost time: 0.9072375297546387
Epoch: 46, Steps: 64 | Train Loss: 0.0950779 Vali Loss: 0.1460304 Test Loss: 0.2230298
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 47 cost time: 0.9033493995666504
Epoch: 47, Steps: 64 | Train Loss: 0.0956092 Vali Loss: 0.1465265 Test Loss: 0.2237519
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 48 cost time: 0.9096176624298096
Epoch: 48, Steps: 64 | Train Loss: 0.0956937 Vali Loss: 0.1463136 Test Loss: 0.2237589
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 49 cost time: 0.8983950614929199
Epoch: 49, Steps: 64 | Train Loss: 0.0956020 Vali Loss: 0.1470938 Test Loss: 0.2237065
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 50 cost time: 0.898749828338623
Epoch: 50, Steps: 64 | Train Loss: 0.0947195 Vali Loss: 0.1461013 Test Loss: 0.2231260
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 51 cost time: 0.8990001678466797
Epoch: 51, Steps: 64 | Train Loss: 0.0952024 Vali Loss: 0.1473888 Test Loss: 0.2230315
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 52 cost time: 0.877000093460083
Epoch: 52, Steps: 64 | Train Loss: 0.0956069 Vali Loss: 0.1475278 Test Loss: 0.2233285
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 53 cost time: 0.9043452739715576
Epoch: 53, Steps: 64 | Train Loss: 0.0954542 Vali Loss: 0.1461556 Test Loss: 0.2232750
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 54 cost time: 0.9044187068939209
Epoch: 54, Steps: 64 | Train Loss: 0.0952641 Vali Loss: 0.1472540 Test Loss: 0.2230605
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 55 cost time: 0.9131059646606445
Epoch: 55, Steps: 64 | Train Loss: 0.0950488 Vali Loss: 0.1473567 Test Loss: 0.2232982
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 56 cost time: 0.9727671146392822
Epoch: 56, Steps: 64 | Train Loss: 0.0955536 Vali Loss: 0.1453731 Test Loss: 0.2230711
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 57 cost time: 0.9663784503936768
Epoch: 57, Steps: 64 | Train Loss: 0.0956034 Vali Loss: 0.1450607 Test Loss: 0.2230649
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 58 cost time: 0.9449079036712646
Epoch: 58, Steps: 64 | Train Loss: 0.0961291 Vali Loss: 0.1467407 Test Loss: 0.2234198
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 59 cost time: 0.9026262760162354
Epoch: 59, Steps: 64 | Train Loss: 0.0950323 Vali Loss: 0.1472748 Test Loss: 0.2230517
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 60 cost time: 0.8966174125671387
Epoch: 60, Steps: 64 | Train Loss: 0.0949829 Vali Loss: 0.1461453 Test Loss: 0.2234304
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.223053440451622, mae:0.3310040235519409, rse:0.23935285210609436
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07322454452514648 GB
Epoch: 1 cost time: 2.2563560009002686
Epoch: 1, Steps: 64 | Train Loss: 0.8480702 Vali Loss: 2.2783885 Test Loss: 3.5919440
Validation loss decreased (inf --> 2.278389).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 2 cost time: 0.8684680461883545
Epoch: 2, Steps: 64 | Train Loss: 0.3541011 Vali Loss: 0.2954556 Test Loss: 0.4005613
Validation loss decreased (2.278389 --> 0.295456).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 3 cost time: 0.8523755073547363
Epoch: 3, Steps: 64 | Train Loss: 0.1291641 Vali Loss: 0.1737474 Test Loss: 0.2177726
Validation loss decreased (0.295456 --> 0.173747).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 4 cost time: 0.8771266937255859
Epoch: 4, Steps: 64 | Train Loss: 0.1171880 Vali Loss: 0.1662894 Test Loss: 0.2186960
Validation loss decreased (0.173747 --> 0.166289).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 5 cost time: 0.8900940418243408
Epoch: 5, Steps: 64 | Train Loss: 0.1118542 Vali Loss: 0.1646570 Test Loss: 0.2186100
Validation loss decreased (0.166289 --> 0.164657).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 6 cost time: 0.8767280578613281
Epoch: 6, Steps: 64 | Train Loss: 0.1093149 Vali Loss: 0.1669475 Test Loss: 0.2181478
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 7 cost time: 0.8676207065582275
Epoch: 7, Steps: 64 | Train Loss: 0.1076977 Vali Loss: 0.1598818 Test Loss: 0.2189363
Validation loss decreased (0.164657 --> 0.159882).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 8 cost time: 0.8767435550689697
Epoch: 8, Steps: 64 | Train Loss: 0.1054472 Vali Loss: 0.1603882 Test Loss: 0.2204699
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 9 cost time: 0.855341911315918
Epoch: 9, Steps: 64 | Train Loss: 0.1040476 Vali Loss: 0.1566977 Test Loss: 0.2198710
Validation loss decreased (0.159882 --> 0.156698).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 10 cost time: 0.8813683986663818
Epoch: 10, Steps: 64 | Train Loss: 0.1026173 Vali Loss: 0.1547230 Test Loss: 0.2224248
Validation loss decreased (0.156698 --> 0.154723).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 11 cost time: 0.8737478256225586
Epoch: 11, Steps: 64 | Train Loss: 0.1013381 Vali Loss: 0.1556007 Test Loss: 0.2228072
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 12 cost time: 0.8820021152496338
Epoch: 12, Steps: 64 | Train Loss: 0.1005261 Vali Loss: 0.1552046 Test Loss: 0.2239835
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 13 cost time: 0.8776159286499023
Epoch: 13, Steps: 64 | Train Loss: 0.0995738 Vali Loss: 0.1537638 Test Loss: 0.2232143
Validation loss decreased (0.154723 --> 0.153764).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 14 cost time: 0.8743495941162109
Epoch: 14, Steps: 64 | Train Loss: 0.0984776 Vali Loss: 0.1519497 Test Loss: 0.2237928
Validation loss decreased (0.153764 --> 0.151950).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 15 cost time: 0.8763446807861328
Epoch: 15, Steps: 64 | Train Loss: 0.0980463 Vali Loss: 0.1519862 Test Loss: 0.2249064
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 16 cost time: 0.8863198757171631
Epoch: 16, Steps: 64 | Train Loss: 0.0974725 Vali Loss: 0.1501714 Test Loss: 0.2246280
Validation loss decreased (0.151950 --> 0.150171).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 17 cost time: 0.8814027309417725
Epoch: 17, Steps: 64 | Train Loss: 0.0969567 Vali Loss: 0.1523495 Test Loss: 0.2240776
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 18 cost time: 0.8759982585906982
Epoch: 18, Steps: 64 | Train Loss: 0.0969858 Vali Loss: 0.1476239 Test Loss: 0.2250750
Validation loss decreased (0.150171 --> 0.147624).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 19 cost time: 0.878615140914917
Epoch: 19, Steps: 64 | Train Loss: 0.0959969 Vali Loss: 0.1501912 Test Loss: 0.2258157
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 20 cost time: 0.8883240222930908
Epoch: 20, Steps: 64 | Train Loss: 0.0959556 Vali Loss: 0.1512179 Test Loss: 0.2259257
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 21 cost time: 0.8781130313873291
Epoch: 21, Steps: 64 | Train Loss: 0.0960978 Vali Loss: 0.1499800 Test Loss: 0.2249713
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 22 cost time: 0.8763847351074219
Epoch: 22, Steps: 64 | Train Loss: 0.0957674 Vali Loss: 0.1505259 Test Loss: 0.2258400
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 23 cost time: 0.8906979560852051
Epoch: 23, Steps: 64 | Train Loss: 0.0953653 Vali Loss: 0.1503187 Test Loss: 0.2264425
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 24 cost time: 0.874000072479248
Epoch: 24, Steps: 64 | Train Loss: 0.0953436 Vali Loss: 0.1499562 Test Loss: 0.2261660
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 25 cost time: 0.8776214122772217
Epoch: 25, Steps: 64 | Train Loss: 0.0951771 Vali Loss: 0.1484810 Test Loss: 0.2258023
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 26 cost time: 0.8724079132080078
Epoch: 26, Steps: 64 | Train Loss: 0.0948898 Vali Loss: 0.1489341 Test Loss: 0.2264218
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 27 cost time: 0.8663623332977295
Epoch: 27, Steps: 64 | Train Loss: 0.0948249 Vali Loss: 0.1479759 Test Loss: 0.2266980
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 28 cost time: 0.8773355484008789
Epoch: 28, Steps: 64 | Train Loss: 0.0949306 Vali Loss: 0.1497507 Test Loss: 0.2260719
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 29 cost time: 0.8767569065093994
Epoch: 29, Steps: 64 | Train Loss: 0.0947707 Vali Loss: 0.1499560 Test Loss: 0.2267796
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 30 cost time: 0.8853752613067627
Epoch: 30, Steps: 64 | Train Loss: 0.0945578 Vali Loss: 0.1494712 Test Loss: 0.2265159
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 31 cost time: 0.8776111602783203
Epoch: 31, Steps: 64 | Train Loss: 0.0942492 Vali Loss: 0.1482932 Test Loss: 0.2260861
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 32 cost time: 0.8806884288787842
Epoch: 32, Steps: 64 | Train Loss: 0.0943553 Vali Loss: 0.1482533 Test Loss: 0.2269036
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 33 cost time: 0.8683788776397705
Epoch: 33, Steps: 64 | Train Loss: 0.0942392 Vali Loss: 0.1491352 Test Loss: 0.2274032
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 34 cost time: 0.8603799343109131
Epoch: 34, Steps: 64 | Train Loss: 0.0942680 Vali Loss: 0.1504069 Test Loss: 0.2268207
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 35 cost time: 0.8773744106292725
Epoch: 35, Steps: 64 | Train Loss: 0.0946944 Vali Loss: 0.1481112 Test Loss: 0.2263475
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 36 cost time: 0.8790004253387451
Epoch: 36, Steps: 64 | Train Loss: 0.0939862 Vali Loss: 0.1515041 Test Loss: 0.2272173
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 37 cost time: 0.8756470680236816
Epoch: 37, Steps: 64 | Train Loss: 0.0944429 Vali Loss: 0.1480040 Test Loss: 0.2263692
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 38 cost time: 0.8783204555511475
Epoch: 38, Steps: 64 | Train Loss: 0.0939394 Vali Loss: 0.1486302 Test Loss: 0.2266157
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 39 cost time: 0.880366325378418
Epoch: 39, Steps: 64 | Train Loss: 0.0944397 Vali Loss: 0.1489812 Test Loss: 0.2267400
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 40 cost time: 0.8714017868041992
Epoch: 40, Steps: 64 | Train Loss: 0.0940671 Vali Loss: 0.1499148 Test Loss: 0.2271084
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 41 cost time: 0.8797235488891602
Epoch: 41, Steps: 64 | Train Loss: 0.0942150 Vali Loss: 0.1500717 Test Loss: 0.2270384
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 42 cost time: 0.875999927520752
Epoch: 42, Steps: 64 | Train Loss: 0.0937355 Vali Loss: 0.1485131 Test Loss: 0.2271726
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 43 cost time: 0.876439094543457
Epoch: 43, Steps: 64 | Train Loss: 0.0941361 Vali Loss: 0.1490364 Test Loss: 0.2270692
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 44 cost time: 0.8744807243347168
Epoch: 44, Steps: 64 | Train Loss: 0.0937320 Vali Loss: 0.1501481 Test Loss: 0.2278276
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 45 cost time: 0.8953430652618408
Epoch: 45, Steps: 64 | Train Loss: 0.0942476 Vali Loss: 0.1498401 Test Loss: 0.2270418
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 46 cost time: 0.876478910446167
Epoch: 46, Steps: 64 | Train Loss: 0.0939197 Vali Loss: 0.1496639 Test Loss: 0.2280618
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 47 cost time: 0.8707447052001953
Epoch: 47, Steps: 64 | Train Loss: 0.0943322 Vali Loss: 0.1488331 Test Loss: 0.2274805
EarlyStopping counter: 29 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 48 cost time: 0.8874037265777588
Epoch: 48, Steps: 64 | Train Loss: 0.0937699 Vali Loss: 0.1492414 Test Loss: 0.2266265
EarlyStopping counter: 30 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 49 cost time: 0.8596220016479492
Epoch: 49, Steps: 64 | Train Loss: 0.0938241 Vali Loss: 0.1484143 Test Loss: 0.2277730
EarlyStopping counter: 31 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 50 cost time: 0.877387285232544
Epoch: 50, Steps: 64 | Train Loss: 0.0937872 Vali Loss: 0.1496950 Test Loss: 0.2275512
EarlyStopping counter: 32 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 51 cost time: 0.8743753433227539
Epoch: 51, Steps: 64 | Train Loss: 0.0938255 Vali Loss: 0.1495243 Test Loss: 0.2274037
EarlyStopping counter: 33 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 52 cost time: 0.8534107208251953
Epoch: 52, Steps: 64 | Train Loss: 0.0940071 Vali Loss: 0.1503306 Test Loss: 0.2274741
EarlyStopping counter: 34 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 53 cost time: 0.8767831325531006
Epoch: 53, Steps: 64 | Train Loss: 0.0936005 Vali Loss: 0.1473904 Test Loss: 0.2271668
Validation loss decreased (0.147624 --> 0.147390).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 54 cost time: 0.876000165939331
Epoch: 54, Steps: 64 | Train Loss: 0.0943517 Vali Loss: 0.1499464 Test Loss: 0.2272775
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 55 cost time: 0.8726153373718262
Epoch: 55, Steps: 64 | Train Loss: 0.0939852 Vali Loss: 0.1483633 Test Loss: 0.2276346
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 56 cost time: 0.8673415184020996
Epoch: 56, Steps: 64 | Train Loss: 0.0938875 Vali Loss: 0.1496221 Test Loss: 0.2280035
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 57 cost time: 0.8750519752502441
Epoch: 57, Steps: 64 | Train Loss: 0.0941860 Vali Loss: 0.1485427 Test Loss: 0.2272982
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 58 cost time: 0.8803915977478027
Epoch: 58, Steps: 64 | Train Loss: 0.0940943 Vali Loss: 0.1500640 Test Loss: 0.2273802
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 59 cost time: 0.863710880279541
Epoch: 59, Steps: 64 | Train Loss: 0.0939881 Vali Loss: 0.1486639 Test Loss: 0.2271919
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 60 cost time: 0.9110000133514404
Epoch: 60, Steps: 64 | Train Loss: 0.0939034 Vali Loss: 0.1490075 Test Loss: 0.2271466
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.2271668165922165, mae:0.3391689658164978, rse:0.24154974520206451
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.06599807739257812 GB
Epoch: 1 cost time: 2.218979597091675
Epoch: 1, Steps: 64 | Train Loss: 1.1187935 Vali Loss: 2.8764458 Test Loss: 4.6354790
Validation loss decreased (inf --> 2.876446).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 2 cost time: 0.8816258907318115
Epoch: 2, Steps: 64 | Train Loss: 0.7216114 Vali Loss: 1.0680777 Test Loss: 1.6514030
Validation loss decreased (2.876446 --> 1.068078).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 3 cost time: 0.8679928779602051
Epoch: 3, Steps: 64 | Train Loss: 0.3733226 Vali Loss: 0.5922607 Test Loss: 0.8803820
Validation loss decreased (1.068078 --> 0.592261).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 4 cost time: 0.9555585384368896
Epoch: 4, Steps: 64 | Train Loss: 0.2470191 Vali Loss: 0.3849253 Test Loss: 0.5482837
Validation loss decreased (0.592261 --> 0.384925).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 5 cost time: 0.889380693435669
Epoch: 5, Steps: 64 | Train Loss: 0.1841911 Vali Loss: 0.2843330 Test Loss: 0.3947770
Validation loss decreased (0.384925 --> 0.284333).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 6 cost time: 0.8902568817138672
Epoch: 6, Steps: 64 | Train Loss: 0.1536276 Vali Loss: 0.2315400 Test Loss: 0.3144427
Validation loss decreased (0.284333 --> 0.231540).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 7 cost time: 0.8729996681213379
Epoch: 7, Steps: 64 | Train Loss: 0.1398997 Vali Loss: 0.2052205 Test Loss: 0.2750656
Validation loss decreased (0.231540 --> 0.205220).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 8 cost time: 0.8766112327575684
Epoch: 8, Steps: 64 | Train Loss: 0.1310246 Vali Loss: 0.1902373 Test Loss: 0.2546028
Validation loss decreased (0.205220 --> 0.190237).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 9 cost time: 0.8773832321166992
Epoch: 9, Steps: 64 | Train Loss: 0.1266172 Vali Loss: 0.1811872 Test Loss: 0.2438335
Validation loss decreased (0.190237 --> 0.181187).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 10 cost time: 0.8743934631347656
Epoch: 10, Steps: 64 | Train Loss: 0.1244341 Vali Loss: 0.1740656 Test Loss: 0.2370865
Validation loss decreased (0.181187 --> 0.174066).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 11 cost time: 0.880378007888794
Epoch: 11, Steps: 64 | Train Loss: 0.1216550 Vali Loss: 0.1707236 Test Loss: 0.2335549
Validation loss decreased (0.174066 --> 0.170724).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 12 cost time: 0.8797934055328369
Epoch: 12, Steps: 64 | Train Loss: 0.1197704 Vali Loss: 0.1663530 Test Loss: 0.2291429
Validation loss decreased (0.170724 --> 0.166353).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 13 cost time: 0.8949995040893555
Epoch: 13, Steps: 64 | Train Loss: 0.1184321 Vali Loss: 0.1650668 Test Loss: 0.2289605
Validation loss decreased (0.166353 --> 0.165067).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 14 cost time: 0.8776192665100098
Epoch: 14, Steps: 64 | Train Loss: 0.1174430 Vali Loss: 0.1658535 Test Loss: 0.2276817
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 15 cost time: 0.8764040470123291
Epoch: 15, Steps: 64 | Train Loss: 0.1160554 Vali Loss: 0.1630438 Test Loss: 0.2271924
Validation loss decreased (0.165067 --> 0.163044).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 16 cost time: 0.879361629486084
Epoch: 16, Steps: 64 | Train Loss: 0.1159408 Vali Loss: 0.1625726 Test Loss: 0.2269569
Validation loss decreased (0.163044 --> 0.162573).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 17 cost time: 0.8854212760925293
Epoch: 17, Steps: 64 | Train Loss: 0.1151620 Vali Loss: 0.1634876 Test Loss: 0.2258383
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 18 cost time: 0.8738250732421875
Epoch: 18, Steps: 64 | Train Loss: 0.1147398 Vali Loss: 0.1618473 Test Loss: 0.2264931
Validation loss decreased (0.162573 --> 0.161847).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 19 cost time: 0.880795955657959
Epoch: 19, Steps: 64 | Train Loss: 0.1145604 Vali Loss: 0.1622944 Test Loss: 0.2254684
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 20 cost time: 0.8772311210632324
Epoch: 20, Steps: 64 | Train Loss: 0.1135898 Vali Loss: 0.1609621 Test Loss: 0.2255391
Validation loss decreased (0.161847 --> 0.160962).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 21 cost time: 0.8884236812591553
Epoch: 21, Steps: 64 | Train Loss: 0.1131430 Vali Loss: 0.1608983 Test Loss: 0.2254889
Validation loss decreased (0.160962 --> 0.160898).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 22 cost time: 0.87837815284729
Epoch: 22, Steps: 64 | Train Loss: 0.1132593 Vali Loss: 0.1598853 Test Loss: 0.2247793
Validation loss decreased (0.160898 --> 0.159885).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 23 cost time: 0.8819997310638428
Epoch: 23, Steps: 64 | Train Loss: 0.1129456 Vali Loss: 0.1610755 Test Loss: 0.2259243
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 24 cost time: 0.8686206340789795
Epoch: 24, Steps: 64 | Train Loss: 0.1120927 Vali Loss: 0.1599896 Test Loss: 0.2248764
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 25 cost time: 0.8630003929138184
Epoch: 25, Steps: 64 | Train Loss: 0.1123127 Vali Loss: 0.1581230 Test Loss: 0.2248338
Validation loss decreased (0.159885 --> 0.158123).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 26 cost time: 0.8710000514984131
Epoch: 26, Steps: 64 | Train Loss: 0.1123716 Vali Loss: 0.1587470 Test Loss: 0.2238876
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 27 cost time: 0.8806250095367432
Epoch: 27, Steps: 64 | Train Loss: 0.1126211 Vali Loss: 0.1596303 Test Loss: 0.2246015
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 28 cost time: 0.8673920631408691
Epoch: 28, Steps: 64 | Train Loss: 0.1122544 Vali Loss: 0.1596210 Test Loss: 0.2256259
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 29 cost time: 0.9236650466918945
Epoch: 29, Steps: 64 | Train Loss: 0.1116542 Vali Loss: 0.1574596 Test Loss: 0.2245781
Validation loss decreased (0.158123 --> 0.157460).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 30 cost time: 0.8787925243377686
Epoch: 30, Steps: 64 | Train Loss: 0.1111911 Vali Loss: 0.1604939 Test Loss: 0.2252893
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 31 cost time: 0.88800048828125
Epoch: 31, Steps: 64 | Train Loss: 0.1114185 Vali Loss: 0.1575943 Test Loss: 0.2252757
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 32 cost time: 0.8766195774078369
Epoch: 32, Steps: 64 | Train Loss: 0.1115180 Vali Loss: 0.1591320 Test Loss: 0.2254162
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 33 cost time: 0.8782427310943604
Epoch: 33, Steps: 64 | Train Loss: 0.1113880 Vali Loss: 0.1577021 Test Loss: 0.2246709
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 34 cost time: 0.8817377090454102
Epoch: 34, Steps: 64 | Train Loss: 0.1106131 Vali Loss: 0.1577769 Test Loss: 0.2246421
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 35 cost time: 0.8823750019073486
Epoch: 35, Steps: 64 | Train Loss: 0.1102412 Vali Loss: 0.1585677 Test Loss: 0.2250092
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 36 cost time: 0.8787286281585693
Epoch: 36, Steps: 64 | Train Loss: 0.1114905 Vali Loss: 0.1578737 Test Loss: 0.2249689
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 37 cost time: 0.8804357051849365
Epoch: 37, Steps: 64 | Train Loss: 0.1105813 Vali Loss: 0.1564153 Test Loss: 0.2249705
Validation loss decreased (0.157460 --> 0.156415).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 38 cost time: 0.88761305809021
Epoch: 38, Steps: 64 | Train Loss: 0.1106711 Vali Loss: 0.1572854 Test Loss: 0.2246610
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 39 cost time: 0.9533729553222656
Epoch: 39, Steps: 64 | Train Loss: 0.1104283 Vali Loss: 0.1565932 Test Loss: 0.2242729
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 40 cost time: 0.8843364715576172
Epoch: 40, Steps: 64 | Train Loss: 0.1105364 Vali Loss: 0.1573454 Test Loss: 0.2249004
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 41 cost time: 0.8791947364807129
Epoch: 41, Steps: 64 | Train Loss: 0.1105025 Vali Loss: 0.1567325 Test Loss: 0.2251160
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 42 cost time: 0.8847007751464844
Epoch: 42, Steps: 64 | Train Loss: 0.1111630 Vali Loss: 0.1564266 Test Loss: 0.2246199
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 43 cost time: 0.8799998760223389
Epoch: 43, Steps: 64 | Train Loss: 0.1105101 Vali Loss: 0.1576365 Test Loss: 0.2242378
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 44 cost time: 0.8746232986450195
Epoch: 44, Steps: 64 | Train Loss: 0.1103773 Vali Loss: 0.1572673 Test Loss: 0.2248555
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 45 cost time: 0.8773388862609863
Epoch: 45, Steps: 64 | Train Loss: 0.1101264 Vali Loss: 0.1579627 Test Loss: 0.2245309
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 46 cost time: 0.9034173488616943
Epoch: 46, Steps: 64 | Train Loss: 0.1104201 Vali Loss: 0.1565642 Test Loss: 0.2245342
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 47 cost time: 0.8804128170013428
Epoch: 47, Steps: 64 | Train Loss: 0.1101834 Vali Loss: 0.1578099 Test Loss: 0.2241533
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 48 cost time: 0.8777530193328857
Epoch: 48, Steps: 64 | Train Loss: 0.1102148 Vali Loss: 0.1578989 Test Loss: 0.2248762
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 49 cost time: 0.8790006637573242
Epoch: 49, Steps: 64 | Train Loss: 0.1105376 Vali Loss: 0.1564712 Test Loss: 0.2252586
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 50 cost time: 0.8743622303009033
Epoch: 50, Steps: 64 | Train Loss: 0.1103089 Vali Loss: 0.1575123 Test Loss: 0.2250551
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 51 cost time: 0.8773469924926758
Epoch: 51, Steps: 64 | Train Loss: 0.1098774 Vali Loss: 0.1575724 Test Loss: 0.2242335
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 52 cost time: 0.8803513050079346
Epoch: 52, Steps: 64 | Train Loss: 0.1107033 Vali Loss: 0.1579238 Test Loss: 0.2251250
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 53 cost time: 0.8583171367645264
Epoch: 53, Steps: 64 | Train Loss: 0.1098824 Vali Loss: 0.1563835 Test Loss: 0.2248117
Validation loss decreased (0.156415 --> 0.156383).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 54 cost time: 0.85176682472229
Epoch: 54, Steps: 64 | Train Loss: 0.1102529 Vali Loss: 0.1575796 Test Loss: 0.2254025
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 55 cost time: 0.8796443939208984
Epoch: 55, Steps: 64 | Train Loss: 0.1104592 Vali Loss: 0.1579593 Test Loss: 0.2253354
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 56 cost time: 0.8876285552978516
Epoch: 56, Steps: 64 | Train Loss: 0.1101273 Vali Loss: 0.1572767 Test Loss: 0.2242982
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 57 cost time: 0.8743836879730225
Epoch: 57, Steps: 64 | Train Loss: 0.1102958 Vali Loss: 0.1563819 Test Loss: 0.2243591
Validation loss decreased (0.156383 --> 0.156382).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 58 cost time: 0.8773665428161621
Epoch: 58, Steps: 64 | Train Loss: 0.1105481 Vali Loss: 0.1567003 Test Loss: 0.2249605
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 59 cost time: 0.8784706592559814
Epoch: 59, Steps: 64 | Train Loss: 0.1095493 Vali Loss: 0.1557366 Test Loss: 0.2245087
Validation loss decreased (0.156382 --> 0.155737).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 60 cost time: 0.8881309032440186
Epoch: 60, Steps: 64 | Train Loss: 0.1102752 Vali Loss: 0.1561927 Test Loss: 0.2238960
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22450873255729675, mae:0.33153605461120605, rse:0.2401323914527893
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.07027053833007812 GB
Epoch: 1 cost time: 2.269454002380371
Epoch: 1, Steps: 64 | Train Loss: 0.9093426 Vali Loss: 2.3794353 Test Loss: 3.8096035
Validation loss decreased (inf --> 2.379435).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 2 cost time: 0.9246158599853516
Epoch: 2, Steps: 64 | Train Loss: 0.3966863 Vali Loss: 0.1963861 Test Loss: 0.2510625
Validation loss decreased (2.379435 --> 0.196386).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 3 cost time: 0.9243893623352051
Epoch: 3, Steps: 64 | Train Loss: 0.1302713 Vali Loss: 0.1840784 Test Loss: 0.2369848
Validation loss decreased (0.196386 --> 0.184078).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 4 cost time: 0.9248490333557129
Epoch: 4, Steps: 64 | Train Loss: 0.1192725 Vali Loss: 0.1699510 Test Loss: 0.2192214
Validation loss decreased (0.184078 --> 0.169951).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 5 cost time: 0.9163751602172852
Epoch: 5, Steps: 64 | Train Loss: 0.1148010 Vali Loss: 0.1642367 Test Loss: 0.2197641
Validation loss decreased (0.169951 --> 0.164237).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 6 cost time: 0.9184231758117676
Epoch: 6, Steps: 64 | Train Loss: 0.1122654 Vali Loss: 0.1646630 Test Loss: 0.2190211
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 7 cost time: 0.9194991588592529
Epoch: 7, Steps: 64 | Train Loss: 0.1093577 Vali Loss: 0.1577213 Test Loss: 0.2185143
Validation loss decreased (0.164237 --> 0.157721).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 8 cost time: 0.9188454151153564
Epoch: 8, Steps: 64 | Train Loss: 0.1080340 Vali Loss: 0.1591013 Test Loss: 0.2165560
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 9 cost time: 0.9149987697601318
Epoch: 9, Steps: 64 | Train Loss: 0.1068888 Vali Loss: 0.1582143 Test Loss: 0.2168016
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 10 cost time: 0.9316222667694092
Epoch: 10, Steps: 64 | Train Loss: 0.1061783 Vali Loss: 0.1576027 Test Loss: 0.2170386
Validation loss decreased (0.157721 --> 0.157603).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 11 cost time: 0.9173746109008789
Epoch: 11, Steps: 64 | Train Loss: 0.1047450 Vali Loss: 0.1554516 Test Loss: 0.2194559
Validation loss decreased (0.157603 --> 0.155452).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 12 cost time: 0.9123947620391846
Epoch: 12, Steps: 64 | Train Loss: 0.1042943 Vali Loss: 0.1579608 Test Loss: 0.2189192
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 13 cost time: 0.9183053970336914
Epoch: 13, Steps: 64 | Train Loss: 0.1030091 Vali Loss: 0.1550762 Test Loss: 0.2183677
Validation loss decreased (0.155452 --> 0.155076).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 14 cost time: 0.9258527755737305
Epoch: 14, Steps: 64 | Train Loss: 0.1026190 Vali Loss: 0.1537776 Test Loss: 0.2196115
Validation loss decreased (0.155076 --> 0.153778).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 15 cost time: 0.9174778461456299
Epoch: 15, Steps: 64 | Train Loss: 0.1021012 Vali Loss: 0.1527558 Test Loss: 0.2193202
Validation loss decreased (0.153778 --> 0.152756).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 16 cost time: 0.9183638095855713
Epoch: 16, Steps: 64 | Train Loss: 0.1017122 Vali Loss: 0.1531296 Test Loss: 0.2191505
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 17 cost time: 0.9264309406280518
Epoch: 17, Steps: 64 | Train Loss: 0.1008970 Vali Loss: 0.1509773 Test Loss: 0.2188950
Validation loss decreased (0.152756 --> 0.150977).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 18 cost time: 0.9256191253662109
Epoch: 18, Steps: 64 | Train Loss: 0.1003625 Vali Loss: 0.1512100 Test Loss: 0.2202439
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 19 cost time: 0.9163668155670166
Epoch: 19, Steps: 64 | Train Loss: 0.1002593 Vali Loss: 0.1498097 Test Loss: 0.2197617
Validation loss decreased (0.150977 --> 0.149810).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 20 cost time: 0.9203579425811768
Epoch: 20, Steps: 64 | Train Loss: 0.0999768 Vali Loss: 0.1509840 Test Loss: 0.2203356
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 21 cost time: 0.9164018630981445
Epoch: 21, Steps: 64 | Train Loss: 0.0994094 Vali Loss: 0.1509330 Test Loss: 0.2202678
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 22 cost time: 0.9197816848754883
Epoch: 22, Steps: 64 | Train Loss: 0.0992489 Vali Loss: 0.1494931 Test Loss: 0.2207739
Validation loss decreased (0.149810 --> 0.149493).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 23 cost time: 0.9123663902282715
Epoch: 23, Steps: 64 | Train Loss: 0.0988992 Vali Loss: 0.1514065 Test Loss: 0.2206315
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 24 cost time: 0.902768611907959
Epoch: 24, Steps: 64 | Train Loss: 0.0988275 Vali Loss: 0.1477840 Test Loss: 0.2211791
Validation loss decreased (0.149493 --> 0.147784).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 25 cost time: 0.9173529148101807
Epoch: 25, Steps: 64 | Train Loss: 0.0989360 Vali Loss: 0.1495842 Test Loss: 0.2210393
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 26 cost time: 0.9176208972930908
Epoch: 26, Steps: 64 | Train Loss: 0.0986098 Vali Loss: 0.1486775 Test Loss: 0.2208153
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 27 cost time: 0.9343240261077881
Epoch: 27, Steps: 64 | Train Loss: 0.0986709 Vali Loss: 0.1489750 Test Loss: 0.2215075
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 28 cost time: 0.9173629283905029
Epoch: 28, Steps: 64 | Train Loss: 0.0983582 Vali Loss: 0.1493017 Test Loss: 0.2213231
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 29 cost time: 0.9203441143035889
Epoch: 29, Steps: 64 | Train Loss: 0.0983781 Vali Loss: 0.1485989 Test Loss: 0.2213744
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 30 cost time: 0.923184871673584
Epoch: 30, Steps: 64 | Train Loss: 0.0983825 Vali Loss: 0.1476335 Test Loss: 0.2210404
Validation loss decreased (0.147784 --> 0.147634).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 31 cost time: 0.89076828956604
Epoch: 31, Steps: 64 | Train Loss: 0.0984085 Vali Loss: 0.1492111 Test Loss: 0.2214203
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 32 cost time: 0.9077167510986328
Epoch: 32, Steps: 64 | Train Loss: 0.0981669 Vali Loss: 0.1485013 Test Loss: 0.2210032
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 33 cost time: 0.9149999618530273
Epoch: 33, Steps: 64 | Train Loss: 0.0980228 Vali Loss: 0.1479378 Test Loss: 0.2213537
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 34 cost time: 0.9276249408721924
Epoch: 34, Steps: 64 | Train Loss: 0.0979242 Vali Loss: 0.1473569 Test Loss: 0.2215172
Validation loss decreased (0.147634 --> 0.147357).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 35 cost time: 0.9234626293182373
Epoch: 35, Steps: 64 | Train Loss: 0.0980903 Vali Loss: 0.1493441 Test Loss: 0.2212843
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 36 cost time: 0.9233746528625488
Epoch: 36, Steps: 64 | Train Loss: 0.0976755 Vali Loss: 0.1472893 Test Loss: 0.2210035
Validation loss decreased (0.147357 --> 0.147289).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 37 cost time: 0.916130781173706
Epoch: 37, Steps: 64 | Train Loss: 0.0977515 Vali Loss: 0.1487707 Test Loss: 0.2210108
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 38 cost time: 0.9243912696838379
Epoch: 38, Steps: 64 | Train Loss: 0.0976874 Vali Loss: 0.1481083 Test Loss: 0.2216166
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 39 cost time: 0.918698787689209
Epoch: 39, Steps: 64 | Train Loss: 0.0977320 Vali Loss: 0.1488868 Test Loss: 0.2214271
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 40 cost time: 0.9137363433837891
Epoch: 40, Steps: 64 | Train Loss: 0.0976741 Vali Loss: 0.1494320 Test Loss: 0.2211149
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 41 cost time: 0.9243369102478027
Epoch: 41, Steps: 64 | Train Loss: 0.0975871 Vali Loss: 0.1478059 Test Loss: 0.2215189
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 42 cost time: 0.9150004386901855
Epoch: 42, Steps: 64 | Train Loss: 0.0978115 Vali Loss: 0.1482684 Test Loss: 0.2215163
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 43 cost time: 0.915621280670166
Epoch: 43, Steps: 64 | Train Loss: 0.0971342 Vali Loss: 0.1483896 Test Loss: 0.2213333
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 44 cost time: 0.9183382987976074
Epoch: 44, Steps: 64 | Train Loss: 0.0968354 Vali Loss: 0.1460860 Test Loss: 0.2216049
Validation loss decreased (0.147289 --> 0.146086).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 45 cost time: 0.9043700695037842
Epoch: 45, Steps: 64 | Train Loss: 0.0973172 Vali Loss: 0.1484997 Test Loss: 0.2217213
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 46 cost time: 0.9224045276641846
Epoch: 46, Steps: 64 | Train Loss: 0.0973983 Vali Loss: 0.1478024 Test Loss: 0.2218464
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 47 cost time: 0.9227533340454102
Epoch: 47, Steps: 64 | Train Loss: 0.0967920 Vali Loss: 0.1478066 Test Loss: 0.2213371
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 48 cost time: 0.9237563610076904
Epoch: 48, Steps: 64 | Train Loss: 0.0972496 Vali Loss: 0.1476449 Test Loss: 0.2217607
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 49 cost time: 0.9190001487731934
Epoch: 49, Steps: 64 | Train Loss: 0.0973296 Vali Loss: 0.1471204 Test Loss: 0.2220545
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 50 cost time: 0.9226751327514648
Epoch: 50, Steps: 64 | Train Loss: 0.0973775 Vali Loss: 0.1471755 Test Loss: 0.2215534
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 51 cost time: 0.9331667423248291
Epoch: 51, Steps: 64 | Train Loss: 0.0973454 Vali Loss: 0.1482523 Test Loss: 0.2217092
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 52 cost time: 0.9289014339447021
Epoch: 52, Steps: 64 | Train Loss: 0.0971267 Vali Loss: 0.1482151 Test Loss: 0.2220834
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 53 cost time: 0.924382209777832
Epoch: 53, Steps: 64 | Train Loss: 0.0973899 Vali Loss: 0.1456135 Test Loss: 0.2216331
Validation loss decreased (0.146086 --> 0.145614).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 54 cost time: 0.9274756908416748
Epoch: 54, Steps: 64 | Train Loss: 0.0976087 Vali Loss: 0.1489052 Test Loss: 0.2216204
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 55 cost time: 0.9317471981048584
Epoch: 55, Steps: 64 | Train Loss: 0.0971896 Vali Loss: 0.1480841 Test Loss: 0.2219121
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 56 cost time: 0.9254646301269531
Epoch: 56, Steps: 64 | Train Loss: 0.0973424 Vali Loss: 0.1485817 Test Loss: 0.2219377
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 57 cost time: 0.9189999103546143
Epoch: 57, Steps: 64 | Train Loss: 0.0973496 Vali Loss: 0.1468908 Test Loss: 0.2216439
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 58 cost time: 0.9296200275421143
Epoch: 58, Steps: 64 | Train Loss: 0.0971677 Vali Loss: 0.1476953 Test Loss: 0.2216014
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 59 cost time: 0.917738676071167
Epoch: 59, Steps: 64 | Train Loss: 0.0972147 Vali Loss: 0.1470411 Test Loss: 0.2216190
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 60 cost time: 0.9184072017669678
Epoch: 60, Steps: 64 | Train Loss: 0.0969167 Vali Loss: 0.1472654 Test Loss: 0.2217455
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22163309156894684, mae:0.3285214900970459, rse:0.2385895699262619
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07338619232177734 GB
Epoch: 1 cost time: 2.2157037258148193
Epoch: 1, Steps: 64 | Train Loss: 0.8469464 Vali Loss: 2.2581966 Test Loss: 3.5944667
Validation loss decreased (inf --> 2.258197).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 2 cost time: 0.8554978370666504
Epoch: 2, Steps: 64 | Train Loss: 0.3376854 Vali Loss: 0.2496166 Test Loss: 0.3514228
Validation loss decreased (2.258197 --> 0.249617).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 3 cost time: 0.8593540191650391
Epoch: 3, Steps: 64 | Train Loss: 0.1262597 Vali Loss: 0.1743525 Test Loss: 0.2193473
Validation loss decreased (0.249617 --> 0.174352).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 4 cost time: 0.9752154350280762
Epoch: 4, Steps: 64 | Train Loss: 0.1152376 Vali Loss: 0.1683884 Test Loss: 0.2221979
Validation loss decreased (0.174352 --> 0.168388).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 5 cost time: 0.8973610401153564
Epoch: 5, Steps: 64 | Train Loss: 0.1108192 Vali Loss: 0.1679209 Test Loss: 0.2224213
Validation loss decreased (0.168388 --> 0.167921).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 6 cost time: 0.887615442276001
Epoch: 6, Steps: 64 | Train Loss: 0.1088904 Vali Loss: 0.1617010 Test Loss: 0.2207979
Validation loss decreased (0.167921 --> 0.161701).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 7 cost time: 0.8824827671051025
Epoch: 7, Steps: 64 | Train Loss: 0.1068658 Vali Loss: 0.1572278 Test Loss: 0.2209673
Validation loss decreased (0.161701 --> 0.157228).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 8 cost time: 0.8811030387878418
Epoch: 8, Steps: 64 | Train Loss: 0.1049102 Vali Loss: 0.1615653 Test Loss: 0.2223826
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 9 cost time: 0.8853847980499268
Epoch: 9, Steps: 64 | Train Loss: 0.1038912 Vali Loss: 0.1564458 Test Loss: 0.2224194
Validation loss decreased (0.157228 --> 0.156446).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 10 cost time: 0.8923633098602295
Epoch: 10, Steps: 64 | Train Loss: 0.1027448 Vali Loss: 0.1561273 Test Loss: 0.2243253
Validation loss decreased (0.156446 --> 0.156127).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 11 cost time: 0.8810005187988281
Epoch: 11, Steps: 64 | Train Loss: 0.1019704 Vali Loss: 0.1548237 Test Loss: 0.2243868
Validation loss decreased (0.156127 --> 0.154824).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 12 cost time: 0.8796243667602539
Epoch: 12, Steps: 64 | Train Loss: 0.1009417 Vali Loss: 0.1536489 Test Loss: 0.2245522
Validation loss decreased (0.154824 --> 0.153649).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 13 cost time: 0.8903987407684326
Epoch: 13, Steps: 64 | Train Loss: 0.1002647 Vali Loss: 0.1552768 Test Loss: 0.2256941
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 14 cost time: 0.8803894519805908
Epoch: 14, Steps: 64 | Train Loss: 0.0998462 Vali Loss: 0.1504833 Test Loss: 0.2231375
Validation loss decreased (0.153649 --> 0.150483).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 15 cost time: 0.8853514194488525
Epoch: 15, Steps: 64 | Train Loss: 0.0994170 Vali Loss: 0.1530919 Test Loss: 0.2265152
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 16 cost time: 0.8921051025390625
Epoch: 16, Steps: 64 | Train Loss: 0.0986081 Vali Loss: 0.1463321 Test Loss: 0.2250166
Validation loss decreased (0.150483 --> 0.146332).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 17 cost time: 0.8827202320098877
Epoch: 17, Steps: 64 | Train Loss: 0.0982840 Vali Loss: 0.1501949 Test Loss: 0.2267355
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 18 cost time: 0.892714262008667
Epoch: 18, Steps: 64 | Train Loss: 0.0981904 Vali Loss: 0.1482346 Test Loss: 0.2250347
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 19 cost time: 0.9016351699829102
Epoch: 19, Steps: 64 | Train Loss: 0.0978334 Vali Loss: 0.1479322 Test Loss: 0.2256666
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 20 cost time: 0.8874549865722656
Epoch: 20, Steps: 64 | Train Loss: 0.0975280 Vali Loss: 0.1480088 Test Loss: 0.2254516
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 21 cost time: 0.8883562088012695
Epoch: 21, Steps: 64 | Train Loss: 0.0968572 Vali Loss: 0.1464438 Test Loss: 0.2263501
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 22 cost time: 0.886603593826294
Epoch: 22, Steps: 64 | Train Loss: 0.0972594 Vali Loss: 0.1479973 Test Loss: 0.2259641
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 23 cost time: 0.8938636779785156
Epoch: 23, Steps: 64 | Train Loss: 0.0970391 Vali Loss: 0.1464641 Test Loss: 0.2267515
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 24 cost time: 0.885000467300415
Epoch: 24, Steps: 64 | Train Loss: 0.0962307 Vali Loss: 0.1467769 Test Loss: 0.2273070
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 25 cost time: 0.8839998245239258
Epoch: 25, Steps: 64 | Train Loss: 0.0966812 Vali Loss: 0.1441786 Test Loss: 0.2274128
Validation loss decreased (0.146332 --> 0.144179).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 26 cost time: 0.8926291465759277
Epoch: 26, Steps: 64 | Train Loss: 0.0956097 Vali Loss: 0.1464834 Test Loss: 0.2271951
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 27 cost time: 0.8750200271606445
Epoch: 27, Steps: 64 | Train Loss: 0.0967325 Vali Loss: 0.1468098 Test Loss: 0.2277193
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 28 cost time: 0.892390251159668
Epoch: 28, Steps: 64 | Train Loss: 0.0962757 Vali Loss: 0.1453280 Test Loss: 0.2270159
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 29 cost time: 0.8961787223815918
Epoch: 29, Steps: 64 | Train Loss: 0.0963478 Vali Loss: 0.1454216 Test Loss: 0.2268637
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 30 cost time: 0.8767638206481934
Epoch: 30, Steps: 64 | Train Loss: 0.0961076 Vali Loss: 0.1454131 Test Loss: 0.2271944
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 31 cost time: 0.8537323474884033
Epoch: 31, Steps: 64 | Train Loss: 0.0961342 Vali Loss: 0.1458759 Test Loss: 0.2278635
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 32 cost time: 0.8966145515441895
Epoch: 32, Steps: 64 | Train Loss: 0.0960261 Vali Loss: 0.1474112 Test Loss: 0.2285323
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 33 cost time: 0.8957688808441162
Epoch: 33, Steps: 64 | Train Loss: 0.0959949 Vali Loss: 0.1455324 Test Loss: 0.2276928
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 34 cost time: 0.8975193500518799
Epoch: 34, Steps: 64 | Train Loss: 0.0954936 Vali Loss: 0.1461936 Test Loss: 0.2278160
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 35 cost time: 0.8907263278961182
Epoch: 35, Steps: 64 | Train Loss: 0.0956801 Vali Loss: 0.1469516 Test Loss: 0.2274018
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 36 cost time: 0.8907852172851562
Epoch: 36, Steps: 64 | Train Loss: 0.0956434 Vali Loss: 0.1451498 Test Loss: 0.2276007
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 37 cost time: 0.8979995250701904
Epoch: 37, Steps: 64 | Train Loss: 0.0952915 Vali Loss: 0.1470212 Test Loss: 0.2275546
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 38 cost time: 0.8889994621276855
Epoch: 38, Steps: 64 | Train Loss: 0.0956046 Vali Loss: 0.1453628 Test Loss: 0.2282053
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 39 cost time: 0.8986194133758545
Epoch: 39, Steps: 64 | Train Loss: 0.0955341 Vali Loss: 0.1461502 Test Loss: 0.2277839
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 40 cost time: 0.9103820323944092
Epoch: 40, Steps: 64 | Train Loss: 0.0953666 Vali Loss: 0.1461142 Test Loss: 0.2280874
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 41 cost time: 0.8945391178131104
Epoch: 41, Steps: 64 | Train Loss: 0.0953320 Vali Loss: 0.1462256 Test Loss: 0.2283872
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 42 cost time: 0.8888287544250488
Epoch: 42, Steps: 64 | Train Loss: 0.0949634 Vali Loss: 0.1463661 Test Loss: 0.2282804
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 43 cost time: 0.89019775390625
Epoch: 43, Steps: 64 | Train Loss: 0.0956298 Vali Loss: 0.1457959 Test Loss: 0.2280748
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 44 cost time: 0.9189996719360352
Epoch: 44, Steps: 64 | Train Loss: 0.0956665 Vali Loss: 0.1443942 Test Loss: 0.2286374
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 45 cost time: 0.8929998874664307
Epoch: 45, Steps: 64 | Train Loss: 0.0957498 Vali Loss: 0.1476055 Test Loss: 0.2282897
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 46 cost time: 0.8980712890625
Epoch: 46, Steps: 64 | Train Loss: 0.0950884 Vali Loss: 0.1439771 Test Loss: 0.2282878
Validation loss decreased (0.144179 --> 0.143977).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 47 cost time: 0.9023354053497314
Epoch: 47, Steps: 64 | Train Loss: 0.0952332 Vali Loss: 0.1455910 Test Loss: 0.2284854
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 48 cost time: 0.8918435573577881
Epoch: 48, Steps: 64 | Train Loss: 0.0952254 Vali Loss: 0.1462257 Test Loss: 0.2285409
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 49 cost time: 0.8889920711517334
Epoch: 49, Steps: 64 | Train Loss: 0.0949760 Vali Loss: 0.1454523 Test Loss: 0.2276729
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 50 cost time: 0.8874118328094482
Epoch: 50, Steps: 64 | Train Loss: 0.0949876 Vali Loss: 0.1451815 Test Loss: 0.2289245
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 51 cost time: 0.8760004043579102
Epoch: 51, Steps: 64 | Train Loss: 0.0951281 Vali Loss: 0.1448883 Test Loss: 0.2277851
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 52 cost time: 0.8836171627044678
Epoch: 52, Steps: 64 | Train Loss: 0.0959189 Vali Loss: 0.1463424 Test Loss: 0.2281998
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 53 cost time: 0.8853740692138672
Epoch: 53, Steps: 64 | Train Loss: 0.0948362 Vali Loss: 0.1449773 Test Loss: 0.2282352
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 54 cost time: 0.9040031433105469
Epoch: 54, Steps: 64 | Train Loss: 0.0948652 Vali Loss: 0.1439125 Test Loss: 0.2278114
Validation loss decreased (0.143977 --> 0.143913).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 55 cost time: 0.8864316940307617
Epoch: 55, Steps: 64 | Train Loss: 0.0951938 Vali Loss: 0.1447377 Test Loss: 0.2284626
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 56 cost time: 0.8823521137237549
Epoch: 56, Steps: 64 | Train Loss: 0.0949694 Vali Loss: 0.1466587 Test Loss: 0.2281610
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 57 cost time: 0.885714054107666
Epoch: 57, Steps: 64 | Train Loss: 0.0953967 Vali Loss: 0.1445121 Test Loss: 0.2272617
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 58 cost time: 0.8849971294403076
Epoch: 58, Steps: 64 | Train Loss: 0.0949518 Vali Loss: 0.1446337 Test Loss: 0.2284688
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 59 cost time: 0.8882496356964111
Epoch: 59, Steps: 64 | Train Loss: 0.0952050 Vali Loss: 0.1443566 Test Loss: 0.2282573
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 60 cost time: 0.8873584270477295
Epoch: 60, Steps: 64 | Train Loss: 0.0949814 Vali Loss: 0.1446037 Test Loss: 0.2284966
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22781141102313995, mae:0.3372310996055603, rse:0.24189220368862152
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.06616020202636719 GB
Epoch: 1 cost time: 2.2146520614624023
Epoch: 1, Steps: 64 | Train Loss: 1.0092231 Vali Loss: 2.5931721 Test Loss: 4.1059670
Validation loss decreased (inf --> 2.593172).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 2 cost time: 0.8728137016296387
Epoch: 2, Steps: 64 | Train Loss: 0.6678141 Vali Loss: 0.9775184 Test Loss: 1.4742494
Validation loss decreased (2.593172 --> 0.977518).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 3 cost time: 0.8759996891021729
Epoch: 3, Steps: 64 | Train Loss: 0.3433938 Vali Loss: 0.4954364 Test Loss: 0.6965110
Validation loss decreased (0.977518 --> 0.495436).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 4 cost time: 0.8803648948669434
Epoch: 4, Steps: 64 | Train Loss: 0.2182242 Vali Loss: 0.3224379 Test Loss: 0.4324989
Validation loss decreased (0.495436 --> 0.322438).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 5 cost time: 0.8804004192352295
Epoch: 5, Steps: 64 | Train Loss: 0.1668018 Vali Loss: 0.2438775 Test Loss: 0.3185140
Validation loss decreased (0.322438 --> 0.243878).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 6 cost time: 0.8853838443756104
Epoch: 6, Steps: 64 | Train Loss: 0.1458846 Vali Loss: 0.2071238 Test Loss: 0.2661563
Validation loss decreased (0.243878 --> 0.207124).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 7 cost time: 0.8773298263549805
Epoch: 7, Steps: 64 | Train Loss: 0.1352596 Vali Loss: 0.1903731 Test Loss: 0.2415728
Validation loss decreased (0.207124 --> 0.190373).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 8 cost time: 0.8763790130615234
Epoch: 8, Steps: 64 | Train Loss: 0.1290761 Vali Loss: 0.1793146 Test Loss: 0.2337250
Validation loss decreased (0.190373 --> 0.179315).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 9 cost time: 0.8517732620239258
Epoch: 9, Steps: 64 | Train Loss: 0.1265747 Vali Loss: 0.1747881 Test Loss: 0.2287010
Validation loss decreased (0.179315 --> 0.174788).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 10 cost time: 0.8900008201599121
Epoch: 10, Steps: 64 | Train Loss: 0.1234897 Vali Loss: 0.1734769 Test Loss: 0.2263340
Validation loss decreased (0.174788 --> 0.173477).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 11 cost time: 0.8926184177398682
Epoch: 11, Steps: 64 | Train Loss: 0.1224155 Vali Loss: 0.1692822 Test Loss: 0.2237967
Validation loss decreased (0.173477 --> 0.169282).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 12 cost time: 0.9123961925506592
Epoch: 12, Steps: 64 | Train Loss: 0.1205389 Vali Loss: 0.1666916 Test Loss: 0.2232700
Validation loss decreased (0.169282 --> 0.166692).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 13 cost time: 0.8973348140716553
Epoch: 13, Steps: 64 | Train Loss: 0.1193775 Vali Loss: 0.1681486 Test Loss: 0.2230183
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 14 cost time: 0.8905491828918457
Epoch: 14, Steps: 64 | Train Loss: 0.1181529 Vali Loss: 0.1647815 Test Loss: 0.2228583
Validation loss decreased (0.166692 --> 0.164782).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 15 cost time: 0.8904204368591309
Epoch: 15, Steps: 64 | Train Loss: 0.1175211 Vali Loss: 0.1628171 Test Loss: 0.2214957
Validation loss decreased (0.164782 --> 0.162817).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 16 cost time: 0.8927769660949707
Epoch: 16, Steps: 64 | Train Loss: 0.1165525 Vali Loss: 0.1645762 Test Loss: 0.2211273
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 17 cost time: 0.8902299404144287
Epoch: 17, Steps: 64 | Train Loss: 0.1159984 Vali Loss: 0.1636354 Test Loss: 0.2215749
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 18 cost time: 0.8936326503753662
Epoch: 18, Steps: 64 | Train Loss: 0.1146530 Vali Loss: 0.1618815 Test Loss: 0.2199501
Validation loss decreased (0.162817 --> 0.161881).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 19 cost time: 0.9094278812408447
Epoch: 19, Steps: 64 | Train Loss: 0.1140940 Vali Loss: 0.1619667 Test Loss: 0.2214036
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 20 cost time: 0.8871910572052002
Epoch: 20, Steps: 64 | Train Loss: 0.1133716 Vali Loss: 0.1623193 Test Loss: 0.2217358
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 21 cost time: 0.891394853591919
Epoch: 21, Steps: 64 | Train Loss: 0.1131518 Vali Loss: 0.1610596 Test Loss: 0.2213696
Validation loss decreased (0.161881 --> 0.161060).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 22 cost time: 0.8887624740600586
Epoch: 22, Steps: 64 | Train Loss: 0.1131552 Vali Loss: 0.1602377 Test Loss: 0.2205925
Validation loss decreased (0.161060 --> 0.160238).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 23 cost time: 0.8989999294281006
Epoch: 23, Steps: 64 | Train Loss: 0.1127714 Vali Loss: 0.1589824 Test Loss: 0.2204977
Validation loss decreased (0.160238 --> 0.158982).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 24 cost time: 0.8901026248931885
Epoch: 24, Steps: 64 | Train Loss: 0.1120479 Vali Loss: 0.1588823 Test Loss: 0.2212396
Validation loss decreased (0.158982 --> 0.158882).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 25 cost time: 0.8823614120483398
Epoch: 25, Steps: 64 | Train Loss: 0.1117375 Vali Loss: 0.1588691 Test Loss: 0.2211349
Validation loss decreased (0.158882 --> 0.158869).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 26 cost time: 0.8823685646057129
Epoch: 26, Steps: 64 | Train Loss: 0.1112249 Vali Loss: 0.1587759 Test Loss: 0.2203630
Validation loss decreased (0.158869 --> 0.158776).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 27 cost time: 0.870490312576294
Epoch: 27, Steps: 64 | Train Loss: 0.1114569 Vali Loss: 0.1568251 Test Loss: 0.2212897
Validation loss decreased (0.158776 --> 0.156825).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 28 cost time: 0.8847830295562744
Epoch: 28, Steps: 64 | Train Loss: 0.1111971 Vali Loss: 0.1576854 Test Loss: 0.2209177
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 29 cost time: 0.886000394821167
Epoch: 29, Steps: 64 | Train Loss: 0.1105625 Vali Loss: 0.1584997 Test Loss: 0.2213608
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 30 cost time: 0.8850760459899902
Epoch: 30, Steps: 64 | Train Loss: 0.1110883 Vali Loss: 0.1572643 Test Loss: 0.2207172
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 31 cost time: 0.8786182403564453
Epoch: 31, Steps: 64 | Train Loss: 0.1109615 Vali Loss: 0.1571801 Test Loss: 0.2206136
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 32 cost time: 0.8813977241516113
Epoch: 32, Steps: 64 | Train Loss: 0.1104021 Vali Loss: 0.1571437 Test Loss: 0.2206933
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 33 cost time: 0.8904240131378174
Epoch: 33, Steps: 64 | Train Loss: 0.1103150 Vali Loss: 0.1565216 Test Loss: 0.2214456
Validation loss decreased (0.156825 --> 0.156522).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 34 cost time: 0.881359338760376
Epoch: 34, Steps: 64 | Train Loss: 0.1102704 Vali Loss: 0.1582078 Test Loss: 0.2205746
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 35 cost time: 0.8803582191467285
Epoch: 35, Steps: 64 | Train Loss: 0.1100137 Vali Loss: 0.1554675 Test Loss: 0.2200105
Validation loss decreased (0.156522 --> 0.155467).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 36 cost time: 0.8823635578155518
Epoch: 36, Steps: 64 | Train Loss: 0.1098360 Vali Loss: 0.1571952 Test Loss: 0.2206140
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 37 cost time: 0.8976187705993652
Epoch: 37, Steps: 64 | Train Loss: 0.1100435 Vali Loss: 0.1554368 Test Loss: 0.2211317
Validation loss decreased (0.155467 --> 0.155437).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 38 cost time: 0.8915634155273438
Epoch: 38, Steps: 64 | Train Loss: 0.1090646 Vali Loss: 0.1576632 Test Loss: 0.2212691
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 39 cost time: 0.8863241672515869
Epoch: 39, Steps: 64 | Train Loss: 0.1100722 Vali Loss: 0.1566480 Test Loss: 0.2203840
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 40 cost time: 0.8820984363555908
Epoch: 40, Steps: 64 | Train Loss: 0.1095652 Vali Loss: 0.1563706 Test Loss: 0.2203052
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 41 cost time: 0.8794071674346924
Epoch: 41, Steps: 64 | Train Loss: 0.1094628 Vali Loss: 0.1564740 Test Loss: 0.2207905
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 42 cost time: 0.8960001468658447
Epoch: 42, Steps: 64 | Train Loss: 0.1092947 Vali Loss: 0.1552892 Test Loss: 0.2201319
Validation loss decreased (0.155437 --> 0.155289).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 43 cost time: 0.8950603008270264
Epoch: 43, Steps: 64 | Train Loss: 0.1094400 Vali Loss: 0.1558210 Test Loss: 0.2208767
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 44 cost time: 0.8932781219482422
Epoch: 44, Steps: 64 | Train Loss: 0.1092894 Vali Loss: 0.1561359 Test Loss: 0.2201879
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 45 cost time: 0.8863563537597656
Epoch: 45, Steps: 64 | Train Loss: 0.1091453 Vali Loss: 0.1544588 Test Loss: 0.2207698
Validation loss decreased (0.155289 --> 0.154459).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 46 cost time: 0.879370927810669
Epoch: 46, Steps: 64 | Train Loss: 0.1093291 Vali Loss: 0.1567897 Test Loss: 0.2207324
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 47 cost time: 0.8817832469940186
Epoch: 47, Steps: 64 | Train Loss: 0.1093609 Vali Loss: 0.1562334 Test Loss: 0.2207228
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 48 cost time: 0.8676278591156006
Epoch: 48, Steps: 64 | Train Loss: 0.1088322 Vali Loss: 0.1570453 Test Loss: 0.2209728
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 49 cost time: 0.8856112957000732
Epoch: 49, Steps: 64 | Train Loss: 0.1093514 Vali Loss: 0.1558103 Test Loss: 0.2207573
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 50 cost time: 0.8762035369873047
Epoch: 50, Steps: 64 | Train Loss: 0.1089912 Vali Loss: 0.1573923 Test Loss: 0.2209338
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 51 cost time: 0.8884069919586182
Epoch: 51, Steps: 64 | Train Loss: 0.1091438 Vali Loss: 0.1552383 Test Loss: 0.2214848
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 52 cost time: 0.845360517501831
Epoch: 52, Steps: 64 | Train Loss: 0.1093812 Vali Loss: 0.1565655 Test Loss: 0.2210260
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 53 cost time: 0.8565998077392578
Epoch: 53, Steps: 64 | Train Loss: 0.1089749 Vali Loss: 0.1565625 Test Loss: 0.2206192
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 54 cost time: 0.8827691078186035
Epoch: 54, Steps: 64 | Train Loss: 0.1086627 Vali Loss: 0.1564101 Test Loss: 0.2205686
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 55 cost time: 0.8836104869842529
Epoch: 55, Steps: 64 | Train Loss: 0.1091481 Vali Loss: 0.1561029 Test Loss: 0.2207760
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 56 cost time: 0.8854069709777832
Epoch: 56, Steps: 64 | Train Loss: 0.1082601 Vali Loss: 0.1539608 Test Loss: 0.2209378
Validation loss decreased (0.154459 --> 0.153961).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 57 cost time: 0.8880233764648438
Epoch: 57, Steps: 64 | Train Loss: 0.1092411 Vali Loss: 0.1553854 Test Loss: 0.2196538
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 58 cost time: 0.8934166431427002
Epoch: 58, Steps: 64 | Train Loss: 0.1091216 Vali Loss: 0.1569356 Test Loss: 0.2210211
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 59 cost time: 0.880692720413208
Epoch: 59, Steps: 64 | Train Loss: 0.1088896 Vali Loss: 0.1550346 Test Loss: 0.2203892
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 60 cost time: 0.8919997215270996
Epoch: 60, Steps: 64 | Train Loss: 0.1089415 Vali Loss: 0.1551296 Test Loss: 0.2207792
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.22093777358531952, mae:0.3233494460582733, rse:0.23821501433849335
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.07043266296386719 GB
Epoch: 1 cost time: 2.2200822830200195
Epoch: 1, Steps: 64 | Train Loss: 0.8012224 Vali Loss: 2.0567114 Test Loss: 3.2717216
Validation loss decreased (inf --> 2.056711).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 2 cost time: 0.8755979537963867
Epoch: 2, Steps: 64 | Train Loss: 0.3263094 Vali Loss: 0.2239877 Test Loss: 0.2754933
Validation loss decreased (2.056711 --> 0.223988).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 3 cost time: 0.8693718910217285
Epoch: 3, Steps: 64 | Train Loss: 0.1299981 Vali Loss: 0.1846782 Test Loss: 0.2303638
Validation loss decreased (0.223988 --> 0.184678).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 4 cost time: 0.8693416118621826
Epoch: 4, Steps: 64 | Train Loss: 0.1197280 Vali Loss: 0.1677154 Test Loss: 0.2168384
Validation loss decreased (0.184678 --> 0.167715).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 5 cost time: 0.8637642860412598
Epoch: 5, Steps: 64 | Train Loss: 0.1148864 Vali Loss: 0.1663877 Test Loss: 0.2182046
Validation loss decreased (0.167715 --> 0.166388).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 6 cost time: 0.8256919384002686
Epoch: 6, Steps: 64 | Train Loss: 0.1120393 Vali Loss: 0.1640563 Test Loss: 0.2170549
Validation loss decreased (0.166388 --> 0.164056).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 7 cost time: 0.8636014461517334
Epoch: 7, Steps: 64 | Train Loss: 0.1100614 Vali Loss: 0.1584280 Test Loss: 0.2153793
Validation loss decreased (0.164056 --> 0.158428).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 8 cost time: 0.8653664588928223
Epoch: 8, Steps: 64 | Train Loss: 0.1087173 Vali Loss: 0.1580334 Test Loss: 0.2161618
Validation loss decreased (0.158428 --> 0.158033).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 9 cost time: 0.8574342727661133
Epoch: 9, Steps: 64 | Train Loss: 0.1071286 Vali Loss: 0.1549889 Test Loss: 0.2161143
Validation loss decreased (0.158033 --> 0.154989).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 10 cost time: 0.8703479766845703
Epoch: 10, Steps: 64 | Train Loss: 0.1061010 Vali Loss: 0.1559607 Test Loss: 0.2162483
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 11 cost time: 0.8653261661529541
Epoch: 11, Steps: 64 | Train Loss: 0.1052959 Vali Loss: 0.1524912 Test Loss: 0.2147375
Validation loss decreased (0.154989 --> 0.152491).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 12 cost time: 0.8694553375244141
Epoch: 12, Steps: 64 | Train Loss: 0.1037257 Vali Loss: 0.1525213 Test Loss: 0.2162196
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 13 cost time: 0.8676021099090576
Epoch: 13, Steps: 64 | Train Loss: 0.1033751 Vali Loss: 0.1539135 Test Loss: 0.2159509
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 14 cost time: 0.8674483299255371
Epoch: 14, Steps: 64 | Train Loss: 0.1032536 Vali Loss: 0.1512812 Test Loss: 0.2160799
Validation loss decreased (0.152491 --> 0.151281).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 15 cost time: 0.8663387298583984
Epoch: 15, Steps: 64 | Train Loss: 0.1020562 Vali Loss: 0.1525221 Test Loss: 0.2173296
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 16 cost time: 0.8713631629943848
Epoch: 16, Steps: 64 | Train Loss: 0.1016784 Vali Loss: 0.1503564 Test Loss: 0.2177648
Validation loss decreased (0.151281 --> 0.150356).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 17 cost time: 0.8647556304931641
Epoch: 17, Steps: 64 | Train Loss: 0.1011718 Vali Loss: 0.1515235 Test Loss: 0.2168544
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 18 cost time: 0.8609998226165771
Epoch: 18, Steps: 64 | Train Loss: 0.1000934 Vali Loss: 0.1511107 Test Loss: 0.2172165
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 19 cost time: 0.8636224269866943
Epoch: 19, Steps: 64 | Train Loss: 0.0998823 Vali Loss: 0.1475722 Test Loss: 0.2173770
Validation loss decreased (0.150356 --> 0.147572).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 20 cost time: 0.8763329982757568
Epoch: 20, Steps: 64 | Train Loss: 0.0993953 Vali Loss: 0.1465141 Test Loss: 0.2175842
Validation loss decreased (0.147572 --> 0.146514).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 21 cost time: 0.8652949333190918
Epoch: 21, Steps: 64 | Train Loss: 0.0993154 Vali Loss: 0.1491754 Test Loss: 0.2177524
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 22 cost time: 0.8673415184020996
Epoch: 22, Steps: 64 | Train Loss: 0.0992372 Vali Loss: 0.1463285 Test Loss: 0.2172117
Validation loss decreased (0.146514 --> 0.146329).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 23 cost time: 0.8637778759002686
Epoch: 23, Steps: 64 | Train Loss: 0.0982378 Vali Loss: 0.1480545 Test Loss: 0.2172794
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 24 cost time: 0.8613691329956055
Epoch: 24, Steps: 64 | Train Loss: 0.0984394 Vali Loss: 0.1472527 Test Loss: 0.2172164
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 25 cost time: 0.8626000881195068
Epoch: 25, Steps: 64 | Train Loss: 0.0973359 Vali Loss: 0.1440819 Test Loss: 0.2171614
Validation loss decreased (0.146329 --> 0.144082).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 26 cost time: 0.8669378757476807
Epoch: 26, Steps: 64 | Train Loss: 0.0975626 Vali Loss: 0.1464526 Test Loss: 0.2167922
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 27 cost time: 0.8693432807922363
Epoch: 27, Steps: 64 | Train Loss: 0.0973207 Vali Loss: 0.1465084 Test Loss: 0.2171801
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 28 cost time: 0.869375467300415
Epoch: 28, Steps: 64 | Train Loss: 0.0970747 Vali Loss: 0.1434991 Test Loss: 0.2173740
Validation loss decreased (0.144082 --> 0.143499).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 29 cost time: 0.8653867244720459
Epoch: 29, Steps: 64 | Train Loss: 0.0972902 Vali Loss: 0.1450120 Test Loss: 0.2174290
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 30 cost time: 0.8630001544952393
Epoch: 30, Steps: 64 | Train Loss: 0.0971175 Vali Loss: 0.1465923 Test Loss: 0.2170558
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 31 cost time: 0.8366005420684814
Epoch: 31, Steps: 64 | Train Loss: 0.0968392 Vali Loss: 0.1470702 Test Loss: 0.2170891
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 32 cost time: 0.8623576164245605
Epoch: 32, Steps: 64 | Train Loss: 0.0973087 Vali Loss: 0.1468803 Test Loss: 0.2171478
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 33 cost time: 0.8613624572753906
Epoch: 33, Steps: 64 | Train Loss: 0.0968149 Vali Loss: 0.1457813 Test Loss: 0.2166179
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 34 cost time: 0.8689303398132324
Epoch: 34, Steps: 64 | Train Loss: 0.0966963 Vali Loss: 0.1443527 Test Loss: 0.2165372
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 35 cost time: 0.8617017269134521
Epoch: 35, Steps: 64 | Train Loss: 0.0970316 Vali Loss: 0.1456736 Test Loss: 0.2166402
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 36 cost time: 0.8719997406005859
Epoch: 36, Steps: 64 | Train Loss: 0.0973620 Vali Loss: 0.1464568 Test Loss: 0.2167631
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 37 cost time: 0.8655977249145508
Epoch: 37, Steps: 64 | Train Loss: 0.0962876 Vali Loss: 0.1461309 Test Loss: 0.2169577
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 38 cost time: 0.8798356056213379
Epoch: 38, Steps: 64 | Train Loss: 0.0966303 Vali Loss: 0.1464467 Test Loss: 0.2170487
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 39 cost time: 0.8628318309783936
Epoch: 39, Steps: 64 | Train Loss: 0.0970801 Vali Loss: 0.1441465 Test Loss: 0.2167475
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 40 cost time: 0.8643262386322021
Epoch: 40, Steps: 64 | Train Loss: 0.0970714 Vali Loss: 0.1475079 Test Loss: 0.2168973
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 41 cost time: 0.8657286167144775
Epoch: 41, Steps: 64 | Train Loss: 0.0967202 Vali Loss: 0.1452421 Test Loss: 0.2168757
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 42 cost time: 0.8589990139007568
Epoch: 42, Steps: 64 | Train Loss: 0.0965896 Vali Loss: 0.1452959 Test Loss: 0.2170397
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 43 cost time: 0.8625979423522949
Epoch: 43, Steps: 64 | Train Loss: 0.0962298 Vali Loss: 0.1465757 Test Loss: 0.2165005
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 44 cost time: 0.8713195323944092
Epoch: 44, Steps: 64 | Train Loss: 0.0963542 Vali Loss: 0.1470470 Test Loss: 0.2167388
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 45 cost time: 0.8794233798980713
Epoch: 45, Steps: 64 | Train Loss: 0.0959543 Vali Loss: 0.1458991 Test Loss: 0.2167162
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 46 cost time: 0.8672876358032227
Epoch: 46, Steps: 64 | Train Loss: 0.0964852 Vali Loss: 0.1452291 Test Loss: 0.2169746
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 47 cost time: 0.8671963214874268
Epoch: 47, Steps: 64 | Train Loss: 0.0967901 Vali Loss: 0.1473058 Test Loss: 0.2170692
EarlyStopping counter: 19 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 48 cost time: 0.8680000305175781
Epoch: 48, Steps: 64 | Train Loss: 0.0960775 Vali Loss: 0.1442546 Test Loss: 0.2170624
EarlyStopping counter: 20 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 49 cost time: 0.8776054382324219
Epoch: 49, Steps: 64 | Train Loss: 0.0963173 Vali Loss: 0.1455043 Test Loss: 0.2168750
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 50 cost time: 0.8523790836334229
Epoch: 50, Steps: 64 | Train Loss: 0.0961795 Vali Loss: 0.1458609 Test Loss: 0.2167918
EarlyStopping counter: 22 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 51 cost time: 0.8521134853363037
Epoch: 51, Steps: 64 | Train Loss: 0.0962982 Vali Loss: 0.1453388 Test Loss: 0.2172562
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 52 cost time: 0.8727946281433105
Epoch: 52, Steps: 64 | Train Loss: 0.0961486 Vali Loss: 0.1450225 Test Loss: 0.2169579
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 53 cost time: 0.8650002479553223
Epoch: 53, Steps: 64 | Train Loss: 0.0962234 Vali Loss: 0.1451046 Test Loss: 0.2169708
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 54 cost time: 0.873999834060669
Epoch: 54, Steps: 64 | Train Loss: 0.0961905 Vali Loss: 0.1454159 Test Loss: 0.2172178
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 55 cost time: 0.8669033050537109
Epoch: 55, Steps: 64 | Train Loss: 0.0958587 Vali Loss: 0.1446715 Test Loss: 0.2169842
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 56 cost time: 0.8693892955780029
Epoch: 56, Steps: 64 | Train Loss: 0.0960085 Vali Loss: 0.1464316 Test Loss: 0.2168844
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 57 cost time: 0.8653082847595215
Epoch: 57, Steps: 64 | Train Loss: 0.0960432 Vali Loss: 0.1458822 Test Loss: 0.2169995
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 58 cost time: 0.8637149333953857
Epoch: 58, Steps: 64 | Train Loss: 0.0962271 Vali Loss: 0.1443423 Test Loss: 0.2169725
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 59 cost time: 0.8640000820159912
Epoch: 59, Steps: 64 | Train Loss: 0.0968988 Vali Loss: 0.1470419 Test Loss: 0.2172448
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 60 cost time: 0.8214118480682373
Epoch: 60, Steps: 64 | Train Loss: 0.0963205 Vali Loss: 0.1462785 Test Loss: 0.2169518
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.21737395226955414, mae:0.320539653301239, rse:0.2362859547138214
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityCh_336_96', model='PerioDformer', data='CityCh', root_path='./dataset/', data_path='CityCh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.0735483169555664 GB
Epoch: 1 cost time: 2.3503406047821045
Epoch: 1, Steps: 64 | Train Loss: 0.8509027 Vali Loss: 2.2773194 Test Loss: 3.6136494
Validation loss decreased (inf --> 2.277319).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 2 cost time: 0.9599206447601318
Epoch: 2, Steps: 64 | Train Loss: 0.3356347 Vali Loss: 0.2631891 Test Loss: 0.3481404
Validation loss decreased (2.277319 --> 0.263189).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 3 cost time: 0.9633674621582031
Epoch: 3, Steps: 64 | Train Loss: 0.1246066 Vali Loss: 0.1696372 Test Loss: 0.2163396
Validation loss decreased (0.263189 --> 0.169637).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 4 cost time: 0.9524660110473633
Epoch: 4, Steps: 64 | Train Loss: 0.1138653 Vali Loss: 0.1700192 Test Loss: 0.2193070
EarlyStopping counter: 1 out of 100
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 5 cost time: 0.9484517574310303
Epoch: 5, Steps: 64 | Train Loss: 0.1100762 Vali Loss: 0.1638116 Test Loss: 0.2180694
Validation loss decreased (0.169637 --> 0.163812).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 6 cost time: 0.9553332328796387
Epoch: 6, Steps: 64 | Train Loss: 0.1082243 Vali Loss: 0.1585426 Test Loss: 0.2174711
Validation loss decreased (0.163812 --> 0.158543).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 7 cost time: 0.9494378566741943
Epoch: 7, Steps: 64 | Train Loss: 0.1050117 Vali Loss: 0.1564109 Test Loss: 0.2188742
Validation loss decreased (0.158543 --> 0.156411).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 8 cost time: 0.9507827758789062
Epoch: 8, Steps: 64 | Train Loss: 0.1025320 Vali Loss: 0.1531230 Test Loss: 0.2169113
Validation loss decreased (0.156411 --> 0.153123).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 9 cost time: 0.9544248580932617
Epoch: 9, Steps: 64 | Train Loss: 0.1009455 Vali Loss: 0.1527292 Test Loss: 0.2166812
Validation loss decreased (0.153123 --> 0.152729).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 10 cost time: 1.0340025424957275
Epoch: 10, Steps: 64 | Train Loss: 0.0994229 Vali Loss: 0.1484960 Test Loss: 0.2163501
Validation loss decreased (0.152729 --> 0.148496).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 11 cost time: 1.0330002307891846
Epoch: 11, Steps: 64 | Train Loss: 0.0986359 Vali Loss: 0.1515025 Test Loss: 0.2162733
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 12 cost time: 0.9639997482299805
Epoch: 12, Steps: 64 | Train Loss: 0.0980995 Vali Loss: 0.1535347 Test Loss: 0.2176576
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 13 cost time: 0.9489943981170654
Epoch: 13, Steps: 64 | Train Loss: 0.0976738 Vali Loss: 0.1491207 Test Loss: 0.2164005
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 14 cost time: 0.9476253986358643
Epoch: 14, Steps: 64 | Train Loss: 0.0974963 Vali Loss: 0.1511668 Test Loss: 0.2165106
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 15 cost time: 0.9533543586730957
Epoch: 15, Steps: 64 | Train Loss: 0.0968244 Vali Loss: 0.1508967 Test Loss: 0.2185245
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 16 cost time: 0.9643738269805908
Epoch: 16, Steps: 64 | Train Loss: 0.0958856 Vali Loss: 0.1481997 Test Loss: 0.2176726
Validation loss decreased (0.148496 --> 0.148200).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 17 cost time: 0.9534311294555664
Epoch: 17, Steps: 64 | Train Loss: 0.0961894 Vali Loss: 0.1516987 Test Loss: 0.2191899
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 18 cost time: 0.959453821182251
Epoch: 18, Steps: 64 | Train Loss: 0.0956084 Vali Loss: 0.1497516 Test Loss: 0.2187587
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 19 cost time: 0.9743974208831787
Epoch: 19, Steps: 64 | Train Loss: 0.0955100 Vali Loss: 0.1479676 Test Loss: 0.2166075
Validation loss decreased (0.148200 --> 0.147968).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 20 cost time: 0.9644758701324463
Epoch: 20, Steps: 64 | Train Loss: 0.0951455 Vali Loss: 0.1490884 Test Loss: 0.2189874
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 21 cost time: 0.9593026638031006
Epoch: 21, Steps: 64 | Train Loss: 0.0954786 Vali Loss: 0.1498435 Test Loss: 0.2178589
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 22 cost time: 0.9618682861328125
Epoch: 22, Steps: 64 | Train Loss: 0.0951222 Vali Loss: 0.1484410 Test Loss: 0.2179353
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 23 cost time: 0.9509999752044678
Epoch: 23, Steps: 64 | Train Loss: 0.0949333 Vali Loss: 0.1482597 Test Loss: 0.2181010
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 24 cost time: 0.9606366157531738
Epoch: 24, Steps: 64 | Train Loss: 0.0946594 Vali Loss: 0.1492537 Test Loss: 0.2184317
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 25 cost time: 0.960003137588501
Epoch: 25, Steps: 64 | Train Loss: 0.0949025 Vali Loss: 0.1469294 Test Loss: 0.2184594
Validation loss decreased (0.147968 --> 0.146929).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 26 cost time: 0.9643762111663818
Epoch: 26, Steps: 64 | Train Loss: 0.0946049 Vali Loss: 0.1484792 Test Loss: 0.2181342
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 27 cost time: 0.9604361057281494
Epoch: 27, Steps: 64 | Train Loss: 0.0943789 Vali Loss: 0.1488573 Test Loss: 0.2178916
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 28 cost time: 0.9633760452270508
Epoch: 28, Steps: 64 | Train Loss: 0.0938243 Vali Loss: 0.1503564 Test Loss: 0.2186051
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 29 cost time: 0.9634208679199219
Epoch: 29, Steps: 64 | Train Loss: 0.0945525 Vali Loss: 0.1470685 Test Loss: 0.2192785
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 30 cost time: 0.9524276256561279
Epoch: 30, Steps: 64 | Train Loss: 0.0942030 Vali Loss: 0.1484773 Test Loss: 0.2189527
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 31 cost time: 0.9534907341003418
Epoch: 31, Steps: 64 | Train Loss: 0.0942054 Vali Loss: 0.1467531 Test Loss: 0.2185162
Validation loss decreased (0.146929 --> 0.146753).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 32 cost time: 0.9567463397979736
Epoch: 32, Steps: 64 | Train Loss: 0.0939366 Vali Loss: 0.1480530 Test Loss: 0.2187489
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 33 cost time: 0.9611289501190186
Epoch: 33, Steps: 64 | Train Loss: 0.0942764 Vali Loss: 0.1488361 Test Loss: 0.2190791
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 34 cost time: 0.9580001831054688
Epoch: 34, Steps: 64 | Train Loss: 0.0937988 Vali Loss: 0.1486363 Test Loss: 0.2184236
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 35 cost time: 0.9589998722076416
Epoch: 35, Steps: 64 | Train Loss: 0.0939996 Vali Loss: 0.1489207 Test Loss: 0.2188768
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 36 cost time: 0.9636154174804688
Epoch: 36, Steps: 64 | Train Loss: 0.0939628 Vali Loss: 0.1484446 Test Loss: 0.2183663
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 37 cost time: 0.9596800804138184
Epoch: 37, Steps: 64 | Train Loss: 0.0936931 Vali Loss: 0.1481015 Test Loss: 0.2183671
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 38 cost time: 0.95847487449646
Epoch: 38, Steps: 64 | Train Loss: 0.0939868 Vali Loss: 0.1478320 Test Loss: 0.2189453
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 39 cost time: 0.9786167144775391
Epoch: 39, Steps: 64 | Train Loss: 0.0937573 Vali Loss: 0.1477382 Test Loss: 0.2184756
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 40 cost time: 0.9594225883483887
Epoch: 40, Steps: 64 | Train Loss: 0.0936658 Vali Loss: 0.1472442 Test Loss: 0.2188314
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 41 cost time: 0.9615592956542969
Epoch: 41, Steps: 64 | Train Loss: 0.0938130 Vali Loss: 0.1484482 Test Loss: 0.2187088
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 42 cost time: 0.9803917407989502
Epoch: 42, Steps: 64 | Train Loss: 0.0940862 Vali Loss: 0.1472506 Test Loss: 0.2189845
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 43 cost time: 1.0007390975952148
Epoch: 43, Steps: 64 | Train Loss: 0.0936768 Vali Loss: 0.1498173 Test Loss: 0.2196680
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 44 cost time: 0.96376633644104
Epoch: 44, Steps: 64 | Train Loss: 0.0939235 Vali Loss: 0.1478920 Test Loss: 0.2185652
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 45 cost time: 0.9672012329101562
Epoch: 45, Steps: 64 | Train Loss: 0.0932079 Vali Loss: 0.1482142 Test Loss: 0.2188950
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 46 cost time: 0.9579999446868896
Epoch: 46, Steps: 64 | Train Loss: 0.0937872 Vali Loss: 0.1470337 Test Loss: 0.2187405
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 47 cost time: 0.9539997577667236
Epoch: 47, Steps: 64 | Train Loss: 0.0940671 Vali Loss: 0.1491133 Test Loss: 0.2194555
EarlyStopping counter: 16 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 48 cost time: 0.9496116638183594
Epoch: 48, Steps: 64 | Train Loss: 0.0929338 Vali Loss: 0.1487575 Test Loss: 0.2194467
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 49 cost time: 0.9350686073303223
Epoch: 49, Steps: 64 | Train Loss: 0.0932999 Vali Loss: 0.1480028 Test Loss: 0.2192311
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 50 cost time: 0.9633746147155762
Epoch: 50, Steps: 64 | Train Loss: 0.0934542 Vali Loss: 0.1494792 Test Loss: 0.2187702
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 51 cost time: 0.9583985805511475
Epoch: 51, Steps: 64 | Train Loss: 0.0935740 Vali Loss: 0.1483976 Test Loss: 0.2192859
EarlyStopping counter: 20 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 52 cost time: 0.956505298614502
Epoch: 52, Steps: 64 | Train Loss: 0.0941023 Vali Loss: 0.1488792 Test Loss: 0.2196248
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 53 cost time: 0.9606125354766846
Epoch: 53, Steps: 64 | Train Loss: 0.0933362 Vali Loss: 0.1482069 Test Loss: 0.2191773
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 54 cost time: 0.9553923606872559
Epoch: 54, Steps: 64 | Train Loss: 0.0934735 Vali Loss: 0.1463799 Test Loss: 0.2191232
Validation loss decreased (0.146753 --> 0.146380).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 55 cost time: 0.9649083614349365
Epoch: 55, Steps: 64 | Train Loss: 0.0935484 Vali Loss: 0.1487253 Test Loss: 0.2196996
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 56 cost time: 0.9613649845123291
Epoch: 56, Steps: 64 | Train Loss: 0.0933317 Vali Loss: 0.1489156 Test Loss: 0.2194154
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 57 cost time: 0.9574234485626221
Epoch: 57, Steps: 64 | Train Loss: 0.0938888 Vali Loss: 0.1469760 Test Loss: 0.2188375
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 58 cost time: 0.9490001201629639
Epoch: 58, Steps: 64 | Train Loss: 0.0932250 Vali Loss: 0.1485613 Test Loss: 0.2195517
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 59 cost time: 0.9666228294372559
Epoch: 59, Steps: 64 | Train Loss: 0.0933776 Vali Loss: 0.1470586 Test Loss: 0.2191903
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 60 cost time: 0.9516110420227051
Epoch: 60, Steps: 64 | Train Loss: 0.0931565 Vali Loss: 0.1487726 Test Loss: 0.2194301
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityCh_336_96_PerioDformer_CityCh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.21912319958209991, mae:0.32466456294059753, rse:0.23723477125167847
