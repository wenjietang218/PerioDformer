nohup: ignoring input
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=64, n_heads=4, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm64_nh4_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.07688093185424805 GB
Epoch: 1 cost time: 2.378357410430908
Epoch: 1, Steps: 52 | Train Loss: 0.8732691 Vali Loss: 2.3056035 Test Loss: 1.4398911
Validation loss decreased (inf --> 2.305604).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 2 cost time: 0.8768370151519775
Epoch: 2, Steps: 52 | Train Loss: 0.6131976 Vali Loss: 1.4056401 Test Loss: 0.4190686
Validation loss decreased (2.305604 --> 1.405640).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 3 cost time: 0.8784303665161133
Epoch: 3, Steps: 52 | Train Loss: 0.4845699 Vali Loss: 1.3473356 Test Loss: 0.3663169
Validation loss decreased (1.405640 --> 1.347336).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 4 cost time: 0.871140718460083
Epoch: 4, Steps: 52 | Train Loss: 0.4580702 Vali Loss: 1.3356632 Test Loss: 0.3463666
Validation loss decreased (1.347336 --> 1.335663).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 5 cost time: 0.8104777336120605
Epoch: 5, Steps: 52 | Train Loss: 0.4450646 Vali Loss: 1.3191444 Test Loss: 0.3319637
Validation loss decreased (1.335663 --> 1.319144).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 6 cost time: 0.8045618534088135
Epoch: 6, Steps: 52 | Train Loss: 0.4330556 Vali Loss: 1.3070215 Test Loss: 0.3245151
Validation loss decreased (1.319144 --> 1.307021).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 7 cost time: 0.8237779140472412
Epoch: 7, Steps: 52 | Train Loss: 0.4273749 Vali Loss: 1.2993259 Test Loss: 0.3196784
Validation loss decreased (1.307021 --> 1.299326).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 8 cost time: 0.855999231338501
Epoch: 8, Steps: 52 | Train Loss: 0.4218011 Vali Loss: 1.2874205 Test Loss: 0.3156704
Validation loss decreased (1.299326 --> 1.287421).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 9 cost time: 0.8012373447418213
Epoch: 9, Steps: 52 | Train Loss: 0.4199658 Vali Loss: 1.2861477 Test Loss: 0.3121539
Validation loss decreased (1.287421 --> 1.286148).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 10 cost time: 0.8284263610839844
Epoch: 10, Steps: 52 | Train Loss: 0.4170238 Vali Loss: 1.2815108 Test Loss: 0.3107871
Validation loss decreased (1.286148 --> 1.281511).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 11 cost time: 0.8638811111450195
Epoch: 11, Steps: 52 | Train Loss: 0.4143033 Vali Loss: 1.2820244 Test Loss: 0.3095717
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 12 cost time: 0.8790011405944824
Epoch: 12, Steps: 52 | Train Loss: 0.4108943 Vali Loss: 1.2700363 Test Loss: 0.3079656
Validation loss decreased (1.281511 --> 1.270036).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 13 cost time: 0.8689219951629639
Epoch: 13, Steps: 52 | Train Loss: 0.4087033 Vali Loss: 1.2807417 Test Loss: 0.3078157
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 14 cost time: 0.872812032699585
Epoch: 14, Steps: 52 | Train Loss: 0.4075268 Vali Loss: 1.2786088 Test Loss: 0.3067849
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 15 cost time: 0.85550856590271
Epoch: 15, Steps: 52 | Train Loss: 0.4059590 Vali Loss: 1.2789714 Test Loss: 0.3068587
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 16 cost time: 0.8549959659576416
Epoch: 16, Steps: 52 | Train Loss: 0.4052596 Vali Loss: 1.2775557 Test Loss: 0.3063156
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 17 cost time: 0.8519999980926514
Epoch: 17, Steps: 52 | Train Loss: 0.4049386 Vali Loss: 1.2690210 Test Loss: 0.3048562
Validation loss decreased (1.270036 --> 1.269021).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 18 cost time: 0.8481378555297852
Epoch: 18, Steps: 52 | Train Loss: 0.4034759 Vali Loss: 1.2595750 Test Loss: 0.3056071
Validation loss decreased (1.269021 --> 1.259575).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 19 cost time: 0.8585596084594727
Epoch: 19, Steps: 52 | Train Loss: 0.4015060 Vali Loss: 1.2727878 Test Loss: 0.3057898
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 20 cost time: 0.8790163993835449
Epoch: 20, Steps: 52 | Train Loss: 0.4035044 Vali Loss: 1.2629014 Test Loss: 0.3058208
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 21 cost time: 0.8728592395782471
Epoch: 21, Steps: 52 | Train Loss: 0.4019994 Vali Loss: 1.2735472 Test Loss: 0.3061075
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 22 cost time: 0.8869996070861816
Epoch: 22, Steps: 52 | Train Loss: 0.3993925 Vali Loss: 1.2675942 Test Loss: 0.3052669
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 23 cost time: 0.8926181793212891
Epoch: 23, Steps: 52 | Train Loss: 0.4011148 Vali Loss: 1.2609401 Test Loss: 0.3049318
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 24 cost time: 0.8639698028564453
Epoch: 24, Steps: 52 | Train Loss: 0.4014003 Vali Loss: 1.2621135 Test Loss: 0.3050864
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 25 cost time: 0.8567080497741699
Epoch: 25, Steps: 52 | Train Loss: 0.4014257 Vali Loss: 1.2545025 Test Loss: 0.3047490
Validation loss decreased (1.259575 --> 1.254503).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 26 cost time: 0.8578345775604248
Epoch: 26, Steps: 52 | Train Loss: 0.3985395 Vali Loss: 1.2688208 Test Loss: 0.3058892
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 27 cost time: 0.8618555068969727
Epoch: 27, Steps: 52 | Train Loss: 0.3998781 Vali Loss: 1.2609804 Test Loss: 0.3053093
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 28 cost time: 0.8506340980529785
Epoch: 28, Steps: 52 | Train Loss: 0.3988552 Vali Loss: 1.2609183 Test Loss: 0.3050153
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 29 cost time: 0.8659217357635498
Epoch: 29, Steps: 52 | Train Loss: 0.3977149 Vali Loss: 1.2653074 Test Loss: 0.3051744
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 30 cost time: 0.8596494197845459
Epoch: 30, Steps: 52 | Train Loss: 0.3962168 Vali Loss: 1.2605324 Test Loss: 0.3051932
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 31 cost time: 0.8628149032592773
Epoch: 31, Steps: 52 | Train Loss: 0.3984815 Vali Loss: 1.2605793 Test Loss: 0.3058654
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 32 cost time: 0.8597886562347412
Epoch: 32, Steps: 52 | Train Loss: 0.3978958 Vali Loss: 1.2609472 Test Loss: 0.3052917
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 33 cost time: 0.8722813129425049
Epoch: 33, Steps: 52 | Train Loss: 0.3992704 Vali Loss: 1.2685714 Test Loss: 0.3054199
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 34 cost time: 0.838057279586792
Epoch: 34, Steps: 52 | Train Loss: 0.3979926 Vali Loss: 1.2607361 Test Loss: 0.3052177
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 35 cost time: 0.8726396560668945
Epoch: 35, Steps: 52 | Train Loss: 0.3969894 Vali Loss: 1.2655163 Test Loss: 0.3054876
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 36 cost time: 0.85310959815979
Epoch: 36, Steps: 52 | Train Loss: 0.3975594 Vali Loss: 1.2605654 Test Loss: 0.3049448
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 37 cost time: 0.8694775104522705
Epoch: 37, Steps: 52 | Train Loss: 0.3977456 Vali Loss: 1.2622631 Test Loss: 0.3053330
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 38 cost time: 0.8926148414611816
Epoch: 38, Steps: 52 | Train Loss: 0.3964149 Vali Loss: 1.2669135 Test Loss: 0.3051803
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 39 cost time: 0.870563268661499
Epoch: 39, Steps: 52 | Train Loss: 0.3975388 Vali Loss: 1.2602873 Test Loss: 0.3050781
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 40 cost time: 0.8333818912506104
Epoch: 40, Steps: 52 | Train Loss: 0.3970749 Vali Loss: 1.2606928 Test Loss: 0.3055790
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 41 cost time: 0.830233097076416
Epoch: 41, Steps: 52 | Train Loss: 0.3973958 Vali Loss: 1.2610148 Test Loss: 0.3063333
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 42 cost time: 0.8289995193481445
Epoch: 42, Steps: 52 | Train Loss: 0.3972623 Vali Loss: 1.2596507 Test Loss: 0.3059167
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 43 cost time: 0.8044281005859375
Epoch: 43, Steps: 52 | Train Loss: 0.3973787 Vali Loss: 1.2616737 Test Loss: 0.3052445
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 44 cost time: 0.8036420345306396
Epoch: 44, Steps: 52 | Train Loss: 0.3970455 Vali Loss: 1.2592275 Test Loss: 0.3060579
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 45 cost time: 0.8197951316833496
Epoch: 45, Steps: 52 | Train Loss: 0.3964254 Vali Loss: 1.2594751 Test Loss: 0.3053490
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 46 cost time: 0.8580000400543213
Epoch: 46, Steps: 52 | Train Loss: 0.3958084 Vali Loss: 1.2652652 Test Loss: 0.3060541
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 47 cost time: 0.8553726673126221
Epoch: 47, Steps: 52 | Train Loss: 0.3961638 Vali Loss: 1.2588267 Test Loss: 0.3056676
EarlyStopping counter: 22 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 48 cost time: 0.8534092903137207
Epoch: 48, Steps: 52 | Train Loss: 0.3959528 Vali Loss: 1.2671781 Test Loss: 0.3051878
EarlyStopping counter: 23 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 49 cost time: 0.8576233386993408
Epoch: 49, Steps: 52 | Train Loss: 0.3958089 Vali Loss: 1.2538366 Test Loss: 0.3064182
Validation loss decreased (1.254503 --> 1.253837).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 50 cost time: 0.8589997291564941
Epoch: 50, Steps: 52 | Train Loss: 0.3949951 Vali Loss: 1.2576123 Test Loss: 0.3056529
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 51 cost time: 0.8570096492767334
Epoch: 51, Steps: 52 | Train Loss: 0.3950246 Vali Loss: 1.2624602 Test Loss: 0.3064488
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 52 cost time: 0.8696305751800537
Epoch: 52, Steps: 52 | Train Loss: 0.3969554 Vali Loss: 1.2636049 Test Loss: 0.3053271
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 53 cost time: 0.8666760921478271
Epoch: 53, Steps: 52 | Train Loss: 0.3973298 Vali Loss: 1.2519240 Test Loss: 0.3069593
Validation loss decreased (1.253837 --> 1.251924).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 54 cost time: 0.8637809753417969
Epoch: 54, Steps: 52 | Train Loss: 0.3960647 Vali Loss: 1.2619795 Test Loss: 0.3062078
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 55 cost time: 0.8540000915527344
Epoch: 55, Steps: 52 | Train Loss: 0.3962772 Vali Loss: 1.2554251 Test Loss: 0.3063295
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 56 cost time: 0.8554692268371582
Epoch: 56, Steps: 52 | Train Loss: 0.3963924 Vali Loss: 1.2606969 Test Loss: 0.3056663
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 57 cost time: 0.8661608695983887
Epoch: 57, Steps: 52 | Train Loss: 0.3955919 Vali Loss: 1.2592090 Test Loss: 0.3052353
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 58 cost time: 0.8708117008209229
Epoch: 58, Steps: 52 | Train Loss: 0.3967978 Vali Loss: 1.2622778 Test Loss: 0.3064086
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 59 cost time: 0.8867816925048828
Epoch: 59, Steps: 52 | Train Loss: 0.3959052 Vali Loss: 1.2595115 Test Loss: 0.3061989
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019845962524414062 GB
GPU已分配内存的峰值：0.0784749984741211 GB
Epoch: 60 cost time: 0.870999813079834
Epoch: 60, Steps: 52 | Train Loss: 0.3963500 Vali Loss: 1.2472622 Test Loss: 0.3054219
Validation loss decreased (1.251924 --> 1.247262).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm64_nh4_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3054219186306, mae:0.34474191069602966, rse:0.45275044441223145
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_192', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=192, w=4, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=64, n_heads=4, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_192_PerioDformer_NetTh_ftS_sl336_ll48_pl192_dm64_nh4_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6673
val 1969
test 1969
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08098936080932617 GB
Epoch: 1 cost time: 2.5207247734069824
Epoch: 1, Steps: 52 | Train Loss: 0.9294329 Vali Loss: 2.4642589 Test Loss: 1.6161231
Validation loss decreased (inf --> 2.464259).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 2 cost time: 0.9900190830230713
Epoch: 2, Steps: 52 | Train Loss: 0.6709377 Vali Loss: 1.5114006 Test Loss: 0.4770201
Validation loss decreased (2.464259 --> 1.511401).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 3 cost time: 0.9706838130950928
Epoch: 3, Steps: 52 | Train Loss: 0.5054505 Vali Loss: 1.4172782 Test Loss: 0.3851424
Validation loss decreased (1.511401 --> 1.417278).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 4 cost time: 0.9609997272491455
Epoch: 4, Steps: 52 | Train Loss: 0.4725563 Vali Loss: 1.3930992 Test Loss: 0.3555963
Validation loss decreased (1.417278 --> 1.393099).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 5 cost time: 0.8986220359802246
Epoch: 5, Steps: 52 | Train Loss: 0.4562186 Vali Loss: 1.3878552 Test Loss: 0.3382915
Validation loss decreased (1.393099 --> 1.387855).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 6 cost time: 0.9096488952636719
Epoch: 6, Steps: 52 | Train Loss: 0.4470628 Vali Loss: 1.3713517 Test Loss: 0.3277568
Validation loss decreased (1.387855 --> 1.371352).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 7 cost time: 0.9544610977172852
Epoch: 7, Steps: 52 | Train Loss: 0.4400577 Vali Loss: 1.3527569 Test Loss: 0.3205510
Validation loss decreased (1.371352 --> 1.352757).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 8 cost time: 0.9604020118713379
Epoch: 8, Steps: 52 | Train Loss: 0.4348882 Vali Loss: 1.3579280 Test Loss: 0.3152481
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 9 cost time: 0.9424352645874023
Epoch: 9, Steps: 52 | Train Loss: 0.4307312 Vali Loss: 1.3481809 Test Loss: 0.3115917
Validation loss decreased (1.352757 --> 1.348181).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 10 cost time: 0.9695816040039062
Epoch: 10, Steps: 52 | Train Loss: 0.4268930 Vali Loss: 1.3361838 Test Loss: 0.3093442
Validation loss decreased (1.348181 --> 1.336184).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 11 cost time: 0.958000898361206
Epoch: 11, Steps: 52 | Train Loss: 0.4244235 Vali Loss: 1.3331248 Test Loss: 0.3065145
Validation loss decreased (1.336184 --> 1.333125).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 12 cost time: 0.9476404190063477
Epoch: 12, Steps: 52 | Train Loss: 0.4221896 Vali Loss: 1.3306907 Test Loss: 0.3055365
Validation loss decreased (1.333125 --> 1.330691).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 13 cost time: 0.9666299819946289
Epoch: 13, Steps: 52 | Train Loss: 0.4200087 Vali Loss: 1.3344182 Test Loss: 0.3037234
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 14 cost time: 0.9697637557983398
Epoch: 14, Steps: 52 | Train Loss: 0.4177765 Vali Loss: 1.3340057 Test Loss: 0.3036029
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 15 cost time: 0.9830644130706787
Epoch: 15, Steps: 52 | Train Loss: 0.4182853 Vali Loss: 1.3296705 Test Loss: 0.3025409
Validation loss decreased (1.330691 --> 1.329671).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 16 cost time: 0.9905555248260498
Epoch: 16, Steps: 52 | Train Loss: 0.4153009 Vali Loss: 1.3298433 Test Loss: 0.3021124
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 17 cost time: 0.9550578594207764
Epoch: 17, Steps: 52 | Train Loss: 0.4152908 Vali Loss: 1.3246439 Test Loss: 0.3018918
Validation loss decreased (1.329671 --> 1.324644).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 18 cost time: 0.977618932723999
Epoch: 18, Steps: 52 | Train Loss: 0.4143908 Vali Loss: 1.3231599 Test Loss: 0.3011191
Validation loss decreased (1.324644 --> 1.323160).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 19 cost time: 0.9259998798370361
Epoch: 19, Steps: 52 | Train Loss: 0.4139371 Vali Loss: 1.3224447 Test Loss: 0.3015290
Validation loss decreased (1.323160 --> 1.322445).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 20 cost time: 0.9040000438690186
Epoch: 20, Steps: 52 | Train Loss: 0.4122778 Vali Loss: 1.3196175 Test Loss: 0.3004803
Validation loss decreased (1.322445 --> 1.319618).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 21 cost time: 0.9668800830841064
Epoch: 21, Steps: 52 | Train Loss: 0.4127084 Vali Loss: 1.3231184 Test Loss: 0.2998980
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 22 cost time: 0.9762239456176758
Epoch: 22, Steps: 52 | Train Loss: 0.4116510 Vali Loss: 1.3337970 Test Loss: 0.3001124
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 23 cost time: 0.9638409614562988
Epoch: 23, Steps: 52 | Train Loss: 0.4113215 Vali Loss: 1.3195843 Test Loss: 0.2996029
Validation loss decreased (1.319618 --> 1.319584).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 24 cost time: 0.9614572525024414
Epoch: 24, Steps: 52 | Train Loss: 0.4106891 Vali Loss: 1.3089664 Test Loss: 0.3000670
Validation loss decreased (1.319584 --> 1.308966).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 25 cost time: 0.98136305809021
Epoch: 25, Steps: 52 | Train Loss: 0.4105763 Vali Loss: 1.3197141 Test Loss: 0.2998486
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 26 cost time: 0.9618289470672607
Epoch: 26, Steps: 52 | Train Loss: 0.4096450 Vali Loss: 1.3186551 Test Loss: 0.2999110
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 27 cost time: 0.9600002765655518
Epoch: 27, Steps: 52 | Train Loss: 0.4097443 Vali Loss: 1.3105272 Test Loss: 0.2997007
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 28 cost time: 0.9596219062805176
Epoch: 28, Steps: 52 | Train Loss: 0.4103656 Vali Loss: 1.3187649 Test Loss: 0.2999158
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 29 cost time: 0.9745941162109375
Epoch: 29, Steps: 52 | Train Loss: 0.4091746 Vali Loss: 1.3161813 Test Loss: 0.2991926
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 30 cost time: 0.9738023281097412
Epoch: 30, Steps: 52 | Train Loss: 0.4084894 Vali Loss: 1.3242170 Test Loss: 0.2998131
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 31 cost time: 0.9556021690368652
Epoch: 31, Steps: 52 | Train Loss: 0.4086994 Vali Loss: 1.3083600 Test Loss: 0.2992962
Validation loss decreased (1.308966 --> 1.308360).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 32 cost time: 0.9573910236358643
Epoch: 32, Steps: 52 | Train Loss: 0.4088166 Vali Loss: 1.3129780 Test Loss: 0.2993118
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 33 cost time: 0.9478147029876709
Epoch: 33, Steps: 52 | Train Loss: 0.4084708 Vali Loss: 1.3147312 Test Loss: 0.2993187
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 34 cost time: 0.9567904472351074
Epoch: 34, Steps: 52 | Train Loss: 0.4073541 Vali Loss: 1.3070577 Test Loss: 0.2993301
Validation loss decreased (1.308360 --> 1.307058).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 35 cost time: 0.9529104232788086
Epoch: 35, Steps: 52 | Train Loss: 0.4075706 Vali Loss: 1.3180022 Test Loss: 0.2999931
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 36 cost time: 0.9756035804748535
Epoch: 36, Steps: 52 | Train Loss: 0.4080970 Vali Loss: 1.2997100 Test Loss: 0.2990445
Validation loss decreased (1.307058 --> 1.299710).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 37 cost time: 0.9745051860809326
Epoch: 37, Steps: 52 | Train Loss: 0.4071486 Vali Loss: 1.3144948 Test Loss: 0.2993130
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 38 cost time: 0.9014205932617188
Epoch: 38, Steps: 52 | Train Loss: 0.4082354 Vali Loss: 1.3169152 Test Loss: 0.2993139
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 39 cost time: 0.9573674201965332
Epoch: 39, Steps: 52 | Train Loss: 0.4079565 Vali Loss: 1.3174930 Test Loss: 0.2993988
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 40 cost time: 0.9486539363861084
Epoch: 40, Steps: 52 | Train Loss: 0.4069053 Vali Loss: 1.3178035 Test Loss: 0.3005541
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 41 cost time: 0.954756498336792
Epoch: 41, Steps: 52 | Train Loss: 0.4070420 Vali Loss: 1.3096435 Test Loss: 0.2993590
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 42 cost time: 0.9680004119873047
Epoch: 42, Steps: 52 | Train Loss: 0.4075468 Vali Loss: 1.3176192 Test Loss: 0.2997445
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 43 cost time: 0.978999137878418
Epoch: 43, Steps: 52 | Train Loss: 0.4070315 Vali Loss: 1.3151547 Test Loss: 0.2997083
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 44 cost time: 0.976703405380249
Epoch: 44, Steps: 52 | Train Loss: 0.4066484 Vali Loss: 1.3196107 Test Loss: 0.2989141
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 45 cost time: 0.9665024280548096
Epoch: 45, Steps: 52 | Train Loss: 0.4067068 Vali Loss: 1.3152564 Test Loss: 0.2994129
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 46 cost time: 0.9672856330871582
Epoch: 46, Steps: 52 | Train Loss: 0.4070361 Vali Loss: 1.3209134 Test Loss: 0.3000577
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 47 cost time: 0.9601898193359375
Epoch: 47, Steps: 52 | Train Loss: 0.4062646 Vali Loss: 1.3247186 Test Loss: 0.2995254
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 48 cost time: 0.9684741497039795
Epoch: 48, Steps: 52 | Train Loss: 0.4075859 Vali Loss: 1.3161517 Test Loss: 0.2996762
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 49 cost time: 0.9599514007568359
Epoch: 49, Steps: 52 | Train Loss: 0.4068453 Vali Loss: 1.3177409 Test Loss: 0.2991651
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 50 cost time: 0.9470677375793457
Epoch: 50, Steps: 52 | Train Loss: 0.4070234 Vali Loss: 1.3155254 Test Loss: 0.2995093
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 51 cost time: 0.9768598079681396
Epoch: 51, Steps: 52 | Train Loss: 0.4069953 Vali Loss: 1.3160431 Test Loss: 0.2996173
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 52 cost time: 0.968437671661377
Epoch: 52, Steps: 52 | Train Loss: 0.4069694 Vali Loss: 1.3135910 Test Loss: 0.2989396
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 53 cost time: 0.9183166027069092
Epoch: 53, Steps: 52 | Train Loss: 0.4067060 Vali Loss: 1.3122563 Test Loss: 0.2995512
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 54 cost time: 0.8886041641235352
Epoch: 54, Steps: 52 | Train Loss: 0.4069001 Vali Loss: 1.3071132 Test Loss: 0.2987348
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 55 cost time: 0.9630963802337646
Epoch: 55, Steps: 52 | Train Loss: 0.4071004 Vali Loss: 1.3107400 Test Loss: 0.2995371
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 56 cost time: 0.9847986698150635
Epoch: 56, Steps: 52 | Train Loss: 0.4069469 Vali Loss: 1.3101927 Test Loss: 0.2995230
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 57 cost time: 0.9715869426727295
Epoch: 57, Steps: 52 | Train Loss: 0.4066119 Vali Loss: 1.3152771 Test Loss: 0.2999026
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 58 cost time: 0.9489977359771729
Epoch: 58, Steps: 52 | Train Loss: 0.4070715 Vali Loss: 1.3106557 Test Loss: 0.2993003
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 59 cost time: 0.9489190578460693
Epoch: 59, Steps: 52 | Train Loss: 0.4066878 Vali Loss: 1.3171502 Test Loss: 0.2997040
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020227432250976562 GB
GPU已分配内存的峰值：0.08260631561279297 GB
Epoch: 60 cost time: 0.944364070892334
Epoch: 60, Steps: 52 | Train Loss: 0.4068793 Vali Loss: 1.3113065 Test Loss: 0.2988661
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_192_PerioDformer_NetTh_ftS_sl336_ll48_pl192_dm64_nh4_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1969
test-mse:0.29904454946517944, mae:0.3490738570690155, rse:0.45462313294410706
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_336', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=336, w=1, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=64, n_heads=4, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_336_PerioDformer_NetTh_ftS_sl336_ll48_pl336_dm64_nh4_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6529
val 1825
test 1825
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.09918785095214844 GB
Epoch: 1 cost time: 2.626918077468872
Epoch: 1, Steps: 51 | Train Loss: 0.7189578 Vali Loss: 2.1318219 Test Loss: 1.3825701
Validation loss decreased (inf --> 2.131822).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 2 cost time: 1.2206125259399414
Epoch: 2, Steps: 51 | Train Loss: 0.5906082 Vali Loss: 1.5231321 Test Loss: 0.5641134
Validation loss decreased (2.131822 --> 1.523132).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 3 cost time: 1.262960433959961
Epoch: 3, Steps: 51 | Train Loss: 0.4645226 Vali Loss: 1.3972641 Test Loss: 0.3936618
Validation loss decreased (1.523132 --> 1.397264).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 4 cost time: 1.1739981174468994
Epoch: 4, Steps: 51 | Train Loss: 0.4400603 Vali Loss: 1.3645037 Test Loss: 0.3537099
Validation loss decreased (1.397264 --> 1.364504).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 5 cost time: 1.2761030197143555
Epoch: 5, Steps: 51 | Train Loss: 0.4304436 Vali Loss: 1.3504227 Test Loss: 0.3343607
Validation loss decreased (1.364504 --> 1.350423).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 6 cost time: 1.280585765838623
Epoch: 6, Steps: 51 | Train Loss: 0.4248299 Vali Loss: 1.3312579 Test Loss: 0.3236144
Validation loss decreased (1.350423 --> 1.331258).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 7 cost time: 1.241197109222412
Epoch: 7, Steps: 51 | Train Loss: 0.4206493 Vali Loss: 1.3308747 Test Loss: 0.3145035
Validation loss decreased (1.331258 --> 1.330875).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 8 cost time: 1.2259447574615479
Epoch: 8, Steps: 51 | Train Loss: 0.4172875 Vali Loss: 1.3172224 Test Loss: 0.3098787
Validation loss decreased (1.330875 --> 1.317222).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 9 cost time: 1.1795053482055664
Epoch: 9, Steps: 51 | Train Loss: 0.4144603 Vali Loss: 1.3181447 Test Loss: 0.3055941
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 10 cost time: 1.2767534255981445
Epoch: 10, Steps: 51 | Train Loss: 0.4127585 Vali Loss: 1.3095013 Test Loss: 0.3031223
Validation loss decreased (1.317222 --> 1.309501).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 11 cost time: 1.2560923099517822
Epoch: 11, Steps: 51 | Train Loss: 0.4110993 Vali Loss: 1.3096153 Test Loss: 0.3008853
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 12 cost time: 1.2663543224334717
Epoch: 12, Steps: 51 | Train Loss: 0.4097310 Vali Loss: 1.3058158 Test Loss: 0.2996657
Validation loss decreased (1.309501 --> 1.305816).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 13 cost time: 1.2454895973205566
Epoch: 13, Steps: 51 | Train Loss: 0.4086263 Vali Loss: 1.3030831 Test Loss: 0.2983806
Validation loss decreased (1.305816 --> 1.303083).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 14 cost time: 1.2477924823760986
Epoch: 14, Steps: 51 | Train Loss: 0.4077394 Vali Loss: 1.3050621 Test Loss: 0.2978668
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 15 cost time: 1.2690598964691162
Epoch: 15, Steps: 51 | Train Loss: 0.4066030 Vali Loss: 1.3028841 Test Loss: 0.2974826
Validation loss decreased (1.303083 --> 1.302884).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 16 cost time: 1.284498929977417
Epoch: 16, Steps: 51 | Train Loss: 0.4060750 Vali Loss: 1.3029388 Test Loss: 0.2969336
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 17 cost time: 1.2662346363067627
Epoch: 17, Steps: 51 | Train Loss: 0.4057242 Vali Loss: 1.3007370 Test Loss: 0.2961262
Validation loss decreased (1.302884 --> 1.300737).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 18 cost time: 1.2669107913970947
Epoch: 18, Steps: 51 | Train Loss: 0.4045802 Vali Loss: 1.3018268 Test Loss: 0.2963895
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 19 cost time: 1.2515411376953125
Epoch: 19, Steps: 51 | Train Loss: 0.4044609 Vali Loss: 1.2984095 Test Loss: 0.2956664
Validation loss decreased (1.300737 --> 1.298409).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 20 cost time: 1.2477400302886963
Epoch: 20, Steps: 51 | Train Loss: 0.4041845 Vali Loss: 1.3015184 Test Loss: 0.2969365
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 21 cost time: 1.2448854446411133
Epoch: 21, Steps: 51 | Train Loss: 0.4037163 Vali Loss: 1.2995434 Test Loss: 0.2954994
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 22 cost time: 1.2332634925842285
Epoch: 22, Steps: 51 | Train Loss: 0.4030042 Vali Loss: 1.2945193 Test Loss: 0.2952998
Validation loss decreased (1.298409 --> 1.294519).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 23 cost time: 1.2544095516204834
Epoch: 23, Steps: 51 | Train Loss: 0.4029463 Vali Loss: 1.2878739 Test Loss: 0.2955676
Validation loss decreased (1.294519 --> 1.287874).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 24 cost time: 1.2496566772460938
Epoch: 24, Steps: 51 | Train Loss: 0.4025622 Vali Loss: 1.2967923 Test Loss: 0.2951486
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 25 cost time: 1.2493648529052734
Epoch: 25, Steps: 51 | Train Loss: 0.4027897 Vali Loss: 1.2930855 Test Loss: 0.2946856
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 26 cost time: 1.2495028972625732
Epoch: 26, Steps: 51 | Train Loss: 0.4026213 Vali Loss: 1.2912271 Test Loss: 0.2952830
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 27 cost time: 1.2426173686981201
Epoch: 27, Steps: 51 | Train Loss: 0.4024095 Vali Loss: 1.2954630 Test Loss: 0.2944662
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 28 cost time: 1.2374935150146484
Epoch: 28, Steps: 51 | Train Loss: 0.4018676 Vali Loss: 1.2903795 Test Loss: 0.2952561
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 29 cost time: 1.2187561988830566
Epoch: 29, Steps: 51 | Train Loss: 0.4016398 Vali Loss: 1.2944165 Test Loss: 0.2951468
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 30 cost time: 1.1592278480529785
Epoch: 30, Steps: 51 | Train Loss: 0.4014482 Vali Loss: 1.2877376 Test Loss: 0.2947890
Validation loss decreased (1.287874 --> 1.287738).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 31 cost time: 1.2126357555389404
Epoch: 31, Steps: 51 | Train Loss: 0.4014028 Vali Loss: 1.2947284 Test Loss: 0.2953464
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 32 cost time: 1.2544710636138916
Epoch: 32, Steps: 51 | Train Loss: 0.4014388 Vali Loss: 1.2937149 Test Loss: 0.2952491
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 33 cost time: 1.2454075813293457
Epoch: 33, Steps: 51 | Train Loss: 0.4016973 Vali Loss: 1.2926490 Test Loss: 0.2946933
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 34 cost time: 1.2633652687072754
Epoch: 34, Steps: 51 | Train Loss: 0.4014989 Vali Loss: 1.2948198 Test Loss: 0.2959580
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 35 cost time: 1.2325842380523682
Epoch: 35, Steps: 51 | Train Loss: 0.4017447 Vali Loss: 1.2940398 Test Loss: 0.2944055
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 36 cost time: 1.253462314605713
Epoch: 36, Steps: 51 | Train Loss: 0.4011972 Vali Loss: 1.2933958 Test Loss: 0.2963876
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 37 cost time: 1.241145133972168
Epoch: 37, Steps: 51 | Train Loss: 0.4011825 Vali Loss: 1.2921304 Test Loss: 0.2948439
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 38 cost time: 1.2485544681549072
Epoch: 38, Steps: 51 | Train Loss: 0.4010300 Vali Loss: 1.2888917 Test Loss: 0.2947144
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 39 cost time: 1.1714577674865723
Epoch: 39, Steps: 51 | Train Loss: 0.4014601 Vali Loss: 1.2958342 Test Loss: 0.2948158
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 40 cost time: 1.1853880882263184
Epoch: 40, Steps: 51 | Train Loss: 0.4010761 Vali Loss: 1.2892663 Test Loss: 0.2940574
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 41 cost time: 1.1712918281555176
Epoch: 41, Steps: 51 | Train Loss: 0.4009734 Vali Loss: 1.2912673 Test Loss: 0.2944963
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 42 cost time: 1.189967393875122
Epoch: 42, Steps: 51 | Train Loss: 0.4012209 Vali Loss: 1.2919165 Test Loss: 0.2952971
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 43 cost time: 1.2370059490203857
Epoch: 43, Steps: 51 | Train Loss: 0.4008482 Vali Loss: 1.2899514 Test Loss: 0.2948532
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 44 cost time: 1.2436497211456299
Epoch: 44, Steps: 51 | Train Loss: 0.4011759 Vali Loss: 1.2872907 Test Loss: 0.2945300
Validation loss decreased (1.287738 --> 1.287291).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 45 cost time: 1.2486252784729004
Epoch: 45, Steps: 51 | Train Loss: 0.4006329 Vali Loss: 1.2938497 Test Loss: 0.2952719
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 46 cost time: 1.2645368576049805
Epoch: 46, Steps: 51 | Train Loss: 0.4007640 Vali Loss: 1.2923096 Test Loss: 0.2948872
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 47 cost time: 1.2675175666809082
Epoch: 47, Steps: 51 | Train Loss: 0.4010737 Vali Loss: 1.2902364 Test Loss: 0.2957718
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 48 cost time: 1.2195208072662354
Epoch: 48, Steps: 51 | Train Loss: 0.4009301 Vali Loss: 1.2920960 Test Loss: 0.2943899
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 49 cost time: 1.249713659286499
Epoch: 49, Steps: 51 | Train Loss: 0.4011875 Vali Loss: 1.2859485 Test Loss: 0.2948765
Validation loss decreased (1.287291 --> 1.285949).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 50 cost time: 1.2653939723968506
Epoch: 50, Steps: 51 | Train Loss: 0.4006419 Vali Loss: 1.2922851 Test Loss: 0.2941694
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 51 cost time: 1.1626296043395996
Epoch: 51, Steps: 51 | Train Loss: 0.4007971 Vali Loss: 1.2943690 Test Loss: 0.2948504
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 52 cost time: 1.1512696743011475
Epoch: 52, Steps: 51 | Train Loss: 0.4008595 Vali Loss: 1.2929672 Test Loss: 0.2955677
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 53 cost time: 1.2687063217163086
Epoch: 53, Steps: 51 | Train Loss: 0.4006741 Vali Loss: 1.2890902 Test Loss: 0.2950252
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 54 cost time: 1.2776284217834473
Epoch: 54, Steps: 51 | Train Loss: 0.4009766 Vali Loss: 1.2919362 Test Loss: 0.2961203
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 55 cost time: 1.2663793563842773
Epoch: 55, Steps: 51 | Train Loss: 0.4008478 Vali Loss: 1.2892456 Test Loss: 0.2949150
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 56 cost time: 1.263404130935669
Epoch: 56, Steps: 51 | Train Loss: 0.4005104 Vali Loss: 1.2867783 Test Loss: 0.2949593
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 57 cost time: 1.2443969249725342
Epoch: 57, Steps: 51 | Train Loss: 0.4008834 Vali Loss: 1.2936916 Test Loss: 0.2954576
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 58 cost time: 1.2484383583068848
Epoch: 58, Steps: 51 | Train Loss: 0.4008066 Vali Loss: 1.2885009 Test Loss: 0.2937461
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 59 cost time: 1.2660934925079346
Epoch: 59, Steps: 51 | Train Loss: 0.4010179 Vali Loss: 1.2941964 Test Loss: 0.2947791
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02182769775390625 GB
GPU已分配内存的峰值：0.10191106796264648 GB
Epoch: 60 cost time: 1.2473599910736084
Epoch: 60, Steps: 51 | Train Loss: 0.4006091 Vali Loss: 1.2952932 Test Loss: 0.2955531
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_336_PerioDformer_NetTh_ftS_sl336_ll48_pl336_dm64_nh4_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1825
test-mse:0.2948766052722931, mae:0.3611921966075897, rse:0.45323047041893005
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_720', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=720, w=1, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=64, n_heads=4, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_720_PerioDformer_NetTh_ftS_sl336_ll48_pl720_dm64_nh4_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6145
val 1441
test 1441
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.12911033630371094 GB
Epoch: 1 cost time: 3.3012032508850098
Epoch: 1, Steps: 48 | Train Loss: 0.7596959 Vali Loss: 2.0518239 Test Loss: 1.4211031
Validation loss decreased (inf --> 2.051824).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 2 cost time: 1.6538128852844238
Epoch: 2, Steps: 48 | Train Loss: 0.6447498 Vali Loss: 1.4646300 Test Loss: 0.6331540
Validation loss decreased (2.051824 --> 1.464630).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 3 cost time: 1.6739485263824463
Epoch: 3, Steps: 48 | Train Loss: 0.5082760 Vali Loss: 1.3213725 Test Loss: 0.4262734
Validation loss decreased (1.464630 --> 1.321373).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 4 cost time: 1.766446828842163
Epoch: 4, Steps: 48 | Train Loss: 0.4743876 Vali Loss: 1.2866349 Test Loss: 0.3643345
Validation loss decreased (1.321373 --> 1.286635).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 5 cost time: 1.7856862545013428
Epoch: 5, Steps: 48 | Train Loss: 0.4616522 Vali Loss: 1.2778355 Test Loss: 0.3403122
Validation loss decreased (1.286635 --> 1.277835).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 6 cost time: 1.7553894519805908
Epoch: 6, Steps: 48 | Train Loss: 0.4542296 Vali Loss: 1.2705692 Test Loss: 0.3247866
Validation loss decreased (1.277835 --> 1.270569).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 7 cost time: 1.7666759490966797
Epoch: 7, Steps: 48 | Train Loss: 0.4492279 Vali Loss: 1.2605754 Test Loss: 0.3131571
Validation loss decreased (1.270569 --> 1.260575).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 8 cost time: 1.770512342453003
Epoch: 8, Steps: 48 | Train Loss: 0.4453377 Vali Loss: 1.2589406 Test Loss: 0.3063402
Validation loss decreased (1.260575 --> 1.258941).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 9 cost time: 1.7730951309204102
Epoch: 9, Steps: 48 | Train Loss: 0.4421275 Vali Loss: 1.2603663 Test Loss: 0.3003838
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 10 cost time: 1.759653091430664
Epoch: 10, Steps: 48 | Train Loss: 0.4395229 Vali Loss: 1.2571647 Test Loss: 0.2964296
Validation loss decreased (1.258941 --> 1.257165).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 11 cost time: 1.6603972911834717
Epoch: 11, Steps: 48 | Train Loss: 0.4372536 Vali Loss: 1.2612214 Test Loss: 0.2943272
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 12 cost time: 1.6992554664611816
Epoch: 12, Steps: 48 | Train Loss: 0.4358972 Vali Loss: 1.2616500 Test Loss: 0.2918395
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 13 cost time: 1.8080663681030273
Epoch: 13, Steps: 48 | Train Loss: 0.4344192 Vali Loss: 1.2582933 Test Loss: 0.2912932
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 14 cost time: 1.7571275234222412
Epoch: 14, Steps: 48 | Train Loss: 0.4331738 Vali Loss: 1.2595577 Test Loss: 0.2895499
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 15 cost time: 1.7681598663330078
Epoch: 15, Steps: 48 | Train Loss: 0.4320777 Vali Loss: 1.2581143 Test Loss: 0.2890048
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 16 cost time: 1.7577919960021973
Epoch: 16, Steps: 48 | Train Loss: 0.4310138 Vali Loss: 1.2640513 Test Loss: 0.2895619
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 17 cost time: 1.7685143947601318
Epoch: 17, Steps: 48 | Train Loss: 0.4307188 Vali Loss: 1.2592244 Test Loss: 0.2882134
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 18 cost time: 1.7564375400543213
Epoch: 18, Steps: 48 | Train Loss: 0.4296576 Vali Loss: 1.2591465 Test Loss: 0.2875597
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 19 cost time: 1.7565441131591797
Epoch: 19, Steps: 48 | Train Loss: 0.4291614 Vali Loss: 1.2577418 Test Loss: 0.2870498
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 20 cost time: 1.7805235385894775
Epoch: 20, Steps: 48 | Train Loss: 0.4288674 Vali Loss: 1.2586563 Test Loss: 0.2869370
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 21 cost time: 1.7840921878814697
Epoch: 21, Steps: 48 | Train Loss: 0.4281285 Vali Loss: 1.2595601 Test Loss: 0.2866133
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 22 cost time: 1.7594144344329834
Epoch: 22, Steps: 48 | Train Loss: 0.4278190 Vali Loss: 1.2590947 Test Loss: 0.2864205
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 23 cost time: 1.7519996166229248
Epoch: 23, Steps: 48 | Train Loss: 0.4274880 Vali Loss: 1.2570767 Test Loss: 0.2854176
Validation loss decreased (1.257165 --> 1.257077).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 24 cost time: 1.7633345127105713
Epoch: 24, Steps: 48 | Train Loss: 0.4274813 Vali Loss: 1.2642947 Test Loss: 0.2863171
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 25 cost time: 1.7605202198028564
Epoch: 25, Steps: 48 | Train Loss: 0.4270988 Vali Loss: 1.2596983 Test Loss: 0.2855566
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 26 cost time: 1.767467737197876
Epoch: 26, Steps: 48 | Train Loss: 0.4267818 Vali Loss: 1.2569976 Test Loss: 0.2852979
Validation loss decreased (1.257077 --> 1.256998).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 27 cost time: 1.6952664852142334
Epoch: 27, Steps: 48 | Train Loss: 0.4266477 Vali Loss: 1.2603252 Test Loss: 0.2859308
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 28 cost time: 1.742469310760498
Epoch: 28, Steps: 48 | Train Loss: 0.4267221 Vali Loss: 1.2605690 Test Loss: 0.2861330
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 29 cost time: 1.7599167823791504
Epoch: 29, Steps: 48 | Train Loss: 0.4259058 Vali Loss: 1.2602564 Test Loss: 0.2859229
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 30 cost time: 1.7476098537445068
Epoch: 30, Steps: 48 | Train Loss: 0.4262099 Vali Loss: 1.2608635 Test Loss: 0.2854439
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 31 cost time: 1.7521491050720215
Epoch: 31, Steps: 48 | Train Loss: 0.4256852 Vali Loss: 1.2562852 Test Loss: 0.2849767
Validation loss decreased (1.256998 --> 1.256285).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 32 cost time: 1.6449859142303467
Epoch: 32, Steps: 48 | Train Loss: 0.4258538 Vali Loss: 1.2594962 Test Loss: 0.2852873
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 33 cost time: 1.7397618293762207
Epoch: 33, Steps: 48 | Train Loss: 0.4257132 Vali Loss: 1.2552099 Test Loss: 0.2849143
Validation loss decreased (1.256285 --> 1.255210).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 34 cost time: 1.7244713306427002
Epoch: 34, Steps: 48 | Train Loss: 0.4256130 Vali Loss: 1.2616682 Test Loss: 0.2851696
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 35 cost time: 1.7692933082580566
Epoch: 35, Steps: 48 | Train Loss: 0.4253527 Vali Loss: 1.2620287 Test Loss: 0.2857173
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 36 cost time: 1.754629373550415
Epoch: 36, Steps: 48 | Train Loss: 0.4259317 Vali Loss: 1.2642745 Test Loss: 0.2852614
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 37 cost time: 1.7788877487182617
Epoch: 37, Steps: 48 | Train Loss: 0.4254071 Vali Loss: 1.2610216 Test Loss: 0.2852518
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 38 cost time: 1.726337194442749
Epoch: 38, Steps: 48 | Train Loss: 0.4255416 Vali Loss: 1.2573651 Test Loss: 0.2861789
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 39 cost time: 1.7062289714813232
Epoch: 39, Steps: 48 | Train Loss: 0.4253605 Vali Loss: 1.2578932 Test Loss: 0.2850928
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 40 cost time: 1.7880709171295166
Epoch: 40, Steps: 48 | Train Loss: 0.4253991 Vali Loss: 1.2610112 Test Loss: 0.2857513
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 41 cost time: 1.7704601287841797
Epoch: 41, Steps: 48 | Train Loss: 0.4252418 Vali Loss: 1.2562171 Test Loss: 0.2849230
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 42 cost time: 1.7914023399353027
Epoch: 42, Steps: 48 | Train Loss: 0.4251622 Vali Loss: 1.2535703 Test Loss: 0.2840986
Validation loss decreased (1.255210 --> 1.253570).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 43 cost time: 1.784236192703247
Epoch: 43, Steps: 48 | Train Loss: 0.4254316 Vali Loss: 1.2581401 Test Loss: 0.2841303
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 44 cost time: 1.7605485916137695
Epoch: 44, Steps: 48 | Train Loss: 0.4249351 Vali Loss: 1.2604512 Test Loss: 0.2847709
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 45 cost time: 1.6344029903411865
Epoch: 45, Steps: 48 | Train Loss: 0.4250175 Vali Loss: 1.2640922 Test Loss: 0.2851563
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 46 cost time: 1.7503960132598877
Epoch: 46, Steps: 48 | Train Loss: 0.4252435 Vali Loss: 1.2571105 Test Loss: 0.2849482
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 47 cost time: 1.7604706287384033
Epoch: 47, Steps: 48 | Train Loss: 0.4250603 Vali Loss: 1.2530704 Test Loss: 0.2843485
Validation loss decreased (1.253570 --> 1.253070).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 48 cost time: 1.7313916683197021
Epoch: 48, Steps: 48 | Train Loss: 0.4252774 Vali Loss: 1.2595546 Test Loss: 0.2862166
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 49 cost time: 1.7687404155731201
Epoch: 49, Steps: 48 | Train Loss: 0.4248379 Vali Loss: 1.2589883 Test Loss: 0.2848800
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 50 cost time: 1.8100550174713135
Epoch: 50, Steps: 48 | Train Loss: 0.4249129 Vali Loss: 1.2581135 Test Loss: 0.2843635
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 51 cost time: 1.7514071464538574
Epoch: 51, Steps: 48 | Train Loss: 0.4250342 Vali Loss: 1.2609563 Test Loss: 0.2852435
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 52 cost time: 1.76137375831604
Epoch: 52, Steps: 48 | Train Loss: 0.4249814 Vali Loss: 1.2617728 Test Loss: 0.2845841
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 53 cost time: 1.764112949371338
Epoch: 53, Steps: 48 | Train Loss: 0.4250552 Vali Loss: 1.2602865 Test Loss: 0.2848397
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 54 cost time: 1.732255220413208
Epoch: 54, Steps: 48 | Train Loss: 0.4251805 Vali Loss: 1.2590495 Test Loss: 0.2852022
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 55 cost time: 1.7234563827514648
Epoch: 55, Steps: 48 | Train Loss: 0.4250689 Vali Loss: 1.2620883 Test Loss: 0.2863948
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 56 cost time: 1.750457525253296
Epoch: 56, Steps: 48 | Train Loss: 0.4246635 Vali Loss: 1.2601962 Test Loss: 0.2850114
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 57 cost time: 1.750265121459961
Epoch: 57, Steps: 48 | Train Loss: 0.4249257 Vali Loss: 1.2564836 Test Loss: 0.2846219
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 58 cost time: 1.7720959186553955
Epoch: 58, Steps: 48 | Train Loss: 0.4249988 Vali Loss: 1.2580068 Test Loss: 0.2837878
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 59 cost time: 1.7659001350402832
Epoch: 59, Steps: 48 | Train Loss: 0.4248720 Vali Loss: 1.2634829 Test Loss: 0.2852328
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02457427978515625 GB
GPU已分配内存的峰值：0.13277959823608398 GB
Epoch: 60 cost time: 1.8091559410095215
Epoch: 60, Steps: 48 | Train Loss: 0.4250096 Vali Loss: 1.2587103 Test Loss: 0.2852172
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_720_PerioDformer_NetTh_ftS_sl336_ll48_pl720_dm64_nh4_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1441
test-mse:0.2843484580516815, mae:0.36102908849716187, rse:0.4523908197879791
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_960', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=960, w=1, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=64, n_heads=4, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_960_PerioDformer_NetTh_ftS_sl336_ll48_pl960_dm64_nh4_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 5905
val 1201
test 1201
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.148651123046875 GB
Epoch: 1 cost time: 3.6622602939605713
Epoch: 1, Steps: 46 | Train Loss: 0.7811044 Vali Loss: 2.0391381 Test Loss: 1.4272466
Validation loss decreased (inf --> 2.039138).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 2 cost time: 2.0355844497680664
Epoch: 2, Steps: 46 | Train Loss: 0.6719136 Vali Loss: 1.4629568 Test Loss: 0.6618931
Validation loss decreased (2.039138 --> 1.462957).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 3 cost time: 2.0567779541015625
Epoch: 3, Steps: 46 | Train Loss: 0.5314063 Vali Loss: 1.3313832 Test Loss: 0.4407491
Validation loss decreased (1.462957 --> 1.331383).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 4 cost time: 2.0228753089904785
Epoch: 4, Steps: 46 | Train Loss: 0.4941948 Vali Loss: 1.2861724 Test Loss: 0.3681338
Validation loss decreased (1.331383 --> 1.286172).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 5 cost time: 2.018531084060669
Epoch: 5, Steps: 46 | Train Loss: 0.4795161 Vali Loss: 1.2719575 Test Loss: 0.3436077
Validation loss decreased (1.286172 --> 1.271958).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 6 cost time: 2.03317928314209
Epoch: 6, Steps: 46 | Train Loss: 0.4708726 Vali Loss: 1.2776828 Test Loss: 0.3270137
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 7 cost time: 2.024860143661499
Epoch: 7, Steps: 46 | Train Loss: 0.4651069 Vali Loss: 1.2813048 Test Loss: 0.3162673
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 8 cost time: 2.016902446746826
Epoch: 8, Steps: 46 | Train Loss: 0.4602275 Vali Loss: 1.2802515 Test Loss: 0.3088411
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 9 cost time: 2.003386974334717
Epoch: 9, Steps: 46 | Train Loss: 0.4566428 Vali Loss: 1.2787008 Test Loss: 0.3037442
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 10 cost time: 2.0251307487487793
Epoch: 10, Steps: 46 | Train Loss: 0.4539478 Vali Loss: 1.2778591 Test Loss: 0.3008679
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 11 cost time: 2.022569417953491
Epoch: 11, Steps: 46 | Train Loss: 0.4518536 Vali Loss: 1.2760603 Test Loss: 0.2969577
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 12 cost time: 2.039450168609619
Epoch: 12, Steps: 46 | Train Loss: 0.4499422 Vali Loss: 1.2788652 Test Loss: 0.2951609
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 13 cost time: 2.051497220993042
Epoch: 13, Steps: 46 | Train Loss: 0.4481753 Vali Loss: 1.2780151 Test Loss: 0.2925632
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 14 cost time: 2.038306713104248
Epoch: 14, Steps: 46 | Train Loss: 0.4463957 Vali Loss: 1.2819657 Test Loss: 0.2916065
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 15 cost time: 2.0341970920562744
Epoch: 15, Steps: 46 | Train Loss: 0.4453868 Vali Loss: 1.2839799 Test Loss: 0.2902775
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 16 cost time: 2.0135440826416016
Epoch: 16, Steps: 46 | Train Loss: 0.4443499 Vali Loss: 1.2776470 Test Loss: 0.2900287
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 17 cost time: 2.0478622913360596
Epoch: 17, Steps: 46 | Train Loss: 0.4434869 Vali Loss: 1.2776091 Test Loss: 0.2877270
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 18 cost time: 1.949420690536499
Epoch: 18, Steps: 46 | Train Loss: 0.4427411 Vali Loss: 1.2728468 Test Loss: 0.2875754
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 19 cost time: 1.8737871646881104
Epoch: 19, Steps: 46 | Train Loss: 0.4421950 Vali Loss: 1.2735192 Test Loss: 0.2871506
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 20 cost time: 2.011336326599121
Epoch: 20, Steps: 46 | Train Loss: 0.4415811 Vali Loss: 1.2794694 Test Loss: 0.2878574
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 21 cost time: 2.0708563327789307
Epoch: 21, Steps: 46 | Train Loss: 0.4411801 Vali Loss: 1.2737876 Test Loss: 0.2854355
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 22 cost time: 2.022833824157715
Epoch: 22, Steps: 46 | Train Loss: 0.4404456 Vali Loss: 1.2838830 Test Loss: 0.2854750
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 23 cost time: 2.0375053882598877
Epoch: 23, Steps: 46 | Train Loss: 0.4400204 Vali Loss: 1.2702953 Test Loss: 0.2839020
Validation loss decreased (1.271958 --> 1.270295).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 24 cost time: 2.05824875831604
Epoch: 24, Steps: 46 | Train Loss: 0.4404528 Vali Loss: 1.2811036 Test Loss: 0.2863126
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 25 cost time: 2.0254621505737305
Epoch: 25, Steps: 46 | Train Loss: 0.4396498 Vali Loss: 1.2792118 Test Loss: 0.2849374
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 26 cost time: 2.0064263343811035
Epoch: 26, Steps: 46 | Train Loss: 0.4396565 Vali Loss: 1.2773463 Test Loss: 0.2841215
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 27 cost time: 2.0302436351776123
Epoch: 27, Steps: 46 | Train Loss: 0.4391771 Vali Loss: 1.2800645 Test Loss: 0.2846407
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 28 cost time: 2.0402612686157227
Epoch: 28, Steps: 46 | Train Loss: 0.4391660 Vali Loss: 1.2796953 Test Loss: 0.2836074
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 29 cost time: 2.0141208171844482
Epoch: 29, Steps: 46 | Train Loss: 0.4388366 Vali Loss: 1.2759867 Test Loss: 0.2831108
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 30 cost time: 1.9265234470367432
Epoch: 30, Steps: 46 | Train Loss: 0.4387120 Vali Loss: 1.2845494 Test Loss: 0.2837440
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 31 cost time: 2.0221216678619385
Epoch: 31, Steps: 46 | Train Loss: 0.4384275 Vali Loss: 1.2790878 Test Loss: 0.2834533
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 32 cost time: 2.0251946449279785
Epoch: 32, Steps: 46 | Train Loss: 0.4380429 Vali Loss: 1.2790141 Test Loss: 0.2840485
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 33 cost time: 2.033106565475464
Epoch: 33, Steps: 46 | Train Loss: 0.4382806 Vali Loss: 1.2773885 Test Loss: 0.2821215
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 34 cost time: 2.0302202701568604
Epoch: 34, Steps: 46 | Train Loss: 0.4381016 Vali Loss: 1.2732830 Test Loss: 0.2829769
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 35 cost time: 2.0437591075897217
Epoch: 35, Steps: 46 | Train Loss: 0.4377755 Vali Loss: 1.2760175 Test Loss: 0.2834505
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 36 cost time: 1.970250129699707
Epoch: 36, Steps: 46 | Train Loss: 0.4382182 Vali Loss: 1.2751318 Test Loss: 0.2831371
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 37 cost time: 1.9610671997070312
Epoch: 37, Steps: 46 | Train Loss: 0.4376445 Vali Loss: 1.2758734 Test Loss: 0.2827638
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 38 cost time: 2.016777515411377
Epoch: 38, Steps: 46 | Train Loss: 0.4377336 Vali Loss: 1.2788174 Test Loss: 0.2828474
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 39 cost time: 2.018361806869507
Epoch: 39, Steps: 46 | Train Loss: 0.4377084 Vali Loss: 1.2796637 Test Loss: 0.2825496
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 40 cost time: 2.0129103660583496
Epoch: 40, Steps: 46 | Train Loss: 0.4376172 Vali Loss: 1.2677507 Test Loss: 0.2815048
Validation loss decreased (1.270295 --> 1.267751).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 41 cost time: 2.0307583808898926
Epoch: 41, Steps: 46 | Train Loss: 0.4372737 Vali Loss: 1.2737591 Test Loss: 0.2825923
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 42 cost time: 2.074655294418335
Epoch: 42, Steps: 46 | Train Loss: 0.4379713 Vali Loss: 1.2803786 Test Loss: 0.2830546
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 43 cost time: 1.9822239875793457
Epoch: 43, Steps: 46 | Train Loss: 0.4373660 Vali Loss: 1.2733712 Test Loss: 0.2828205
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 44 cost time: 1.9960196018218994
Epoch: 44, Steps: 46 | Train Loss: 0.4375575 Vali Loss: 1.2775288 Test Loss: 0.2818134
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 45 cost time: 2.0152101516723633
Epoch: 45, Steps: 46 | Train Loss: 0.4375885 Vali Loss: 1.2711233 Test Loss: 0.2825592
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 46 cost time: 2.00825572013855
Epoch: 46, Steps: 46 | Train Loss: 0.4371089 Vali Loss: 1.2806447 Test Loss: 0.2830067
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 47 cost time: 2.009981155395508
Epoch: 47, Steps: 46 | Train Loss: 0.4374116 Vali Loss: 1.2818244 Test Loss: 0.2822137
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 48 cost time: 2.016580104827881
Epoch: 48, Steps: 46 | Train Loss: 0.4373319 Vali Loss: 1.2824477 Test Loss: 0.2830659
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 49 cost time: 2.0144522190093994
Epoch: 49, Steps: 46 | Train Loss: 0.4371130 Vali Loss: 1.2764119 Test Loss: 0.2826490
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 50 cost time: 1.9924101829528809
Epoch: 50, Steps: 46 | Train Loss: 0.4374087 Vali Loss: 1.2816944 Test Loss: 0.2817587
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 51 cost time: 1.9934065341949463
Epoch: 51, Steps: 46 | Train Loss: 0.4371854 Vali Loss: 1.2790880 Test Loss: 0.2830087
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 52 cost time: 2.027467727661133
Epoch: 52, Steps: 46 | Train Loss: 0.4374718 Vali Loss: 1.2786630 Test Loss: 0.2828414
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 53 cost time: 2.039393663406372
Epoch: 53, Steps: 46 | Train Loss: 0.4374372 Vali Loss: 1.2741479 Test Loss: 0.2826391
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 54 cost time: 2.0115041732788086
Epoch: 54, Steps: 46 | Train Loss: 0.4372064 Vali Loss: 1.2774700 Test Loss: 0.2828638
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 55 cost time: 2.0312187671661377
Epoch: 55, Steps: 46 | Train Loss: 0.4373176 Vali Loss: 1.2822080 Test Loss: 0.2824420
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 56 cost time: 2.056089401245117
Epoch: 56, Steps: 46 | Train Loss: 0.4372913 Vali Loss: 1.2718673 Test Loss: 0.2812986
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 57 cost time: 2.053676128387451
Epoch: 57, Steps: 46 | Train Loss: 0.4368342 Vali Loss: 1.2726526 Test Loss: 0.2823054
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 58 cost time: 2.0269854068756104
Epoch: 58, Steps: 46 | Train Loss: 0.4371990 Vali Loss: 1.2718198 Test Loss: 0.2814996
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 59 cost time: 1.9796247482299805
Epoch: 59, Steps: 46 | Train Loss: 0.4367748 Vali Loss: 1.2775638 Test Loss: 0.2830965
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0262908935546875 GB
GPU已分配内存的峰值：0.15302610397338867 GB
Epoch: 60 cost time: 2.0057265758514404
Epoch: 60, Steps: 46 | Train Loss: 0.4372618 Vali Loss: 1.2755166 Test Loss: 0.2824238
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_960_PerioDformer_NetTh_ftS_sl336_ll48_pl960_dm64_nh4_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1201
test-mse:0.2815048396587372, mae:0.35805004835128784, rse:0.45215827226638794
