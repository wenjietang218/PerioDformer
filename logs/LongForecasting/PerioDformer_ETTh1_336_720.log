Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='ETTh1_336_720', model='PerioDformer', data='ETTh1', root_path='./dataset/', data_path='ETTh1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=720, w=3, C=24, mlp_num=1, d_model2=32, d_ff2=256, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=5, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_336_720_PerioDformer_ETTh1_ftM_sl336_ll48_pl720_dm16_nh4_el5_dl1_df256_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_256__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
0
Training with all the variates.
当前GPU已分配内存：0.0318603515625 GB
GPU已分配内存的峰值：0.7212371826171875 GB
Epoch: 1 cost time: 6.586956739425659
Epoch: 1, Steps: 59 | Train Loss: 0.8999649 Vali Loss: 1.9919304 Test Loss: 0.7792898
Validation loss decreased (inf --> 1.991930).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 2 cost time: 5.001381874084473
Epoch: 2, Steps: 59 | Train Loss: 0.8238622 Vali Loss: 1.7660614 Test Loss: 0.6198627
Validation loss decreased (1.991930 --> 1.766061).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 3 cost time: 5.004127264022827
Epoch: 3, Steps: 59 | Train Loss: 0.7258603 Vali Loss: 1.6490674 Test Loss: 0.5366755
Validation loss decreased (1.766061 --> 1.649067).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 4 cost time: 4.973871231079102
Epoch: 4, Steps: 59 | Train Loss: 0.6742343 Vali Loss: 1.5948112 Test Loss: 0.4894371
Validation loss decreased (1.649067 --> 1.594811).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 5 cost time: 4.9716832637786865
Epoch: 5, Steps: 59 | Train Loss: 0.6460339 Vali Loss: 1.5488048 Test Loss: 0.4624957
Validation loss decreased (1.594811 --> 1.548805).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 6 cost time: 4.975809574127197
Epoch: 6, Steps: 59 | Train Loss: 0.6277865 Vali Loss: 1.5354363 Test Loss: 0.4493304
Validation loss decreased (1.548805 --> 1.535436).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 7 cost time: 4.980329990386963
Epoch: 7, Steps: 59 | Train Loss: 0.6163175 Vali Loss: 1.5244043 Test Loss: 0.4395290
Validation loss decreased (1.535436 --> 1.524404).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 8 cost time: 4.985644102096558
Epoch: 8, Steps: 59 | Train Loss: 0.6074295 Vali Loss: 1.5238919 Test Loss: 0.4327701
Validation loss decreased (1.524404 --> 1.523892).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 9 cost time: 4.980761289596558
Epoch: 9, Steps: 59 | Train Loss: 0.6011788 Vali Loss: 1.5111576 Test Loss: 0.4265238
Validation loss decreased (1.523892 --> 1.511158).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 10 cost time: 4.986276626586914
Epoch: 10, Steps: 59 | Train Loss: 0.5964669 Vali Loss: 1.5090135 Test Loss: 0.4264917
Validation loss decreased (1.511158 --> 1.509014).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 11 cost time: 4.984264850616455
Epoch: 11, Steps: 59 | Train Loss: 0.5934026 Vali Loss: 1.5062969 Test Loss: 0.4234771
Validation loss decreased (1.509014 --> 1.506297).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 12 cost time: 5.034087896347046
Epoch: 12, Steps: 59 | Train Loss: 0.5903917 Vali Loss: 1.5082663 Test Loss: 0.4223497
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 13 cost time: 5.032999515533447
Epoch: 13, Steps: 59 | Train Loss: 0.5876020 Vali Loss: 1.5036262 Test Loss: 0.4222277
Validation loss decreased (1.506297 --> 1.503626).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 14 cost time: 4.986518144607544
Epoch: 14, Steps: 59 | Train Loss: 0.5860859 Vali Loss: 1.5074731 Test Loss: 0.4198521
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 15 cost time: 4.986307382583618
Epoch: 15, Steps: 59 | Train Loss: 0.5835255 Vali Loss: 1.5035142 Test Loss: 0.4185649
Validation loss decreased (1.503626 --> 1.503514).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 16 cost time: 4.98331356048584
Epoch: 16, Steps: 59 | Train Loss: 0.5818762 Vali Loss: 1.5015569 Test Loss: 0.4184764
Validation loss decreased (1.503514 --> 1.501557).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 17 cost time: 4.9882776737213135
Epoch: 17, Steps: 59 | Train Loss: 0.5807263 Vali Loss: 1.5031137 Test Loss: 0.4177816
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 18 cost time: 4.989842891693115
Epoch: 18, Steps: 59 | Train Loss: 0.5800163 Vali Loss: 1.5068729 Test Loss: 0.4166035
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 19 cost time: 4.987684488296509
Epoch: 19, Steps: 59 | Train Loss: 0.5788162 Vali Loss: 1.5074604 Test Loss: 0.4167227
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 20 cost time: 4.9890923500061035
Epoch: 20, Steps: 59 | Train Loss: 0.5780330 Vali Loss: 1.5080349 Test Loss: 0.4148784
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 21 cost time: 4.982402563095093
Epoch: 21, Steps: 59 | Train Loss: 0.5772375 Vali Loss: 1.5015806 Test Loss: 0.4152316
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 22 cost time: 5.0157716274261475
Epoch: 22, Steps: 59 | Train Loss: 0.5770145 Vali Loss: 1.5090808 Test Loss: 0.4142537
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 23 cost time: 5.007261037826538
Epoch: 23, Steps: 59 | Train Loss: 0.5758305 Vali Loss: 1.5073652 Test Loss: 0.4146042
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 24 cost time: 4.991987228393555
Epoch: 24, Steps: 59 | Train Loss: 0.5754897 Vali Loss: 1.5048287 Test Loss: 0.4136942
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 25 cost time: 4.9922873973846436
Epoch: 25, Steps: 59 | Train Loss: 0.5748502 Vali Loss: 1.5041817 Test Loss: 0.4137474
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 26 cost time: 4.985979080200195
Epoch: 26, Steps: 59 | Train Loss: 0.5737347 Vali Loss: 1.5032365 Test Loss: 0.4131214
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 27 cost time: 4.992158889770508
Epoch: 27, Steps: 59 | Train Loss: 0.5739821 Vali Loss: 1.5031383 Test Loss: 0.4135902
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 28 cost time: 4.993350028991699
Epoch: 28, Steps: 59 | Train Loss: 0.5728543 Vali Loss: 1.5065396 Test Loss: 0.4126220
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 29 cost time: 4.99399209022522
Epoch: 29, Steps: 59 | Train Loss: 0.5732911 Vali Loss: 1.5083680 Test Loss: 0.4125386
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 30 cost time: 4.9958717823028564
Epoch: 30, Steps: 59 | Train Loss: 0.5725368 Vali Loss: 1.5037178 Test Loss: 0.4133325
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 31 cost time: 4.9996984004974365
Epoch: 31, Steps: 59 | Train Loss: 0.5725601 Vali Loss: 1.5073047 Test Loss: 0.4116943
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 32 cost time: 5.0168352127075195
Epoch: 32, Steps: 59 | Train Loss: 0.5719830 Vali Loss: 1.4996107 Test Loss: 0.4121447
Validation loss decreased (1.501557 --> 1.499611).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 33 cost time: 4.99383544921875
Epoch: 33, Steps: 59 | Train Loss: 0.5720367 Vali Loss: 1.5040932 Test Loss: 0.4114553
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 34 cost time: 4.994793653488159
Epoch: 34, Steps: 59 | Train Loss: 0.5724931 Vali Loss: 1.5058427 Test Loss: 0.4117398
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 35 cost time: 4.994276285171509
Epoch: 35, Steps: 59 | Train Loss: 0.5716353 Vali Loss: 1.5040706 Test Loss: 0.4113409
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 36 cost time: 4.987895250320435
Epoch: 36, Steps: 59 | Train Loss: 0.5717184 Vali Loss: 1.5056332 Test Loss: 0.4118779
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 37 cost time: 5.179501295089722
Epoch: 37, Steps: 59 | Train Loss: 0.5712531 Vali Loss: 1.5008600 Test Loss: 0.4108016
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 38 cost time: 5.079002618789673
Epoch: 38, Steps: 59 | Train Loss: 0.5717500 Vali Loss: 1.5019681 Test Loss: 0.4114197
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 39 cost time: 4.992505311965942
Epoch: 39, Steps: 59 | Train Loss: 0.5711830 Vali Loss: 1.5014457 Test Loss: 0.4106944
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 40 cost time: 4.991997480392456
Epoch: 40, Steps: 59 | Train Loss: 0.5709729 Vali Loss: 1.5054975 Test Loss: 0.4111381
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 41 cost time: 5.046217203140259
Epoch: 41, Steps: 59 | Train Loss: 0.5710445 Vali Loss: 1.5063901 Test Loss: 0.4111681
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
Epoch: 42 cost time: 5.074121475219727
Epoch: 42, Steps: 59 | Train Loss: 0.5711922 Vali Loss: 1.5104721 Test Loss: 0.4106580
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0329132080078125 GB
GPU已分配内存的峰值：0.728600025177002 GB
