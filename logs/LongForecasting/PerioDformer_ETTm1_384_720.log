Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='ETTm1_384_720', model='PerioDformer', data='ETTm1', root_path='./dataset/10%/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=384, label_len=48, pred_len=720, w=1, C=48, mlp_num=1, d_model2=128, d_ff2=256, experiment=2, dimension=64, percent=0, fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=64, n_heads=8, e_layers=5, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=10, batch_size=128, patience=20, learning_rate=0.0001, des='Exp', loss='mse', lradj='TST', pct_start=0.4, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 8655
>>>>>>>start training : ETTm1_384_720_PerioDformer_ETTm1_ftM_sl384_ll48_pl720_dm64_nh8_el5_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_48_1_128_256__exp2_dim64_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33457
val 10801
test 10801
0
Training with all the variates.
当前GPU已分配内存：0.04218864440917969 GB
GPU已分配内存的峰值：1.6616301536560059 GB
	iters: 100, epoch: 1 | loss: 0.6058219
	speed: 0.2037s/iter; left time: 511.3792s
	iters: 200, epoch: 1 | loss: 0.6023779
	speed: 0.1896s/iter; left time: 457.1410s
Epoch: 1 cost time: 50.901721715927124
Epoch: 1, Steps: 261 | Train Loss: 0.5920944 Vali Loss: 1.1795487 Test Loss: 0.6012298
Validation loss decreased (inf --> 1.179549).  Saving model ...
Updating learning rate to 1.8084442414672414e-05
0
Training with all the variates.
当前GPU已分配内存：0.04281425476074219 GB
GPU已分配内存的峰值：1.6675143241882324 GB
	iters: 100, epoch: 2 | loss: 0.4867920
	speed: 0.4490s/iter; left time: 1010.1929s
	iters: 200, epoch: 2 | loss: 0.4292898
	speed: 0.1902s/iter; left time: 408.9253s
Epoch: 2 cost time: 49.518515825271606
Epoch: 2, Steps: 261 | Train Loss: 0.4753043 Vali Loss: 0.9652092 Test Loss: 0.4331545
Validation loss decreased (1.179549 --> 0.965209).  Saving model ...
Updating learning rate to 5.20722897365137e-05
0
Training with all the variates.
当前GPU已分配内存：0.04265403747558594 GB
GPU已分配内存的峰值：1.6675143241882324 GB
	iters: 100, epoch: 3 | loss: 0.4415785
	speed: 0.4492s/iter; left time: 893.4180s
	iters: 200, epoch: 3 | loss: 0.4574403
	speed: 0.1905s/iter; left time: 359.7636s
Epoch: 3 cost time: 49.55550456047058
Epoch: 3, Steps: 261 | Train Loss: 0.4188621 Vali Loss: 0.9394192 Test Loss: 0.4140296
Validation loss decreased (0.965209 --> 0.939419).  Saving model ...
Updating learning rate to 8.601771369872585e-05
0
Training with all the variates.
当前GPU已分配内存：0.04281425476074219 GB
GPU已分配内存的峰值：1.6675143241882324 GB
	iters: 100, epoch: 4 | loss: 0.4372025
	speed: 0.4490s/iter; left time: 775.8870s
	iters: 200, epoch: 4 | loss: 0.4060408
	speed: 0.1906s/iter; left time: 310.3419s
Epoch: 4 cost time: 49.565247535705566
Epoch: 4, Steps: 261 | Train Loss: 0.4063774 Vali Loss: 0.9474187 Test Loss: 0.4105581
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.999989938694043e-05
0
Training with all the variates.
当前GPU已分配内存：0.04265403747558594 GB
GPU已分配内存的峰值：1.6675143241882324 GB
	iters: 100, epoch: 5 | loss: 0.4025469
	speed: 0.4492s/iter; left time: 658.9295s
	iters: 200, epoch: 5 | loss: 0.3776571
	speed: 0.1903s/iter; left time: 260.0978s
Epoch: 5 cost time: 49.57435750961304
Epoch: 5, Steps: 261 | Train Loss: 0.3977076 Vali Loss: 0.9561759 Test Loss: 0.4123686
EarlyStopping counter: 2 out of 20
Updating learning rate to 9.325105694550348e-05
0
Training with all the variates.
当前GPU已分配内存：0.04281425476074219 GB
GPU已分配内存的峰值：1.6675143241882324 GB
	iters: 100, epoch: 6 | loss: 0.4256894
	speed: 0.4496s/iter; left time: 542.1734s
	iters: 200, epoch: 6 | loss: 0.3693973
	speed: 0.1900s/iter; left time: 210.1004s
Epoch: 6 cost time: 49.59798073768616
Epoch: 6, Steps: 261 | Train Loss: 0.3893681 Vali Loss: 0.9512471 Test Loss: 0.4133708
EarlyStopping counter: 3 out of 20
Updating learning rate to 7.491318231356486e-05
0
Training with all the variates.
当前GPU已分配内存：0.04265403747558594 GB
GPU已分配内存的峰值：1.6675143241882324 GB
	iters: 100, epoch: 7 | loss: 0.3848913
	speed: 0.4497s/iter; left time: 424.9221s
	iters: 200, epoch: 7 | loss: 0.3773564
	speed: 0.1900s/iter; left time: 160.5471s
Epoch: 7 cost time: 49.59100914001465
Epoch: 7, Steps: 261 | Train Loss: 0.3824482 Vali Loss: 0.9567794 Test Loss: 0.4160132
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.9899894189655695e-05
0
Training with all the variates.
当前GPU已分配内存：0.04281425476074219 GB
GPU已分配内存的峰值：1.6675143241882324 GB
	iters: 100, epoch: 8 | loss: 0.3438168
	speed: 0.4498s/iter; left time: 307.6572s
	iters: 200, epoch: 8 | loss: 0.3828096
	speed: 0.1900s/iter; left time: 110.9807s
Epoch: 8 cost time: 49.59748840332031
Epoch: 8, Steps: 261 | Train Loss: 0.3778332 Vali Loss: 0.9528306 Test Loss: 0.4177783
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.491348292662442e-05
0
Training with all the variates.
当前GPU已分配内存：0.04265403747558594 GB
GPU已分配内存的峰值：1.6675143241882324 GB
	iters: 100, epoch: 9 | loss: 0.3865460
	speed: 0.4499s/iter; left time: 190.3158s
	iters: 200, epoch: 9 | loss: 0.3887947
	speed: 0.1900s/iter; left time: 61.3725s
Epoch: 9 cost time: 49.60054111480713
Epoch: 9, Steps: 261 | Train Loss: 0.3751171 Vali Loss: 0.9561339 Test Loss: 0.4169852
EarlyStopping counter: 6 out of 20
Updating learning rate to 6.649037244152206e-06
0
Training with all the variates.
当前GPU已分配内存：0.04281425476074219 GB
GPU已分配内存的峰值：1.6675143241882324 GB
	iters: 100, epoch: 10 | loss: 0.3347655
	speed: 0.4493s/iter; left time: 72.7880s
	iters: 200, epoch: 10 | loss: 0.3535173
	speed: 0.1900s/iter; left time: 11.7784s
Epoch: 10 cost time: 49.5656259059906
Epoch: 10, Steps: 261 | Train Loss: 0.3740415 Vali Loss: 0.9540313 Test Loss: 0.4170835
EarlyStopping counter: 7 out of 20
Updating learning rate to 5.00613059569099e-10
>>>>>>>testing : ETTm1_384_720_PerioDformer_ETTm1_ftM_sl384_ll48_pl720_dm64_nh8_el5_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_48_1_128_256__exp2_dim64_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test-mse:0.41402938961982727, mae:0.4190128445625305, rse:0.6125308871269226
