Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='ETTm1_384_96', model='PerioDformer', data='ETTm1', root_path='./dataset/10%/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=384, label_len=48, pred_len=96, w=6, C=48, mlp_num=2, d_model2=128, d_ff2=256, experiment=2, dimension=64, percent=0, fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=64, n_heads=8, e_layers=2, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=10, batch_size=128, patience=20, learning_rate=0.0001, des='Exp', loss='mse', lradj='TST', pct_start=0.4, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 332930
>>>>>>>start training : ETTm1_384_96_PerioDformer_ETTm1_ftM_sl384_ll48_pl96_dm64_nh8_el2_dl1_df128_fc1_ebtimeF_dtTrue_Exp_6_48_2_128_256__exp2_dim64_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34081
val 11425
test 11425
0
Training with all the variates.
当前GPU已分配内存：0.03003978729248047 GB
GPU已分配内存的峰值：0.8591060638427734 GB
	iters: 100, epoch: 1 | loss: 0.4018428
	speed: 0.1206s/iter; left time: 308.9599s
	iters: 200, epoch: 1 | loss: 0.3417354
	speed: 0.1065s/iter; left time: 262.0050s
Epoch: 1 cost time: 29.76722550392151
Epoch: 1, Steps: 266 | Train Loss: 0.3908533 Vali Loss: 0.4524066 Test Loss: 0.3629870
Validation loss decreased (inf --> 0.452407).  Saving model ...
Updating learning rate to 1.8083961185155783e-05
0
Training with all the variates.
当前GPU已分配内存：0.03003978729248047 GB
GPU已分配内存的峰值：0.8643579483032227 GB
	iters: 100, epoch: 2 | loss: 0.2825136
	speed: 0.2760s/iter; left time: 633.3795s
	iters: 200, epoch: 2 | loss: 0.2895737
	speed: 0.1066s/iter; left time: 234.0100s
Epoch: 2 cost time: 28.28653621673584
Epoch: 2, Steps: 266 | Train Loss: 0.2872765 Vali Loss: 0.3924060 Test Loss: 0.3127102
Validation loss decreased (0.452407 --> 0.392406).  Saving model ...
Updating learning rate to 5.207092962958252e-05
0
Training with all the variates.
当前GPU已分配内存：0.03003978729248047 GB
GPU已分配内存的峰值：0.8643579483032227 GB
	iters: 100, epoch: 3 | loss: 0.2517132
	speed: 0.2769s/iter; left time: 561.8780s
	iters: 200, epoch: 3 | loss: 0.2898469
	speed: 0.1067s/iter; left time: 205.8233s
Epoch: 3 cost time: 28.489782333374023
Epoch: 3, Steps: 266 | Train Loss: 0.2691092 Vali Loss: 0.3871292 Test Loss: 0.3044395
Validation loss decreased (0.392406 --> 0.387129).  Saving model ...
Updating learning rate to 8.601627431776268e-05
0
Training with all the variates.
当前GPU已分配内存：0.03003978729248047 GB
GPU已分配内存的峰值：0.8643579483032227 GB
	iters: 100, epoch: 4 | loss: 0.2626796
	speed: 0.2800s/iter; left time: 493.5522s
	iters: 200, epoch: 4 | loss: 0.2523627
	speed: 0.1074s/iter; left time: 178.6128s
Epoch: 4 cost time: 28.526914358139038
Epoch: 4, Steps: 266 | Train Loss: 0.2594275 Vali Loss: 0.3775656 Test Loss: 0.2987018
Validation loss decreased (0.387129 --> 0.377566).  Saving model ...
Updating learning rate to 9.999990313383577e-05
0
Training with all the variates.
当前GPU已分配内存：0.03003978729248047 GB
GPU已分配内存的峰值：0.8643579483032227 GB
	iters: 100, epoch: 5 | loss: 0.2541599
	speed: 0.2794s/iter; left time: 418.2567s
	iters: 200, epoch: 5 | loss: 0.2330045
	speed: 0.1074s/iter; left time: 150.0655s
Epoch: 5 cost time: 28.566518783569336
Epoch: 5, Steps: 266 | Train Loss: 0.2516142 Vali Loss: 0.3742585 Test Loss: 0.2954646
Validation loss decreased (0.377566 --> 0.374258).  Saving model ...
Updating learning rate to 9.325200291296221e-05
0
Training with all the variates.
当前GPU已分配内存：0.03003978729248047 GB
GPU已分配内存的峰值：0.8643579483032227 GB
	iters: 100, epoch: 6 | loss: 0.2244761
	speed: 0.2808s/iter; left time: 345.6243s
	iters: 200, epoch: 6 | loss: 0.2759221
	speed: 0.1078s/iter; left time: 121.9448s
Epoch: 6 cost time: 28.705739498138428
Epoch: 6, Steps: 266 | Train Loss: 0.2464469 Vali Loss: 0.3721792 Test Loss: 0.2938805
Validation loss decreased (0.374258 --> 0.372179).  Saving model ...
Updating learning rate to 7.491481703037036e-05
0
Training with all the variates.
当前GPU已分配内存：0.03003978729248047 GB
GPU已分配内存的峰值：0.8643579483032227 GB
	iters: 100, epoch: 7 | loss: 0.2465921
	speed: 0.2769s/iter; left time: 267.2192s
	iters: 200, epoch: 7 | loss: 0.2390499
	speed: 0.1068s/iter; left time: 92.3747s
Epoch: 7 cost time: 28.387656688690186
Epoch: 7, Steps: 266 | Train Loss: 0.2429606 Vali Loss: 0.3777930 Test Loss: 0.2936681
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.990177963476007e-05
0
Training with all the variates.
当前GPU已分配内存：0.03003978729248047 GB
GPU已分配内存的峰值：0.8643579483032227 GB
	iters: 100, epoch: 8 | loss: 0.2352795
	speed: 0.2774s/iter; left time: 193.8692s
	iters: 200, epoch: 8 | loss: 0.2349691
	speed: 0.1067s/iter; left time: 63.9334s
Epoch: 8 cost time: 28.462186336517334
Epoch: 8, Steps: 266 | Train Loss: 0.2408382 Vali Loss: 0.3713383 Test Loss: 0.2933971
Validation loss decreased (0.372179 --> 0.371338).  Saving model ...
Updating learning rate to 2.49151138965346e-05
0
Training with all the variates.
当前GPU已分配内存：0.03003978729248047 GB
GPU已分配内存的峰值：0.8643579483032227 GB
	iters: 100, epoch: 9 | loss: 0.2284211
	speed: 0.2776s/iter; left time: 120.1883s
	iters: 200, epoch: 9 | loss: 0.2384150
	speed: 0.1069s/iter; left time: 35.5860s
Epoch: 9 cost time: 28.44769024848938
Epoch: 9, Steps: 266 | Train Loss: 0.2396106 Vali Loss: 0.3707214 Test Loss: 0.2922133
Validation loss decreased (0.371338 --> 0.370721).  Saving model ...
Updating learning rate to 6.649976721797853e-06
0
Training with all the variates.
当前GPU已分配内存：0.03003978729248047 GB
GPU已分配内存的峰值：0.8643579483032227 GB
	iters: 100, epoch: 10 | loss: 0.2329597
	speed: 0.2771s/iter; left time: 46.2830s
	iters: 200, epoch: 10 | loss: 0.2419096
	speed: 0.1069s/iter; left time: 7.1633s
Epoch: 10 cost time: 28.4410343170166
Epoch: 10, Steps: 266 | Train Loss: 0.2392138 Vali Loss: 0.3706254 Test Loss: 0.2922276
Validation loss decreased (0.370721 --> 0.370625).  Saving model ...
Updating learning rate to 4.968661642358393e-10
>>>>>>>testing : ETTm1_384_96_PerioDformer_ETTm1_ftM_sl384_ll48_pl96_dm64_nh8_el2_dl1_df128_fc1_ebtimeF_dtTrue_Exp_6_48_2_128_256__exp2_dim64_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test-mse:0.2922276556491852, mae:0.34602802991867065, rse:0.514610230922699
