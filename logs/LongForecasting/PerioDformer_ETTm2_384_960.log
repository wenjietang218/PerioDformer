Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='ETTm2_384_960', model='PerioDformer', data='ETTm2', root_path='./dataset/10%/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=384, label_len=48, pred_len=960, w=2, C=48, mlp_num=3, d_model2=128, d_ff2=256, experiment=2, dimension=64, percent=0, fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=32, n_heads=8, e_layers=5, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=10, batch_size=128, patience=20, learning_rate=0.0001, des='Exp', loss='mse', lradj='TST', pct_start=0.4, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 4455380
>>>>>>>start training : ETTm2_384_960_PerioDformer_ETTm2_ftM_sl384_ll48_pl960_dm32_nh8_el5_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_48_3_128_256__exp2_dim64_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33217
val 10561
test 10561
0
Training with all the variates.
当前GPU已分配内存：0.11065864562988281 GB
GPU已分配内存的峰值：3.0111470222473145 GB
	iters: 100, epoch: 1 | loss: 0.4925354
	speed: 0.5807s/iter; left time: 1446.4656s
	iters: 200, epoch: 1 | loss: 0.5146776
	speed: 0.5726s/iter; left time: 1369.0609s
Epoch: 1 cost time: 149.1363925933838
Epoch: 1, Steps: 259 | Train Loss: 0.6163185 Vali Loss: 0.3162733 Test Loss: 0.4052908
Validation loss decreased (inf --> 0.316273).  Saving model ...
Updating learning rate to 1.808464011595976e-05
0
Training with all the variates.
当前GPU已分配内存：0.11065864562988281 GB
GPU已分配内存的峰值：3.056346893310547 GB
	iters: 100, epoch: 2 | loss: 0.6077478
	speed: 1.2901s/iter; left time: 2879.4737s
	iters: 200, epoch: 2 | loss: 0.4056242
	speed: 0.5732s/iter; left time: 1221.9968s
Epoch: 2 cost time: 148.08173632621765
Epoch: 2, Steps: 259 | Train Loss: 0.5720209 Vali Loss: 0.3072936 Test Loss: 0.3877463
Validation loss decreased (0.316273 --> 0.307294).  Saving model ...
Updating learning rate to 5.2072848497334757e-05
0
Training with all the variates.
当前GPU已分配内存：0.11065864562988281 GB
GPU已分配内存的峰值：3.056346893310547 GB
	iters: 100, epoch: 3 | loss: 0.4708790
	speed: 1.2901s/iter; left time: 2545.4659s
	iters: 200, epoch: 3 | loss: 0.5965502
	speed: 0.5729s/iter; left time: 1072.9969s
Epoch: 3 cost time: 148.06131410598755
Epoch: 3, Steps: 259 | Train Loss: 0.5389405 Vali Loss: 0.3147493 Test Loss: 0.3836109
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.601830500921189e-05
0
Training with all the variates.
当前GPU已分配内存：0.11065864562988281 GB
GPU已分配内存的峰值：3.056346893310547 GB
	iters: 100, epoch: 4 | loss: 0.4863112
	speed: 1.2902s/iter; left time: 2211.4004s
	iters: 200, epoch: 4 | loss: 0.4900298
	speed: 0.5728s/iter; left time: 924.5300s
Epoch: 4 cost time: 148.03755617141724
Epoch: 4, Steps: 259 | Train Loss: 0.5167310 Vali Loss: 0.3138961 Test Loss: 0.3795837
EarlyStopping counter: 2 out of 20
Updating learning rate to 9.999989782707182e-05
0
Training with all the variates.
当前GPU已分配内存：0.11065864562988281 GB
GPU已分配内存的峰值：3.056346893310547 GB
	iters: 100, epoch: 5 | loss: 0.4389553
	speed: 1.2885s/iter; left time: 1874.6965s
	iters: 200, epoch: 5 | loss: 0.4458693
	speed: 0.5723s/iter; left time: 775.5085s
Epoch: 5 cost time: 147.88248205184937
Epoch: 5, Steps: 259 | Train Loss: 0.4972443 Vali Loss: 0.3166906 Test Loss: 0.3841514
EarlyStopping counter: 3 out of 20
Updating learning rate to 9.32506683140222e-05
0
Training with all the variates.
当前GPU已分配内存：0.11065864562988281 GB
GPU已分配内存的峰值：3.056346893310547 GB
	iters: 100, epoch: 6 | loss: 0.4917668
	speed: 1.2888s/iter; left time: 1541.4174s
	iters: 200, epoch: 6 | loss: 0.5226522
	speed: 0.5725s/iter; left time: 627.4897s
Epoch: 6 cost time: 147.92643189430237
Epoch: 6, Steps: 259 | Train Loss: 0.4856214 Vali Loss: 0.3152629 Test Loss: 0.3834113
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.491251074396247e-05
0
Training with all the variates.
当前GPU已分配内存：0.11065864562988281 GB
GPU已分配内存的峰值：3.056346893310547 GB
	iters: 100, epoch: 7 | loss: 0.4572074
	speed: 1.2891s/iter; left time: 1207.8914s
	iters: 200, epoch: 7 | loss: 0.4352788
	speed: 0.5720s/iter; left time: 478.7641s
Epoch: 7 cost time: 147.85262489318848
Epoch: 7, Steps: 259 | Train Loss: 0.4755972 Vali Loss: 0.3193175 Test Loss: 0.3900196
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.989911962846481e-05
0
Training with all the variates.
当前GPU已分配内存：0.11065864562988281 GB
GPU已分配内存的峰值：3.056346893310547 GB
	iters: 100, epoch: 8 | loss: 0.4483326
	speed: 1.2886s/iter; left time: 873.6684s
	iters: 200, epoch: 8 | loss: 0.4752164
	speed: 0.5726s/iter; left time: 330.9419s
Epoch: 8 cost time: 147.95628428459167
Epoch: 8, Steps: 259 | Train Loss: 0.4680758 Vali Loss: 0.3210149 Test Loss: 0.3884077
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.4912812916890644e-05
0
Training with all the variates.
当前GPU已分配内存：0.11065864562988281 GB
GPU已分配内存的峰值：3.056346893310547 GB
	iters: 100, epoch: 9 | loss: 0.4457403
	speed: 1.2894s/iter; left time: 540.2430s
	iters: 200, epoch: 9 | loss: 0.4855176
	speed: 0.5726s/iter; left time: 182.6446s
Epoch: 9 cost time: 147.96680760383606
Epoch: 9, Steps: 259 | Train Loss: 0.4632210 Vali Loss: 0.3208319 Test Loss: 0.3871626
EarlyStopping counter: 7 out of 20
Updating learning rate to 6.648651314442604e-06
0
Training with all the variates.
当前GPU已分配内存：0.11065864562988281 GB
GPU已分配内存的峰值：3.056346893310547 GB
	iters: 100, epoch: 10 | loss: 0.4265456
	speed: 1.2885s/iter; left time: 206.1588s
	iters: 200, epoch: 10 | loss: 0.4305676
	speed: 0.5722s/iter; left time: 34.3308s
Epoch: 10 cost time: 147.87186813354492
Epoch: 10, Steps: 259 | Train Loss: 0.4617619 Vali Loss: 0.3206523 Test Loss: 0.3886802
EarlyStopping counter: 8 out of 20
Updating learning rate to 5.021729281811084e-10
>>>>>>>testing : ETTm2_384_960_PerioDformer_ETTm2_ftM_sl384_ll48_pl960_dm32_nh8_el5_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_48_3_128_256__exp2_dim64_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10561
test-mse:0.3877466022968292, mae:0.40492621064186096, rse:0.5013827681541443
